! function e(t, i, n) {
    function r(a, s) {
        if (!i[a]) {
            if (!t[a]) {
                var l = "function" == typeof require && require;
                if (!s && l) return l(a, !0);
                if (o) return o(a, !0);
                var h = new Error("Cannot find module '" + a + "'");
                throw h.code = "MODULE_NOT_FOUND", h
            }
            var u = i[a] = {
                exports: {}
            };
            t[a][0].call(u.exports, function(e) {
                var i = t[a][1][e];
                return r(i ? i : e)
            }, u, u.exports, e, t, i, n)
        }
        return i[a].exports
    }
    for (var o = "function" == typeof require && require, a = 0; a < n.length; a++) r(n[a]);
    return r
}({
    1: [function(e, t, i) {
        "use strict";

        function n() {
            if (l.length) throw l.shift()
        }

        function r(e) {
            var t;
            t = s.length ? s.pop() : new o, t.task = e, a(t)
        }

        function o() {
            this.task = null
        }
        var a = e("./raw"),
            s = [],
            l = [],
            h = a.makeRequestCallFromTimer(n);
        t.exports = r, o.prototype.call = function() {
            try {
                this.task.call()
            } catch (e) {
                r.onerror ? r.onerror(e) : (l.push(e), h())
            } finally {
                this.task = null, s[s.length] = this
            }
        }
    }, {
        "./raw": 2
    }],
    2: [function(e, t, i) {
        (function(e) {
            "use strict";

            function i(e) {
                s.length || (a(), l = !0), s[s.length] = e
            }

            function n() {
                for (; h < s.length;) {
                    var e = h;
                    if (h += 1, s[e].call(), h > u) {
                        for (var t = 0, i = s.length - h; i > t; t++) s[t] = s[t + h];
                        s.length -= h, h = 0
                    }
                }
                s.length = 0, h = 0, l = !1
            }

            function r(e) {
                var t = 1,
                    i = new c(e),
                    n = document.createTextNode("");
                return i.observe(n, {
                        characterData: !0
                    }),
                    function() {
                        t = -t, n.data = t
                    }
            }

            function o(e) {
                return function() {
                    function t() {
                        clearTimeout(i), clearInterval(n), e()
                    }
                    var i = setTimeout(t, 0),
                        n = setInterval(t, 50)
                }
            }
            t.exports = i;
            var a, s = [],
                l = !1,
                h = 0,
                u = 1024,
                d = "undefined" != typeof e ? e : self,
                c = d.MutationObserver || d.WebKitMutationObserver;
            a = "function" == typeof c ? r(n) : o(n), i.requestFlush = a, i.makeRequestCallFromTimer = o
        }).call(this, window)
    }, {}],
    3: [function(e, t, i) {
        var n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
        ! function(e) {
            "use strict";

            function t(e) {
                var t = e.charCodeAt(0);
                return t === a || t === d ? 62 : t === s || t === c ? 63 : l > t ? -1 : l + 10 > t ? t - l + 26 + 26 : u + 26 > t ? t - u : h + 26 > t ? t - h + 26 : void 0
            }

            function i(e) {
                function i(e) {
                    h[d++] = e
                }
                var n, r, a, s, l, h;
                if (e.length % 4 > 0) throw new Error("Invalid string. Length must be a multiple of 4");
                var u = e.length;
                l = "=" === e.charAt(u - 2) ? 2 : "=" === e.charAt(u - 1) ? 1 : 0, h = new o(3 * e.length / 4 - l), a = l > 0 ? e.length - 4 : e.length;
                var d = 0;
                for (n = 0, r = 0; a > n; n += 4, r += 3) s = t(e.charAt(n)) << 18 | t(e.charAt(n + 1)) << 12 | t(e.charAt(n + 2)) << 6 | t(e.charAt(n + 3)), i((16711680 & s) >> 16), i((65280 & s) >> 8), i(255 & s);
                return 2 === l ? (s = t(e.charAt(n)) << 2 | t(e.charAt(n + 1)) >> 4, i(255 & s)) : 1 === l && (s = t(e.charAt(n)) << 10 | t(e.charAt(n + 1)) << 4 | t(e.charAt(n + 2)) >> 2, i(s >> 8 & 255), i(255 & s)), h
            }

            function r(e) {
                function t(e) {
                    return n.charAt(e)
                }

                function i(e) {
                    return t(e >> 18 & 63) + t(e >> 12 & 63) + t(e >> 6 & 63) + t(63 & e)
                }
                var r, o, a, s = e.length % 3,
                    l = "";
                for (r = 0, a = e.length - s; a > r; r += 3) o = (e[r] << 16) + (e[r + 1] << 8) + e[r + 2], l += i(o);
                switch (s) {
                    case 1:
                        o = e[e.length - 1], l += t(o >> 2), l += t(o << 4 & 63), l += "==";
                        break;
                    case 2:
                        o = (e[e.length - 2] << 8) + e[e.length - 1], l += t(o >> 10), l += t(o >> 4 & 63), l += t(o << 2 & 63), l += "="
                }
                return l
            }
            var o = "undefined" != typeof Uint8Array ? Uint8Array : Array,
                a = "+".charCodeAt(0),
                s = "/".charCodeAt(0),
                l = "0".charCodeAt(0),
                h = "a".charCodeAt(0),
                u = "A".charCodeAt(0),
                d = "-".charCodeAt(0),
                c = "_".charCodeAt(0);
            e.toByteArray = i, e.fromByteArray = r
        }("undefined" == typeof i ? this.base64js = {} : i)
    }, {}],
    4: [function(e, t, i) {
        function n() {
            return "ontouchstart" in window || navigator.MaxTouchPoints > 0 || navigator.msMaxTouchPoints > 0
        }

        function r(e) {
            return /Edge/.test(R(e))
        }

        function o(e) {
            return /BlackBerry/i.test(R(e)) || /BB10/i.test(R(e)) || /PlayBook/i.test(R(e)) || /RIM/i.test(R(e))
        }

        function a(e) {
            return o(e) && /mobile/i.test(R(e))
        }

        function s(e) {
            return o(e) && /tablet/i.test(R(e))
        }

        function l(e) {
            return /android/i.test(R(e))
        }

        function h(e) {
            return l(e) && /mobi/i.test(R(e))
        }

        function u(e) {
            return /Windows Phone/i.test(R(e))
        }

        function d(e) {
            return /iPhone/i.test(R(e))
        }

        function c(e) {
            return d(e) || g(e) || h(e) || u(e) || a(e)
        }

        function f(e) {
            return l(e) && (!/mobile/i.test(R(e)) || /SCH-I800/i.test(R(e)) || /Xoom/i.test(R(e)))
        }

        function p(e) {
            return /Silk/i.test(R(e))
        }

        function m(e) {
            return /iPad/i.test(R(e))
        }

        function g(e) {
            return /iPod/i.test(R(e))
        }

        function _(e) {
            return m(e) || f(e) || s(e) || p(e)
        }

        function v(e) {
            return m(e) || d(e) || g(e)
        }

        function y(e) {
            var t = T(e);
            return t.supported
        }

        function b(e, t) {
            for (var i = ["webgl", "experimental-webgl", "moz-webgl", "webkit-3d"], n = null, r = 0; r < i.length; r++) try {
                if (n = e.getContext(i[r], t)) break
            } catch (o) {}
            return n
        }

        function x(e) {
            if (v(e)) {
                var t = w(R(e));
                if (t && t.major && t.major >= 6) return !0
            }
            return !1
        }

        function w(e) {
            var t = / OS ([0-9_]+)/i.exec(R(e));
            return t ? {
                major: t[1].split("_")[0],
                minor: t[1].split("_")[1],
                full: t[1]
            } : null
        }

        function M(e) {
            var t = / Android ([0-9.]+)/i.exec(R(e));
            return t ? {
                major: t[1].split(".")[0],
                minor: t[1].split(".")[1],
                full: t[1]
            } : null
        }

        function T(e) {
            var t = ["VERSION", "VENDOR", "RENDERER", "SHADING_LANGUAGE_VERSION"],
                i = {
                    supported: !1
                };
            if ("object" == typeof Ejecta) return i.ejecta = !0, i;
            var n = document.createElement("canvas"),
                r = b(n, e);
            return r && (i.supported = !0, D.each(t, function(e) {
                i[e] = r.getParameter(r[e])
            })), i
        }

        function S(e) {
            return /firefox\//i.test(R(e))
        }

        function C(e) {
            return /chrome\//i.test(R(e))
        }

        function E(e) {
            return /MSIE/i.test(R(e)) || /Trident/i.test(R(e))
        }

        function k(e) {
            return /(Windows (?:NT 5\.2|NT 5\.1))/.test(R(e))
        }

        function L(e) {
            return /bot|crawler|spider|robot|crawling|slurp|snippet|externalhit/i.test(R(e))
        }

        function P(e) {
            e = e.toLowerCase();
            var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
            return {
                browser: t[1] || "",
                version: t[2] || "0"
            }
        }

        function A(e) {
            var t = P(R(e)),
                i = {};
            return t.browser && (i[t.browser] = !0, i.version = t.version), i.chrome ? i.webkit = !0 : i.webkit && (i.safari = !0), i
        }

        function R(e) {
            return null == e && "undefined" != typeof navigator ? navigator.userAgent : e
        }
        var D = e("underscore");
        t.exports = {
            isMobile: c,
            isTablet: _,
            isAndroid: l,
            isIOS: v,
            supportWebGL: y,
            getWebGlContext: b,
            supportIosNativeScroll: x,
            detectWebGL: T,
            isFirefox: S,
            isGoogleChrome: C,
            isMSIE: E,
            isWindowsXP: k,
            isBot: L,
            getBrowser: A,
            getIOSVersion: w,
            getAndroidVersion: M,
            isEdge: r,
            isTouchDevice: n
        }
    }, {
        underscore: 207
    }],
    5: [function(e, t, i) {}, {}],
    6: [function(e, t, i) {
        (function(t) {
            "use strict";

            function n() {
                function e() {}
                try {
                    var t = new Uint8Array(1);
                    return t.foo = function() {
                        return 42
                    }, t.constructor = e, 42 === t.foo() && t.constructor === e && "function" == typeof t.subarray && 0 === t.subarray(1, 1).byteLength
                } catch (i) {
                    return !1
                }
            }

            function r() {
                return o.TYPED_ARRAY_SUPPORT ? 2147483647 : 1073741823
            }

            function o(e) {
                return this instanceof o ? (o.TYPED_ARRAY_SUPPORT || (this.length = 0, this.parent = void 0), "number" == typeof e ? a(this, e) : "string" == typeof e ? s(this, e, arguments.length > 1 ? arguments[1] : "utf8") : l(this, e)) : arguments.length > 1 ? new o(e, arguments[1]) : new o(e)
            }

            function a(e, t) {
                if (e = m(e, 0 > t ? 0 : 0 | g(t)), !o.TYPED_ARRAY_SUPPORT)
                    for (var i = 0; t > i; i++) e[i] = 0;
                return e
            }

            function s(e, t, i) {
                ("string" != typeof i || "" === i) && (i = "utf8");
                var n = 0 | v(t, i);
                return e = m(e, n), e.write(t, i), e
            }

            function l(e, t) {
                if (o.isBuffer(t)) return h(e, t);
                if (X(t)) return u(e, t);
                if (null == t) throw new TypeError("must start with number, buffer, array or string");
                if ("undefined" != typeof ArrayBuffer) {
                    if (t.buffer instanceof ArrayBuffer) return d(e, t);
                    if (t instanceof ArrayBuffer) return c(e, t)
                }
                return t.length ? f(e, t) : p(e, t)
            }

            function h(e, t) {
                var i = 0 | g(t.length);
                return e = m(e, i), t.copy(e, 0, 0, i), e
            }

            function u(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var n = 0; i > n; n += 1) e[n] = 255 & t[n];
                return e
            }

            function d(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var n = 0; i > n; n += 1) e[n] = 255 & t[n];
                return e
            }

            function c(e, t) {
                return o.TYPED_ARRAY_SUPPORT ? (t.byteLength, e = o._augment(new Uint8Array(t))) : e = d(e, new Uint8Array(t)), e
            }

            function f(e, t) {
                var i = 0 | g(t.length);
                e = m(e, i);
                for (var n = 0; i > n; n += 1) e[n] = 255 & t[n];
                return e
            }

            function p(e, t) {
                var i, n = 0;
                "Buffer" === t.type && X(t.data) && (i = t.data, n = 0 | g(i.length)), e = m(e, n);
                for (var r = 0; n > r; r += 1) e[r] = 255 & i[r];
                return e
            }

            function m(e, t) {
                o.TYPED_ARRAY_SUPPORT ? (e = o._augment(new Uint8Array(t)), e.__proto__ = o.prototype) : (e.length = t, e._isBuffer = !0);
                var i = 0 !== t && t <= o.poolSize >>> 1;
                return i && (e.parent = $), e
            }

            function g(e) {
                if (e >= r()) throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x" + r().toString(16) + " bytes");
                return 0 | e
            }

            function _(e, t) {
                if (!(this instanceof _)) return new _(e, t);
                var i = new o(e, t);
                return delete i.parent, i
            }

            function v(e, t) {
                "string" != typeof e && (e = "" + e);
                var i = e.length;
                if (0 === i) return 0;
                for (var n = !1;;) switch (t) {
                    case "ascii":
                    case "binary":
                    case "raw":
                    case "raws":
                        return i;
                    case "utf8":
                    case "utf-8":
                        return G(e).length;
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                        return 2 * i;
                    case "hex":
                        return i >>> 1;
                    case "base64":
                        return V(e).length;
                    default:
                        if (n) return G(e).length;
                        t = ("" + t).toLowerCase(), n = !0
                }
            }

            function y(e, t, i) {
                var n = !1;
                if (t = 0 | t, i = void 0 === i || i === 1 / 0 ? this.length : 0 | i, e || (e = "utf8"), 0 > t && (t = 0), i > this.length && (i = this.length), t >= i) return "";
                for (;;) switch (e) {
                    case "hex":
                        return A(this, t, i);
                    case "utf8":
                    case "utf-8":
                        return E(this, t, i);
                    case "ascii":
                        return L(this, t, i);
                    case "binary":
                        return P(this, t, i);
                    case "base64":
                        return C(this, t, i);
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                        return R(this, t, i);
                    default:
                        if (n) throw new TypeError("Unknown encoding: " + e);
                        e = (e + "").toLowerCase(), n = !0
                }
            }

            function b(e, t, i, n) {
                i = Number(i) || 0;
                var r = e.length - i;
                n ? (n = Number(n), n > r && (n = r)) : n = r;
                var o = t.length;
                if (o % 2 !== 0) throw new Error("Invalid hex string");
                n > o / 2 && (n = o / 2);
                for (var a = 0; n > a; a++) {
                    var s = parseInt(t.substr(2 * a, 2), 16);
                    if (isNaN(s)) throw new Error("Invalid hex string");
                    e[i + a] = s
                }
                return a
            }

            function x(e, t, i, n) {
                return Z(G(t, e.length - i), e, i, n)
            }

            function w(e, t, i, n) {
                return Z(j(t), e, i, n)
            }

            function M(e, t, i, n) {
                return w(e, t, i, n)
            }

            function T(e, t, i, n) {
                return Z(V(t), e, i, n)
            }

            function S(e, t, i, n) {
                return Z(q(t, e.length - i), e, i, n)
            }

            function C(e, t, i) {
                return 0 === t && i === e.length ? Y.fromByteArray(e) : Y.fromByteArray(e.slice(t, i))
            }

            function E(e, t, i) {
                i = Math.min(e.length, i);
                for (var n = [], r = t; i > r;) {
                    var o = e[r],
                        a = null,
                        s = o > 239 ? 4 : o > 223 ? 3 : o > 191 ? 2 : 1;
                    if (i >= r + s) {
                        var l, h, u, d;
                        switch (s) {
                            case 1:
                                128 > o && (a = o);
                                break;
                            case 2:
                                l = e[r + 1], 128 === (192 & l) && (d = (31 & o) << 6 | 63 & l, d > 127 && (a = d));
                                break;
                            case 3:
                                l = e[r + 1], h = e[r + 2], 128 === (192 & l) && 128 === (192 & h) && (d = (15 & o) << 12 | (63 & l) << 6 | 63 & h, d > 2047 && (55296 > d || d > 57343) && (a = d));
                                break;
                            case 4:
                                l = e[r + 1], h = e[r + 2], u = e[r + 3], 128 === (192 & l) && 128 === (192 & h) && 128 === (192 & u) && (d = (15 & o) << 18 | (63 & l) << 12 | (63 & h) << 6 | 63 & u, d > 65535 && 1114112 > d && (a = d))
                        }
                    }
                    null === a ? (a = 65533, s = 1) : a > 65535 && (a -= 65536, n.push(a >>> 10 & 1023 | 55296), a = 56320 | 1023 & a), n.push(a), r += s
                }
                return k(n)
            }

            function k(e) {
                var t = e.length;
                if (Q >= t) return String.fromCharCode.apply(String, e);
                for (var i = "", n = 0; t > n;) i += String.fromCharCode.apply(String, e.slice(n, n += Q));
                return i
            }

            function L(e, t, i) {
                var n = "";
                i = Math.min(e.length, i);
                for (var r = t; i > r; r++) n += String.fromCharCode(127 & e[r]);
                return n
            }

            function P(e, t, i) {
                var n = "";
                i = Math.min(e.length, i);
                for (var r = t; i > r; r++) n += String.fromCharCode(e[r]);
                return n
            }

            function A(e, t, i) {
                var n = e.length;
                (!t || 0 > t) && (t = 0), (!i || 0 > i || i > n) && (i = n);
                for (var r = "", o = t; i > o; o++) r += W(e[o]);
                return r
            }

            function R(e, t, i) {
                for (var n = e.slice(t, i), r = "", o = 0; o < n.length; o += 2) r += String.fromCharCode(n[o] + 256 * n[o + 1]);
                return r
            }

            function D(e, t, i) {
                if (e % 1 !== 0 || 0 > e) throw new RangeError("offset is not uint");
                if (e + t > i) throw new RangeError("Trying to access beyond buffer length")
            }

            function I(e, t, i, n, r, a) {
                if (!o.isBuffer(e)) throw new TypeError("buffer must be a Buffer instance");
                if (t > r || a > t) throw new RangeError("value is out of bounds");
                if (i + n > e.length) throw new RangeError("index out of range")
            }

            function O(e, t, i, n) {
                0 > t && (t = 65535 + t + 1);
                for (var r = 0, o = Math.min(e.length - i, 2); o > r; r++) e[i + r] = (t & 255 << 8 * (n ? r : 1 - r)) >>> 8 * (n ? r : 1 - r)
            }

            function N(e, t, i, n) {
                0 > t && (t = 4294967295 + t + 1);
                for (var r = 0, o = Math.min(e.length - i, 4); o > r; r++) e[i + r] = t >>> 8 * (n ? r : 3 - r) & 255
            }

            function B(e, t, i, n, r, o) {
                if (t > r || o > t) throw new RangeError("value is out of bounds");
                if (i + n > e.length) throw new RangeError("index out of range");
                if (0 > i) throw new RangeError("index out of range")
            }

            function F(e, t, i, n, r) {
                return r || B(e, t, i, 4, 3.4028234663852886e38, -3.4028234663852886e38), K.write(e, t, i, n, 23, 4), i + 4
            }

            function z(e, t, i, n, r) {
                return r || B(e, t, i, 8, 1.7976931348623157e308, -1.7976931348623157e308), K.write(e, t, i, n, 52, 8), i + 8
            }

            function H(e) {
                if (e = U(e).replace(ee, ""), e.length < 2) return "";
                for (; e.length % 4 !== 0;) e += "=";
                return e
            }

            function U(e) {
                return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
            }

            function W(e) {
                return 16 > e ? "0" + e.toString(16) : e.toString(16)
            }

            function G(e, t) {
                t = t || 1 / 0;
                for (var i, n = e.length, r = null, o = [], a = 0; n > a; a++) {
                    if (i = e.charCodeAt(a), i > 55295 && 57344 > i) {
                        if (!r) {
                            if (i > 56319) {
                                (t -= 3) > -1 && o.push(239, 191, 189);
                                continue
                            }
                            if (a + 1 === n) {
                                (t -= 3) > -1 && o.push(239, 191, 189);
                                continue
                            }
                            r = i;
                            continue
                        }
                        if (56320 > i) {
                            (t -= 3) > -1 && o.push(239, 191, 189), r = i;
                            continue
                        }
                        i = (r - 55296 << 10 | i - 56320) + 65536
                    } else r && (t -= 3) > -1 && o.push(239, 191, 189);
                    if (r = null, 128 > i) {
                        if ((t -= 1) < 0) break;
                        o.push(i)
                    } else if (2048 > i) {
                        if ((t -= 2) < 0) break;
                        o.push(i >> 6 | 192, 63 & i | 128)
                    } else if (65536 > i) {
                        if ((t -= 3) < 0) break;
                        o.push(i >> 12 | 224, i >> 6 & 63 | 128, 63 & i | 128)
                    } else {
                        if (!(1114112 > i)) throw new Error("Invalid code point");
                        if ((t -= 4) < 0) break;
                        o.push(i >> 18 | 240, i >> 12 & 63 | 128, i >> 6 & 63 | 128, 63 & i | 128)
                    }
                }
                return o
            }

            function j(e) {
                for (var t = [], i = 0; i < e.length; i++) t.push(255 & e.charCodeAt(i));
                return t
            }

            function q(e, t) {
                for (var i, n, r, o = [], a = 0; a < e.length && !((t -= 2) < 0); a++) i = e.charCodeAt(a), n = i >> 8, r = i % 256, o.push(r), o.push(n);
                return o
            }

            function V(e) {
                return Y.toByteArray(H(e))
            }

            function Z(e, t, i, n) {
                for (var r = 0; n > r && !(r + i >= t.length || r >= e.length); r++) t[r + i] = e[r];
                return r
            }
            var Y = e("base64-js"),
                K = e("ieee754"),
                X = e("isarray");
            i.Buffer = o, i.SlowBuffer = _, i.INSPECT_MAX_BYTES = 50, o.poolSize = 8192;
            var $ = {};
            o.TYPED_ARRAY_SUPPORT = void 0 !== t.TYPED_ARRAY_SUPPORT ? t.TYPED_ARRAY_SUPPORT : n(), o.TYPED_ARRAY_SUPPORT ? (o.prototype.__proto__ = Uint8Array.prototype, o.__proto__ = Uint8Array) : (o.prototype.length = void 0, o.prototype.parent = void 0), o.isBuffer = function(e) {
                return !(null == e || !e._isBuffer)
            }, o.compare = function(e, t) {
                if (!o.isBuffer(e) || !o.isBuffer(t)) throw new TypeError("Arguments must be Buffers");
                if (e === t) return 0;
                for (var i = e.length, n = t.length, r = 0, a = Math.min(i, n); a > r && e[r] === t[r];) ++r;
                return r !== a && (i = e[r], n = t[r]), n > i ? -1 : i > n ? 1 : 0
            }, o.isEncoding = function(e) {
                switch (String(e).toLowerCase()) {
                    case "hex":
                    case "utf8":
                    case "utf-8":
                    case "ascii":
                    case "binary":
                    case "base64":
                    case "raw":
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                        return !0;
                    default:
                        return !1
                }
            }, o.concat = function(e, t) {
                if (!X(e)) throw new TypeError("list argument must be an Array of Buffers.");
                if (0 === e.length) return new o(0);
                var i;
                if (void 0 === t)
                    for (t = 0, i = 0; i < e.length; i++) t += e[i].length;
                var n = new o(t),
                    r = 0;
                for (i = 0; i < e.length; i++) {
                    var a = e[i];
                    a.copy(n, r), r += a.length
                }
                return n
            }, o.byteLength = v, o.prototype.toString = function() {
                var e = 0 | this.length;
                return 0 === e ? "" : 0 === arguments.length ? E(this, 0, e) : y.apply(this, arguments)
            }, o.prototype.equals = function(e) {
                if (!o.isBuffer(e)) throw new TypeError("Argument must be a Buffer");
                return this === e ? !0 : 0 === o.compare(this, e)
            }, o.prototype.inspect = function() {
                var e = "",
                    t = i.INSPECT_MAX_BYTES;
                return this.length > 0 && (e = this.toString("hex", 0, t).match(/.{2}/g).join(" "), this.length > t && (e += " ... ")), "<Buffer " + e + ">"
            }, o.prototype.compare = function(e) {
                if (!o.isBuffer(e)) throw new TypeError("Argument must be a Buffer");
                return this === e ? 0 : o.compare(this, e)
            }, o.prototype.indexOf = function(e, t) {
                function i(e, t, i) {
                    for (var n = -1, r = 0; i + r < e.length; r++)
                        if (e[i + r] === t[-1 === n ? 0 : r - n]) {
                            if (-1 === n && (n = r), r - n + 1 === t.length) return i + n
                        } else n = -1;
                    return -1
                }
                if (t > 2147483647 ? t = 2147483647 : -2147483648 > t && (t = -2147483648), t >>= 0, 0 === this.length) return -1;
                if (t >= this.length) return -1;
                if (0 > t && (t = Math.max(this.length + t, 0)), "string" == typeof e) return 0 === e.length ? -1 : String.prototype.indexOf.call(this, e, t);
                if (o.isBuffer(e)) return i(this, e, t);
                if ("number" == typeof e) return o.TYPED_ARRAY_SUPPORT && "function" === Uint8Array.prototype.indexOf ? Uint8Array.prototype.indexOf.call(this, e, t) : i(this, [e], t);
                throw new TypeError("val must be string, number or Buffer")
            }, o.prototype.get = function(e) {
                return console.log(".get() is deprecated. Access using array indexes instead."), this.readUInt8(e)
            }, o.prototype.set = function(e, t) {
                return console.log(".set() is deprecated. Access using array indexes instead."), this.writeUInt8(e, t)
            }, o.prototype.write = function(e, t, i, n) {
                if (void 0 === t) n = "utf8", i = this.length, t = 0;
                else if (void 0 === i && "string" == typeof t) n = t, i = this.length, t = 0;
                else if (isFinite(t)) t = 0 | t, isFinite(i) ? (i = 0 | i, void 0 === n && (n = "utf8")) : (n = i, i = void 0);
                else {
                    var r = n;
                    n = t, t = 0 | i, i = r
                }
                var o = this.length - t;
                if ((void 0 === i || i > o) && (i = o), e.length > 0 && (0 > i || 0 > t) || t > this.length) throw new RangeError("attempt to write outside buffer bounds");
                n || (n = "utf8");
                for (var a = !1;;) switch (n) {
                    case "hex":
                        return b(this, e, t, i);
                    case "utf8":
                    case "utf-8":
                        return x(this, e, t, i);
                    case "ascii":
                        return w(this, e, t, i);
                    case "binary":
                        return M(this, e, t, i);
                    case "base64":
                        return T(this, e, t, i);
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                        return S(this, e, t, i);
                    default:
                        if (a) throw new TypeError("Unknown encoding: " + n);
                        n = ("" + n).toLowerCase(), a = !0
                }
            }, o.prototype.toJSON = function() {
                return {
                    type: "Buffer",
                    data: Array.prototype.slice.call(this._arr || this, 0)
                }
            };
            var Q = 4096;
            o.prototype.slice = function(e, t) {
                var i = this.length;
                e = ~~e, t = void 0 === t ? i : ~~t, 0 > e ? (e += i, 0 > e && (e = 0)) : e > i && (e = i), 0 > t ? (t += i, 0 > t && (t = 0)) : t > i && (t = i), e > t && (t = e);
                var n;
                if (o.TYPED_ARRAY_SUPPORT) n = o._augment(this.subarray(e, t));
                else {
                    var r = t - e;
                    n = new o(r, void 0);
                    for (var a = 0; r > a; a++) n[a] = this[a + e]
                }
                return n.length && (n.parent = this.parent || this), n
            }, o.prototype.readUIntLE = function(e, t, i) {
                e = 0 | e, t = 0 | t, i || D(e, t, this.length);
                for (var n = this[e], r = 1, o = 0; ++o < t && (r *= 256);) n += this[e + o] * r;
                return n
            }, o.prototype.readUIntBE = function(e, t, i) {
                e = 0 | e, t = 0 | t, i || D(e, t, this.length);
                for (var n = this[e + --t], r = 1; t > 0 && (r *= 256);) n += this[e + --t] * r;
                return n
            }, o.prototype.readUInt8 = function(e, t) {
                return t || D(e, 1, this.length), this[e]
            }, o.prototype.readUInt16LE = function(e, t) {
                return t || D(e, 2, this.length), this[e] | this[e + 1] << 8
            }, o.prototype.readUInt16BE = function(e, t) {
                return t || D(e, 2, this.length), this[e] << 8 | this[e + 1]
            }, o.prototype.readUInt32LE = function(e, t) {
                return t || D(e, 4, this.length), (this[e] | this[e + 1] << 8 | this[e + 2] << 16) + 16777216 * this[e + 3]
            }, o.prototype.readUInt32BE = function(e, t) {
                return t || D(e, 4, this.length), 16777216 * this[e] + (this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3])
            }, o.prototype.readIntLE = function(e, t, i) {
                e = 0 | e, t = 0 | t, i || D(e, t, this.length);
                for (var n = this[e], r = 1, o = 0; ++o < t && (r *= 256);) n += this[e + o] * r;
                return r *= 128, n >= r && (n -= Math.pow(2, 8 * t)), n
            }, o.prototype.readIntBE = function(e, t, i) {
                e = 0 | e, t = 0 | t, i || D(e, t, this.length);
                for (var n = t, r = 1, o = this[e + --n]; n > 0 && (r *= 256);) o += this[e + --n] * r;
                return r *= 128, o >= r && (o -= Math.pow(2, 8 * t)), o
            }, o.prototype.readInt8 = function(e, t) {
                return t || D(e, 1, this.length), 128 & this[e] ? -1 * (255 - this[e] + 1) : this[e]
            }, o.prototype.readInt16LE = function(e, t) {
                t || D(e, 2, this.length);
                var i = this[e] | this[e + 1] << 8;
                return 32768 & i ? 4294901760 | i : i
            }, o.prototype.readInt16BE = function(e, t) {
                t || D(e, 2, this.length);
                var i = this[e + 1] | this[e] << 8;
                return 32768 & i ? 4294901760 | i : i
            }, o.prototype.readInt32LE = function(e, t) {
                return t || D(e, 4, this.length), this[e] | this[e + 1] << 8 | this[e + 2] << 16 | this[e + 3] << 24
            }, o.prototype.readInt32BE = function(e, t) {
                return t || D(e, 4, this.length), this[e] << 24 | this[e + 1] << 16 | this[e + 2] << 8 | this[e + 3]
            }, o.prototype.readFloatLE = function(e, t) {
                return t || D(e, 4, this.length), K.read(this, e, !0, 23, 4)
            }, o.prototype.readFloatBE = function(e, t) {
                return t || D(e, 4, this.length), K.read(this, e, !1, 23, 4)
            }, o.prototype.readDoubleLE = function(e, t) {
                return t || D(e, 8, this.length), K.read(this, e, !0, 52, 8)
            }, o.prototype.readDoubleBE = function(e, t) {
                return t || D(e, 8, this.length), K.read(this, e, !1, 52, 8)
            }, o.prototype.writeUIntLE = function(e, t, i, n) {
                e = +e, t = 0 | t, i = 0 | i, n || I(this, e, t, i, Math.pow(2, 8 * i), 0);
                var r = 1,
                    o = 0;
                for (this[t] = 255 & e; ++o < i && (r *= 256);) this[t + o] = e / r & 255;
                return t + i
            }, o.prototype.writeUIntBE = function(e, t, i, n) {
                e = +e, t = 0 | t, i = 0 | i, n || I(this, e, t, i, Math.pow(2, 8 * i), 0);
                var r = i - 1,
                    o = 1;
                for (this[t + r] = 255 & e; --r >= 0 && (o *= 256);) this[t + r] = e / o & 255;
                return t + i
            }, o.prototype.writeUInt8 = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 1, 255, 0), o.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), this[t] = 255 & e, t + 1
            }, o.prototype.writeUInt16LE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 65535, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : O(this, e, t, !0), t + 2
            }, o.prototype.writeUInt16BE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 65535, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : O(this, e, t, !1), t + 2
            }, o.prototype.writeUInt32LE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 4294967295, 0), o.TYPED_ARRAY_SUPPORT ? (this[t + 3] = e >>> 24, this[t + 2] = e >>> 16, this[t + 1] = e >>> 8, this[t] = 255 & e) : N(this, e, t, !0), t + 4
            }, o.prototype.writeUInt32BE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 4294967295, 0), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : N(this, e, t, !1), t + 4
            }, o.prototype.writeIntLE = function(e, t, i, n) {
                if (e = +e, t = 0 | t, !n) {
                    var r = Math.pow(2, 8 * i - 1);
                    I(this, e, t, i, r - 1, -r)
                }
                var o = 0,
                    a = 1,
                    s = 0 > e ? 1 : 0;
                for (this[t] = 255 & e; ++o < i && (a *= 256);) this[t + o] = (e / a >> 0) - s & 255;
                return t + i
            }, o.prototype.writeIntBE = function(e, t, i, n) {
                if (e = +e, t = 0 | t, !n) {
                    var r = Math.pow(2, 8 * i - 1);
                    I(this, e, t, i, r - 1, -r)
                }
                var o = i - 1,
                    a = 1,
                    s = 0 > e ? 1 : 0;
                for (this[t + o] = 255 & e; --o >= 0 && (a *= 256);) this[t + o] = (e / a >> 0) - s & 255;
                return t + i
            }, o.prototype.writeInt8 = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 1, 127, -128), o.TYPED_ARRAY_SUPPORT || (e = Math.floor(e)), 0 > e && (e = 255 + e + 1), this[t] = 255 & e, t + 1
            }, o.prototype.writeInt16LE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 32767, -32768), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8) : O(this, e, t, !0), t + 2
            }, o.prototype.writeInt16BE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 2, 32767, -32768), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 8, this[t + 1] = 255 & e) : O(this, e, t, !1), t + 2
            }, o.prototype.writeInt32LE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 2147483647, -2147483648), o.TYPED_ARRAY_SUPPORT ? (this[t] = 255 & e, this[t + 1] = e >>> 8, this[t + 2] = e >>> 16, this[t + 3] = e >>> 24) : N(this, e, t, !0), t + 4
            }, o.prototype.writeInt32BE = function(e, t, i) {
                return e = +e, t = 0 | t, i || I(this, e, t, 4, 2147483647, -2147483648), 0 > e && (e = 4294967295 + e + 1), o.TYPED_ARRAY_SUPPORT ? (this[t] = e >>> 24, this[t + 1] = e >>> 16, this[t + 2] = e >>> 8, this[t + 3] = 255 & e) : N(this, e, t, !1), t + 4
            }, o.prototype.writeFloatLE = function(e, t, i) {
                return F(this, e, t, !0, i)
            }, o.prototype.writeFloatBE = function(e, t, i) {
                return F(this, e, t, !1, i)
            }, o.prototype.writeDoubleLE = function(e, t, i) {
                return z(this, e, t, !0, i)
            }, o.prototype.writeDoubleBE = function(e, t, i) {
                return z(this, e, t, !1, i)
            }, o.prototype.copy = function(e, t, i, n) {
                if (i || (i = 0), n || 0 === n || (n = this.length), t >= e.length && (t = e.length), t || (t = 0), n > 0 && i > n && (n = i), n === i) return 0;
                if (0 === e.length || 0 === this.length) return 0;
                if (0 > t) throw new RangeError("targetStart out of bounds");
                if (0 > i || i >= this.length) throw new RangeError("sourceStart out of bounds");
                if (0 > n) throw new RangeError("sourceEnd out of bounds");
                n > this.length && (n = this.length), e.length - t < n - i && (n = e.length - t + i);
                var r, a = n - i;
                if (this === e && t > i && n > t)
                    for (r = a - 1; r >= 0; r--) e[r + t] = this[r + i];
                else if (1e3 > a || !o.TYPED_ARRAY_SUPPORT)
                    for (r = 0; a > r; r++) e[r + t] = this[r + i];
                else e._set(this.subarray(i, i + a), t);
                return a
            }, o.prototype.fill = function(e, t, i) {
                if (e || (e = 0), t || (t = 0), i || (i = this.length), t > i) throw new RangeError("end < start");
                if (i !== t && 0 !== this.length) {
                    if (0 > t || t >= this.length) throw new RangeError("start out of bounds");
                    if (0 > i || i > this.length) throw new RangeError("end out of bounds");
                    var n;
                    if ("number" == typeof e)
                        for (n = t; i > n; n++) this[n] = e;
                    else {
                        var r = G(e.toString()),
                            o = r.length;
                        for (n = t; i > n; n++) this[n] = r[n % o]
                    }
                    return this
                }
            }, o.prototype.toArrayBuffer = function() {
                if ("undefined" != typeof Uint8Array) {
                    if (o.TYPED_ARRAY_SUPPORT) return new o(this).buffer;
                    for (var e = new Uint8Array(this.length), t = 0, i = e.length; i > t; t += 1) e[t] = this[t];
                    return e.buffer
                }
                throw new TypeError("Buffer.toArrayBuffer not supported in this browser")
            };
            var J = o.prototype;
            o._augment = function(e) {
                return e.constructor = o, e._isBuffer = !0, e._set = e.set, e.get = J.get, e.set = J.set, e.write = J.write, e.toString = J.toString, e.toLocaleString = J.toString, e.toJSON = J.toJSON, e.equals = J.equals, e.compare = J.compare, e.indexOf = J.indexOf, e.copy = J.copy, e.slice = J.slice, e.readUIntLE = J.readUIntLE, e.readUIntBE = J.readUIntBE, e.readUInt8 = J.readUInt8, e.readUInt16LE = J.readUInt16LE, e.readUInt16BE = J.readUInt16BE, e.readUInt32LE = J.readUInt32LE, e.readUInt32BE = J.readUInt32BE, e.readIntLE = J.readIntLE, e.readIntBE = J.readIntBE, e.readInt8 = J.readInt8, e.readInt16LE = J.readInt16LE, e.readInt16BE = J.readInt16BE, e.readInt32LE = J.readInt32LE, e.readInt32BE = J.readInt32BE, e.readFloatLE = J.readFloatLE, e.readFloatBE = J.readFloatBE, e.readDoubleLE = J.readDoubleLE, e.readDoubleBE = J.readDoubleBE, e.writeUInt8 = J.writeUInt8, e.writeUIntLE = J.writeUIntLE, e.writeUIntBE = J.writeUIntBE, e.writeUInt16LE = J.writeUInt16LE, e.writeUInt16BE = J.writeUInt16BE, e.writeUInt32LE = J.writeUInt32LE, e.writeUInt32BE = J.writeUInt32BE, e.writeIntLE = J.writeIntLE, e.writeIntBE = J.writeIntBE, e.writeInt8 = J.writeInt8, e.writeInt16LE = J.writeInt16LE, e.writeInt16BE = J.writeInt16BE, e.writeInt32LE = J.writeInt32LE, e.writeInt32BE = J.writeInt32BE, e.writeFloatLE = J.writeFloatLE, e.writeFloatBE = J.writeFloatBE, e.writeDoubleLE = J.writeDoubleLE, e.writeDoubleBE = J.writeDoubleBE, e.fill = J.fill, e.inspect = J.inspect, e.toArrayBuffer = J.toArrayBuffer, e
            };
            var ee = /[^+\/0-9A-Za-z-_]/g
        }).call(this, window)
    }, {
        "base64-js": 3,
        ieee754: 106,
        isarray: 7
    }],
    7: [function(e, t, i) {
        var n = {}.toString;
        t.exports = Array.isArray || function(e) {
            return "[object Array]" == n.call(e)
        }
    }, {}],
    8: [function(e, t, i) {
        (function(e) {
            function t(e) {
                return Array.isArray ? Array.isArray(e) : "[object Array]" === g(e)
            }

            function n(e) {
                return "boolean" == typeof e
            }

            function r(e) {
                return null === e
            }

            function o(e) {
                return null == e
            }

            function a(e) {
                return "number" == typeof e
            }

            function s(e) {
                return "string" == typeof e
            }

            function l(e) {
                return "symbol" == typeof e
            }

            function h(e) {
                return void 0 === e
            }

            function u(e) {
                return "[object RegExp]" === g(e)
            }

            function d(e) {
                return "object" == typeof e && null !== e
            }

            function c(e) {
                return "[object Date]" === g(e)
            }

            function f(e) {
                return "[object Error]" === g(e) || e instanceof Error
            }

            function p(e) {
                return "function" == typeof e
            }

            function m(e) {
                return null === e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || "symbol" == typeof e || "undefined" == typeof e
            }

            function g(e) {
                return Object.prototype.toString.call(e)
            }
            i.isArray = t, i.isBoolean = n, i.isNull = r, i.isNullOrUndefined = o, i.isNumber = a, i.isString = s, i.isSymbol = l, i.isUndefined = h, i.isRegExp = u, i.isObject = d, i.isDate = c, i.isError = f, i.isFunction = p, i.isPrimitive = m, i.isBuffer = e.isBuffer
        }).call(this, {
            isBuffer: e("../../is-buffer/index.js")
        })
    }, {
        "../../is-buffer/index.js": 108
    }],
    9: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            i = i || 2;
            var n = t && t.length,
                s = n ? t[0] * i : e.length,
                l = o(e, r(e, 0, s, i, !0)),
                h = [];
            if (!l) return h;
            var d, c, f, p, m, g, _;
            if (n && (l = u(e, t, l, i)), e.length > 80 * i) {
                d = f = e[0], c = p = e[1];
                for (var v = i; s > v; v += i) m = e[v], g = e[v + 1], d > m && (d = m), c > g && (c = g), m > f && (f = m), g > p && (p = g);
                _ = Math.max(f - d, p - c)
            }
            return a(e, l, h, i, d, c, _), h
        }

        function r(e, t, i, n, r) {
            var o, a, s, l = 0;
            for (o = t, a = i - n; i > o; o += n) l += (e[a] - e[o]) * (e[o + 1] + e[a + 1]), a = o;
            if (r === l > 0)
                for (o = t; i > o; o += n) s = S(o, s);
            else
                for (o = i - n; o >= t; o -= n) s = S(o, s);
            return s
        }

        function o(e, t, i) {
            i || (i = t);
            var n, r = t;
            do
                if (n = !1, r.steiner || !y(e, r.i, r.next.i) && 0 !== v(e, r.prev.i, r.i, r.next.i)) r = r.next;
                else {
                    if (r.prev.next = r.next, r.next.prev = r.prev, r.prevZ && (r.prevZ.nextZ = r.nextZ), r.nextZ && (r.nextZ.prevZ = r.prevZ), r = i = r.prev, r === r.next) return null;
                    n = !0
                }
            while (n || r !== i);
            return i
        }

        function a(e, t, i, n, r, u, d, c) {
            if (t) {
                c || void 0 === r || f(e, t, r, u, d);
                for (var p, m, g = t; t.prev !== t.next;)
                    if (p = t.prev, m = t.next, s(e, t, r, u, d)) i.push(p.i / n), i.push(t.i / n), i.push(m.i / n), m.prev = p, p.next = m, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ), t = m.next, g = m.next;
                    else if (t = m, t === g) {
                    c ? 1 === c ? (t = l(e, t, i, n), a(e, t, i, n, r, u, d, 2)) : 2 === c && h(e, t, i, n, r, u, d) : a(e, o(e, t), i, n, r, u, d, 1);
                    break
                }
            }
        }

        function s(e, t, i, n, r) {
            var o = t.prev.i,
                a = t.i,
                s = t.next.i,
                l = e[o],
                h = e[o + 1],
                u = e[a],
                d = e[a + 1],
                c = e[s],
                f = e[s + 1],
                p = l * d - h * u,
                g = l * f - h * c,
                _ = c * d - f * u,
                v = p - g - _;
            if (0 >= v) return !1;
            var y, b, x, w, M, T, S, C = f - h,
                E = l - c,
                k = h - d,
                L = u - l;
            if (void 0 !== i) {
                var P = u > l ? c > l ? l : c : c > u ? u : c,
                    A = d > h ? f > h ? h : f : f > d ? d : f,
                    R = l > u ? l > c ? l : c : u > c ? u : c,
                    D = h > d ? h > f ? h : f : d > f ? d : f,
                    I = m(P, A, i, n, r),
                    O = m(R, D, i, n, r);
                for (S = t.nextZ; S && S.z <= O;)
                    if (y = S.i, S = S.nextZ, y !== o && y !== s && (b = e[y], x = e[y + 1], w = C * b + E * x - g, w >= 0 && (M = k * b + L * x + p, M >= 0 && (T = v - w - M, T >= 0 && (w && M || w && T || M && T))))) return !1;
                for (S = t.prevZ; S && S.z >= I;)
                    if (y = S.i, S = S.prevZ, y !== o && y !== s && (b = e[y], x = e[y + 1], w = C * b + E * x - g, w >= 0 && (M = k * b + L * x + p, M >= 0 && (T = v - w - M, T >= 0 && (w && M || w && T || M && T))))) return !1
            } else
                for (S = t.next.next; S !== t.prev;)
                    if (y = S.i, S = S.next, b = e[y], x = e[y + 1], w = C * b + E * x - g, w >= 0 && (M = k * b + L * x + p, M >= 0 && (T = v - w - M, T >= 0 && (w && M || w && T || M && T)))) return !1;
            return !0
        }

        function l(e, t, i, n) {
            var r = t;
            do {
                var o = r.prev,
                    a = r.next.next;
                if (o.i !== a.i && b(e, o.i, r.i, r.next.i, a.i) && w(e, o, a) && w(e, a, o)) {
                    i.push(o.i / n), i.push(r.i / n), i.push(a.i / n), o.next = a, a.prev = o;
                    var s = r.prevZ,
                        l = r.nextZ && r.nextZ.nextZ;
                    s && (s.nextZ = l), l && (l.prevZ = s), r = t = a
                }
                r = r.next
            } while (r !== t);
            return r
        }

        function h(e, t, i, n, r, s, l) {
            var h = t;
            do {
                for (var u = h.next.next; u !== h.prev;) {
                    if (h.i !== u.i && _(e, h, u)) {
                        var d = T(h, u);
                        return h = o(e, h, h.next), d = o(e, d, d.next), a(e, h, i, n, r, s, l), void a(e, d, i, n, r, s, l)
                    }
                    u = u.next
                }
                h = h.next
            } while (h !== t)
        }

        function u(e, t, i, n) {
            var a, s, l, h, u, c = [];
            for (a = 0, s = t.length; s > a; a++) l = t[a] * n, h = s - 1 > a ? t[a + 1] * n : e.length, u = r(e, l, h, n, !1), u === u.next && (u.steiner = !0), u = o(e, u), u && c.push(g(e, u));
            for (c.sort(function(t, i) {
                    return e[t.i] - e[i.i]
                }), a = 0; a < c.length; a++) d(e, c[a], i), i = o(e, i, i.next);
            return i
        }

        function d(e, t, i) {
            if (i = c(e, t, i)) {
                var n = T(i, t);
                o(e, n, n.next)
            }
        }

        function c(e, t, i) {
            var n, r, o, a = i,
                s = t.i,
                l = e[s],
                h = e[s + 1],
                u = -(1 / 0);
            do {
                if (r = a.i, o = a.next.i, h <= e[r + 1] && h >= e[o + 1]) {
                    var d = e[r] + (h - e[r + 1]) * (e[o] - e[r]) / (e[o + 1] - e[r + 1]);
                    l >= d && d > u && (u = d, n = e[r] < e[o] ? a : a.next)
                }
                a = a.next
            } while (a !== i);
            if (!n) return null;
            var c, f, p, m, g, _, v = e[n.i],
                y = e[n.i + 1],
                b = l * y - h * v,
                x = l * h - h * u,
                M = h - h,
                T = l - u,
                S = h - y,
                C = v - l,
                E = b - x - (u * y - h * v),
                k = 0 >= E ? -1 : 1,
                L = n,
                P = 1 / 0;
            for (a = n.next; a !== L;) c = e[a.i], f = e[a.i + 1], p = l - c, p >= 0 && c >= v && (m = (M * c + T * f - x) * k, m >= 0 && (g = (S * c + C * f + b) * k, g >= 0 && E * k - m - g >= 0 && (_ = Math.abs(h - f) / p, P > _ && w(e, a, t) && (n = a, P = _)))), a = a.next;
            return n
        }

        function f(e, t, i, n, r) {
            var o = t;
            do null === o.z && (o.z = m(e[o.i], e[o.i + 1], i, n, r)), o.prevZ = o.prev, o.nextZ = o.next, o = o.next; while (o !== t);
            o.prevZ.nextZ = null, o.prevZ = null, p(o)
        }

        function p(e) {
            var t, i, n, r, o, a, s, l, h = 1;
            do {
                for (i = e, e = null, o = null, a = 0; i;) {
                    for (a++, n = i, s = 0, t = 0; h > t && (s++, n = n.nextZ, n); t++);
                    for (l = h; s > 0 || l > 0 && n;) 0 === s ? (r = n, n = n.nextZ, l--) : 0 !== l && n ? i.z <= n.z ? (r = i, i = i.nextZ, s--) : (r = n, n = n.nextZ, l--) : (r = i, i = i.nextZ, s--), o ? o.nextZ = r : e = r, r.prevZ = o, o = r;
                    i = n
                }
                o.nextZ = null, h *= 2
            } while (a > 1);
            return e
        }

        function m(e, t, i, n, r) {
            return e = 1e3 * (e - i) / r, e = 16711935 & (e | e << 8), e = 252645135 & (e | e << 4), e = 858993459 & (e | e << 2), e = 1431655765 & (e | e << 1), t = 1e3 * (t - n) / r, t = 16711935 & (t | t << 8), t = 252645135 & (t | t << 4), t = 858993459 & (t | t << 2), t = 1431655765 & (t | t << 1), e | t << 1
        }

        function g(e, t) {
            var i = t,
                n = t;
            do e[i.i] < e[n.i] && (n = i), i = i.next; while (i !== t);
            return n
        }

        function _(e, t, i) {
            return t.next.i !== i.i && t.prev.i !== i.i && !x(e, t, t.i, i.i) && w(e, t, i) && w(e, i, t) && M(e, t, t.i, i.i)
        }

        function v(e, t, i, n) {
            var r = (e[i + 1] - e[t + 1]) * (e[n] - e[i]) - (e[i] - e[t]) * (e[n + 1] - e[i + 1]);
            return r > 0 ? 1 : 0 > r ? -1 : 0
        }

        function y(e, t, i) {
            return e[t] === e[i] && e[t + 1] === e[i + 1]
        }

        function b(e, t, i, n, r) {
            return v(e, t, i, n) !== v(e, t, i, r) && v(e, n, r, t) !== v(e, n, r, i)
        }

        function x(e, t, i, n) {
            var r = t;
            do {
                var o = r.i,
                    a = r.next.i;
                if (o !== i && a !== i && o !== n && a !== n && b(e, o, a, i, n)) return !0;
                r = r.next
            } while (r !== t);
            return !1
        }

        function w(e, t, i) {
            return -1 === v(e, t.prev.i, t.i, t.next.i) ? -1 !== v(e, t.i, i.i, t.next.i) && -1 !== v(e, t.i, t.prev.i, i.i) : -1 === v(e, t.i, i.i, t.prev.i) || -1 === v(e, t.i, t.next.i, i.i)
        }

        function M(e, t, i, n) {
            var r = t,
                o = !1,
                a = (e[i] + e[n]) / 2,
                s = (e[i + 1] + e[n + 1]) / 2;
            do {
                var l = r.i,
                    h = r.next.i;
                e[l + 1] > s != e[h + 1] > s && a < (e[h] - e[l]) * (s - e[l + 1]) / (e[h + 1] - e[l + 1]) + e[l] && (o = !o), r = r.next
            } while (r !== t);
            return o
        }

        function T(e, t) {
            var i = new C(e.i),
                n = new C(t.i),
                r = e.next,
                o = t.prev;
            return e.next = t, t.prev = e, i.next = r, r.prev = i, n.next = i, i.prev = n, o.next = n, n.prev = o, n
        }

        function S(e, t) {
            var i = new C(e);
            return t ? (i.next = t.next, i.prev = t, t.next.prev = i, t.next = i) : (i.prev = i, i.next = i), i
        }

        function C(e) {
            this.i = e, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1
        }
        t.exports = n
    }, {}],
    10: [function(e, t, i) {
        "use strict";
        t.exports = {
            BinaryLoader: e("./src/model/BinaryLoader"),
            Color: e("./src/Color"),
            Constants: e("./src/Constants"),
            Geometry: e("./src/object/Geometry"),
            MathHelper: e("./src/utils/MathHelper"),
            Matrix4: e("./src/math/Matrix4"),
            Model: e("./src/model/Model"),
            Object3D: e("./src/object/Object3D"),
            OrthographicCamera: e("./src/camera/OrthographicCamera"),
            PerspectiveCamera: e("./src/camera/PerspectiveCamera"),
            Quaternion: e("./src/math/Quaternion"),
            Ray: e("./src/utils/Ray"),
            RenderEngine: e("./src/RenderEngine"),
            RenderTarget: e("./src/RenderTarget"),
            ShapeUtils: e("./src/utils/ShapeUtils"),
            SkeletonUtils: e("./src/utils/SkeletonUtils"),
            TriangulationUtils: e("./src/utils/TriangulationUtils"),
            VectorUtils: e("./src/utils/VectorUtils"),
            Vector2: e("./src/math/Vector2"),
            Vector3: e("./src/math/Vector3"),
            WebGLPerformanceCalculator: e("./src/utils/perfcalc/WebGLPerformanceCalculator"),
            OBJImporter: e("./src/model/OBJImporter")
        };
    }, {
        "./src/Color": 13,
        "./src/Constants": 14,
        "./src/RenderEngine": 17,
        "./src/RenderTarget": 18,
        "./src/camera/OrthographicCamera": 29,
        "./src/camera/PerspectiveCamera": 30,
        "./src/math/Matrix4": 60,
        "./src/math/Quaternion": 61,
        "./src/math/Vector2": 62,
        "./src/math/Vector3": 63,
        "./src/model/BinaryLoader": 64,
        "./src/model/Model": 65,
        "./src/model/OBJImporter": 67,
        "./src/object/Geometry": 68,
        "./src/object/Object3D": 70,
        "./src/utils/MathHelper": 78,
        "./src/utils/Ray": 79,
        "./src/utils/ShapeUtils": 80,
        "./src/utils/SkeletonUtils": 81,
        "./src/utils/TriangulationUtils": 82,
        "./src/utils/VectorUtils": 83,
        "./src/utils/perfcalc/WebGLPerformanceCalculator": 88
    }],
    11: [function(e, t, i) {
        function n(e) {
            return /BlackBerry/i.test(P(e)) || /BB10/i.test(P(e)) || /PlayBook/i.test(P(e)) || /RIM/i.test(P(e))
        }

        function r(e) {
            return n(e) && /mobile/i.test(P(e))
        }

        function o(e) {
            return n(e) && /tablet/i.test(P(e))
        }

        function a(e) {
            return /android/i.test(P(e))
        }

        function s(e) {
            return a(e) && /mobi/i.test(P(e))
        }

        function l(e) {
            return /Windows Phone/i.test(P(e))
        }

        function h(e) {
            return /iPhone/i.test(P(e))
        }

        function u(e) {
            return h(e) || p(e) || s(e) || l(e) || r(e)
        }

        function d(e) {
            return a(e) && (!/mobile/i.test(P(e)) || /SCH-I800/i.test(P(e)) || /Xoom/i.test(P(e)))
        }

        function c(e) {
            return /Silk/i.test(P(e))
        }

        function f(e) {
            return /iPad/i.test(P(e))
        }

        function p(e) {
            return /iPod/i.test(P(e))
        }

        function m(e) {
            return f(e) || d(e) || o(e) || c(e)
        }

        function g(e) {
            return f(e) || h(e) || p(e)
        }

        function _() {
            var e = document.createElement("canvas");
            return null != v(e)
        }

        function v(e, t) {
            for (var i = ["webgl", "experimental-webgl", "moz-webgl", "webkit-3d"], n = null, r = 0; r < i.length; r++) try {
                if (n = e.getContext(i[r], t)) break
            } catch (o) {}
            return n
        }

        function y(e) {
            if (g(e)) {
                var t = b(P(e));
                if (t && t.major && t.major >= 6) return !0
            }
            return !1
        }

        function b(e) {
            var t = / OS ([0-9_]+)/i.exec(P(e));
            return t ? {
                major: t[1].split("_")[0],
                minor: t[1].split("_")[1],
                full: t[1]
            } : null
        }

        function x(e) {
            var t = / Android ([0-9.]+)/i.exec(P(e));
            return t ? {
                major: t[1].split(".")[0],
                minor: t[1].split(".")[1],
                full: t[1]
            } : null
        }

        function w() {
            var e = ["VERSION", "VENDOR", "RENDERER", "SHADING_LANGUAGE_VERSION"],
                t = {
                    supported: !1
                };
            if ("object" == typeof Ejecta) return t.ejecta = !0, t;
            var i = document.createElement("canvas"),
                n = v(i);
            return n && (t.supported = !0, A.each(e, function(e) {
                t[e] = n.getParameter(n[e])
            })), t
        }

        function M(e) {
            return /firefox\//i.test(P(e))
        }

        function T(e) {
            return /chrome\//i.test(P(e))
        }

        function S(e) {
            return /MSIE/i.test(P(e)) || /Trident/i.test(P(e))
        }

        function C(e) {
            return /(Windows (?:NT 5\.2|NT 5\.1))/.test(P(e))
        }

        function E(e) {
            return /bot|crawler|spider|robot|crawling|slurp|snippet|externalhit/i.test(P(e))
        }

        function k(e) {
            e = e.toLowerCase();
            var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || [];
            return {
                browser: t[1] || "",
                version: t[2] || "0"
            }
        }

        function L(e) {
            var t = k(P(e)),
                i = {};
            return t.browser && (i[t.browser] = !0, i.version = t.version), i.chrome ? i.webkit = !0 : i.webkit && (i.safari = !0), i
        }

        function P(e) {
            return null == e && "undefined" != typeof navigator ? navigator.userAgent : e
        }
        var A = e("underscore");
        t.exports = {
            isMobile: u,
            isTablet: m,
            isAndroid: a,
            isIOS: g,
            supportWebGL: _,
            getWebGlContext: v,
            supportIosNativeScroll: y,
            detectWebGL: w,
            isFirefox: M,
            isGoogleChrome: T,
            isMSIE: S,
            isWindowsXP: C,
            isBot: E,
            getBrowser: L,
            getIOSVersion: b,
            getAndroidVersion: x
        }
    }, {
        underscore: 207
    }],
    12: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this._renderEngine = e, this._getShadowMapBoundsCallback = i, this._shadowMapSize = t, this._renderEngine.conf.get("shadows.debugShadowMap") && (this._textureViewer = new d(this._renderEngine)), this._splitQuantity = this._renderEngine.conf.get("shadows.csm.splitQuantity"), this._renderTargetSize = {
                height: 0,
                width: 0
            }, this.createSplits(), this.constructRenderTarget(), this._depthMaterials = null, this._clearColor = new r(16777215), this._debugClearColor = new r(2004318071, !0), this.isDirty = !0, this.isEnabled = !0
        }
        var r = e("./Color"),
            o = e("./math/Matrix4"),
            a = e("./camera/OrthographicCamera"),
            s = e("./camera/PerspectiveCamera"),
            l = e("./Constants"),
            h = e("./RenderTarget"),
            u = e("./math/Vector3"),
            d = e("./texture/TextureViewer");
        e("./utils/polyfills"), t.exports = n;
        var c = [new u(-1, -1, -1), new u(-1, 1, -1), new u(1, 1, -1), new u(1, -1, -1), new u(-1, -1, 1), new u(-1, 1, 1), new u(1, 1, 1), new u(1, -1, 1)],
            f = new u;
        n.prototype.createSplits = function() {
            var e = this._shadowMapSize,
                t = this._renderEngine._webGL._maxTextureSize;
            if (e > t) return void console.warn("not enough max texture size to use cascading shadows");
            this._splits = [];
            for (var i = 0, n = 0, r = 0, o = 0, a = 0; a < this._splitQuantity; a++) {
                var s = this.getSplit(i, n);
                r = Math.max(i + 1, r), o = Math.max(n + 1, o), this.setShadowMatrixUniform(s, a), this._splits.push(s), a < this._splitQuantity - 1 && (n++, n * e + e > t && (n = 0, i++, i * e + e > t && console.error("max texture size reached, %s split remains to add", this._splitQuantity - (a + 1))))
            }
            var l = r * this._shadowMapSize,
                h = o * this._shadowMapSize;
            this._renderTargetSize.width = l, this._renderTargetSize.height = h, this._renderEngine.getShaderLibrary().uniforms.csmShadows.shadowTextureSize.value.set(l, h), this.setSplitsUVRect(r, o)
        }, n.prototype.setShadowMatrixUniform = function(e, t) {
            this._renderEngine.getShaderLibrary().uniforms.csmShadows.shadowMatrix[t].value = e.shadowMatrix
        }, n.prototype.setSplitsUVRect = function(e, t) {
            for (var i = 0; i < this._splitQuantity; i++) {
                var n = this._splits[i].splitPosition,
                    r = n.x / e,
                    o = n.y / t,
                    a = r + 1 / e,
                    s = o + 1 / t;
                this._renderEngine.getShaderLibrary().uniforms.csmShadows.splitUVRect[i].value.set(r, o, a, s)
            }
        }, n.prototype.getSplit = function(e, t) {
            for (var i = {
                    splitPosition: {
                        x: e,
                        y: t
                    },
                    viewport: {
                        x: e * this._shadowMapSize,
                        y: t * this._shadowMapSize,
                        width: this._shadowMapSize,
                        height: this._shadowMapSize
                    },
                    near: 0,
                    far: 0,
                    shadowMatrix: new o,
                    shadowCamera: new a(-1, 1, -1, 1, -1, 1),
                    frustumCamera: new s(45, 1, 1, 100),
                    inverseViewProjectionMatrix: new o,
                    frustumPoints: []
                }, n = 0; 8 > n; n++) i.frustumPoints[n] = new u;
            return i
        }, n.prototype.destruct = function() {
            null != this._shadowMapRenderTarget && (this._renderEngine._webGL.deallocateRenderTarget(this._shadowMapRenderTarget), delete this._shadowMapRenderTarget), this._textureViewer && (this._renderEngine._webGL.deallocateRenderTarget(this._debugShadowRenderTarget), delete this._debugShadowRenderTarget, delete this._textureViewer)
        }, n.prototype.constructRenderTarget = function() {
            var e = {
                depthBuffer: !0,
                format: l.RGBAFormat,
                magFilter: l.LinearFilter,
                minFilter: l.LinearFilter,
                generateMipmaps: !1
            };
            if (this._shadowMapRenderTarget = new h(this._renderTargetSize.width, this._renderTargetSize.height, e), this._renderEngine._shaderLibrary.uniforms.csmShadows.shadowTexture.texture = this._shadowMapRenderTarget, this._textureViewer) {
                this._debugShadowRenderTarget = new h(this._renderTargetSize.width, this._renderTargetSize.height, e);
                var t = this._renderTargetSize.width / 16,
                    i = this._renderTargetSize.height / 16,
                    n = {
                        x: 32,
                        y: 32,
                        width: t,
                        height: i
                    },
                    r = {
                        x: 64 + t,
                        y: 32,
                        width: t,
                        height: i
                    },
                    o = {
                        materialName: "depthDebug",
                        textureUniformName: "depthTexture"
                    };
                this._textureViewer.addTexture("shadow", this._shadowMapRenderTarget, n, o), this._textureViewer.addTexture("debugShadow", this._debugShadowRenderTarget, r)
            }
        }, n.prototype.updateShadowMatrix = function(e) {
            for (var t = 0; t < this._splitQuantity; t++) this._updateShadowMatrixWithIndex(t, e)
        }, n.prototype._updateShadowMatrixWithIndex = function(e, t) {
            var i = this._splits[e],
                n = this._shadowMapSize / this._renderTargetSize.width,
                r = this._shadowMapSize / this._renderTargetSize.height,
                o = i.viewport.x / this._renderTargetSize.width,
                a = i.viewport.y / this._renderTargetSize.height,
                s = [.5 * n, 0, 0, .5 * n + o, 0, .5 * r, 0, .5 * r + a, 0, 0, .5, .5, 0, 0, 0, 1];
            if (this._renderEngine._shadow && this.isEnabled) {
                i.shadowMatrix.set(s[0], s[1], s[2], s[3], s[4], s[5], s[6], s[7], s[8], s[9], s[10], s[11], s[12], s[13], s[14], s[15]), i.shadowMatrix.multiplySelf(i.shadowCamera.projScreenMatrix);
                var l = t.matrixWorld;
                i.shadowMatrix.multiplySelf(l)
            }
        }, n.prototype.clear = function() {
            this._shadowMapRenderTarget && this._renderEngine._webGL.setAndClearRenderTarget(this._shadowMapRenderTarget, this._clearColor, {
                updateViewportDisabled: !0
            })
        }, n.prototype.updateShadowMap = function(e, t) {
            this._depthMaterials || (this._depthMaterials = this._renderEngine.getDepthMaterials());
            var i = {
                updateViewportDisabled: !0
            };
            if (this.isDirty && (this.isDirty = !1, this._textureViewer && this._renderEngine._webGL.setAndClearRenderTarget(this._debugShadowRenderTarget, this._debugClearColor, i), this._renderEngine._webGL.setAndClearRenderTarget(this._shadowMapRenderTarget, this._clearColor, i), this.isEnabled)) {
                var n = this._renderEngine._webGL.getCurrentViewPort(),
                    r = this.calculateFrustumNearFar(t);
                this.calculateFrustumSplits(r.near, r.far, t);
                var o = this._renderEngine.conf.get("shadows.csm.bias");
                this._renderEngine.getShaderLibrary().uniforms.csmShadows.shadowBias.value = o;
                for (var a = 0; a < this._splitQuantity; a++) {
                    var s = this._splits[a];
                    this.updateFrustumPoints(a, t), this.calculateShadowMatrix(a, t);
                    var l = s.viewport;
                    this._renderEngine._webGL.setViewportRectangle(l.x, l.y, l.width, l.height), this._renderEngine._webGL.setScissor(l), this._renderEngine._webGL.setCamera(s.shadowCamera), this._renderEngine._webGL.renderObjects(e.sortedObjects, this._depthMaterials, "shadowDepth", !1), this._textureViewer && (this._renderEngine._webGL.setRenderTarget(this._debugShadowRenderTarget, i), this._renderEngine._webGL.renderObjects(e.sortedObjects, null, "shadowDepth", !1), this._renderEngine._webGL.setRenderTarget(this._shadowMapRenderTarget, i))
                }
                this._renderEngine._webGL.setViewportRectangle(n.x, n.y, n.width, n.height), this._renderEngine._webGL.setScissor(null)
            }
        }, n.prototype.calculateFrustumNearFar = function(e) {
            var t = this._renderEngine.conf.get("shadows.csm.maxFar"),
                i = e.near,
                n = this._renderEngine.conf.get("shadows.csm.minFar"),
                r = this._getShadowMapBoundsCallback(t),
                o = r.zMin,
                a = Math.min(e.position.z - o, 200) / 200;
            t = n + t * a;
            var s = r.camBounds,
                l = s[0],
                h = s[3],
                u = e.position.clone(),
                d = Math.cos(e.fov * Math.PI / 180);
            return f.set(h.x, h.y, h.z), f.subSelf(u), n = Math.max(n, f.length() * d * 1.05), t = Math.min(n, t), 0 != r.zMin && (a = Math.min(.7, a)), f.set(l.x, l.y, o), f.subSelf(u), i = Math.max(i, a * f.length()) * d, i = Math.min(u.z - o, i), {
                near: i,
                far: t
            }
        }, n.prototype.calculateFrustumSplits = function(e, t, i) {
            var n, r = this._renderEngine.conf.get("shadows.csm.splitWeight"),
                o = this._renderEngine.conf.get("shadows.csm.overlapRatio");
            for (n = 0; n < this._splitQuantity; n++) {
                var a = this._splits[n];
                a.near = e, a.far = t;
                var s = Math.min(e + Math.max(2e3, .5 * t), t),
                    l = s / e;
                if (n > 0) {
                    var h = n / this._splitQuantity,
                        u = r * (e * Math.pow(l, h)) + (1 - r) * (e + (s - e) * h);
                    a.near = u, this._splits[n - 1].far = u * o
                }
            }
            for (n = 0; n < this._splitQuantity; n++) {
                var d = i.projectionMatrix.n33,
                    c = i.projectionMatrix.n34,
                    f = .5 * (-this._splits[n].far * d + c) / this._splits[n].far + .5;
                this._renderEngine.getShaderLibrary().uniforms.csmShadows.splitFarDist[n].value = f
            }
        }, n.prototype.updateFrustumPoints = function(e, t) {
            var i = this._splits[e],
                n = i.frustumCamera;
            n.near = i.near, n.far = i.far, n.fov = t.fov, n.aspect = t.aspect, n.position.copy(t.position), n.up.copy(t.up), n.lookAt(t.target), n.updateMatrix();
            var r = this._splits[e].inverseViewProjectionMatrix;
            r.getInverse(n.projScreenMatrix);
            for (var o = this._splits[e].frustumPoints, a = 0; 8 > a; a++) o[a].copy(c[a]), r.multiplyVector3(o[a])
        }, n.prototype.calculateShadowMatrix = function(e, t) {
            var i, n, r = this._renderEngine._shaderLibrary.uniforms.light.vLightDir.value,
                o = this._splits[e],
                a = o.frustumPoints,
                s = a[0].x,
                l = a[0].x,
                h = a[0].y,
                d = a[0].y,
                c = a[0].z,
                f = a[0].z;
            for (i = 1; 8 > i; i++) n = a[i], s = Math.min(n.x, s), h = Math.min(n.y, h), c = Math.min(n.z, c), l = Math.max(n.x, l), d = Math.max(n.y, d), f = Math.max(n.z, f);
            var p = new u(.5 * (s + l), .5 * (h + d), .5 * (c + f)),
                m = o.shadowCamera;
            for (m.position.copy(p), m.up.copy(r), m.up.z = 0, m.up.normalizeIfNotZero(), m.lookAt(p.subSelf(r)), m.left = -1, m.right = 1, m.top = 1, m.bottom = -1, m.near = -1, m.far = 1, m.updateMatrix(), l = -(1 / 0), d = -(1 / 0), f = -(1 / 0), s = 1 / 0, h = 1 / 0, c = 1 / 0, i = 0; 8 > i; i++) n = a[i], m.projScreenMatrix.multiplyVector3(n), l = Math.max(n.x, l), d = Math.max(n.y, d), f = Math.max(n.z, f), s = Math.min(n.x, s), h = Math.min(n.y, h), c = Math.min(n.z, c);
            var g = this._renderEngine.conf.get("shadows.csm.shadowProjectionNearExtend");
            m.left = s, m.right = l, m.top = d, m.bottom = h, m.near = c - g, m.far = f + 1e3, m.updateMatrix(), this._updateShadowMatrixWithIndex(e, t)
        }
    }, {
        "./Color": 13,
        "./Constants": 14,
        "./RenderTarget": 18,
        "./camera/OrthographicCamera": 29,
        "./camera/PerspectiveCamera": 30,
        "./math/Matrix4": 60,
        "./math/Vector3": 63,
        "./texture/TextureViewer": 77,
        "./utils/polyfills": 95
    }],
    13: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            return this.setRGBA(1, 1, 1, 1), null != e && this.set(e, t), this
        }
        var r = e("underscore"),
            o = e("underscore.string"),
            a = e("onecolor"),
            s = e("./utils/MathHelper");
        t.exports = n;
        var l = {
                red: "#994545",
                black: "#333333",
                green: "#55C29A",
                lightgreen: "#A6EDC7",
                grey: "#A0A0A0",
                gray: "#A0A0A0",
                darkgrey: "#6E6E6E",
                darkgray: "#6E6E6E",
                blue: "#3150CC",
                lightblue: "#ADD8E6",
                white: "#EDEDED",
                yellow: "#DFE88B",
                brown: "#916A49",
                greybrown: "#91857D",
                orange: "#E3AE78",
                pink: "#DFAAE3",
                sand: "#C2B280",
                lightsteelblue: "#B0C4DE",
                rose: "#FBCCE7",
                carmine: "#960018",
                redcarmine: "#960018"
            },
            h = {
                plaster: "#f2f2f2",
                brick: "#B5653A",
                wood: "#e1b681",
                concrete: "#BCBABB",
                glas: "#CCEBE8",
                stone: "#E8E8E8",
                metal: "#C5C7CC",
                mdf: "#b0a1a4",
                timberframing: "#e1b681",
                asphalt: "#969696",
                rooftile: "#845B3D",
                copper: "#799680",
                slate: "#333E4F",
                tarpaper: "#707175",
                gras: "#A2C25C",
                gravel: "#64635f",
                eternit: "#a9aba6",
                thatch: "#7c6e61",
                plant: "#A2C25C",
                tin: "#7c7c7a",
                cementblock: "#cecbd4",
                marble: "#d5d7e6",
                sandstone: "#c5ad91",
                acsheet: "#d5dad6",
                asbesto: "#d5dfe9",
                zink: "#759796",
                gold: "#FFE205",
                silver: "#C0C0C0",
                hdf: "#9a662c",
                roofingfelt: "#323136",
                mirror: "#ffffff",
                plate: "#e89b71",
                steel: "#898989",
                stainlesssteel: "#B0B0B0",
                tile: "#D39F70"
            };
        n.fromString = function(e) {
            e = o.trim(e.toLowerCase()).replace(/[_ ]/g, "");
            var t = e.split(";")[0],
                i = l[t];
            if (null == i) {
                var r = e.replace(/s$/, "").split(";")[0];
                i = h[r]
            }
            var s = a(i || t);
            return s ? (new n).setRGBA(s.red(), s.green(), s.blue(), 1) : null
        }, n.prototype = {
            constructor: n,
            r: 1,
            g: 1,
            b: 1,
            a: 1,
            copy: function(e) {
                return this.r = e.r, this.g = e.g, this.b = e.b, this.a = e.a, this
            },
            setRGB: function(e, t, i) {
                return this.r = e, this.g = t, this.b = i, this
            },
            setRGBA: function(e, t, i, n) {
                return this.r = e, this.g = t, this.b = i, this.a = n, this
            },
            random: function() {
                this.setRGB(Math.random(), Math.random(), Math.random())
            },
            mix: function(e, t) {
                return this.r = s.lerp(this.r, e.r, t), this.g = s.lerp(this.g, e.g, t), this.b = s.lerp(this.b, e.b, t), this
            },
            setString: function(e) {
                var t = a(e);
                return !1 === t ? (console.warn("unknown color string", e), !1) : (this.r = t.red(), this.g = t.green(), this.b = t.blue(), !0)
            },
            equals: function(e) {
                return this.r == e.r && this.g == e.g && this.b == e.b && this.a == e.a
            },
            getHex: function() {
                return Math.floor(255 * this.r) << 16 ^ Math.floor(255 * this.g) << 8 ^ Math.floor(255 * this.b)
            },
            setHexRGBA: function(e) {
                return e = Math.floor(e), this.r = (e >> 24 & 255) / 255, this.g = (e >> 16 & 255) / 255, this.b = (e >> 8 & 255) / 255, this.a = (255 & e) / 255, this
            },
            setHex: function(e) {
                return e = Math.floor(e), this.r = (e >> 16 & 255) / 255, this.g = (e >> 8 & 255) / 255, this.b = (255 & e) / 255, this
            },
            set: function(e, t) {
                r.isNumber(e) ? t ? this.setHexRGBA(e) : this.setHex(e) : r.isString(e) && this.setString(e)
            },
            clone: function() {
                return (new n).setRGBA(this.r, this.g, this.b, this.a)
            }
        }
    }, {
        "./utils/MathHelper": 78,
        onecolor: 150,
        underscore: 207,
        "underscore.string": 206
    }],
    14: [function(e, t, i) {
        "use strict";
        t.exports = {
            Opaque: 0,
            Mask: 1,
            Gradual: 2,
            SuperGradual: 4,
            POINTS: 1,
            LINES: 2,
            TRIANGLES: 3,
            FRONT: 0,
            BACK: 1,
            KEEP: 0,
            REPLACE: 1,
            INCR: 2,
            EQUAL: 0,
            ALWAYS: 1,
            NOTEQUAL: 2,
            NoBlending: 0,
            NormalBlending: 1,
            AdditiveAlphaBlending: 2,
            MultiplyBlending: 3,
            AdditiveAllBlending: 4,
            RepeatWrapping: 0,
            ClampToEdgeWrapping: 1,
            MirroredRepeatWrapping: 2,
            NearestFilter: 3,
            NearestMipMapNearestFilter: 4,
            NearestMipMapLinearFilter: 5,
            LinearFilter: 6,
            LinearMipMapNearestFilter: 7,
            LinearMipMapLinearFilter: 8,
            ByteType: 9,
            UnsignedByteType: 10,
            ShortType: 11,
            UnsignedShortType: 12,
            IntType: 13,
            UnsignedIntType: 14,
            FloatType: 15,
            AlphaFormat: 16,
            RGBFormat: 17,
            RGBAFormat: 18,
            LuminanceFormat: 19,
            LuminanceAlphaFormat: 20
        }
    }, {}],
    15: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this._renderEngine = t, this._webGL = this._renderEngine._webGL, this._depthMaterials = this._renderEngine.getDepthMaterials(), this.conf = e, this.width = i.width, this.height = i.height, this.clearColor = new l(0), this._isEnabled = !0, this._depthMapMaterials = {}, this._textureViewer = new s(this._renderEngine), this._onResized()
        }
        var r = e("underscore"),
            o = e("./Constants"),
            a = e("./RenderTarget"),
            s = e("./texture/TextureViewer"),
            l = e("./Color");
        t.exports = n, n.prototype.render = function(e) {
            this._webGL.setAndClearRenderTarget(this._rtDepthMap, this.clearColor), this._renderObjects(e), this._webGL.setRenderTarget(), this._webGL.setRightViewPort()
        }, n.prototype._renderObjects = function(e) {
            for (var t = e.sortedObjects, i = 0; i !== t.length; ++i) {
                var n = t[i];
                if (n.visible && n.material.visible) {
                    var r = this._getDepthMapMaterials(n.material);
                    this._webGL.renderObject(n, r)
                }
            }
        }, n.prototype._getDepthMapMaterials = function(e) {
            var t = e.effectName,
                i = this._depthMapMaterials[t];
            return i || (i = this._renderEngine.createMaterial(t + "_depthMap", o.NoBlending), this._depthMapMaterials[t] = i), r.extend(i.uniforms, e.uniforms), this._webGL._currentMaterialId == i.id && this._webGL.setMaterial(null), i
        }, n.prototype.destruct = function() {
            this._rtDepthMap && (this._renderEngine.releaseRenderTarget(this._rtDepthMap), delete this._rtDepthMap), this._textureViewer && (this._textureViewer.onDivRemoved(), delete this._textureViewer), this._depthMapMaterials = null
        }, n.prototype.resize = function(e) {
            this.width = e.w, this.height = e.h, this._onResized()
        }, n.prototype._onResized = function() {
            var e = this._webGL.getViewSize(),
                t = {
                    depthBuffer: !0,
                    format: o.RGBAFormat,
                    minFilter: o.NearestFilter,
                    magFilter: o.NearestFilter
                };
            this._rtDepthMap ? (this._renderEngine.releaseRenderTarget(this._rtDepthMap), this._rtDepthMap.width = this.width, this._rtDepthMap.height = this.height) : this._rtDepthMap = new a(e.width, e.height, t);
            var i = "DepthMapTextureView";
            this._textureViewer.removeTexture(i);
            var n = this._renderEngine.createMaterial("depthMap", o.NoBlending);
            n.depthTest = !1, n.depthWrite = !1;
            var r = {
                    x: 0,
                    y: 0,
                    width: e.width,
                    height: e.height
                },
                s = {
                    materialName: "depthMap",
                    textureUniformName: "depthTexture",
                    uvArrayQuad: [0, 0, 1, 0, 0, 1, 1, 1]
                };
            this.textureViewDepthMap = this._textureViewer.addTexture(i, this._rtDepthMap, r, s)
        }, n.prototype.setCamera = function(e) {
            var t = e.tilt;
            .9 == t ? this.textureViewDepthMap.material.uniforms.nearFar.value.z = 127 : (this.textureViewDepthMap.material.uniforms.nearFar.value.y = e.target.distanceTo(e.position), this.textureViewDepthMap.material.uniforms.nearFar.value.z = 0), this.textureViewDepthMap.material.uniforms.minMaxColor.value.x = this.conf.get("minColorDepthMap"), this.textureViewDepthMap.material.uniforms.minMaxColor.value.y = this.conf.get("maxColorDepthMap")
        }, n.prototype.setEnabled = function(e) {
            this._isEnabled = e
        }, n.prototype.isEnabled = function() {
            return this._isEnabled
        }, n.prototype.onDivRemoved = function() {
            this.destruct(), delete this._renderEngine, delete this._webGL
        }
    }, {
        "./Color": 13,
        "./Constants": 14,
        "./RenderTarget": 18,
        "./texture/TextureViewer": 77,
        underscore: 207
    }],
    16: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._renderEngine = e, this._webGL = e._webGL, this.reflectRate = t.reflectRate || .5, this.writeStencilMaterial = this._renderEngine.createMaterial(t.writeStencilMaterialName), this.writeStencilMaterial.depthWrite = !1, this.writeStencilMaterial.isList = !1;
            var i = this._renderEngine.getShadowExtensionName();
            this.invertZMaterials = {
                isList: !0,
                "default": this._renderEngine.createMaterial("dirlight_invertZ" + i, r.NormalBlending)
            };
            for (var n = ["texture", "skinning", "texture_skinning", "miniSkinning", "texture_miniSkinning", "heightCropping", "texture_heightCropping", "texture_envmap_heightCropping", "envmap", "texture_envmap"], o = 0; o < n.length; ++o) {
                var a = n[o],
                    s = "dirlight_invertZ" + i + "_" + a;
                this.invertZMaterials[a] = this._renderEngine.createMaterial(s, r.NormalBlending)
            }
        }
        var r = e("./Constants");
        t.exports = n, n.prototype.destruct = function() {
            this._renderEngine.releaseMaterial(this.writeStencilMaterial);
            for (var e = ["default", "texture", "skinning", "texture_skinning", "miniSkinning", "texture_miniSkinning"], t = 0; t < e.length; ++t) this._renderEngine.releaseMaterial(this.invertZMaterials[e[t]])
        }, n.prototype.render = function(e) {
            var t = 1;
            this._webGL.setRenderTarget(null), this._webGL.setStencilFunction(t, r.ALWAYS, r.REPLACE), this._webGL.setColorWrite(!1), this._webGL.renderObjects(e.sortedObjects, this.writeStencilMaterial, "reflector", !1), this._webGL.clearDepth();
            var i = this._renderEngine.getShaderLibrary();
            i.uniforms.globalAlpha.fAlpha.value = this.reflectRate, this._webGL.setCullFace(r.FRONT), this._webGL.setStencilFunction(t, r.EQUAL, null);
            for (var n = ["default", "texture", "skinning", "texture_skinning", "miniSkinning", "texture_miniSkinning"], o = 0; o < n.length; ++o) this.invertZMaterials[n[o]].depthWrite = !0, this.invertZMaterials[n[o]].blending = r.NoBlending;
            this._webGL.renderObjects(e.sortedObjects, this.invertZMaterials, "reflected", !1), this._webGL.setColorWrite(!0), this._webGL.setStencilFunction(t, r.EQUAL, r.INCR);
            for (var a = 0; a < n.length; ++a) this.invertZMaterials[n[a]].depthWrite = !1, this.invertZMaterials[n[a]].blending = r.NormalBlending;
            this._webGL.renderObjects(e.sortedObjects, this.invertZMaterials, "reflected", !1), this._webGL.setCullFace(r.BACK), i.uniforms.globalAlpha.fAlpha.value = 1, this._webGL.setStencilFunction(null), this._webGL.setColorWrite(!0)
        }
    }, {
        "./Constants": 14
    }],
    17: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.parameters = t, t.forceRenderCallback = r.bind(this.forceRender, this), this._webGL = new c(t), a.call(this), this.setMaxListeners(0), this._supportNegativeViewportOffset = t.supportNegativeViewportOffset, this._lastRender = this._lastAnimate = Date.now(), this.minDT = t.minDT, this._forceDT = t.forceDT, this._dt = 0, this._renderingEnabled = !0, this._currentTime = null, this._needRender = !0, this._canRender = !0, this._pickingRenderTarget = null, this._meshCache = [], this._depthMaterials = null, this._scene = new p, this.camera = null, this.conf = e, this._shadow = !1, this._preZ = !1, this._minDTEnabled = !0, this._animateCallback = r.bind(this._animate, this), this._serverConfig = t.serverConfig, this._shaderLibrary = new f(e);
            var i = {
                renderEngine: this,
                textureUnloadPeriod: t.textureUnloadPeriod,
                textureCacheSize: e.textureCacheSize
            };
            this._textureHandler = new h(i), this.bindDelegateFunction(this._textureHandler, ["createTexture", "createAtlas", "packAndGetIndexFromAtlas", "getTexture", "handlePreloadedTexture", "handlePreloadedTextureNow", "askTextureToServer", "askTextureToServerWithImage", "loadCompressedTexture", "loadTexture", "abortLoadingTexture", "releaseTexture", "unloadTexture"]), this._shaderHandler = new u(e, this, this._shaderLibrary), t.initShaders(e, this._shaderLibrary), this.bindDelegateFunction(this._shaderHandler, ["createMaterial", "releaseMaterial", "getDebugMaterial"]), null != this.parameters.depthMap ? this.setDepthMap(this.parameters.depthMap) : null != this.parameters.sideBySide ? this.setSideBySide(this.parameters.sideBySide) : null != this.parameters.topToBottom && this.setTopToBottom(this.parameters.topToBottom), this.setSSAO(t.ssao), this.setShadow(t.shadow, !0), this.setPreZ(t.preZ), this.setWaterRipple(t.waterRipple), this.setWaterReflection(t.waterReflection), this._quad = this.createMesh(s.createUnitPlane(), this.createMaterial("renderTexture", l.NoBlending)), this._quad.geometry.clearOnWebglLoad = !0, this._webGL.updateObject(this._quad), this._shaderHandler.rebuildShader(), this._startBuildShaders()
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("events").EventEmitter,
            s = e("./utils/TriangulationUtils"),
            l = e("./Constants"),
            h = e("./texture/TextureHandler"),
            u = e("./material/ShaderHandler"),
            d = e("./material/ShaderUtils"),
            c = e("./WebGLRenderer"),
            f = e("./material/ShaderLibrary"),
            p = e("./object/Scene"),
            m = e("./object/Mesh"),
            g = e("./ShadowEngine"),
            _ = e("./CSMShadowEngine"),
            v = e("./SSAOutline"),
            y = e("./MirrorEffect"),
            b = e("./RenderTarget");
        e("./utils/requestAnimationFramePolyfill");
        var x = e("./DepthMap"),
            w = e("./camera/PerspectiveCamera");
        t.exports = n;
        var M = 100;
        o.inherits(n, a), n.prototype._startBuildShaders = function() {
            this._webGL.endBuildPrograms(M), this._buildShadersHandle = setTimeout(r.bind(this._startBuildShaders, this))
        }, n.prototype._stopBuildShaders = function() {
            null != this._buildShadersHandle && (clearTimeout(this._buildShadersHandle), this._buildShadersHandle = null)
        }, n.prototype.setPreZ = function(e) {
            this._preZ != e && (this._preZ = e, this._SSAOutline && this._SSAOutline.setHandlePreZ(e))
        }, n.prototype.setSSAO = function(e) {
            this._ssao != e && (this._ssao = e, e ? this.enableSSAO(this._preZ) : this.disableSSAO(), this.setSSAOutlineEnabled(e))
        }, n.prototype.setShadow = function(e, t) {
            this._shadow != e && (this._shadow = e, e ? this.enableShadows() : this.disableShadows(), t || this._shaderHandler.rebuildShader())
        }, n.prototype.setShadowOptions = function(e, t) {
            var i = this.conf.get("shadows")[e];
            i != t && (this.conf.get("shadows")[e] = t || !1, this._shadow = !1, this.disableShadows(), this.destroyShadowEngine(), this.rebuildDepthMaterials(), this.setShadow(!0))
        }, n.prototype.rebuildDepthMaterials = function() {
            this.destroyDepthMaterials(), this.buildDepthMaterials()
        }, n.prototype.disableShadows = function() {
            this._shadowEngine && (this._shadowEngine.isEnabled = !1)
        }, n.prototype.setWaterReflection = function(e) {
            this._waterReflection != e && (this._waterReflection = e, e ? this.enableWaterReflection() : this.disableWaterReflection())
        }, n.prototype.setWaterRipple = function(e) {
            this._waterRippleEnabled != e && (this._waterRippleEnabled = e, this._waterReflection && this.enableWaterReflection())
        }, n.prototype.enableWaterReflection = function() {
            if (this._webGL.stencilAvailable) {
                var e = {
                    writeStencilMaterialName: this.getGroundStencilShaderName(),
                    reflectRate: this.conf.environment.waterReflectRate
                };
                this.setMirrorEffect(e)
            } else this.setMirrorEffect(null)
        }, n.prototype.getGroundStencilShaderName = function() {
            var e = "groundForStencil";
            return this._waterRippleEnabled && (e += "_waterRipple"), e
        }, n.prototype.disableWaterReflection = function() {
            this.setMirrorEffect(null)
        }, n.prototype.enableShadows = function() {
            if (!this._shadowEngine) {
                var e = this.conf.get("shadows.useCsm") ? _ : g;
                this._shadowEngine = new e(this, this.conf.shadows.size, this.parameters.getShadowMapBoundsCallback)
            }
            this._shadowEngine.isEnabled = !0
        }, n.prototype.setSideBySide = function(e) {
            this._sideBySide != e && (this._sideBySide = e, this._webGL.setSideBySide(e), this._webGL.setDefaultStates(), this.setSize(this._webGL.getSize()))
        }, n.prototype.setTopToBottom = function(e) {
            this._topToBottom != e && (this._topToBottom = e, this._webGL.setTopToBottom(e), this._webGL.setDefaultStates(), this.setSize(this._webGL.getSize()))
        }, n.prototype.setDepthMap = function(e) {
            if (this._depthMap != e) {
                if (this._depthMapRenderer && (this._depthMapRenderer.destruct(), this._depthMapRenderer = null), e) {
                    var t = this._webGL.getViewSize();
                    this._depthMapRenderer = new x(this.conf, this, t)
                }
                this._depthMap = e, this._webGL.setDepthMap(e), this._webGL.setDefaultStates(), this.setSize(this._webGL.getSize())
            }
        }, n.prototype.enableSSAO = function(e) {
            if (!this._SSAOutline) {
                var t = this._webGL.getViewSize();
                this._SSAOutline = new v(this.conf, this, t)
            }
            this._SSAOutline.setHandlePreZ(e)
        }, n.prototype.disableSSAO = function() {
            this._SSAOutline && (this._SSAOutline.destruct(), delete this._SSAOutline, this._SSAOutline = null)
        }, n.prototype.setCamera = function(e) {
            e != this.camera && (this._shaderLibrary.uniforms.cameraPos.cameraPosition.value = e.position, this._shaderLibrary.uniforms.cameraPos.cameraTarget.value = e.target), this.camera = e, this._shadowEngine && this._shadowEngine.updateShadowMatrix(e), this._depthMapRenderer && this._depthMapRenderer.setCamera(e)
        }, n.prototype.getCamera = function() {
            return this.camera
        }, n.prototype.getShaderLibrary = function() {
            return this._shaderLibrary
        }, n.prototype.getDepthMaterials = function() {
            return this._depthMaterials || this.buildDepthMaterials(), this._depthMaterials
        }, n.prototype.buildDepthMaterials = function() {
            this._depthMaterials = {
                isCallback: !0,
                "default": this.createMaterial("depth", l.NoBlending),
                callback: r.bind(function(e) {
                    var t = e.uniforms.tex0 && e.uniforms.tex0.texture,
                        i = e.uniforms.uMaxHeight,
                        n = t ? "texture" : "";
                    return e.useSkinning() ? n += t ? "_skinning" : "skinning" : e.useMiniSkinning() ? n += t ? "_miniSkinning" : "miniSkinning" : e.effectName.indexOf("_envmap") > -1 ? n += t ? "_envmap" : "envmap" : e.effectName.indexOf("_specularLighting") > -1 ? n += t ? "_specularLighting" : "specularLighting" : "" == n && (n = "default"), i && (n += "_heightCropping"), this._depthMaterials[n]
                }, this)
            };
            for (var e = ["texture", "skinning", "texture_skinning", "miniSkinning", "texture_miniSkinning", "heightCropping", "texture_heightCropping", "texture_envmap_heightCropping", "envmap", "texture_envmap", "specularLighting", "texture_specularLighting"], t = 0; t < e.length; ++t) {
                var i = e[t];
                this._depthMaterials[i] = this.createMaterial("depth_" + i, l.NoBlending)
            }
            d.buildHeightMapMaterialOverrides(this, this._depthMaterials, "depth")
        }, n.prototype.bindDelegateFunction = function(e, t) {
            for (var i = 0; i < t.length; ++i) {
                var n = t[i];
                this[n] = r.bind(e[n], e)
            }
        }, n.prototype.unbindDelegateFunction = function(e, t) {
            for (var i = 0; i < t.length; ++i) delete this[t[i]]
        }, n.prototype.getScene = function() {
            return this._scene
        }, n.prototype.getCanvas = function() {
            return this._webGL._canvas
        }, n.prototype.getWebGLInfo = function() {
            return this._webGL.glInfo
        }, n.prototype.canUsePointSprite = function() {
            return this._webGL.canUsePointSprite
        }, n.prototype.getMaxPointSpriteSize = function() {
            return this._webGL.maxPointSpriteSize
        }, n.prototype.canUseStencil = function() {
            return this._webGL.stencilAvailable
        }, n.prototype.getDepthBits = function() {
            return this._webGL._depthBits
        }, n.prototype.setMirrorEffect = function(e) {
            this._mirrorEffect && (this._mirrorEffect.destruct(), this._mirrorEffect = null), e && (this._mirrorEffect = new y(this, e))
        }, n.prototype.createMesh = function(e, t) {
            var i;
            return this._meshCache.length > 0 ? (i = this._meshCache.pop(), i.construct(e, t)) : i = new m(e, t), i
        }, n.prototype.freeMesh = function(e) {
            if (e) {
                var t = e.cleanupCallback;
                e.cleanup(), t && t(e, this), this._meshCache.length < 100 && this._meshCache.push(e)
            }
        }, n.prototype.updateMaterial = function(e) {
            this._webGL.setProgram(e.material, e)
        }, n.prototype.updateObject = function(e) {
            this._webGL.updateObject(e)
        }, n.prototype.releaseObject = function(e) {
            null != e && (null != e.parent && e.parent.remove(e), e.geometry && (this.releaseGeometry(e.geometry), e.geometry.clear()), this.freeMesh(e))
        }, n.prototype.releaseGeometry = function(e) {
            null != e && this._webGL.deallocateGeometry(e)
        }, n.prototype.releaseRenderTarget = function(e) {
            this._webGL.deallocateRenderTarget(e)
        }, n.prototype.pickMesh = function(e, t, i) {
            if (!e || !e.length) return null;
            var n = this._webGL,
                r = t,
                o = n._viewportHeight - i;
            if (!this._pickingRenderTarget || !this._supportNegativeViewportOffset) {
                var a = 1,
                    s = 1;
                this._supportNegativeViewportOffset || (a = n._viewportHeight, s = n._viewportWidth), this._pickingRenderTarget && this._pickingRenderTarget.width == s && this._pickingRenderTarget.width == a || (this._pickingRenderTarget = new b(s, a), this._pickingPixel = new Uint8Array(4))
            }
            n.setRenderTarget(this._pickingRenderTarget, {
                updateViewportDisabled: !0
            }), this._supportNegativeViewportOffset && n.setViewportOrigin(-r, -o), n.clear();
            for (var h = 0; h < e.length; ++h) {
                var u = e[h];
                u.material.pickingMaterial && (this._shaderLibrary.uniforms.picking.pickingColor.value.setHex(h), n._currentProgram = null, n.renderObject(u, u.material.pickingMaterial))
            }
            var d = this._pickingPixel,
                c = 0,
                f = 0;
            this._supportNegativeViewportOffset || (c = r, f = o), n._gl.readPixels(c, f, 1, 1, l.RGBAFormat, l.UnsignedByteType, d);
            var p = d[0] << 16 ^ d[1] << 8 ^ d[2],
                m = p >= 0 && p < e.length ? e[p] : null;
            return n.setRenderTarget(null, {
                updateViewportDisabled: !0
            }), this._supportNegativeViewportOffset && n.setViewportOrigin(0, 0), {
                mesh: m,
                index: d[3]
            }
        }, n.prototype.forceUpdateShadow = function() {
            this._shadowEngine && (this._shadowEngine.isDirty = !0)
        }, n.prototype.setShadowEnabled = function(e) {
            this._shadowEngine && this._shadowEngine.isEnabled != e && (this.forceUpdateShadow(), this._shadowEngine.isEnabled = e)
        }, n.prototype.setSSAOutlineEnabled = function(e) {
            this._SSAOutline && this._SSAOutline.setEnabled(e)
        }, n.prototype.forceRender = function() {
            this._needRender = !0
        }, n.prototype.textureToRenderTarget = function(e, t, i) {
            var n = t.x,
                r = t.y,
                o = t.w,
                a = t.h;
            this._quad.position.set(n, r, 0), this._quad.scale.set(o, a, 1), this._quad.updateMatrix(), this._quad.material.uniforms.tex0.texture = e, this._webGL.setMaterial(null), this._webGL.setRenderTarget(i), this._webGL.renderObject(this._quad), this._quad.material.uniforms.tex0.texture = null, this._webGL.setRenderTarget(null)
        }, n.prototype.fixFrameRateForFireFox = function() {
            var e = this;
            r.delay(function() {
                e._webGL.setSize(e._webGL._canvas.width - 2, e._webGL._canvas.height), e._webGL.setSize(e._webGL._canvas.width + 2, e._webGL._canvas.height)
            }, 800)
        }, n.prototype.canUseDevicePixelRatio = function() {
            return this._webGL.canUseDevicePixelRatio()
        }, n.prototype.getUseDevicePixelRatio = function() {
            return this._useDevicePixelRatio
        }, n.prototype.setUseDevicePixelRatio = function(e) {
            this._useDevicePixelRatio != e && (this._useDevicePixelRatio = e, this._webGL.setUseDevicePixelRatio(e))
        }, n.prototype.renderEnabled = function(e) {
            this._renderingEnabled != e && (this._renderingEnabled = e, e ? this.startRenderLoop() : this.stopRenderLoop())
        }, n.prototype.setSize = function(e) {
            this._canRender = e.w > 0 && e.h > 0, this._webGL.setSize(e.w, e.h), this._SSAOutline && this._SSAOutline.resize(e), this._shaderLibrary.uniforms.viewport.viewport.value.set(0, 0, e.w, e.h), this._depthMapRenderer && this._depthMapRenderer.resize(e), this.emit("onResize")
        }, n.prototype.resetDT = function() {
            var e = (new Date).valueOf();
            this._lastAnimate = e, this._currentTime = e, this._lastRender = e
        }, n.prototype.startRenderLoop = function() {
            this.stopRenderLoop(), this._lastRender = Date.now(), this._requestId = requestAnimationFrame(this._animateCallback)
        }, n.prototype.stopRenderLoop = function() {
            null != this._requestId && (window.cancelAnimationFrame(this._requestId), delete this._requestId)
        }, n.prototype.getRenderStats = function() {
            return this._webGL.info.render
        }, n.prototype.onDivRemoved = function() {
            this.emit("onDivRemoved"), this._stopBuildShaders(), this.stopRenderLoop(), delete this._animateCallback, delete this._pickingPixel, this._textureHandler && (this._textureHandler.onDivRemoved(), this.unbindDelegateFunction(this._textureHandler, ["createTexture", "createAtlas", "packAndGetIndexFromAtlas", "getTexture", "handlePreloadedTexture", "handlePreloadedTextureNow", "askTextureToServer", "loadTexture", "abortLoadingTexture", "releaseTexture", "unloadTexture"])), this._SSAOutline && this._SSAOutline.onDivRemoved(), this.destroyShadowEngine(), this.freeMesh(this._quad), this._scene.removeAllObjects(), this._webGL.releaseAllPrograms(), this._shaderHandler.onDivRemoved(), r.each(this._meshCache, function(e) {
                e.cleanup()
            }), this._meshCache = {}, this.destroyDepthMaterials(), delete this._pickingRenderTarget, delete this._shaderLibrary, delete this._quad, delete this._scene, delete this._SSAOutline, delete this._shaderHandler, delete this._textureHandler, delete this._webGL
        }, n.prototype.destroyDepthMaterials = function() {
            r.each(this._depthMaterials, function(e) {
                e["default"] ? this.releaseMaterial(e["default"]) : this.releaseMaterial(e)
            }, this), delete this._depthMaterials
        }, n.prototype.destroyShadowEngine = function() {
            this._shadowEngine && (this._shadowEngine.destruct(), delete this._shadowEngine)
        }, n.prototype.onServerHostReady = function(e, t) {
            return this._serverConfig.onServerHostReady(e, t)
        }, n.prototype.getMemoryStats = function() {
            return this._webGL.info.memory
        }, n.prototype.onShadersReady = function(e) {
            this._webGL.onShadersReady(e)
        }, n.prototype._computeDT = function(e) {
            var t;
            null != e ? (this._dt = 1e3 / e, this._lastAnimate = this._currentTime, this._currentTime += this._dt, t = this._currentTime) : (t = Date.now(), this._dt = t - this._lastRender);
            var i = {
                now: t,
                dt: t - this._lastAnimate
            };
            this.emit("compute", i), this._lastAnimate = t;
            var n = this._webGL._canvas.width > 0 && this._webGL._canvas.height > 0,
                r = this._needRender || (this._minDTEnabled || this._forceDT) && this._dt > this.minDT,
                o = n && this._canRender && r;
            return o && (this._lastRender = t), o
        }, n.prototype._animate = function() {
            var e = this._computeDT(this.conf.fixedFrameRate);
            e && this._render(), this._renderingEnabled && (this._requestId = requestAnimationFrame(this._animateCallback))
        }, n.prototype.renderNextFrame = function(e, t) {
            this._computeDT(e), this._render(), t()
        }, n.prototype._render = function() {
            this._webGL.initRender();
            var e = {
                time: this._lastRender,
                dt: this._dt
            };
            this.emit("preRender", e), this._needRender = !1;
            var t = this._scene.updateAnimation(e);
            t && this.forceUpdateShadow(), this._webGL.updateObjects(this._scene.sortedObjects), this._webGL.setAndClearRenderTarget();
            var i = this._shadowEngine && this._shadowEngine.isDirty;
            this._sideBySide ? (this._renderScene(this._getCameraForEye("left")), this._shadowEngine && (this._shadowEngine.isDirty = i), this._renderScene(this._getCameraForEye("right"))) : this._topToBottom ? (this._renderScene(this._getCameraForEye("top")), this._shadowEngine && (this._shadowEngine.isDirty = i), this._renderScene(this._getCameraForEye("bottom"))) : this._renderScene(this.getCamera()), this._textureHandler.manageAtlasAndCache(this._lastRender), this.emit("postRender", {
                dt: this._dt
            })
        }, n.prototype._getCameraForEye = function(e) {
            var t = new w(this.camera.fov, this.camera.aspect, this.camera.near, this.camera.far);
            t.position = this.camera.position.clone(), t.target = this.camera.target.clone(), t.up = this.camera.up.clone();
            var i = t.target.clone().subSelf(t.position).crossSelf(t.up);
            return i.normalize().multiplyScalar(this.conf.eyes3dDistance), "left" == e || "top" == e ? t.position.addSelf(i) : ("right" == e || "bottom" == e) && t.position.subSelf(i), t.lookAt(t.target), t.updateMatrix(), t.eye = e, t
        }, n.prototype.clearShadows = function() {
            this._shadowEngine && this._shadowEngine.clear(this._scene)
        }, n.prototype._renderScene = function(e) {
            this._shadowEngine && this._shadowEngine.isEnabled && this._shadowEngine.updateShadowMap(this._scene, e), this._webGL.setCamera(e), this._webGL.setRenderTarget(), "left" == e.eye ? this._webGL.setLeftViewPort() : "right" == e.eye && this._webGL.setRightViewPort(), "top" == e.eye ? this._webGL.setTopViewPort() : "bottom" == e.eye ? this._webGL.setBottomViewPort() : this._depthMapRenderer && this._webGL.setLeftViewPort(), this._SSAOutline && this._SSAOutline.isEnabled() ? this._SSAOutline.render(this._scene, e) : this._webGL.renderObjects(this._scene.sortedObjects), this._mirrorEffect && this._mirrorEffect.render(this._scene), this._depthMapRenderer && this._depthMapRenderer.render(this._scene)
        }, n.prototype.getShadowExtensionName = function() {
            if (this._shadow) {
                var e = "_csmShadows";
                this.conf.shadows.debugShadowArea && (e += "Debug");
                var t = this.conf.shadows.useCsm ? e : "_shadow";
                return this.conf.shadows.usePcf && (t += "_pcfShadows"), this.conf.shadows.useLerp && (t += "_lerpShadows"), t
            }
            return ""
        }
    }, {
        "./CSMShadowEngine": 12,
        "./Constants": 14,
        "./DepthMap": 15,
        "./MirrorEffect": 16,
        "./RenderTarget": 18,
        "./SSAOutline": 19,
        "./ShadowEngine": 20,
        "./WebGLRenderer": 22,
        "./camera/PerspectiveCamera": 30,
        "./material/ShaderHandler": 32,
        "./material/ShaderLibrary": 33,
        "./material/ShaderUtils": 34,
        "./object/Mesh": 69,
        "./object/Scene": 71,
        "./texture/TextureHandler": 76,
        "./utils/TriangulationUtils": 82,
        "./utils/requestAnimationFramePolyfill": 96,
        events: 99,
        underscore: 207,
        util: 212
    }],
    18: [function(e, t, i) {
        "use strict";
        var n = e("./Constants"),
            r = e("./texture/Texture"),
            o = function a(e, t, i) {
                this.id = --a.RenderTargetCount, this.width = e, this.height = t, i = i || {}, this.wrap = void 0 !== i.wrap ? i.wrap : n.ClampToEdgeWrapping, this.magFilter = void 0 !== i.magFilter ? i.magFilter : n.LinearFilter, this.minFilter = void 0 !== i.minFilter ? i.minFilter : n.LinearFilter, this.generateMipmaps = void 0 !== i.generateMipmaps ? i.generateMipmaps : !1, this.format = void 0 !== i.format ? i.format : n.RGBAFormat, this.type = void 0 !== i.type ? i.type : n.UnsignedByteType, this.depthBuffer = void 0 !== i.depthBuffer ? i.depthBuffer : !1, this.stencilBuffer = void 0 !== i.stencilBuffer ? i.stencilBuffer : !1
            };
        o.prototype.grabTexture = function() {
            var e = new r;
            return e.id = --o.RenderTargetCount, e.width = this.width, e.height = this.height, e.image = null, e._imagePtr = null, e.magFilter = this.magFilter, e.minFilter = this.minFilter, e.wrap = this.wrap, e.generateMipmaps = this.generateMipmaps, e.format = this.format, e.type = this.type, e.__webglTexture = this.__webglTexture, this.__webglTexture = void 0, e
        }, o.RenderTargetCount = 0, t.exports = o
    }, {
        "./Constants": 14,
        "./texture/Texture": 74
    }],
    19: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this._renderEngine = t, this._webGL = this._renderEngine._webGL, this._depthMaterials = this._renderEngine.getDepthMaterials(), this.width = i.width, this.height = i.height, this._quad = this._renderEngine.createMesh(a.createUnitPlane(), this._depthMaterials.texture), this._quad.geometry.clearOnWebglLoad = !0, this._quad.scale.set(2, 2, 1), this._quad.updateMatrix(), this._webGL.updateObject(this._quad), this.clearColor = new s(0), this._isEnabled = !0, this.onResized()
        }
        var r = e("underscore"),
            o = e("./Constants"),
            a = e("./utils/TriangulationUtils"),
            s = e("./Color"),
            l = e("./RenderTarget"),
            h = e("./material/ShaderUtils");
        t.exports = n, n.prototype.destruct = function() {
            this._rtDepth && (this._renderEngine.releaseRenderTarget(this._rtDepth), delete this._rtDepth), this._rtProcessResult && (this._renderEngine.releaseRenderTarget(this._rtProcessResult), delete this._rtProcessResult), this._rtAmbient && (this._renderEngine.releaseRenderTarget(this._rtAmbient), delete this._rtAmbient), this._multiplyTexMat && (this._renderEngine.releaseMaterial(this._multiplyTexMat), delete this._multiplyTexMat), this._ssaoMaterial && (this._renderEngine.releaseMaterial(this._ssaoMaterial), delete this._ssaoMaterial), this._blurSsaoMaterial && (this._renderEngine.releaseMaterial(this._blurSsaoMaterial), delete this._blurSsaoMaterial), this._preZMaterials && (r.each(this._preZMaterials, function(e) {
                this._renderEngine.releaseMaterial(e)
            }, this), delete this._preZMaterials), this._depthMaterials = null
        }, n.prototype.resize = function(e) {
            this.width = e.w, this.height = e.h, this.onResized()
        }, n.prototype.onResized = function() {
            var e = {
                depthBuffer: !0,
                format: o.RGBAFormat,
                minFilter: o.NearestFilter,
                magFilter: o.NearestFilter
            };
            this._rtDepth ? (this._renderEngine.releaseRenderTarget(this._rtDepth), this._rtDepth.width = this.width, this._rtDepth.height = this.height) : this._rtDepth = new l(this.width, this.height, e), this._multiplyTexMat || (this._multiplyTexMat = this._renderEngine.createMaterial("renderTexture", o.MultiplyBlending), this._multiplyTexMat.depthTest = !1, this._multiplyTexMat.depthWrite = !1);
            var t = {
                format: o.RGBFormat
            };
            this._rtProcessResult ? (this._renderEngine.releaseRenderTarget(this._rtProcessResult), this._rtProcessResult.width = this.width, this._rtProcessResult.height = this.height) : this._rtProcessResult = new l(this.width, this.height, t), this._rtAmbient ? (this._renderEngine.releaseRenderTarget(this._rtAmbient), this._rtAmbient.width = this.width, this._rtAmbient.height = this.height) : this._rtAmbient = new l(this.width, this.height, t), null == this._ssaoMaterial && (this._ssaoMaterial = this._renderEngine.createMaterial("ssao", o.NoBlending), this._ssaoMaterial.depthWrite = !1, this._ssaoMaterial.depthTest = !1), this._ssaoMaterial.uniforms.depthTex.texture = this._rtDepth, null == this._blurSsaoMaterial && (this._blurSsaoMaterial = this._renderEngine.createMaterial("ssao_blur", o.NoBlending), this._blurSsaoMaterial.depthWrite = !1, this._blurSsaoMaterial.depthTest = !1), this._blurSsaoMaterial.uniforms.depthTex.texture = this._rtDepth, this._blurSsaoMaterial.uniforms.ambientTex.texture = this._rtAmbient
        }, n.prototype.render = function(e, t) {
            this._webGL.renderObjects(e.sortedObjects, null, "colorBeforeProcess", !1), this._webGL.setAndClearRenderTarget(this._rtDepth, this.clearColor), this._preZMaterials && (this._webGL.setColorWrite(!1), this._webGL.renderObjects(e.sortedObjects, this._preZMaterials, "preZ", !1), this._webGL.setColorWrite(!0)), this._webGL.renderObjects(e.sortedObjects, this._depthMaterials, "depth", !1), this._ssaoMaterial.uniforms.cameraNearFar.value.set(t.near, t.far), this._webGL.setAndClearRenderTarget(this._rtAmbient), this._webGL.renderObject(this._quad, this._ssaoMaterial), this._webGL.setAndClearRenderTarget(this._rtProcessResult), this._webGL.renderObject(this._quad, this._blurSsaoMaterial), this._multiplyTexMat.uniforms.tex0.texture = this._rtProcessResult, this._webGL.setRenderTarget(null), this._webGL.renderObject(this._quad, this._multiplyTexMat), this._webGL.renderObjects(e.sortedObjects, null, "colorBeforeProcess", !0)
        }, n.prototype.setEnabled = function(e) {
            this._isEnabled = e
        }, n.prototype.isEnabled = function() {
            return this._isEnabled
        }, n.prototype.onDivRemoved = function() {
            this._renderEngine.freeMesh(this._quad), this.destruct(), delete this._quad, delete this._renderEngine, delete this._webGL
        }, n.prototype.setHandlePreZ = function(e) {
            !this._preZMaterials && e ? (this._renderEngine.releaseMaterial(this._preZMaterials), this._preZMaterials = {
                isCallback: !0,
                "default": this._renderEngine.createMaterial("nolight", o.NoBlending),
                callback: r.bind(function() {
                    return this._preZMaterials["default"]
                }, this)
            }, h.buildHeightMapMaterialOverrides(this._renderEngine, this._preZMaterials, "nolight")) : !e && this._preZMaterials && (r.each(this._preZMaterials, function(e) {
                this._renderEngine.releaseMaterial(e)
            }, this), this._preZMaterials = null)
        }
    }, {
        "./Color": 13,
        "./Constants": 14,
        "./RenderTarget": 18,
        "./material/ShaderUtils": 34,
        "./utils/TriangulationUtils": 82,
        underscore: 207
    }],
    20: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this._renderEngine = e, this._getShadowMapBoundsCallback = i, this.size = t, this._renderEngine.conf.get("shadows.debugShadowMap") && (this._textureViewer = new u(this._renderEngine)), this.constructRenderTarget(), this._shadowMtx = new o, this._renderEngine.getShaderLibrary().uniforms.shadow.shadowMatrix.value = this._shadowMtx, this._shadowCamera = new a(-1, 1, -1, 1, -1, 1), this._depthMaterials = null, this._clearColor = new r(16777215), this.isDirty = !0, this.isEnabled = !0
        }
        var r = e("./Color"),
            o = e("./math/Matrix4"),
            a = e("./camera/OrthographicCamera"),
            s = e("./Constants"),
            l = e("./RenderTarget"),
            h = e("./math/Vector3"),
            u = e("./texture/TextureViewer");
        t.exports = n, n.prototype.destruct = function() {
            null != this._rtShadow && (this._renderEngine._webGL.deallocateRenderTarget(this._rtShadow), delete this._rtShadow), this._textureViewer && delete this._textureViewer
        }, n.prototype.constructRenderTarget = function() {
            var e = {
                depthBuffer: !0,
                format: s.RGBAFormat
            };
            if (this._rtShadow = new l(this.size, this.size, e), this._rtShadow.generateMipmaps = !1, this._renderEngine._shaderLibrary.uniforms.shadow.shadowTexture.texture = this._rtShadow, this._renderEngine._shaderLibrary.uniforms.shadow.shadowTextureSize.value.set(this.size, this.size), this._textureViewer) {
                var t = {
                        x: 32,
                        y: 32,
                        width: 256,
                        height: 256
                    },
                    i = {
                        materialName: "depthDebug",
                        textureUniformName: "depthTexture"
                    };
                this._textureViewer.addTexture("shadow", this._rtShadow, t, i)
            }
        }, n.prototype.matchShadowMapToBounds = function(e, t) {
            var i = e.xMin,
                n = e.yMin,
                r = e.xMax,
                o = e.yMax,
                a = e.zMin,
                s = this._renderEngine._shaderLibrary.uniforms.light.vLightDir.value,
                l = 100,
                u = s.x > 0 ? -1 : 1;
            i += s.x * l * u, r -= s.x * l * u;
            var d = s.y > 0 ? -1 : 1;
            n += s.y * l * d, o -= s.y * l * d;
            var c = new h(i + r, n + o, a);
            c.multiplyScalar(.5), this._shadowCamera.position.copy(c), this._shadowCamera.up.copy(s), this._shadowCamera.up.z = 0, this._shadowCamera.up.normalizeIfNotZero(), this._shadowCamera.lookAt(c.subSelf(s)), this._shadowCamera.left = this._shadowCamera.top = this.size, this._shadowCamera.right = this._shadowCamera.bottom = -this.size, this._shadowCamera.near = -1, this._shadowCamera.far = 1, this._shadowCamera.updateMatrix();
            var f = -(1 / 0),
                p = -(1 / 0),
                m = -(1 / 0),
                g = function(e, t) {
                    t.projScreenMatrix.multiplyVector3(e), f = Math.max(f, e.x), p = Math.max(p, e.y), m = Math.max(m, e.z)
                },
                _ = new h(i, n, 0);
            g(_, this._shadowCamera), _.set(r, n, 0), g(_, this._shadowCamera), _.set(r, o, 0), g(_, this._shadowCamera), _.set(i, o, 0), g(_, this._shadowCamera), this._shadowCamera.left = this.size * f, this._shadowCamera.right = -this._shadowCamera.left, this._shadowCamera.top = this.size * p, this._shadowCamera.bottom = -this._shadowCamera.top, this._shadowCamera.near = -m, this._shadowCamera.far = m, this._shadowCamera.updateMatrix(), this.updateShadowMatrix(t)
        }, n.prototype.updateShadowMatrix = function(e) {
            if (this._renderEngine._shadow && this.isEnabled) {
                this._shadowMtx.set(.5, 0, 0, .5, 0, .5, 0, .5, 0, 0, .5, .5, 0, 0, 0, 1), this._shadowMtx.multiplySelf(this._shadowCamera.projScreenMatrix);
                var t = e.matrixWorld;
                this._shadowMtx.multiplySelf(t)
            }
        }, n.prototype.clear = function() {
            this._rtShadow && this._renderEngine._webGL.setAndClearRenderTarget(this._rtShadow, this._clearColor)
        }, n.prototype.updateShadowMap = function(e, t) {
            if (this._depthMaterials || (this._depthMaterials = this._renderEngine.getDepthMaterials()), this.isDirty && (this.isDirty = !1, this._renderEngine._webGL.setAndClearRenderTarget(this._rtShadow, this._clearColor), this.isEnabled)) {
                var i = this._getShadowMapBoundsCallback(this._renderEngine.conf.get("shadows.maxDistance"), t);
                this.matchShadowMapToBounds(i, t), this._renderEngine._webGL.setCullFace(s.FRONT), this._renderEngine._webGL.setCamera(this._shadowCamera), this._renderEngine._webGL.renderObjects(e.sortedObjects, this._depthMaterials, "shadowDepth", !1), this._renderEngine._webGL.setCullFace(s.BACK)
            }
        }
    }, {
        "./Color": 13,
        "./Constants": 14,
        "./RenderTarget": 18,
        "./camera/OrthographicCamera": 29,
        "./math/Matrix4": 60,
        "./math/Vector3": 63,
        "./texture/TextureViewer": 77
    }],
    21: [function(e, t, i) {
        "use strict";
        var n = function() {
            function e(e) {
                if (null == f) {
                    f = {};
                    for (var t in e) "number" == typeof e[t] && (f[e[t]] = t)
                }
            }

            function t() {
                if (null == f) throw "WebGLDebugUtils.init(ctx) not called"
            }

            function i(e) {
                return t(), void 0 !== f[e]
            }

            function n(e) {
                t();
                var i = f[e];
                return void 0 !== i ? i : "*UNKNOWN WebGL ENUM (0x" + e.toString(16) + ")"
            }

            function r(e, t, i) {
                var r = c[e];
                return void 0 !== r && r[t] ? n(i) : null === i ? "null" : void 0 === i ? "undefined" : i.toString()
            }

            function o(e, t) {
                for (var i = "", n = 0; n < t.length; ++n) i += (0 == n ? "" : ", ") + r(e, n, t[n]);
                return i
            }

            function a(e, t, i) {
                e.__defineGetter__(i, function() {
                    return t[i]
                }), e.__defineSetter__(i, function(e) {
                    t[i] = e
                })
            }

            function s(t, i, o) {
                function s(e, t) {
                    return function() {
                        o && o(t, arguments);
                        var n = e[t].apply(e, arguments),
                            r = e.getError();
                        return 0 != r && (l[r] = !0, i(r, t, arguments)), n
                    }
                }
                e(t), i = i || function(e, t, i) {
                    for (var o = "", a = 0; a < i.length; ++a) o += (0 == a ? "" : ", ") + r(t, a, i[a]);
                    d("WebGL error " + n(e) + " in " + t + "(" + o + ")")
                };
                var l = {},
                    h = {};
                for (var u in t) "function" == typeof t[u] ? h[u] = s(t, u) : a(h, t, u);
                return h.getError = function() {
                    for (var e in l)
                        if (l.hasOwnProperty(e) && l[e]) return l[e] = !1, e;
                    return t.NO_ERROR
                }, h
            }

            function l(e) {
                var t = e.getParameter(e.MAX_VERTEX_ATTRIBS),
                    i = e.createBuffer();
                e.bindBuffer(e.ARRAY_BUFFER, i);
                for (var n = 0; t > n; ++n) e.disableVertexAttribArray(n), e.vertexAttribPointer(n, 4, e.FLOAT, !1, 0, 0), e.vertexAttrib1f(n, 0);
                e.deleteBuffer(i);
                for (var r = e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS), n = 0; r > n; ++n) e.activeTexture(e.TEXTURE0 + n), e.bindTexture(e.TEXTURE_CUBE_MAP, null), e.bindTexture(e.TEXTURE_2D, null);
                for (e.activeTexture(e.TEXTURE0), e.useProgram(null), e.bindBuffer(e.ARRAY_BUFFER, null), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, null), e.bindFramebuffer(e.FRAMEBUFFER, null), e.bindRenderbuffer(e.RENDERBUFFER, null), e.disable(e.BLEND), e.disable(e.CULL_FACE), e.disable(e.DEPTH_TEST), e.disable(e.DITHER), e.disable(e.SCISSOR_TEST), e.blendColor(0, 0, 0, 0), e.blendEquation(e.FUNC_ADD), e.blendFunc(e.ONE, e.ZERO), e.clearColor(0, 0, 0, 0), e.clearDepth(1), e.clearStencil(-1), e.colorMask(!0, !0, !0, !0), e.cullFace(e.BACK), e.depthFunc(e.LESS), e.depthMask(!0), e.depthRange(0, 1), e.frontFace(e.CCW), e.hint(e.GENERATE_MIPMAP_HINT, e.DONT_CARE), e.lineWidth(1), e.pixelStorei(e.PACK_ALIGNMENT, 4), e.pixelStorei(e.UNPACK_ALIGNMENT, 4), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !1), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, !1), e.UNPACK_COLORSPACE_CONVERSION_WEBGL && e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL, e.BROWSER_DEFAULT_WEBGL), e.polygonOffset(0, 0), e.sampleCoverage(1, !1), e.scissor(0, 0, e.canvas.width, e.canvas.height), e.stencilFunc(e.ALWAYS, 0, 4294967295), e.stencilMask(4294967295), e.stencilOp(e.KEEP, e.KEEP, e.KEEP), e.viewport(0, 0, e.canvas.width, e.canvas.height), e.clear(e.COLOR_BUFFER_BIT | e.DEPTH_BUFFER_BIT | e.STENCIL_BUFFER_BIT); e.getError(););
            }

            function h(e) {
                function t(e) {
                    return "function" == typeof e ? e : function(t) {
                        e.handleEvent(t)
                    }
                }

                function i(e) {
                    var t = e.addEventListener;
                    e.addEventListener = function(i, n, r) {
                        switch (i) {
                            case "webglcontextlost":
                                M(n);
                                break;
                            case "webglcontextrestored":
                                T(n);
                                break;
                            default:
                                t.apply(e, arguments)
                        }
                    }
                }

                function n() {
                    for (var e = Object.keys(w), t = 0; t < e.length; ++t) delete w[e]
                }

                function r() {
                    ++y, g || v == y && e.loseContext()
                }

                function o(e, t) {
                    var i = e[t];
                    return function() {
                        if (r(), !g) {
                            var t = i.apply(e, arguments);
                            return t
                        }
                    }
                }

                function s() {
                    for (var e = 0; e < _.length; ++e) {
                        var t = _[e];
                        t instanceof WebGLBuffer ? d.deleteBuffer(t) : t instanceof WebGLFramebuffer ? d.deleteFramebuffer(t) : t instanceof WebGLProgram ? d.deleteProgram(t) : t instanceof WebGLRenderbuffer ? d.deleteRenderbuffer(t) : t instanceof WebGLShader ? d.deleteShader(t) : t instanceof WebGLTexture && d.deleteTexture(t)
                    }
                }

                function h(e) {
                    return {
                        statusMessage: e,
                        preventDefault: function() {
                            b = !0
                        }
                    }
                }

                function u(e) {
                    for (var t in e) "function" == typeof e[t] ? c[t] = o(e, t) : a(c, e, t);
                    c.getError = function() {
                        if (r(), !g)
                            for (var e; e = d.getError();) w[e] = !0;
                        for (var e in w)
                            if (w[e]) return delete w[e], e;
                        return c.NO_ERROR
                    };
                    for (var i = ["createBuffer", "createFramebuffer", "createProgram", "createRenderbuffer", "createShader", "createTexture"], n = 0; n < i.length; ++n) {
                        var s = i[n];
                        c[s] = function(t) {
                            return function() {
                                if (r(), g) return null;
                                var i = t.apply(e, arguments);
                                return i.__webglDebugContextLostId__ = m, _.push(i), i
                            }
                        }(e[s])
                    }
                    for (var l = ["getActiveAttrib", "getActiveUniform", "getBufferParameter", "getContextAttributes", "getAttachedShaders", "getFramebufferAttachmentParameter", "getParameter", "getProgramParameter", "getProgramInfoLog", "getRenderbufferParameter", "getShaderParameter", "getShaderInfoLog", "getShaderSource", "getTexParameter", "getUniform", "getUniformLocation", "getVertexAttrib"], n = 0; n < l.length; ++n) {
                        var s = l[n];
                        c[s] = function(t) {
                            return function() {
                                return r(), g ? null : t.apply(e, arguments)
                            }
                        }(c[s])
                    }
                    for (var h = ["isBuffer", "isEnabled", "isFramebuffer", "isProgram", "isRenderbuffer", "isShader", "isTexture"], n = 0; n < h.length; ++n) {
                        var s = h[n];
                        c[s] = function(t) {
                            return function() {
                                return r(), g ? !1 : t.apply(e, arguments)
                            }
                        }(c[s])
                    }
                    return c.checkFramebufferStatus = function(t) {
                        return function() {
                            return r(), g ? c.FRAMEBUFFER_UNSUPPORTED : t.apply(e, arguments)
                        }
                    }(c.checkFramebufferStatus), c.getAttribLocation = function(t) {
                        return function() {
                            return r(), g ? -1 : t.apply(e, arguments)
                        }
                    }(c.getAttribLocation), c.getVertexAttribOffset = function(t) {
                        return function() {
                            return r(), g ? 0 : t.apply(e, arguments)
                        }
                    }(c.getVertexAttribOffset), c.isContextLost = function() {
                        return g
                    }, c
                }
                var d, c, f = [],
                    p = [],
                    c = {},
                    m = 1,
                    g = !1,
                    _ = [],
                    v = 0,
                    y = 0,
                    b = !1,
                    x = 0,
                    w = {};
                e.getContext = function(t) {
                    return function() {
                        var i = t.apply(e, arguments);
                        if (i instanceof WebGLRenderingContext) {
                            if (i != d) {
                                if (d) throw "got different context";
                                d = i, c = u(d)
                            }
                            return c
                        }
                        return i
                    }
                }(e.getContext);
                var M = function(e) {
                        f.push(t(e))
                    },
                    T = function(e) {
                        p.push(t(e))
                    };
                return i(e), e.loseContext = function() {
                    if (!g) {
                        for (g = !0, v = 0, ++m; d.getError(););
                        n(), w[d.CONTEXT_LOST_WEBGL] = !0;
                        var t = h("context lost"),
                            i = f.slice();
                        setTimeout(function() {
                            for (var n = 0; n < i.length; ++n) i[n](t);
                            x >= 0 && setTimeout(function() {
                                e.restoreContext()
                            }, x)
                        }, 0)
                    }
                }, e.restoreContext = function() {
                    g && p.length && setTimeout(function() {
                        if (!b) throw "can not restore. webglcontestlost listener did not call event.preventDefault";
                        s(), l(d), g = !1, y = 0, b = !1;
                        for (var e = p.slice(), t = h("context restored"), i = 0; i < e.length; ++i) e[i](t)
                    }, 0)
                }, e.loseContextInNCalls = function(e) {
                    if (g) throw "You can not ask a lost contet to be lost";
                    v = y + e
                }, e.getNumCalls = function() {
                    return y
                }, e.setRestoreTimeout = function(e) {
                    x = e
                }, e
            }
            var u = function(e) {
                    window.console && window.console.log && window.console.log(e)
                },
                d = function(e) {
                    window.console && window.console.error ? window.console.error(e) : u(e)
                },
                c = {
                    enable: {
                        0: !0
                    },
                    disable: {
                        0: !0
                    },
                    getParameter: {
                        0: !0
                    },
                    drawArrays: {
                        0: !0
                    },
                    drawElements: {
                        0: !0,
                        2: !0
                    },
                    createShader: {
                        0: !0
                    },
                    getShaderParameter: {
                        1: !0
                    },
                    getProgramParameter: {
                        1: !0
                    },
                    getVertexAttrib: {
                        1: !0
                    },
                    vertexAttribPointer: {
                        2: !0
                    },
                    bindTexture: {
                        0: !0
                    },
                    activeTexture: {
                        0: !0
                    },
                    getTexParameter: {
                        0: !0,
                        1: !0
                    },
                    texParameterf: {
                        0: !0,
                        1: !0
                    },
                    texParameteri: {
                        0: !0,
                        1: !0,
                        2: !0
                    },
                    texImage2D: {
                        0: !0,
                        2: !0,
                        6: !0,
                        7: !0
                    },
                    texSubImage2D: {
                        0: !0,
                        6: !0,
                        7: !0
                    },
                    copyTexImage2D: {
                        0: !0,
                        2: !0
                    },
                    copyTexSubImage2D: {
                        0: !0
                    },
                    generateMipmap: {
                        0: !0
                    },
                    bindBuffer: {
                        0: !0
                    },
                    bufferData: {
                        0: !0,
                        2: !0
                    },
                    bufferSubData: {
                        0: !0
                    },
                    getBufferParameter: {
                        0: !0,
                        1: !0
                    },
                    pixelStorei: {
                        0: !0,
                        1: !0
                    },
                    readPixels: {
                        4: !0,
                        5: !0
                    },
                    bindRenderbuffer: {
                        0: !0
                    },
                    bindFramebuffer: {
                        0: !0
                    },
                    checkFramebufferStatus: {
                        0: !0
                    },
                    framebufferRenderbuffer: {
                        0: !0,
                        1: !0,
                        2: !0
                    },
                    framebufferTexture2D: {
                        0: !0,
                        1: !0,
                        2: !0
                    },
                    getFramebufferAttachmentParameter: {
                        0: !0,
                        1: !0,
                        2: !0
                    },
                    getRenderbufferParameter: {
                        0: !0,
                        1: !0
                    },
                    renderbufferStorage: {
                        0: !0,
                        1: !0
                    },
                    clear: {
                        0: !0
                    },
                    depthFunc: {
                        0: !0
                    },
                    blendFunc: {
                        0: !0,
                        1: !0
                    },
                    blendFuncSeparate: {
                        0: !0,
                        1: !0,
                        2: !0,
                        3: !0
                    },
                    blendEquation: {
                        0: !0
                    },
                    blendEquationSeparate: {
                        0: !0,
                        1: !0
                    },
                    stencilFunc: {
                        0: !0
                    },
                    stencilFuncSeparate: {
                        0: !0,
                        1: !0
                    },
                    stencilMaskSeparate: {
                        0: !0
                    },
                    stencilOp: {
                        0: !0,
                        1: !0,
                        2: !0
                    },
                    stencilOpSeparate: {
                        0: !0,
                        1: !0,
                        2: !0,
                        3: !0
                    },
                    cullFace: {
                        0: !0
                    },
                    frontFace: {
                        0: !0
                    }
                },
                f = null;
            return {
                init: e,
                mightBeEnum: i,
                glEnumToString: n,
                glFunctionArgToString: r,
                glFunctionArgsToString: o,
                makeDebugContext: s,
                makeLostContextSimulatingCanvas: h,
                resetToInitialState: l
            }
        }();
        t.exports = n
    }, {}],
    22: [function(e, t, i) {
        "use strict";

        function n(e) {
            return 0 === (e & e - 1)
        }

        function r(e) {
            e = o.defaults(e || {}, {
                usePointSprite: !1,
                depthMap: !1
            }), e.webGlContextAttributes = o.defaults(e.webGlContextAttributes || {}, {
                alpha: !1,
                depth: !0,
                stencil: !0,
                clearColor: 16777215,
                antialias: !0,
                premultipliedAlpha: !1,
                preserveDrawingBuffer: !0,
                failIfMajorPerformanceCaveat: !0
            }), this._canvas = e.canvas || document.createElement("canvas"), this._clearColor = new s(e.webGlContextAttributes.clearColor || 0), this._clearColor.a = 0, this._forceRenderCallback = e.forceRenderCallback, this._debugEnabled = e.debugEnabled || !1, this._onShadersGeneratedCallbacks = [], this._programs = {}, this._programsCounter = 0, this._linkingPrograms = [], this._buildingPrograms = [], this.setDepthMap(e.depthMap), this.setSideBySide(e.sideBySide), this.setTopToBottom(e.topToBottom), this._currentProgram = null, this._currentRenderTarget = null, this._currentMaterialId = -1, this._currentGeometryId = -1, this._currentDoubleSided = null, this._currentBlending = null, this._currentDepthTest = null, this._currentDepthWrite = null, this._currentColorWrite = 255, this._currentStencilValue = 0, this._enabledAttributesCache = [], this._currentTextures = {}, this._activeTextureSlot = 0, this._currentScissor = null, this._clientWidth = this._canvas.clientWidth, this._clientHeight = this._canvas.clientHeight, this._modelViewMatrixArray = new Float32Array(16), this._projectionMatrix = new Float32Array(16), this._viewMatrix = new l, this._viewMatrixArray = new Float32Array(16);
            var t = e.webGlContextAttributes;
            this._gl = this._createWebGLContext(t), this.glExtensionManager = new d(this._gl), this._initGLParameters(e), this._initDebug(), this._initStats(), this.remapConstantsWithGLValues(), this._initAttributeCache(), this.setDefaultStates(), this.clear()
        }
        var o = e("underscore"),
            a = e("./Constants"),
            s = e("./Color"),
            l = e("./math/Matrix4"),
            h = e("./WebGLDebugUtils"),
            u = e("browser-detect"),
            d = e("./utils/WebGLExtensionManager"),
            c = ["", "-o-", "-moz-", "-webkit-", "-ms-", "-khtml-"];
        t.exports = r;
        var f = window && window.performance && window.performance.now ? window.performance : Date,
            p = 4,
            m = r.prototype;
        m._initStats = function() {
            this.info = {
                memory: {
                    programs: 0,
                    geometries: 0,
                    textures: 0,
                    geometryBufferSizes: {}
                },
                render: {
                    calls: 0,
                    vertices: 0,
                    faces: 0,
                    points: 0
                },
                textures: {}
            }, this.shaderBuildTime = 0, this.textureCreationTime = 0
        }, m._initGLParameters = function(e) {
            this.glInfo = this._getGlInfo(), this._devicePixelRatio = window.devicePixelRatio || 1, this._pixelRatio = e.useDevicePixelRatio ? this._devicePixelRatio : 1, this.anisotropicExt = this.glExtensionManager.enableExtension(d.texture_filter_anisotropic), this.anisotropicExt && (this.anisotropicExt.max = this._gl.getParameter(this.anisotropicExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT));
            var t = this.glInfo.SHADING_LANGUAGE_VERSION,
                i = /GLSL ES ([0-9\.]+)/.exec(t),
                n = i ? i[1] : null;
            if (this.shaderVersion = n ? parseFloat(n, 10) : 0, this.stencilAvailable = this.glInfo.STENCIL_BITS, e.webGLMinShaderVersion && (!n || e.webGLMinShaderVersion > this.shaderVersion)) throw "Error GLSL Version " + t + " not supported.";
            this.maxPointSpriteSize = this.glInfo.ALIASED_POINT_SIZE_RANGE[1], this.canUsePointSprite = e.usePointSprite && this.maxPointSpriteSize >= (e.requiredPointSpriteSize || 2), this.canUseFixedColor = this.shaderVersion >= 1, this._maxTextureUnit = this.glInfo.MAX_COMBINED_TEXTURE_IMAGE_UNITS, this._maxTextureUnit < 8 && console.warn("Max combined textures is low", this._maxTextureUnit);
            for (var r = 0; r < this._maxTextureUnit; r++) this._currentTextures[r] = null;
            this._maxTextureSize = this.glInfo.MAX_TEXTURE_SIZE, this._maxVertexUniforms = this.glInfo.MAX_VERTEX_UNIFORM_VECTORS, this._maxVertexUniforms < 254 && console.warn("max Vertex uniforms is low", this._maxVertexUniforms), this._depthBits = this.glInfo.DEPTH_BITS
        }, m._initDebug = function() {
            function e(e, t, i) {
                console.error("Webgl error", e, t, i)
            }
            this._debugEnabled && (console.warn("WebgGL is using a debug context (slower)"), h.makeDebugContext(this._gl, e, null))
        }, m._createWebGLContext = function(e) {
            return e.alpha || e.premultipliedAlpha || (this._canvas.style["background-color"] = "black"), u.getWebGlContext(this._canvas, e)
        }, m._getGlInfo = function() {
            var e = ["ALIASED_LINE_WIDTH_RANGE", "ALIASED_POINT_SIZE_RANGE", "ALPHA_BITS", "BLUE_BITS", "DEPTH_BITS", "GREEN_BITS", "MAX_COMBINED_TEXTURE_IMAGE_UNITS", "MAX_CUBE_MAP_TEXTURE_SIZE", "MAX_FRAGMENT_UNIFORM_VECTORS", "MAX_RENDERBUFFER_SIZE", "MAX_TEXTURE_IMAGE_UNITS", "MAX_TEXTURE_SIZE", "MAX_VARYING_VECTORS", "MAX_VERTEX_ATTRIBS", "MAX_VERTEX_TEXTURE_IMAGE_UNITS", "MAX_VERTEX_UNIFORM_VECTORS", "MAX_VIEWPORT_DIMS", "RED_BITS", "RENDERER", "SHADING_LANGUAGE_VERSION", "STENCIL_BITS", "VENDOR", "VERSION"],
                t = {
                    supported: !0
                },
                i = this._gl;
            o.each(e, function(e) {
                t[e] = i.getParameter(i[e])
            });
            var n = this.glExtensionManager.enableExtension(d.debug_renderer_info);
            return n && o.each(["UNMASKED_RENDERER_WEBGL", "UNMASKED_VENDOR_WEBGL"], function(e) {
                t[e] = i.getParameter(n[e])
            }), t.supportedExtensions = i.getSupportedExtensions(), t
        }, m._initAttributeCache = function() {
            for (var e = this.glInfo.MAX_VERTEX_ATTRIBS, t = 0; e > t; ++t) this._enabledAttributesCache[t] = !1
        }, m.setDefaultStates = function() {
            this._gl.clearDepth(1), this.stencilAvailable && this._gl.clearStencil(0), this._gl.enable(this._gl.DEPTH_TEST), this._gl.depthFunc(this._gl.LEQUAL), this.stencilAvailable && (this._gl.disable(this._gl.STENCIL_TEST), this._gl.stencilMask(0)), this._gl.frontFace(this._gl.CCW), this._gl.cullFace(this._gl.BACK), this._gl.enable(this._gl.CULL_FACE), this._gl.enable(this._gl.BLEND), this._gl.blendEquation(this._gl.FUNC_ADD), this._gl.blendFunc(this._gl.SRC_ALPHA, this._gl.ONE_MINUS_SRC_ALPHA), this._gl.clearColor(this._clearColor.r, this._clearColor.g, this._clearColor.b, this._clearColor.a), this._gl.colorMask(!0, !0, !0, !0);
            var e = this.getViewSize();
            this.setViewportRectangle(0, 0, e.width, e.height)
        }, m.canUseDevicePixelRatio = function() {
            return this._devicePixelRatio > 1
        }, m.setUseDevicePixelRatio = function(e) {
            var t = e ? this._devicePixelRatio : 1;
            this._pixelRatio !== t && (this._pixelRatio = t, this.setSize(this._clientWidth, this._clientHeight))
        }, m.setSize = function(e, t) {
            var i = this._pixelRatio;
            this._clientWidth = e, this._clientHeight = t;
            var n = this._canvas;
            n.width = e * i, n.height = t * i;
            var r = 1 / i,
                a = "scale3d(" + r + ", " + r + ", 1.0)",
                s = "0 0 0";
            o.each(c, function(e) {
                n.style[e + "transform"] = a, n.style[e + "transform-origin"] = s
            });
            var l = this.getViewSize();
            this.setViewport(l.width, l.height)
        }, m.setViewport = function(e, t) {
            (this._viewportWidth != e || this._viewportHeight != t) && (this._viewportWidth = e, this._viewportHeight = t, this._updateViewport(), this._currentProgram = null)
        }, m._updateViewport = function() {
            var e = this._viewportX,
                t = this._viewportY;
            this._currentRenderTarget && (e = 0, t = 0), this._gl.viewport(e, t, this._viewportWidth, this._viewportHeight)
        }, m.setLineWidth = function(e) {
            this._gl.lineWidth(e)
        }, m.setViewportOrigin = function(e, t) {
            (this._viewportX != e || this._viewportY != t) && (this._viewportX = e, this._viewportY = t, this._gl.viewport(e, t, this._viewportWidth, this._viewportHeight), this._currentProgram = null)
        }, m.setViewportRectangle = function(e, t, i, n) {
            (this._viewportX != e || this._viewportY != t || this._viewportWidth != i || this._viewportHeight != n) && (this._viewportX = e, this._viewportY = t, this._viewportWidth = i, this._viewportHeight = n, this._gl.viewport(this._viewportX, this._viewportY, this._viewportWidth, this._viewportHeight), this._currentProgram = null)
        }, m.getCurrentViewPort = function() {
            return {
                x: this._viewportX,
                y: this._viewportY,
                width: this._viewportWidth,
                height: this._viewportHeight
            }
        }, m.clearDepth = function() {
            var e = this._currentDepthWrite;
            this.setDepthWrite(!0), this._gl.clear(this._gl.DEPTH_BUFFER_BIT), this.setDepthWrite(e)
        }, m.clearStencil = function() {
            this.stencilAvailable && (this._gl.stencilMask(255), this._gl.clear(this._gl.STENCIL_BUFFER_BIT))
        }, m.clear = function() {
            var e = this._gl.COLOR_BUFFER_BIT | this._gl.DEPTH_BUFFER_BIT,
                t = this._currentDepthWrite;
            this.setDepthWrite(!0), this.stencilAvailable && (this._gl.stencilMask(255), e |= this._gl.STENCIL_BUFFER_BIT), this._gl.clear(e), this.stencilAvailable && this._gl.stencilMask(this._currentStencilValue), this.setDepthWrite(t)
        }, m.queryPrecisionHeaderString = function() {
            var e = "";
            if (this._gl.getShaderPrecisionFormat) {
                var t = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_FLOAT);
                t && 0 != t.precision ? e = "precision highp float;\n" : (t = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.MEDIUM_FLOAT), e += t && 0 != t.precision ? "precision mediump float;\n" : "precision lowp float;\n");
                var i = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.HIGH_INT);
                i && 0 != i.precision ? e += "precision highp int;\n" : (i = this._gl.getShaderPrecisionFormat(this._gl.FRAGMENT_SHADER, this._gl.MEDIUM_INT), e += i && 0 != i.precision ? "precision mediump int;\n" : "precision lowp int;\n");
            } else e = "precision lowp float;\n", e += "precision lowp int;\n";
            return e
        }, m.deallocateGeometry = function(e) {
            this._currentGeometryId == e.id && (this._currentGeometryId = -1), e.__webglAttributeBuffers && (this.info.memory.geometries--, o.each(e.__webglAttributeBuffers, function(e) {
                this._gl.deleteBuffer(e)
            }, this)), e.__webglAttributeBuffers = null, e.__webglInterleavedVertexBuffer && (this._gl.deleteBuffer(e.__webglInterleavedVertexBuffer), e.__webglInterleavedVertexBuffer = null), delete this.info.memory.geometryBufferSizes[e.id], this._gl.deleteBuffer(e.__webglIndexBuffer), e.__webglIndexBuffer = null
        }, m.deallocateTexture = function(e) {
            if (e.__webglTexture) {
                for (var t = 0; t < this._maxTextureUnit; t++)
                    if (this._currentTextures[t] == e) {
                        this.setActiveTextureSlot(t), this.bindTexture(null);
                        break
                    }
                this._gl.deleteTexture(e.__webglTexture), delete e.__webglTexture, this.info.memory.textures--, delete this.info.textures[e.id]
            }
        }, m.deallocateRenderTarget = function(e) {
            if (e && e.__webglFramebuffer) {
                for (var t = 0; t < this._maxTextureUnit; t++)
                    if (this._currentTextures[t] == e) {
                        this.setActiveTextureSlot(t), this.bindTexture(null);
                        break
                    }
                this._gl.deleteTexture(e.__webglTexture), delete this.info.textures[e.id], delete e.__webglTexture, this._gl.deleteFramebuffer(e.__webglFramebuffer), delete e.__webglFramebuffer, this._gl.deleteRenderbuffer(e.__webglRenderbuffer), delete e.__webglRenderbuffer
            }
        }, m.setBuffer = function(e, t, i, n) {
            this._gl.bindBuffer(this._gl.ARRAY_BUFFER, e), this._gl.vertexAttribPointer(t, i, n, !1, 0, 0)
        }, m.setInterleavedBuffer = function(e, t, i, n, r) {
            this._gl.bindBuffer(this._gl.ARRAY_BUFFER, e), this._gl.vertexAttribPointer(t, i, this._gl.FLOAT, !1, r * p, n * p)
        }, m.setMaterial = function(e) {
            e ? (this.setBlending(e.blending), this.setDepthTest(e.depthTest), this.setDepthWrite(e.depthWrite)) : this._currentMaterialId = -1
        };
        var g = [];
        m.initRender = function() {
            this.info.render.calls = 0, this.info.render.vertices = 0, this.info.render.faces = 0, this.info.render.points = 0
        }, m.renderObject = function(e, t, i) {
            e.preRenderFunc && e.preRenderFunc(this, e, t, i), e.renderFunc ? e.renderFunc(this, e, t, i) : this.doObjectRendering(e, t), e.postRenderFunc && e.postRenderFunc(this, e, t, i)
        }, m.doObjectRendering = function(e, t) {
            var i = e.geometry;
            if (!i) return void console.error("Rendering object without geometry", e);
            if (!(0 == i.ptsCount && 0 == i.indexCount || e.vertexSubArray && 0 == e.vertexSubArray.count)) {
                var n = t || e.material;
                if (!n.program) return void this.initMaterial(n);
                if (!n.program.building) {
                    this.setMaterial(n), this.setObjectCulling(e);
                    var r = this._currentProgram,
                        o = this.setProgram(n, e);
                    if (o) {
                        var a = i.id !== this._currentGeometryId || o !== r;
                        a && this.updateBuffers(e, o), i.__webglIndexBuffer ? this._renderIndexedBuffer(e, i, a) : this._renderBuffer(e, i)
                    }
                }
            }
        }, m._renderIndexedBuffer = function(e, t, i) {
            i && this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, t.__webglIndexBuffer);
            var n = 0,
                r = t.indexCount;
            e.vertexSubArray && (n = 2 * e.vertexSubArray.startIndex, r = e.vertexSubArray.count);
            var o = t.primitiveType;
            this._gl.drawElements(o, r, this._gl.UNSIGNED_SHORT, n), o == a.TRIANGLES ? (this.info.render.calls++, this.info.render.vertices += r, this.info.render.faces += r / 3) : o == a.LINES ? (this.info.render.calls++, this.info.render.vertices += r) : o == a.POINTS && (this.info.render.calls++, this.info.render.points += r)
        }, m._renderBuffer = function(e, t) {
            var i = t.primitiveType,
                n = 0,
                r = t.ptsCount;
            e.vertexSubArray && (n = e.vertexSubArray.startIndex, r = e.vertexSubArray.count), this._gl.drawArrays(i, n, r), i == a.TRIANGLES ? (this.info.render.calls++, this.info.render.vertices += r, this.info.render.faces += r / 3) : i == a.LINES ? (this.info.render.calls++, this.info.render.vertices += r) : i == a.POINTS && (this.info.render.calls++, this.info.render.points += r)
        }, m.updateBuffers = function(e, t) {
            var i = e.geometry,
                n = t.attributes;
            g.length = 0, this._currentGeometryId = i.id;
            var r, o, a, s, l;
            if (i.__webglInterleavedVertexBuffer && i._interleavedData) {
                s = n.length;
                var h = i._interleavedData.details,
                    u = i._interleavedData.stride;
                for (a = 0; s > a; ++a)
                    if (l = n[a]) {
                        r = l.name;
                        var d = h[r];
                        if (d) {
                            o = d.size;
                            var c = d.offset;
                            this.setInterleavedBuffer(i.__webglInterleavedVertexBuffer, a, o, c, u), g[a] = !0
                        }
                    }
            }
            if (i.__webglAttributeBuffers)
                for (s = n.length, a = 0; s > a; ++a)
                    if (l = n[a]) {
                        r = l.name, o = l.size;
                        var f = i.__webglAttributeBuffers[r];
                        if (f) this.setBuffer(f, a, o, this._gl.FLOAT), g[a] = !0;
                        else if (i.__webglAttributeValues) {
                            var p = i.__webglAttributeValues[r];
                            p && (4 == o ? this._gl.vertexAttrib4fv(a, p) : 2 == o ? this._gl.vertexAttrib2fv(a, p) : 3 == o ? this._gl.vertexAttrib3fv(a, p) : 1 == o && this._gl.vertexAttrib1fv(a, p))
                        }
                    }
            this._updateVertexAttribArray()
        }, m._updateVertexAttribArray = function() {
            for (var e = 0; e < this._enabledAttributesCache.length; ++e) g[e] ? (this._gl.enableVertexAttribArray(e), this._enabledAttributesCache[e] = !0) : this._enabledAttributesCache[e] && (this._gl.disableVertexAttribArray(e), this._enabledAttributesCache[e] = !1)
        }, m.setAndClearRenderTarget = function(e, t, i) {
            this.setRenderTarget(e, i), this._clearRenderTarget(t)
        }, m._clearRenderTarget = function(e) {
            e ? this._gl.clearColor(e.r, e.g, e.b, e.a) : this._gl.clearColor(this._clearColor.r, this._clearColor.g, this._clearColor.b, this._clearColor.a), this.clear(), e && this._gl.clearColor(this._clearColor.r, this._clearColor.g, this._clearColor.b, this._clearColor.a)
        }, m.setCamera = function(e) {
            e.projectionMatrix.flattenToArray(this._projectionMatrix), this._viewMatrix.copy(e.viewMatrix), this._viewMatrix.flattenToArray(this._viewMatrixArray, 0), this._currentProgram = null
        }, m.renderObjects = function(e, t, i, n) {
            for (var r, o = null, a = 0; a !== e.length; ++a) {
                r = e[a];
                var s = !0;
                if (i && (s = r.handleRenderPass[i], n && (s = !s)), r.visible && r.material.visible && s) {
                    if (t) {
                        var l = r.material;
                        if (!l.program) {
                            this.initMaterial(l);
                            continue
                        }
                        if (l.program.building) continue;
                        o = this._getMaterialOverride(l, t)
                    }
                    this.renderObject(r, o, i)
                }
            }
        }, m._getMaterialOverride = function(e, t) {
            var i = null,
                n = e.uniforms.tex0 && e.uniforms.tex0.texture,
                r = e.uniforms.uMaxHeight;
            return t.isCallback ? (i = t.callback(e), null == i && (console.error("No material override found for " + e.effectName), i = e)) : i = t.isList ? t[this._getMaterialOverrideName(e, n, r)] : t, n && i.uniforms.tex0 && (this._currentMaterialId == i.id ? this.setTexture(n, 0) : i.uniforms.tex0.texture = n), r && i.uniforms.uMaxHeight && (i.uniforms.uMaxHeight.value = e.uniforms.uMaxHeight.value), i
        }, m._getMaterialOverrideName = function(e, t, i) {
            var n = t ? "texture" : "";
            return e.useSkinning() ? n += t ? "_skinning" : "skinning" : e.useMiniSkinning() ? n += t ? "_miniSkinning" : "miniSkinning" : e.effectName.indexOf("_envmap") > -1 ? n += t ? "_envmap" : "envmap" : "" == n && (n = "default"), i && (n += "_heightCropping"), n
        }, m.setBufferData = function(e, t, i) {
            e && (this._gl.bindBuffer(this._gl.ARRAY_BUFFER, t), this._gl.bufferData(this._gl.ARRAY_BUFFER, e, i))
        }, m.updateObjects = function(e) {
            var t, i = e.length;
            for (t = 0; i > t; ++t) this.updateObject(e[t])
        }, m.updateObject = function(e) {
            var t = e.geometry;
            if (!t) return void console.error("updateObject without geometry " + e);
            if (null == t.__webglAttributeBuffers && e.updateMatrix(), t.needsRebuildWebGLBuffer()) {
                var i = e.material,
                    n = this._gl.STATIC_DRAW;
                t.__webglAttributeBuffers || (t.__webglAttributeBuffers = {}, this.info.memory.geometries++), this.info.memory.geometryBufferSizes[t.id] = 0;
                var r = t.attributes;
                r || (r = i.program.building ? o.keys(i.program.attributesConf) : o.compact(o.pluck(i.program.attributes, "name")));
                var a, s = r.length;
                for (a = 0; s > a; ++a) {
                    var l = r[a];
                    if (!t.isAttributeInterleaved(l)) {
                        var h = t.getAttributeBuffer32(l, this);
                        if (h) {
                            var u = t.__webglAttributeBuffers[l];
                            u || (u = t.__webglAttributeBuffers[l] = this._gl.createBuffer()), this.setBufferData(h, u, n), this.info.memory.geometryBufferSizes[t.id] += 4 * h.length
                        } else {
                            var d = t.getAttributeValue(l, this);
                            d && (t.__webglAttributeValues || (t.__webglAttributeValues = {}), t.__webglAttributeValues[l] = d)
                        }
                    }
                }
                var c = t.getInterleavedBuffer32();
                c && this._updateObjectInterleaved(t, c, n), t.getIndexCount() > 0 && this._updateObjectIndexed(t, n), t.onWebGLBufferGenerated()
            }
        }, m._updateObjectInterleaved = function(e, t, i) {
            var n = e.__webglInterleavedVertexBuffer;
            n || (n = e.__webglInterleavedVertexBuffer = this._gl.createBuffer()), this.setBufferData(t, n, i), this.info.memory.geometryBufferSizes[e.id] += 4 * t.length
        }, m._updateObjectIndexed = function(e, t) {
            var i = e.getIndexBuffer16();
            i && (e.__webglIndexBuffer || (e.__webglIndexBuffer = this._gl.createBuffer()), this._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, e.__webglIndexBuffer), this._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, i, t), this.info.memory.geometryBufferSizes[e.id] += 2 * i.length)
        }, m.initMaterial = function(e) {
            e.program || (e.program = this.buildProgram(e.effectName, e.shader))
        }, m.setProgram = function(e, t) {
            var i = e.program,
                n = i.uniformsLocations,
                r = !1,
                o = !1;
            if (i !== this._currentProgram && (this._gl.useProgram(i), this._currentProgram = i, r = !0, o = !0), e.id !== this._currentMaterialId && (this._currentMaterialId = e.id, r = !0), o) {
                if (!this.loadUniforms(i, e.commonUniforms)) return null;
                null != n.projectionMatrix && this._gl.uniformMatrix4fv(n.projectionMatrix, !1, this._projectionMatrix), null != n.viewport && this._gl.uniform4f(n.viewport, this._viewportX, this._viewportY, this._viewportWidth, this._viewportHeight), null != n.screenSize && this._gl.uniform2f(n.screenSize, this._clientWidth, this._clientHeight), null != n.pixelRatio && this._gl.uniform1f(n.pixelRatio, this._pixelRatio)
            }
            if (r && !this.loadUniforms(i, e.uniforms)) return null;
            if (n.bonesMatrix && e.useSkinning()) {
                var a = t.getSkinningMatrixArray();
                a && this._gl.uniformMatrix4fv(n.bonesMatrix, !1, a)
            }
            if (n.bonesQuat && e.useMiniSkinning()) {
                var s = t.getSkinningMatrixArray();
                s && this._gl.uniform4fv(n.bonesQuat, s)
            }
            return null != n.objectID && this._gl.uniform1i(n.objectID, t.id), this._setMatrixUniforms(t, n), i
        }, m._setMatrixUniforms = function(e, t) {
            null != t.modelViewMatrix && (l.MultiplyToArray(this._viewMatrix, e.matrixWorld, this._modelViewMatrixArray), this._gl.uniformMatrix4fv(t.modelViewMatrix, !1, this._modelViewMatrixArray)), null != t.objectMatrix && this._gl.uniformMatrix4fv(t.objectMatrix, !1, e._objectMatrixArray), null != t.viewMatrix && this._gl.uniformMatrix4fv(t.viewMatrix, !1, this._viewMatrixArray)
        }, m.loadUniform = function(e, t, i) {
            var n;
            return null == t.value && null == t.slot || !(n = e.uniformsLocations[i]) ? !0 : this._loadUniformLocation(t, n)
        }, m._loadUniformLocation = function(e, t) {
            if ("t" === e.type) {
                if (e.texture && this.setTexture(e.texture, e.slot), !e.texture || !e.texture.__webglTexture || !this._currentTextures[e.slot]) return !1;
                this._gl.uniform1i(t, e.slot)
            } else "c" === e.type ? this._gl.uniform4f(t, e.value.r, e.value.g, e.value.b, e.value.a) : "f" === e.type ? this._gl.uniform1f(t, e.value) : "v3" === e.type ? this._gl.uniform3f(t, e.value.x, e.value.y, e.value.z) : "v4" === e.type ? this._gl.uniform4f(t, e.value.x, e.value.y, e.value.z, e.value.w) : "v2" === e.type ? this._gl.uniform2f(t, e.value.x, e.value.y) : "i" === e.type ? this._gl.uniform1i(t, e.value) : "m4" === e.type ? (e._array || (e._array = new Float32Array(16)), e.value.flattenToArray(e._array), this._gl.uniformMatrix4fv(t, !1, e._array)) : "v3v" === e.type && this._gl.uniform3fv(t, e.value);
            return !0
        }, m.loadUniforms = function(e, t) {
            var i;
            for (var n in t)
                if (i = t[n], o.isArray(i))
                    for (var r = 0; r < i.length; r++) {
                        var a = n + "[" + r + "]";
                        if (!this.loadUniform(e, i[r], a)) return !1
                    } else if (!this.loadUniform(e, i, n)) return !1;
            return !0
        }, m.setObjectCulling = function(e) {
            this._currentDoubleSided !== e.doubleSided && (e.doubleSided ? this._gl.disable(this._gl.CULL_FACE) : this._gl.enable(this._gl.CULL_FACE), this._currentDoubleSided = e.doubleSided)
        }, m.setCullFace = function(e) {
            this._gl.cullFace(e)
        }, m.setDepthTest = function(e) {
            this._currentDepthTest !== e && (e ? this._gl.enable(this._gl.DEPTH_TEST) : this._gl.disable(this._gl.DEPTH_TEST), this._currentDepthTest = e)
        }, m.setStencilFunction = function(e, t, i) {
            this.stencilAvailable && (null !== e ? (this._gl.enable(this._gl.STENCIL_TEST), this._gl.stencilFunc(t, e, 255), null != i ? (this._gl.stencilOp(this._gl.KEEP, this._gl.KEEP, i), this._currentStencilValue = 255, this._gl.stencilMask(255)) : (this._currentStencilValue = 0, this._gl.stencilMask(0))) : (this._gl.disable(this._gl.STENCIL_TEST), this._gl.stencilMask(0), this._currentStencilValue = 0))
        }, m.setColorWrite = function(e) {
            this._currentColorWrite != e && (this._currentColorWrite = e, this._gl.colorMask(e, e, e, e))
        }, m.setDepthWrite = function(e) {
            this._currentDepthWrite !== e && (this._gl.depthMask(e), this._currentDepthWrite = e)
        }, m.setBlending = function(e) {
            e !== this._currentBlending && (e == a.NoBlending ? this._gl.disable(this._gl.BLEND) : (this._currentBlending == a.NoBlending && this._gl.enable(this._gl.BLEND), e == a.NormalBlending ? (this._gl.blendEquation(this._gl.FUNC_ADD), this._gl.blendFunc(this._gl.SRC_ALPHA, this._gl.ONE_MINUS_SRC_ALPHA)) : e == a.AdditiveAlphaBlending ? (this._gl.blendEquation(this._gl.FUNC_ADD), this._gl.blendFunc(this._gl.SRC_ALPHA, this._gl.ONE)) : e == a.MultiplyBlending ? (this._gl.blendEquation(this._gl.FUNC_ADD), this._gl.blendFunc(this._gl.ZERO, this._gl.SRC_COLOR)) : e == a.AdditiveAllBlending ? (this._gl.blendEquation(this._gl.FUNC_ADD), this._gl.blendFunc(this._gl.ONE, this._gl.ONE)) : console.error("Unknown blending", e)), this._currentBlending = e)
        }, m.setScissor = function(e) {
            null != this._currentScissor && null == e ? this._gl.disable(this._gl.SCISSOR_TEST) : null == this._currentScissor && null != e && this._gl.enable(this._gl.SCISSOR_TEST), e && (null == this._currentScissor || this._currentScissor.x != e.x || this._currentScissor.y != e.y || this._currentScissor.width != e.width || this._currentScissor.height != e.height) && this._gl.scissor(e.x, e.y, e.width, e.height), this._currentScissor = e
        }, m.buildProgram = function(e, t) {
            var i = f.now(),
                n = this._programs[e];
            if (!n) {
                n = this._gl.createProgram(), n.effectName = e, n.id = this._programsCounter++, n.building = !0, this._programs[e] = n, n.uniformsLocations = {}, n.attributesByName = {}, n.attributes = [], n.attributesConf = {
                    position: 3,
                    normal: 3,
                    uv: 2,
                    color: 4,
                    weights: 2,
                    bonesIndex: 3,
                    miniSkinIndex: 1,
                    userData: 4
                }, t.attributes && o.extend(n.attributesConf, t.attributes), this.info.memory.programs++;
                var r = {
                    effectName: e,
                    shader: t,
                    program: n
                };
                u.isAndroid() || this._gl.bindAttribLocation(n, 0, "position"), this._linkingPrograms.push(r)
            }
            var a = f.now();
            return this.shaderBuildTime += a - i, n
        }, m.linkProgram = function(e) {
            var t = e.program,
                i = e.shader;
            this._gl.attachShader(t, this.getShader(this._gl.FRAGMENT_SHADER, i.fragmentCode)), this._gl.attachShader(t, this.getShader(this._gl.VERTEX_SHADER, i.vertexCode)), this._gl.linkProgram(t), this._buildingPrograms.push(e)
        }, m.endBuildProgram = function(e) {
            var t = e.program,
                i = e.shader;
            this._debugEnabled && !this._gl.getProgramParameter(t, this._gl.LINK_STATUS) && (console.error("Could not initialise shader %s\nVALIDATE_STATUS: ", e.effectName, this._gl.getProgramParameter(t, this._gl.VALIDATE_STATUS), this._gl.getError()), console.error("Program Info Logs:", this._gl.getProgramInfoLog(t))), t.building = !1;
            var n = ["viewMatrix", "projectionMatrix", "objectMatrix", "modelViewMatrix", "objectID"],
                r = function(e, t) {
                    if (o.isArray(e))
                        for (var i = 0; i < e.length; i++) n.push(t + "[" + i + "]");
                    else n.push(t)
                };
            o.each(i.uniforms, r), o.each(i.commonUniforms, r);
            for (var a, s = 0; s < n.length; s++) a = n[s], t.uniformsLocations[a] = this._gl.getUniformLocation(t, a);
            o.each(t.attributesConf, function(e, i) {
                if (e !== !1) {
                    var n = this._gl.getAttribLocation(t, i);
                    t.attributesByName[i] = n, n >= 0 && (t.attributes[n] = {
                        name: i,
                        size: e
                    })
                }
            }, this)
        }, m.isGeneratingShaders = function() {
            return this._buildingPrograms.length > 0 || this._linkingPrograms.length > 0
        }, m.endBuildPrograms = function(e) {
            if (this._buildingPrograms.length > 0 || this._linkingPrograms.length > 0) {
                for (var t = f.now(), i = 0; this._buildingPrograms.length > 0 && e > i;) this.endBuildProgram(this._buildingPrograms.shift()), i = f.now() - t;
                for (; this._linkingPrograms.length > 0 && e > i;) this.linkProgram(this._linkingPrograms.shift()), i = f.now() - t;
                this.shaderBuildTime += i, this._forceRenderCallback(), this._onShadersGenerated()
            }
        }, m.onShadersReady = function(e) {
            this.isGeneratingShaders() ? this._onShadersGeneratedCallbacks.push(e) : e()
        }, m._onShadersGenerated = function() {
            this.isGeneratingShaders() || (o.each(this._onShadersGeneratedCallbacks, function(e) {
                return e()
            }), this._onShadersGeneratedCallbacks = [])
        }, m.releaseProgram = function(e) {
            for (var t = this._gl.getAttachedShaders(e); t && t.length;) {
                var i = t.pop();
                this._gl.detachShader(e, i), this._gl.deleteShader(i)
            }
            this._gl.deleteProgram(e), this._currentProgram = null, delete this._programs[e.effectName], this.info.memory.programs--
        }, m.releaseAllPrograms = function() {
            o.each(this._programs, function(e) {
                this.releaseProgram(e)
            }, this), this._programs = {}, this._linkingPrograms = [], this._buildingPrograms = []
        }, m.getShader = function(e, t) {
            var i = this._gl.createShader(e);
            return this._gl.shaderSource(i, t), this._gl.compileShader(i), this._debugEnabled && !this._gl.getShaderParameter(i, this._gl.COMPILE_STATUS) && (console.error(this._gl.getShaderInfoLog(i)), console.error(t)), i
        }, m.setTextureParameters = function(e, t) {
            if (t ? (this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, e.wrap), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, e.wrap)) : (this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_S, this._gl.CLAMP_TO_EDGE), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_WRAP_T, this._gl.CLAMP_TO_EDGE)), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MAG_FILTER, e.magFilter), this._gl.texParameteri(this._gl.TEXTURE_2D, this._gl.TEXTURE_MIN_FILTER, e.minFilter), this.anisotropicExt) {
                var i = e.useAnisotropic ? this.anisotropicExt.max : 1;
                this._gl.texParameterf(this._gl.TEXTURE_2D, this.anisotropicExt.TEXTURE_MAX_ANISOTROPY_EXT, i)
            }
        }, m.bindTexture = function(e) {
            if (this._currentTextures[this._activeTextureSlot] != e) {
                this._currentTextures[this._activeTextureSlot] = e;
                var t = null != e ? e.__webglTexture : null;
                return this._gl.bindTexture(this._gl.TEXTURE_2D, t), !0
            }
            return !1
        }, m.setActiveTextureSlot = function(e) {
            e >= this._maxTextureUnit ? console.warn("Desired texture slot " + e + " exceeds maxium allowed " + this._maxTextureUnit) : e != this._activeTextureSlot && (this._gl.activeTexture(this._gl.TEXTURE0 + e), this._activeTextureSlot = e)
        }, m.setTexture = function(e, t) {
            if (e.needsUpdate && null == e.__webglTexture && (e.__webglTexture = this._gl.createTexture(), this._updateTextureStats(e)), e.__webglTexture) {
                var i = e.image,
                    r = e.array ? e.array.width : e.width || i.width,
                    o = e.array ? e.array.height : e.height || i.height;
                (r > this._maxTextureSize || o > this._maxTextureSize) && console.error("Texture", e.sourcePath, "is too big for this hardware :", r, o, ">", this._maxTextureSize);
                var a = n(r) && n(o);
                this.setActiveTextureSlot(t);
                var s = this.bindTexture(e);
                s && this.setTextureParameters(e, a), e.needsUpdate && this._updateTexture(e, i, r, o, a)
            }
        }, m._updateTextureStats = function(e) {
            this.info.memory.textures++, this.info.textures[e.id] = {
                name: e.loadedName,
                size: 0,
                texture: e
            }
        }, m._updateTexture = function(e, t, i, n, r) {
            var o = Date.now();
            if (e.id >= 0) {
                var a = e.format,
                    s = e.type;
                e.array ? (this._gl.texImage2D(this._gl.TEXTURE_2D, 0, a, i, n, 0, a, s, e.array.value), this.info.textures[e.id].size = i * n * this.bytesForTextureFormat(a)) : e.compressionHandler ? e.compressionHandler.uploadData(this._gl, this.glExtensionManager) : (this._gl.texImage2D(this._gl.TEXTURE_2D, 0, a, a, s, t), this.info.textures[e.id].size = t.width * t.height * this.bytesForTextureFormat(a))
            }
            e.generateMipmaps && (r ? this._gl.generateMipmap(this._gl.TEXTURE_2D) : console.error("Can't generate mipmap on texture", e.sourcePath, "size is not power of 2")), e.needsUpdate = !1;
            var l = Date.now();
            this.textureCreationTime += l - o
        }, m.setLeftViewPort = function() {
            var e = this.getViewSize();
            this.setViewportRectangle(0, 0, e.width, e.height)
        }, m.setRightViewPort = function() {
            var e = this.getViewSize();
            this.setViewportRectangle(e.width, 0, e.width, e.height)
        }, m.setTopViewPort = function() {
            var e = this.getViewSize();
            this.setViewportRectangle(0, 0, e.width, e.height)
        }, m.setBottomViewPort = function() {
            var e = this.getViewSize();
            this.setViewportRectangle(0, e.height, e.width, e.height)
        }, m.getSize = function() {
            return {
                w: this._clientWidth,
                h: this._clientHeight
            }
        }, m.setSideBySide = function(e) {
            this._sideBySide = e
        }, m.setTopToBottom = function(e) {
            this._topToBottom = e
        }, m.setDepthMap = function(e) {
            this._depthMap = e
        }, m.getViewSize = function() {
            var e = this._canvas.width,
                t = this._canvas.height;
            return this._depthMap || this._sideBySide ? e *= .5 : this._topToBottom && (t *= .5), {
                width: e,
                height: t
            }
        }, m.setRenderTarget = function(e, t) {
            if (e == this._currentRenderTarget) {
                if (!e) return;
                if (e.__webglFramebuffer && e.__webglTexture) return
            }
            if (this._currentRenderTarget = e, e && (!e.__webglFramebuffer || !e.__webglTexture)) {
                e.__webglTexture || (e.__webglTexture = this._gl.createTexture(), this.info.textures[e.id] = {
                    name: "renderTarget" + e.id,
                    size: 0,
                    texture: e
                }), e.__webglFramebuffer || (e.__webglFramebuffer = this._gl.createFramebuffer());
                var i = n(e.width) && n(e.height),
                    r = e.format,
                    o = e.type;
                if (this.bindTexture(e), this.setTextureParameters(e, i), this._gl.texImage2D(this._gl.TEXTURE_2D, 0, r, e.width, e.height, 0, r, o, null), this.info.textures[e.id].size = e.width * e.height * this.bytesForTextureFormat(r), this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, e.__webglFramebuffer), this._gl.framebufferTexture2D(this._gl.FRAMEBUFFER, this._gl.COLOR_ATTACHMENT0, this._gl.TEXTURE_2D, e.__webglTexture, 0), e.depthBuffer) {
                    e.__webglRenderbuffer = this._gl.createRenderbuffer(), this._gl.bindRenderbuffer(this._gl.RENDERBUFFER, e.__webglRenderbuffer);
                    var a = e.stencilBuffer ? this._gl.DEPTH_STENCIL : this._gl.DEPTH_COMPONENT16,
                        s = e.stencilBuffer ? this._gl.DEPTH_STENCIL_ATTACHMENT : this._gl.DEPTH_ATTACHMENT;
                    this._gl.renderbufferStorage(this._gl.RENDERBUFFER, a, e.width, e.height), this._gl.framebufferRenderbuffer(this._gl.FRAMEBUFFER, s, this._gl.RENDERBUFFER, e.__webglRenderbuffer)
                }
                this.bindTexture(null), this._gl.bindRenderbuffer(this._gl.RENDERBUFFER, null), this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, null)
            }
            var l, h, u;
            if (e) l = e.__webglFramebuffer, h = e.width, u = e.height;
            else {
                l = null;
                var d = this.getViewSize();
                h = d.width, u = d.height
            }
            this._gl.bindFramebuffer(this._gl.FRAMEBUFFER, l), t && t.updateViewportDisabled || this.setViewport(h, u)
        }, m.bytesForTextureFormat = function(e) {
            return e == a.AlphaFormat ? 1 : e == a.LuminanceAlphaFormat ? 2 : e == a.RGBFormat ? 3 : 4
        }, m.getTexureMemoryUsage = function() {
            var e = 0;
            return o.each(this.info.textures, function(t) {
                e += t.size
            }), e
        }, m.printTexureNames = function() {
            var e = [];
            o.each(this.info.textures, function(t) {
                t.name && e.push(t.name + " : " + t.texture.refCount)
            }), e.sort();
            for (var t = "", i = 0; i < e.length; i++) t += e[i] + "\n";
            console.log(t)
        }, m.remapConstantsWithGLValues = function() {
            a.TRIANGLES = this._gl.TRIANGLES, a.POINTS = this._gl.POINTS, a.LINES = this._gl.LINES, a.FRONT = this._gl.FRONT, a.BACK = this._gl.BACK, a.KEEP = this._gl.KEEP, a.REPLACE = this._gl.REPLACE, a.INCR = this._gl.INCR, a.EQUAL = this._gl.EQUAL, a.ALWAYS = this._gl.ALWAYS, a.NOTEQUAL = this._gl.NOTEQUAL, a.RepeatWrapping = this._gl.REPEAT, a.ClampToEdgeWrapping = this._gl.CLAMP_TO_EDGE, a.MirroredRepeatWrapping = this._gl.MIRRORED_REPEAT, a.NearestFilter = this._gl.NEAREST, a.NearestMipMapNearestFilter = this._gl.NEAREST_MIPMAP_NEAREST, a.NearestMipMapLinearFilter = this._gl.NEAREST_MIPMAP_LINEAR, a.LinearFilter = this._gl.LINEAR, a.LinearMipMapNearestFilter = this._gl.LINEAR_MIPMAP_NEAREST, a.LinearMipMapLinearFilter = this._gl.LINEAR_MIPMAP_LINEAR, a.ByteType = this._gl.BYTE, a.UnsignedByteType = this._gl.UNSIGNED_BYTE, a.ShortType = this._gl.SHORT, a.UnsignedShortType = this._gl.UNSIGNED_SHORT, a.IntType = this._gl.INT, a.UnsignedIntType = this._gl.UNSIGNED_INT, a.FloatType = this._gl.FLOAT, a.AlphaFormat = this._gl.ALPHA, a.RGBFormat = this._gl.RGB, a.RGBAFormat = this._gl.RGBA, a.LuminanceFormat = this._gl.LUMINANCE, a.LuminanceAlphaFormat = this._gl.LUMINANCE_ALPHA
        }
    }, {
        "./Color": 13,
        "./Constants": 14,
        "./WebGLDebugUtils": 21,
        "./math/Matrix4": 60,
        "./utils/WebGLExtensionManager": 84,
        "browser-detect": 11,
        underscore: 207
    }],
    23: [function(e, t, i) {
        "use strict";

        function n() {
            this.durationMs = 0, this.keys = []
        }
        t.exports = n;
        var r = n.prototype;
        r.addKey = function(e) {
            this.keys.push(e), this.durationMs = e.timeStamp
        }, r.updatePosture = function(e, t, i) {
            for (var n = null, r = i, o = this.keys[this.keys.length - 1].timeStamp; t > o;) t -= o;
            for (var a = !1, s = 0; !a && s < this.keys.length; ++s) n = r, r = this.keys[s], a = r.timeStamp > t;
            var l = (t - n.timeStamp) / (r.timeStamp - n.timeStamp);
            e.copyMatrixList(n), e.lerpToKey(r, l)
        }, r.clone = function() {
            for (var e = new n, t = 0; t < this.keys.length; t++) e.addKey(this.keys[t].clone());
            return e
        }
    }, {}],
    24: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.timeStamp = e, this.matrixList = []
        }
        t.exports = n;
        var r = n.prototype;
        r.addMatrix = function(e) {
            this.matrixList.push(e)
        }, r.copyMatrixList = function(e) {
            for (var t = 0; t < e.matrixList.length; ++t) this.matrixList[t].copy(e.matrixList[t])
        }, r.clone = function() {
            for (var e = new n(this.timeStamp), t = 0; t < this.matrixList.length; ++t) e.addMatrix(this.matrixList[t].clone());
            return e
        }, r.lerpToKey = function(e, t) {
            for (var i = 0; i < this.matrixList.length; ++i) this.matrixList[i].lerp(e.matrixList[i], t)
        }
    }, {}],
    25: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            r.call(this), this.index = e, this.parentIndex = t, this.bindPoseMatrix = i, this.skinningMatrix = new o
        }
        var r = e("../object/Object3D"),
            o = e("../math/Matrix4");
        t.exports = n, n.prototype = new r, n.prototype.constructor = n, n.prototype.supr = r.prototype, n.prototype.updateMatrix = function() {
            this.parent ? this.matrixWorld.multiply(this.parent.matrixWorld, this.matrix) : this.matrixWorld.copy(this.matrix), this.skinningMatrix.multiply(this.matrixWorld, this.bindPoseMatrix);
            for (var e = 0; e < this.children.length; e++) this.children[e].updateMatrix()
        }, n.prototype.clone = function() {
            return new n(this.index, this.parentIndex, this.bindPoseMatrix.clone())
        }
    }, {
        "../math/Matrix4": 60,
        "../object/Object3D": 70
    }],
    26: [function(e, t, i) {
        "use strict";

        function n() {
            this.animationData = [], this._animationKeys = [], this.durationMs = 0, this.numberOfMatrices = 0
        }
        var r = e("./AnimationKey"),
            o = e("../math/Matrix4");
        t.exports = n;
        var a = n.prototype;
        a.addAnimation = function(e, t, i) {
            null == i && (i = 1), this.animationData.push({
                animation: e,
                timeOffset: t,
                speed: i
            });
            var n = e.durationMs / i;
            0 == this.durationMs && (this.durationMs = 1), this.durationMs = Math.max(n, this.durationMs), this.numberOfMatrices += e.keys[0].matrixList.length;
            for (var a = new r, s = 0; s < e.keys[0].matrixList.length; s++) a.addMatrix(new o);
            this._animationKeys.push(a)
        }, a.updatePosture = function(e, t) {
            if (e.matrixList.length == this.numberOfMatrices)
                for (var i = 0, n = 0; n < this.animationData.length; n++) {
                    var r = this.animationData[n],
                        o = this._animationKeys[n],
                        a = r.speed * t + r.timeOffset;
                    r.animation.updatePosture(o, a, null);
                    for (var s = 0; s < o.matrixList.length; s++) e.matrixList[s + i].copy(o.matrixList[s]);
                    i += o.matrixList.length
                } else console.error("Not equal number of animations and matrices")
        }
    }, {
        "../math/Matrix4": 60,
        "./AnimationKey": 24
    }],
    27: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.bones = [];
            for (var t = 0; e > t; ++t) this.bones.push(null);
            this.bonesMatrixArray = new Float32Array(16 * e), this.animations = null, this.currentAnim = null, this.currentPosture = null, this.blendingPosture = null, this.currentTime = 0, this.animationFrameCallback = null
        }
        var r = e("underscore"),
            o = e("./AnimationKey"),
            a = e("../math/Matrix4");
        t.exports = n;
        var s = n.prototype;
        s.addBone = function(e) {
            this.bones[e.index] = e, e.skinningMatrix.flattenToArray(this.bonesMatrixArray, 16 * e.index)
        }, s.updateHierarchy = function() {
            null != this.currentPosture && console.error("Skeleton.updateHierarchy already called!"), this.currentPosture = new o(0), r.each(this.bones, function(e) {
                -1 != e.parentIndex && this.bones[e.parentIndex].add(e), this.currentPosture.addMatrix(new a)
            }, this), this.computeAnim(0)
        }, s.updateFromPosture = function() {
            for (var e = 0; e < this.bones.length; ++e) this.bones[e].matrix.copy(this.currentPosture.matrixList[e]);
            for (var t = 0; t < this.bones.length; ++t) - 1 == this.bones[t].parentIndex && this.bones[t].updateMatrix();
            for (var i = 0; i < this.bones.length; ++i) {
                var n = this.bones[i].skinningMatrix;
                n.flattenToArray(this.bonesMatrixArray, 16 * i)
            }
        }, s.computeAnim = function(e) {
            this.currentAnim && (this.currentTime = (this.currentTime + e) % this.currentAnim.durationMs, this.blendingPosture && this.currentTime > 0 && (this.blendingPosture = null), this.currentAnim.updatePosture(this.currentPosture, this.currentTime, this.blendingPosture), this.updateFromPosture(), this.animationFrameCallback && this.animationFrameCallback(this))
        }, s.playAnimation = function(e, t) {
            (0 > e || e > this.animations.length - 1) && (console.error("Given animation index does not exist:", e), e = 0), this.currentAnim && (t = t || 200, this.blendingPosture = this.currentPosture.clone(), this.blendingPosture.timeStamp = -t, this.currentTime = -t), this.currentAnim = this.animations[e]
        }, s.setAnimations = function(e) {
            this.animations = e
        }, s.clone = function() {
            var e = new n(this.bones.length);
            return r.each(this.bones, function(t) {
                e.addBone(t.clone())
            }, this), e.setAnimations(this.animations), e.updateHierarchy(), e
        }, s.deepClone = function() {
            var e = new n(this.bones.length);
            r.each(this.bones, function(t) {
                e.addBone(t.clone())
            }, this);
            for (var t = [], i = 0; i < this.animations.length; i++) t.push(this.animations[i].clone());
            return e.setAnimations(t), e.updateHierarchy(), e
        }
    }, {
        "../math/Matrix4": 60,
        "./AnimationKey": 24,
        underscore: 207
    }],
    28: [function(e, t, i) {
        "use strict";

        function n() {
            r.call(this), this.viewMatrix = new o, this.projectionMatrix = new o, this.projectionMatrixInverse = new o, this.projScreenMatrix = new o, this._projectionMatrixArray = new Float32Array(16), this.up = new a(0, 1, 0), this.target = new a
        }
        var r = e("../object/Object3D"),
            o = e("../math/Matrix4"),
            a = e("../math/Vector3");
        t.exports = n, n.prototype = new r, n.prototype.constructor = n, n.prototype.lookAt = function(e) {
            this.target.set(e.x, e.y, e.z), this.matrix.lookAt(this.position, this.target, this.up), this.rotation.getRotationFromMatrix(this.matrix)
        }, n.prototype.updateMatrix = function() {
            r.prototype.updateMatrix.call(this), this.updateProjectionMatrix(), this.viewMatrix.getInverse(this.matrixWorld), this.projScreenMatrix.multiply(this.projectionMatrix, this.viewMatrix)
        }
    }, {
        "../math/Matrix4": 60,
        "../math/Vector3": 63,
        "../object/Object3D": 70
    }],
    29: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, a, s) {
            r.call(this), this.left = e, this.right = t, this.top = i, this.bottom = n, this.near = void 0 !== a ? a : .1, this.far = void 0 !== s ? s : 2e3, this.projectionMatrix = new o, this.updateProjectionMatrix()
        }
        var r = e("./Camera"),
            o = e("../math/Matrix4");
        t.exports = n, n.prototype = new r, n.prototype.constructor = n, n.prototype.updateProjectionMatrix = function() {
            this.projectionMatrix.makeOrtho(this.left, this.right, this.top, this.bottom, this.near, this.far)
        }
    }, {
        "../math/Matrix4": 60,
        "./Camera": 28
    }],
    30: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            r.call(this), this.fov = void 0 !== e ? e : 50, this.aspect = void 0 !== t ? t : 1, this.near = void 0 !== i ? i : .1, this.far = void 0 !== n ? n : 2e3, this.projectionMatrix = new o, this.updateProjectionMatrix()
        }
        var r = e("./Camera"),
            o = e("../math/Matrix4");
        t.exports = n, n.prototype = new r, n.prototype.constructor = n, n.prototype.updateProjectionMatrix = function() {
            this.projectionMatrix.makePerspective(this.fov, this.aspect, this.near, this.far)
        }
    }, {
        "../math/Matrix4": 60,
        "./Camera": 28
    }],
    31: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.id = n.MaterialCount++, this.transparent = r.Opaque, this.depthTest = !0, this.depthWrite = !0, this.blending = e.blending, this.effectName = e.effectName, this.shader = e.shader, this.commonUniforms = e.shader.commonUniforms, this.uniforms = e.uniforms, this.program = null, this.visible = !0
        }
        var r = e("../Constants");
        t.exports = n, n.prototype = {
            constructor: n,
            useSkinning: function() {
                return this.program.attributesByName.weights >= 0 && this.program.attributesByName.bonesIndex >= 0
            },
            useMiniSkinning: function() {
                return this.program.attributesByName.miniSkinIndex >= 0
            }
        }, n.MaterialCount = 0
    }, {
        "../Constants": 14
    }],
    32: [function(e, t, i) {
        "use strict";

        function n(t, i, n) {
            this._renderEngine = i, this._shaderLibrary = n, this.conf = t, this.maxBonesCount = 32, this.miniSkinMaxBonesCount = 200, this._renderEngine._webGL._maxVertexUniforms < 254 && (this.maxBonesCount = 24, this.miniSkinMaxBonesCount = 50), this.materials = [], this._vertexHeader = e("./shader/vertexFunctions.shaderlib"), this._fragmentHeader = e("./shader/fragmentFunctions.shaderlib"), this._precisions = this._renderEngine._webGL.queryPrecisionHeaderString(), this.buildDefines(), this.conf.on && this.conf.on("change:shadows.debugShadowArea", o.bind(this.rebuildShader, this)), this._renderEngine.on("preRender", o.bind(this.updateTimer, this))
        }
        var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
            },
            o = e("underscore"),
            a = e("../Constants"),
            s = e("./Material");
        t.exports = n, n.prototype.getDebugMaterial = function() {
            return null == this.debugMaterial && (this.debugMaterial = this.createMaterial("nolight", a.NoBlending), this.debugMaterial.depthTest = !1, this.debugMaterial.transparent = a.SuperGradual), this.debugMaterial
        }, n.prototype.updateTimer = function(e) {
            var t = this._shaderLibrary.uniforms.time.currentTime.value + .001 * e.dt;
            this._shaderLibrary.uniforms.time.currentTime.value = t % 1024
        }, n.prototype.buildDefines = function() {
            this._defines = "";
            var e = this._renderEngine._shadow;
            this.define("SHADOW_ENABLED", e), this.define("SHADOW_SIZE", this.conf.shadows.size), this.define("BONES_COUNT", this.maxBonesCount), this.define("MINI_SKINNING_BONES_COUNT", this.miniSkinMaxBonesCount),
                this.define("SHADOW_DEBUG", this.conf.shadows.debugShadowArea)
        }, n.prototype.define = function(e, t) {
            t === !0 ? this._defines += "#define " + e + "\n" : t !== !1 && (this._defines += "#define " + e + " " + t + "\n")
        }, n.prototype.cloneUniform = function(e) {
            var t, i, n = {};
            for (t in e) i = e[t], i && i.clone ? n[t] = i.clone() : n[t] = i;
            return n
        }, n.prototype.cloneUniforms = function(e) {
            var t, i = {};
            for (t in e)
                if (o.isArray(e[t])) {
                    i[t] = [];
                    for (var n = 0; n < e[t].length; n++) i[t].push(this.cloneUniform(e[t][n]))
                } else i[t] = this.cloneUniform(e[t]);
            return i
        }, n.prototype.rebuildShader = function() {
            return "object" == ("undefined" == typeof Ejecta ? "undefined" : r(Ejecta)) ? void console.warn("rebuildShader not supported with Ejecta") : (this.buildDefines(), this._renderEngine._webGL.releaseAllPrograms(), this.cleanShaders(), o.each(this.materials, function(e) {
                e.program = null;
                var t = e.shader;
                this.buildEffectCode(t, e.effectName), this._renderEngine._webGL.initMaterial(e)
            }, this), void this._renderEngine.forceUpdateShadow())
        }, n.prototype.cleanShaders = function() {
            o.each(this._shaderLibrary.effects, function(e, t) {
                var i = this._shaderLibrary.effects[t];
                delete i.vertexCode, delete i.fragmentCode
            }, this)
        }, n.prototype.releaseMaterial = function(e) {
            var t = this.materials.indexOf(e);
            t >= 0 && this.materials.splice(t, 1)
        }, n.prototype.findEffect = function(e) {
            var t = this._shaderLibrary.effects[e];
            if (null == t) {
                var i = e.split("_"),
                    n = [],
                    r = i.shift();
                o.each(i, function(e) {
                    var t = this._shaderLibrary.extensions[e];
                    t ? n.push(t) : r += "_" + e
                }, this);
                var a = this._shaderLibrary.effects[r];
                a && (t = o.pick(a, "vertexProgramName", "fragmentProgramName", "commonUniformKeys", "vertexDefines", "fragmentDefines"), a.uniforms && (t.uniforms = this.cloneUniforms(a.uniforms)), a.attributes && (t.attributes = o.clone(a.attributes)), o.each(n, function(e) {
                    var i = o.keys(e);
                    o.each(i, function(i) {
                        this.mergeExtensionValues(t, e, i)
                    }, this)
                }, this), this._shaderLibrary.effects[e] = t)
            }
            return t
        }, n.prototype.mergeExtensionValues = function(e, t, i) {
            var n = t[i];
            "uniforms" == i && (n = this.cloneUniforms(n)), o.isArray(n) ? e[i] = (e[i] || []).concat(n) : o.isObject(n) ? e[i] = o.extend(e[i] || {}, n) : o.isString(n) && (e[i] = e[i] ? e[i] + "\n" + n : n)
        }, n.prototype.initCommonUniforms = function(e) {
            if (!e.commonUniforms) {
                var t = e.commonUniforms = {};
                e.commonUniformKeys && o.each(e.commonUniformKeys, function(e) {
                    o.extend(t, this._shaderLibrary.uniforms[e])
                }, this)
            }
        }, n.prototype.buildEffectCode = function(e, t) {
            if (!e.vertexCode) {
                var i = this._shaderLibrary.programs.vertex[e.vertexProgramName];
                e.vertexCode = "//" + t + "\n" + this._precisions + this._defines + "\n" + (e.vertexDefines || "") + "\n" + this._vertexHeader + "\n" + i
            }
            if (!e.fragmentCode) {
                var n = this._shaderLibrary.programs.fragment[e.fragmentProgramName];
                e.fragmentCode = this._precisions + this._defines + "\n" + (e.fragmentDefines || "") + this._fragmentHeader + "\n" + n
            }
        }, n.prototype.createMaterial = function(e, t) {
            null == t && (t = a.NormalBlending);
            var i = this.findEffect(e);
            if (null == i) return console.error("Requested shader does not exist : ", e), this.getDebugMaterial();
            var n = this.cloneUniforms(i.uniforms);
            this.initCommonUniforms(i), this.buildEffectCode(i, e);
            var r = {
                    effectName: e,
                    uniforms: n,
                    shader: i,
                    blending: t
                },
                o = new s(r);
            return this._renderEngine._webGL.initMaterial(o), this.materials.push(o), o
        }, n.prototype.onDivRemoved = function() {
            this.cleanShaders(), this.materials = [], delete this._shaderLibrary, delete this._renderEngine, delete this.conf
        }
    }, {
        "../Constants": 14,
        "./Material": 31,
        "./shader/fragmentFunctions.shaderlib": 45,
        "./shader/vertexFunctions.shaderlib": 59,
        underscore: 207
    }],
    33: [function(e, t, i) {
        "use strict";

        function n(t) {
            this.uniforms = {
                shadow: {
                    shadowTexture: {
                        type: "t",
                        slot: 5,
                        texture: null
                    },
                    shadowMatrix: {
                        type: "m4",
                        value: null
                    },
                    shadowColor: {
                        type: "c",
                        value: new r(t.shadows.color)
                    },
                    shadowBias: {
                        type: "f",
                        value: t.shadows.bias
                    },
                    shadowTextureSize: {
                        type: "v2",
                        value: new a
                    }
                },
                csmShadows: {
                    shadowTexture: {
                        type: "t",
                        slot: 5,
                        texture: null
                    },
                    shadowTextureSize: {
                        type: "v2",
                        value: new a
                    },
                    shadowColor: {
                        type: "c",
                        value: new r(t.shadows.color)
                    },
                    shadowBias: {
                        type: "f",
                        value: t.shadows.csm.bias
                    },
                    shadowSlopeBiasFactor: {
                        type: "f",
                        value: t.shadows.csm.slopeBiasFactor
                    },
                    shadowMatrix: [{
                        type: "m4",
                        value: new s
                    }, {
                        type: "m4",
                        value: new s
                    }, {
                        type: "m4",
                        value: new s
                    }, {
                        type: "m4",
                        value: new s
                    }],
                    splitFarDist: [{
                        type: "f",
                        value: 0
                    }, {
                        type: "f",
                        value: 0
                    }, {
                        type: "f",
                        value: 0
                    }, {
                        type: "f",
                        value: 0
                    }],
                    splitUVRect: [{
                        type: "v4",
                        value: new l
                    }, {
                        type: "v4",
                        value: new l
                    }, {
                        type: "v4",
                        value: new l
                    }, {
                        type: "v4",
                        value: new l
                    }]
                },
                envMap: {
                    envTexture: {
                        type: "t",
                        slot: 2,
                        texture: null
                    }
                },
                light: {
                    vLightDir: {
                        type: "v3",
                        value: new o(0, 0, 1)
                    },
                    vLightFrontColor: {
                        type: "c",
                        value: new r(16777215)
                    },
                    vLightBackColor: {
                        type: "c",
                        value: new r(0)
                    },
                    vLightAmbientColor: {
                        type: "c",
                        value: new r(2236962)
                    },
                    vLightSpecularColor: {
                        type: "c",
                        value: new r(16777215)
                    }
                },
                globalLight: {
                    vGlobalColor: {
                        type: "c",
                        value: new r(16777215)
                    }
                },
                globalAlpha: {
                    fAlpha: {
                        type: "f",
                        value: 1
                    }
                },
                cameraPos: {
                    cameraPosition: {
                        type: "v3",
                        value: null
                    },
                    cameraTarget: {
                        type: "v3",
                        value: null
                    }
                },
                time: {
                    currentTime: {
                        type: "f",
                        value: 0
                    }
                },
                viewport: {
                    viewport: {
                        type: "v4",
                        value: new l
                    }
                },
                screenSize: {
                    screenSize: {
                        type: "v2",
                        value: new a
                    },
                    pixelRatio: {
                        type: "f",
                        value: 1
                    }
                },
                picking: {
                    pickingColor: {
                        type: "c",
                        value: new r
                    }
                },
                depth: {
                    depthBias: {
                        type: "f",
                        value: .001
                    }
                }
            }, this.programs = {
                vertex: {
                    common2D: e("./shader/common2D.vshader"),
                    common3D: e("./shader/common3D.vshader"),
                    fountain: e("./shader/fountain.vshader"),
                    lensFlare: e("./shader/lensFlare.vshader"),
                    sky: e("./shader/sky.vshader"),
                    ssao: e("./shader/ssao.vshader"),
                    ssao_blur: e("./shader/ssao_blur.vshader"),
                    smoke: e("./shader/smoke.vshader"),
                    point: e("./shader/point.vshader"),
                    depthDebug: e("./shader/depthDebug.vshader"),
                    depthMap: e("./shader/depthMap.vshader")
                },
                fragment: {
                    common3D: e("./shader/common3D.fshader"),
                    blobWithoutTexture: e("./shader/blobWithoutTexture.fshader"),
                    depth: e("./shader/depth.fshader"),
                    lensFlare: e("./shader/lensFlare.fshader"),
                    sky: e("./shader/sky.fshader"),
                    ssao: e("./shader/ssao.fshader"),
                    ssao_blur: e("./shader/ssao_blur.fshader"),
                    picking: e("./shader/picking.fshader"),
                    pickingWithIndex: e("./shader/pickingWithIndex.fshader"),
                    point: e("./shader/point.fshader"),
                    depthDebug: e("./shader/depthDebug.fshader"),
                    depthMap: e("./shader/depthMap.fshader")
                }
            }, this.effects = {
                nolight: {
                    uniforms: {},
                    vertexDefines: ["#define NO_GLOBAL_COLOR"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentProgramName: "common3D"
                },
                nolight_texture: {
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    vertexDefines: ["#define USE_UV", "#define NO_GLOBAL_COLOR"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_TEXTURE"].join("\n"),
                    fragmentProgramName: "common3D"
                },
                dirlight: {
                    commonUniformKeys: ["globalLight", "light", "time"],
                    uniforms: {},
                    attributes: {
                        color: !1,
                        compressedColor: 2,
                        normal: !1,
                        compressedNormal: 1
                    },
                    vertexDefines: ["#define USE_LIGHT", "#define USE_COMPRESSED_COLOR", "#define USE_COMPRESSED_NORMAL", "#define USE_TIMER"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentProgramName: "common3D"
                },
                dirlight_texture: {
                    commonUniformKeys: ["globalLight", "light", "time"],
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    attributes: {
                        color: !1,
                        compressedColor: 2,
                        normal: !1,
                        compressedNormal: 1
                    },
                    vertexDefines: ["#define USE_UV", "#define USE_LIGHT", "#define USE_COMPRESSED_COLOR", "#define USE_COMPRESSED_NORMAL", "#define USE_TIMER"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_TEXTURE", "#define USE_LIGHT"].join("\n"),
                    fragmentProgramName: "common3D"
                },
                dirlight_invertZ: {
                    commonUniformKeys: ["globalLight", "light", "globalAlpha", "time"],
                    uniforms: {},
                    attributes: {
                        color: !1,
                        compressedColor: 2,
                        normal: !1,
                        compressedNormal: 1
                    },
                    vertexDefines: ["#define INVERT_Z", "#define USE_LIGHT", "#define USE_COMPRESSED_COLOR", "#define USE_COMPRESSED_NORMAL", "#define USE_TIMER"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_F_ALPHA"].join("\n"),
                    fragmentProgramName: "common3D"
                },
                dirlight_invertZ_texture: {
                    commonUniformKeys: ["globalLight", "light", "globalAlpha", "time"],
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    attributes: {
                        color: !1,
                        compressedColor: 2,
                        normal: !1,
                        compressedNormal: 1
                    },
                    vertexDefines: ["#define USE_UV", "#define INVERT_Z", "#define USE_LIGHT", "#define USE_COMPRESSED_COLOR", "#define USE_COMPRESSED_NORMAL", "#define USE_TIMER"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_TEXTURE", "#define USE_F_ALPHA", "#define USE_LIGHT"].join("\n"),
                    fragmentProgramName: "common3D"
                },
                lensFlare: {
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        },
                        fAlpha: {
                            type: "f",
                            value: 0
                        },
                        sunPosScreenSpace: {
                            type: "v2",
                            value: new a
                        }
                    },
                    vertexProgramName: "lensFlare",
                    fragmentProgramName: "lensFlare"
                },
                fountain: {
                    commonUniformKeys: ["globalLight", "time"],
                    uniforms: {
                        height: {
                            type: "f",
                            value: 14
                        },
                        particleMaxLife: {
                            type: "f",
                            value: 2
                        },
                        spreadingFactor: {
                            type: "f",
                            value: 7.5
                        },
                        particleSize: {
                            type: "f",
                            value: 2048
                        },
                        direction: {
                            type: "v2",
                            value: new a
                        }
                    },
                    vertexDefines: ["#define USE_TIMER"].join("\n"),
                    vertexProgramName: "fountain",
                    fragmentDefines: ["#define IS_POINT_SPRITE"].join("\n"),
                    fragmentProgramName: "blobWithoutTexture"
                },
                smoke: {
                    commonUniformKeys: ["globalLight", "time"],
                    uniforms: {
                        particleMaxLife: {
                            type: "f",
                            value: 20
                        },
                        particleSizes: {
                            type: "v2",
                            value: new a(2, 5)
                        },
                        spreadingfactor: {
                            type: "f",
                            value: 40
                        },
                        emiterScale: {
                            type: "f",
                            value: 3
                        },
                        direction: {
                            type: "v3",
                            value: new o(80, 40, 40)
                        }
                    },
                    vertexDefines: ["#define USE_TIMER"].join("\n"),
                    vertexProgramName: "smoke",
                    fragmentDefines: ["#define IS_POINT_SPRITE"].join("\n"),
                    fragmentProgramName: "blobWithoutTexture"
                },
                sky: {
                    commonUniformKeys: ["globalLight", "time"],
                    uniforms: {
                        cloudsTexture: {
                            type: "t",
                            slot: 0,
                            texture: null
                        },
                        gradientTexture: {
                            type: "t",
                            slot: 6,
                            texture: null
                        },
                        sunDirection: {
                            type: "v3",
                            value: new o(0, 0, -1)
                        },
                        cloudsInfo: {
                            type: "v3",
                            value: new o(0, 0, 0)
                        },
                        cloudColor: {
                            type: "c",
                            value: new r(16777215)
                        }
                    },
                    vertexProgramName: "sky",
                    fragmentDefines: ["#define USE_TIMER"].join("\n"),
                    fragmentProgramName: "sky"
                },
                point: {
                    uniforms: {
                        pointSize: {
                            type: "f",
                            value: 16
                        }
                    },
                    vertexProgramName: "point",
                    fragmentProgramName: "point"
                },
                point_texture: {
                    uniforms: {
                        texture: {
                            type: "t",
                            slot: 0,
                            texture: null
                        },
                        pointSize: {
                            type: "f",
                            value: 16
                        }
                    },
                    fragmentDefines: ["#define USE_TEXTURE"].join("\n"),
                    vertexProgramName: "point",
                    fragmentProgramName: "point"
                },
                depth: {
                    commonUniformKeys: ["depth"],
                    uniforms: {},
                    vertexDefines: ["#define NO_COLOR", "#define NO_GLOBAL_COLOR", "#define USE_FNORMAL"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_FNORMAL"].join("\n"),
                    fragmentProgramName: "depth"
                },
                depthMap: {
                    commonUniformKeys: ["depth"],
                    uniforms: {
                        depthTexture: {
                            type: "t",
                            slot: 0,
                            texture: null
                        },
                        minMaxColor: {
                            type: "v2",
                            value: new a(t.minColorDepthMap, t.maxColorDepthMap)
                        },
                        nearFar: {
                            type: "v3",
                            value: new o(t.depthMapNear, t.depthMapFar, 0)
                        }
                    },
                    vertexDefines: ["#define NO_COLOR", "#define NO_GLOBAL_COLOR", "#define USE_FNORMAL"].join("\n"),
                    vertexProgramName: "depthMap",
                    fragmentDefines: ["#define USE_FNORMAL"].join("\n"),
                    fragmentProgramName: "depthMap"
                },
                depthDebug: {
                    commonUniformKeys: ["depth"],
                    uniforms: {
                        depthTexture: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    vertexProgramName: "depthDebug",
                    vertexDefines: ["#define USE_FNORMAL"].join("\n"),
                    fragmentProgramName: "depthDebug",
                    fragmentDefines: ["#define USE_FNORMAL"].join("\n")
                },
                depth_texture: {
                    commonUniformKeys: ["depth"],
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    vertexDefines: ["#define USE_UV", "#define USE_FNORMAL"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentDefines: ["#define USE_TEXTURE_ALPHA", "#define USE_FNORMAL"].join("\n"),
                    fragmentProgramName: "depth"
                },
                renderTexture: {
                    uniforms: {
                        tex0: {
                            type: "t",
                            slot: 0,
                            texture: null
                        }
                    },
                    vertexProgramName: "common2D",
                    fragmentDefines: ["#define USE_TEXTURE"].join("\n"),
                    fragmentProgramName: "common3D"
                },
                ssao: {
                    commonUniformKeys: ["viewport"],
                    uniforms: {
                        depthTex: {
                            type: "t",
                            slot: 6,
                            texture: null
                        },
                        cameraNearFar: {
                            type: "v2",
                            value: new a(0, 100)
                        },
                        ssaoMaxValue: {
                            type: "f",
                            value: t.ssaoParams.ssaoMaxValue
                        },
                        ssaoContrast: {
                            type: "f",
                            value: t.ssaoParams.ssaoContrast
                        },
                        ssaoRadius: {
                            type: "f",
                            value: t.ssaoParams.ssaoRadius
                        }
                    },
                    vertexProgramName: "ssao",
                    fragmentProgramName: "ssao"
                },
                ssao_blur: {
                    commonUniformKeys: ["viewport"],
                    uniforms: {
                        depthTex: {
                            type: "t",
                            slot: 6,
                            texture: null
                        },
                        ambientTex: {
                            type: "t",
                            slot: 7,
                            texture: null
                        },
                        outlineColor: {
                            type: "c",
                            value: new r(t.ssaoParams.outlineColor)
                        },
                        outlineTolerance: {
                            type: "f",
                            value: t.ssaoParams.outlineTolerance
                        }
                    },
                    vertexProgramName: "ssao_blur",
                    fragmentProgramName: "ssao_blur"
                },
                picking: {
                    commonUniformKeys: ["picking"],
                    uniforms: {},
                    vertexDefines: ["#define NO_GLOBAL_COLOR"].join("\n"),
                    vertexProgramName: "common3D",
                    fragmentProgramName: "picking"
                }
            }, this.extensions = {
                depthMap: {
                    fragmentDefines: ["#define DEPTH_MAP"].join("\n")
                },
                clipping: {
                    uniforms: {
                        clippingWorld: {
                            type: "v2",
                            value: new a(3200, 2e3)
                        }
                    },
                    vertexDefines: ["#define CLIPPING"].join("\n"),
                    fragmentDefines: ["#define CLIPPING"].join("\n")
                },
                skinning: {
                    vertexDefines: ["#define USE_SKINNING"].join("\n"),
                    uniforms: {
                        bonesMatrix: {
                            type: "m4v",
                            value: null
                        }
                    }
                },
                miniSkinning: {
                    vertexDefines: ["#define USE_MINI_SKINNING"].join("\n"),
                    uniforms: {
                        bonesQuat: {
                            type: "v4v",
                            value: null
                        }
                    }
                },
                uniformColor: {
                    vertexDefines: ["#define UNIFORM_COLOR"].join("\n"),
                    uniforms: {
                        uColor: {
                            type: "c",
                            value: new r(16777215)
                        }
                    }
                },
                envmap: {
                    commonUniformKeys: ["envMap", "cameraPos", "globalAlpha"],
                    vertexDefines: ["#define USE_ENVMAP"].join("\n"),
                    fragmentDefines: ["#define USE_F_ALPHA", "#define USE_ENVMAP"].join("\n")
                },
                heightCropping: {
                    vertexDefines: ["#define HEIGHT_DISCARD"].join("\n"),
                    fragmentDefines: ["#define HEIGHT_DISCARD"].join("\n"),
                    uniforms: {
                        uMaxHeight: {
                            type: "f",
                            value: 999999.99
                        }
                    }
                },
                heightMap: {
                    uniforms: {
                        heightMapTexture: {
                            type: "t",
                            slot: 7,
                            texture: null
                        },
                        heightMapUvOffset: {
                            type: "v2",
                            value: new a(0, 0)
                        },
                        heightMapUvScale: {
                            type: "v2",
                            value: new a(1, 1)
                        }
                    },
                    vertexDefines: ["#define ELEVATION_HEIGHTMAP_ENABLED"].join("\n")
                },
                heightMapInterpolating: {
                    uniforms: {
                        heightMapTexture: {
                            type: "t",
                            slot: 7,
                            texture: null
                        },
                        heightMapUvOffset: {
                            type: "v2",
                            value: new a(0, 0)
                        },
                        heightMapUvScale: {
                            type: "v2",
                            value: new a(1, 1)
                        },
                        heightMapSize: {
                            type: "v2",
                            value: new a(1, 1)
                        }
                    },
                    vertexDefines: ["#define ELEVATION_HEIGHTMAP_ENABLED", "#define ELEVATION_HEIGHTMAP_INTERPOLATING"].join("\n")
                },
                heightMapIndexed: {
                    uniforms: {
                        heightMapTexture: {
                            type: "t",
                            slot: 7,
                            texture: null
                        },
                        heightMapUvOffset: {
                            type: "v2",
                            value: new a(0, 0)
                        },
                        heightMapUvScale: {
                            type: "v2",
                            value: new a(1, 1)
                        },
                        heightMapMin: {
                            type: "f",
                            value: 0
                        },
                        heightMapRange: {
                            type: "f",
                            value: 0
                        }
                    },
                    vertexDefines: ["#define ELEVATION_HEIGHTMAP_ENABLED", "#define ELEVATION_HEIGHTMAP_INDEXED"].join("\n")
                },
                alphaStep: {
                    fragmentDefines: ["#define USE_ALPHA_STEP"].join("\n")
                },
                shadow: {
                    commonUniformKeys: ["shadow"],
                    vertexDefines: ["#define USE_SHADOW"].join("\n"),
                    fragmentDefines: ["#define USE_SHADOW"].join("\n")
                },
                csmShadows: {
                    commonUniformKeys: ["csmShadows"],
                    vertexDefines: ["#define USE_CSM", "#define USE_FNORMAL"].join("\n"),
                    fragmentDefines: ["#define USE_CSM", "#define USE_FNORMAL"].join("\n")
                },
                csmShadowsDebug: {
                    commonUniformKeys: ["csmShadows"],
                    vertexDefines: ["#define USE_CSM", "#define CSM_DEBUG", "#define USE_FNORMAL"].join("\n"),
                    fragmentDefines: ["#define USE_CSM", "#define CSM_DEBUG", "#define USE_FNORMAL"].join("\n")
                },
                pcfShadows: {
                    vertexDefines: ["#define USE_PCF"].join("\n"),
                    fragmentDefines: ["#define USE_PCF"].join("\n")
                },
                lerpShadows: {
                    vertexDefines: ["#define USE_LERP"].join("\n"),
                    fragmentDefines: ["#define USE_LERP"].join("\n")
                },
                specularLighting: {
                    commonUniformKeys: ["cameraPos"],
                    uniforms: {
                        specularShininess: {
                            type: "f",
                            value: 2
                        },
                        specularIntensity: {
                            type: "f",
                            value: 1
                        }
                    },
                    vertexDefines: ["#define USE_SPECULAR_LIGHTING", "#define USE_FNORMAL"].join("\n"),
                    fragmentDefines: ["#define USE_SPECULAR_LIGHTING", "#define USE_FNORMAL"].join("\n")
                }
            }
        }
        var r = e("../Color"),
            o = e("../math/Vector3"),
            a = e("../math/Vector2"),
            s = e("../math/Matrix4"),
            l = e("../math/Quaternion");
        t.exports = n
    }, {
        "../Color": 13,
        "../math/Matrix4": 60,
        "../math/Quaternion": 61,
        "../math/Vector2": 62,
        "../math/Vector3": 63,
        "./shader/blobWithoutTexture.fshader": 35,
        "./shader/common2D.vshader": 36,
        "./shader/common3D.fshader": 37,
        "./shader/common3D.vshader": 38,
        "./shader/depth.fshader": 39,
        "./shader/depthDebug.fshader": 40,
        "./shader/depthDebug.vshader": 41,
        "./shader/depthMap.fshader": 42,
        "./shader/depthMap.vshader": 43,
        "./shader/fountain.vshader": 44,
        "./shader/lensFlare.fshader": 46,
        "./shader/lensFlare.vshader": 47,
        "./shader/picking.fshader": 48,
        "./shader/pickingWithIndex.fshader": 49,
        "./shader/point.fshader": 50,
        "./shader/point.vshader": 51,
        "./shader/sky.fshader": 52,
        "./shader/sky.vshader": 53,
        "./shader/smoke.vshader": 54,
        "./shader/ssao.fshader": 55,
        "./shader/ssao.vshader": 56,
        "./shader/ssao_blur.fshader": 57,
        "./shader/ssao_blur.vshader": 58
    }],
    34: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = t.callback;
            t.heightMap = e.createMaterial(i + "_heightMap", r.NoBlending), t.heightMapInterp = e.createMaterial(i + "_heightMapInterpolating", r.NoBlending), t.heightMapIndexed = e.createMaterial(i + "_heightMapIndexed", r.NoBlending), t.isCallback = !0, delete t.isList, t.callback = function(i) {
                if (i.uniforms.heightMapTexture) {
                    var r;
                    if (i.uniforms.heightMapSize) {
                        r = t.heightMapInterp;
                        var o = i.uniforms.heightMapSize.value;
                        r.uniforms.heightMapSize.value = o
                    } else if (i.uniforms.heightMapMin) {
                        r = t.heightMapIndexed;
                        var a = i.uniforms.heightMapMin.value,
                            s = i.uniforms.heightMapRange.value;
                        r.uniforms.heightMapMin.value = a, r.uniforms.heightMapRange.value = s
                    } else r = t.heightMap;
                    e._webGL._currentMaterialId == r.id && e._webGL.setMaterial(null);
                    var l = i.uniforms.heightMapTexture.texture;
                    r.uniforms.heightMapTexture.texture = l;
                    var h = i.uniforms.heightMapUvOffset.value;
                    r.uniforms.heightMapUvOffset.value = h;
                    var u = i.uniforms.heightMapUvScale.value;
                    return r.uniforms.heightMapUvScale.value = u, r
                }
                return n ? n(i) : null
            }
        }
        var r = e("../Constants");
        t.exports = {
            buildHeightMapMaterialOverrides: n
        }
    }, {
        "../Constants": 14
    }],
    35: [function(e, t, i) {
        t.exports = "\nvarying vec4 vColor;\n\n#ifndef IS_POINT_SPRITE\nvarying vec2 vUv;\n#endif //IS_POINT_SPRITE\n\nvoid main()\n{\n#ifdef IS_POINT_SPRITE\n    vec2 vUv = gl_PointCoord;\n#endif //IS_POINT_SPRITE\n\n    float alpha = vColor.a * (1.0 - smoothstep(0.2, 0.5, length( vUv - vec2( 0.5 ))));\n    if( alpha < 0.01 )\n        discard;\n#ifdef DEPTH_MAP\n    setDepthColor();\n#else //DEPTH_MAP\n    gl_FragColor = vec4( vColor.rgb, alpha );\n#endif //DEPTH_MAP\n}\n"
    }, {}],
    36: [function(e, t, i) {
        t.exports = "\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main()\n{\n    vColor = color;\n    vUv = vec2( uv.x, 1.0 - uv.y );\n    gl_Position = objectMatrix * vec4( position, 1.0 );\n}\n"
    }, {}],
    37: [function(e, t, i) {
        t.exports = "\n#ifdef USE_TEXTURE\nuniform sampler2D tex0;\nvarying vec2 vUv;\n#endif //USE_TEXTURE\n\n#ifdef USE_ENVMAP\nvarying vec2 vEnvUv;\nuniform sampler2D envTexture;\n#endif //USE_ENVMAP\n\n#ifdef USE_SPECULAR_LIGHTING\nuniform mat4 viewMatrix;\nvarying vec3 vEye;\nuniform vec4 vLightSpecularColor;\nuniform float specularShininess;\nuniform float specularIntensity;\n#endif // USE_SPECULAR_LIGHTING\n\n#ifdef USE_F_ALPHA\nuniform float fAlpha;\n#endif //USE_F_ALPHA\n\nvarying vec4 vColor;\n\n#ifdef HEIGHT_DISCARD\nvarying float vHeight;\nuniform float uMaxHeight;\n#endif  // HEIGHT_DISCARD\n\n#ifdef CLIPPING\nvarying vec4 worldPosition;\nuniform vec2 clippingWorld;\n#endif//CLIPPING\n\nvoid main()\n{\n#ifdef CLIPPING\n    if(worldPosition.x<-clippingWorld.x) discard;\n    if(worldPosition.x>clippingWorld.x) discard;\n    if(worldPosition.y<-clippingWorld.y) discard;\n    if(worldPosition.y>clippingWorld.y) discard;\n#endif//CLIPPING\n\n#ifdef HEIGHT_DISCARD\n	if (vHeight >= uMaxHeight) {\n		discard;\n	}\n#endif // HEIGHT_DISCARD\n\n    gl_FragColor = vColor;\n#ifdef USE_TEXTURE\n	vec4 textureColor = texture2D( tex0, vUv );\n    gl_FragColor *= textureColor;\n\n    // Idea for encoding transparency and an additional map (specular or envmap for example) into alpha channel,\n    //   each with 16 possible values:\n    // Use 4 bits for transparency and 4 bits for map. eg 0x73 => transparency = 0x70, map = 0x30\n    // transparency = floor(255.0 / 256.0 * textureColor.a * 16.0) / 16.0;\n    // specularIntensity = fract(255.0 / 256.0 * textureColor.a * 16.0);\n\n#endif //USE_TEXTURE\n\n#ifdef USE_ENVMAP\n#ifdef USE_TEXTURE\n    float envRatio = textureColor.a;\n#else\n    float envRatio = vColor.a;\n#endif //USE_TEXTURE\n    gl_FragColor.rgb = mix( texture2D( envTexture, vEnvUv ).rgb, gl_FragColor.rgb, envRatio );\n    gl_FragColor.a = 1.0;\n#endif //USE_ENVMAP\n\n#ifdef USE_SPECULAR_LIGHTING\n	float nDotVP = clamp(dot(vLightDir, vNormal), 0.0, 1.0);\n	if (nDotVP > 0.0) {\n		// reflected vector\n		vec3 reflectVector = normalize(-reflect(vLightDir, vNormal));\n\n		// specular as function of angle between eye and reflected vector\n		float eDotRV = clamp(dot(vEye, reflectVector), 0.0, 1.0);\n		eDotRV = pow(eDotRV, 16.0);\n\n		// Calculate specular from shininess\n		float pf = pow(eDotRV, specularShininess);\n\n    	float specularFactor = specularIntensity;\n#ifdef USE_TEXTURE\n		// Alpha channel holds specular map: more opaque => less specular\n		specularFactor *= (1.0 - textureColor.a);\n#endif // USE_TEXTURE\n\n		gl_FragColor.rgb += specularFactor * vLightSpecularColor.rgb * pf;\n	}\n\n#ifdef USE_TEXTURE\n	// alpha channel of texture only used as specular mask\n	gl_FragColor.a = 1.0;\n#endif\n#endif // USE_SPECULAR_LIGHTING\n\n#ifdef USE_F_ALPHA\n    gl_FragColor.a *= fAlpha;\n#endif //USE_F_ALPHA\n\n    float alphaTolerance =  0.01;\n\n#ifdef USE_TEXTURE\n    alphaTolerance = 0.2;\n#endif //USE_TEXTURE\n\n#ifdef USE_ALPHA_STEP\n    // Avoid transparency bleeding between interpolated pixels (eg Eiffel tower becoming invisible at distance)\n	gl_FragColor.a = step(alphaTolerance, gl_FragColor.a);\n#endif\n\n    if( gl_FragColor.a < alphaTolerance )\n        discard;\n\n\n#ifdef DEPTH_MAP\n    setDepthColor();\n#else //DEPTH_MAP\n\n#ifdef SHADOW_ENABLED\n#ifdef USE_SHADOW\n    gl_FragColor.rgb *= computeShadow();\n#else\n#ifdef USE_CSM\n    gl_FragColor.rgb *= computeCSMShadow(vNormal);\n#endif //USE_CSM\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n#endif //DEPTH_MAP\n}\n"
    }, {}],
    38: [function(e, t, i) {
        t.exports = "\nvarying vec4 vColor;\n\n#ifdef CLIPPING\nvarying vec4 worldPosition;\n#endif //CLIPPING\n\n#ifndef NO_GLOBAL_COLOR\nuniform vec4 vGlobalColor;\n#endif //NO_GLOBAL_COLOR\n#ifdef UNIFORM_COLOR\nuniform vec4 uColor;\n#endif\n#ifdef USE_UV\nvarying vec2 vUv;\n#endif //USE_UV\n\n#if defined (USE_ENVMAP) || defined (USE_SPECULAR_LIGHTING)\nuniform vec3 cameraPosition;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec2 vEnvUv;\n#endif //USE_ENVMAP\n\n#ifdef USE_SPECULAR_LIGHTING\nvarying vec3 vEye;\n#endif // USE_SPECULAR_LIGHTING\n\n#ifdef HEIGHT_DISCARD\nvarying float vHeight;\n#endif // HEIGHT_DISCARD\n\nvoid main()\n{\n\n    vec3 aPosition = position;\n//#ifdef USE_TIMER\n//    float factor1 = 1.0 + 0.3 * (1.0 + sin(aPosition.x * 3.14 / 100.0 - currentTime * 3.14 / 2.0));\n//    float factor2 = 1.0 + 0.3 * (1.0 + sin(aPosition.y * 3.14 / 77.0 - currentTime * 3.14 / 1.0));\n//    float factor3 = 1.0 + 0.1 * (1.0 + sin(aPosition.x * 3.14 / 53.0 - currentTime * 3.14 / 0.3));\n//    float factor4 = 1.0 + 0.1 * (1.0 + sin(aPosition.y * 3.14 / 43.0 - currentTime * 3.14 / 0.6));\n//    aPosition.z *= factor1 * factor2 * factor3 * factor4;\n\n//    aPosition.x += 0.5 * position.z * sin(currentTime * 3.14 / 2.0);\n//    aPosition.y += 0.5 * position.z * cos(currentTime * 3.14 / 2.0);\n//#endif\n\n#ifdef USE_COMPRESSED_NORMAL\n    decompressNormal();\n#endif //USE_COMPRESSED_NORMAL\n\n#ifdef USE_COMPRESSED_COLOR\n    decompressColor();\n#endif //USE_COMPRESSED_COLOR\n\n#ifdef USE_UV\n    vUv = uv;\n#endif //USE_UV\n\n#ifdef INVERT_Z\n    mat4 objMatrix = objectMatrix;\n    objMatrix[2][2] *= -1.25;\n    objMatrix[3][2] *= -1.25;\n    mat4 modelViewProjMatrix = projectionMatrix * viewMatrix * objMatrix;\n#else\n    mat4 modelViewProjMatrix = projectionMatrix * modelViewMatrix;\n#endif //INVERT_Z\n\n#ifdef NO_COLOR\n	vColor = vec4(1.0);\n#else\n    vColor = color;\n#endif //NO_COLOR\n#ifndef NO_GLOBAL_COLOR\n    vColor *= vGlobalColor;\n#endif //NO_GLOBAL_COLOR\n#ifdef UNIFORM_COLOR\n    vColor *= uColor;\n#endif\n\n#ifdef USE_SKINNING\n    computeSkinning( vec4( aPosition, 1.0 ), vec4( normal, 0.0 ) );\n    gl_Position = modelViewProjMatrix * skinnedPosition;\n#else\n#ifdef USE_MINI_SKINNING\n    computeMiniSkinning( aPosition );\n    gl_Position = modelViewProjMatrix * skinnedPosition;\n#else\n\n#ifdef ELEVATION_HEIGHTMAP_ENABLED\n	aPosition.z = getHeightFromHeightMap(aPosition);\n#endif // ELEVATION_HEIGHTMAP_ENABLED\n\n    gl_Position = modelViewProjMatrix * vec4( aPosition, 1.0 );\n\n#endif //USE_MINI_SKINNING\n#endif //USE_SKINNING\n\n#ifdef HEIGHT_DISCARD\n	vHeight = aPosition.z;\n#endif\n\n#if defined (USE_ENVMAP) || defined (USE_SPECULAR_LIGHTING)\n    vec4 mPosition = objectMatrix * vec4( aPosition, 1.0 );\n    vec3 eyeDir = normalize( cameraPosition - mPosition.xyz );\n\n#ifdef USE_SPECULAR_LIGHTING\n	vEye = eyeDir;\n#endif\n\n#ifdef USE_ENVMAP\n    vec3 wNormal = ( objectMatrix * vec4( normal, 0.0 ) ).xyz;\n\n    vec3 reflVec = reflect( eyeDir, wNormal );\n    vEnvUv = reflVec.xy + reflVec.zz;\n#endif\n#endif //USE_ENVMAP || USE_SPECULAR_LIGHTING\n\n#ifdef SHADOW_ENABLED\n#ifdef USE_SHADOW\n    computeShadowCoord();\n#else\n#ifdef USE_CSM\n    computeWorldPos();\n#endif //USE_CSM\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n\n#ifdef USE_LIGHT\n#ifdef USE_SKINNING\n    vColor.rgb *= computeLighting(skinnedNormal);\n#else\n#ifdef USE_MINI_SKINNING\n    vColor.rgb *= computeLighting(normal);\n#else\n    vColor.rgb *= computeLighting(( objectMatrix * vec4( normal, 0.0 ) ).xyz );\n#endif //USE_MINI_SKINNING\n#endif //USE_SKINNING\n#endif //USE_LIGHT\n\n#ifdef CLIPPING\n    worldPosition = modelViewMatrix * vec4( aPosition, 1.0 );\n#endif //CLIPPING\n\n}\n\n"
    }, {}],
    39: [function(e, t, i) {
        t.exports = "uniform float depthBias;\n\n#ifdef USE_TEXTURE_ALPHA\nuniform sampler2D tex0;\nvarying vec2 vUv;\n#endif //USE_TEXTURE_ALPHA\n\n#ifdef HEIGHT_DISCARD\nvarying float vHeight;\nuniform float uMaxHeight;\n#endif  // HEIGHT_DISCARD\n\nvoid main() {\n\n#ifdef HEIGHT_DISCARD\n	if (vHeight >= uMaxHeight) {\n		discard;\n	}\n#endif // HEIGHT_DISCARD\n\n#ifdef USE_TEXTURE_ALPHA\n    gl_FragColor = texture2D( tex0, vUv );\n\n#ifndef USE_ENVMAP\n#ifndef USE_SPECULAR_LIGHTING\n	// Alpha channel used as environment/specular map rather than transparency\n    if( gl_FragColor.a < 0.5 )\n        discard;\n#endif // USE_SPECULAR_LIGHTING\n#endif // USE_ENVMAP\n\n#endif //USE_TEXTURE_ALPHA\n//    float bias = depthBias * sqrt(1.0 - pow(dot(vNormal, vLightDir), 2.0)) / dot(vNormal, vLightDir);\n//    float bias = depthBias * clamp(tan(acos(dot(vNormal,vLightDir))), 0.0, 1.0);\n//    float bias = depthBias * (1.0 - abs(dot(vNormal, vLightDir)));\n    gl_FragColor = floatToVec4( gl_FragCoord.z);\n}\n"
    }, {}],
    40: [function(e, t, i) {
        t.exports = "uniform sampler2D depthTexture;\nvarying vec2 vUv;\n\nvoid main() {\n	float depth = vec4ToFloat(texture2D(depthTexture, vUv));\n	//depth = pow(depth, 4.0); // make far distances more visible\n\n    gl_FragColor = vec4(depth, depth, depth, 1);\n}\n"
    }, {}],
    41: [function(e, t, i) {
        t.exports = "varying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n\n    mat4 modelViewProjMatrix = projectionMatrix * modelViewMatrix;\n\n    gl_Position = modelViewProjMatrix * vec4(position, 1.0);\n}\n\n"
    }, {}],
    42: [function(e, t, i) {
        t.exports = "uniform sampler2D depthTexture;\nvarying vec2 vUv;\nuniform vec3 nearFar;\nuniform vec2 minMaxColor;\n\nfloat LinearizeDepth(float depth)\n{\n    float z = depth * 2.0 - 1.0; // Back to NDC\n    return (2.0 * nearFar.x * nearFar.y) / (nearFar.y + nearFar.x - z * (nearFar.y - nearFar.x));\n}\n\nvoid main() {\n    if ( nearFar.z > 0.0 ) {\n        float color = nearFar.z / 256.0;\n        gl_FragColor = vec4(color, color, color, 1.0);\n    } else {\n        float depth = vec4ToFloat(texture2D(depthTexture, vUv));\n        float color = 1.0 - LinearizeDepth(depth) / nearFar.y;\n        color = color * ( ( minMaxColor.y - minMaxColor.x ) / 256.0 ) + minMaxColor.x / 256.0;\n        gl_FragColor = vec4(color, color, color, 1.0);\n    }\n}\n"
    }, {}],
    43: [function(e, t, i) {
        arguments[4][41][0].apply(i, arguments)
    }, {
        dup: 41
    }],
    44: [function(e, t, i) {
        t.exports = "uniform int objectID;\nuniform float height;\nuniform float particleMaxLife;\nuniform float spreadingFactor;\nuniform float particleSize;\nuniform vec4 vGlobalColor;\nuniform vec2 direction;\n\nvarying vec4 vColor;\n\nvoid main()\n{\n	float random = fract(sin(dot(position.xy * 100.0, vec2(12.9898, 78.233))) * 43758.5453);\n	float fac = 0.8 + 0.2 * random;\n    vec3 pos = position;\n    float time = float(objectID) + currentTime;\n    float particleLife01 = mod( time + pos.z * particleMaxLife, particleMaxLife ) / particleMaxLife;\n    pos.z += length(pos.xy) + sin( particleLife01 * 2.8 ) * fac * height;\n    pos.xy *= spreadingFactor * particleLife01;\n    pos.xy += fac * 0.2 * direction * particleLife01 * particleLife01;\n\n    vColor = vGlobalColor;\n    vColor.a = 0.3 * min( 3.0 * particleLife01, 0.5 - 0.5 * particleLife01 );\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n    gl_PointSize = particleSize * min( 0.5 + particleLife01, 1.0 ) / max( gl_Position.z, 15.0 );\n}\n"
    }, {}],
    45: [function(e, t, i) {
        t.exports = "\nvec4 floatToVec4( const in float depth )\n{\n    const vec4 bit_shift = vec4( 16581375.0, 65025.0, 255.0, 1.0 );\n    const vec4 bit_mask = vec4( 0.0, 1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0 );\n    vec4 res = fract( depth * bit_shift );\n    res -= res.xxyz * bit_mask;\n    return res;\n}\n\n\nfloat vec4ToFloat( const in vec4 rgba_depth )\n{\n    const vec4 bit_shift = vec4( 1.0 / 16581375.0, 1.0 / 65025.0, 1.0 / 255.0, 1.0 );\n    float depth = dot( rgba_depth, bit_shift );\n    return depth;\n}\n\n#ifdef DEPTH_MAP\nvoid setDepthColor()\n{\n    gl_FragColor = floatToVec4( gl_FragCoord.z);\n}\n#endif //DEPTH_MAP\n\nuniform vec3 vLightDir;\n#ifdef USE_TIMER\nuniform float currentTime;\n#endif //USE_TIMER\n\n#ifdef USE_FNORMAL\nvarying vec3 vNormal;\n#endif //USE_FNORMAL\n\n#ifdef SHADOW_ENABLED\n\nfloat texture2DDepthCompare(sampler2D depthTexture, vec2 uv, float compare) {\n	float depth = vec4ToFloat(texture2D(depthTexture, uv));\n    return step(depth, compare);\n}\n\nfloat texture2DShadowLerp(sampler2D depthTexture, vec2 size, vec2 uv, float compare) {\n    vec2 texelSize = vec2(1.0)/size;\n    vec2 f = fract(uv*size+0.5);\n    vec2 centroidUV = floor(uv*size+0.5)/size;\n\n    float lb = texture2DDepthCompare(depthTexture, centroidUV+texelSize*vec2(0.0, 0.0), compare);\n    float lt = texture2DDepthCompare(depthTexture, centroidUV+texelSize*vec2(0.0, 1.0), compare);\n    float rb = texture2DDepthCompare(depthTexture, centroidUV+texelSize*vec2(1.0, 0.0), compare);\n    float rt = texture2DDepthCompare(depthTexture, centroidUV+texelSize*vec2(1.0, 1.0), compare);\n    float a = mix(lb, lt, f.y);\n    float b = mix(rb, rt, f.y);\n    float c = mix(a, b, f.x);\n    return c;\n}\n\nfloat texture2DPCFShadow(sampler2D depthTexture, vec2 size, vec2 uv, float compare) {\n    float result = 0.0;\n    for(int x=-2; x<=2; x++){\n        for(int y=-2; y<=2; y++){\n            vec2 off = vec2(x,y)/size;\n            result += texture2DDepthCompare(depthTexture, uv+off, compare);\n        }\n    }\n    return result/25.0;\n}\n\nfloat texture2DPCFShadowLerp(sampler2D depthTexture, vec2 size, vec2 uv, float compare){\n    float result = 0.0;\n    for(int x=-1; x<=1; x++){\n        for(int y=-1; y<=1; y++){\n            vec2 off = vec2(x,y)/size;\n            result += texture2DShadowLerp(depthTexture, size, uv+off, compare);\n        }\n    }\n    return result/9.0;\n}\n\nconst vec3 white = vec3( 1.0, 1.0, 1.0 );\n\n#ifdef USE_SHADOW\nuniform vec4 shadowColor;\nuniform float shadowBias;\nuniform sampler2D shadowTexture;\nuniform vec2 shadowTextureSize;\n\nvarying vec4 shadowCoord;\n\nvec3 computeShadow()\n{\n    vec3 sCoord = shadowCoord.xyz / shadowCoord.w;\n    if( sCoord.z > 0.0 && sCoord.z < 1.0 && sCoord.x > 0.0 && sCoord.x < 1.0 && sCoord.y > 0.0 && sCoord.y < 1.0 ) {\n#if defined(USE_PCF) && defined(USE_LERP)\n        float depthValue = texture2DPCFShadowLerp(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - shadowBias);\n#elif defined(USE_PCF) || defined(USE_LERP)\n#ifdef USE_PCF\n        float depthValue = texture2DPCFShadow(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - shadowBias);\n#endif //USE_PCF\n#ifdef USE_LERP\n        float depthValue = texture2DShadowLerp(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - shadowBias);\n#endif //USE_LERP\n#else\n        float depthValue = texture2DDepthCompare(shadowTexture, sCoord.xy,  sCoord.z - shadowBias);\n#endif\n        return mix(white, shadowColor.rgb, depthValue);\n    }\n#ifdef SHADOW_DEBUG\n    else\n        return vec3( 1.0, 0.0, 0.0 );\n#endif //SHADOW_DEBUG\n    return white;\n}\n#else//USE_SHADOW\n\n#ifdef USE_CSM\n#define MAX_SPLITS 4\nuniform vec4 shadowColor;\nuniform float shadowBias;\nuniform float shadowSlopeBiasFactor;\nuniform sampler2D shadowTexture;\nuniform vec2 shadowTextureSize;\n\nuniform float splitFarDist[MAX_SPLITS];\nuniform mat4 shadowMatrix[MAX_SPLITS];\nuniform vec4 splitUVRect[MAX_SPLITS];\nvarying vec4 vWorldPos;\n\nvec3 computeCSMShadow(vec3 normal) {\n    // Compare fragment z with each split dist far: choose appropriate split/shadow matrix\n    int index = 3;\n    mat4 matrix = shadowMatrix[3];\n    vec4 uvRect = splitUVRect[3];\n    if (gl_FragCoord.z <= splitFarDist[0]) {\n        index = 0;\n        matrix = shadowMatrix[0];\n        uvRect = splitUVRect[0];\n    } else if (gl_FragCoord.z <= splitFarDist[1]) {\n        index = 1;\n        matrix = shadowMatrix[1];\n        uvRect = splitUVRect[1];\n    } else if (gl_FragCoord.z <= splitFarDist[2]) {\n        index = 2;\n        matrix = shadowMatrix[2];\n        uvRect = splitUVRect[2];\n    }\n\n    // Use shadow matrix and vWorldPos to calculate shadow coord (uv)\n    vec4 sCoord = matrix * vWorldPos;\n\n    // Shadows only on faces in direct light and avoid grazing angles\n#ifndef FRAGMENT_NORMALMAP_ENABLED\n    sCoord.xyz *= step(0.1, dot(normal, normalize(vLightDir)));\n#endif //FRAGMENT_NORMALMAP_ENABLED\n    // Should check if shadow coord falls out of UV rectangle for specific split : use splitUVRect\n\n    if (sCoord.z > 0.0 && sCoord.z < 1.0 && sCoord.x > uvRect.x && sCoord.x < uvRect.z && sCoord.y > uvRect.y && sCoord.y < uvRect.w ) {\n\n#ifdef FRAGMENT_NORMALMAP_ENABLED\n        float bias = shadowSlopeBiasFactor;\n#else //FRAGMENT_NORMALMAP_ENABLED\n        float bias = shadowBias;\n#endif //FRAGMENT_NORMALMAP_ENABLED\n\n        // Compare depths using texture2DDepthCompare and get depthValue\n#if defined(USE_PCF) && defined(USE_LERP)\n        float depthValue = texture2DPCFShadowLerp(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - bias);\n#elif defined(USE_PCF) || defined(USE_LERP)\n#ifdef USE_PCF\n        float depthValue = texture2DPCFShadow(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - bias * 4.0);\n#endif //USE_PCF\n#ifdef USE_LERP\n        float depthValue = texture2DShadowLerp(shadowTexture, shadowTextureSize, sCoord.xy, sCoord.z - bias);\n#endif //USE_LERP\n#else\n        float depthValue = texture2DDepthCompare(shadowTexture, sCoord.xy,  sCoord.z - bias);\n#endif\n\n        float slope = dot(normal, vLightDir);\n       float clippedSlope = step(0.1, slope);\n        if( clippedSlope <= 0.1 )\n            depthValue = 1.0 - clippedSlope;\n\n        vec3 color = mix(white, shadowColor.rgb, depthValue);\n#ifdef CSM_DEBUG\n       if(index == 0)\n           color *= vec3(1.0, 1.0, 0.5); // yellow\n       else if (index == 1)\n           color *= vec3(0.5, 1.0, 0.5); // green\n       else if (index == 2)\n           color *= vec3(0.5, 0.5, 1.0); // blue\n       else\n           color *= vec3(1.0, 0.5, 1.0); // violet\n#endif//CSM_DEBUG\n       return color;\n    }\n#ifdef CSM_DEBUG\n    else\n        return vec3( 1.0, 0.0, 0.0 );\n#endif//CSM_DEBUG\n    return white;\n}\n#endif //USE_CSM\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n";
    }, {}],
    46: [function(e, t, i) {
        t.exports = "uniform sampler2D tex0;\nuniform float fAlpha;\nvarying vec3 uvMapping;\nvarying vec4 vColor;\n\nvoid main()\n{\n#ifdef DEPTH_MAP\n    setDepthColor();\n#else //DEPTH_MAP\n    gl_FragColor = vColor * texture2D( tex0, uvMapping.xy + gl_PointCoord * uvMapping.z );\n    gl_FragColor.a *= fAlpha;\n#endif //DEPTH_MAP\n}\n"
    }, {}],
    47: [function(e, t, i) {
        t.exports = "uniform vec2 sunPosScreenSpace;\nvarying vec3 uvMapping;\nvarying vec4 vColor;\n\nvoid main()\n{\n    vColor = color;\n    vec2 screenPos = ( 1.0 - position.x ) * sunPosScreenSpace;\n    float indexV = floor(position.y * 0.5);\n    float indexU = position.y - indexV * 2.0;\n    uvMapping = vec3( indexU * 0.5, indexV * 0.5, 0.5);\n\n    float depth = clamp( 1.0 - position.x, 0.0, 1.0 );\n    gl_Position = vec4( screenPos.xy, depth, 1.0);\n\n    gl_PointSize = position.z;\n}\n"
    }, {}],
    48: [function(e, t, i) {
        t.exports = "uniform vec4 pickingColor;\n\nvoid main()\n{\n    //TODO discard if should be transparent\n    gl_FragColor.rgb = pickingColor.rgb;\n    gl_FragColor.a = 1.;\n}\n"
    }, {}],
    49: [function(e, t, i) {
        t.exports = "uniform vec4 pickingColor;\nvarying float vIndex;\n\nvoid main()\n{\n    //TODO discard if should be transparent\n    gl_FragColor.rgb = pickingColor.rgb;\n    gl_FragColor.a = vIndex;\n}\n"
    }, {}],
    50: [function(e, t, i) {
        t.exports = "\n#ifdef USE_TEXTURE\nuniform sampler2D texture;\n#endif // USE_TEXTURE\n\nvarying vec4 vColor;\n\nvoid main() {\n\n	vec4 color = vColor;\n\n#ifdef USE_TEXTURE\n	color *= texture2D(texture, gl_PointCoord);\n#endif\n\n    gl_FragColor = color;\n}\n"
    }, {}],
    51: [function(e, t, i) {
        t.exports = "\nvarying vec4 vColor;\n\nuniform float pointSize;\n\nvoid main() {\n\n    vec3 aPosition = position;\n\n#ifdef USE_COMPRESSED_COLOR\n    decompressColor();\n#endif //USE_COMPRESSED_COLOR\n\n	vColor = color;\n\n	gl_PointSize = pointSize;\n\n    mat4 modelViewProjMatrix = projectionMatrix * modelViewMatrix;\n\n#ifdef USE_SKINNING\n    computeSkinning( vec4( aPosition, 1.0 ), vec4( normal, 0.0 ) );\n    gl_Position = modelViewProjMatrix * skinnedPosition;\n#else\n#ifdef USE_MINI_SKINNING\n    computeMiniSkinning( aPosition );\n    gl_Position = modelViewProjMatrix * skinnedPosition;\n#else\n\n    gl_Position = modelViewProjMatrix * vec4( aPosition, 1.0 );\n\n#endif //USE_MINI_SKINNING\n#endif //USE_SKINNING\n}\n\n"
    }, {}],
    52: [function(e, t, i) {
        t.exports = "uniform sampler2D cloudsTexture;\nuniform sampler2D gradientTexture;\n\nuniform vec3 cloudsInfo;\nuniform vec3 sunDirection;\n\nvarying vec2 vSkyGradientUv;\nvarying vec2 vSunGradientUv;\nvarying vec4 vCloudColor;\nvarying vec3 vPos;\n\nvoid main()\n{\n#ifdef DEPTH_MAP\n    setDepthColor();\n#else //DEPTH_MAP\n\n    const float sunPower = 25.0;\n\n    vec4 sunColor = texture2D(gradientTexture, vSunGradientUv);\n\n    float sunDot = dot(sunDirection,normalize(vPos));\n\n    float s = smoothstep( -0.05, 0.025, sunDirection.z);\n    float minStep = mix( -0.2, 0.995, s );\n    float sunHaloRate = 0.2 * smoothstep( minStep, 0.999, pow( max( 0.0, sunDot ), mix( 5.0, sunPower, s)));\n    float sunRate = 0.6 * smoothstep( 0.995, 0.999, pow( max( 0.0, sunDot ), sunPower));\n\n    vec4 horizonColor = texture2D(gradientTexture, vec2( sunDirection.z + 0.05, 1.0 ) );\n    vec4 baseColor = texture2D(gradientTexture, vSkyGradientUv) + sunColor * sunRate + horizonColor * sunHaloRate;\n\n    vec2 uvs0 = vPos.xy * 2.0 + currentTime * cloudsInfo.xy;\n    vec2 uvs1 = vPos.xy + vec2(0.5,0.5) + 1.5 * currentTime * cloudsInfo.xy;\n    float noisy = min( 1.0, cloudsInfo.z * (texture2D( cloudsTexture, uvs0).r + texture2D( cloudsTexture, uvs1).r));\n\n\n    gl_FragColor = mix( baseColor, vCloudColor * horizonColor, noisy);\n#endif //DEPTH_MAP\n}\n"
    }, {}],
    53: [function(e, t, i) {
        t.exports = "\nuniform vec4 cloudColor;\nuniform vec3 sunDirection;\nuniform vec4 vGlobalColor;\n\nvarying vec3 vPos;\nvarying vec4 vCloudColor;\nvarying vec2 vSkyGradientUv;\nvarying vec2 vSunGradientUv;\n\nvoid main()\n{\n    vCloudColor = cloudColor * vGlobalColor;\n    vPos = position;\n\n    vSkyGradientUv = vec2(sunDirection.z + 0.05, 1.0 - position.z);\n    vSunGradientUv = vec2(sunDirection.z + 0.05, 0.0);\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n}\n"
    }, {}],
    54: [function(e, t, i) {
        t.exports = "uniform int objectID;\nuniform float particleMaxLife;\nuniform vec2 particleSizes;\nuniform float spreadingfactor;\nuniform vec3 direction;\nuniform float emiterScale;\n\nuniform vec4 vGlobalColor;\nvarying vec4 vColor;\n\nvoid main()\n{\n    vec3 pos = position;\n    float time = float(objectID) + currentTime;\n    float particleLife01 = mod( time + pos.z * particleMaxLife, particleMaxLife ) / particleMaxLife;\n    pos.z = sqrt( particleLife01 ) * direction.z + spreadingfactor * particleLife01 ;\n    pos.xy = pos.xy * emiterScale + pos.xy * spreadingfactor * particleLife01 + direction.xy * particleLife01;\n\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n    vColor = vGlobalColor;\n    vColor.a = min( particleLife01 * 0.8, 0.2 - 0.2 * particleLife01 );\n\n    gl_PointSize = mix( particleSizes.x, particleSizes.y, particleLife01 ) / gl_Position.z;\n}\n"
    }, {}],
    55: [function(e, t, i) {
        t.exports = "uniform sampler2D depthTex;\nuniform float ssaoMaxValue;\nuniform float ssaoContrast;\nuniform vec2 cameraNearFar;\nvarying vec2 vUv0;\nvarying vec4 vUv[4];\n\nfloat getDepth( vec2 coord ) {\n    float d = vec4ToFloat( texture2D( depthTex, coord ) );\n    return (2.0 * cameraNearFar.x) / (cameraNearFar.y + cameraNearFar.x - d * (cameraNearFar.y-cameraNearFar.x));\n}\n\nvoid main()\n{\n    float currentPixelDepth = getDepth(vUv0);\n    float factor = 1.0 - step( 0.9, currentPixelDepth );\n\n    float ambient = 0.0;\n    for( int i = 0; i < 4; ++i )\n    {\n        float diff = ssaoContrast * (currentPixelDepth-getDepth(vUv[i].xy));\n        ambient += min( ssaoMaxValue, diff * factor);\n        diff = ssaoContrast * (currentPixelDepth-getDepth(vUv[i].zw));\n        ambient += min( ssaoMaxValue, diff * factor);\n    }\n    ambient = 1.0 - ambient / 8.0;\n    gl_FragColor = vec4( ambient, ambient, ambient, 1.0 );\n}\n"
    }, {}],
    56: [function(e, t, i) {
        t.exports = "uniform vec4 viewport;\nuniform float ssaoRadius;\nvarying vec2 vUv0;\nvarying vec4 vUv[4];\n\nvoid main()\n{\n    vec2 uvs = vec2( position.x + 0.5, position.y + 0.5 );\n    vec2 radius = ssaoRadius / viewport.zw;\n    vUv0 = uvs;\n    vUv[0].xy = uvs + vec2( 0.4908445223087547, -0.8712471835934337 ) * radius;\n    vUv[0].zw = uvs + vec2( -0.12886043213735499, 0.9916627395588553 ) * radius;\n    vUv[1].xy = uvs + vec2( -0.8929958666534527, 0.4500648643694031 ) * radius;\n    vUv[1].zw = uvs + vec2( -0.780436479674034, -0.6252350767463397 ) * radius;\n    vUv[2].xy = uvs + vec2( 0.2004409019358597, -0.9797057950380508 ) * radius;\n    vUv[2].zw = uvs + vec2( -0.39515534900218924, -0.9186143097921772 ) * radius;\n    vUv[3].xy = uvs + vec2( 0.658756252360792, 0.7523564314708585 ) * radius;\n    vUv[3].zw = uvs + vec2( 0.9615992729402716, 0.27445735238965835 ) * radius;\n\n    gl_Position = objectMatrix * vec4( position, 1.0 );\n}\n"
    }, {}],
    57: [function(e, t, i) {
        t.exports = "uniform sampler2D ambientTex;\nuniform sampler2D depthTex;\nuniform vec4 outlineColor;\nuniform float outlineTolerance;\nuniform vec4 viewport;\n\nvarying vec2 vUv;\n\nvoid main()\n{\n    float thisDepth = vec4ToFloat( texture2D( depthTex, vUv ) );\n    vec4 color = texture2D( ambientTex, vUv );\n    float outline = 0.0;\n    float invScreenSizeX = 1.0 / viewport.z;\n    float invScreenSizeY = 1.0 / viewport.w;\n    float depth;\n    vec2 uv;\n\n    uv = vUv + vec2( -invScreenSizeX, 0.0 );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( -invScreenSizeX, -invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( 0.0, -invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( +invScreenSizeX, -invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( +invScreenSizeX, 0.0 );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( +invScreenSizeX, +invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( 0.0, +invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    uv = vUv + vec2( -invScreenSizeX, +invScreenSizeY );\n    depth = vec4ToFloat( texture2D( depthTex, uv ) );\n    outline += thisDepth - depth;\n    color += texture2D( ambientTex, uv );\n\n    gl_FragColor = mix( color / 9.0, outlineColor, step( outlineTolerance, outline ));\n}"
    }, {}],
    58: [function(e, t, i) {
        t.exports = "uniform vec4 viewport;\nvarying vec2 vUv;\n\nvoid main()\n{\n    vec2 uvs = vec2( position.x + 0.5, position.y + 0.5 );\n    vec2 invScreenSize = 1.0 / viewport.zw;\n    vUv = uvs;\n\n    gl_Position = objectMatrix * vec4( position, 1.0 );\n}\n"
    }, {}],
    59: [function(e, t, i) {
        t.exports = "uniform mat4 viewMatrix;\nuniform mat4 objectMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nattribute vec3 position;\n#ifndef USE_COMPRESSED_NORMAL\nattribute vec3 normal;\n#else\nattribute float compressedNormal;\nvec3 normal;\n#endif //USE_COMPRESSED_NORMAL\nattribute vec2 uv;\n#ifndef USE_COMPRESSED_COLOR\nattribute vec4 color;\n#else\nattribute vec2 compressedColor;\nvec4 color;\n#endif //USE_COMPRESSED_COLOR\n\n#ifdef USE_TIMER\nuniform float currentTime;\n#endif //USE_TIMER\n#ifdef USE_FNORMAL\nvarying vec3 vNormal;\nvoid computeFragmentNormal() {\n    vNormal = normalize(( objectMatrix * vec4( normal, 0.0 ) ).xyz);\n}\n#endif //USE_FNORMAL\n\n#ifdef USE_SKINNING\nattribute vec2 weights;\nattribute vec3 bonesIndex;\nuniform mat4 bonesMatrix[BONES_COUNT];\n\nvec4 skinnedPosition;\nvec3 skinnedNormal;\n\nvoid computeSkinning( vec4 pos, vec4 norm )\n{\n    float remainingWeight = 1.0;\n    skinnedPosition = vec4( 0.0 );\n    vec4 n = vec4( 0.0 );\n\n    ivec3 idx = ivec3(bonesIndex);\n    mat4 mtx;\n\n    mtx = bonesMatrix[ idx.x ];\n    skinnedPosition += mtx * pos * weights.x;\n    n += mtx * norm * weights.x;\n    remainingWeight -= weights.x;\n\n    mtx = bonesMatrix[ idx.y ];\n    skinnedPosition += mtx * pos * weights.y;\n    n += mtx * norm * weights.y;\n    remainingWeight -= weights.y;\n\n    mtx = bonesMatrix[ idx.z ];\n    skinnedPosition += mtx * pos * remainingWeight;\n    n += mtx * norm * remainingWeight;\n\n    skinnedNormal = normalize((objectMatrix * vec4(n.xyz, 0.0)).xyz);\n}\n#endif //USE_SKINNING\n\n#ifdef USE_MINI_SKINNING\nattribute float miniSkinIndex;\nuniform vec4 bonesQuat[MINI_SKINNING_BONES_COUNT];\n\nvec4 skinnedPosition;\nvoid computeMiniSkinning( vec3 pos )\n{\n    vec4 quat = bonesQuat[int(miniSkinIndex)];\n    skinnedPosition = vec4((pos.xyz * quat.w) + quat.xyz, 1.0 );\n}\n#endif //USE_MINI_SKINNING\n\n#ifdef USE_LIGHT\nuniform vec4 vLightFrontColor;\nuniform vec4 vLightBackColor;\nuniform vec4 vLightAmbientColor;\nuniform vec3 vLightDir;\n\nvec3 computeLighting( vec3 normalWS )\n{\n    float nDotL = 0.5 + 0.5 * dot( normalize(normalWS), normalize(vLightDir) );\n    vec4 lightColor = mix( vLightBackColor, vLightFrontColor, nDotL ) + vLightAmbientColor;\n    return lightColor.rgb;\n}\n#endif //USE_LIGHT\n\n\n#ifdef ELEVATION_HEIGHTMAP_ENABLED\nuniform sampler2D heightMapTexture;\nuniform vec2 heightMapUvOffset;\nuniform vec2 heightMapUvScale;\n\n#ifdef ELEVATION_HEIGHTMAP_INTERPOLATING\nuniform vec2 heightMapSize;\n\n// http://codeflow.org/entries/2013/feb/22/how-to-write-portable-webgl/#how-to-deal-with-no-linear-filtering-support\nvec4 texture2DLerp(sampler2D source, vec2 texcoord, vec2 size){\n    // texel size, fractional position and centroid UV\n    vec2 tex = 1.0 / size;\n    vec2 f = fract(texcoord * size + 0.5);\n    vec2 uv = floor(texcoord * size + 0.5) / size;\n\n    // lookup the 4 corners\n    vec4 lb = texture2D(source, uv);\n    vec4 lt = texture2D(source, uv+vec2(0.0, tex.y));\n    vec4 rb = texture2D(source, uv+vec2(tex.x, 0.0));\n    vec4 rt = texture2D(source, uv+vec2(tex.x, tex.y));\n\n    // interpolation in y\n    vec4 a = mix(lb, lt, f.y);\n    vec4 b = mix(rb, rt, f.y);\n\n    // interpolation in x\n    return mix(a, b, f.x);\n}\n#endif //ELEVATION_HEIGHTMAP_INTERPOLATING\n\n#ifdef ELEVATION_HEIGHTMAP_INDEXED\nuniform float heightMapMin;\nuniform float heightMapRange;\n\nfloat floatFromUint16IndexedTexture(sampler2D source, vec2 texcoord, float minHeight, float range) {\n	// Get encoded uint16 value\n	highp vec4 uint16Index = texture2D(source, texcoord);\n\n	// Upper value in a, lower value in r: convert to value [0, 1]\n	// similar to http://stackoverflow.com/a/19383119\n	float value = (uint16Index.a * 256.0 + uint16Index.r) / 257.0;\n\n	// Convert to float value using min and range\n	return minHeight + value * range;\n}\n\n#endif //ELEVATION_HEIGHTMAP_INDEXED\n\nfloat getHeightFromHeightMap(vec3 aPosition) {\n\n	// Quick and dirty check if we want to apply height map: only use if position.z >= 0.0\n	if (aPosition.z < 0.0) {\n		return 0.0;\n\n	} else {\n		vec2 heightMapUv = heightMapUvOffset + uv * heightMapUvScale;\n#ifdef ELEVATION_HEIGHTMAP_INTERPOLATING\n		float height = texture2DLerp(heightMapTexture, heightMapUv, heightMapSize).r;\n#else\n#ifdef ELEVATION_HEIGHTMAP_INDEXED\n		float height = floatFromUint16IndexedTexture(heightMapTexture, heightMapUv, heightMapMin, heightMapRange);\n#else\n		float height = texture2D(heightMapTexture, heightMapUv).r;\n#endif\n#endif\n\n		return height;\n	}\n}\n#endif //ELEVATION_HEIGHTMAP_ENABLED\n\n#ifdef SHADOW_ENABLED\n#ifdef USE_SHADOW\nvarying vec4 shadowCoord;\nuniform mat4 shadowMatrix;\n\nvoid computeShadowCoord() {\n#ifdef USE_SKINNING\n    shadowCoord = shadowMatrix * modelViewMatrix * skinnedPosition;\n#ifdef USE_LIGHT\n    shadowCoord.xyz *= step( 0.1, dot( skinnedNormal, vLightDir ));\n#endif //USE_LIGHT\n\n#else\n#ifdef USE_MINI_SKINNING\n    shadowCoord = shadowMatrix * modelViewMatrix * skinnedPosition;\n#else\n\n\n#ifdef ELEVATION_HEIGHTMAP_ENABLED\n	vec3 aPosition = position;\n	aPosition.z = getHeightFromHeightMap(aPosition);\n    shadowCoord = shadowMatrix * modelViewMatrix * vec4( aPosition, 1.0 );\n\n#else\n    shadowCoord = shadowMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n#endif // ELEVATION_HEIGHTMAP_ENABLED\n\n#endif //USE_MINI_SKINNING\n#ifdef USE_LIGHT\n    vec3 wN = normalize(( objectMatrix * vec4( normal, 0.0 ) ).xyz);\n    shadowCoord.xyz *= step( 0.1, dot( wN, vLightDir ));\n#endif //USE_LIGHT\n#endif //USE_SKINNING\n\n}\n\n#else\n#ifdef USE_CSM\nvarying vec4 vWorldPos;\nvoid computeWorldPos() {\n#ifdef USE_FNORMAL\n    computeFragmentNormal();\n#endif //USE_FNORMAL\n#ifdef USE_SKINNING\n    vWorldPos = modelViewMatrix * skinnedPosition;\n#else\n#ifdef USE_MINI_SKINNING\n    vWorldPos = modelViewMatrix * skinnedPosition;\n#else\n#ifdef ELEVATION_HEIGHTMAP_ENABLED\n	vec3 aPosition = position;\n	aPosition.z = getHeightFromHeightMap(aPosition);\n    vWorldPos = modelViewMatrix * vec4(aPosition, 1.0);\n#else\n    vWorldPos = modelViewMatrix * vec4(position, 1.0);\n#endif // ELEVATION_HEIGHTMAP_ENABLED\n#endif //USE_MINI_SKINNING\n#endif //USE_SKINNING\n}\n#endif //USE_CSM\n\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n\n#ifdef USE_COMPRESSED_NORMAL\nfloat compressedNormalPrecision = pow(2., 11.);\nfloat compressedNormalFactor = (compressedNormalPrecision - 1.) / 2.;\nfloat compressedNormalPositiveFlag = compressedNormalPrecision * compressedNormalPrecision;\nvoid decompressNormal()\n{\n    normal.x = compressedNormal;\n    normal.y = floor(normal.x / compressedNormalPrecision);\n    normal.xy = mod(normal.xy, compressedNormalPrecision) / compressedNormalFactor - 1.;\n    //dot(normal.xy, normal.xy) may be greater than 1.0 on some browsers (IE11)\n    normal.z = sqrt(max(1. - dot(normal.xy, normal.xy), 0.));\n    normal.z *= sign(compressedNormal - compressedNormalPositiveFlag);\n}\n#endif //USE_COMPRESSED_NORMAL\n\n#ifdef USE_COMPRESSED_COLOR\nvoid decompressColor()\n{\n    color.b = compressedColor.x;\n    color.g = floor(color.b / 256.);\n    color.r = floor(color.g / 256.);\n    color.rgb = mod(color.rgb, 256.) / 255.;\n    color.a = compressedColor.y;\n}\n#endif //USE_COMPRESSED_COLOR\n\n"
    }, {}],
    60: [function(e, t, i) {
        "use strict";

        function n() {
            this.identity()
        }
        var r = e("./Vector3"),
            o = e("./Quaternion");
        t.exports = n, n.prototype = {
            constructor: n,
            set: function(e, t, i, n, r, o, a, s, l, h, u, d, c, f, p, m) {
                return this.n11 = e, this.n12 = t, this.n13 = i, this.n14 = n, this.n21 = r, this.n22 = o, this.n23 = a, this.n24 = s, this.n31 = l, this.n32 = h, this.n33 = u, this.n34 = d, this.n41 = c, this.n42 = f, this.n43 = p, this.n44 = m, this
            },
            identity: function() {
                return this.set(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1), this
            },
            isIdentity: function() {
                return this.n12 || this.n13 || this.n14 ? !1 : this.n21 || this.n23 || this.n24 ? !1 : this.n31 || this.n32 || this.n34 ? !1 : this.n41 || this.n42 || this.n43 ? !1 : 1 == this.n11 && 1 == this.n22 && 1 == this.n33 && 1 == this.n44
            },
            copy: function(e) {
                return this.set(e.n11, e.n12, e.n13, e.n14, e.n21, e.n22, e.n23, e.n24, e.n31, e.n32, e.n33, e.n34, e.n41, e.n42, e.n43, e.n44), this
            },
            lookAt: function(e, t, i) {
                var r = n.__v1,
                    o = n.__v2,
                    a = n.__v3;
                return a.sub(e, t).normalize(), 0 === a.length() && (a.z = 1), r.cross(i, a).normalize(), 0 === r.length() && (a.x += 1e-4, r.cross(i, a).normalize()), o.cross(a, r), this.n11 = r.x, this.n12 = o.x, this.n13 = a.x, this.n21 = r.y, this.n22 = o.y, this.n23 = a.y, this.n31 = r.z, this.n32 = o.z, this.n33 = a.z, this
            },
            multiply: function(e, t) {
                var i = e.n11,
                    n = e.n12,
                    r = e.n13,
                    o = e.n14,
                    a = e.n21,
                    s = e.n22,
                    l = e.n23,
                    h = e.n24,
                    u = e.n31,
                    d = e.n32,
                    c = e.n33,
                    f = e.n34,
                    p = e.n41,
                    m = e.n42,
                    g = e.n43,
                    _ = e.n44,
                    v = t.n11,
                    y = t.n12,
                    b = t.n13,
                    x = t.n14,
                    w = t.n21,
                    M = t.n22,
                    T = t.n23,
                    S = t.n24,
                    C = t.n31,
                    E = t.n32,
                    k = t.n33,
                    L = t.n34,
                    P = t.n41,
                    A = t.n42,
                    R = t.n43,
                    D = t.n44;
                return this.n11 = i * v + n * w + r * C + o * P, this.n12 = i * y + n * M + r * E + o * A, this.n13 = i * b + n * T + r * k + o * R, this.n14 = i * x + n * S + r * L + o * D, this.n21 = a * v + s * w + l * C + h * P, this.n22 = a * y + s * M + l * E + h * A, this.n23 = a * b + s * T + l * k + h * R, this.n24 = a * x + s * S + l * L + h * D, this.n31 = u * v + d * w + c * C + f * P, this.n32 = u * y + d * M + c * E + f * A, this.n33 = u * b + d * T + c * k + f * R, this.n34 = u * x + d * S + c * L + f * D, this.n41 = p * v + m * w + g * C + _ * P, this.n42 = p * y + m * M + g * E + _ * A, this.n43 = p * b + m * T + g * k + _ * R, this.n44 = p * x + m * S + g * L + _ * D, this
            },
            multiplySelf: function(e) {
                return this.multiply(this, e)
            },
            multiplyToArray: function(e, t, i) {
                return this.multiply(e, t), this.flattenToArray(i), this
            },
            multiplyScalar: function(e) {
                return this.n11 *= e, this.n12 *= e, this.n13 *= e, this.n14 *= e, this.n21 *= e, this.n22 *= e, this.n23 *= e, this.n24 *= e, this.n31 *= e, this.n32 *= e, this.n33 *= e, this.n34 *= e, this.n41 *= e, this.n42 *= e, this.n43 *= e, this.n44 *= e, this
            },
            multiplyVector3: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z,
                    r = 1 / (this.n41 * t + this.n42 * i + this.n43 * n + this.n44);
                return e.x = (this.n11 * t + this.n12 * i + this.n13 * n + this.n14) * r, e.y = (this.n21 * t + this.n22 * i + this.n23 * n + this.n24) * r, e.z = (this.n31 * t + this.n32 * i + this.n33 * n + this.n34) * r, e
            },
            multiplyVector3Optimized: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z;
                return e.x = this.n11 * t + this.n12 * i + this.n13 * n + this.n14, e.y = this.n21 * t + this.n22 * i + this.n23 * n + this.n24, e.z = this.n31 * t + this.n32 * i + this.n33 * n + this.n34, e
            },
            determinant: function() {
                var e = this.n11,
                    t = this.n12,
                    i = this.n13,
                    n = this.n14,
                    r = this.n21,
                    o = this.n22,
                    a = this.n23,
                    s = this.n24,
                    l = this.n31,
                    h = this.n32,
                    u = this.n33,
                    d = this.n34,
                    c = this.n41,
                    f = this.n42,
                    p = this.n43,
                    m = this.n44;
                return n * a * h * c - i * s * h * c - n * o * u * c + t * s * u * c + i * o * d * c - t * a * d * c - n * a * l * f + i * s * l * f + n * r * u * f - e * s * u * f - i * r * d * f + e * a * d * f + n * o * l * p - t * s * l * p - n * r * h * p + e * s * h * p + t * r * d * p - e * o * d * p - i * o * l * m + t * a * l * m + i * r * h * m - e * a * h * m - t * r * u * m + e * o * u * m
            },
            transpose: function() {
                var e;
                return e = this.n21, this.n21 = this.n12, this.n12 = e, e = this.n31, this.n31 = this.n13, this.n13 = e, e = this.n32, this.n32 = this.n23, this.n23 = e, e = this.n41, this.n41 = this.n14, this.n14 = e, e = this.n42, this.n42 = this.n24, this.n24 = e, e = this.n43, this.n43 = this.n34, this.n34 = e, this
            },
            clone: function() {
                var e = new n;
                return e.set(this.n11, this.n12, this.n13, this.n14, this.n21, this.n22, this.n23, this.n24, this.n31, this.n32, this.n33, this.n34, this.n41, this.n42, this.n43, this.n44), e
            },
            flattenToArray: function(e, t) {
                t = t || 0, e[t++] = this.n11, e[t++] = this.n21, e[t++] = this.n31, e[t++] = this.n41, e[t++] = this.n12, e[t++] = this.n22, e[t++] = this.n32, e[t++] = this.n42, e[t++] = this.n13, e[t++] = this.n23, e[t++] = this.n33, e[t++] = this.n43, e[t++] = this.n14, e[t++] = this.n24, e[t++] = this.n34, e[t++] = this.n44
            },
            setPosition: function(e) {
                return this.n14 = e.x, this.n24 = e.y, this.n34 = e.z, this
            },
            getPosition: function() {
                return n.__v1.set(this.n14, this.n24, this.n34)
            },
            getColumnX: function() {
                return n.__v1.set(this.n11, this.n21, this.n31)
            },
            getColumnY: function() {
                return n.__v1.set(this.n12, this.n22, this.n32)
            },
            getColumnZ: function() {
                return n.__v1.set(this.n13, this.n23, this.n33)
            },
            getInverse: function(e) {
                var t = e.n11,
                    i = e.n12,
                    n = e.n13,
                    r = e.n14,
                    o = e.n21,
                    a = e.n22,
                    s = e.n23,
                    l = e.n24,
                    h = e.n31,
                    u = e.n32,
                    d = e.n33,
                    c = e.n34,
                    f = e.n41,
                    p = e.n42,
                    m = e.n43,
                    g = e.n44;
                return this.n11 = s * c * p - l * d * p + l * u * m - a * c * m - s * u * g + a * d * g, this.n12 = r * d * p - n * c * p - r * u * m + i * c * m + n * u * g - i * d * g, this.n13 = n * l * p - r * s * p + r * a * m - i * l * m - n * a * g + i * s * g, this.n14 = r * s * u - n * l * u - r * a * d + i * l * d + n * a * c - i * s * c, this.n21 = l * d * f - s * c * f - l * h * m + o * c * m + s * h * g - o * d * g, this.n22 = n * c * f - r * d * f + r * h * m - t * c * m - n * h * g + t * d * g, this.n23 = r * s * f - n * l * f - r * o * m + t * l * m + n * o * g - t * s * g, this.n24 = n * l * h - r * s * h + r * o * d - t * l * d - n * o * c + t * s * c, this.n31 = a * c * f - l * u * f + l * h * p - o * c * p - a * h * g + o * u * g, this.n32 = r * u * f - i * c * f - r * h * p + t * c * p + i * h * g - t * u * g, this.n33 = i * l * f - r * a * f + r * o * p - t * l * p - i * o * g + t * a * g, this.n34 = r * a * h - i * l * h - r * o * u + t * l * u + i * o * c - t * a * c, this.n41 = s * u * f - a * d * f - s * h * p + o * d * p + a * h * m - o * u * m, this.n42 = i * d * f - n * u * f + n * h * p - t * d * p - i * h * m + t * u * m, this.n43 = n * a * f - i * s * f - n * o * p + t * s * p + i * o * m - t * a * m, this.n44 = i * s * h - n * a * h + n * o * u - t * s * u - i * o * d + t * a * d, this.multiplyScalar(1 / e.determinant()), this
            },
            setRotation: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z,
                    r = Math.cos(t),
                    o = Math.sin(t),
                    a = Math.cos(i),
                    s = Math.sin(i),
                    l = Math.cos(n),
                    h = Math.sin(n),
                    u = r * l,
                    d = r * h,
                    c = o * l,
                    f = o * h;
                return this.n11 = a * l, this.n12 = -a * h, this.n13 = s, this.n21 = d + c * s, this.n22 = u - f * s, this.n23 = -o * a, this.n31 = f - u * s, this.n32 = c + d * s, this.n33 = r * a, this
            },
            scale: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z;
                return this.n11 *= t, this.n12 *= i, this.n13 *= n, this.n21 *= t, this.n22 *= i, this.n23 *= n, this.n31 *= t, this.n32 *= i, this.n33 *= n, this.n41 *= t, this.n42 *= i, this.n43 *= n, this
            },
            extractPosition: function(e) {
                return this.n14 = e.n14, this.n24 = e.n24, this.n34 = e.n34, this
            },
            extractRotation: function(e) {
                var t = n.__v1.set(e.n11, e.n21, e.n31).length(),
                    i = n.__v1.set(e.n12, e.n22, e.n32).length(),
                    r = n.__v1.set(e.n13, e.n23, e.n33).length();
                return this.n11 = e.n11 / t, this.n21 = e.n21 / t, this.n31 = e.n31 / t, this.n12 = e.n12 / i, this.n22 = e.n22 / i, this.n32 = e.n32 / i, this.n13 = e.n13 / r, this.n23 = e.n23 / r, this.n33 = e.n33 / r, this
            },
            getScales: function(e) {
                e.x = n.__v0.set(this.n11, this.n21, this.n31).length(), e.y = n.__v0.set(this.n12, this.n22, this.n32).length(), e.z = n.__v0.set(this.n13, this.n23, this.n33).length()
            },
            translate: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z;
                return this.n14 = this.n11 * t + this.n12 * i + this.n13 * n + this.n14, this.n24 = this.n21 * t + this.n22 * i + this.n23 * n + this.n24, this.n34 = this.n31 * t + this.n32 * i + this.n33 * n + this.n34, this.n44 = this.n41 * t + this.n42 * i + this.n43 * n + this.n44, this
            },
            setRotationFromQuaternion: function(e) {
                var t = e.x,
                    i = e.y,
                    n = e.z,
                    r = e.w,
                    o = t + t,
                    a = i + i,
                    s = n + n,
                    l = t * o,
                    h = t * a,
                    u = t * s,
                    d = i * a,
                    c = i * s,
                    f = n * s,
                    p = r * o,
                    m = r * a,
                    g = r * s;
                return this.n11 = 1 - (d + f), this.n12 = h - g, this.n13 = u + m, this.n21 = h + g, this.n22 = 1 - (l + f), this.n23 = c - p, this.n31 = u - m, this.n32 = c + p, this.n33 = 1 - (l + d), this
            },
            lerp: function(e, t) {
                if (0 != t) {
                    if (t >= 1) return void this.copy(e);
                    var i = t,
                        r = 1 - t,
                        a = function(e, t) {
                            return e * r + t * i
                        };
                    this.getScales(n.__v3), e.getScales(n.__v4), n.__v3.lerpSelf(n.__v4, t);
                    var s = new o;
                    s.rotationFromMatrx(this);
                    var l = new o;
                    l.rotationFromMatrx(e), s.lerp(l, t), this.setRotationFromQuaternion(s), this.scale(n.__v3), this.n14 = a(this.n14, e.n14), this.n24 = a(this.n24, e.n24), this.n34 = a(this.n34, e.n34), this.n44 = a(this.n44, e.n44)
                }
            },
            makeOrtho: function(e, t, i, n, r, o) {
                var a, s, l, h, u, d;
                return h = t - e, u = i - n, d = o - r, a = (t + e) / h, s = (i + n) / u, l = (o + r) / d, this.n11 = 2 / h, this.n12 = 0, this.n13 = 0, this.n14 = -a, this.n21 = 0, this.n22 = 2 / u, this.n23 = 0, this.n24 = -s, this.n31 = 0, this.n32 = 0, this.n33 = -2 / d, this.n34 = -l, this.n41 = 0, this.n42 = 0, this.n43 = 0, this.n44 = 1, this
            },
            makePerspective: function(e, t, i, n) {
                var r, o, a, s;
                return r = i * Math.tan(e * Math.PI / 360), o = -r, a = o * t, s = r * t, this.makeFrustum(a, s, o, r, i, n)
            },
            makeFrustum: function(e, t, i, n, r, o) {
                var a, s, l, h, u, d;
                return a = 2 * r / (t - e), s = 2 * r / (n - i), l = (t + e) / (t - e), h = (n + i) / (n - i), u = -(o + r) / (o - r), d = -2 * o * r / (o - r), this.n11 = a, this.n12 = 0, this.n13 = l, this.n14 = 0, this.n21 = 0, this.n22 = s, this.n23 = h, this.n24 = 0, this.n31 = 0, this.n32 = 0, this.n33 = u, this.n34 = d, this.n41 = 0, this.n42 = 0, this.n43 = -1, this.n44 = 0, this
            }
        }, n.MultiplyToArray = function(e, t, i) {
            var n = e.n11,
                r = e.n12,
                o = e.n13,
                a = e.n14,
                s = e.n21,
                l = e.n22,
                h = e.n23,
                u = e.n24,
                d = e.n31,
                c = e.n32,
                f = e.n33,
                p = e.n34,
                m = e.n41,
                g = e.n42,
                _ = e.n43,
                v = e.n44,
                y = t.n11,
                b = t.n12,
                x = t.n13,
                w = t.n14,
                M = t.n21,
                T = t.n22,
                S = t.n23,
                C = t.n24,
                E = t.n31,
                k = t.n32,
                L = t.n33,
                P = t.n34,
                A = t.n41,
                R = t.n42,
                D = t.n43,
                I = t.n44;
            i[0] = n * y + r * M + o * E + a * A, i[1] = s * y + l * M + h * E + u * A, i[2] = d * y + c * M + f * E + p * A, i[3] = m * y + g * M + _ * E + v * A, i[4] = n * b + r * T + o * k + a * R, i[5] = s * b + l * T + h * k + u * R, i[6] = d * b + c * T + f * k + p * R, i[7] = m * b + g * T + _ * k + v * R, i[8] = n * x + r * S + o * L + a * D, i[9] = s * x + l * S + h * L + u * D, i[10] = d * x + c * S + f * L + p * D, i[11] = m * x + g * S + _ * L + v * D, i[12] = n * w + r * C + o * P + a * I, i[13] = s * w + l * C + h * P + u * I, i[14] = d * w + c * C + f * P + p * I, i[15] = m * w + g * C + _ * P + v * I
        }, n.__v0 = new r, n.__v1 = new r, n.__v2 = new r, n.__v3 = new r, n.__v4 = new r, n.__m = new n
    }, {
        "./Quaternion": 61,
        "./Vector3": 63
    }],
    61: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            this.x = e || 0, this.y = t || 0, this.z = i || 0, this.w = n || 0
        }
        var r = e("./Vector3");
        t.exports = n, n.prototype.set = function(e, t, i, n) {
            this.x = e, this.y = t, this.z = i, this.w = n
        }, n.prototype.clone = function() {
            return new n(this.x, this.y, this.z, this.w)
        }, n.prototype.flattenToArray = function(e, t) {
            t = t || 0, e[t++] = this.x, e[t++] = this.y, e[t++] = this.z, e[t++] = this.w
        }, n.prototype.rotationFromMatrx = function(e) {
            var t, i = new r,
                n = 1 / i.set(e.n11, e.n21, e.n31).length(),
                o = 1 / i.set(e.n12, e.n22, e.n32).length(),
                a = 1 / i.set(e.n13, e.n23, e.n33).length(),
                s = e.n11 * n,
                l = e.n12 * o,
                h = e.n13 * a,
                u = e.n21 * n,
                d = e.n22 * o,
                c = e.n23 * a,
                f = e.n31 * n,
                p = e.n32 * o,
                m = e.n33 * a,
                g = s + d + m;
            g > 0 ? (t = .5 / Math.sqrt(g + 1), this.w = .25 / t, this.x = (p - c) * t, this.y = (h - f) * t, this.z = (u - l) * t) : s > d && s > m ? (t = 2 * Math.sqrt(1 + s - d - m), this.w = (p - c) / t, this.x = .25 * t, this.y = (l + u) / t, this.z = (h + f) / t) : d > m ? (t = 2 * Math.sqrt(1 + d - s - m), this.w = (h - f) / t, this.x = (l + u) / t, this.y = .25 * t, this.z = (c + p) / t) : (t = 2 * Math.sqrt(1 + m - s - d), this.w = (u - l) / t, this.x = (h + f) / t, this.y = (c + p) / t, this.z = .25 * t)
        }, n.prototype.lerp = function(e, t) {
            var i = this.x,
                n = this.y,
                r = this.z,
                o = this.w,
                a = o * e.w + i * e.x + n * e.y + r * e.z;
            if (!(a >= 1)) {
                0 > a ? (this.w = -e.w, this.x = -e.x, this.y = -e.y, this.z = -e.z, a = -a) : (this.w = e.w, this.x = e.x, this.y = e.y, this.z = e.z);
                var s = Math.acos(a),
                    l = Math.sqrt(1 - a * a);
                if (Math.abs(l) < .001) return this.w = .5 * (o + this.w), this.x = .5 * (i + this.x), this.y = .5 * (n + this.y), void(this.z = .5 * (r + this.z));
                var h = Math.sin((1 - t) * s) / l,
                    u = Math.sin(t * s) / l;
                this.w = o * h + this.w * u, this.x = i * h + this.x * u, this.y = n * h + this.y * u, this.z = r * h + this.z * u
            }
        }
    }, {
        "./Vector3": 63
    }],
    62: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.x = e || 0, this.y = t || 0
        }
        t.exports = n, n.equals = function(e, t) {
            return e.x === t.x && e.y === t.y
        }, n.clone = function(e) {
            return new n(e.x, e.y)
        }, n.prototype = {
            constructor: n,
            set: function(e, t) {
                return this.x = e, this.y = t, this
            },
            copy: function(e) {
                return this.x = e.x, this.y = e.y, this
            },
            clone: function() {
                return n.clone(this)
            },
            add: function(e, t) {
                return this.x = e.x + t.x, this.y = e.y + t.y, this
            },
            addSelf: function(e) {
                return this.x += e.x, this.y += e.y, this
            },
            sub: function(e, t) {
                return this.x = e.x - t.x, this.y = e.y - t.y, this
            },
            subSelf: function(e) {
                return this.x -= e.x, this.y -= e.y, this
            },
            multiplyScalar: function(e) {
                return this.x *= e, this.y *= e, this
            },
            divideScalar: function(e) {
                return e ? (this.x /= e, this.y /= e) : this.set(0, 0), this
            },
            negate: function() {
                return this.multiplyScalar(-1)
            },
            dot: function(e) {
                return this.x * e.x + this.y * e.y
            },
            lengthSq: function() {
                return this.x * this.x + this.y * this.y
            },
            length: function() {
                return Math.sqrt(this.lengthSq())
            },
            normalize: function() {
                return this.divideScalar(this.length())
            },
            normalizeIfNotZero: function() {
                return this.isZero() ? this : this.normalize()
            },
            distanceTo: function(e) {
                return Math.sqrt(this.distanceToSquared(e))
            },
            distanceToSquared: function(e) {
                var t = this.x - e.x,
                    i = this.y - e.y;
                return t * t + i * i
            },
            setLength: function(e) {
                return this.normalize().multiplyScalar(e)
            },
            lerpSelf: function(e, t) {
                return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this
            },
            equals: function(e) {
                return n.equals(this, e)
            },
            isZero: function() {
                return this.lengthSq() < 1e-4
            },
            minSelf: function(e) {
                this.x = Math.min(this.x, e.x), this.y = Math.min(this.y, e.y)
            },
            minSelf2: function(e, t) {
                this.x = Math.min(this.x, e), this.y = Math.min(this.y, t)
            },
            maxSelf: function(e) {
                this.x = Math.max(this.x, e.x), this.y = Math.max(this.y, e.y)
            },
            maxSelf2: function(e, t) {
                this.x = Math.max(this.x, e), this.y = Math.max(this.y, t)
            }
        }
    }, {}],
    63: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this.x = e || 0, this.y = t || 0, this.z = i || 0
        }
        t.exports = n, n.magnitude = function(e) {
            return Math.sqrt(e.x * e.x + e.y * e.y + e.z * e.z)
        }, n.prototype = {
            constructor: n,
            set: function(e, t, i) {
                return this.x = e, this.y = t, this.z = i, this
            },
            setX: function(e) {
                return this.x = e, this
            },
            setY: function(e) {
                return this.y = e, this
            },
            setZ: function(e) {
                return this.z = e, this
            },
            copy: function(e) {
                return this.x = e.x, this.y = e.y, this.z = e.z, this
            },
            clone: function() {
                return new n(this.x, this.y, this.z)
            },
            add: function(e, t) {
                return this.x = e.x + t.x, this.y = e.y + t.y, this.z = e.z + t.z, this
            },
            addSelf: function(e) {
                return this.x += e.x, this.y += e.y, this.z += e.z, this
            },
            addScalar: function(e) {
                return this.x += e, this.y += e, this.z += e, this
            },
            sub: function(e, t) {
                return this.x = e.x - t.x, this.y = e.y - t.y, this.z = e.z - t.z, this
            },
            subSelf: function(e) {
                return this.x -= e.x, this.y -= e.y, this.z -= e.z, this
            },
            multiply: function(e, t) {
                return this.x = e.x * t.x, this.y = e.y * t.y, this.z = e.z * t.z, this
            },
            multiplySelf: function(e) {
                return this.x *= e.x, this.y *= e.y, this.z *= e.z, this
            },
            multiplyScalar: function(e) {
                return this.x *= e, this.y *= e, this.z *= e, this
            },
            divideSelf: function(e) {
                return this.x /= e.x, this.y /= e.y, this.z /= e.z, this
            },
            divideScalar: function(e) {
                return e && (this.x /= e, this.y /= e, this.z /= e), this
            },
            negate: function() {
                return this.multiplyScalar(-1)
            },
            dot: function(e) {
                return this.x * e.x + this.y * e.y + this.z * e.z
            },
            lengthSq: function() {
                return this.x * this.x + this.y * this.y + this.z * this.z
            },
            length: function() {
                return Math.sqrt(this.lengthSq())
            },
            lengthManhattan: function() {
                return Math.abs(this.x) + Math.abs(this.y) + Math.abs(this.z)
            },
            normalize: function() {
                return this.divideScalar(this.length())
            },
            normalizeIfNotZero: function() {
                return this.isZero() ? this : this.normalize()
            },
            setLength: function(e) {
                return this.normalize().multiplyScalar(e)
            },
            lerpSelf: function(e, t) {
                return this.x += (e.x - this.x) * t, this.y += (e.y - this.y) * t, this.z += (e.z - this.z) * t, this
            },
            cross: function(e, t) {
                return this.x = e.y * t.z - e.z * t.y, this.y = e.z * t.x - e.x * t.z, this.z = e.x * t.y - e.y * t.x, this
            },
            crossSelf: function(e) {
                var t = this.x,
                    i = this.y,
                    n = this.z;
                return this.x = i * e.z - n * e.y, this.y = n * e.x - t * e.z, this.z = t * e.y - i * e.x, this
            },
            distanceTo: function(e) {
                return Math.sqrt(this.distanceToSquared(e))
            },
            distanceToSquared: function(e) {
                return (new n).sub(this, e).lengthSq()
            },
            getPositionFromMatrix: function(e) {
                return this.x = e.n14, this.y = e.n24, this.z = e.n34, this
            },
            getRotationFromMatrix: function(e, t) {
                var i = t ? t.x : 1,
                    n = t ? t.y : 1,
                    r = t ? t.z : 1,
                    o = e.n11 / i,
                    a = e.n12 / n,
                    s = e.n13 / r,
                    l = e.n21 / i,
                    h = e.n22 / n,
                    u = e.n23 / r,
                    d = e.n33 / r;
                this.y = Math.asin(s);
                var c = Math.cos(this.y);
                return Math.abs(c) > 1e-5 ? (this.x = Math.atan2(-u / c, d / c), this.z = Math.atan2(-a / c, o / c)) : (this.x = 0, this.z = Math.atan2(l, h)), this
            },
            getScaleFromMatrix: function(e) {
                var t = this.set(e.n11, e.n21, e.n31).length(),
                    i = this.set(e.n12, e.n22, e.n32).length(),
                    n = this.set(e.n13, e.n23, e.n33).length();
                this.x = t, this.y = i, this.z = n
            },
            equals: function(e) {
                return e.x === this.x && e.y === this.y && e.z === this.z
            },
            nearEquals: function(e, t) {
                return Math.abs(e.x - this.x) < t && Math.abs(e.y - this.y) < t && Math.abs(e.z - this.z) < t
            },
            isZero: function() {
                return this.lengthSq() < 1e-4
            },
            minSelf: function(e) {
                this.x = Math.min(this.x, e.x), this.y = Math.min(this.y, e.y), this.z = Math.min(this.z, e.z)
            },
            minSelf3: function(e, t, i) {
                this.x = Math.min(this.x, e), this.y = Math.min(this.y, t), this.z = Math.min(this.z, i)
            },
            maxSelf: function(e) {
                this.x = Math.max(this.x, e.x), this.y = Math.max(this.y, e.y), this.z = Math.max(this.z, e.z);
            },
            maxSelf3: function(e, t, i) {
                this.x = Math.max(this.x, e), this.y = Math.max(this.y, t), this.z = Math.max(this.z, i)
            }
        }, n.xUnit = new n(1, 0, 0), n.yUnit = new n(0, 1, 0), n.zUnit = new n(0, 0, 1)
    }, {}],
    64: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.xhr = new XMLHttpRequest, this.callback = t, this.url = e, this.xhr.onreadystatechange = r.bind(this.onReady, this), this.xhr.open("GET", e, !0), this.xhr.responseType = "arraybuffer", this.xhr.send()
        }
        var r = e("underscore"),
            o = e("./ModelDecoder");
        t.exports = n;
        var a = n.prototype;
        a.onReady = function() {
            if (4 == this.xhr.readyState)
                if (!this.xhr.response || 200 != this.xhr.status && 0 != this.xhr.status) {
                    if (0 != this.xhr.status) {
                        var e = new Error("BinaryLoader: Couldn't load " + this.url + " status = " + this.xhr.status);
                        console.error(e.message), this.callback(e, null, null)
                    }
                } else this.ondataReceived(this.xhr.response)
        }, a.abort = function() {
            this.xhr && this.xhr.abort()
        }, a.ondataReceived = function(e) {
            var t, i;
            try {
                var n = new o;
                i = n.decodeData(e)
            } catch (r) {
                t = r, console.error("Binary loading failed", this.url, r)
            }
            t ? this.callback(t, null, null) : this.callback(null, i.geometry, i.skeleton), delete this.callback
        }
    }, {
        "./ModelDecoder": 66,
        underscore: 207
    }],
    65: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._renderEngine = e, this.meshHeight = 0, this.isLoading = !1, this.noLight = !1, this.texturePath = null, this.useEnvmap = !1, this.useSkeleton = !1, this.uniformColor = null, this.cropAtHeight = null, this.transparent = !1, this.useAlphaStep = !1, this.useSpecularLighting = !1
        }
        var r = e("underscore"),
            o = e("../Constants"),
            a = e("./BinaryLoader"),
            s = e("./ModelDecoder"),
            l = e("../object/Mesh");
        t.exports = n, n.prototype.setUniformColor = function(e) {
            var t = e != this.uniformColor;
            t && null != this.uniformColor && null != e && (t = !this.uniformColor.equals(e)), t && (this.uniformColor = e, this.buildMaterial(), this.material.uniforms.uColor && (this.material.uniforms.uColor.value.r = this.uniformColor.r, this.material.uniforms.uColor.value.g = this.uniformColor.g, this.material.uniforms.uColor.value.b = this.uniformColor.b, this.material.uniforms.uColor.value.a = this.uniformColor.a))
        }, n.prototype.setCropAtHeight = function(e) {
            var t = e != this.cropAtHeight;
            t && (this.cropAtHeight = e, this.buildMaterial(), this.material.uniforms.uMaxHeight && (this.material.uniforms.uMaxHeight.value = this.cropAtHeight))
        }, n.prototype.setUseAlphaStep = function(e) {
            this.useAlphaStep != e && (this.useAlphaStep = e, this.buildMaterial())
        }, n.prototype.setUseSpecularLighting = function(e) {
            this.useSpecularLighting != e && (this.useSpecularLighting = e, this.buildMaterial())
        }, n.prototype.setUseEnvmap = function(e) {
            this.useEnvmap != e && (this.useEnvmap = e, this.buildMaterial())
        }, n.prototype.setTransparent = function(e) {
            this.transparent != e && (this.material.transparent = this.transparent ? o.Mask : o.Opaque)
        }, n.prototype.setMaterial = function(e) {
            this._renderEngine && (this.material && this._renderEngine.releaseMaterial(this.material), this.material = this._renderEngine.createMaterial(e), this.material.uniforms.tex0 && this.diffuseTexture && (this.material.uniforms.tex0.texture = this.diffuseTexture), this.material.uniforms.uColor && (this.material.uniforms.uColor.value.r = this.uniformColor.r, this.material.uniforms.uColor.value.g = this.uniformColor.g, this.material.uniforms.uColor.value.b = this.uniformColor.b, this.material.uniforms.uColor.value.a = this.uniformColor.a), this.material.uniforms.uMaxHeight && (this.material.uniforms.uMaxHeight.value = this.cropAtHeight), null != this.mesh && (this.mesh.material = this.material))
        }, n.prototype.unload = function() {
            this._renderEngine && (this.material && (this.material.uniforms.envTexture && this._renderEngine.releaseTexture(this.material.uniforms.envTexture.texture), this._renderEngine.releaseMaterial(this.material), delete this.material), this.diffuseTexture && (this._renderEngine.releaseTexture(this.diffuseTexture), delete this.diffuseTexture), null != this.mesh && this._renderEngine.releaseObject(this.mesh)), delete this.mesh, delete this.sceneParent
        }, n.prototype.handleMeshLoaded = function() {
            this._renderEngine && (this.sceneParent.add(this.mesh), this._renderEngine.forceUpdateShadow(), this._renderEngine.forceRender())
        }, n.prototype.onDiffuseTextureLoaded = function() {
            this.diffuseTextureLoaded = !0, this.mesh && this.handleMeshLoaded()
        }, n.prototype.playAnimation = function(e) {
            this.animation = null != e ? e : 0, null != this.mesh.skeleton && (this.mesh.animSpeed = 1, this.mesh.skeleton.playAnimation(this.animation))
        }, n.prototype.abortLoading = function() {
            this._loadingModel && (this._loadingModel.abort(), delete this._loadingModel)
        }, n.prototype.buildOptions = function(e) {
            return e = r.defaults(e, {
                pos: null,
                sceneParent: null,
                noLight: !1,
                texturePath: null,
                useEnvmap: !1,
                doubleSided: !1,
                clearOnWebglLoad: !1,
                transparent: !1,
                uniformColor: null
            })
        }, n.prototype.load = function(e, t, i) {
            t = this.buildOptions(t), this.unload(), this.sceneParent = t.sceneParent, this.loadTexture(t.texturePath);
            var n = r.bind(function(e, n, r) {
                e || this.buildMesh(n, r, t), i && i(e, this)
            }, this);
            this._loadingModel = new a(e, n)
        }, n.prototype.loadWithRawData = function(e, t) {
            t = this.buildOptions(t), this.unload(), this.sceneParent = t.sceneParent, this.loadTexture(t.texturePath);
            var i = new s,
                n = i.decodeData(e);
            this.buildMesh(n.geometry, n.skeleton, t)
        }, n.prototype.loadWithGeometry = function(e, t) {
            t = this.buildOptions(t), this.unload(), this.sceneParent = t.sceneParent, this.loadTexture(t.texturePath), this.buildMesh(e, null, t)
        }, n.prototype.loadTexture = function(e) {
            if (e && this._renderEngine) {
                this.diffuseTexture && this._renderEngine.releaseTexture(this.diffuseTexture), this.diffuseTextureLoaded = !1;
                var t = e.split(".").pop(),
                    i = {
                        repeat: o.RepeatWrapping,
                        onSuccess: r.bind(this.onDiffuseTextureLoaded, this)
                    };
                "zip" == t ? this.diffuseTexture = this._renderEngine.loadCompressedTexture(e, "zip", i) : "dds" == t ? this.diffuseTexture = this._renderEngine.loadCompressedTexture(e, "s3tc", i) : this.diffuseTexture = this._renderEngine.loadTexture(e, i)
            }
        }, n.prototype.buildMaterial = function() {
            var e = this._renderEngine.getShadowExtensionName(),
                t = this.noLight ? "nolight" : "dirlight" + e;
            this.texturePath && (t += "_texture"), this.useEnvmap && (t += "_envmap"), this.useSkeleton && (t += "_skinning"), this.uniformColor && (t += "_uniformColor"), null != this.cropAtHeight && (t += "_heightCropping"), this.useAlphaStep && (t += "_alphaStep"), this.useSpecularLighting && (t += "_specularLighting"), t != this.materialName && (this.setMaterial(t), this.materialName = t, this.material && (this.material.transparent = this.transparent ? o.Mask : o.Opaque))
        }, n.prototype.buildMesh = function(e, t, i) {
            var n = i.pos,
                r = i.texturePath,
                o = i.useEnvmap,
                a = i.doubleSided,
                s = i.clearOnWebglLoad,
                h = i.transparent,
                u = i.uniformColor,
                d = i.cropAtHeight,
                c = i.useAlphaStep,
                f = i.useSpecularLighting,
                p = i.noLight;
            if (this.texturePath = r, this.useEnvmap = o, this.noLight = p, this.useSkeleton = null != t, this.uniformColor = u, this.cropAtHeight = d, this.useAlphaStep = c, this.useSpecularLighting = f, this.transparent = h, !this._renderEngine || this.sceneParent) {
                if (delete this._loadingModel, this.buildMaterial(), this._renderEngine ? this.mesh = this._renderEngine.createMesh(e, this.material) : this.mesh = new l(e, this.material), t) {
                    var m = t.clone();
                    this.mesh.setSkeleton(m), m.playAnimation(0), this.mesh.animSpeed = 1
                }
                n && (this.mesh.position.copy(n), this.mesh.updateMatrix()), a && (this.mesh.doubleSided = a), (!this.diffuseTexture || this.diffuseTextureLoaded) && this.handleMeshLoaded(), e.boundingRadius = -1, this.xyRadius = 0;
                for (var g = 0; g < e._positionArray.length;) {
                    var _ = e._positionArray[g++],
                        v = e._positionArray[g++];
                    this.xyRadius = Math.max(this.xyRadius, _ * _ + v * v);
                    var y = e._positionArray[g++];
                    this.meshHeight = Math.max(this.meshHeight, y), e.boundingRadius = Math.max(e.boundingRadius, _ * _ + v * v + y * y)
                }
                e.boundingRadius = Math.sqrt(e.boundingRadius), this.xyRadius = Math.sqrt(this.xyRadius), e.clearOnWebglLoad = s
            }
        }
    }, {
        "../Constants": 14,
        "../object/Mesh": 69,
        "./BinaryLoader": 64,
        "./ModelDecoder": 66,
        underscore: 207
    }],
    66: [function(e, t, i) {
        "use strict";

        function n() {}
        var r = e("../object/Geometry"),
            o = e("../Color"),
            a = e("../math/Matrix4"),
            s = e("../animation/Animation"),
            l = e("../animation/AnimationKey"),
            h = e("../animation/Skeleton"),
            u = e("../animation/Bone");
        t.exports = n, n.prototype.decodeData = function(e) {
            var t = new r;
            t._positionArray = [], t._normalArray = [], t._uvArray = [], t.fixedColor = new o;
            var i, n, d, c, f, p, m, g, _ = null,
                v = 1,
                y = 0,
                b = 0,
                x = 0,
                w = new Float32Array(e),
                M = w[0];
            if (-3 == M) {
                var T = new Uint16Array(w.buffer);
                t._indexArray = [];
                var S = w[1];
                n = w[2], b = w[3], y = 0 != b, y && (t._weightsArray = [], t._bonesIndexArray = []), x = w[4];
                var C = 10,
                    E = S % 2 == 1;
                for (d = E ? 5 + (S + 1) / 2 : 5 + S / 2, c = d + 3 * n, f = c + 3 * n, p = f + 2 * n, m = p + 2 * n, i = 0; S > i; i++) t._indexArray[i] = T[C++];
                for (g = 0; n > g; ++g) t._positionArray.push(w[d++], w[d++], w[d++]), t._normalArray.push(w[c++], w[c++], w[c++]), t._uvArray.push(w[f++], w[f++]), y && (t._weightsArray.push(w[p++], w[p++]), t._bonesIndexArray.push(w[m++], w[m++], w[m++]));
                y && (v = m)
            } else if (-2 == M) {
                for (n = w[1], b = w[2], y = 0 != b, y && (t._weightsArray = [], t._bonesIndexArray = []), x = w[3], d = 4, c = d + 3 * n, f = c + 3 * n, p = f + 2 * n, m = p + 2 * n, g = 0; n > g; ++g) t._positionArray.push(w[d++], w[d++], w[d++]), t._normalArray.push(w[c++], w[c++], w[c++]), t._uvArray.push(w[f++], w[f++]), y && (t._weightsArray.push(w[p++], w[p++]), t._bonesIndexArray.push(w[m++], w[m++], w[m++]));
                y && (v = m)
            } else {
                console.warn("Model", this.url, "uses old format, please update Model Server"), M = 0;
                var k = w[v++],
                    L = w[v++];
                0 > k && (M = k, k = L, L = w[v++], b = w[v++], x = w[v++]), y = 0 != b, y && (t._weightsArray = [], t._bonesIndexArray = []);
                var P = v;
                v = P + 3 * k;
                for (var A = 0; L > A; ++A) {
                    var R = P + 3 * w[v++],
                        D = P + 3 * w[v++],
                        I = P + 3 * w[v++];
                    t._positionArray.push(w[R], w[R + 1], w[R + 2]), t._positionArray.push(w[D], w[D + 1], w[D + 2]), t._positionArray.push(w[I], w[I + 1], w[I + 2]), t._normalArray.push(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]), t._uvArray.push(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]), y && (t._weightsArray.push(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]), t._bonesIndexArray.push(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]))
                }
            }
            var O, N = null;
            if (y) {
                _ = new h(b);
                for (var B = 0; b > B; ++B) {
                    i = w[v++];
                    var F = w[v++];
                    O = new a, O.set(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]), _.addBone(new u(i, F, O))
                }
                _.updateHierarchy(), N = [];
                for (var z = 0; x > z; ++z) {
                    for (var H = w[v++], U = new s, W = 0; H > W; ++W) {
                        for (var G = w[v++], j = new l(G), q = 0; b > q; ++q) O = new a, O.set(w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++], w[v++]), j.addMatrix(O);
                        U.addKey(j)
                    }
                    N.push(U)
                }
                _.setAnimations(N)
            }
            var V = {
                geometry: t,
                skeleton: _
            };
            return V
        }
    }, {
        "../Color": 13,
        "../animation/Animation": 23,
        "../animation/AnimationKey": 24,
        "../animation/Bone": 25,
        "../animation/Skeleton": 27,
        "../math/Matrix4": 60,
        "../object/Geometry": 68
    }],
    67: [function(e, t, i) {
        "use strict";

        function n() {
            this._objLineDataHandlerCallback = r.bind(this.objLineDataHandler, this), this.geometry = null, this._positionArray = [], this._normalArray = [], this._uvArray = [], this._indexArray = [], this._isTextured = !1, this._tmpVector = new a
        }
        var r = e("underscore"),
            o = e("../object/Geometry"),
            a = e("../math/Vector3"),
            s = e("../math/Vector2"),
            l = e("../Color");
        t.exports = n, n.prototype["import"] = function(e, t, i) {
            if (this._flipYZ = null != i ? i : !0, this.handleFileData(e, i)) {
                if (0 == this._positionArray.length) return void console.warn("No position data imported for the OBJ");
                console.log("Imported " + this._positionArray.length / 3 + " vertices"), this.geometry = new o, this.geometry.fixedColor = new l(16777215), this.geometry.__isColorDirty = !0, 0 == this._normalArray.length && (console.log("Building normal data"), this.buildNormalArray(t)), this.geometry._positionArray = this._positionArray, this.geometry.__isPositionDirty = !0, 0 != this._uvArray.length && (this.geometry._uvArray = this._uvArray, this.geometry.__isUvDirty = !0, this._isTextured = !0), 0 != this._indexArray.length && (this.geometry._indexArray = this._indexArray), this.geometry._normalArray = this._normalArray, this.geometry.__isNormalDirty = !0
            }
        }, n.prototype.handleFileData = function(e) {
            for (var t = 0, i = !0, n = 0; t < e.length && i;) {
                var r = e.indexOf("\n", t); - 1 == r && (r = e.length);
                var o = e.substring(t, r);
                i = this.decodeLine(o, this._objLineDataHandlerCallback), i || console.log("Failed import on line " + n + ' :"' + o + '"'), t = r + 1, n++
            }
            return i
        }, n.prototype.objLineDataHandler = function(e, t, i) {
            var n = !0;
            return e ? (console.error(e.message), !1) : ("v" == t ? n = this.addPosition(i) : "vt" == t ? n = this.addUV(i) : "vn" == t ? n = this.addNormal(i) : "f" == t && (n = this.addFace(i)), n)
        }, n.prototype.decodeLine = function(e, t) {
            var i, n, r = !0;
            if (e.trim(), e.length > 1) {
                var o = e.substr(0, e.indexOf(" ")),
                    a = e.substr(e.indexOf(" ")).trim().replace(/\s+/g, " ");
                if ("#" == o);
                else if ("v" == o || "vn" == o) i = a.split(" "), i.length < 3 ? (t(new Error("vertex position or normal does not contain x,y,z")), r = !1) : (n = {
                    x: i[0],
                    y: i[1],
                    z: i[2]
                }, r = t(null, o, n));
                else if ("vt" == o) i = a.split(" "), i.length < 2 ? (t(new Error("vertex UV does not contain u,v")), r = !1) : (n = {
                    u: i[0],
                    v: i[1]
                }, r = t(null, o, n));
                else if ("f" == o)
                    if (i = a.split(" "), 3 != i.length && 4 != i.length) t(new Error("Face data does not contain triangle or quad positions")), r = !1;
                    else {
                        var s = function(e, i) {
                            for (var n = [], r = 0; 3 > r; r++) {
                                var a = i[r],
                                    s = {
                                        positionIndex: null,
                                        uvIndex: null,
                                        normalIndex: null
                                    };
                                if (n[a] = s, -1 == e[a].indexOf("/")) s.positionIndex = e[a];
                                else {
                                    var l = e[a].split("/");
                                    s.positionIndex = l[0], l.length >= 2 && "" != l[1] && (s.uvIndex = l[1]), l.length >= 3 && "" != l[2] && (s.normalIndex = l[2])
                                }
                            }
                            return t(null, o, n)
                        };
                        3 == i.length ? r = s(i, [0, 1, 2]) : (r = s(i, [0, 1, 2]), r = r && s(i, [2, 3, 0]))
                    }
            }
            return r
        }, n.prototype.addPosition = function(e) {
            return this._flipYZ ? this._positionArray.push(+e.x, +e.z, +e.y) : this._positionArray.push(+e.x, +e.y, +e.z), !0
        }, n.prototype.addNormal = function(e) {
            return this._tmpVector.set(+e.x, +e.y, +e.z), this._tmpVector.normalize(), this._normalArray.push(this._tmpVector.x, this._tmpVector.y, this._tmpVector.z), !0
        }, n.prototype.addUV = function(e) {
            return this._uvArray.push(+e.u, +e.v), !0
        }, n.prototype.addFace = function(e) {
            for (var t = 0; 3 > t; t++) {
                var i = !0,
                    n = e[t],
                    r = n.positionIndex;
                if (n.uvIndex && (i = n.uvIndex == r), n.normalIndex && (i = n.normalIndex == r), !i) return console.error("OBJ with differing vertex attribute indices is not supported"), !1;
                this._indexArray.push(+(r - 1))
            }
            return !0
        }, n.prototype.buildNormalArray = function(e) {
            var t, i, n = this._indexArray.length / 3,
                r = new a,
                o = new a,
                l = new a,
                h = [],
                u = [],
                d = this._positionArray.length / 3;
            for (i = 0; d > i; i++) {
                var c = 3 * i,
                    f = 2 * i,
                    p = new a(this._positionArray[c], this._positionArray[c + 1], this._positionArray[c + 2]);
                t = {
                    position: p,
                    uv: null,
                    normal: null,
                    linked: null
                }, h.push(t), this._uvArray.length > 0 && (t.uv = new s(this._uvArray[f], this._uvArray[f + 1]))
            }
            for (var m = 0; n > m; m++) {
                var g = 3 * m,
                    _ = this._indexArray[g],
                    v = this._indexArray[g + 1],
                    y = this._indexArray[g + 2],
                    b = h[_],
                    x = h[v],
                    w = h[y],
                    M = b.position,
                    T = x.position,
                    S = w.position,
                    C = b.uv,
                    E = x.uv,
                    k = w.uv;
                r.sub(T, M), o.sub(S, M), l.cross(o, r);
                var L = this.handleBuiltVertexNormal(_, M, C, l, h, e),
                    P = this.handleBuiltVertexNormal(v, T, E, l, h, e),
                    A = this.handleBuiltVertexNormal(y, S, k, l, h, e);
                u.push(L), u.push(P), u.push(A)
            }
            var R = [],
                D = [],
                I = [],
                O = h.length;
            for (i = 0; O > i; i++) t = h[i], t.normal.normalize(), R.push(t.position.x, t.position.y, t.position.z), D.push(t.normal.x, t.normal.y, t.normal.z), this._uvArray.length > 0 && I.push(t.uv.x, t.uv.y);
            console.log("Normals built: from " + d + " vertices to " + O + " vertices"), console.log("Normals built: from " + this._indexArray.length + " indices to " + u.length + " indices"), this._positionArray = R, this._normalArray = D, this._uvArray = I, this._indexArray = u
        }, n.prototype.handleBuiltVertexNormal = function(e, t, i, n, r, o) {
            var a = r[e];
            if (null == a.normal) return a.normal = n.clone(), e;
            if (o) return a.normal.addSelf(n), e;
            if (a.normal.nearEquals(n, .001)) return e;
            if (null == a.linked) {
                var s = {
                        position: t.clone(),
                        uv: null != i ? i.clone() : null,
                        normal: n.clone(),
                        linked: null
                    },
                    l = r.length;
                return r[l] = s, a.linked = l, l
            }
            return this.handleBuiltVertexNormal(a.linked, t, i, n, r)
        }
    }, {
        "../Color": 13,
        "../math/Vector2": 62,
        "../math/Vector3": 63,
        "../object/Geometry": 68,
        underscore: 207
    }],
    68: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.id = n.GeometryCounter++, this.boundingRadius = 0, this.clearOnWebglLoad = !1, this.primitiveType = null != e ? e : l.TRIANGLES, this.clear(), this.attributes = null, this.__isDirty = !0, this.__isPositionDirty = !0, this.__isColorDirty = !0, this.__isUvDirty = !0, this.__isNormalDirty = !0, this.__isSkinningDirty = !0, this.__isMiniSkinningDirty = !0, this.__isUserDataDirty = !0, this.__isIndexDirty = !0, this.__isInterleavingDirty = !0, this.__pointsCount = -1, this.__indexCount = -1
        }
        var r = e("underscore"),
            o = e("../math/Vector3"),
            a = e("../Color"),
            s = e("../math/Matrix4"),
            l = e("../Constants"),
            h = new o;
        t.exports = n, n.GeometryCounter = 0, n.maxFloatCount = Math.pow(2, 20), n.maxIndexCount = Math.pow(2, 16);
        var u = window.Float32Array ? new Float32Array(n.maxFloatCount) : null;
        n.prototype = {
            constructor: n,
            onWebGLBufferGenerated: function() {
                this.__isDirty = !1, this.__isPositionDirty = !1, this.__isColorDirty = !1, this.__isUvDirty = !1, this.__isNormalDirty = !1, this.__isSkinningDirty = !1, this.__isMiniSkinningDirty = !1, this.__isUserDataDirty = !1, this.__isIndexDirty = !1, this.__isInterleavingDirty = !0, this.clearOnWebglLoad && this.clear()
            },
            clear: function() {
                this._positionArray = null, this._colorArray = null, this._normalArray = null, this._uvArray = null, this._userDataArray = null, this._weightsArray = null, this._bonesIndexArray = null, this._miniSkinIndexArray = null, this._indexArray = null, this._interleavedData = null
            },
            needsRebuildWebGLBuffer: function() {
                return this.__isDirty || this.__isPositionDirty || this.__isColorDirty || this.__isUvDirty || this.__isNormalDirty || this.__isSkinningDirty || this.__isMiniSkinningDirty || this.__isUserDataDirty || this.__isIndexDirty ? ((this.__isDirty || this.__isPositionDirty || this.__isInterleavingDirty) && (this.ptsCount = this.getPointsCount()), (this.__isDirty || this.__isIndexDirty) && (this.indexCount = this.getIndexCount()), !0) : !1
            },
            getPointsCount: function() {
                return this.__pointsCount >= 0 ? this.__pointsCount : this._interleavedData ? this._interleavedData.array / this._interleavedData.stride : this._positionArray ? this._positionArray.length / 3 : 0
            },
            setPointsCount: function(e) {
                e != this.__pointsCount && (this.__pointsCount = e, this.__isDirty = !0)
            },
            getIndexCount: function() {
                return this.__indexCount >= 0 ? this.__indexCount : this._indexArray ? this._indexArray.length : 0
            },
            setIndexCount: function(e) {
                e != this.__indexCount && (this.__indexCount = e, this.__isDirty = !0)
            },
            setInterleaveDetails: function(e, t) {
                this._interleavedData = {
                    stride: e,
                    array: [],
                    details: t
                }, this.__isInterleavingDirty = !0
            },
            smoothNormals: function(e) {
                if (this.primitiveType == l.TRIANGLES && this._positionArray && this._normalArray) {
                    for (var t, i, n = {}, r = e ? 3 * e : 0, a = r; a < this._positionArray.length;) i = "_" + this._positionArray[a] + "_" + this._positionArray[a + 1] + "_" + this._positionArray[a + 2], t = n[i], t || (t = n[i] = new o), t.x += this._normalArray[a], t.y += this._normalArray[a + 1], t.z += this._normalArray[a + 2], a += 3;
                    for (a = r; a < this._positionArray.length;) i = "_" + this._positionArray[a] + "_" + this._positionArray[a + 1] + "_" + this._positionArray[a + 2], t = n[i], t.normalized || (t.normalized = !0, t.normalize()), this._normalArray[a] = t.x, this._normalArray[a + 1] = t.y, this._normalArray[a + 2] = t.z, a += 3
                }
            },
            clone: function() {
                var e = new n(this.primitiveType);
                return e.boundingRadius = this.boundingRadius, this._positionArray && (r.isArray(this._positionArray) ? e._positionArray = this._positionArray.concat() : e._positionArray = this._positionArray.subarray(0)), this._colorArray && (r.isArray(this._colorArray) ? e._colorArray = this._colorArray.concat() : e._colorArray = this._colorArray.subarray(0)), this.fixedColor && (e.fixedColor = this.fixedColor.clone()), this._normalArray && (r.isArray(this._normalArray) ? e._normalArray = this._normalArray.concat() : e._normalArray = this._normalArray.subarray(0)), this._uvArray && (r.isArray(this._uvArray) ? e._uvArray = this._uvArray.concat() : e._uvArray = this._uvArray.subarray(0)), this._userDataArray && (r.isArray(this._userDataArray) ? e._userDataArray = this._userDataArray.concat() : e._userDataArray = this._userDataArray.subarray(0)), this._weightsArray && (r.isArray(this._weightsArray) ? e._weightsArray = this._weightsArray.concat() : e._weightsArray = this._weightsArray.subarray(0)), this._bonesIndexArray && (r.isArray(this._bonesIndexArray) ? e._bonesIndexArray = this._bonesIndexArray.concat() : e._bonesIndexArray = this._bonesIndexArray.subarray(0)), this._miniSkinIndexArray && (r.isArray(this._miniSkinIndexArray) ? e._miniSkinIndexArray = this._miniSkinIndexArray.concat() : e._miniSkinIndexArray = this._miniSkinIndexArray.subarray(0)), this._indexArray && (r.isArray(this._indexArray) ? e._indexArray = this._indexArray.concat() : e._indexArray = this._indexArray.subarray(0)), this._interleavedData && (e._interleavedData = {
                    stride: this._interleavedData.stride,
                    array: r.isArray(this._interleavedData.array) ? this._interleavedData.array.concat() : this._interleavedData.array.subarray(0),
                    details: r.clone(this._interleavedData.details)
                }), e
            },
            convertTrianglesToLines: function() {
                var e, t = [];
                if (this._indexArray)
                    for (var i = this._indexArray.length / 3, n = 0; i > n; n++) e = 3 * n, t.push(this._indexArray[e], this._indexArray[e + 1], this._indexArray[e + 1], this._indexArray[e + 2], this._indexArray[e + 2], this._indexArray[e]);
                else {
                    this.getPointsCount() > 65534 && console.warn("Generated wireframe geometry is 2 large for indexBuffer, some triangles will be missing");
                    var r = this.getPointsCount();
                    for (e = 0; r > e; e += 3) t.push(e, e + 1, e + 1, e + 2, e + 2, e)
                }
                this.primitiveType = l.LINES, this._indexArray = t, this.__isIndexDirty = !0
            },
            convertTrianglesToPoints: function() {
                var e, t = [];
                this.getPointsCount() > 65534 && console.warn("Generated points geometry is 2 large for indexBuffer, some triangles will be missing");
                var i = this.getPointsCount();
                for (e = 0; i > e; e++) t.push(e);
                this.primitiveType = l.POINTS, this._indexArray = t, this.__isIndexDirty = !0
            },
            setRigidSkin: function(e) {
                var t = this.getPointsCount();
                this._weightsArray = [], this._bonesIndexArray = [];
                for (var i = 0; t > i; ++i) this._weightsArray.push(e, 0), this._bonesIndexArray.push(0, 0, 0)
            },
            append: function(e, t, i) {
                var n = e.boundingRadius;
                if (n > 0) {
                    if (t) {
                        var o = h;
                        t.getScales(o);
                        var a = t.getPosition();
                        n = a.length() + n * Math.max(o.x, o.y, o.z)
                    }
                    this.boundingRadius < 0 && this.computeBoundingSphere(), this.boundingRadius = Math.max(this.boundingRadius, n)
                }
                var l;
                t && (l = new s, l.extractRotation(t)), e._positionArray && null == this._positionArray && (this._positionArray = []), (e._colorArray || i) && null == this._colorArray && (this._colorArray = []), e._normalArray && null == this._normalArray && (this._normalArray = []), e._uvArray && null == this._uvArray && (this._uvArray = []), e._userDataArray && null == this._userDataArray && (this._userDataArray = []), e._weightsArray && null == this._weightsArray && (this._weightsArray = []), e._bonesIndexArray && null == this._bonesIndexArray && (this._bonesIndexArray = []), e._miniSkinIndexArray && null == this._miniSkinIndexArray && (this._miniSkinIndexArray = []), e._indexArray && null == this._indexArray && (this._indexArray = []);
                var d = function(e, t) {
                    for (var i = 0; i < t.length;) e.push(t[i++])
                };
                if (this._indexArray) {
                    var c = this.getPointsCount();
                    r.each(e._indexArray, function(e) {
                        this._indexArray.push(c + e)
                    }, this)
                }
                var f = 0,
                    p = h;
                if (this._positionArray)
                    if (t && !t.isIdentity())
                        if (0 == t.n41 && 0 == t.n42 && 0 == t.n43 && 1 == t.n44)
                            for (f = 0; f < e._positionArray.length;) p.set(e._positionArray[f++], e._positionArray[f++], e._positionArray[f++]), t.multiplyVector3Optimized(p), this._positionArray.push(p.x, p.y, p.z);
                        else
                            for (f = 0; f < e._positionArray.length;) p.set(e._positionArray[f++], e._positionArray[f++], e._positionArray[f++]), t.multiplyVector3(p), this._positionArray.push(p.x, p.y, p.z);
                else d(this._positionArray, e._positionArray);
                if (this._normalArray)
                    if (l && !l.isIdentity())
                        for (f = 0; f < e._normalArray.length;) p.set(e._normalArray[f++], e._normalArray[f++], e._normalArray[f++]), l.multiplyVector3(p), this._normalArray.push(p.x, p.y, p.z);
                    else d(this._normalArray, e._normalArray);
                if (this._colorArray) {
                    if (i)
                        for (f = 0; f < e.getPointsCount(); ++f) this._colorArray.push(i.r, i.g, i.b, i.a);
                    else d(this._colorArray, e._colorArray);
                    if (u && u.length < this._colorArray.length) throw new Error("Color array very increasingly too much big (Size is important!) Current size = " + this._colorArray.length)
                }
                this._uvArray && d(this._uvArray, e._uvArray), this._userDataArray && d(this._userDataArray, e._userDataArray), this._weightsArray && d(this._weightsArray, e._weightsArray), this._bonesIndexArray && d(this._bonesIndexArray, e._bonesIndexArray), this._miniSkinIndexArray && d(this._miniSkinIndexArray, e._miniSkinIndexArray), this.__isDirty = !0
            },
            verifyAppend: function(e) {
                var t = n.maxFloatCount,
                    i = n.maxFloatCount,
                    r = n.maxFloatCount,
                    o = n.maxFloatCount,
                    a = n.maxFloatCount,
                    s = n.maxFloatCount,
                    l = n.maxFloatCount,
                    h = n.maxFloatCount;
                return this._indexArray && (t = n.maxIndexCount / 3, i = n.maxIndexCount / 3, r = n.maxIndexCount / 4, o = n.maxIndexCount / 2, a = n.maxIndexCount / 4, s = n.maxIndexCount / 2, l = n.maxIndexCount / 3, h = n.maxIndexCount), this._positionArray && e._positionArray && this._positionArray.length + e._positionArray.length > t ? !1 : this._colorArray && e._colorArray && this._colorArray.length + e._colorArray.length > r ? !1 : this._normalArray && e._normalArray && this._normalArray.length + e._normalArray.length > i ? !1 : this._uvArray && e._uvArray && this._uvArray.length + e._uvArray.length > o ? !1 : this._userDataArray && e._userDataArray && this._userDataArray.length + e._userDataArray.length > a ? !1 : this._weightsArray && e._weightsArray && this._weightsArray.length + e._weightsArray.length > s ? !1 : this._bonesIndexArray && e._bonesIndexArray && this._bonesIndexArray.length + e._bonesIndexArray.length > l ? !1 : this._miniSkinIndexArray && e._miniSkinIndexArray && this._miniSkinIndexArray.length + e._miniSkinIndexArray.length > h ? !1 : !0
            },
            getPositionBuffer32: function() {
                return this._positionArray && (this.__isDirty || this.__isPositionDirty) ? (this._positionArray.length > n.maxFloatCount && console.warn("Position buffer is too large for common Float32 buffer"), r.isArray(this._positionArray) ? (u.set(this._positionArray), u.subarray(0, 3 * this.getPointsCount())) : this._positionArray) : null
            },
            getColorBuffer32: function() {
                return this._colorArray && (this.__isDirty || this.__isColorDirty) ? (u.length < this._colorArray.length && console.warn("Color buffer is too large for common Float32 buffer size=", this._colorArray.length), r.isArray(this._colorArray) ? (u.set(this._colorArray), u.subarray(0, 4 * this.getPointsCount())) : this._colorArray) : null
            },
            getFixedColorBuffer32: function() {
                if (!this.fixedColor || !this.__isDirty && !this.__isColorDirty) return null;
                var e = this.getPointsCount(),
                    t = 4 * e;
                t > n.maxFloatCount && console.warn("Color buffer is too large for common Float32 buffer");
                for (var i = 0, r = this.fixedColor; t > i;) u[i++] = r.r, u[i++] = r.g, u[i++] = r.b, u[i++] = r.a;
                return u.subarray(0, t)
            },
            getCompressedColorBuffer32: function() {
                if (!this._colorArray || !this.__isDirty && !this.__isColorDirty) return null;
                this._colorArray.length > n.maxFloatCount && console.warn("Color buffer is too large for common Float32 buffer");
                for (var e, t, i, r, o = 0, s = 0, l = this._colorArray, h = l.length, d = new a; h > o;) e = l[o++], t = l[o++], i = l[o++], r = l[o++], d.setRGB(e, t, i), u[s++] = d.getHex(), u[s++] = r;
                return u.subarray(0, this._colorArray.length / 2)
            },
            getFixedCompressedColorBuffer32: function() {
                if (!this.fixedColor || !this.__isDirty && !this.__isColorDirty) return null;
                var e = this.getPointsCount(),
                    t = 2 * e;
                t > n.maxFloatCount && console.warn("Color buffer is too large for common Float32 buffer");
                for (var i = 0, r = this.fixedColor, o = r.getHex(), a = r.a; t > i;) u[i++] = o, u[i++] = a;
                return u.subarray(0, t)
            },
            getNormalBuffer32: function() {
                return this._normalArray && (this.__isDirty || this.__isNormalDirty) ? (this._normalArray.length > n.maxFloatCount && console.warn("Normal buffer is too large for common Float32 buffer"), r.isArray(this._normalArray) ? (u.set(this._normalArray), u.subarray(0, 3 * this.getPointsCount())) : this._normalArray) : null
            },
            getCompressedNormalBuffer32: function() {
                if (!this._normalArray || !this.__isDirty && !this.__isNormalDirty) return null;
                this._normalArray.length > n.maxFloatCount && console.warn("Normal buffer is too large for common Float32 buffer");
                var e, t, i, r, o = 0,
                    a = 0,
                    s = this._normalArray,
                    l = s.length;
                u.set(this._normalArray);
                for (var h = 2048, d = (h - 1) / 2, c = h * h; l > o;) e = Math.floor((s[o++] + 1) * d), t = Math.floor((s[o++] + 1) * d), i = s[o++], r = t * h + e, i >= 0 && (r += c), u[a++] = r;
                return u.subarray(0, this.getPointsCount())
            },
            getUvBuffer32: function() {
                return this._uvArray && (this.__isDirty || this.__isUvDirty) ? (this._uvArray.length > n.maxFloatCount && console.warn("Uv buffer is too large for common Float32 buffer"), r.isArray(this._uvArray) ? (u.set(this._uvArray), u.subarray(0, 2 * this.getPointsCount())) : this._uvArray) : null
            },
            getUserDataBuffer32: function() {
                return this._userDataArray && (this.__isDirty || this.__isUserDataDirty) ? (this._userDataArray.length > n.maxFloatCount && console.warn("UserData buffer is too large for common Float32 buffer"), r.isArray(this._userDataArray) ? (u.set(this._userDataArray), u.subarray(0, 4 * this.getPointsCount())) : this._userDataArray) : null
            },
            getMiniSkinningBuffer32: function() {
                return this._miniSkinIndexArray && (this.__isDirty || this.__isMiniSkinningDirty) ? (this._miniSkinIndexArray.length > n.maxFloatCount && console.warn("MiniSinning buffer is too large for common Float32 buffer"), r.isArray(this._miniSkinIndexArray) ? (u.set(this._miniSkinIndexArray), u.subarray(0, this.getPointsCount())) : this._miniSkinIndexArray) : null
            },
            getBonesIndexBuffer32: function() {
                return this._bonesIndexArray && (this.__isDirty || this.__isSkinningDirty) ? (this._bonesIndexArray.length > n.maxFloatCount && console.warn("BoneIndex buffer is too large for common Float32 buffer"), r.isArray(this._bonesIndexArray) ? (u.set(this._bonesIndexArray), u.subarray(0, 3 * this.getPointsCount())) : this._bonesIndexArray) : null
            },
            getWeightBuffer32: function() {
                return this._weightsArray && (this.__isDirty || this.__isSkinningDirty) ? (this._weightsArray.length > n.maxFloatCount && console.warn("Weight buffer is too large for common Float32 buffer"), r.isArray(this._weightsArray) ? (u.set(this._weightsArray), u.subarray(0, 2 * this.getPointsCount())) : this._weightsArray) : null
            },
            getIndexBuffer16: function() {
                return this._indexArray && (this.__isIndexDirty || this.__isDirty) ? r.isArray(this._indexArray) ? new Uint16Array(this._indexArray) : this._indexArray : null
            },
            getInterleavedBuffer32: function() {
                return this._interleavedData && (this.__isDirty || this.__isInterleavingDirty) ? (this._interleavedData.array.length > n.maxFloatCount && console.warn("Interleaved data is too large for common Float32 buffer"), r.isArray(this._interleavedData.array) ? (u.set(this._interleavedData.array), u.subarray(0, this.getPointsCount() * this._interleavedData.stride)) : this._interleavedData.array) : null
            },
            isAttributeInterleaved: function(e) {
                var t = this.getAttributeDetails(e);
                return void 0 !== t && null != t
            },
            getAttributeDetails: function(e) {
                if (!this._interleavedData) return null;
                var t = r.find(this._interleavedData.details, function(t, i) {
                    return i === e
                });
                return t
            },
            getAttributeBuffer32: function(e, t) {
                switch (e) {
                    case "position":
                        return this.getPositionBuffer32();
                    case "color":
                        return this.fixedColor ? t.canUseFixedColor ? null : this.getFixedColorBuffer32() : this.getColorBuffer32();
                    case "compressedColor":
                        return this.fixedColor ? t.canUseFixedColor ? null : this.getFixedCompressedColorBuffer32() : this.getCompressedColorBuffer32();
                    case "normal":
                        return this.getNormalBuffer32();
                    case "compressedNormal":
                        return this.getCompressedNormalBuffer32();
                    case "uv":
                        return this.getUvBuffer32();
                    case "userData":
                        return this.getUserDataBuffer32();
                    case "miniSkinIndex":
                        return this.getMiniSkinningBuffer32();
                    case "weights":
                        return this.getWeightBuffer32();
                    case "bonesIndex":
                        return this.getBonesIndexBuffer32()
                }
                return null
            },
            getAttributeValue: function(e, t) {
                var i, n;
                return "color" == e && this.fixedColor && t.canUseFixedColor ? (i = this.fixedColor, n = new Float32Array(4), n[0] = i.r, n[1] = i.g, n[2] = i.b, n[3] = i.a, n) : "compressedColor" == e && this.fixedColor && t.canUseFixedColor ? (i = this.fixedColor, n = new Float32Array(2), n[0] = i.getHex(), n[1] = i.a, n) : null
            },
            getBoundingBox: function() {
                if (this._positionArray) {
                    if (this._boundingBox) return this._boundingBox;
                    for (var e = {
                            minX: 999999,
                            maxX: -999999,
                            minY: 999999,
                            maxY: -999999,
                            minZ: 999999,
                            maxZ: -999999
                        }, t = 0; t < this._positionArray.length; t += 3) e.minX = Math.min(e.minX, this._positionArray[t + 0]), e.maxX = Math.max(e.maxX, this._positionArray[t + 0]), e.minY = Math.min(e.minY, this._positionArray[t + 1]), e.maxY = Math.max(e.maxY, this._positionArray[t + 1]), e.minZ = Math.min(e.minZ, this._positionArray[t + 2]), e.maxZ = Math.max(e.maxZ, this._positionArray[t + 2]);
                    return e.center = {
                        x: .5 * (e.minX + e.maxX),
                        y: .5 * (e.minY + e.maxY),
                        z: .5 * (e.minZ + e.maxZ)
                    }, this._boundingBox = e, e
                }
                return null
            }
        }
    }, {
        "../Color": 13,
        "../Constants": 14,
        "../math/Matrix4": 60,
        "../math/Vector3": 63,
        underscore: 207
    }],
    69: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            r.call(this), this.isMesh = !0, this.cleanup(), this.construct(e, t)
        }
        var r = e("./Object3D");
        t.exports = n, n.prototype = new r, n.prototype.constructor = n, n.prototype.supr = r.prototype, n.prototype.construct = function(e, t) {
            this.geometry = e, this.material = t, this.vertexSubArray = null
        }, n.prototype.cleanup = function() {
            this.geometry = null, this.material = null, this.vertexSubArray = null, this.ignoreRayCast = !1, this.parent && this.parent.remove(this), this.parent = null, this.children = [], this.position.set(0, 0, 0), this.rotation.set(0, 0, 0), this.scale.set(1, 1, 1),
                this.doubleSided = !1, this.renderPriority = 0, delete this.miniSkinQuat, delete this.miniSkinQuatArray, this.skeleton && (delete this._updateSkeletonCbk, delete this.skeleton, delete this.animSpeed), this.matrix.identity(), this.matrixWorld.identity(), delete this.preRenderFunc, delete this.postRenderFunc, delete this.renderFunc, delete this.cleanupCallback, this.visible = !0, this.handleRenderPass = {}
        }, n.prototype.updateSkeleton = function(e) {
            if (e = e || {
                    dt: 1
                }, this.skeleton) this.skeleton.computeAnim(e.dt * this.animSpeed);
            else if (this.miniSkinQuat) {
                this.miniSkinQuatArray || (this.miniSkinQuatArray = new Float32Array(4 * this.miniSkinQuat.length));
                for (var t = 0; t < this.miniSkinQuat.length; ++t) this.miniSkinQuat[t].flattenToArray(this.miniSkinQuatArray, 4 * t)
            }
            return Boolean(this.handleRenderPass.shadowDepth)
        }, n.prototype.updateAnimation = function(e) {
            var t = this.updateSkeleton(e);
            return t |= r.prototype.updateAnimation.apply(this, arguments)
        }, n.prototype.setSkeleton = function(e) {
            this.skeleton = e, this.animSpeed = 1
        }, n.prototype.getSkinningMatrixArray = function() {
            return this.skeleton ? this.skeleton.bonesMatrixArray : this.miniSkinQuatArray ? this.miniSkinQuatArray : null
        }, n.prototype.useVertexSubArray = function(e, t) {
            this.vertexSubArray = {
                startIndex: e,
                count: t
            }
        }, n.prototype.useIndexedVertexSubArray = function(e, t) {
            this.vertexSubArray = {
                startIndex: e,
                count: t
            }
        }, n.prototype.updateRenderPriority = function(e) {
            if (this.renderPriority = e, this.parent) {
                for (var t = this; null != t.parent;) t = t.parent;
                t.updateObjectSortPosition && t.updateObjectSortPosition(this)
            }
        }
    }, {
        "./Object3D": 70
    }],
    70: [function(e, t, i) {
        "use strict";

        function n() {
            this.id = n.Object3DCount++, this.parent = null, this.children = [], this.position = new r, this.rotation = new r, this.scale = new r(1, 1, 1), this.matrix = new o, this.matrixWorld = new o, this._objectMatrixArray = new Float32Array(16)
        }
        var r = e("../math/Vector3"),
            o = e("../math/Matrix4"),
            a = e("underscore");
        t.exports = n, n.prototype = {
            constructor: n,
            add: function(e) {
                if (e === this) return void console.warn("Object3D.add: An object can't be added as a child of itself.");
                if (-1 === this.children.indexOf(e)) {
                    null != e.parent && e.parent.remove(e), e.parent = this, this.children.push(e);
                    for (var t = this; null != t.parent;) t = t.parent;
                    null !== t && t.isScene && t.addObject(e)
                }
            },
            removeAllChildren: function() {
                var e = a.clone(this.children);
                a.each(e, function(e) {
                    e.removeAllChildren(), this.remove(e)
                }, this), this.children = []
            },
            remove: function(e) {
                var t = this.children.indexOf(e);
                if (-1 !== t) {
                    e.parent = null, this.children.splice(t, 1);
                    for (var i = this; null !== i.parent;) i = i.parent;
                    null !== i && i.isScene && i.removeObject(e)
                }
            },
            updateMatrix: function() {
                this.matrix.setPosition(this.position), this.matrix.setRotation(this.rotation), (1 !== this.scale.x || 1 !== this.scale.y || 1 !== this.scale.z) && this.matrix.scale(this.scale), this.parent ? this.matrixWorld.multiply(this.parent.matrixWorld, this.matrix) : this.matrixWorld.copy(this.matrix), this._objectMatrixArray && this.matrixWorld.flattenToArray(this._objectMatrixArray);
                for (var e = 0, t = this.children.length; t > e; e++) this.children[e].updateMatrix()
            },
            updateMatrixFromQuaternion: function(e) {
                this.matrix.setPosition(this.position), this.matrix.setRotationFromQuaternion(e), (1 !== this.scale.x || 1 !== this.scale.y || 1 !== this.scale.z) && this.matrix.scale(this.scale), this.parent ? this.matrixWorld.multiply(this.parent.matrixWorld, this.matrix) : this.matrixWorld.copy(this.matrix), this._objectMatrixArray && this.matrixWorld.flattenToArray(this._objectMatrixArray);
                for (var t = 0, i = this.children.length; i > t; t++) this.children[t].updateMatrix()
            },
            updateAnimation: function(e) {
                var t = !1;
                return a.each(this.children, function(i) {
                    t |= i.updateAnimation(e)
                }, this), t
            },
            applyRecursively: function(e) {
                e(this);
                for (var t = 0, i = this.children.length; i > t; t++) this.children[t].applyRecursively(e)
            }
        }, n.Object3DCount = 0
    }, {
        "../math/Matrix4": 60,
        "../math/Vector3": 63,
        underscore: 207
    }],
    71: [function(e, t, i) {
        "use strict";

        function n() {
            o.call(this), this.isScene = !0, this.sortedObjects = [], this.effectsIds = {}, this.effectsCount = 0
        }
        var r = e("underscore"),
            o = e("./Object3D");
        t.exports = n, n.prototype = new o, n.prototype.constructor = n, n.prototype.addObject = function(e) {
            e.isMesh && this.updateObjectSortPosition(e);
            for (var t = 0; t < e.children.length; t++) this.addObject(e.children[t])
        }, n.prototype.updateObjectSortPosition = function(e) {
            var t = this.sortedObjects.indexOf(e);
            if (t >= 0 && this.sortedObjects.splice(t, 1), e.material) {
                var i = e.material.effectName;
                i in this.effectsIds || (this.effectsIds[i] = this.effectsCount++ % 64);
                var n = this.effectsIds[i];
                e._computedRenderPriority = 8096 * e.renderPriority * 64 * 2 + 8096 * e.material.transparent * 64 + 8096 * n + e.material.id;
                var o = r.sortedIndex(this.sortedObjects, e, function(e) {
                    return e._computedRenderPriority
                });
                this.sortedObjects.splice(o, 0, e)
            } else console.error("No material for object in scene ", e)
        }, n.prototype.removeObject = function(e) {
            if (e.isMesh) {
                var t = this.sortedObjects.indexOf(e); - 1 !== t && this.sortedObjects.splice(t, 1)
            }
            for (var i = 0; i < e.children.length; i++) this.removeObject(e.children[i])
        }, n.prototype.getIdxInScene = function(e) {
            return this.sortedObjects.indexOf(e)
        }, n.prototype.removeAllObjects = function() {
            var e = this.sortedObjects;
            r.each(e, function(e) {
                e.removeAllChildren()
            }), this.removeAllChildren(), this.sortedObjects = [], this.effectsIds = {}, this.effectsCount = 0
        }
    }, {
        "./Object3D": 70,
        underscore: 207
    }],
    72: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, r) {
            this._textureHandler = t, this._renderEngine = e, this.name = i, this.countPerLine = n / r, this._renderTarget = new a(n, n), this.waitingTex = [], this.textureMapping = [];
            for (var o = this.countPerLine * this.countPerLine, l = 0; o > l; ++l) this.textureMapping.push(null);
            var h = new s;
            h.a = 0, this._renderEngine._webGL.setAndClearRenderTarget(this._renderTarget, h)
        }
        var r = e("underscore"),
            o = e("../Constants"),
            a = e("../RenderTarget"),
            s = e("../Color");
        t.exports = n, n.prototype.getTexture = function() {
            return this._renderTarget
        }, n.prototype.getTextureIndex = function(e, t) {
            var i = this.textureMapping.indexOf(e);
            return -1 == i && (i = this.textureMapping.indexOf(null), -1 == i ? (console.error("Atlas %s is full, consider new implementation with release method", this.name), i = 0) : (this._textureHandler.loadTexture(e, {
                onSuccess: r.bind(this.pushTextureToPack, this, i),
                serverName: t
            }), this.textureMapping[i] = e)), i
        }, n.prototype.pushTextureToPack = function(e, t) {
            0 == this.waitingTex.length && this._textureHandler.atlasWithWork.push(this), this.waitingTex.push({
                index: e,
                tex: t
            })
        }, n.prototype.packWaitingTex = function() {
            for (; 0 != this.waitingTex.length;) {
                var e = this.waitingTex.pop();
                this.packNow(e.index, e.tex)
            }
        }, n.prototype.packNow = function(e, t) {
            var i = t.minFilter,
                n = t.magFilter;
            t.magFilter = t.minFilter = o.LinearFilter;
            var r = Math.floor(e / this.countPerLine),
                a = e - r * this.countPerLine,
                s = (1 + 2 * a) / this.countPerLine - 1,
                l = (1 + 2 * r) / this.countPerLine - 1,
                h = t.image.width,
                u = t.image.height,
                d = 2 / this.countPerLine,
                c = 2 / this.countPerLine;
            h > u ? c *= u / h : u > h && (d *= h / u), this._renderEngine.textureToRenderTarget(t, {
                x: s,
                y: l,
                w: d,
                h: c
            }, this._renderTarget), this._textureHandler.releaseTexture(t), t.minFilter = i, t.magFilter = n
        }, n.prototype.onDivRemoved = function() {
            r.each(this.textureMapping, function(e) {
                e && this._textureHandler.releaseTexture(e)
            }, this), delete this.textureMapping, delete this._textureHandler, delete this._renderEngine, delete this._renderTarget
        }
    }, {
        "../Color": 13,
        "../Constants": 14,
        "../RenderTarget": 18,
        underscore: 207
    }],
    73: [function(e, t, i) {
        "use strict";

        function n() {
            throw new Error("abstract function")
        }

        function r(e) {
            return "s3tc" == e ? new a : "zip" == e ? new l : null
        }

        function o() {}

        function a() {
            o.call(this), this._dds = null
        }

        function s(e, t) {
            switch (t) {
                case "dxt1":
                    return e.COMPRESSED_RGB_S3TC_DXT1_EXT;
                case "dxt3":
                    return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;
                case "dxt5":
                    return e.COMPRESSED_RGBA_S3TC_DXT5_EXT;
                default:
                    throw new Error("unsupported format " + t)
            }
        }

        function l() {
            o.call(this), this._dds = null
        }
        var h = e("underscore"),
            u = e("util"),
            d = e("parse-dds"),
            c = e("jszip"),
            f = e("../utils/WebGLExtensionManager"),
            p = e("../Constants"),
            m = window.URL || window.webkitURL,
            g = window.URL || window.webkitURL ? (window.URL || window.webkitURL).revokeObjectURL : null;
        t.exports = {
            createHandler: r,
            S3CompressionHandler: a
        }, o.prototype.setData = n, o.prototype.uploadData = n, u.inherits(a, o), a.prototype.setData = function(e, t, i) {
            this._data = e, this._dds = d(e), t.generateMipmaps = 1 == this._dds.images.length, t.width = this._dds.shape[0], t.height = this._dds.shape[1], t.magFilter = p.LinearFilter, t.minFilter = p.LinearFilter, i(null)
        }, a.prototype.uploadData = function(e, t) {
            for (var i = t.enableExtension(f.compressed_texture_s3tc), n = s(i, this._dds.format), r = 0; r < this._dds.images.length; r++) {
                var o = this._dds.images[r],
                    a = new Uint8Array(this._data, o.offset, o.length),
                    l = o.shape[0],
                    h = o.shape[1];
                l > 1 && h > 1 && e.compressedTexImage2D(e.TEXTURE_2D, r, n, l, h, 0, a)
            }
        }, u.inherits(l, o), l.prototype.setData = function(e, t, i) {
            this._data = e, this._zip = new c, this._loadedCallback = i, this._remainingFileCount = 0, this._texture = t;
            var n = this._mipmaps = [];
            this._zipName = t.sourcePath.replace(/^.*[\\\/]/, "");
            var r = this._zipName.substr(0, this._zipName.length - ".zip".length) + "_",
                o = this;
            this._zip.loadAsync(e).then(function(e) {
                o._remainingFileCount = h.size(e.files), h.each(e.files, function(e, t) {
                    if (0 == t.indexOf(r)) {
                        var i = t.split(".").pop(),
                            a = t.substring(r.length, t.length - i.length - 1),
                            s = +a;
                        e.async("uint8Array").then(function(e) {
                            var t = new Image,
                                i = new Blob([e], {
                                    type: "image/jpeg"
                                }),
                                r = m.createObjectURL(i);
                            n[s] = r, t.onload = h.bind(function() {
                                o._onImageObtained(null, s, t)
                            }, o), t.onerror = h.bind(function(e) {
                                o._onImageObtained(e, s, t)
                            }, o), t.src = r
                        })
                    }
                })
            })
        }, l.prototype._onImageObtained = function(e, t, i) {
            var n = this._mipmaps[t];
            g(n), this._mipmaps[t] = i, this._remainingFileCount--, 0 == this._remainingFileCount && (this._texture.generateMipmaps = 1 == this._mipmaps.length, this._texture.width = this._mipmaps[0].width, this._texture.height = this._mipmaps[0].height, this._loadedCallback(), delete this._loadedCallback)
        }, l.prototype.uploadData = function(e) {
            for (var t, i = p.RGBAFormat, n = p.UnsignedByteType, r = !0, o = 0; o < this._mipmaps.length; o++) {
                var a = this._mipmaps[o];
                a ? (o > 0 && (r = r && (a.width == .5 * t.w || 1 == t.w) && (a.height == .5 * t.h || 1 == t.h), o == this._mipmaps.length - 1 && (r = r && 1 == a.width && 1 == a.height)), t = {
                    w: a.width,
                    h: a.height
                }, e.texImage2D(e.TEXTURE_2D, o, i, i, n, a)) : r = !1
            }
            r || (console.warn("Incorrect mipmap data obtained: deactivating mipmapping for " + this._zipName), this._texture.minFilter = p.LinearFilter)
        }
    }, {
        "../Constants": 14,
        "../utils/WebGLExtensionManager": 84,
        jszip: 121,
        "parse-dds": 167,
        underscore: 207,
        util: 212
    }],
    74: [function(e, t, i) {
        "use strict";

        function n() {
            this.id = n.TextureCount++, this.image = new Image, this._imagePtr = this.image, this.wrap = r.RepeatWrapping, this.magFilter = r.LinearFilter, this.minFilter = r.LinearMipMapLinearFilter, this.format = r.RGBAFormat, this.type = r.UnsignedByteType, this.useAnisotropic = !1, this.generateMipmaps = !0, this.needsUpdate = !1, this.request = null, this.loadedName = null, this.sourcePath = null, this.refCount = 0, this.aborted = !1
        }
        var r = e("../Constants");
        t.exports = n, n.TextureCount = 0, n.prototype.reset = function() {
            this.request = null, this.image = this._imagePtr, this.image.onload = null, this.loadedName = null, this.sourcePath = null, this.aborted = !1, this.wrap = r.RepeatWrapping, delete this.array, delete this.compressionHandler, this.magFilter = r.LinearFilter, this.minFilter = r.LinearMipMapLinearFilter, this.format = r.RGBAFormat, this.type = r.UnsignedByteType, this.useAnisotropic = !1, this.generateMipmaps = !0, this.needsUpdate = !1, this.refCount = 0, this.refCountDebug = []
        }, n.prototype.addRefCount = function() {
            this.refCount++
        }, n.prototype.subRefCount = function() {
            this.refCount--
        }
    }, {
        "../Constants": 14
    }],
    75: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._texture = e, this._requestUrl = e.sourcePath, this._callback = t, this.load()
        }
        var r = e("underscore");
        t.exports = n, n.prototype.load = function() {
            this._xhr || (this._xhr = new XMLHttpRequest, this._xhr.onreadystatechange = r.bind(this._onReady, this), this._xhr.open("GET", this._requestUrl, !0), this._xhr.responseType = "arraybuffer", this._xhr.send())
        }, n.prototype.abort = function() {
            this._xhr && (this._xhr.abort(), delete this._xhr), delete this._texture.request, delete this._texture
        }, n.prototype._onReady = function() {
            4 == this._xhr.readyState && (!this._xhr.response || 200 != this._xhr.status && 0 != this._xhr.status ? 0 != this._xhr.status && this._callback(new Error("Error " + this._xhr.status + " loading texture data at " + this._requestUrl)) : this._onDataReceived(this._xhr.response))
        }, n.prototype._onDataReceived = function(e) {
            this._callback(null, e), delete this._xhr, delete this._callback, delete this._texture
        }
    }, {
        underscore: 207
    }],
    76: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._renderEngine = e.renderEngine, this._glExtensionManager = this._renderEngine._webGL.glExtensionManager, this.loadedTextures = {}, this.atlas = {}, this.textureCache = [], this.atlasWithWork = [], this.textureUnloadPeriod = e.textureUnloadPeriod, this.textureCacheSize = e.textureCacheSize || 64, this.textureUnloadPeriod > 0 && (this.keysToUnload = [], this.lastUnloadDate = Date.now())
        }

        function r(e) {
            return -1 != e.indexOf("data:")
        }
        var o = e("underscore"),
            a = e("./Atlas"),
            s = e("./Texture"),
            l = e("./TextureDataRequest"),
            h = e("./CompressedTextureHandlers"),
            u = e("../utils/WebGLExtensionManager"),
            d = window.URL || window.webkitURL ? (window.URL || window.webkitURL).revokeObjectURL : null;
        t.exports = n, n.prototype.onDivRemoved = function() {
            o.each(this.atlas, function(e) {
                e.onDivRemoved()
            });
            var e = o.clone(this.loadedTextures);
            o.each(e, function(e) {
                this.unloadTexture(e)
            }, this), this.unloadOldTextures(), delete this.keysToUnload, delete this.loadedTextures, delete this.atlas, delete this.textureCache
        }, n.prototype.createTexture = function() {
            return this.textureCache.length > 0 ? this.textureCache.pop() : new s
        }, n.prototype.getTexture = function(e, t, i) {
            var n = this.loadedTextures[e];
            return null == n && (n = this.createTexture(), this.loadedTextures[e] = n, null != t && (n.wrap = t), n.sourcePath = e, n.serverName = i), n.addRefCount(), n
        }, n.prototype.abortLoadingTexture = function(e, t) {
            if (!e.loadedName || e.loadedName != e.sourcePath) {
                if (e.request && e.request.abort(), e.onServerHostReadyRequest && e.onServerHostReadyRequest.abort(), t && e.successCbkList) {
                    var i = e.successCbkList.indexOf(t);
                    i > -1 && (e.successCbkList.splice(i, 1), 0 == e.successCbkList.length && delete e.successCbkList)
                }
                e.aborted = !0, e.image.src = "", e.image.onload = null, e.image.onerror = null, e.image.onabort = null, this.revokeObjectUrlForTexture(e)
            }
        }, n.prototype.revokeObjectUrlForTexture = function(e) {
            e.objectUrl && (d(e.objectUrl), e.request && e.request.objectUrl && delete e.request.objectUrl, delete e.objectUrl)
        }, n.prototype.onTextureLoaded = function(e) {
            if (!e.aborted) {
                if (e.loadedName = e.sourcePath, e.image.onload = null, e.image.onerror = null, e.image.onabort = null, e.needsUpdate = !0, e.successCbkList) {
                    for (var t = e.successCbkList.pop(); t;) t(e), t = e.successCbkList.pop();
                    delete e.successCbkList
                }
                this.revokeObjectUrlForTexture(e)
            }
        }, n.prototype.handlePreloadedTexture = function(e, t) {
            t && (e.successCbkList || (e.successCbkList = []), e.successCbkList.push(t)), this.onTextureLoaded(e)
        }, n.prototype.handlePreloadedTextureNow = function(e) {
            if (!e.aborted) {
                e.loadedName = e.sourcePath, e.image.onload = null, e.needsUpdate = !0;
                var t = this._renderEngine._webGL;
                if (t.setTexture(e, 0), e.successCbkList) {
                    for (var i = e.successCbkList.pop(); i;) i(e), i = e.successCbkList.pop();
                    delete e.successCbkList
                }
            }
        }, n.prototype.askTextureToServer = function(e) {
            var t = this;
            e.aborted = !1, e.onError || (e.onError = function(t) {
                e.aborted || console.warn("Failed to ask texture %s to server: %s", e.sourcePath, t)
            }), e.loadedName != e.sourcePath ? (e.onSuccess && (e.successCbkList || (e.successCbkList = []), e.successCbkList.push(e.onSuccess)), e.onServerHostReadyRequest = this._renderEngine.onServerHostReady(e.serverName, function(i) {
                if (delete e.onServerHostReadyRequest, !e.aborted)
                    if (e.requestCallback) {
                        e.image.onload = null;
                        var n = {
                            onError: e.onError,
                            onSuccess: function(i) {
                                !e.request || e.aborted || e.request.aborted || (e.objectUrl = i, e.request.objectUrl && delete e.request.objectUrl, e.image.onload = o.bind(t.onTextureLoaded, t, e), e.image.src = i)
                            },
                            texture: e,
                            serverHost: i
                        };
                        e.request = e.requestCallback(e.sourcePath, n)
                    } else if (e.compressionHandler) e.request = new l(e, function(i, n) {
                    delete e.request, i ? e.onError() : e.compressionHandler.setData(n, e, function() {
                        t.onTextureLoaded(e)
                    })
                });
                else {
                    var a = i + e.sourcePath;
                    e.image.crossOrigin = r(a) ? null : "anonymous", e.image.onerror = function() {
                        e.aborted || e.onError()
                    }, e.image.onload = function() {
                        e.aborted || t.onTextureLoaded(e)
                    }, e.image.src = a
                }
            })) : e.onSuccess && !e.aborted && e.onSuccess(e)
        }, n.prototype.askTextureToServerWithImage = function(e, t) {
            function i() {
                n.onTextureLoaded(e)
            }
            var n = this;
            e.aborted = !1, e.onError || (e.onError = function(t) {
                e.aborted || console.warn("failed askTextureToServer", e.sourcePath, t)
            }), e.loadedName != e.sourcePath ? (e.onSuccess && (e.successCbkList || (e.successCbkList = []), e.successCbkList.push(e.onSuccess)), e.image.crossOrigin = r(t) ? null : "anonymous", e.image.onerror = function() {
                e.aborted || e.onError()
            }, e.image.onload = function() {
                e.aborted || i()
            }, e.image.src = t) : e.onSuccess && !e.aborted && e.onSuccess(e)
        }, n.prototype.loadCompressedTexture = function(e, t, i) {
            if ("s3tc" == t) {
                if (!this._glExtensionManager.isAvailable(u.compressed_texture_s3tc)) throw new Error("s3 compressed textures are not supported on this platform")
            } else if ("zip" != t) throw new Error("Unsupported compressed texture format: " + t);
            return i = i || {}, i.compressionHandler = h.createHandler(t), this.loadTexture(e, i)
        }, n.prototype.loadTexture = function(e, t) {
            t = t || {};
            var i = this.getTexture(e, t.repeat, t.serverName);
            return i.onSuccess = t.onSuccess, i.onError = t.onError, i.requestCallback = t.requestCallback, i.compressionHandler = t.compressionHandler, this.askTextureToServer(i), i
        }, n.prototype.releaseTexture = function(e) {
            e.loadedName && e.loadedName == e.sourcePath || this.abortLoadingTexture(e), e.subRefCount(), e.onServerHostReadyRequest && e.onServerHostReadyRequest.abort(), delete e.onServerHostReadyRequest, delete e.onSuccess, delete e.onError, delete e.requestCallback, 0 == e.refCount && (e.sourcePath ? 0 == this.textureUnloadPeriod ? this.unloadTexture(e) : this.keysToUnload.push(e.sourcePath) : this.deallocateTexture(e))
        }, n.prototype.unloadTexture = function(e) {
            e.sourcePath && delete this.loadedTextures[e.sourcePath], this.deallocateTexture(e), this.textureCache.length < this.textureCacheSize && this.textureCache.push(e)
        }, n.prototype.deallocateTexture = function(e) {
            this._renderEngine._webGL.deallocateTexture(e), e.reset()
        }, n.prototype.unloadOldTextures = function() {
            for (; this.keysToUnload.length;) {
                var e = this.keysToUnload.pop(),
                    t = this.loadedTextures[e];
                t && 0 == t.refCount && this.unloadTexture(t)
            }
        }, n.prototype.manageAtlasAndCache = function(e) {
            for (; this.atlasWithWork.length;) this.atlasWithWork.pop().packWaitingTex();
            0 < this.textureUnloadPeriod && e - this.lastUnloadDate > this.textureUnloadPeriod && (this.unloadOldTextures(), this.lastUnloadDate = e)
        }, n.prototype.createAtlas = function(e, t, i) {
            var n = this.atlas[e];
            return null == n && (n = new a(this._renderEngine, this, e, t, i), this.atlas[e] = n), n.getTexture()
        }, n.prototype.packAndGetIndexFromAtlas = function(e, t, i) {
            var n;
            return null == this.atlas[e] ? console.error("trying to pack to unknown atlas", e) : t && (n = this.atlas[e].getTextureIndex(t, i)), n
        }
    }, {
        "../utils/WebGLExtensionManager": 84,
        "./Atlas": 72,
        "./CompressedTextureHandlers": 73,
        "./Texture": 74,
        "./TextureDataRequest": 75,
        underscore: 207
    }],
    77: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._renderEngine = e, this._parentNode = new a, this._createMatrixQuad(), this._textureViews = {}, this._renderFunc = r.bind(this.render, this), this._renderEngine.on("postRender", this._renderFunc), this._onResizeCbk = r.bind(this.resize, this), this._renderEngine.on("onResize", this._onResizeCbk), this._onDivRemovedCbk = r.bind(this.onDivRemoved, this), this._renderEngine.on("onDivRemoved", this._onDivRemovedCbk)
        }
        var r = e("underscore"),
            o = e("../Constants"),
            a = e("../object/Object3D"),
            s = e("../utils/TriangulationUtils"),
            l = e("../camera/OrthographicCamera");
        t.exports = n, n.prototype._createMatrixQuad = function() {
            var e = this._renderEngine._webGL.getViewSize();
            this._camera = new l(0, e.width, e.height, 0, -1, 100), this._camera.position.set(0, 0, 10), this._camera.updateMatrix()
        }, n.prototype.addTexture = function(e, t, i, n) {
            n = r.defaults(n || {}, {
                materialName: "nolight_texture",
                textureUniformName: "tex0"
            });
            var a = this._renderEngine.createMaterial(n.materialName, o.NormalBlending);
            a.depthTest = !1, a.depthWrite = !1;
            var l = this._textureViews[e];
            if (l) this._renderEngine.releaseMaterial(l.material), delete l.material, l.rect = i, l.materialConfig = n, l.material = a, l.mesh.material = a;
            else {
                var h = s.createUnitPlane();
                n.uvArrayQuad && (h._uvArray = n.uvArrayQuad);
                var u = this._renderEngine.createMesh(h, a);
                l = {
                    texture: t,
                    rect: i,
                    materialConfig: n,
                    material: a,
                    geometry: h,
                    mesh: u
                }, this._textureViews[e] = l, this._parentNode.add(l.mesh)
            }
            return l.material.uniforms[l.materialConfig.textureUniformName].texture = t, l.mesh.position.set(i.x + .5 * i.width, i.y + .5 * i.height, 0), l.mesh.scale.set(i.width, i.height, 1), l.mesh.updateMatrix(), this._renderEngine._webGL.updateObject(l.mesh), l
        }, n.prototype.removeTexture = function(e) {
            var t = this._textureViews[e];
            t && (this._renderEngine.releaseMaterial(t.material), this._renderEngine.releaseObject(t.mesh), this._parentNode.remove(t.mesh), delete this._textureViews[e])
        }, n.prototype.render = function() {
            this._renderEngine._webGL.setCamera(this._camera), this._renderEngine._webGL.renderObjects(this._parentNode.children)
        }, n.prototype.onDivRemoved = function() {
            for (var e = r.keys(this._textureViews), t = 0; t < e.length; t++) this.removeTexture(e[t]);
            this._renderEngine.removeListener("onResize", this._onResizeCbk), this._renderEngine.removeListener("onDivRemoved", this._onDivRemovedCbk), this._renderEngine.removeListener("postRender", this._renderFunc), delete this._renderEngine
        }, n.prototype.resize = function() {
            var e = this._renderEngine._webGL.getViewSize();
            this._camera.right = e.width, this._camera.top = e.height, this._camera.updateMatrix()
        }
    }, {
        "../Constants": 14,
        "../camera/OrthographicCamera": 29,
        "../object/Object3D": 70,
        "../utils/TriangulationUtils": 82,
        underscore: 207
    }],
    78: [function(e, t, i) {
        "use strict";

        function n(e) {
            return (Math.exp(e) + Math.exp(-e)) / 2
        }

        function r(e, t, i) {
            return e + (t - e) * i
        }

        function o(e, t, i) {
            return Math.max(0, Math.min(1, (i - e) / (t - e)))
        }

        function a(e, t, i) {
            return Math.min(i, Math.max(e, t))
        }

        function s(e) {
            return e * Math.PI / 180
        }

        function l(e) {
            return 180 * e / Math.PI
        }

        function h(e) {
            return e ? u[e.toUpperCase()] || parseFloat(e) : NaN
        }
        t.exports = {
            cosh: n,
            lerp: r,
            linearStep: o,
            clamp: a,
            degToRad: s,
            radToDeg: l,
            angleFromNorthInDegree: h
        };
        var u = {
            N: 0,
            NORTH: 0,
            NNE: 22.5,
            NE: 45,
            ENE: 67.5,
            E: 90,
            EAST: 90,
            ESE: 112.5,
            SE: 135,
            SSE: 157.5,
            S: 180,
            SOUTH: 180,
            SSW: 202.5,
            SW: 225,
            WSW: 247.5,
            W: 270,
            WEST: 270,
            WN: 292.5,
            NW: 337.5
        }
    }, {}],
    79: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.origin = e || new a, this.direction = t || new a
        }

        function r(e, t, i) {
            return b.sub(i, e), h = b.dot(t), u = x.add(e, w.copy(t).multiplyScalar(h)), d = i.distanceTo(u)
        }

        function o(e, t, i, n) {
            return b.sub(n, t), x.sub(i, t), w.sub(e, t), c = b.dot(b), f = b.dot(x), p = b.dot(w), m = x.dot(x), g = x.dot(w), _ = 1 / (c * m - f * f), v = (m * p - f * g) * _, y = (c * g - f * p) * _, v >= 0 && y >= 0 && 1 > v + y
        }
        var a = e("../math/Vector3"),
            s = e("../math/Matrix4"),
            l = e("../Constants");
        t.exports = n, n.prototype.intersectAllChildren = function(e) {
            var t = [];
            return this.intersectRecursive(e, t), t.sort(function(e, t) {
                return e.distance == t.distance ? e.object.geometry.boundingRadius - t.object.geometry.boundingRadius : e.distance - t.distance
            }), t
        }, n.prototype.intersectRecursive = function(e, t) {
            this.intersectObject(e, t);
            for (var i = 0; i < e.children.length; i++) this.intersectRecursive(e.children[i], t)
        }, n.prototype.intersectObject = function(e, t) {
            var i = e.geometry;
            if (i && !e.ignoreRayCast && e.visible) {
                if (0 == i.boundingRadius || i.primitiveType != l.TRIANGLES || !i._positionArray) return;
                var n, h = new a,
                    u = new a,
                    d = new s,
                    c = e.matrixWorld,
                    f = r(this.origin, this.direction, c.getPosition()),
                    p = new a(c.getColumnX().length(), c.getColumnY().length(), c.getColumnZ().length());
                if (f > e.geometry.boundingRadius * Math.max(p.x, p.y, p.z)) return;
                d.extractRotation(c);
                for (var m, g, _ = new a, v = new a, y = new a, b = a.zUnit.clone(), x = new a, w = i._positionArray, M = i._normalArray, T = i._indexArray, S = T ? T.length : w.length / 3, C = 0; S > C;) {
                    var E, k, L;
                    T ? (E = 3 * T[C], k = 3 * T[C + 1], L = 3 * T[C + 2]) : (E = 3 * C, k = E + 3, L = E + 6), M && b.set(M[E], M[E + 1], M[E + 2]), b = d.multiplyVector3(b), m = this.direction.dot(b), Math.abs(m) > 1e-4 && (_.set(w[E], w[E + 1], w[E + 2]), x = c.multiplyVector3(_.clone()).subSelf(this.origin), g = b.dot(x) / m, g > 0 && (e.doubleSided || 0 > m) && (h.copy(this.direction), u.add(this.origin, h.multiplyScalar(g)), v.set(w[k], w[k + 1], w[k + 2]), y.set(w[L], w[L + 1], w[L + 2]), c.multiplyVector3(_), c.multiplyVector3(v), c.multiplyVector3(y), o(u, _, v, y) && (n = {
                        distance: this.origin.distanceTo(u),
                        point: u.clone().subSelf(b.multiplyScalar(.01)),
                        object: e
                    }, t.push(n)))), C += 3
                }
            }
        };
        var h, u, d, c, f, p, m, g, _, v, y, b = new a,
            x = new a,
            w = new a
    }, {
        "../Constants": 14,
        "../math/Matrix4": 60,
        "../math/Vector3": 63
    }],
    80: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n, r = [],
                o = [],
                a = [],
                s = {
                    round: 6,
                    round_hipped: 6
                };
            if ("mansard" == i || "gambrel" == i || "round" == i || "round_hipped" == i) {
                var l = s[i] || 2,
                    h = .5 * Math.PI / l;
                for (n = 1; l > n; ++n) {
                    var u = h * n;
                    a.push(Math.sin(u)), o.push(1 - Math.cos(u))
                }
            } else "saltbox" == i || "double_saltbox" == i || "triple_saltbox" == i || "quadruple_saltbox" == i ? (a.push(.99), o.push(.5)) : (a.push(.5), o = a);
            for (n = 0; n < o.length; ++n) {
                var d = o[n];
                I.x = R.lerp(e.x, t.x, d), I.y = R.lerp(e.y, t.y, d);
                var c = a[n];
                I.z = R.lerp(e.z, t.z, c);
                var f = I.clone();
                f.pos01 = d, r.push(f)
            }
            return r
        }

        function r(e, t) {
            var i = new P(t.xMin, t.yMax),
                n = new P(t.xMax, t.yMax),
                r = new P(t.xMax, t.yMin),
                o = new P(t.xMin, t.yMin),
                a = [i, n, r, o];
            if (_(a, e)) return !0;
            if (_(e, a)) return !0;
            var l = [];
            return s(e, i, o, l), l.length ? !0 : (s(e, o, r, l), l.length ? !0 : (s(e, r, n, l), l.length ? !0 : (s(e, n, i, l), l.length ? !0 : !1)))
        }

        function o(e, t, i) {
            if (x([e], t)) return !0;
            for (var n = e.length, r = function(e, t) {
                    return Math.pow(e.x - t.x, 2) + Math.pow(e.y - t.y, 2)
                }, o = i * i, a = 0; n > a; ++a) {
                var s = e[a];
                if (0 == a && s.distanceToSquared(t) < o) return !0;
                var l = e[a + 1];
                if (a == n - 1 && (l = e[0]), l.distanceToSquared(t) < o) return !0;
                var h = r(s, l),
                    u = l.x - s.x,
                    d = l.y - s.y,
                    c = t.x - s.x,
                    f = t.y - s.y,
                    p = (c * u + f * d) / h;
                if (h = r(t, {
                        x: s.x + p * u,
                        y: s.y + p * d
                    }), o > h) return !0
            }
            return !1
        }

        function a(e, t, i) {
            var n = [];
            s(e.shapePts, t, i, n);
            for (var r = 0; r < e.shapeHolePts.length; ++r) {
                var o = e.shapeHolePts[r];
                s(o, t, i, n)
            }
            return n
        }

        function s(e, t, i, n) {
            for (var r = e.length, o = 0; r > o; ++o) {
                var a = e[o],
                    s = o == r - 1 ? e[0] : e[o + 1],
                    l = D.findInnerIntersection(t, i, a, s);
                l && n.push({
                    point: l,
                    edge: [a, s]
                })
            }
        }

        function l(e) {
            e.length > 2 && P.equals(e[0], e[e.length - 1]) && e.pop()
        }

        function h(e, t) {
            if (l(e), null == t || t > 0) {
                t = t || .1;
                for (var i = e[0], n = 1; n < e.length;) {
                    var r = e[n];
                    i.distanceTo(r) < t ? (i.addSelf(r), i.multiplyScalar(.5), e.splice(n, 1)) : (i = r, n++)
                }
            }
        }

        function u(e) {
            return e.length >= 2 && P.equals(e[0], e[e.length - 1])
        }

        function d(e) {
            for (var t = e.length, i = 0, n = t - 1, r = 0; t > r; n = r++) i += e[n].x * e[r].y - e[n].y * e[r].x;
            return i > 0
        }

        function c(e, t, i) {
            var n = [],
                r = new P,
                o = new P,
                a = function(e, t) {
                    var a = Math.min(e.y, t.y),
                        s = Math.max(e.y, t.y);
                    if (i.y < s && i.y > a && (e.x > i.x || t.x > i.x)) {
                        o.set(t.x - e.x, t.y - e.y);
                        var l = e.x + (i.y - e.y) * o.x / o.y;
                        r.set(l - e.x, i.y - e.y), l > i.x && r.length() < o.length() && r.dot(o) > 0 && n.push(new A(l, i.y, 0))
                    }
                },
                s = function(e, t) {
                    var a = Math.min(e.x, t.x),
                        s = Math.max(e.x, t.x);
                    if (i.x < s && i.x > a && (e.y > i.y || t.y > i.y)) {
                        o.set(t.x - e.x, t.y - e.y);
                        var l = e.y + (i.x - e.x) * o.y / o.x;
                        r.set(i.x - e.x, l - e.y), l > i.y && r.length() < o.length() && r.dot(o) > 0 && n.push(new A(i.x, l, 0))
                    }
                },
                l = "x" == e ? a : s,
                h = function(e) {
                    for (var t = 0; t < e.length; ++t) {
                        var i = e[t],
                            n = null;
                        n = t == e.length - 1 ? e[0] : e[t + 1], l(i, n)
                    }
                };
            h(t.shapePts);
            for (var u = 0; u < t.shapeHolePts.length; ++u) h(t.shapeHolePts[u]);
            return n.sort(function(t, i) {
                return t[e] - i[e]
            }), n.length % 2 != 0 && console.warn("odd intersection count found !"), n
        }

        function f(e, t, i, n, r) {
            function o() {
                return R.lerp(u, d, Math.random())
            }

            function a() {
                return R.lerp(f, p, Math.random())
            }
            for (var s = i.startX, l = i.startY, h = i.endY, u = i.xSamplingMin, d = i.xSamplingMax, f = i.ySamplingMin, p = i.ySamplingMax, m = 0; m < e.length; ++m)
                for (var g = e[m], _ = l + f * Math.random(); h > _;) {
                    for (var v = new P(s, _), y = c("x", g, v); y.length > 1;) {
                        var b = y.pop(),
                            x = y.pop(),
                            w = b.x - x.x,
                            M = 0,
                            T = x.clone(),
                            S = r ? 0 : u * Math.random();
                        for (T.x += S, M += S; w > M;) n(T.x + t.x, T.y + t.y), S = o(), T.x += S, M += S
                    }
                    _ += a()
                }
        }

        function p(e, t, i) {
            for (var n = t.x, r = t.y, o = t.sampling, a = t.addEndPoints, s = e.length, l = new P, h = 0; s > h; ++h)
                if (a && i(n + e[h].x, r + e[h].y), s - 1 > h) {
                    l.set(e[h + 1].x - e[h].x, e[h + 1].y - e[h].y);
                    var u = l.length();
                    l.normalize();
                    for (var d = Math.floor(u / o), c = u / d, f = 1; d > f; ++f) i(n + e[h].x + l.x * f * c, r + e[h].y + l.y * f * c)
                }
        }

        function m(e, t, i, n) {
            for (var r = e.length, o = new P, a = 0; r > a; ++a)
                if (n(t.x + e[a].x, t.y + e[a].y), r - 1 > a) {
                    o.set(e[a + 1].x - e[a].x, e[a + 1].y - e[a].y);
                    var s = o.length();
                    o.normalize();
                    for (var l = t.x + e[a].x, h = t.y + e[a].y, u = s / i, d = 1; i >= d; ++d) n(l + o.x * d * u, h + o.y * d * u)
                }
        }

        function g(e, t, i, n, r) {
            for (var o = 0; o < e.length; ++o) {
                var a = {
                    x: t,
                    y: i,
                    sampling: n,
                    addEndPoints: !0
                };
                p(e[o].shapePts, a, r)
            }
        }

        function _(e, t) {
            for (var i = new P, n = new P, r = 0; r < t.length; ++r) {
                for (var o = t[r], a = 0, s = 0; s < e.length; ++s) {
                    var l = e[s],
                        h = null;
                    h = s == e.length - 1 ? e[0] : e[s + 1];
                    var u = Math.min(l.y, h.y),
                        d = Math.max(l.y, h.y);
                    if (o.y < d && o.y > u && (l.x > o.x || h.x > o.x)) {
                        n.set(h.x - l.x, h.y - l.y);
                        var c = l.x + (o.y - l.y) * n.x / n.y;
                        i.set(c - l.x, o.y - l.y), c > o.x && i.length() < n.length() && i.dot(n) > 0 && a++
                    }
                }
                if (1 == a % 2) return !0
            }
            return !1
        }

        function v(e, t) {
            for (var i = e.length - 1, n = !1, r = t.x, o = t.y, a = 0; a < e.length; a++) {
                var s = e[a],
                    l = e[i];
                s.equals(l) || (s.y < o && l.y >= o || l.y < o && s.y >= o) && (s.x <= r || l.x <= r) && (n ^= s.x + (o - s.y) / (l.y - s.y) * (l.x - s.x) < r), i = a
            }
            return 1 == n
        }

        function y(e, t) {
            for (var i = !1, n = 0; n < e.length && !i; n++)
                if (i = v(t.shapePts, e[n])) {
                    for (var r = !1, o = 0; o < t.shapeHolePts.length && !r; o++) r = v(t.shapeHolePts[o], e[n]);
                    i = !r
                }
            return i
        }

        function b(e, t) {
            var i = v(t.shapePts, e);
            if (i) {
                for (var n = !1, r = 0; r < t.shapeHolePts.length && !n; r++) n = v(t.shapeHolePts[r], e);
                i = !n
            }
            return i
        }

        function x(e, t) {
            for (var i = 0, n = new P, r = new P, o = 0; o < e.length; ++o) {
                for (var a = e[o], s = 0; s < a.length; ++s) {
                    var l = a[s],
                        h = null;
                    h = s == a.length - 1 ? a[0] : a[s + 1];
                    var u = Math.min(l.y, h.y),
                        d = Math.max(l.y, h.y);
                    if (t.y < d && t.y > u && (l.x > t.x || h.x > t.x)) {
                        r.set(h.x - l.x, h.y - l.y);
                        var c = l.x + (t.y - l.y) * r.x / r.y;
                        n.set(c - l.x, t.y - l.y), c > t.x && n.length() < r.length() && n.dot(r) > 0 && i++
                    }
                }
                if (1 == i % 2) return !0
            }
            return !1
        }

        function w(e) {
            for (var t = e.concat(), i = new P, n = new P, r = 0; r < t.length;) {
                0 == r ? i.sub(t[t.length - 1], t[r]).normalize() : i.sub(t[r - 1], t[r]).normalize(), r + 1 != t.length ? n.sub(t[r + 1], t[r]).normalize() : n.sub(t[0], t[r]).normalize();
                var o = i.x * n.y - i.y * n.x;
                0 > o ? (t.splice(r, 1), r = Math.max(r - 1, 0)) : ++r
            }
            return h(t, 0), t
        }

        function M(e) {
            var t, i, n = w(e),
                r = new P(1 / 0, 0),
                o = new P(-(1 / 0), 0),
                a = new P(0, 1 / 0),
                s = new P(0, -(1 / 0));
            for (t = 0; t < n.length; ++t) i = n[t], i.index = t, i.x < r.x && (r.copy(i), r.index = t), i.x > o.x && (o.copy(i), o.index = t), i.y < a.y && (a.copy(i), a.index = t), i.y > s.y && (s.copy(i), s.index = t);
            var l = new P(0, 1),
                h = new P(1, 0),
                u = new P,
                d = new P,
                c = [new P(r.x, a.y), new P(r.x, s.y), new P(o.x, s.y), new P(o.x, a.y)];
            u.sub(c[1], c[0]), d.sub(c[2], c[1]), c.area = u.length() * d.length();
            for (var f = n.length - 1, p = [{
                    idx: r.index,
                    nextIdx: r.index == f ? 0 : r.index + 1,
                    d: 0,
                    edge: new P,
                    dir: l
                }, {
                    idx: s.index,
                    nextIdx: s.index == f ? 0 : s.index + 1,
                    d: 0,
                    edge: new P,
                    dir: h
                }, {
                    idx: o.index,
                    nextIdx: o.index == f ? 0 : o.index + 1,
                    d: 0,
                    edge: new P,
                    dir: l,
                    reverse: !0
                }, {
                    idx: a.index,
                    nextIdx: a.index == f ? 0 : a.index + 1,
                    d: 0,
                    edge: new P,
                    dir: h,
                    reverse: !0
                }], m = 0; m < n.length; m++) {
                var g = 0,
                    _ = 0;
                for (t = 0; 4 > t; ++t) {
                    p[t].edge.sub(n[p[t].nextIdx], n[p[t].idx]).normalize();
                    var v = p[t].reverse ? -1 : 1;
                    p[t].d = v * p[t].edge.dot(p[t].dir), p[t].d > g && (g = p[t].d, _ = t)
                }
                var y = p[_].edge.clone();
                p[_].reverse && y.negate(), p[_].dir.copy(y), _ % 2 == 0 ? (p[_ + 1].dir.set(-y.y, y.x), p[_ + 1].dir.x < 0 && p[_ + 1].dir.negate()) : (p[_ - 1].dir.set(y.y, -y.x), p[_ - 1].dir.y < 0 && p[_ - 1].dir.negate());
                var b = !0,
                    x = [];
                if (i = D.findIntersection(n[p[0].idx], p[0].dir, n[p[1].idx], p[1].dir), b = null != i, x.push(i), b && (i = D.findIntersection(n[p[1].idx], p[1].dir, n[p[2].idx], p[2].dir), b = null != i, x.push(i), b && (i = D.findIntersection(n[p[2].idx], p[2].dir, n[p[3].idx], p[3].dir), b = null != i, x.push(i), b && (i = D.findIntersection(n[p[3].idx], p[3].dir, n[p[0].idx], p[0].dir), b = null != i, x.push(i), b && (u.sub(x[1], x[0]), d.sub(x[2], x[1]), x.area = u.length() * d.length(), (!c || x.area < c.area) && (c = x))))), p[_].idx = p[_].nextIdx, p[_].nextIdx = p[_].idx == f ? 0 : p[_].idx + 1, l.y <= 0 || h.x <= 0) break
            }
            c.center = new P(c[0].x + c[2].x, c[0].y + c[2].y).multiplyScalar(.5);
            var M = new P(c[1].x - c[0].x, c[1].y - c[0].y),
                T = new P(c[2].x - c[1].x, c[2].y - c[1].y);
            return T.lengthSq() < M.lengthSq() ? (c.smallEdge = T, c.longEdge = M) : (c.smallEdge = M, c.longEdge = T), c
        }

        function T(e, t) {
            for (var i = 0; i < e.length; ++i) e[i].z = t
        }

        function S(e, t) {
            T(e.shapePts, t);
            for (var i = 0; i < e.shapeHolePts.length; ++i) T(e.shapeHolePts[i], t)
        }

        function C(e, t, i) {
            var n = .5 * t,
                r = .5 * t;
            return E(e, n, r, i)
        }

        function E(e, t, i, n) {
            l(e);
            for (var r, o, a = e.length, s = new A, h = new A, u = [], d = [], c = 0; a - 1 > c; ++c) r = e[c], o = e[c + 1], s.set(r.y - o.y, o.x - r.x, 0), h.copy(s), s.setLength(t), u.push(r.clone().addSelf(s)), u.push(o.clone().addSelf(s)), h.setLength(i), d.push(r.clone().subSelf(h)), d.push(o.clone().subSelf(h));
            n && (r = e[a - 1], o = e[0], s.set(r.y - o.y, o.x - r.x, 0), h.copy(s), s.setLength(t), u.push(r.clone().addSelf(s)), u.push(o.clone().addSelf(s)), h.setLength(i), d.push(r.clone().subSelf(h)),
                d.push(o.clone().subSelf(h)));
            for (var f, p, m, g, _, v, y, b, x, w = 0; w < u.length - 3; w += 2) f = u[w], p = u[w + 1], m = u[w + 2], g = u[w + 3], x = D.findInnerIntersection(f, p, m, g), null != x && (p.copy(x), m.copy(x)), _ = d[w], v = d[w + 1], y = d[w + 2], b = d[w + 3], x = D.findInnerIntersection(_, v, y, b), null != x && (v.copy(x), y.copy(x));
            return n && (f = u[0], p = u[1], m = u[u.length - 2], g = u[u.length - 1], x = D.findInnerIntersection(f, p, m, g), null != x && (f.copy(x), g.copy(x)), _ = d[0], v = d[1], y = d[d.length - 2], b = d[d.length - 1], x = D.findInnerIntersection(_, v, y, b), null != x && (_.copy(x), b.copy(x))), {
                rightPts: u,
                leftPts: d
            }
        }

        function k(e, t) {
            var i = {
                    shapePts: null,
                    shapeHolePts: []
                },
                n = e.shapePts,
                r = e.shapeHolePts,
                o = L(n, t);
            i.shapePts = o;
            for (var a = 0; a < r.length; a++) {
                var s = r[a],
                    l = L(s, -t);
                l.length > 2 && i.shapeHolePts.push(l)
            }
            return i
        }

        function L(e, t) {
            var i, n, r = 0,
                o = 0,
                a = [];
            for (i = 0; i < e.length; i++) n = e[i], null == n.x ? (r += n[0], o += n[1]) : (r += n.x, o += n.y);
            for (r /= e.length, o /= e.length, i = 0; i < e.length; i++) {
                n = e[i];
                var s, l;
                null == n.x ? (s = n[0] - r, l = n[1] - o) : (s = n.x - r, l = n.y - o);
                var h = Math.sqrt(s * s + l * l);
                if (t > 0 || h + t > 0) {
                    s = s / h * t, l = l / h * t;
                    var u;
                    null == n.x ? u = [n[0] + s, n[1] + l] : (u = n.clone(), u.x = n.x + s, u.y = n.y + l), a.push(u)
                }
            }
            return a
        }
        var P = e("../math/Vector2"),
            A = e("../math/Vector3"),
            R = e("./MathHelper"),
            D = e("./VectorUtils"),
            I = new A;
        t.exports = {
            buildBendedEdge: n,
            isBoundsCloseToPointsList: r,
            isPointCloseToPointsList: o,
            intersectRingWithSegment: a,
            intersectPointsListWithSegment: s,
            checkStartEnd: l,
            simplifyPointsList: h,
            isClosed: u,
            isClockWise: d,
            intersectShapeAlong: c,
            sampleShape: f,
            sampleLine: p,
            sampleFixedLine: m,
            sampleRings: g,
            isPointInPolygon: v,
            isPolygonIntersectingRing: y,
            isPointInRing: b,
            isPointInsideShape: x,
            buildConvexHull: w,
            getMinimalOBox: M,
            setPtsListHeight: T,
            setRingHeight: S,
            offsetPointsList: C,
            offsetInnerOuterWidthPositionPointsList: E,
            expandRing: k,
            expandShape: L
        }
    }, {
        "../math/Vector2": 62,
        "../math/Vector3": 63,
        "./MathHelper": 78,
        "./VectorUtils": 83
    }],
    81: [function(e, t, i) {
        "use strict";

        function n(e) {
            for (var t = new f(e), i = 0; e > i; ++i) t.addBone(new p(i, -1, new u));
            return t.updateHierarchy(), t
        }

        function r(e, t, i) {
            for (var n = new d, r = new u, o = new c(0), a = new h, s = new h, l = 0, f = 0; f < e.length; ++f) {
                var p = e[f];
                if (f < e.length - 1) {
                    var m = e[f + 1];
                    a.sub(m, p)
                }
                var g = l / t;
                if (i && 0 != f) {
                    var _ = new c(g - 1);
                    r.setPosition(p), _.addMatrix(r.clone()), n.addKey(_)
                }
                if (o = new c(g), l += a.length(), f < e.length - 1) {
                    a.normalize();
                    var v = a.y > 0 ? 1 : -1;
                    s.z = Math.acos(a.x) * v - Math.PI / 2
                }
                r.setRotation(s), r.setPosition(p), o.addMatrix(r.clone()), n.addKey(o)
            }
            return n
        }

        function o() {
            return new m
        }

        function a(e) {
            for (var t = new f(e.animationData.length), i = 0; i < e.animationData.length; i++) t.addBone(new p(i, -1, new u));
            return t.updateHierarchy(), t.setAnimations([e]), t.playAnimation(0), t.computeAnim(0), t
        }

        function s(e, t) {
            var i, n, r = e.bones.length,
                o = new f(r * t);
            for (i = 0; t > i; i++) {
                var a = e.clone();
                for (n = 0; n < a.bones.length; n++) a.bones[n].index += i * r, -1 != a.bones[n].parentIndex && (a.bones[n].parentIndex += i * r), o.addBone(a.bones[n])
            }
            return o.updateHierarchy(), o
        }

        function l(e, t, i, n, r) {
            for (var o = e.animations[t], a = 0; a < e.bones.length; a++) {
                var s = e.bones[a];
                if (s.index >= i && s.index <= n && -1 == s.parentIndex)
                    for (var l = 0; l < o.keys.length; l++) {
                        var h = o.keys[l],
                            u = h.matrixList[s.index];
                        u.multiply(r, u)
                    }
            }
        }
        var h = e("../math/Vector3"),
            u = e("../math/Matrix4"),
            d = e("../animation/Animation"),
            c = e("../animation/AnimationKey"),
            f = e("../animation/Skeleton"),
            p = e("../animation/Bone"),
            m = e("../animation/MultiAnimation");
        t.exports = {
            createSkeleton: n,
            pivotAnimationFromPointsListAndSpeed: r,
            createMultiAnimation: o,
            createSkeletonForMultiAnimation: a,
            createSkeletonForPackedAnimatedMesh: s,
            transformSkeletonAnimation: l
        }
    }, {
        "../animation/Animation": 23,
        "../animation/AnimationKey": 24,
        "../animation/Bone": 25,
        "../animation/MultiAnimation": 26,
        "../animation/Skeleton": 27,
        "../math/Matrix4": 60,
        "../math/Vector3": 63
    }],
    82: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            for (var i = new F.SweepContext(t ? e.shapePts.concat() : e.shapePts), n = 0; n < e.shapeHolePts.length; ++n) i.addHole(t ? e.shapeHolePts[n].concat() : e.shapeHolePts[n]);
            e.innerPoints && i.addPoints(e.innerPoints);
            try {
                return F.sweep.Triangulate(i), i.GetTriangles()
            } catch (r) {
                return null
            }
        }

        function r(e) {
            var t, i, n = [],
                r = 0;
            for (t = 0; t < e.length; t++) i = e[t], n[r++] = i.x, n[r++] = i.y;
            return n
        }

        function o(e) {
            var t = r(e.shapePts);
            return z(t)
        }

        function a(e, t, i, n) {
            for (var r = n.height, a = n.color, s = n.flipSided, l = e._positionArray, h = e._normalArray, u = e._indexArray, d = {
                    indexOffset: l.length / 3,
                    normalSmoothing: n.normalSmoothing
                }, c = o(t), f = 0; f < c.length; f += 3) {
                var p = c[f],
                    m = s ? c[f + 2] : c[f + 1],
                    g = s ? c[f + 1] : c[f + 2],
                    _ = i[p],
                    v = i[m],
                    y = i[g];
                null == _.position.z && (_.position.z = r), null == v.position.z && (v.position.z = r), null == y.position.z && (y.position.z = r);
                var b = null;
                h && (b = H.computeNormal(_.position, v.position, y.position)), A(i, u, p, b, d), A(i, u, m, b, d), A(i, u, g, b, d)
            }
            R(e, i, a, !1)
        }

        function s(e, t, i, r) {
            var o, a, s = r.copyArrays,
                l = r.height,
                h = r.color,
                u = r.flipSided,
                d = n(t, s),
                c = null != d ? d.length : 0,
                f = 0 == c;
            for (a = 0; c > a && !f; ++a) {
                o = d[a];
                for (var p = 0; 3 > p && !f; p++) {
                    var m = o.points_[p];
                    f = null == m.index
                }
            }
            if (f) return !1;
            var g = e._positionArray,
                _ = e._normalArray,
                v = e._indexArray,
                y = {
                    indexOffset: g.length / 3,
                    normalSmoothing: r.normalSmoothing
                };
            for (a = 0; c > a; ++a) {
                o = d[a];
                var b = o.points_[0],
                    x = u ? o.points_[2] : o.points_[1],
                    w = u ? o.points_[1] : o.points_[2];
                null == b.z && (b.z = l), null == x.z && (x.z = l), null == w.z && (w.z = l);
                var M = null;
                _ && (M = H.computeNormal(b, x, w)), A(i, v, b.index, M, y), A(i, v, x.index, M, y), A(i, v, w.index, M, y)
            }
            return R(e, i, h, !1), !0
        }

        function l(e, t, i) {
            for (var r = i.copyArrays, o = i.height, a = i.color, s = i.flipSided, l = i.normalSmoothing, h = n(t, r), u = h.length, d = e._positionArray, c = e._normalArray, f = e._colorArray, p = d.length, m = 0; u > m; ++m) {
                var g = h[m],
                    _ = g.points_[0],
                    v = s ? g.points_[2] : g.points_[1],
                    y = s ? g.points_[1] : g.points_[2];
                if (null == _.z && (_.z = o), null == v.z && (v.z = o), null == y.z && (y.z = o), d.push(_.x, _.y, _.z, v.x, v.y, v.z, y.x, y.y, y.z), c) {
                    var b = H.computeNormal(_, v, y);
                    c.push(b.x, b.y, b.z, b.x, b.y, b.z, b.x, b.y, b.z)
                }
                a && f.push(a.r, a.g, a.b, a.a, a.r, a.g, a.b, a.a, a.r, a.g, a.b, a.a)
            }
            l && P(p, d, c)
        }

        function h(e, t, i) {
            var n = i.slowerButMoreAcurate,
                r = O.maxIndexCount / 3,
                o = null != e._indexArray;
            if (o) {
                var h = 0;
                D.each(t.shapeHolePts, function(e) {
                    h += e.length
                });
                var u = t.shapePts.length + h;
                o = r > u
            }
            var d = q && !n;
            if (d = d && 0 == t.shapeHolePts.length && !t.innerPoints, o) {
                var c, f, p, m = [],
                    g = 0;
                for (c = 0; c < t.shapePts.length; c++) p = t.shapePts[c], p.index = g++, m.push({
                    index: p.index,
                    position: p
                });
                if (t.shapeHolePts)
                    for (f = 0; f < t.shapeHolePts.length; ++f) {
                        var _ = t.shapeHolePts[f];
                        for (c = 0; c < _.length; c++) p = _[c], p.index = g++, m.push({
                            index: p.index,
                            position: p
                        })
                    }
                if (t.innerPoints)
                    for (c = 0; c < t.innerPoints.length; c++) p = t.innerPoints[c], p.index = g++, m.push({
                        index: p.index,
                        position: p
                    });
                d ? a(e, t, m, i) : s(e, t, m, i)
            } else l(e, t, i)
        }

        function u(e, t, i, n, r) {
            var o, a, s, l, h, u, d, c, f, p, m = e._positionArray,
                g = e._normalArray,
                _ = e._colorArray,
                v = e._indexArray,
                y = null !== v && void 0 !== v,
                b = m.length,
                x = n.center.x,
                w = n.center.y;
            if (y) {
                var M = {
                        indexOffset: m.length / 3,
                        normalSmoothing: r
                    },
                    T = [],
                    S = 0;
                for (u = U, d = W, c = G, f = j, s = 0; s < i.length - 1; ++s)
                    for (o = i[s], a = i[s + 1], l = 0; l < t.length; ++l) u.set(t[l].x, t[l].y, o.z), u.x += (x - u.x) * o.xy, u.y += (w - u.y) * o.xy, c.set(t[l].x, t[l].y, a.z), c.x += (x - c.x) * a.xy, c.y += (w - c.y) * a.xy, p = a.color, T.push({
                        position: u.clone(),
                        color: p,
                        index: S++
                    }), T.push({
                        position: c.clone(),
                        color: p,
                        index: S++
                    });
                for (s = 0; s < i.length - 1; ++s)
                    for (l = 0; l < t.length; ++l) {
                        var C = 2 * s * t.length,
                            E = C + 2 * l,
                            k = E + 1,
                            L = l == t.length - 1 ? C : E + 2,
                            D = L + 1;
                        u = T[E].position, c = T[k].position, d = T[L].position, f = T[D].position, h = H.computeNormal(u, c, d), A(T, v, E, h, M), A(T, v, k, h, M), A(T, v, L, h, M), h = H.computeNormal(d, c, f), A(T, v, L, h, M), A(T, v, k, h, M), A(T, v, D, h, M)
                    }
                R(e, T, null, !1)
            } else {
                for (u = U, d = W, c = G, f = j, s = 0; s < i.length - 1; ++s)
                    for (o = i[s], a = i[s + 1], l = 0; l < t.length; ++l) {
                        var I = l == t.length - 1 ? 0 : l + 1;
                        u.set(t[l].x, t[l].y, o.z), c.x = u.x + (x - u.x) * a.xy, c.y = u.y + (w - u.y) * a.xy, c.z = a.z, u.x += (x - u.x) * o.xy, u.y += (w - u.y) * o.xy, d.set(t[I].x, t[I].y, o.z), f.x = d.x + (x - d.x) * a.xy, f.y = d.y + (w - d.y) * a.xy, f.z = a.z, d.x += (x - d.x) * o.xy, d.y += (w - d.y) * o.xy, p = a.color, h = H.computeNormal(u, c, d), m.push(u.x, u.y, u.z, c.x, c.y, c.z, d.x, d.y, d.z), g.push(h.x, h.y, h.z, h.x, h.y, h.z, h.x, h.y, h.z), _.push(p.r, p.g, p.b, p.a, p.r, p.g, p.b, p.a, p.r, p.g, p.b, p.a), h = H.computeNormal(d, c, f), m.push(d.x, d.y, d.z, c.x, c.y, c.z, f.x, f.y, f.z), g.push(h.x, h.y, h.z, h.x, h.y, h.z, h.x, h.y, h.z), _.push(p.r, p.g, p.b, p.a, p.r, p.g, p.b, p.a, p.r, p.g, p.b, p.a)
                    }
                r && P(b, m, g)
            }
        }

        function d(e, t, i) {
            var n, r, o, a, s = i.minHeight,
                l = i.height,
                h = i.color,
                u = i.closed,
                d = i.repeatUv,
                c = e._positionArray,
                f = e._indexArray,
                p = u ? t.length : t.length - 1,
                m = new N,
                g = new N,
                _ = new N,
                v = new N,
                y = h,
                b = h;
            D.isArray(h) && (y = h[0], b = h[1]);
            var x, w, M = [],
                T = {
                    indexOffset: c.length / 3,
                    normalSmoothing: i.normalSmoothing
                },
                S = 0;
            for (o = 0, r = t[0], w = 0; w < t.length; ++w) n = t[w], o = d ? o + n.distanceTo(r) * d : 0, 0 == l ? (m.set(n.x, n.y, s), _.copy(m), _.z = n.z) : (m.set(n.x, n.y, n.z - l), _ = n), M.push({
                position: m.clone(),
                color: y,
                uv: {
                    u: o,
                    v: 0
                },
                index: S++
            }), M.push({
                position: _.clone(),
                color: b,
                uv: {
                    u: o,
                    v: -1
                },
                index: S++
            }), r = n;
            for (w = 0; p > w; ++w) {
                x = u && w == p - 1;
                var C = 2 * w,
                    E = C + 1,
                    k = x ? 0 : C + 2,
                    L = x ? 1 : C + 3;
                m = M[C].position, _ = M[E].position, g = M[k].position, v = M[L].position, 0 == l && m.equals(_) ? a = H.computeNormal(g, _, v) : (a = H.computeNormal(m, _, g), A(M, f, C, a, T), A(M, f, E, a, T), A(M, f, k, a, T)), A(M, f, k, a, T), A(M, f, E, a, T), A(M, f, L, a, T)
            }
            R(e, M, null, d)
        }

        function c(e, t, i) {
            var n, r, o, a, s = i.minHeight,
                l = i.height,
                h = i.color,
                u = i.closed,
                d = i.repeatUv,
                c = i.normalSmoothing,
                f = e._positionArray,
                p = e._normalArray,
                m = e._colorArray,
                g = f.length,
                _ = u ? t.length : t.length - 1,
                v = new N,
                y = new N,
                b = new N,
                x = new N,
                w = h,
                M = h;
            D.isArray(h) && (w = h[0], M = h[1]);
            for (var T, S = 0; _ > S; ++S) T = u && S == _ - 1, n = t[S], r = T ? t[0] : t[S + 1], 0 == l ? (v.set(n.x, n.y, s), b.copy(v), b.z = n.z - l, y.set(r.x, r.y, s), x.copy(y), x.z = r.z - l) : (v.set(n.x, n.y, n.z - l), b = n, y.set(r.x, r.y, r.z - l), x = r), 0 == l && v.equals(b) ? a = H.computeNormal(y, b, x) : (a = H.computeNormal(v, b, y), f.push(v.x, v.y, v.z, b.x, b.y, b.z, y.x, y.y, y.z), p.push(a.x, a.y, a.z, a.x, a.y, a.z, a.x, a.y, a.z), h && m.push(w.r, w.g, w.b, w.a, M.r, M.g, M.b, M.a, w.r, w.g, w.b, w.a)), f.push(y.x, y.y, y.z, b.x, b.y, b.z, x.x, x.y, x.z), p.push(a.x, a.y, a.z, a.x, a.y, a.z, a.x, a.y, a.z), h && m.push(w.r, w.g, w.b, w.a, M.r, M.g, M.b, M.a, M.r, M.g, M.b, M.a), d && (o = n.distanceTo(r) * d, e._uvArray.push(0, 0, 0, -1, o, 0, o, 0, 0, -1, o, -1));
            c && P(g, f, p)
        }

        function f(e, t, i) {
            null != e._indexArray ? d(e, t, i) : c(e, t, i)
        }

        function p(e, t, i, n, r) {
            e._indexArray ? m(e, t, i, n, r) : g(e, t, i, n, r)
        }

        function m(e, t, i, n, r) {
            var o, a, s, l, h, u, d = e._positionArray,
                c = e._normalArray,
                f = e._indexArray,
                p = t.length,
                m = {
                    indexOffset: d.length / 3,
                    normalSmoothing: !1
                },
                g = [],
                _ = 0;
            for (u = 0; p > u; ++u) s = i[u], o = t[u], g[_] = {
                position: new N(s.x, s.y, null == s.z ? 0 : s.z),
                index: _
            }, _++, g[_] = {
                position: new N(o.x, o.y, null == o.z ? 0 : o.z),
                index: _
            }, _++;
            var v = r ? p : p - 1;
            for (u = 0; v > u; ++u) {
                var y = r && u == v - 1,
                    b = 2 * u,
                    x = b + 1,
                    w = y ? 0 : b + 2,
                    M = y ? 1 : b + 3;
                s = g[b].position, l = g[w].position, o = g[x].position, a = g[M].position, s.equals(l) || (h = c ? H.computeNormal(o, s, l) : null, A(g, f, b, h, m), A(g, f, w, h, m), A(g, f, x, h, m)), o.equals(a) || (h = c ? H.computeNormal(o, l, a) : null, A(g, f, x, h, m), A(g, f, w, h, m), A(g, f, M, h, m))
            }
            R(e, g, n, !1)
        }

        function g(e, t, i, n, r) {
            function o(e, t, i) {
                c.push(e.x, e.y, e.z, t.x, t.y, t.z, i.x, i.y, i.z), f && (u = H.computeNormal(e, t, i), f.push(u.x, u.y, u.z, u.x, u.y, u.z, u.x, u.y, u.z)), n && p.push(n.r, n.g, n.b, n.a, n.r, n.g, n.b, n.a, n.r, n.g, n.b, n.a)
            }
            var a, s, l, h, u, d, c = e._positionArray,
                f = e._normalArray,
                p = e._colorArray,
                m = t.length;
            for (d = 0; m - 1 > d; ++d) a = t[d], s = t[d + 1], l = i[d], h = i[d + 1], a.z = null == a.z ? 0 : a.z, s.z = null == s.z ? 0 : s.z, l.z = null == l.z ? 0 : l.z, h.z = null == h.z ? 0 : h.z, l.equals(h) || o(a, l, h), a.equals(s) || o(a, h, s);
            if (r) {
                a = t[0], l = i[0];
                var g = i[i.length - 1];
                g.equals(l) && (g = t[t.length - 1]), c.push(a.x, a.y, a.z, g.x, g.y, g.z, l.x, l.y, l.z), f && (u = H.computeNormal(a, g, l), f.push(u.x, u.y, u.z, u.x, u.y, u.z, u.x, u.y, u.z)), n && p.push(n.r, n.g, n.b, n.a, n.r, n.g, n.b, n.a, n.r, n.g, n.b, n.a)
            }
        }

        function _(e, t) {
            t.useIndexedData ? y(e, t) : b(e, t)
        }

        function v(e) {
            var t;
            return t = e ? (O.maxIndexCount - O.maxIndexCount % 2) / 2 : O.maxFloatCount - O.maxFloatCount % 3
        }

        function y(e, t) {
            var i = t.shapePts,
                n = t.rightPts,
                r = t.leftPts,
                o = t.useIndexedData,
                a = t.radius,
                s = t.scaleNormal || 1;
            t.closed && (i.push(i[0]), n.push(n[0]), r.push(r[0]));
            for (var l, h, u, d, c, f = new N, p = n.length, m = i.length, g = v(o), _ = Math.floor(p / g) + 1, y = p % g, b = 0, x = 0; _ > x; ++x) {
                var w = new O;
                w._positionArray = [], w._normalArray = [], w._indexArray = o ? [] : null, w.boundingRadius = Math.max(w.boundingRadius, a), e.push(w);
                for (var M = x == _ - 1 ? y : g, T = [], S = 0, C = 0; M > C; ++C) u = r[C + b], null == u.z && (u.z = 0), l = n[C + b], null == l.z && (l.z = 0), c = i[Math.floor((C + 1 + b) / 2) % m], null == c.z && (c.z = 0), f.copy(l).subSelf(c), T[S] = {
                    position: new N(c.x, c.y, c.z),
                    normal: new N(f.x * s, f.y * s, f.z * s),
                    index: S
                }, S++, f.copy(u).subSelf(c), T[S] = {
                    position: new N(c.x, c.y, c.z),
                    normal: new N(f.x * s, f.y * s, f.z * s),
                    index: S
                }, S++;
                b += M, l = U, h = W, u = G, d = j;
                var E = {
                        indexOffset: 0,
                        normalSmoothing: !1
                    },
                    k = w._indexArray;
                for (C = 0; M - 1 > C; ++C) {
                    var L = 2 * C,
                        P = L + 1,
                        D = L + 2,
                        I = L + 3;
                    l.copy(T[L].position).addSelf(T[L].normal), h.copy(T[D].position).addSelf(T[D].normal), u.copy(T[P].position).addSelf(T[P].normal), d.copy(T[I].position).addSelf(T[I].normal), u.equals(d) || (A(T, k, L, null, E), A(T, k, P, null, E), A(T, k, I, null, E)), l.equals(h) || (A(T, k, L, null, E), A(T, k, I, null, E), A(T, k, D, null, E))
                }
                R(w, T, null, !1)
            }
        }

        function b(e, t) {
            var i = t.shapePts,
                n = t.rightPts,
                r = t.leftPts,
                o = t.useIndexedData,
                a = t.radius,
                s = t.scaleNormal || 1;
            t.closed && (i.push(i[0]), n.push(n[0]), r.push(r[0]));
            for (var l, h, u, d, c, f, p = new N, m = n.length, g = i.length, _ = v(o), y = Math.floor(m / _) + 1, b = m % _, x = 0, w = 0; y > w; ++w) {
                var M = new O;
                M._positionArray = [], M._normalArray = [], M._indexArray = o ? [] : null, M.boundingRadius = Math.max(M.boundingRadius, a), e.push(M);
                for (var T = M._positionArray, S = M._normalArray, C = w == y - 1 ? b : _, E = 0; C - 1 > E; ++E) l = n[E + x], null == l.z && (l.z = 0), h = n[E + 1 + x], null == h.z && (h.z = 0), u = r[E + x], null == u.z && (u.z = 0), d = r[E + 1 + x], null == d.z && (d.z = 0), c = i[Math.floor((E + 1 + x) / 2) % g], null == c.z && (c.z = 0), f = i[Math.floor((E + 2 + x) / 2) % g], null == f.z && (f.z = 0), u.equals(d) || (T.push(c.x, c.y, c.z, c.x, c.y, c.z, f.x, f.y, f.z), p.copy(l).subSelf(c), S.push(p.x * s, p.y * s, p.z * s), p.copy(u).subSelf(c), S.push(p.x * s, p.y * s, p.z * s), p.copy(d).subSelf(f), S.push(p.x * s, p.y * s, p.z * s)), l.equals(h) || (T.push(c.x, c.y, c.z, f.x, f.y, f.z, f.x, f.y, f.z), p.copy(l).subSelf(c), S.push(p.x * s, p.y * s, p.z * s), p.copy(d).subSelf(f), S.push(p.x * s, p.y * s, p.z * s), p.copy(h).subSelf(f), S.push(p.x * s, p.y * s, p.z * s));
                x += C
            }
        }

        function x(e, t, i, n) {
            var r = new O(t);
            r.boundingRadius = 1, r.fixedColor = e ? e : new B(16777215), r._positionArray = [], r._normalArray = [], r._uvArray = [], r._indexArray = [];
            for (var o = 0; n >= o; o++)
                for (var a = -.5 + o / n, s = 1 - o / n, l = 0; i >= l; l++) {
                    var h = -.5 + l / i,
                        u = l / i;
                    r._positionArray.push(h, a, 0), r._normalArray.push(0, 0, 1), r._uvArray.push(u, s)
                }
            return r
        }

        function w(e, t, i) {
            t = t ? t : 1, i = i ? i : 1;
            var n, r, o = x(e, I.TRIANGLES, t, i);
            for (r = 0; i > r; r++)
                for (n = 0; t > n; n++) {
                    var a = r * (t + 1) + n,
                        s = a + 1,
                        l = a + (t + 1),
                        h = l + 1;
                    o._indexArray.push(a, s, l, l, s, h)
                }
            return o
        }

        function M(e, t, i) {
            t = t ? t : 1, i = i ? i : 1;
            var n, r, o = x(e, I.LINES, t, i);
            for (r = 0; i > r; r++)
                for (n = 0; t > n; n++) {
                    var a = r * (t + 1) + n,
                        s = a + 1,
                        l = a + (t + 1);
                    o._indexArray.push(a, s, a, l, l, s)
                }
            var h = i * (t + 1);
            for (n = 0; t > n; n++) o._indexArray.push(h, h + 1), h++;
            for (h = t, r = 0; i > r; r++) o._indexArray.push(h, h + (t + 1)), h += t + 1;
            return o
        }

        function T(e, t) {
            var i = e._positionArray.length / 3;
            S(e, t), C(e, i, t)
        }

        function S(e, t) {
            for (var i = t.w, n = t.h, r = t.normX, o = t.normY, a = t.normZ, s = t.transX, l = t.transY, h = t.transZ, u = e._positionArray, d = e._normalArray, c = e._uvArray, f = t.nx, p = t.ny, m = 0; p >= m; m++) {
                var g = -(n / 2) + m * (n / p),
                    _ = 1 - m / p;
                t.cw && (_ = 1 - _);
                for (var v = 0; f >= v; v++) {
                    var y, b, x, w = -(i / 2) + v * (i / f),
                        M = v / f;
                    0 != a ? (y = s + w, b = l + g, x = h) : 0 != r ? (y = s, b = l + w, x = h + g) : (y = s + g, b = l, x = h + w), u.push(y), u.push(b), u.push(x), d.push(r), d.push(o), d.push(a), c.push(M), c.push(_)
                }
            }
        }

        function C(e, t, i) {
            var n, r, o, a, s, l, h = e._indexArray,
                u = i.primitiveType,
                d = i.nx,
                c = i.ny,
                f = i.cw;
            if (u == I.TRIANGLES)
                for (l = 0; c > l; l++)
                    for (s = 0; d > s; s++) n = t + l * (d + 1) + s, r = f ? n + 1 : n + d + 1, o = f ? n + d + 1 : n + 1, a = f ? o + 1 : r + 1, h.push(n), h.push(o), h.push(r), h.push(r), h.push(o), h.push(a);
            else if (u == I.LINES) {
                for (l = 0; c > l; l++)
                    for (s = 0; d > s; s++) n = t + l * (d + 1) + s, r = n + 1, o = n + (d + 1), h.push(n, r, n, o);
                var p = t + c * (d + 1);
                for (s = 0; d > s; s++) h.push(p, p + 1), p++;
                for (p = t + d, l = 0; c > l; l++) h.push(p, p + (d + 1)), p += d + 1
            }
        }

        function E(e) {
            e = D.defaults({}, e, {
                nx: 1,
                ny: 1,
                nz: 1,
                primitiveType: I.TRIANGLES,
                width: 1,
                height: 1,
                depth: 1,
                color: new B(16777215)
            });
            var t = new O(e.primitiveType);
            return t.boundingRadius = 1, t.fixedColor = e.color, t._positionArray = [], t._normalArray = [], t._uvArray = [], t._indexArray = [], T(t, {
                primitiveType: e.primitiveType,
                nx: e.nx,
                ny: e.ny,
                w: e.width,
                h: e.depth,
                transX: 0,
                transY: 0,
                transZ: -.5 * e.height,
                normX: 0,
                normY: 0,
                normZ: -1,
                cw: !0
            }), T(t, {
                primitiveType: e.primitiveType,
                nx: e.nx,
                ny: e.ny,
                w: e.width,
                h: e.depth,
                transX: 0,
                transY: 0,
                transZ: .5 * e.height,
                normX: 0,
                normY: 0,
                normZ: 1,
                cw: !1
            }), T(t, {
                primitiveType: e.primitiveType,
                nx: e.ny,
                ny: e.nz,
                w: e.depth,
                h: e.height,
                transX: -.5 * e.width,
                transY: 0,
                transZ: 0,
                normX: -1,
                normY: 0,
                normZ: 0,
                cw: !0
            }), T(t, {
                primitiveType: e.primitiveType,
                nx: e.ny,
                ny: e.nz,
                w: e.depth,
                h: e.height,
                transX: .5 * e.width,
                transY: 0,
                transZ: 0,
                normX: 1,
                normY: 0,
                normZ: 0,
                cw: !1
            }), T(t, {
                primitiveType: e.primitiveType,
                nx: e.nz,
                ny: e.nx,
                w: e.height,
                h: e.width,
                transX: 0,
                transY: -.5 * e.depth,
                transZ: 0,
                normX: 0,
                normY: -1,
                normZ: 0,
                cw: !0
            }), T(t, {
                primitiveType: e.primitiveType,
                nx: e.nz,
                ny: e.nx,
                w: e.height,
                h: e.width,
                transX: 0,
                transY: .5 * e.depth,
                transZ: 0,
                normX: 0,
                normY: 1,
                normZ: 0,
                cw: !1
            }), t
        }

        function k(e) {
            var t = new O(I.LINES);
            return t.boundingRadius = e, t._positionArray = [0, 0, 0, e, 0, 0, 0, 0, 0, 0, e, 0, 0, 0, 0, 0, 0, e], t._colorArray = [1, 0, 0, 1, 1, 0, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1], t
        }

        function L(e) {
            var t = e.radius || 50,
                i = void 0 !== e.phiStart ? e.phiStart : 0,
                n = void 0 !== e.phiLength ? e.phiLength : 2 * Math.PI,
                r = void 0 !== e.thetaStart ? e.thetaStart : 0,
                o = void 0 !== e.thetaLength ? e.thetaLength : Math.PI,
                a = e.segmentsWidth,
                s = e.segmentsHeight,
                l = Math.max(3, Math.floor(a) || 8),
                h = Math.max(2, Math.floor(s) || 6),
                u = new O;
            u.fixedColor = new B, u._positionArray = [], u._uvArray = [], u._normalArray = [];
            var d, c, f = [];
            for (c = 0; h >= c; c++) {
                var p = [];
                for (d = 0; l >= d; d++) {
                    var m = d / l,
                        g = c / h,
                        _ = t * Math.sin(i + m * n) * Math.sin(r + g * o),
                        v = -t * Math.cos(i + m * n) * Math.sin(r + g * o),
                        y = t * Math.cos(r + g * o);
                    p.push({
                        pos: {
                            x: _,
                            y: v,
                            z: y
                        },
                        uv: {
                            u: m,
                            v: g
                        }
                    })
                }
                f.push(p)
            }
            for (c = 0; h > c; c++)
                for (d = 0; l > d; d++) {
                    var b = f[c][d + 1],
                        x = f[c][d],
                        w = f[c + 1][d],
                        M = f[c + 1][d + 1];
                    Math.abs(w.pos.z) != t && (u._positionArray.push(b.pos.x, b.pos.y, b.pos.z, w.pos.x, w.pos.y, w.pos.z, M.pos.x, M.pos.y, M.pos.z), u._normalArray.push(b.pos.x / t, b.pos.y / t, b.pos.z / t, w.pos.x / t, w.pos.y / t, w.pos.z / t, M.pos.x / t, M.pos.y / t, M.pos.z / t), u._uvArray.push(b.uv.u, b.uv.v, w.uv.u, w.uv.v, M.uv.u, M.uv.v)), Math.abs(b.pos.z) != t && (u._positionArray.push(b.pos.x, b.pos.y, b.pos.z, x.pos.x, x.pos.y, x.pos.z, w.pos.x, w.pos.y, w.pos.z), u._normalArray.push(b.pos.x / t, b.pos.y / t, b.pos.z / t, x.pos.x / t, x.pos.y / t, x.pos.z / t, w.pos.x / t, w.pos.y / t, w.pos.z / t), u._uvArray.push(b.uv.u, b.uv.v, x.uv.u, x.uv.v, w.uv.u, w.uv.v))
                }
            return u.boundingSphereRadius = t, u
        }

        function P(e, t, i) {
            for (var n, r, o = {}, a = e; a < t.length;) r = "_" + t[a] + "_" + t[a + 1] + "_" + t[a + 2], n = o[r], n || (n = o[r] = new N), n.x += i[a], n.y += i[a + 1], n.z += i[a + 2], a += 3;
            for (a = e; a < t.length;) r = "_" + t[a] + "_" + t[a + 1] + "_" + t[a + 2], n = o[r], n.normalized || (n.normalized = !0, n.normalize()), i[a] = n.x, i[a + 1] = n.y, i[a + 2] = n.z, a += 3
        }

        function A(e, t, i, n, r) {
            var o = r.indexOffset,
                a = r.normalSmoothing,
                s = e[i];
            if (n && s.normal && !a)
                if (s.normal.nearEquals(n, .001)) t.push(i + o);
                else if (s.link) A(e, t, s.link.index, n, r);
            else {
                i = e.length;
                var l = {
                    index: i,
                    position: new N(s.position.x, s.position.y, s.position.z),
                    normal: n.clone(),
                    color: s.color,
                    uv: s.uv
                };
                s.link = l, e.push(l), t.push(i + o)
            } else a && n ? s.normal ? (s.normal.addSelf(n), s.normalRequiresNormalization = !0) : s.normal = n.clone() : n && (s.normal = n.clone()), t.push(i + o)
        }

        function R(e, t, i, n) {
            for (var r = e._positionArray, o = e._normalArray, a = e._colorArray, s = e._uvArray, l = 0; l < t.length; l++) {
                var h = t[l],
                    u = h.position;
                if (r.push(u.x, u.y, u.z), o) {
                    var d = h.normal;
                    d ? h.normalRequiresNormalization && d.normalize() : d = new N, o.push(d.x, d.y, d.z)
                }
                if (a) {
                    var c = h.color;
                    null == c && null != i && (c = i), null != c && a.push(c.r, c.g, c.b, c.a)
                }
                if (s && n) {
                    var f = h.uv;
                    s.push(f.u, f.v)
                }
            }
        }
        var D = e("underscore"),
            I = e("../Constants"),
            O = e("../object/Geometry"),
            N = e("../math/Vector3"),
            B = e("../Color"),
            F = e("poly2tri"),
            z = e("earcut"),
            H = e("./VectorUtils"),
            U = new N,
            W = new N,
            G = new N,
            j = new N,
            q = !0;
        t.exports = {
            getTrianglesFromRing: n,
            triangulateRing: h,
            triangulateShapeFromSplits: u,
            extrudeWall: f,
            smoothNormals: P,
            triangulateOffsetPointsList: p,
            triangulateLinePointsList: _,
            createUnitPlane: w,
            createUnitPlaneLines: M,
            createCuboid: E,
            createAxis: k,
            createSphere: L
        }
    }, {
        "../Color": 13,
        "../Constants": 14,
        "../math/Vector3": 63,
        "../object/Geometry": 68,
        "./VectorUtils": 83,
        earcut: 9,
        poly2tri: 173,
        underscore: 207
    }],
    83: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            return (e.x - t.x) * (i.y - t.y) - (i.x - t.x) * (e.y - t.y)
        }

        function r(e, t, i) {
            var n = h;
            n.sub(t, i);
            var r = u;
            return r.sub(t, e), n.crossSelf(r), n.isZero() || n.normalize(), n
        }

        function o(e, t, i, n) {
            var r = t.dot(n);
            if (1 == r) return null;
            var o = t.x * n.y - t.y * n.x;
            if (0 == o) return null;
            var a = (e.y - i.y) * n.x - (e.x - i.x) * n.y;
            a /= o;
            var l = s.clone(e);
            return l.x += t.x * a, l.y += t.y * a, l
        }

        function a(e, t, i, n) {
            var r = new s;
            r.sub(t, e);
            var a = r.clone().normalize(),
                l = new s;
            l.sub(n, i);
            var h = l.clone().normalize(),
                u = o(e, a, i, h);
            if (null != u) {
                var d = new s;
                if (d.sub(u, e), d.isZero()) return u;
                if (d.dot(r) > 0 && d.length() <= r.length() + .01) {
                    if (d.sub(u, i), d.isZero()) return u;
                    if (d.dot(l) > 0 && d.length() <= l.length() + .01) return u
                }
            }
            return null
        }
        var s = e("../math/Vector2"),
            l = e("../math/Vector3"),
            h = new l,
            u = new l;
        t.exports = {
            determinant: n,
            computeNormal: r,
            findIntersection: o,
            findInnerIntersection: a
        }
    }, {
        "../math/Vector2": 62,
        "../math/Vector3": 63
    }],
    84: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._gl = e, this._allExtensionNames = this._gl.getSupportedExtensions(), this._allExtensions = {};
            for (var t = 0; t < this._allExtensionNames.length; t++) this._allExtensions[this._allExtensionNames[t]] = null;
            this.textureFloatState = 0
        }
        var r = e("underscore"),
            o = e("browser-detect");
        t.exports = n, t.exports.TEXTURE_FLOAT_DISABLED = 0, t.exports.TEXTURE_FLOAT_FULL = 1, t.exports.TEXTURE_FLOAT_HALF = 2, t.exports.TEXTURE_FLOAT_LINEAR = 4, t.exports.instanced_arrays = "instanced_arrays", t.exports.blend_minmax = "blend_minmax", t.exports.color_buffer_half_float = "color_buffer_half_float", t.exports.disjoint_timer_query = "disjoint_timer_query", t.exports.frag_depth = "frag_depth", t.exports.sRGB = "sRGB", t.exports.shader_texture_lod = "shader_texture_lod", t.exports.texture_filter_anisotropic = "texture_filter_anisotropic", t.exports.element_index_uint = "element_index_uint", t.exports.standard_derivatives = "standard_derivatives", t.exports.texture_float = "texture_float", t.exports.texture_float_linear = "texture_float_linear", t.exports.texture_half_float = "texture_half_float", t.exports.texture_half_float_linear = "texture_half_float_linear", t.exports.vertex_array_object = "vertex_array_object", t.exports.color_buffer_float = "color_buffer_float", t.exports.compressed_texture_atc = "compressed_texture_atc", t.exports.compressed_texture_etc1 = "compressed_texture_etc1", t.exports.compressed_texture_pvrtc = "compressed_texture_pvrtc", t.exports.compressed_texture_s3tc = "compressed_texture_s3tc", t.exports.debug_renderer_info = "debug_renderer_info", t.exports.debug_shaders = "debug_shaders", t.exports.depth_texture = "depth_texture", t.exports.draw_buffers = "draw_buffers", t.exports.lose_context = "lose_context", n.prototype.isAvailable = function(e) {
            return null != this.getFullExtensionName(e)
        }, n.prototype.getFullExtensionName = function(e) {
            var t = r.find(this._allExtensionNames, function(t) {
                return t.indexOf(e) > -1
            });
            return t
        }, n.prototype.enableExtension = function(e) {
            if (this.isAvailable(e)) {
                var t = this.getFullExtensionName(e);
                if (null != this._allExtensions[t]) return this._allExtensions[t];
                var i = this._gl.getExtension(t);
                if (null != i) return this._allExtensions[t] = i, i;
                console.warn("Unable to activate GL Extension " + e + " (" + t + ")")
            } else console.warn("GL Extension " + e + " does not exist for this device");
            return null
        }, n.prototype.isEnabled = function(e) {
            var t = this.getFullExtensionName(e);
            return null != t && null != this._allExtensions[t]
        }, n.prototype.enableTextureFloat = function(e) {
            return 0 == this.textureFloatState && (this.enableExtension(n.texture_float) ? this.textureFloatState = n.TEXTURE_FLOAT_FULL : this.enableExtension(n.texture_half_float) && (this.textureFloatState = n.TEXTURE_FLOAT_HALF)), !o.isIOS() && e && (this.textureFloatState == n.TEXTURE_FLOAT_FULL ? this.enableExtension(n.texture_float_linear) && (this.textureFloatState |= n.TEXTURE_FLOAT_LINEAR) : this.textureFloatState == n.TEXTURE_FLOAT_HALF && this.enableExtension(n.texture_half_float_linear) && (this.textureFloatState |= n.TEXTURE_FLOAT_LINEAR)), this.textureFloatState
        }
    }, {
        "browser-detect": 11,
        underscore: 207
    }],
    85: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, r, o, a, s) {
            this.width = i, this.height = n, a ? s ? this.geometry = this.createIndexedInterleavedGeometry(e, t, i, n, r, o) : this.geometry = this.createIndexedGeometry(e, t, i, n, r, o) : this.geometry = this.createArrayGeometry(e, t, i, n, r, o), this.mesh = null, this.material = null, this.materialName = null
        }
        var r = e("../../object/Geometry"),
            o = e("../../object/Mesh");
        t.exports = n, n.prototype.createArrayGeometry = function(e, t, i, n, o, a) {
            var s = new r,
                l = (e - 1) * (t - 1) * 6;
            s._positionArray = new Float32Array(3 * l), s.__isPositionDirty = !0, s.setPointsCount(l), o && (s._colorArray = new Float32Array(4 * l), s.__isColorDirty = !0), a && (s._uvArray = new Float32Array(2 * l), s.__isUvDirty = !0);
            for (var h = i / (e - 1), u = n / (t - 1), d = 1 / (e - 1), c = 1 / (t - 1), f = 0; t - 1 > f; f++)
                for (var p = f * n / (t - 1) - .5 * n, m = f / (t - 1), g = 0; e - 1 > g; g++) {
                    var _ = g * i / (e - 1) - .5 * n,
                        v = g / (e - 1),
                        y = 6 * (f * (e - 1) + g) * 3;
                    if (s._positionArray[y++] = _, s._positionArray[y++] = p, s._positionArray[y++] = 0, s._positionArray[y++] = _ + h, s._positionArray[y++] = p, s._positionArray[y++] = 0, s._positionArray[y++] = _, s._positionArray[y++] = p + u, s._positionArray[y++] = 0, s._positionArray[y++] = _ + h, s._positionArray[y++] = p, s._positionArray[y++] = 0, s._positionArray[y++] = _ + h, s._positionArray[y++] = p + u, s._positionArray[y++] = 0, s._positionArray[y++] = _, s._positionArray[y++] = p + u, s._positionArray[y++] = 0, o) {
                        var b = Math.random(),
                            x = Math.random(),
                            w = Math.random();
                        y = 6 * (f * (e - 1) + g) * 4, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1, s._colorArray[y++] = b, s._colorArray[y++] = x, s._colorArray[y++] = w, s._colorArray[y++] = 1
                    }
                    a && (y = 6 * (f * (e - 1) + g) * 2, s._uvArray[y++] = v, s._uvArray[y++] = m, s._uvArray[y++] = v + d, s._uvArray[y++] = m, s._uvArray[y++] = v, s._uvArray[y++] = m + c, s._uvArray[y++] = v + d, s._uvArray[y++] = m, s._uvArray[y++] = v + d, s._uvArray[y++] = m + c, s._uvArray[y++] = v, s._uvArray[y++] = m + c)
                }
            return s.needsRebuildWebGLBuffer(), s.__webglAttributeBuffers = {}, s
        }, n.prototype.createIndexedGeometry = function(e, t, i, n, o, a) {
            var s = new r,
                l = (e - 1) * (t - 1) * 4,
                h = (e - 1) * (t - 1) * 6;
            s._positionArray = new Float32Array(3 * l), s.__isPositionDirty = !0, s.setPointsCount(l), s._indexArray = new Uint16Array(h), s.__isIndexDirty = !0, o && (s._colorArray = new Float32Array(4 * l), s.__isColorDirty = !0), a && (s._uvArray = new Float32Array(2 * l), s.__isUvDirty = !0);
            var u, d, c, f = i / (e - 1),
                p = n / (t - 1),
                m = 1 / (e - 1),
                g = 1 / (t - 1);
            for (d = 0; t - 1 > d; d++) {
                var _ = d * n / (t - 1) - .5 * n,
                    v = d / (t - 1);
                for (u = 0; e - 1 > u; u++) {
                    var y = u * i / (e - 1) - .5 * n,
                        b = u / (e - 1);
                    if (c = 4 * (d * (e - 1) + u) * 3, s._positionArray[c++] = y, s._positionArray[c++] = _, s._positionArray[c++] = 0, s._positionArray[c++] = y + f, s._positionArray[c++] = _, s._positionArray[c++] = 0, s._positionArray[c++] = y, s._positionArray[c++] = _ + p, s._positionArray[c++] = 0, s._positionArray[c++] = y + f, s._positionArray[c++] = _ + p, s._positionArray[c++] = 0, o) {
                        var x = Math.random(),
                            w = Math.random(),
                            M = Math.random();
                        c = 4 * (d * (e - 1) + u) * 4, s._colorArray[c++] = x, s._colorArray[c++] = w, s._colorArray[c++] = M, s._colorArray[c++] = 1, s._colorArray[c++] = x, s._colorArray[c++] = w, s._colorArray[c++] = M, s._colorArray[c++] = 1, s._colorArray[c++] = x, s._colorArray[c++] = w, s._colorArray[c++] = M, s._colorArray[c++] = 1, s._colorArray[c++] = x, s._colorArray[c++] = w, s._colorArray[c++] = M, s._colorArray[c++] = 1
                    }
                    a && (c = 4 * (d * (e - 1) + u) * 2, s._uvArray[c++] = b, s._uvArray[c++] = v, s._uvArray[c++] = b + m, s._uvArray[c++] = v, s._uvArray[c++] = b, s._uvArray[c++] = v + g, s._uvArray[c++] = b + m, s._uvArray[c++] = v + g)
                }
            }
            for (c = 0, d = 0; t - 1 > d; d++)
                for (u = 0; e - 1 > u; u++) {
                    var T = 4 * (d * (e - 1) + u),
                        S = T + 1,
                        C = T + 2,
                        E = T + 3;
                    s._indexArray[c++] = T, s._indexArray[c++] = S, s._indexArray[c++] = C, s._indexArray[c++] = C, s._indexArray[c++] = S, s._indexArray[c++] = E
                }
            return s.needsRebuildWebGLBuffer(), s.__webglAttributeBuffers = {}, s
        }, n.prototype.createIndexedInterleavedGeometry = function(e, t, i, n, o, a) {
            var s = new r,
                l = (e - 1) * (t - 1) * 4,
                h = (e - 1) * (t - 1) * 6,
                u = 3,
                d = {
                    position: {
                        size: 3,
                        offset: 0
                    }
                };
            o && (d.color = {
                size: 4,
                offset: u
            }, u += 4), a && (d.uv = {
                size: 2,
                offset: u
            }, u += 2), s._interleavedData = {
                stride: u,
                array: new Float32Array(l * u),
                details: d
            }, s.__isInterleavingDirty = !0, s.setPointsCount(l), s._indexArray = new Uint16Array(h), s.__isIndexDirty = !0;
            var c, f, p, m = i / (e - 1),
                g = n / (t - 1),
                _ = 1 / (e - 1),
                v = 1 / (t - 1),
                y = s._interleavedData.array;
            for (f = 0; t - 1 > f; f++) {
                var b = f * n / (t - 1) - .5 * n,
                    x = f / (t - 1);
                for (c = 0; e - 1 > c; c++) {
                    var w = c * i / (e - 1) - .5 * n,
                        M = c / (e - 1),
                        T = Math.random(),
                        S = Math.random(),
                        C = Math.random();
                    p = 4 * (f * (e - 1) + c) * u, y[p++] = w, y[p++] = b, y[p++] = 0, o && (y[p++] = T, y[p++] = S, y[p++] = C, y[p++] = 1), a && (y[p++] = M, y[p++] = x), y[p++] = w + m, y[p++] = b, y[p++] = 0, o && (y[p++] = T, y[p++] = S, y[p++] = C, y[p++] = 1), a && (y[p++] = M + _, y[p++] = x), y[p++] = w, y[p++] = b + g, y[p++] = 0, o && (y[p++] = T, y[p++] = S, y[p++] = C, y[p++] = 1), a && (y[p++] = M, y[p++] = x + v), y[p++] = w + m, y[p++] = b + g, y[p++] = 0, o && (y[p++] = T, y[p++] = S, y[p++] = C, y[p++] = 1), a && (y[p++] = M + _, y[p++] = x + v)
                }
            }
            for (p = 0, f = 0; t - 1 > f; f++)
                for (c = 0; e - 1 > c; c++) {
                    var E = 4 * (f * (e - 1) + c),
                        k = E + 1,
                        L = E + 2,
                        P = E + 3;
                    s._indexArray[p++] = E, s._indexArray[p++] = k, s._indexArray[p++] = L, s._indexArray[p++] = L, s._indexArray[p++] = k, s._indexArray[p++] = P
                }
            return s.needsRebuildWebGLBuffer(), s
        }, n.prototype.createWebGLVertexAttributes = function(e) {
            this.geometry.__webglAttributeBuffers.position || (this.geometry.__webglAttributeBuffers.position = e._gl.createBuffer()), this.geometry._colorArray && !this.geometry.__webglAttributeBuffers.color && (this.geometry.__webglAttributeBuffers.color = e._gl.createBuffer()), this.geometry._uvArray && !this.geometry.__webglAttributeBuffers.uv && (this.geometry.__webglAttributeBuffers.uv = e._gl.createBuffer()), this.geometry._indexArray && !this.geometry.__webglIndexBuffer && (this.geometry.__webglIndexBuffer = e._gl.createBuffer())
        }, n.prototype.uploadVertexData = function(e) {
            this.createWebGLVertexAttributes(e), e.setBufferData(this.geometry._positionArray, this.geometry.__webglAttributeBuffers.position, e._gl.STATIC_DRAW), this.geometry._colorArray && e.setBufferData(this.geometry._colorArray, this.geometry.__webglAttributeBuffers.color, e._gl.STATIC_DRAW), this.geometry._uvArray && e.setBufferData(this.geometry._uvArray, this.geometry.__webglAttributeBuffers.uv, e._gl.STATIC_DRAW), this.geometry._indexArray && (e._gl.bindBuffer(this._gl.ELEMENT_ARRAY_BUFFER, this.geometry.__webglIndexBuffer), e._gl.bufferData(this._gl.ELEMENT_ARRAY_BUFFER, this.geometry._indexArray, e._gl.STATIC_DRAW), e.setBufferData(this.geometry._uvArray, this.geometry.__webglAttributeBuffers.uv, e._gl.STATIC_DRAW))
        }, n.prototype.dispose = function(e) {
            e.deallocateGeometry(this.geometry), this.geometry = null
        }, n.prototype.createMesh = function(e, t, i) {
            (null == this.mesh || this.materialName != i) && (this.materialName = i, this.material = this.createMaterial(e, t, i), this.mesh = new o(this.geometry, this.material), this.mesh.updateMatrix())
        }, n.prototype.createMaterial = function(e, t, i) {
            i = i ? i : "renderSimpleColor";
            for (var n = t.createMaterial(i); n.program.building;) e.endBuildPrograms();
            return n
        }
    }, {
        "../../object/Geometry": 68,
        "../../object/Mesh": 69
    }],
    86: [function(e, t, i) {
        "use strict";

        function n(t, i) {
            this._webGL = t, this._shaderLibrary = i, this.materials = [], this._vertexHeader = e("./shaders/header.vshader"), this._fragmentHeader = e("./shaders/header.fshader"), this._precisions = this._webGL.queryPrecisionHeaderString()
        }
        var r = e("underscore"),
            o = e("../../Constants"),
            a = e("../../material/Material");
        t.exports = n, n.prototype.dispose = function() {
            for (var e = 0; e < this.materials.length; e++) {
                var t = this.materials.pop();
                this.releaseMaterial(t)
            }
        }, n.prototype.define = function(e, t) {
            t === !0 ? this._defines += "#define " + e + "\n" : t !== !1 && (this._defines += "#define " + e + " " + t + "\n")
        }, n.prototype.cloneUniforms = function(e) {
            var t, i, n, r = {};
            for (t in e) {
                r[t] = {};
                for (i in e[t]) n = e[t][i], n && n.clone ? r[t][i] = n.clone() : r[t][i] = n
            }
            return r
        }, n.prototype.releaseMaterial = function(e) {
            var t = this.materials.indexOf(e);
            if (t >= 0) {
                var i = this.materials[t];
                this.materials.splice(t, 1), i.program && this._webGL.releaseProgram(i.program)
            }
        }, n.prototype.findEffect = function(e) {
            var t = this._shaderLibrary.effects[e];
            if (null == t) {
                var i = e.split("_"),
                    n = [],
                    o = i.shift();
                r.each(i, function(e) {
                    var t = this._shaderLibrary.extensions[e];
                    t ? n.push(t) : o += "_" + e
                }, this);
                var a = this._shaderLibrary.effects[o];
                a && (t = r.pick(a, "vertexProgramName", "fragmentProgramName", "commonUniformKeys", "vertexDefines", "fragmentDefines"), a.uniforms && (t.uniforms = this.cloneUniforms(a.uniforms)), a.attributes && (t.attributes = r.clone(a.attributes)), r.each(n, function(e) {
                    e.commonUniformKeys && (t.commonUniformKeys = (t.commonUniformKeys || []).concat(e.commonUniformKeys)), e.uniforms && (t.uniforms = r.extend(t.uniforms || {}, this.cloneUniforms(e.uniforms))),
                        e.attributes && (t.attributes = r.extend(t.attributes || {}, e.attributes)), e.vertexDefines && (t.vertexDefines = t.vertexDefines ? t.vertexDefines + "\n" + e.vertexDefines : e.vertexDefines), e.fragmentDefines && (t.fragmentDefines = t.fragmentDefines ? t.fragmentDefines + "\n" + e.fragmentDefines : e.fragmentDefines)
                }, this), this._shaderLibrary.effects[e] = t)
            }
            return t
        }, n.prototype.initCommonUniforms = function(e) {
            if (!e.commonUniforms) {
                var t = e.commonUniforms = {};
                e.commonUniformKeys && r.each(e.commonUniformKeys, function(e) {
                    r.extend(t, this._shaderLibrary.uniforms[e])
                }, this)
            }
        }, n.prototype.buildEffectCode = function(e, t) {
            if (!e.vertexCode) {
                var i = this._shaderLibrary.programs.vertex[e.vertexProgramName];
                e.vertexCode = "//" + t + "\n" + this._precisions + "\n" + (e.vertexDefines || "") + "\n" + this._vertexHeader + "\n" + i
            }
            if (!e.fragmentCode) {
                var n = this._shaderLibrary.programs.fragment[e.fragmentProgramName];
                e.fragmentCode = this._precisions + "\n" + (e.fragmentDefines || "") + this._fragmentHeader + "\n" + n
            }
        }, n.prototype.createMaterial = function(e, t) {
            null == t && (t = o.NormalBlending);
            var i = this.findEffect(e);
            if (null == i) return console.error("Requested shader does not exist : ", e), null;
            var n = this.cloneUniforms(i.uniforms);
            this.initCommonUniforms(i), this.buildEffectCode(i, e);
            var r = {
                    effectName: e,
                    uniforms: n,
                    shader: i,
                    blending: t
                },
                s = new a(r);
            return this._webGL.initMaterial(s), this.materials.push(s), s
        }
    }, {
        "../../Constants": 14,
        "../../material/Material": 31,
        "./shaders/header.fshader": 89,
        "./shaders/header.vshader": 90,
        underscore: 207
    }],
    87: [function(e, t, i) {
        "use strict";

        function n() {
            this.uniforms = {
                cameraPos: {
                    cameraPosition: {
                        type: "v3",
                        value: null
                    },
                    cameraTarget: {
                        type: "v3",
                        value: null
                    }
                },
                time: {
                    currentTime: {
                        type: "f",
                        value: 0
                    }
                },
                viewport: {
                    viewport: {
                        type: "v4",
                        value: new o
                    }
                },
                screenSize: {
                    screenSize: {
                        type: "v2",
                        value: new r
                    },
                    pixelRatio: {
                        type: "f",
                        value: 1
                    }
                }
            }, this.programs = {
                vertex: {
                    renderSimpleColor: e("./shaders/renderSimpleColor.vshader"),
                    mandelbrot: e("./shaders/mandelbrot.vshader")
                },
                fragment: {
                    renderSimpleColor: e("./shaders/renderSimpleColor.fshader"),
                    mandelbrot: e("./shaders/mandelbrot.fshader")
                }
            }, this.effects = {
                renderSimpleColor: {
                    uniforms: {},
                    vertexProgramName: "renderSimpleColor",
                    fragmentProgramName: "renderSimpleColor"
                },
                mandelbrot: {
                    uniforms: {
                        offset: {
                            type: "v2",
                            value: new r
                        },
                        scale: {
                            type: "f",
                            value: 1
                        }
                    },
                    vertexProgramName: "mandelbrot",
                    fragmentProgramName: "mandelbrot"
                }
            }
        }
        var r = e("../../math/Vector2"),
            o = e("../../math/Quaternion");
        t.exports = n
    }, {
        "../../math/Quaternion": 61,
        "../../math/Vector2": 62,
        "./shaders/mandelbrot.fshader": 91,
        "./shaders/mandelbrot.vshader": 92,
        "./shaders/renderSimpleColor.fshader": 93,
        "./shaders/renderSimpleColor.vshader": 94
    }],
    88: [function(e, t, i) {
        "use strict";

        function n() {
            this._testConfig = {}, this._testConfig[_] = {
                setup: this._testVertexBufferUploadSetup,
                test: this._testVertexBufferUpload,
                teardown: this._testVertexBufferUploadTeardown,
                params: [64, 128, 256],
                benchmarks: [3, 70],
                benchmarkSizeScaling: !1,
                weight: .5,
                useTestSetupCache: !1
            }, this._testConfig[v] = {
                setup: this._testTextureUploadSetup,
                test: this._testTextureUpload,
                teardown: this._testTextureUploadTeardown,
                params: [512, 1024, 2048],
                benchmarks: [15, 100],
                benchmarkSizeScaling: !1,
                weight: .5,
                useTestSetupCache: !1
            }, this._testConfig[w] = {
                setup: this._testRenderLowPolySetup,
                test: this._testRenderPoly,
                teardown: this._testRenderPolyTeardown,
                params: [256, 1024, 4096],
                benchmarks: [25, 350],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !1
            }, this._testConfig[M] = {
                setup: this._testRenderIndexedLowPolySetup,
                test: this._testRenderPoly,
                teardown: this._testRenderPolyTeardown,
                params: [256, 1024, 4096],
                benchmarks: [25, 350],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !1
            }, this._testConfig[y] = {
                setup: this._testRenderHighPolySetup,
                test: this._testRenderPoly,
                teardown: this._testRenderPolyTeardown,
                params: [16],
                benchmarks: [10, 200],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !0
            }, this._testConfig[T] = {
                setup: this._testRenderIndexedHighPolySetup,
                test: this._testRenderPoly,
                teardown: this._testRenderPolyTeardown,
                params: [16],
                benchmarks: [10, 200],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !0
            }, this._testConfig[S] = {
                setup: this._testRenderIndexedInterleavedHighPolySetup,
                test: this._testRenderPoly,
                teardown: this._testRenderPolyTeardown,
                params: [16],
                benchmarks: [10, 200],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !0
            }, this._testConfig[b] = {
                setup: this._testFragmentShaderSetup,
                test: this._testFragmentShader,
                teardown: this._testFragmentShaderTeardown,
                params: [128, 512, 1024],
                benchmarks: [15, 60],
                benchmarkSizeScaling: !0,
                weight: 1.5,
                useTestSetupCache: !1
            }, this._testConfig[x] = {
                setup: this._testReadPixelSetup,
                test: this._testReadPixel,
                teardown: this._testReadPixelTeardown,
                params: [1, 16, 256],
                benchmarks: [10, 30],
                benchmarkSizeScaling: !1,
                weight: 1,
                useTestSetupCache: !1
            }, this._shaderLibrary = new s, this._shaderHandler = null
        }
        var r = e("underscore"),
            o = e("./TestSceneObject"),
            a = e("../../object/Geometry"),
            s = e("./TestShaderLibrary"),
            l = e("./TestShaderHandler"),
            h = e("../../WebGLRenderer"),
            u = e("../../texture/Texture"),
            d = e("../../Constants"),
            c = e("../../camera/OrthographicCamera"),
            f = e("../../math/Vector3"),
            p = e("../../math/Matrix4"),
            m = e("../../RenderTarget");
        e("../requestAnimationFramePolyfill");
        var g = window.performance && window.performance.now ? window.performance : Date;
        t.exports = n;
        var _ = "vertex_buffer_upload",
            v = "texture_upload",
            y = "render_high_poly",
            b = "fragment_shader",
            x = "pixel_read",
            w = "render_low_poly",
            M = "render_indexed_low_poly",
            T = "render_indexed_high_poly",
            S = "render_indexed_interleaved_high_poly";
        n.prototype.getWebGLRenderer = function(e, t) {
            if (t) return t;
            try {
                var i = r.defaults(e.webGLParameters || {}, {
                    useDevicePixelRatio: !1
                });
                return i.forceRenderCallback = r.bind(this._forceRender, this), new h(i)
            } catch (n) {
                return null
            }
        }, n.prototype.calculate = function(e, t, i) {
            var n = {
                width: 1024,
                height: 1024
            };
            return this._parameters = r.defaults(e || {}, {
                size: n,
                fixedSize: n,
                renderToTexture: !0,
                lastOnly: !0,
                skipIfSlow: !0,
                numberOfTestIterations: 5,
                verbose: !1,
                testList: [_, v, y, b, x]
            }), this._testsEndedCallback = t, this._webGL = this.getWebGLRenderer(this._parameters, i), null == this._webGL ? void this._testsEndedCallback(new Error("WebGL not available"), null) : (this._webGL.setSize(this._parameters.fixedSize.width, this._parameters.fixedSize.height), this._shaderHandler = new l(this._webGL, this._shaderLibrary), this._testList = this._parameters.testList, this._currentTestIndex = 0, this._currentTestParamIndex = 0, this._currentTestIteration = 0, this._testResults = [], this._currentTestResult = null, this._currentTestParamResult = null, this._deviceSettings = {
                size: {
                    width: this._webGL._canvas.width,
                    height: this._webGL._canvas.height
                },
                glVersion: this._webGL.glInfo.VERSION
            }, this._benchmarkSizeScalingFactor = this._parameters.size.width / this._parameters.fixedSize.width * (this._parameters.size.height / this._parameters.fixedSize.height), this._isAborted = !1, this._testStartTime = g.now(), this._testSetupCache = {
                config: null,
                teardown: null
            }, this._useTestSetupCache = !1, void requestAnimationFrame(r.bind(this._runTest, this)))
        }, n.prototype.abort = function() {
            this._isAborted = !0, this._webGL && (this._webGL = null, this._testsEndedCallback(new Error("aborted"), null))
        }, n.prototype._runTest = function() {
            if (!this._isAborted) {
                var e = this._testList[this._currentTestIndex],
                    t = this._testConfig[e].test,
                    i = this._testConfig[e].params;
                this._useTestSetupCache = this._testConfig[e].useTestSetupCache, this._parameters.lastOnly && (this._currentTestParamIndex = i.length - 1);
                var n = i[this._currentTestParamIndex];
                if (t) {
                    null == this._currentTestResult && (this._currentTestResult = {
                        testName: e,
                        testData: []
                    }, this._testResults.push(this._currentTestResult)), null == this._currentTestParamResult && (this._currentTestParamResult = {
                        param: n,
                        raw: [],
                        mean: 0
                    }, this._currentTestResult.testData.push(this._currentTestParamResult)), this._parameters.verbose && console.log("Running " + this._testList[this._currentTestIndex] + "(" + n + ")");
                    var r = {},
                        o = this._testConfig[e].setup;
                    o && (r = o.apply(this, [n]));
                    var a = g.now();
                    t.apply(this, [n, r]), this._webGL._gl.flush();
                    var s = new Uint8Array(4);
                    this._webGL._gl.readPixels(0, 0, 1, 1, d.RGBAFormat, d.UnsignedByteType, s), this._webGL._gl.getError();
                    var l = g.now(),
                        h = l - a,
                        u = this._currentTestParamResult.mean,
                        c = this._currentTestParamResult.raw.length;
                    u = (u * c + h) / (c + 1), this._currentTestParamResult.mean = u, this._currentTestParamResult.raw.push(h);
                    var f = this._testConfig[e].teardown;
                    f && f.apply(this, [r])
                } else console.log("No test for " + this._testList[this._currentTestIndex]), this._currentTestParamIndex = this._testConfig[e].params.length;
                this._onTestTerminated()
            }
        }, n.prototype._onTestTerminated = function() {
            var e = this._testList[this._currentTestIndex],
                t = this._testConfig[e].params;
            this._currentTestIteration++;
            var i = !1,
                n = this._currentTestParamResult.mean;
            if (this._currentTestIteration >= this._parameters.numberOfTestIterations) this._currentTestParamIndex++, this._currentTestIteration = 0, this._currentTestParamResult = null, i = !0;
            else if (n > this._testConfig[e].benchmarks[1] && this._parameters.skipIfSlow) {
                for (var o = this._currentTestIteration; o < this._parameters.numberOfTestIterations; o++) this._currentTestParamResult.raw.push(-1);
                this._currentTestParamIndex++, this._currentTestIteration = 0, this._currentTestParamResult = null, i = !0
            }
            if (this._currentTestParamIndex >= t.length) {
                var a = this._testConfig[e].benchmarks[1],
                    s = this._testConfig[e].benchmarks[0],
                    l = 10 * (a - n) / (a - s);
                l = Math.min(10, Math.max(0, l)), this._currentTestResult.benchmarkScore = l, this._currentTestIndex++, this._currentTestParamIndex = 0, this._currentTestResult = null
            }
            i && this._testSetupCache.teardown && (this._useTestSetupCache = !1, this._testSetupCache.teardown(), this._testSetupCache.config = null, this._testSetupCache.teardown = null), this._currentTestIndex >= this._testList.length ? this._onAllTestsTerminated() : requestAnimationFrame(r.bind(this._runTest, this))
        }, n.prototype._onAllTestsTerminated = function() {
            this._shaderHandler && (this._shaderHandler.dispose(), this._shaderHandler = null), this._testEndTime = g.now();
            for (var e = 0, t = 0, i = 0; i < this._testResults.length; i++) {
                var n = this._testResults[i].testName,
                    r = this._testConfig[n].weight;
                e += this._testResults[i].benchmarkScore * r, t += r
            }
            e /= t;
            var o = {
                parameters: this._parameters,
                deviceSettings: this._deviceSettings,
                results: this._testResults,
                benchmarkScore: e,
                duration: this._testEndTime - this._testStartTime
            };
            this._webGL = null, this._testsEndedCallback(null, o)
        }, n.prototype._testVertexBufferUploadSetup = function(e) {
            var t = e,
                i = e,
                n = new a,
                r = (t - 1) * (i - 1) * 6;
            return n._positionArray = new Float32Array(3 * r), n.__isPositionDirty = !0, n.setPointsCount(r), n.needsRebuildWebGLBuffer(), n.__webglAttributeBuffers = {}, {
                geometry: n
            }
        }, n.prototype._testVertexBufferUpload = function(e, t) {
            var i = t.geometry;
            i.__webglAttributeBuffers.position = this._webGL._gl.createBuffer(), this._webGL.setBufferData(i._positionArray, i.__webglAttributeBuffers.position, this._webGL._gl.STATIC_DRAW)
        }, n.prototype._testVertexBufferUploadTeardown = function(e) {
            var t = e.geometry;
            this._webGL.deallocateGeometry(t)
        }, n.prototype._testTextureUploadSetup = function(e) {
            var t = e,
                i = e,
                n = new Uint8Array(t * i * 4),
                r = new u;
            return r.magFilter = d.NearestFilter, r.minFilter = d.NearestFilter, r.generateMipmaps = !1, r.loadedName = t + "x" + i, r.array = {
                width: t,
                height: i,
                value: n
            }, r.needsUpdate = !0, {
                texture: r
            }
        }, n.prototype._testTextureUpload = function(e, t) {
            var i = t.texture;
            this._webGL.setTexture(i, 0)
        }, n.prototype._testTextureUploadTeardown = function(e) {
            var t = e.texture;
            this._webGL.deallocateTexture(t)
        }, n.prototype._testRenderLowPolySetup = function() {
            return this._testRenderPolySetup(16, 16, !1, !1)
        }, n.prototype._testRenderIndexedLowPolySetup = function() {
            return this._testRenderPolySetup(16, 16, !0, !1)
        }, n.prototype._testRenderHighPolySetup = function() {
            return this._testRenderPolySetup(128, 128, !1, !1)
        }, n.prototype._testRenderIndexedHighPolySetup = function() {
            return this._testRenderPolySetup(128, 128, !0, !1)
        }, n.prototype._testRenderIndexedInterleavedHighPolySetup = function() {
            return this._testRenderPolySetup(128, 128, !0, !0)
        }, n.prototype._testRenderPolySetup = function(e, t, i, n) {
            if (this._useTestSetupCache && this._testSetupCache.config) return this._testSetupCache.config;
            var a = -this._parameters.fixedSize.width,
                s = this._parameters.fixedSize.width,
                l = -this._parameters.fixedSize.height,
                h = this._parameters.fixedSize.height,
                u = new c(a, s, h, l, 1, 1e4),
                d = new f,
                p = new f(0, 0, 100);
            u.lookAt(d), u.position = p, u.updateMatrix(), this._webGL.setCamera(u);
            var g = 100,
                _ = 100,
                v = new o(e, t, g, _, !0, !0, i, n);
            v.createMesh(this._webGL, this._shaderHandler), this._webGL.updateObject(v.mesh);
            var y = null;
            this._parameters.renderToTexture && (y = new m(this._parameters.fixedSize.width * this._webGL._pixelRatio, this._parameters.fixedSize.height * this._webGL._pixelRatio)), this._webGL.setAndClearRenderTarget(y);
            var b = {
                sceneObject: v,
                renderTarget: y
            };
            return this._useTestSetupCache && (this._testSetupCache.config = b, this._testSetupCache.teardown = r.bind(function() {
                this._testRenderPolyTeardown(b)
            }, this)), b
        }, n.prototype._testRenderPoly = function(e, t) {
            for (var i = t.sceneObject, n = -this._parameters.fixedSize.width + .5 * i.width, r = this._parameters.fixedSize.width - .5 * i.width, o = -this._parameters.fixedSize.height + .5 * i.height, a = this._parameters.fixedSize.height - .5 * i.height, s = 0; e > s; s++) {
                var l = n + Math.random() * (r - n),
                    h = o + Math.random() * (a - o);
                i.mesh.position.x = l, i.mesh.position.y = h, i.mesh.updateMatrix(), this._webGL.renderObject(i.mesh)
            }
        }, n.prototype._testRenderPolyTeardown = function(e) {
            if (!this._useTestSetupCache) {
                var t = e.sceneObject,
                    i = e.renderTarget;
                t.dispose(this._webGL), this._webGL.deallocateRenderTarget(i)
            }
        }, n.prototype._testFragmentShaderSetup = function(e) {
            if (this._useTestSetupCache && this._testSetupCache.config) return this._testSetupCache.config;
            var t = new p;
            t.flattenToArray(this._webGL._projectionMatrix, 0), t.flattenToArray(this._webGL._viewMatrix, 0);
            var i = new o(2, 2, 2, 2);
            i.createMesh(this._webGL, this._shaderHandler, "mandelbrot"), i.material.uniforms.offset.value.x = -.749, i.material.uniforms.offset.value.y = .1, i.material.uniforms.scale.value = .001, this._webGL.updateObject(i.mesh);
            var n = null;
            this._parameters.renderToTexture ? n = new m(e * this._webGL._pixelRatio, e * this._webGL._pixelRatio) : this._webGL.setSize(e, e), this._webGL.setAndClearRenderTarget(n);
            var a = {
                sceneObject: i,
                renderTarget: n
            };
            return this._useTestSetupCache && (this._testSetupCache.config = a, this._testSetupCache.teardown = r.bind(function() {
                this._testFragmentShaderTeardown(a)
            }, this)), a
        }, n.prototype._testFragmentShader = function(e, t) {
            var i = t.sceneObject;
            i.mesh.updateMatrix(), this._webGL.renderObject(i.mesh)
        }, n.prototype._testFragmentShaderTeardown = function(e) {
            if (!this._useTestSetupCache) {
                var t = e.sceneObject,
                    i = e.renderTarget;
                t.dispose(this._webGL), this._webGL.deallocateRenderTarget(i)
            }
        }, n.prototype._testReadPixelSetup = function(e) {
            var t = null;
            this._parameters.renderToTexture && (t = new m(this._parameters.fixedSize.width * this._webGL._pixelRatio, this._parameters.fixedSize.height * this._webGL._pixelRatio));
            var i = new Uint8Array(e * e * 4);
            return this._webGL.setAndClearRenderTarget(t), {
                pixelBuffer: i,
                renderTarget: t
            }
        }, n.prototype._testReadPixel = function(e, t) {
            var i = t.pixelBuffer;
            this._webGL._gl.readPixels(0, 0, e, e, d.RGBAFormat, d.UnsignedByteType, i)
        }, n.prototype._testReadPixelTeardown = function(e) {
            var t = e.renderTarget;
            this._webGL.deallocateRenderTarget(t)
        }, n.prototype._forceRender = function() {}
    }, {
        "../../Constants": 14,
        "../../RenderTarget": 18,
        "../../WebGLRenderer": 22,
        "../../camera/OrthographicCamera": 29,
        "../../math/Matrix4": 60,
        "../../math/Vector3": 63,
        "../../object/Geometry": 68,
        "../../texture/Texture": 74,
        "../requestAnimationFramePolyfill": 96,
        "./TestSceneObject": 85,
        "./TestShaderHandler": 86,
        "./TestShaderLibrary": 87,
        underscore: 207
    }],
    89: [function(e, t, i) {
        t.exports = "\n\n#ifdef USE_TIMER\nuniform float currentTime;\n#endif //USE_TIMER\n"
    }, {}],
    90: [function(e, t, i) {
        t.exports = "uniform mat4 viewMatrix;\nuniform mat4 objectMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 modelViewMatrix;\nattribute vec3 position;\nattribute vec3 normal;\n\nattribute vec2 uv;\nattribute vec4 color;\n\n#ifdef USE_TIMER\nuniform float currentTime;\n#endif //USE_TIMER\n\n"
    }, {}],
    91: [function(e, t, i) {
        t.exports = "varying vec2 v_c;\n\nvec4 getColor(float intensity) {\n\n    float frequency = 2.0 * 3.14159;\n\n    float r = sin(frequency * intensity * 2.0);\n    float g = sin(frequency * intensity * 4.0);\n    float b = sin(frequency * intensity * 6.0);\n\n    return vec4(r, g, b, 1.0);\n}\n\n\nvoid main() {\n    vec2 z = vec2(0.0);\n    int iIter;\n    const int MAX_ITER = 100;\n    float ESCAPE_RADIUS = 16.0;\n\n    for (int i = 0; i < MAX_ITER; i++) {\n        iIter = i;\n        float x = (z.x * z.x - z.y * z.y) + v_c.x;\n        float y = (z.y * z.x + z.x * z.y) + v_c.y;\n\n        if ((x * x + y * y) > ESCAPE_RADIUS) break;\n        z.x = x;\n        z.y = y;\n    }\n\n    float speed;\n    if (iIter == MAX_ITER) {\n        speed = 0.0;\n    } else {\n        speed = float(iIter) / float(MAX_ITER);\n    }\n\n    gl_FragColor = getColor(speed);\n}\n\n\n"
    }, {}],
    92: [function(e, t, i) {
        t.exports = "varying vec2 v_c;\n\nuniform vec2 offset;\nuniform float scale;\n\nvoid main() {\n    v_c = scale * position.xy + offset;\n    gl_Position = vec4(position, 1.0);\n}\n"
    }, {}],
    93: [function(e, t, i) {
        t.exports = "varying vec4 v_color;\nvarying vec2 v_uv;\n\nvoid main() {\n    gl_FragColor = vec4(v_color.r * v_uv.x, v_color.g, v_color.b * v_uv.y, v_color.a);\n}\n"
    }, {}],
    94: [function(e, t, i) {
        t.exports = "varying vec4 v_color;\nvarying vec2 v_uv;\n\nvoid main() {\n    vec3 pos = position;\n    v_color = color;\n    v_uv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n}\n"
    }, {}],
    95: [function(e, t, i) {
        "use strict";
        Math.sign = Math.sign || function(e) {
            return e = +e, 0 === e || isNaN(e) ? Number(e) : e > 0 ? 1 : -1
        }
    }, {}],
    96: [function(e, t, i) {
        "use strict";
        ! function() {
            for (var e = 0, t = ["ms", "moz", "webkit", "o"], i = 0; i < t.length && !window.requestAnimationFrame; ++i) window.requestAnimationFrame = window[t[i] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[t[i] + "CancelAnimationFrame"] || window[t[i] + "CancelRequestAnimationFrame"];
            window.requestAnimationFrame || (window.requestAnimationFrame = function(t) {
                var i = (new Date).getTime(),
                    n = Math.max(0, 16 - (i - e)),
                    r = window.setTimeout(function() {
                        t(i + n)
                    }, n);
                return e = i + n, r
            }), window.cancelAnimationFrame || (window.cancelAnimationFrame = function(e) {
                clearTimeout(e)
            })
        }()
    }, {}],
    97: [function(e, t, i) {
        "use strict";
        t.exports = {
            Color: e("./src/Color"),
            MathHelper: e("./src/utils/MathHelper"),
            VectorUtils: e("./src/utils/VectorUtils"),
            ShapeUtils: e("./src/utils/ShapeUtils"),
            TriangulationUtils: e("./src/utils/TriangulationUtils"),
            SkeletonUtils: e("./src/utils/SkeletonUtils"),
            Vector2: e("./src/math/Vector2"),
            Vector3: e("./src/math/Vector3"),
            WebGLExtensionManager: e("./src/utils/WebGLExtensionManager")
        }
    }, {
        "./src/Color": 13,
        "./src/math/Vector2": 62,
        "./src/math/Vector3": 63,
        "./src/utils/MathHelper": 78,
        "./src/utils/ShapeUtils": 80,
        "./src/utils/SkeletonUtils": 81,
        "./src/utils/TriangulationUtils": 82,
        "./src/utils/VectorUtils": 83,
        "./src/utils/WebGLExtensionManager": 84
    }],
    98: [function(e, t, i) {
        (function(i, n) {
            (function() {
                "use strict";

                function r(e) {
                    return "function" == typeof e || "object" == typeof e && null !== e
                }

                function o(e) {
                    return "function" == typeof e
                }

                function a(e) {
                    return "object" == typeof e && null !== e
                }

                function s(e) {
                    q = e
                }

                function l(e) {
                    K = e
                }

                function h() {
                    return function() {
                        i.nextTick(p)
                    }
                }

                function u() {
                    return function() {
                        j(p)
                    }
                }

                function d() {
                    var e = 0,
                        t = new Q(p),
                        i = document.createTextNode("");
                    return t.observe(i, {
                            characterData: !0
                        }),
                        function() {
                            i.data = e = ++e % 2
                        }
                }

                function c() {
                    var e = new MessageChannel;
                    return e.port1.onmessage = p,
                        function() {
                            e.port2.postMessage(0)
                        }
                }

                function f() {
                    return function() {
                        setTimeout(p, 1)
                    }
                }

                function p() {
                    for (var e = 0; Y > e; e += 2) {
                        var t = te[e],
                            i = te[e + 1];
                        t(i), te[e] = void 0, te[e + 1] = void 0
                    }
                    Y = 0
                }

                function m() {
                    try {
                        var t = e,
                            i = t("vertx");
                        return j = i.runOnLoop || i.runOnContext, u()
                    } catch (n) {
                        return f()
                    }
                }

                function g() {}

                function _() {
                    return new TypeError("You cannot resolve a promise with itself")
                }

                function v() {
                    return new TypeError("A promises callback cannot return that same promise.")
                }

                function y(e) {
                    try {
                        return e.then
                    } catch (t) {
                        return oe.error = t, oe
                    }
                }

                function b(e, t, i, n) {
                    try {
                        e.call(t, i, n)
                    } catch (r) {
                        return r
                    }
                }

                function x(e, t, i) {
                    K(function(e) {
                        var n = !1,
                            r = b(i, t, function(i) {
                                n || (n = !0, t !== i ? T(e, i) : C(e, i))
                            }, function(t) {
                                n || (n = !0, E(e, t))
                            }, "Settle: " + (e._label || " unknown promise"));
                        !n && r && (n = !0, E(e, r))
                    }, e)
                }

                function w(e, t) {
                    t._state === ne ? C(e, t._result) : t._state === re ? E(e, t._result) : k(t, void 0, function(t) {
                        T(e, t)
                    }, function(t) {
                        E(e, t)
                    })
                }

                function M(e, t) {
                    if (t.constructor === e.constructor) w(e, t);
                    else {
                        var i = y(t);
                        i === oe ? E(e, oe.error) : void 0 === i ? C(e, t) : o(i) ? x(e, t, i) : C(e, t)
                    }
                }

                function T(e, t) {
                    e === t ? E(e, _()) : r(t) ? M(e, t) : C(e, t)
                }

                function S(e) {
                    e._onerror && e._onerror(e._result), L(e)
                }

                function C(e, t) {
                    e._state === ie && (e._result = t, e._state = ne, 0 !== e._subscribers.length && K(L, e))
                }

                function E(e, t) {
                    e._state === ie && (e._state = re, e._result = t, K(S, e))
                }

                function k(e, t, i, n) {
                    var r = e._subscribers,
                        o = r.length;
                    e._onerror = null, r[o] = t, r[o + ne] = i, r[o + re] = n, 0 === o && e._state && K(L, e)
                }

                function L(e) {
                    var t = e._subscribers,
                        i = e._state;
                    if (0 !== t.length) {
                        for (var n, r, o = e._result, a = 0; a < t.length; a += 3) n = t[a], r = t[a + i], n ? R(i, n, r, o) : r(o);
                        e._subscribers.length = 0
                    }
                }

                function P() {
                    this.error = null
                }

                function A(e, t) {
                    try {
                        return e(t)
                    } catch (i) {
                        return ae.error = i, ae
                    }
                }

                function R(e, t, i, n) {
                    var r, a, s, l, h = o(i);
                    if (h) {
                        if (r = A(i, n), r === ae ? (l = !0, a = r.error, r = null) : s = !0, t === r) return void E(t, v())
                    } else r = n, s = !0;
                    t._state !== ie || (h && s ? T(t, r) : l ? E(t, a) : e === ne ? C(t, r) : e === re && E(t, r))
                }

                function D(e, t) {
                    try {
                        t(function(t) {
                            T(e, t)
                        }, function(t) {
                            E(e, t)
                        })
                    } catch (i) {
                        E(e, i)
                    }
                }

                function I(e, t) {
                    var i = this;
                    i._instanceConstructor = e, i.promise = new e(g), i._validateInput(t) ? (i._input = t, i.length = t.length, i._remaining = t.length, i._init(), 0 === i.length ? C(i.promise, i._result) : (i.length = i.length || 0, i._enumerate(), 0 === i._remaining && C(i.promise, i._result))) : E(i.promise, i._validationError())
                }

                function O(e) {
                    return new se(this, e).promise
                }

                function N(e) {
                    function t(e) {
                        T(r, e)
                    }

                    function i(e) {
                        E(r, e)
                    }
                    var n = this,
                        r = new n(g);
                    if (!Z(e)) return E(r, new TypeError("You must pass an array to race.")), r;
                    for (var o = e.length, a = 0; r._state === ie && o > a; a++) k(n.resolve(e[a]), void 0, t, i);
                    return r
                }

                function B(e) {
                    var t = this;
                    if (e && "object" == typeof e && e.constructor === t) return e;
                    var i = new t(g);
                    return T(i, e), i
                }

                function F(e) {
                    var t = this,
                        i = new t(g);
                    return E(i, e), i
                }

                function z() {
                    throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")
                }

                function H() {
                    throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")
                }

                function U(e) {
                    this._id = ce++, this._state = void 0, this._result = void 0, this._subscribers = [], g !== e && (o(e) || z(), this instanceof U || H(), D(this, e))
                }

                function W() {
                    var e;
                    if ("undefined" != typeof n) e = n;
                    else if ("undefined" != typeof self) e = self;
                    else try {
                        e = Function("return this")()
                    } catch (t) {
                        throw new Error("polyfill failed because global object is unavailable in this environment")
                    }
                    var i = e.Promise;
                    (!i || "[object Promise]" !== Object.prototype.toString.call(i.resolve()) || i.cast) && (e.Promise = fe)
                }
                var G;
                G = Array.isArray ? Array.isArray : function(e) {
                    return "[object Array]" === Object.prototype.toString.call(e)
                };
                var j, q, V, Z = G,
                    Y = 0,
                    K = ({}.toString, function(e, t) {
                        te[Y] = e, te[Y + 1] = t, Y += 2, 2 === Y && (q ? q(p) : V())
                    }),
                    X = "undefined" != typeof window ? window : void 0,
                    $ = X || {},
                    Q = $.MutationObserver || $.WebKitMutationObserver,
                    J = "undefined" != typeof i && "[object process]" === {}.toString.call(i),
                    ee = "undefined" != typeof Uint8ClampedArray && "undefined" != typeof importScripts && "undefined" != typeof MessageChannel,
                    te = new Array(1e3);
                V = J ? h() : Q ? d() : ee ? c() : void 0 === X && "function" == typeof e ? m() : f();
                var ie = void 0,
                    ne = 1,
                    re = 2,
                    oe = new P,
                    ae = new P;
                I.prototype._validateInput = function(e) {
                    return Z(e)
                }, I.prototype._validationError = function() {
                    return new Error("Array Methods must be provided an Array")
                }, I.prototype._init = function() {
                    this._result = new Array(this.length)
                };
                var se = I;
                I.prototype._enumerate = function() {
                    for (var e = this, t = e.length, i = e.promise, n = e._input, r = 0; i._state === ie && t > r; r++) e._eachEntry(n[r], r)
                }, I.prototype._eachEntry = function(e, t) {
                    var i = this,
                        n = i._instanceConstructor;
                    a(e) ? e.constructor === n && e._state !== ie ? (e._onerror = null, i._settledAt(e._state, t, e._result)) : i._willSettleAt(n.resolve(e), t) : (i._remaining--, i._result[t] = e)
                }, I.prototype._settledAt = function(e, t, i) {
                    var n = this,
                        r = n.promise;
                    r._state === ie && (n._remaining--, e === re ? E(r, i) : n._result[t] = i), 0 === n._remaining && C(r, n._result)
                }, I.prototype._willSettleAt = function(e, t) {
                    var i = this;
                    k(e, void 0, function(e) {
                        i._settledAt(ne, t, e)
                    }, function(e) {
                        i._settledAt(re, t, e)
                    })
                };
                var le = O,
                    he = N,
                    ue = B,
                    de = F,
                    ce = 0,
                    fe = U;
                U.all = le, U.race = he, U.resolve = ue, U.reject = de, U._setScheduler = s, U._setAsap = l, U._asap = K, U.prototype = {
                    constructor: U,
                    then: function(e, t) {
                        var i = this,
                            n = i._state;
                        if (n === ne && !e || n === re && !t) return this;
                        var r = new this.constructor(g),
                            o = i._result;
                        if (n) {
                            var a = arguments[n - 1];
                            K(function() {
                                R(n, r, a, o)
                            })
                        } else k(i, r, e, t);
                        return r
                    },
                    "catch": function(e) {
                        return this.then(null, e)
                    }
                };
                var pe = W,
                    me = {
                        Promise: fe,
                        polyfill: pe
                    };
                "function" == typeof define && define.amd ? define(function() {
                    return me
                }) : "undefined" != typeof t && t.exports ? t.exports = me : "undefined" != typeof this && (this.ES6Promise = me), pe()
            }).call(this)
        }).call(this, e("_process"), window)
    }, {
        _process: 181
    }],
    99: [function(e, t, i) {
        function n() {
            this._events = this._events || {}, this._maxListeners = this._maxListeners || void 0
        }

        function r(e) {
            return "function" == typeof e
        }

        function o(e) {
            return "number" == typeof e
        }

        function a(e) {
            return "object" == typeof e && null !== e
        }

        function s(e) {
            return void 0 === e
        }
        t.exports = n, n.EventEmitter = n, n.prototype._events = void 0, n.prototype._maxListeners = void 0, n.defaultMaxListeners = 10, n.prototype.setMaxListeners = function(e) {
            if (!o(e) || 0 > e || isNaN(e)) throw TypeError("n must be a positive number");
            return this._maxListeners = e, this
        }, n.prototype.emit = function(e) {
            var t, i, n, o, l, h;
            if (this._events || (this._events = {}), "error" === e && (!this._events.error || a(this._events.error) && !this._events.error.length)) {
                if (t = arguments[1], t instanceof Error) throw t;
                var u = new Error('Uncaught, unspecified "error" event. (' + t + ")");
                throw u.context = t, u
            }
            if (i = this._events[e], s(i)) return !1;
            if (r(i)) switch (arguments.length) {
                case 1:
                    i.call(this);
                    break;
                case 2:
                    i.call(this, arguments[1]);
                    break;
                case 3:
                    i.call(this, arguments[1], arguments[2]);
                    break;
                default:
                    o = Array.prototype.slice.call(arguments, 1), i.apply(this, o)
            } else if (a(i))
                for (o = Array.prototype.slice.call(arguments, 1), h = i.slice(), n = h.length, l = 0; n > l; l++) h[l].apply(this, o);
            return !0
        }, n.prototype.addListener = function(e, t) {
            var i;
            if (!r(t)) throw TypeError("listener must be a function");
            return this._events || (this._events = {}), this._events.newListener && this.emit("newListener", e, r(t.listener) ? t.listener : t), this._events[e] ? a(this._events[e]) ? this._events[e].push(t) : this._events[e] = [this._events[e], t] : this._events[e] = t, a(this._events[e]) && !this._events[e].warned && (i = s(this._maxListeners) ? n.defaultMaxListeners : this._maxListeners, i && i > 0 && this._events[e].length > i && (this._events[e].warned = !0, console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.", this._events[e].length), "function" == typeof console.trace && console.trace())), this
        }, n.prototype.on = n.prototype.addListener, n.prototype.once = function(e, t) {
            function i() {
                this.removeListener(e, i), n || (n = !0, t.apply(this, arguments))
            }
            if (!r(t)) throw TypeError("listener must be a function");
            var n = !1;
            return i.listener = t, this.on(e, i), this
        }, n.prototype.removeListener = function(e, t) {
            var i, n, o, s;
            if (!r(t)) throw TypeError("listener must be a function");
            if (!this._events || !this._events[e]) return this;
            if (i = this._events[e], o = i.length, n = -1, i === t || r(i.listener) && i.listener === t) delete this._events[e], this._events.removeListener && this.emit("removeListener", e, t);
            else if (a(i)) {
                for (s = o; s-- > 0;)
                    if (i[s] === t || i[s].listener && i[s].listener === t) {
                        n = s;
                        break
                    }
                if (0 > n) return this;
                1 === i.length ? (i.length = 0, delete this._events[e]) : i.splice(n, 1), this._events.removeListener && this.emit("removeListener", e, t)
            }
            return this
        }, n.prototype.removeAllListeners = function(e) {
            var t, i;
            if (!this._events) return this;
            if (!this._events.removeListener) return 0 === arguments.length ? this._events = {} : this._events[e] && delete this._events[e], this;
            if (0 === arguments.length) {
                for (t in this._events) "removeListener" !== t && this.removeAllListeners(t);
                return this.removeAllListeners("removeListener"), this._events = {}, this
            }
            if (i = this._events[e], r(i)) this.removeListener(e, i);
            else if (i)
                for (; i.length;) this.removeListener(e, i[i.length - 1]);
            return delete this._events[e], this
        }, n.prototype.listeners = function(e) {
            var t;
            return t = this._events && this._events[e] ? r(this._events[e]) ? [this._events[e]] : this._events[e].slice() : []
        }, n.prototype.listenerCount = function(e) {
            if (this._events) {
                var t = this._events[e];
                if (r(t)) return 1;
                if (t) return t.length
            }
            return 0
        }, n.listenerCount = function(e, t) {
            return e.listenerCount(t)
        }
    }, {}],
    100: [function(e, t, i) {
        function n(e) {
            d.done(e)
        }

        function r(e) {
            return u ? u.apply(null, arguments) : "{" + e + "}"
        }

        function o(e, t) {
            s.isString(e) && (e = {
                language: e
            }), s.defaults(e, {
                ajaxGlobal: !1,
                ajaxCache: !0
            });
            var i = l.functions.ajax;
            l.functions.ajax = function(t) {
                t.global = e.ajaxGlobal, t.cache = e.ajaxCache, i.apply(this, arguments)
            };
            var n = e.language,
                r = {
                    fallbackLng: n,
                    lng: n
                };
            s.extend(r, h.i18next);
            var o = "translation",
                a = e.namespace || o;
            a == o ? r.ns = o : (r.ns = {
                namespaces: [a, o],
                defaultNs: a
            }, r.fallbackNS = [o]), l.init(r, function(e) {
                u = e, t && t(), d.resolve(e)
            })
        }
        var a = e("jquery"),
            s = e("underscore"),
            l = e("i18next/lib/dep/i18next"),
            h = e("fack/options");
        s.extend(i, {
            t: r,
            translate: r,
            init: o,
            ready: n
        });
        var u = null,
            d = a.Deferred()
    }, {
        "fack/options": 438,
        "i18next/lib/dep/i18next": 105,
        jquery: 111,
        underscore: 207
    }],
    101: [function(e, t, i) {
        function n(e) {
            return a(o("js", e))
        }

        function r(e) {
            return a(s.stylusSubDir + "/" + o("css", e))
        }

        function o(e, t) {
            return new RegExp("\\." + e + "$").test(t) ? t : t + "." + e
        }
        var a = e("./resourceUrl"),
            s = e("../lib/constants");
        t.exports = {
            resourceUrl: a,
            jsUrl: n,
            cssUrl: r,
            i18n: e("./i18n")
        }
    }, {
        "../lib/constants": 103,
        "./i18n": 100,
        "./resourceUrl": 102
    }],
    102: [function(e, t, i) {
        var n = e("../lib/constants"),
            r = e("fack/cacheforever");
        t.exports = function(e) {
            var t, i = r.fingerprints[e];
            return t = e && i ? n.foreverUrlPrefix + "/" + i : n.staticUrlPrefix, t + "/" + e
        }
    }, {
        "../lib/constants": 103,
        "fack/cacheforever": 437
    }],
    103: [function(e, t, i) {
        t.exports = {
            staticUrlPrefix: "/static",
            foreverUrlPrefix: "/cacheForever",
            stylusSubDir: "css"
        }
    }, {}],
    104: [function(e, t, n) {
        function r() {
            this.BITS = [16, 8, 4, 2, 1], this.MAX_PRECISION = 11, this.BASE32 = "0123456789bcdefghjkmnpqrstuvwxyz";
            var e = {
                    right: {
                        even: "bc01fg45238967deuvhjyznpkmstqrwx"
                    },
                    left: {
                        even: "238967debc01fg45kmstqrwxuvhjyznp"
                    },
                    top: {
                        even: "p0r21436x8zb9dcf5h7kjnmqesgutwvy"
                    },
                    bottom: {
                        even: "14365h7k9dcfesgujnmqp0r2twvyx8zb"
                    }
                },
                t = {
                    right: {
                        even: "bcfguvyz"
                    },
                    left: {
                        even: "0145hjnp"
                    },
                    top: {
                        even: "prxz"
                    },
                    bottom: {
                        even: "028b"
                    }
                };
            e.bottom.odd = e.left.even, e.top.odd = e.right.even, e.left.odd = e.bottom.even, e.right.odd = e.top.even, t.bottom.odd = t.left.even, t.top.odd = t.right.even, t.left.odd = t.bottom.even, t.right.odd = t.top.even, this.NEIGHBORS = e, this.BORDERS = t;
            var i = this.buildLengthToDimensionTables(this.MAX_PRECISION);
            this.latitudeHeights = i.latitudeHeights, this.longitudeWidths = i.longitudeWidths
        }
        r.prototype.refineInterval = function(e, t, i) {
            t & i ? e[0] = (e[0] + e[1]) / 2 : e[1] = (e[0] + e[1]) / 2
        }, r.prototype.encode = function(e, t) {
            var i = this,
                n = 1,
                r = [],
                o = [],
                a = 0,
                s = 0;
            for (geohash = "", r[0] = -90, r[1] = 90, o[0] = -180, o[1] = 180; geohash.length < i.MAX_PRECISION;) n ? (mid = (o[0] + o[1]) / 2, t > mid ? (s |= i.BITS[a], o[0] = mid) : o[1] = mid) : (mid = (r[0] + r[1]) / 2, e > mid ? (s |= i.BITS[a], r[0] = mid) : r[1] = mid), n = !n, 4 > a ? a++ : (geohash += i.BASE32[s], a = 0, s = 0);
            return geohash
        }, r.prototype.decode = function(e) {
            var t = this,
                n = 1,
                r = [],
                o = [];
            for (r[0] = -90, r[1] = 90, o[0] = -180, o[1] = 180, lat_err = 90, lon_err = 180, i = 0; i < e.length; i++)
                for (c = e[i], cd = t.BASE32.indexOf(c), j = 0; j < 5; j++) mask = t.BITS[j], n ? (lon_err /= 2, t.refineInterval(o, cd, mask)) : (lat_err /= 2, t.refineInterval(r, cd, mask)), n = !n;
            return r[2] = (r[0] + r[1]) / 2, o[2] = (o[0] + o[1]) / 2, {
                latitude: r,
                longitude: o
            }
        }, r.prototype.adjacent = function(e, t) {
            var i = this;
            e = e.toLowerCase();
            var n = e.charAt(e.length - 1),
                r = e.length % 2 ? "odd" : "even",
                o = e.substring(0, e.length - 1);
            return -1 != i.BORDERS[t][r].indexOf(n) && (o = i.adjacent(o, t)), o + i.BASE32[i.NEIGHBORS[t][r].indexOf(n)]
        }, r.prototype.neighbors = function(e) {
            var t = this,
                i = [],
                n = [
                    ["top", "right"],
                    ["right", "bottom"],
                    ["bottom", "left"],
                    ["left", "top"]
                ];
            return n.forEach(function(n) {
                var r = t.adjacent(e, n[0]);
                i.push(r), i.push(t.adjacent(r, n[1]))
            }), i
        }, r.prototype.buildLengthToDimensionTables = function(e) {
            var t = [],
                i = [];
            t[0] = 180, i[0] = 360;
            for (var n = !1, r = 1; e >= r; r++) t[r] = t[r - 1] / (n ? 8 : 4), i[r] = i[r - 1] / (n ? 4 : 8), n = !n;
            return {
                latitudeHeights: t,
                longitudeWidths: i
            }
        }, r.prototype.hashLength = function(e, t) {
            for (var i = this, n = !1, r = 1; r <= i.MAX_PRECISION; r++) {
                var o = i.latitudeHeights[r],
                    a = i.longitudeWidths[r];
                (t > o || e > a) && (n = r - 1, r = i.MAX_PRECISION)
            }
            return n ? n : i.MAX_PRECISION
        }, r.prototype.degreesSizeForHashLength = function(e) {
            return [this.latitudeHeights[e], this.longitudeWidths[e]]
        }, r.prototype.subs = function(e) {
            for (var t = this, i = [], n = 0; n < t.BASE32.length; n++) {
                var r = t.BASE32[n];
                i.push(e + r)
            }
            return i
        }, t.exports = new r
    }, {}],
    105: [function(e, t, i) {
        ! function() {
            function e(e, t) {
                if (!t || "function" == typeof t) return e;
                for (var i in t) e[i] = t[i];
                return e
            }

            function i(e, t, i) {
                var n, r = 0,
                    o = e.length,
                    a = void 0 === o || "[object Array]" !== Object.prototype.toString.apply(e) || "function" == typeof e;
                if (i)
                    if (a) {
                        for (n in e)
                            if (t.apply(e[n], i) === !1) break
                    } else
                        for (; o > r && t.apply(e[r++], i) !== !1;);
                else if (a) {
                    for (n in e)
                        if (t.call(e[n], n, e[n]) === !1) break
                } else
                    for (; o > r && t.call(e[r], r, e[r++]) !== !1;);
                return e
            }

            function n(e) {
                return "string" == typeof e ? e.replace(/[&<>"'\/]/g, function(e) {
                    return O[e]
                }) : e
            }

            function r(e) {
                var t = function(e) {
                        if (window.XMLHttpRequest) return e(null, new XMLHttpRequest);
                        if (window.ActiveXObject) try {
                            return e(null, new ActiveXObject("Msxml2.XMLHTTP"))
                        } catch (t) {
                            return e(null, new ActiveXObject("Microsoft.XMLHTTP"))
                        }
                        return e(new Error)
                    },
                    i = function(e) {
                        if ("string" == typeof e) return e;
                        var t = [];
                        for (var i in e) e.hasOwnProperty(i) && t.push(encodeURIComponent(i) + "=" + encodeURIComponent(e[i]));
                        return t.join("&")
                    },
                    n = function(e) {
                        e = e.replace(/\r\n/g, "\n");
                        for (var t = "", i = 0; i < e.length; i++) {
                            var n = e.charCodeAt(i);
                            128 > n ? t += String.fromCharCode(n) : n > 127 && 2048 > n ? (t += String.fromCharCode(n >> 6 | 192), t += String.fromCharCode(63 & n | 128)) : (t += String.fromCharCode(n >> 12 | 224), t += String.fromCharCode(n >> 6 & 63 | 128), t += String.fromCharCode(63 & n | 128))
                        }
                        return t
                    },
                    r = function(e) {
                        var t = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
                        e = n(e);
                        var i, r, o, a, s, l, h, u = "",
                            d = 0;
                        do i = e.charCodeAt(d++), r = e.charCodeAt(d++), o = e.charCodeAt(d++), a = i >> 2, s = (3 & i) << 4 | r >> 4, l = (15 & r) << 2 | o >> 6, h = 63 & o, isNaN(r) ? l = h = 64 : isNaN(o) && (h = 64), u += t.charAt(a) + t.charAt(s) + t.charAt(l) + t.charAt(h), i = r = o = "", a = s = l = h = ""; while (d < e.length);
                        return u
                    },
                    o = function() {
                        for (var e = arguments[0], t = 1; t < arguments.length; t++) {
                            var i = arguments[t];
                            for (var n in i) i.hasOwnProperty(n) && (e[n] = i[n])
                        }
                        return e
                    },
                    a = function(e, n, r, s) {
                        "function" == typeof r && (s = r, r = {}), r.cache = r.cache || !1, r.data = r.data || {}, r.headers = r.headers || {}, r.jsonp = r.jsonp || !1, r.async = void 0 === r.async ? !0 : r.async;
                        var l, h = o({
                            accept: "*/*",
                            "content-type": "application/x-www-form-urlencoded;charset=UTF-8"
                        }, a.headers, r.headers);
                        if (l = "application/json" === h["content-type"] ? JSON.stringify(r.data) : i(r.data), "GET" === e) {
                            var u = [];
                            if (l && (u.push(l), l = null), r.cache || u.push("_=" + (new Date).getTime()), r.jsonp && (u.push("callback=" + r.jsonp), u.push("jsonp=" + r.jsonp)), u = u.join("&"), u.length > 1 && (n += n.indexOf("?") > -1 ? "&" + u : "?" + u), r.jsonp) {
                                var d = document.getElementsByTagName("head")[0],
                                    c = document.createElement("script");
                                return c.type = "text/javascript", c.src = n, void d.appendChild(c)
                            }
                        }
                        t(function(t, i) {
                            if (t) return s(t);
                            i.open(e, n, r.async);
                            for (var o in h) h.hasOwnProperty(o) && i.setRequestHeader(o, h[o]);
                            i.onreadystatechange = function() {
                                if (4 === i.readyState) {
                                    var e = i.responseText || "";
                                    if (!s) return;
                                    s(i.status, {
                                        text: function() {
                                            return e
                                        },
                                        json: function() {
                                            return JSON.parse(e)
                                        }
                                    })
                                }
                            }, i.send(l)
                        })
                    },
                    s = {
                        authBasic: function(e, t) {
                            a.headers.Authorization = "Basic " + r(e + ":" + t)
                        },
                        connect: function(e, t, i) {
                            return a("CONNECT", e, t, i)
                        },
                        del: function(e, t, i) {
                            return a("DELETE", e, t, i)
                        },
                        get: function(e, t, i) {
                            return a("GET", e, t, i)
                        },
                        head: function(e, t, i) {
                            return a("HEAD", e, t, i)
                        },
                        headers: function(e) {
                            a.headers = e || {}
                        },
                        isAllowed: function(e, t, i) {
                            this.options(e, function(e, n) {
                                i(-1 !== n.text().indexOf(t))
                            })
                        },
                        options: function(e, t, i) {
                            return a("OPTIONS", e, t, i)
                        },
                        patch: function(e, t, i) {
                            return a("PATCH", e, t, i)
                        },
                        post: function(e, t, i) {
                            return a("POST", e, t, i)
                        },
                        put: function(e, t, i) {
                            return a("PUT", e, t, i)
                        },
                        trace: function(e, t, i) {
                            return a("TRACE", e, t, i)
                        }
                    },
                    l = e.type ? e.type.toLowerCase() : "get";
                s[l](e.url, e, function(t, i) {
                    200 === t ? e.success(i.json(), t, null) : e.error(i.text(), t, null)
                })
            }

            function o(e, t) {
                "function" == typeof e && (t = e, e = {}), e = e || {}, F.extend(I, e), delete I.fixLng, "string" == typeof I.ns && (I.ns = {
                    namespaces: [I.ns],
                    defaultNs: I.ns
                }), "string" == typeof I.fallbackNS && (I.fallbackNS = [I.fallbackNS]), ("string" == typeof I.fallbackLng || "boolean" == typeof I.fallbackLng) && (I.fallbackLng = [I.fallbackLng]), I.interpolationPrefixEscaped = F.regexEscape(I.interpolationPrefix), I.interpolationSuffixEscaped = F.regexEscape(I.interpolationSuffix), I.lng || (I.lng = F.detectLanguage()), I.lng ? I.useCookie && F.cookie.create(I.cookieName, I.lng, I.cookieExpirationTime, I.cookieDomain) : (I.lng = I.fallbackLng[0], I.useCookie && F.cookie.remove(I.cookieName)), R = F.toLanguages(I.lng), C = R[0], F.log("currentLng set to: " + C);
                var i = b;
                e.fixLng && (i = function(e, t) {
                    return t = t || {}, t.lng = t.lng || i.lng, b(e, t)
                }, i.lng = C), H.setCurrentLng(C), k && I.setJqueryExt && p();
                var n;
                if (k && k.Deferred && (n = k.Deferred()), !I.resStore) {
                    var r = F.toLanguages(I.lng);
                    "string" == typeof I.preload && (I.preload = [I.preload]);
                    for (var o = 0, a = I.preload.length; a > o; o++)
                        for (var s = F.toLanguages(I.preload[o]), l = 0, h = s.length; h > l; l++) r.indexOf(s[l]) < 0 && r.push(s[l]);
                    return L.sync.load(r, I, function(e, r) {
                        P = r, D = !0, t && t(i), n && n.resolve(i)
                    }), n ? n.promise() : void 0
                }
                return P = I.resStore, D = !0, t && t(i), n && n.resolve(i), n ? n.promise() : void 0
            }

            function a(e, t) {
                "string" == typeof e && (e = [e]);
                for (var i = 0, n = e.length; n > i; i++) I.preload.indexOf(e[i]) < 0 && I.preload.push(e[i]);
                return o(t)
            }

            function s(e, t, i) {
                "string" != typeof t ? (i = t, t = I.ns.defaultNs) : I.ns.namespaces.indexOf(t) < 0 && I.ns.namespaces.push(t), P[e] = P[e] || {}, P[e][t] = P[e][t] || {}, F.extend(P[e][t], i)
            }

            function l(e, t) {
                "string" != typeof t && (t = I.ns.defaultNs), P[e] = P[e] || {}, P[e][t] = {}
            }

            function h(e) {
                I.ns.defaultNs = e
            }

            function u(e, t) {
                d([e], t)
            }

            function d(e, t) {
                var i = {
                        dynamicLoad: I.dynamicLoad,
                        resGetPath: I.resGetPath,
                        getAsync: I.getAsync,
                        customLoad: I.customLoad,
                        ns: {
                            namespaces: e,
                            defaultNs: ""
                        }
                    },
                    n = F.toLanguages(I.lng);
                "string" == typeof I.preload && (I.preload = [I.preload]);
                for (var r = 0, o = I.preload.length; o > r; r++)
                    for (var a = F.toLanguages(I.preload[r]), s = 0, l = a.length; l > s; s++) n.indexOf(a[s]) < 0 && n.push(a[s]);
                for (var h = [], u = 0, d = n.length; d > u; u++) {
                    var c = !1,
                        f = P[n[u]];
                    if (f)
                        for (var p = 0, m = e.length; m > p; p++) f[e[p]] || (c = !0);
                    else c = !0;
                    c && h.push(n[u])
                }
                h.length ? L.sync._fetch(h, i, function(i, n) {
                    var r = e.length * h.length;
                    F.each(e, function(e, i) {
                        I.ns.namespaces.indexOf(i) < 0 && I.ns.namespaces.push(i), F.each(h, function(e, o) {
                            P[o] = P[o] || {}, P[o][i] = n[o][i], r--, 0 === r && t && (I.useLocalStorage && L.sync._storeLocal(P), t())
                        })
                    })
                }) : t && t()
            }

            function c(e, t, i) {
                return "function" == typeof t ? (i = t, t = {}) : t || (t = {}), t.lng = e, o(t, i)
            }

            function f() {
                return C
            }

            function p() {
                function e(e, t, i) {
                    if (0 !== t.length) {
                        var n = "text";
                        if (0 === t.indexOf("[")) {
                            var r = t.split("]");
                            t = r[1], n = r[0].substr(1, r[0].length - 1)
                        }
                        t.indexOf(";") === t.length - 1 && (t = t.substr(0, t.length - 2));
                        var o;
                        if ("html" === n) o = I.defaultValueFromContent ? k.extend({
                            defaultValue: e.html()
                        }, i) : i, e.html(k.t(t, o));
                        else if ("text" === n) o = I.defaultValueFromContent ? k.extend({
                            defaultValue: e.text()
                        }, i) : i, e.text(k.t(t, o));
                        else if ("prepend" === n) o = I.defaultValueFromContent ? k.extend({
                            defaultValue: e.html()
                        }, i) : i, e.prepend(k.t(t, o));
                        else if ("append" === n) o = I.defaultValueFromContent ? k.extend({
                            defaultValue: e.html()
                        }, i) : i, e.append(k.t(t, o));
                        else if (0 === n.indexOf("data-")) {
                            var a = n.substr("data-".length);
                            o = I.defaultValueFromContent ? k.extend({
                                defaultValue: e.data(a)
                            }, i) : i;
                            var s = k.t(t, o);
                            e.data(a, s), e.attr(n, s)
                        } else o = I.defaultValueFromContent ? k.extend({
                            defaultValue: e.attr(n)
                        }, i) : i, e.attr(n, k.t(t, o))
                    }
                }

                function t(t, i) {
                    var n = t.attr(I.selectorAttr);
                    if (n || "undefined" == typeof n || n === !1 || (n = t.text() || t.val()), n) {
                        var r = t,
                            o = t.data("i18n-target");
                        if (o && (r = t.find(o) || t), i || I.useDataAttrOptions !== !0 || (i = t.data("i18n-options")), i = i || {}, n.indexOf(";") >= 0) {
                            var a = n.split(";");
                            k.each(a, function(t, n) {
                                "" !== n && e(r, n, i)
                            })
                        } else e(r, n, i);
                        I.useDataAttrOptions === !0 && t.data("i18n-options", i)
                    }
                }
                k.t = k.t || b, k.fn.i18n = function(e) {
                    return this.each(function() {
                        t(k(this), e);
                        var i = k(this).find("[" + I.selectorAttr + "]");
                        i.each(function() {
                            t(k(this), e)
                        })
                    })
                }
            }

            function m(e, t, i, n) {
                if (!e) return e;
                if (n = n || t, e.indexOf(n.interpolationPrefix || I.interpolationPrefix) < 0) return e;
                var r = n.interpolationPrefix ? F.regexEscape(n.interpolationPrefix) : I.interpolationPrefixEscaped,
                    o = n.interpolationSuffix ? F.regexEscape(n.interpolationSuffix) : I.interpolationSuffixEscaped,
                    a = "HTML" + o;
                return F.each(t, function(t, s) {
                    var l = i ? i + I.keyseparator + t : t;
                    "object" == typeof s && null !== s ? e = m(e, s, l, n) : n.escapeInterpolation || I.escapeInterpolation ? (e = e.replace(new RegExp([r, l, a].join(""), "g"), s), e = e.replace(new RegExp([r, l, o].join(""), "g"), F.escape(s))) : e = e.replace(new RegExp([r, l, o].join(""), "g"), s)
                }), e
            }

            function g(e, t) {
                var i = ",",
                    n = "{",
                    r = "}",
                    o = F.extend({}, t);
                for (delete o.postProcess; - 1 != e.indexOf(I.reusePrefix) && (A++, !(A > I.maxRecursion));) {
                    var a = e.lastIndexOf(I.reusePrefix),
                        s = e.indexOf(I.reuseSuffix, a) + I.reuseSuffix.length,
                        l = e.substring(a, s),
                        h = l.replace(I.reusePrefix, "").replace(I.reuseSuffix, "");
                    if (-1 != h.indexOf(i)) {
                        var u = h.indexOf(i);
                        if (-1 != h.indexOf(n, u) && -1 != h.indexOf(r, u)) {
                            var d = h.indexOf(n, u),
                                c = h.indexOf(r, d) + r.length;
                            try {
                                o = F.extend(o, JSON.parse(h.substring(d, c))), h = h.substring(0, u)
                            } catch (f) {}
                        }
                    }
                    var p = M(h, o);
                    e = e.replace(l, p)
                }
                return e
            }

            function _(e) {
                return e.context && ("string" == typeof e.context || "number" == typeof e.context)
            }

            function v(e) {
                return void 0 !== e.count && "string" != typeof e.count && 1 !== e.count
            }

            function y(e, t) {
                t = t || {};
                var i = x(e, t),
                    n = T(e, t);
                return void 0 !== n || n === i
            }

            function b(e, t) {
                return t = t || {}, D ? (A = 0, M.apply(null, arguments)) : (F.log("i18next not finished initialization. you might have called t function before loading resources finished."), t.defaultValue || "")
            }

            function x(e, t) {
                return void 0 !== t.defaultValue ? t.defaultValue : e
            }

            function w() {
                for (var e = [], t = 1; t < arguments.length; t++) e.push(arguments[t]);
                return {
                    postProcess: "sprintf",
                    sprintf: e
                }
            }

            function M(e, t) {
                if (t && "object" != typeof t ? "sprintf" === I.shortcutFunction ? t = w.apply(null, arguments) : "defaultValue" === I.shortcutFunction && (t = {
                        defaultValue: t
                    }) : t = t || {}, void 0 === e || null === e) return "";
                "string" == typeof e && (e = [e]);
                var i = e[0];
                if (e.length > 1)
                    for (var n = 0; n < e.length && (i = e[n], !y(i, t)); n++);
                var r, o = x(i, t),
                    a = T(i, t),
                    s = t.lng ? F.toLanguages(t.lng) : R,
                    l = t.ns || I.ns.defaultNs;
                i.indexOf(I.nsseparator) > -1 && (r = i.split(I.nsseparator), l = r[0], i = r[1]), void 0 === a && I.sendMissing && (t.lng ? z.postMissing(s[0], l, i, o, s) : z.postMissing(I.lng, l, i, o, s));
                var h = t.postProcess || I.postProcess;
                void 0 !== a && h && U[h] && (a = U[h](a, i, t));
                var u = o;
                if (o.indexOf(I.nsseparator) > -1 && (r = o.split(I.nsseparator), u = r[1]), u === i && I.parseMissingKey && (o = I.parseMissingKey(o)), void 0 === a && (o = m(o, t), o = g(o, t), h && U[h])) {
                    var d = x(i, t);
                    a = U[h](d, i, t)
                }
                return void 0 !== a ? a : o
            }

            function T(e, t) {
                t = t || {};
                var i, n, r = x(e, t),
                    o = R;
                if (!P) return r;
                if ("cimode" === o[0].toLowerCase()) return r;
                if (t.lng && (o = F.toLanguages(t.lng), !P[o[0]])) {
                    var a = I.getAsync;
                    I.getAsync = !1, L.sync.load(o, I, function(e, t) {
                        F.extend(P, t), I.getAsync = a
                    })
                }
                var s = t.ns || I.ns.defaultNs;
                if (e.indexOf(I.nsseparator) > -1) {
                    var l = e.split(I.nsseparator);
                    s = l[0], e = l[1]
                }
                if (_(t)) {
                    i = F.extend({}, t), delete i.context, i.defaultValue = I.contextNotFound;
                    var h = s + I.nsseparator + e + "_" + t.context;
                    if (n = b(h, i), n != I.contextNotFound) return m(n, {
                        context: t.context
                    })
                }
                if (v(t)) {
                    i = F.extend({}, t), delete i.count, i.defaultValue = I.pluralNotFound;
                    var u = s + I.nsseparator + e + I.pluralSuffix,
                        d = H.get(o[0], t.count);
                    if (d >= 0 ? u = u + "_" + d : 1 === d && (u = s + I.nsseparator + e), n = b(u, i), n != I.pluralNotFound) return m(n, {
                        count: t.count,
                        interpolationPrefix: t.interpolationPrefix,
                        interpolationSuffix: t.interpolationSuffix
                    })
                }
                for (var c, f = e.split(I.keyseparator), p = 0, y = o.length; y > p && void 0 === c; p++) {
                    for (var w = o[p], S = 0, C = P[w] && P[w][s]; f[S];) C = C && C[f[S]], S++;
                    if (void 0 !== C) {
                        var E = Object.prototype.toString.apply(C);
                        if ("string" == typeof C) C = m(C, t), C = g(C, t);
                        else if ("[object Array]" !== E || I.returnObjectTrees || t.returnObjectTrees) {
                            if (null === C && I.fallbackOnNull === !0) C = void 0;
                            else if (null !== C)
                                if (I.returnObjectTrees || t.returnObjectTrees) {
                                    if ("[object Number]" !== E && "[object Function]" !== E && "[object RegExp]" !== E) {
                                        var k = "[object Array]" === E ? [] : {};
                                        F.each(C, function(i) {
                                            k[i] = M(s + I.nsseparator + e + I.keyseparator + i, t)
                                        }), C = k
                                    }
                                } else I.objectTreeKeyHandler && "function" == typeof I.objectTreeKeyHandler ? C = I.objectTreeKeyHandler(e, C, w, s, t) : (C = "key '" + s + ":" + e + " (" + w + ")' returned an object instead of string.", F.log(C))
                        } else C = C.join("\n"), C = m(C, t), C = g(C, t);
                        "string" == typeof C && "" === C.trim() && I.fallbackOnEmpty === !0 && (C = void 0), c = C
                    }
                }
                if (void 0 === c && !t.isFallbackLookup && (I.fallbackToDefaultNS === !0 || I.fallbackNS && I.fallbackNS.length > 0))
                    if (t.isFallbackLookup = !0, I.fallbackNS.length) {
                        for (var A = 0, D = I.fallbackNS.length; D > A; A++)
                            if (c = T(I.fallbackNS[A] + I.nsseparator + e, t)) {
                                var O = c.indexOf(I.nsseparator) > -1 ? c.split(I.nsseparator)[1] : c,
                                    N = r.indexOf(I.nsseparator) > -1 ? r.split(I.nsseparator)[1] : r;
                                if (O !== N) break
                            }
                    } else c = T(e, t);
                return c
            }

            function S() {
                var e, t = [];
                if ("undefined" != typeof window && (! function() {
                        for (var e = window.location.search.substring(1), i = e.split("&"), n = 0; n < i.length; n++) {
                            var r = i[n].indexOf("=");
                            if (r > 0) {
                                var o = i[n].substring(0, r),
                                    a = i[n].substring(r + 1);
                                t[o] = a
                            }
                        }
                    }(), t[I.detectLngQS] && (e = t[I.detectLngQS])), !e && "undefined" != typeof document && I.useCookie) {
                    var i = F.cookie.read(I.cookieName);
                    i && (e = i)
                }
                return e || "undefined" == typeof navigator || (e = navigator.language ? navigator.language : navigator.userLanguage), e
            }
            Array.prototype.indexOf || (Array.prototype.indexOf = function(e) {
                "use strict";
                if (null == this) throw new TypeError;
                var t = Object(this),
                    i = t.length >>> 0;
                if (0 === i) return -1;
                var n = 0;
                if (arguments.length > 0 && (n = Number(arguments[1]), n != n ? n = 0 : 0 != n && n != 1 / 0 && n != -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n)))), n >= i) return -1;
                for (var r = n >= 0 ? n : Math.max(i - Math.abs(n), 0); i > r; r++)
                    if (r in t && t[r] === e) return r;
                return -1
            }), Array.prototype.lastIndexOf || (Array.prototype.lastIndexOf = function(e) {
                "use strict";
                if (null == this) throw new TypeError;
                var t = Object(this),
                    i = t.length >>> 0;
                if (0 === i) return -1;
                var n = i;
                arguments.length > 1 && (n = Number(arguments[1]), n != n ? n = 0 : 0 != n && n != 1 / 0 && n != -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))));
                for (var r = n >= 0 ? Math.min(n, i - 1) : i - Math.abs(n); r >= 0; r--)
                    if (r in t && t[r] === e) return r;
                return -1
            }), "function" != typeof String.prototype.trim && (String.prototype.trim = function() {
                return this.replace(/^\s+|\s+$/g, "")
            });
            var C, E = this,
                k = E.jQuery || E.Zepto,
                L = {},
                P = {},
                A = 0,
                R = [],
                D = !1;
            "undefined" != typeof t && t.exports ? t.exports = L : (k && (k.i18n = k.i18n || L), E.i18n = E.i18n || L);
            var I = {
                    lng: void 0,
                    load: "all",
                    preload: [],
                    lowerCaseLng: !1,
                    returnObjectTrees: !1,
                    fallbackLng: ["dev"],
                    fallbackNS: [],
                    detectLngQS: "setLng",
                    ns: "translation",
                    fallbackOnNull: !0,
                    fallbackOnEmpty: !1,
                    fallbackToDefaultNS: !1,
                    nsseparator: ":",
                    keyseparator: ".",
                    selectorAttr: "data-i18n",
                    debug: !1,
                    resGetPath: "locales/__lng__/__ns__.json",
                    resPostPath: "locales/add/__lng__/__ns__",
                    getAsync: !0,
                    postAsync: !0,
                    resStore: void 0,
                    useLocalStorage: !1,
                    localStorageExpirationTime: 6048e5,
                    dynamicLoad: !1,
                    sendMissing: !1,
                    sendMissingTo: "fallback",
                    sendType: "POST",
                    interpolationPrefix: "__",
                    interpolationSuffix: "__",
                    reusePrefix: "$t(",
                    reuseSuffix: ")",
                    pluralSuffix: "_plural",
                    pluralNotFound: ["plural_not_found", Math.random()].join(""),
                    contextNotFound: ["context_not_found", Math.random()].join(""),
                    escapeInterpolation: !1,
                    setJqueryExt: !0,
                    defaultValueFromContent: !0,
                    useDataAttrOptions: !1,
                    cookieExpirationTime: void 0,
                    useCookie: !0,
                    cookieName: "i18next",
                    cookieDomain: void 0,
                    objectTreeKeyHandler: void 0,
                    postProcess: void 0,
                    parseMissingKey: void 0,
                    shortcutFunction: "sprintf"
                },
                O = {
                    "&": "&amp;",
                    "<": "&lt;",
                    ">": "&gt;",
                    '"': "&quot;",
                    "'": "&#39;",
                    "/": "&#x2F;"
                },
                N = {
                    create: function(e, t, i, n) {
                        var r;
                        if (i) {
                            var o = new Date;
                            o.setTime(o.getTime() + 60 * i * 1e3), r = "; expires=" + o.toGMTString()
                        } else r = "";
                        n = n ? "domain=" + n + ";" : "", document.cookie = e + "=" + t + r + ";" + n + "path=/"
                    },
                    read: function(e) {
                        for (var t = e + "=", i = document.cookie.split(";"), n = 0; n < i.length; n++) {
                            for (var r = i[n];
                                " " == r.charAt(0);) r = r.substring(1, r.length);
                            if (0 === r.indexOf(t)) return r.substring(t.length, r.length)
                        }
                        return null
                    },
                    remove: function(e) {
                        this.create(e, "", -1)
                    }
                },
                B = {
                    create: function(e, t, i, n) {},
                    read: function(e) {
                        return null
                    },
                    remove: function(e) {}
                },
                F = {
                    extend: k ? k.extend : e,
                    each: k ? k.each : i,
                    ajax: k ? k.ajax : "undefined" != typeof document ? r : function() {},
                    cookie: "undefined" != typeof document ? N : B,
                    detectLanguage: S,
                    escape: n,
                    log: function(e) {
                        I.debug && "undefined" != typeof console && console.log(e)
                    },
                    toLanguages: function(e) {
                        var t = [];
                        if ("string" == typeof e && e.indexOf("-") > -1) {
                            var i = e.split("-");
                            e = I.lowerCaseLng ? i[0].toLowerCase() + "-" + i[1].toLowerCase() : i[0].toLowerCase() + "-" + i[1].toUpperCase(), "unspecific" !== I.load && t.push(e), "current" !== I.load && t.push(i[0])
                        } else t.push(e);
                        for (var n = 0; n < I.fallbackLng.length; n++) - 1 === t.indexOf(I.fallbackLng[n]) && I.fallbackLng[n] && t.push(I.fallbackLng[n]);
                        return t
                    },
                    regexEscape: function(e) {
                        return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&")
                    }
                };
            F.applyReplacement = m;
            var z = {
                    load: function(e, t, i) {
                        t.useLocalStorage ? z._loadLocal(e, t, function(n, r) {
                            for (var o = [], a = 0, s = e.length; s > a; a++) r[e[a]] || o.push(e[a]);
                            o.length > 0 ? z._fetch(o, t, function(e, t) {
                                F.extend(r, t), z._storeLocal(t), i(null, r)
                            }) : i(null, r)
                        }) : z._fetch(e, t, function(e, t) {
                            i(null, t)
                        })
                    },
                    _loadLocal: function(e, t, i) {
                        var n = {},
                            r = (new Date).getTime();
                        if (window.localStorage) {
                            var o = e.length;
                            F.each(e, function(e, a) {
                                var s = window.localStorage.getItem("res_" + a);
                                s && (s = JSON.parse(s), s.i18nStamp && s.i18nStamp + t.localStorageExpirationTime > r && (n[a] = s)), o--, 0 === o && i(null, n)
                            })
                        }
                    },
                    _storeLocal: function(e) {
                        if (window.localStorage)
                            for (var t in e) e[t].i18nStamp = (new Date).getTime(), window.localStorage.setItem("res_" + t, JSON.stringify(e[t]))
                    },
                    _fetch: function(e, t, i) {
                        var n = t.ns,
                            r = {};
                        if (t.dynamicLoad) {
                            var o = function(e, t) {
                                i(null, t)
                            };
                            if ("function" == typeof t.customLoad) t.customLoad(e, n.namespaces, t, o);
                            else {
                                var a = m(t.resGetPath, {
                                    lng: e.join("+"),
                                    ns: n.namespaces.join("+")
                                });
                                F.ajax({
                                    url: a,
                                    success: function(e, t, i) {
                                        F.log("loaded: " + a), o(null, e)
                                    },
                                    error: function(e, t, i) {
                                        F.log("failed loading: " + a), o("failed loading resource.json error: " + i)
                                    },
                                    dataType: "json",
                                    async: t.getAsync
                                })
                            }
                        } else {
                            var s, l = n.namespaces.length * e.length;
                            F.each(n.namespaces, function(n, o) {
                                F.each(e, function(e, n) {
                                    var a = function(e, t) {
                                        e && (s = s || [], s.push(e)), r[n] = r[n] || {}, r[n][o] = t, l--, 0 === l && i(s, r)
                                    };
                                    "function" == typeof t.customLoad ? t.customLoad(n, o, t, a) : z._fetchOne(n, o, t, a)
                                })
                            })
                        }
                    },
                    _fetchOne: function(e, t, i, n) {
                        var r = m(i.resGetPath, {
                            lng: e,
                            ns: t
                        });
                        F.ajax({
                            url: r,
                            success: function(e, t, i) {
                                F.log("loaded: " + r), n(null, e)
                            },
                            error: function(e, t, i) {
                                if (t && 200 == t || e && e.status && 200 == e.status) F.log("There is a typo in: " + r);
                                else if (t && 404 == t || e && e.status && 404 == e.status) F.log("Does not exist: " + r);
                                else {
                                    var o = t ? t : e && e.status ? e.status : null;
                                    F.log(o + " when loading " + r)
                                }
                                n(i, {})
                            },
                            dataType: "json",
                            async: i.getAsync
                        })
                    },
                    postMissing: function(e, t, i, n, r) {
                        var o = {};
                        o[i] = n;
                        var a = [];
                        if ("fallback" === I.sendMissingTo && I.fallbackLng[0] !== !1)
                            for (var s = 0; s < I.fallbackLng.length; s++) a.push({
                                lng: I.fallbackLng[s],
                                url: m(I.resPostPath, {
                                    lng: I.fallbackLng[s],
                                    ns: t
                                })
                            });
                        else if ("current" === I.sendMissingTo || "fallback" === I.sendMissingTo && I.fallbackLng[0] === !1) a.push({
                            lng: e,
                            url: m(I.resPostPath, {
                                lng: e,
                                ns: t
                            })
                        });
                        else if ("all" === I.sendMissingTo)
                            for (var s = 0, l = r.length; l > s; s++) a.push({
                                lng: r[s],
                                url: m(I.resPostPath, {
                                    lng: r[s],
                                    ns: t
                                })
                            });
                        for (var h = 0, u = a.length; u > h; h++) {
                            var d = a[h];
                            F.ajax({
                                url: d.url,
                                type: I.sendType,
                                data: o,
                                success: function(e, r, o) {
                                    F.log("posted missing key '" + i + "' to: " + d.url);
                                    for (var a = i.split("."), s = 0, l = P[d.lng][t]; a[s];) l = s === a.length - 1 ? l[a[s]] = n : l[a[s]] = l[a[s]] || {}, s++
                                },
                                error: function(e, t, n) {
                                    F.log("failed posting missing key '" + i + "' to: " + d.url)
                                },
                                dataType: "json",
                                async: I.postAsync
                            })
                        }
                    }
                },
                H = {
                    rules: {
                        ach: {
                            name: "Acholi",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        af: {
                            name: "Afrikaans",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ak: {
                            name: "Akan",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        am: {
                            name: "Amharic",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        an: {
                            name: "Aragonese",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ar: {
                            name: "Arabic",
                            numbers: [0, 1, 2, 3, 11, 100],
                            plurals: function(e) {
                                return Number(0 === e ? 0 : 1 == e ? 1 : 2 == e ? 2 : e % 100 >= 3 && 10 >= e % 100 ? 3 : e % 100 >= 11 ? 4 : 5)
                            }
                        },
                        arn: {
                            name: "Mapudungun",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        ast: {
                            name: "Asturian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ay: {
                            name: "AymarÃ¡",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        az: {
                            name: "Azerbaijani",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        be: {
                            name: "Belarusian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        bg: {
                            name: "Bulgarian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        bn: {
                            name: "Bengali",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        bo: {
                            name: "Tibetan",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        br: {
                            name: "Breton",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        bs: {
                            name: "Bosnian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        ca: {
                            name: "Catalan",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        cgg: {
                            name: "Chiga",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        cs: {
                            name: "Czech",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : e >= 2 && 4 >= e ? 1 : 2)
                            }
                        },
                        csb: {
                            name: "Kashubian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        cy: {
                            name: "Welsh",
                            numbers: [1, 2, 3, 8],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : 2 == e ? 1 : 8 != e && 11 != e ? 2 : 3)
                            }
                        },
                        da: {
                            name: "Danish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        de: {
                            name: "German",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        dz: {
                            name: "Dzongkha",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        el: {
                            name: "Greek",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        en: {
                            name: "English",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        eo: {
                            name: "Esperanto",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        es: {
                            name: "Spanish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        es_ar: {
                            name: "Argentinean Spanish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        et: {
                            name: "Estonian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        eu: {
                            name: "Basque",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        fa: {
                            name: "Persian",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        fi: {
                            name: "Finnish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        fil: {
                            name: "Filipino",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        fo: {
                            name: "Faroese",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        fr: {
                            name: "French",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        fur: {
                            name: "Friulian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        fy: {
                            name: "Frisian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ga: {
                            name: "Irish",
                            numbers: [1, 2, 3, 7, 11],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : 2 == e ? 1 : 7 > e ? 2 : 11 > e ? 3 : 4)
                            }
                        },
                        gd: {
                            name: "Scottish Gaelic",
                            numbers: [1, 2, 3, 20],
                            plurals: function(e) {
                                return Number(1 == e || 11 == e ? 0 : 2 == e || 12 == e ? 1 : e > 2 && 20 > e ? 2 : 3)
                            }
                        },
                        gl: {
                            name: "Galician",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        gu: {
                            name: "Gujarati",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        gun: {
                            name: "Gun",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        ha: {
                            name: "Hausa",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        he: {
                            name: "Hebrew",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        hi: {
                            name: "Hindi",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        hr: {
                            name: "Croatian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        hu: {
                            name: "Hungarian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        hy: {
                            name: "Armenian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ia: {
                            name: "Interlingua",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        id: {
                            name: "Indonesian",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        is: {
                            name: "Icelandic",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e % 10 != 1 || e % 100 == 11)
                            }
                        },
                        it: {
                            name: "Italian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ja: {
                            name: "Japanese",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        jbo: {
                            name: "Lojban",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        jv: {
                            name: "Javanese",
                            numbers: [0, 1],
                            plurals: function(e) {
                                return Number(0 !== e)
                            }
                        },
                        ka: {
                            name: "Georgian",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        kk: {
                            name: "Kazakh",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        km: {
                            name: "Khmer",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        kn: {
                            name: "Kannada",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ko: {
                            name: "Korean",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        ku: {
                            name: "Kurdish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        kw: {
                            name: "Cornish",
                            numbers: [1, 2, 3, 4],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : 2 == e ? 1 : 3 == e ? 2 : 3)
                            }
                        },
                        ky: {
                            name: "Kyrgyz",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        lb: {
                            name: "Letzeburgesch",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ln: {
                            name: "Lingala",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        lo: {
                            name: "Lao",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        lt: {
                            name: "Lithuanian",
                            numbers: [1, 2, 10],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        lv: {
                            name: "Latvian",
                            numbers: [1, 2, 0],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : 0 !== e ? 1 : 2)
                            }
                        },
                        mai: {
                            name: "Maithili",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        mfe: {
                            name: "Mauritian Creole",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        mg: {
                            name: "Malagasy",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        mi: {
                            name: "Maori",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        mk: {
                            name: "Macedonian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 == e || e % 10 == 1 ? 0 : 1)
                            }
                        },
                        ml: {
                            name: "Malayalam",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        mn: {
                            name: "Mongolian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        mnk: {
                            name: "Mandinka",
                            numbers: [0, 1, 2],
                            plurals: function(e) {
                                return Number(1 == e ? 1 : 2)
                            }
                        },
                        mr: {
                            name: "Marathi",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ms: {
                            name: "Malay",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        mt: {
                            name: "Maltese",
                            numbers: [1, 2, 11, 20],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : 0 === e || e % 100 > 1 && 11 > e % 100 ? 1 : e % 100 > 10 && 20 > e % 100 ? 2 : 3)
                            }
                        },
                        nah: {
                            name: "Nahuatl",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        nap: {
                            name: "Neapolitan",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        nb: {
                            name: "Norwegian Bokmal",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ne: {
                            name: "Nepali",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        nl: {
                            name: "Dutch",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        nn: {
                            name: "Norwegian Nynorsk",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        no: {
                            name: "Norwegian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        nso: {
                            name: "Northern Sotho",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        oc: {
                            name: "Occitan",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        or: {
                            name: "Oriya",
                            numbers: [2, 1],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        pa: {
                            name: "Punjabi",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        pap: {
                            name: "Papiamento",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        pl: {
                            name: "Polish",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        pms: {
                            name: "Piemontese",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ps: {
                            name: "Pashto",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        pt: {
                            name: "Portuguese",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        pt_br: {
                            name: "Brazilian Portuguese",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        rm: {
                            name: "Romansh",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ro: {
                            name: "Romanian",
                            numbers: [1, 2, 20],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : 0 === e || e % 100 > 0 && 20 > e % 100 ? 1 : 2)
                            }
                        },
                        ru: {
                            name: "Russian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        sah: {
                            name: "Yakut",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        sco: {
                            name: "Scots",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        se: {
                            name: "Northern Sami",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        si: {
                            name: "Sinhala",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        sk: {
                            name: "Slovak",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(1 == e ? 0 : e >= 2 && 4 >= e ? 1 : 2)
                            }
                        },
                        sl: {
                            name: "Slovenian",
                            numbers: [5, 1, 2, 3],
                            plurals: function(e) {
                                return Number(e % 100 == 1 ? 1 : e % 100 == 2 ? 2 : e % 100 == 3 || e % 100 == 4 ? 3 : 0)
                            }
                        },
                        so: {
                            name: "Somali",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        son: {
                            name: "Songhay",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        sq: {
                            name: "Albanian",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        sr: {
                            name: "Serbian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        su: {
                            name: "Sundanese",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        sv: {
                            name: "Swedish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        sw: {
                            name: "Swahili",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        ta: {
                            name: "Tamil",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        te: {
                            name: "Telugu",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        tg: {
                            name: "Tajik",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        th: {
                            name: "Thai",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        ti: {
                            name: "Tigrinya",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        tk: {
                            name: "Turkmen",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        tr: {
                            name: "Turkish",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        tt: {
                            name: "Tatar",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        ug: {
                            name: "Uyghur",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        uk: {
                            name: "Ukrainian",
                            numbers: [1, 2, 5],
                            plurals: function(e) {
                                return Number(e % 10 == 1 && e % 100 != 11 ? 0 : e % 10 >= 2 && 4 >= e % 10 && (10 > e % 100 || e % 100 >= 20) ? 1 : 2)
                            }
                        },
                        ur: {
                            name: "Urdu",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        uz: {
                            name: "Uzbek",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        vi: {
                            name: "Vietnamese",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        wa: {
                            name: "Walloon",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(e > 1)
                            }
                        },
                        wo: {
                            name: "Wolof",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        },
                        yo: {
                            name: "Yoruba",
                            numbers: [1, 2],
                            plurals: function(e) {
                                return Number(1 != e)
                            }
                        },
                        zh: {
                            name: "Chinese",
                            numbers: [1],
                            plurals: function(e) {
                                return 0
                            }
                        }
                    },
                    addRule: function(e, t) {
                        H.rules[e] = t
                    },
                    setCurrentLng: function(e) {
                        if (!H.currentRule || H.currentRule.lng !== e) {
                            var t = e.split("-");
                            H.currentRule = {
                                lng: e,
                                rule: H.rules[t[0]]
                            }
                        }
                    },
                    get: function(e, t) {
                        function i(t, i) {
                            var n;
                            if (n = H.currentRule && H.currentRule.lng === e ? H.currentRule.rule : H.rules[t]) {
                                var r = n.plurals(i),
                                    o = n.numbers[r];
                                return 2 === n.numbers.length && 1 === n.numbers[0] && (2 === o ? o = -1 : 1 === o && (o = 1)), o
                            }
                            return 1 === i ? "1" : "-1"
                        }
                        var n = e.split("-");
                        return i(n[0], t)
                    }
                },
                U = {},
                W = function(e, t) {
                    U[e] = t
                },
                G = function() {
                    function e(e) {
                        return Object.prototype.toString.call(e).slice(8, -1).toLowerCase()
                    }

                    function t(e, t) {
                        for (var i = []; t > 0; i[--t] = e);
                        return i.join("")
                    }
                    var i = function() {
                        return i.cache.hasOwnProperty(arguments[0]) || (i.cache[arguments[0]] = i.parse(arguments[0])), i.format.call(null, i.cache[arguments[0]], arguments)
                    };
                    return i.format = function(i, n) {
                        var r, o, a, s, l, h, u, d = 1,
                            c = i.length,
                            f = "",
                            p = [];
                        for (o = 0; c > o; o++)
                            if (f = e(i[o]), "string" === f) p.push(i[o]);
                            else if ("array" === f) {
                            if (s = i[o], s[2])
                                for (r = n[d], a = 0; a < s[2].length; a++) {
                                    if (!r.hasOwnProperty(s[2][a])) throw G('[sprintf] property "%s" does not exist', s[2][a]);
                                    r = r[s[2][a]]
                                } else r = s[1] ? n[s[1]] : n[d++];
                            if (/[^s]/.test(s[8]) && "number" != e(r)) throw G("[sprintf] expecting number but found %s", e(r));
                            switch (s[8]) {
                                case "b":
                                    r = r.toString(2);
                                    break;
                                case "c":
                                    r = String.fromCharCode(r);
                                    break;
                                case "d":
                                    r = parseInt(r, 10);
                                    break;
                                case "e":
                                    r = s[7] ? r.toExponential(s[7]) : r.toExponential();
                                    break;
                                case "f":
                                    r = s[7] ? parseFloat(r).toFixed(s[7]) : parseFloat(r);
                                    break;
                                case "o":
                                    r = r.toString(8);
                                    break;
                                case "s":
                                    r = (r = String(r)) && s[7] ? r.substring(0, s[7]) : r;
                                    break;
                                case "u":
                                    r = Math.abs(r);
                                    break;
                                case "x":
                                    r = r.toString(16);
                                    break;
                                case "X":
                                    r = r.toString(16).toUpperCase()
                            }
                            r = /[def]/.test(s[8]) && s[3] && r >= 0 ? "+" + r : r, h = s[4] ? "0" == s[4] ? "0" : s[4].charAt(1) : " ", u = s[6] - String(r).length, l = s[6] ? t(h, u) : "", p.push(s[5] ? r + l : l + r)
                        }
                        return p.join("")
                    }, i.cache = {}, i.parse = function(e) {
                        for (var t = e, i = [], n = [], r = 0; t;) {
                            if (null !== (i = /^[^\x25]+/.exec(t))) n.push(i[0]);
                            else if (null !== (i = /^\x25{2}/.exec(t))) n.push("%");
                            else {
                                if (null === (i = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))) throw "[sprintf] huh?";
                                if (i[2]) {
                                    r |= 1;
                                    var o = [],
                                        a = i[2],
                                        s = [];
                                    if (null === (s = /^([a-z_][a-z_\d]*)/i.exec(a))) throw "[sprintf] huh?";
                                    for (o.push(s[1]);
                                        "" !== (a = a.substring(s[0].length));)
                                        if (null !== (s = /^\.([a-z_][a-z_\d]*)/i.exec(a))) o.push(s[1]);
                                        else {
                                            if (null === (s = /^\[(\d+)\]/.exec(a))) throw "[sprintf] huh?";
                                            o.push(s[1])
                                        }
                                    i[2] = o
                                } else r |= 2;
                                if (3 === r) throw "[sprintf] mixing positional and named placeholders is not (yet) supported";
                                n.push(i)
                            }
                            t = t.substring(i[0].length)
                        }
                        return n
                    }, i
                }(),
                j = function(e, t) {
                    return t.unshift(e), G.apply(null, t)
                };
            W("sprintf", function(e, t, i) {
                return i.sprintf ? "[object Array]" === Object.prototype.toString.apply(i.sprintf) ? j(e, i.sprintf) : "object" == typeof i.sprintf ? G(e, i.sprintf) : e : e
            }), L.init = o, L.setLng = c, L.preload = a, L.addResourceBundle = s, L.removeResourceBundle = l, L.loadNamespace = u, L.loadNamespaces = d, L.setDefaultNamespace = h, L.t = b, L.translate = b, L.exists = y, L.detectLanguage = F.detectLanguage, L.pluralExtensions = H, L.sync = z, L.functions = F, L.lng = f, L.addPostProcessor = W, L.options = I
        }()
    }, {}],
    106: [function(e, t, i) {
        i.read = function(e, t, i, n, r) {
            var o, a, s = 8 * r - n - 1,
                l = (1 << s) - 1,
                h = l >> 1,
                u = -7,
                d = i ? r - 1 : 0,
                c = i ? -1 : 1,
                f = e[t + d];
            for (d += c, o = f & (1 << -u) - 1, f >>= -u, u += s; u > 0; o = 256 * o + e[t + d], d += c, u -= 8);
            for (a = o & (1 << -u) - 1, o >>= -u, u += n; u > 0; a = 256 * a + e[t + d], d += c, u -= 8);
            if (0 === o) o = 1 - h;
            else {
                if (o === l) return a ? NaN : (f ? -1 : 1) * (1 / 0);
                a += Math.pow(2, n), o -= h
            }
            return (f ? -1 : 1) * a * Math.pow(2, o - n)
        }, i.write = function(e, t, i, n, r, o) {
            var a, s, l, h = 8 * o - r - 1,
                u = (1 << h) - 1,
                d = u >> 1,
                c = 23 === r ? Math.pow(2, -24) - Math.pow(2, -77) : 0,
                f = n ? 0 : o - 1,
                p = n ? 1 : -1,
                m = 0 > t || 0 === t && 0 > 1 / t ? 1 : 0;
            for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (s = isNaN(t) ? 1 : 0, a = u) : (a = Math.floor(Math.log(t) / Math.LN2), t * (l = Math.pow(2, -a)) < 1 && (a--, l *= 2), t += a + d >= 1 ? c / l : c * Math.pow(2, 1 - d), t * l >= 2 && (a++, l /= 2), a + d >= u ? (s = 0, a = u) : a + d >= 1 ? (s = (t * l - 1) * Math.pow(2, r), a += d) : (s = t * Math.pow(2, d - 1) * Math.pow(2, r), a = 0)); r >= 8; e[i + f] = 255 & s, f += p, s /= 256, r -= 8);
            for (a = a << r | s, h += r; h > 0; e[i + f] = 255 & a, f += p, a /= 256, h -= 8);
            e[i + f - p] |= 128 * m
        }
    }, {}],
    107: [function(e, t, i) {
        "function" == typeof Object.create ? t.exports = function(e, t) {
            e.super_ = t, e.prototype = Object.create(t.prototype, {
                constructor: {
                    value: e,
                    enumerable: !1,
                    writable: !0,
                    configurable: !0
                }
            })
        } : t.exports = function(e, t) {
            e.super_ = t;
            var i = function() {};
            i.prototype = t.prototype, e.prototype = new i, e.prototype.constructor = e
        }
    }, {}],
    108: [function(e, t, i) {
        function n(e) {
            return !!e.constructor && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e)
        }

        function r(e) {
            return "function" == typeof e.readFloatLE && "function" == typeof e.slice && n(e.slice(0, 0))
        }
        t.exports = function(e) {
            return null != e && (n(e) || r(e) || !!e._isBuffer)
        }
    }, {}],
    109: [function(e, t, i) {
        "use strict";

        function n(e) {
            return null != e && "" !== e
        }

        function r(e) {
            return (Array.isArray(e) ? e.map(r) : e && "object" == typeof e ? Object.keys(e).filter(function(t) {
                return e[t]
            }) : [e]).filter(n).join(" ")
        }
        i.merge = function o(e, t) {
            if (1 === arguments.length) {
                for (var i = e[0], r = 1; r < e.length; r++) i = o(i, e[r]);
                return i
            }
            var a = e["class"],
                s = t["class"];
            (a || s) && (a = a || [], s = s || [], Array.isArray(a) || (a = [a]), Array.isArray(s) || (s = [s]), e["class"] = a.concat(s).filter(n));
            for (var l in t) "class" != l && (e[l] = t[l]);
            return e
        }, i.joinClasses = r, i.cls = function(e, t) {
            for (var n = [], o = 0; o < e.length; o++) t && t[o] ? n.push(i.escape(r([e[o]]))) : n.push(r(e[o]));
            var a = r(n);
            return a.length ? ' class="' + a + '"' : ""
        }, i.style = function(e) {
            return e && "object" == typeof e ? Object.keys(e).map(function(t) {
                return t + ":" + e[t]
            }).join(";") : e
        }, i.attr = function(e, t, n, r) {
            return "style" === e && (t = i.style(t)), "boolean" == typeof t || null == t ? t ? " " + (r ? e : e + '="' + e + '"') : "" : 0 == e.indexOf("data") && "string" != typeof t ? (-1 !== JSON.stringify(t).indexOf("&") && console.warn("Since Jade 2.0.0, ampersands (`&`) in data attributes will be escaped to `&amp;`"), t && "function" == typeof t.toISOString && console.warn("Jade will eliminate the double quotes around dates in ISO form after 2.0.0"), " " + e + "='" + JSON.stringify(t).replace(/'/g, "&apos;") + "'") : n ? (t && "function" == typeof t.toISOString && console.warn("Jade will stringify dates in ISO form after 2.0.0"), " " + e + '="' + i.escape(t) + '"') : (t && "function" == typeof t.toISOString && console.warn("Jade will stringify dates in ISO form after 2.0.0"), " " + e + '="' + t + '"')
        }, i.attrs = function(e, t) {
            var n = [],
                o = Object.keys(e);
            if (o.length)
                for (var a = 0; a < o.length; ++a) {
                    var s = o[a],
                        l = e[s];
                    "class" == s ? (l = r(l)) && n.push(" " + s + '="' + l + '"') : n.push(i.attr(s, l, !1, t))
                }
            return n.join("")
        }, i.escape = function(e) {
            var t = String(e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;");
            return t === "" + e ? e : t
        }, i.rethrow = function a(t, i, n, r) {
            if (!(t instanceof Error)) throw t;
            if (!("undefined" == typeof window && i || r)) throw t.message += " on line " + n, t;
            try {
                r = r || e("fs").readFileSync(i, "utf8")
            } catch (o) {
                a(t, null, n)
            }
            var s = 3,
                l = r.split("\n"),
                h = Math.max(n - s, 0),
                u = Math.min(l.length, n + s),
                s = l.slice(h, u).map(function(e, t) {
                    var i = t + h + 1;
                    return (i == n ? "  > " : "    ") + i + "| " + e
                }).join("\n");
            throw t.path = i, t.message = (i || "Jade") + ":" + n + "\n" + s + "\n\n" + t.message, t
        }
    }, {
        fs: 5
    }],
    110: [function(e, t, i) {
        ! function(e) {
            e.fn.visible = function(t, i, n, r) {
                if (!(this.length < 1)) {
                    var o = this.length > 1 ? this.eq(0) : this,
                        a = "undefined" != typeof r && null !== r,
                        s = e(a ? r : window),
                        l = a ? s.position() : 0,
                        h = o.get(0),
                        u = s.outerWidth(),
                        d = s.outerHeight(),
                        n = n ? n : "both",
                        c = i === !0 ? h.offsetWidth * h.offsetHeight : !0;
                    if ("function" == typeof h.getBoundingClientRect) {
                        var f = h.getBoundingClientRect(),
                            p = a ? f.top - l.top >= 0 && f.top < d + l.top : f.top >= 0 && f.top < d,
                            m = a ? f.bottom - l.top > 0 && f.bottom <= d + l.top : f.bottom > 0 && f.bottom <= d,
                            g = a ? f.left - l.left >= 0 && f.left < u + l.left : f.left >= 0 && f.left < u,
                            _ = a ? f.right - l.left > 0 && f.right < u + l.left : f.right > 0 && f.right <= u,
                            v = t ? p || m : p && m,
                            y = t ? g || _ : g && _;
                        if ("both" === n) return c && v && y;
                        if ("vertical" === n) return c && v;
                        if ("horizontal" === n) return c && y
                    } else {
                        var b = a ? 0 : l,
                            x = b + d,
                            w = s.scrollLeft(),
                            M = w + u,
                            T = o.position(),
                            S = T.top,
                            C = S + o.height(),
                            E = T.left,
                            k = E + o.width(),
                            L = t === !0 ? C : S,
                            P = t === !0 ? S : C,
                            A = t === !0 ? k : E,
                            R = t === !0 ? E : k;
                        if ("both" === n) return !!c && x >= P && L >= b && M >= R && A >= w;
                        if ("vertical" === n) return !!c && x >= P && L >= b;
                        if ("horizontal" === n) return !!c && M >= R && A >= w
                    }
                }
            }
        }(jQuery)
    }, {}],
    111: [function(e, t, i) {
        ! function(e, i) {
            "object" == typeof t && "object" == typeof t.exports ? t.exports = e.document ? i(e, !0) : function(e) {
                if (!e.document) throw new Error("jQuery requires a window with a document");
                return i(e)
            } : i(e)
        }("undefined" != typeof window ? window : this, function(e, t) {
            function i(e) {
                var t = "length" in e && e.length,
                    i = J.type(e);
                return "function" === i || J.isWindow(e) ? !1 : 1 === e.nodeType && t ? !0 : "array" === i || 0 === t || "number" == typeof t && t > 0 && t - 1 in e
            }

            function n(e, t, i) {
                if (J.isFunction(t)) return J.grep(e, function(e, n) {
                    return !!t.call(e, n, e) !== i
                });
                if (t.nodeType) return J.grep(e, function(e) {
                    return e === t !== i
                });
                if ("string" == typeof t) {
                    if (se.test(t)) return J.filter(t, e, i);
                    t = J.filter(t, e)
                }
                return J.grep(e, function(e) {
                    return V.call(t, e) >= 0 !== i
                })
            }

            function r(e, t) {
                for (;
                    (e = e[t]) && 1 !== e.nodeType;);
                return e
            }

            function o(e) {
                var t = pe[e] = {};
                return J.each(e.match(fe) || [], function(e, i) {
                    t[i] = !0
                }), t
            }

            function a() {
                $.removeEventListener("DOMContentLoaded", a, !1), e.removeEventListener("load", a, !1), J.ready()
            }

            function s() {
                Object.defineProperty(this.cache = {}, 0, {
                    get: function() {
                        return {}
                    }
                }), this.expando = J.expando + s.uid++
            }

            function l(e, t, i) {
                var n;
                if (void 0 === i && 1 === e.nodeType)
                    if (n = "data-" + t.replace(be, "-$1").toLowerCase(), i = e.getAttribute(n), "string" == typeof i) {
                        try {
                            i = "true" === i ? !0 : "false" === i ? !1 : "null" === i ? null : +i + "" === i ? +i : ye.test(i) ? J.parseJSON(i) : i
                        } catch (r) {}
                        ve.set(e, t, i)
                    } else i = void 0;
                return i
            }

            function h() {
                return !0
            }

            function u() {
                return !1
            }

            function d() {
                try {
                    return $.activeElement
                } catch (e) {}
            }

            function c(e, t) {
                return J.nodeName(e, "table") && J.nodeName(11 !== t.nodeType ? t : t.firstChild, "tr") ? e.getElementsByTagName("tbody")[0] || e.appendChild(e.ownerDocument.createElement("tbody")) : e
            }

            function f(e) {
                return e.type = (null !== e.getAttribute("type")) + "/" + e.type, e
            }

            function p(e) {
                var t = Ne.exec(e.type);
                return t ? e.type = t[1] : e.removeAttribute("type"), e
            }

            function m(e, t) {
                for (var i = 0, n = e.length; n > i; i++) _e.set(e[i], "globalEval", !t || _e.get(t[i], "globalEval"))
            }

            function g(e, t) {
                var i, n, r, o, a, s, l, h;
                if (1 === t.nodeType) {
                    if (_e.hasData(e) && (o = _e.access(e), a = _e.set(t, o), h = o.events)) {
                        delete a.handle, a.events = {};
                        for (r in h)
                            for (i = 0, n = h[r].length; n > i; i++) J.event.add(t, r, h[r][i])
                    }
                    ve.hasData(e) && (s = ve.access(e), l = J.extend({}, s), ve.set(t, l))
                }
            }

            function _(e, t) {
                var i = e.getElementsByTagName ? e.getElementsByTagName(t || "*") : e.querySelectorAll ? e.querySelectorAll(t || "*") : [];
                return void 0 === t || t && J.nodeName(e, t) ? J.merge([e], i) : i
            }

            function v(e, t) {
                var i = t.nodeName.toLowerCase();
                "input" === i && Te.test(e.type) ? t.checked = e.checked : ("input" === i || "textarea" === i) && (t.defaultValue = e.defaultValue)
            }

            function y(t, i) {
                var n, r = J(i.createElement(t)).appendTo(i.body),
                    o = e.getDefaultComputedStyle && (n = e.getDefaultComputedStyle(r[0])) ? n.display : J.css(r[0], "display");
                return r.detach(), o
            }

            function b(e) {
                var t = $,
                    i = He[e];
                return i || (i = y(e, t), "none" !== i && i || (ze = (ze || J("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement), t = ze[0].contentDocument, t.write(), t.close(), i = y(e, t), ze.detach()), He[e] = i), i
            }

            function x(e, t, i) {
                var n, r, o, a, s = e.style;
                return i = i || Ge(e), i && (a = i.getPropertyValue(t) || i[t]), i && ("" !== a || J.contains(e.ownerDocument, e) || (a = J.style(e, t)), We.test(a) && Ue.test(t) && (n = s.width, r = s.minWidth, o = s.maxWidth, s.minWidth = s.maxWidth = s.width = a, a = i.width, s.width = n, s.minWidth = r, s.maxWidth = o)), void 0 !== a ? a + "" : a
            }

            function w(e, t) {
                return {
                    get: function() {
                        return e() ? void delete this.get : (this.get = t).apply(this, arguments)
                    }
                }
            }

            function M(e, t) {
                if (t in e) return t;
                for (var i = t[0].toUpperCase() + t.slice(1), n = t, r = Ke.length; r--;)
                    if (t = Ke[r] + i, t in e) return t;
                return n
            }

            function T(e, t, i) {
                var n = qe.exec(t);
                return n ? Math.max(0, n[1] - (i || 0)) + (n[2] || "px") : t
            }

            function S(e, t, i, n, r) {
                for (var o = i === (n ? "border" : "content") ? 4 : "width" === t ? 1 : 0, a = 0; 4 > o; o += 2) "margin" === i && (a += J.css(e, i + we[o], !0, r)), n ? ("content" === i && (a -= J.css(e, "padding" + we[o], !0, r)), "margin" !== i && (a -= J.css(e, "border" + we[o] + "Width", !0, r))) : (a += J.css(e, "padding" + we[o], !0, r), "padding" !== i && (a += J.css(e, "border" + we[o] + "Width", !0, r)));
                return a
            }

            function C(e, t, i) {
                var n = !0,
                    r = "width" === t ? e.offsetWidth : e.offsetHeight,
                    o = Ge(e),
                    a = "border-box" === J.css(e, "boxSizing", !1, o);
                if (0 >= r || null == r) {
                    if (r = x(e, t, o), (0 > r || null == r) && (r = e.style[t]), We.test(r)) return r;
                    n = a && (X.boxSizingReliable() || r === e.style[t]), r = parseFloat(r) || 0
                }
                return r + S(e, t, i || (a ? "border" : "content"), n, o) + "px"
            }

            function E(e, t) {
                for (var i, n, r, o = [], a = 0, s = e.length; s > a; a++) n = e[a], n.style && (o[a] = _e.get(n, "olddisplay"), i = n.style.display, t ? (o[a] || "none" !== i || (n.style.display = ""), "" === n.style.display && Me(n) && (o[a] = _e.access(n, "olddisplay", b(n.nodeName)))) : (r = Me(n), "none" === i && r || _e.set(n, "olddisplay", r ? i : J.css(n, "display"))));
                for (a = 0; s > a; a++) n = e[a], n.style && (t && "none" !== n.style.display && "" !== n.style.display || (n.style.display = t ? o[a] || "" : "none"));
                return e
            }

            function k(e, t, i, n, r) {
                return new k.prototype.init(e, t, i, n, r)
            }

            function L() {
                return setTimeout(function() {
                    Xe = void 0
                }), Xe = J.now()
            }

            function P(e, t) {
                var i, n = 0,
                    r = {
                        height: e
                    };
                for (t = t ? 1 : 0; 4 > n; n += 2 - t) i = we[n], r["margin" + i] = r["padding" + i] = e;
                return t && (r.opacity = r.width = e), r
            }

            function A(e, t, i) {
                for (var n, r = (it[t] || []).concat(it["*"]), o = 0, a = r.length; a > o; o++)
                    if (n = r[o].call(i, t, e)) return n
            }

            function R(e, t, i) {
                var n, r, o, a, s, l, h, u, d = this,
                    c = {},
                    f = e.style,
                    p = e.nodeType && Me(e),
                    m = _e.get(e, "fxshow");
                i.queue || (s = J._queueHooks(e, "fx"), null == s.unqueued && (s.unqueued = 0, l = s.empty.fire, s.empty.fire = function() {
                    s.unqueued || l()
                }), s.unqueued++, d.always(function() {
                    d.always(function() {
                        s.unqueued--, J.queue(e, "fx").length || s.empty.fire()
                    })
                })), 1 === e.nodeType && ("height" in t || "width" in t) && (i.overflow = [f.overflow, f.overflowX, f.overflowY], h = J.css(e, "display"), u = "none" === h ? _e.get(e, "olddisplay") || b(e.nodeName) : h, "inline" === u && "none" === J.css(e, "float") && (f.display = "inline-block")), i.overflow && (f.overflow = "hidden", d.always(function() {
                    f.overflow = i.overflow[0], f.overflowX = i.overflow[1], f.overflowY = i.overflow[2]
                }));
                for (n in t)
                    if (r = t[n], Qe.exec(r)) {
                        if (delete t[n], o = o || "toggle" === r, r === (p ? "hide" : "show")) {
                            if ("show" !== r || !m || void 0 === m[n]) continue;
                            p = !0
                        }
                        c[n] = m && m[n] || J.style(e, n)
                    } else h = void 0;
                if (J.isEmptyObject(c)) "inline" === ("none" === h ? b(e.nodeName) : h) && (f.display = h);
                else {
                    m ? "hidden" in m && (p = m.hidden) : m = _e.access(e, "fxshow", {}), o && (m.hidden = !p), p ? J(e).show() : d.done(function() {
                        J(e).hide()
                    }), d.done(function() {
                        var t;
                        _e.remove(e, "fxshow");
                        for (t in c) J.style(e, t, c[t])
                    });
                    for (n in c) a = A(p ? m[n] : 0, n, d), n in m || (m[n] = a.start, p && (a.end = a.start, a.start = "width" === n || "height" === n ? 1 : 0))
                }
            }

            function D(e, t) {
                var i, n, r, o, a;
                for (i in e)
                    if (n = J.camelCase(i), r = t[n], o = e[i], J.isArray(o) && (r = o[1], o = e[i] = o[0]), i !== n && (e[n] = o, delete e[i]), a = J.cssHooks[n], a && "expand" in a) {
                        o = a.expand(o), delete e[n];
                        for (i in o) i in e || (e[i] = o[i], t[i] = r)
                    } else t[n] = r
            }

            function I(e, t, i) {
                var n, r, o = 0,
                    a = tt.length,
                    s = J.Deferred().always(function() {
                        delete l.elem
                    }),
                    l = function() {
                        if (r) return !1;
                        for (var t = Xe || L(), i = Math.max(0, h.startTime + h.duration - t), n = i / h.duration || 0, o = 1 - n, a = 0, l = h.tweens.length; l > a; a++) h.tweens[a].run(o);
                        return s.notifyWith(e, [h, o, i]), 1 > o && l ? i : (s.resolveWith(e, [h]), !1)
                    },
                    h = s.promise({
                        elem: e,
                        props: J.extend({}, t),
                        opts: J.extend(!0, {
                            specialEasing: {}
                        }, i),
                        originalProperties: t,
                        originalOptions: i,
                        startTime: Xe || L(),
                        duration: i.duration,
                        tweens: [],
                        createTween: function(t, i) {
                            var n = J.Tween(e, h.opts, t, i, h.opts.specialEasing[t] || h.opts.easing);
                            return h.tweens.push(n), n
                        },
                        stop: function(t) {
                            var i = 0,
                                n = t ? h.tweens.length : 0;
                            if (r) return this;
                            for (r = !0; n > i; i++) h.tweens[i].run(1);
                            return t ? s.resolveWith(e, [h, t]) : s.rejectWith(e, [h, t]), this
                        }
                    }),
                    u = h.props;
                for (D(u, h.opts.specialEasing); a > o; o++)
                    if (n = tt[o].call(h, e, u, h.opts)) return n;
                return J.map(u, A, h), J.isFunction(h.opts.start) && h.opts.start.call(e, h), J.fx.timer(J.extend(l, {
                    elem: e,
                    anim: h,
                    queue: h.opts.queue
                })), h.progress(h.opts.progress).done(h.opts.done, h.opts.complete).fail(h.opts.fail).always(h.opts.always)
            }

            function O(e) {
                return function(t, i) {
                    "string" != typeof t && (i = t, t = "*");
                    var n, r = 0,
                        o = t.toLowerCase().match(fe) || [];
                    if (J.isFunction(i))
                        for (; n = o[r++];) "+" === n[0] ? (n = n.slice(1) || "*", (e[n] = e[n] || []).unshift(i)) : (e[n] = e[n] || []).push(i)
                }
            }

            function N(e, t, i, n) {
                function r(s) {
                    var l;
                    return o[s] = !0, J.each(e[s] || [], function(e, s) {
                        var h = s(t, i, n);
                        return "string" != typeof h || a || o[h] ? a ? !(l = h) : void 0 : (t.dataTypes.unshift(h), r(h), !1)
                    }), l
                }
                var o = {},
                    a = e === yt;
                return r(t.dataTypes[0]) || !o["*"] && r("*")
            }

            function B(e, t) {
                var i, n, r = J.ajaxSettings.flatOptions || {};
                for (i in t) void 0 !== t[i] && ((r[i] ? e : n || (n = {}))[i] = t[i]);
                return n && J.extend(!0, e, n), e
            }

            function F(e, t, i) {
                for (var n, r, o, a, s = e.contents, l = e.dataTypes;
                    "*" === l[0];) l.shift(), void 0 === n && (n = e.mimeType || t.getResponseHeader("Content-Type"));
                if (n)
                    for (r in s)
                        if (s[r] && s[r].test(n)) {
                            l.unshift(r);
                            break
                        }
                if (l[0] in i) o = l[0];
                else {
                    for (r in i) {
                        if (!l[0] || e.converters[r + " " + l[0]]) {
                            o = r;
                            break
                        }
                        a || (a = r)
                    }
                    o = o || a
                }
                return o ? (o !== l[0] && l.unshift(o), i[o]) : void 0
            }

            function z(e, t, i, n) {
                var r, o, a, s, l, h = {},
                    u = e.dataTypes.slice();
                if (u[1])
                    for (a in e.converters) h[a.toLowerCase()] = e.converters[a];
                for (o = u.shift(); o;)
                    if (e.responseFields[o] && (i[e.responseFields[o]] = t), !l && n && e.dataFilter && (t = e.dataFilter(t, e.dataType)), l = o, o = u.shift())
                        if ("*" === o) o = l;
                        else if ("*" !== l && l !== o) {
                    if (a = h[l + " " + o] || h["* " + o], !a)
                        for (r in h)
                            if (s = r.split(" "), s[1] === o && (a = h[l + " " + s[0]] || h["* " + s[0]])) {
                                a === !0 ? a = h[r] : h[r] !== !0 && (o = s[0], u.unshift(s[1]));
                                break
                            }
                    if (a !== !0)
                        if (a && e["throws"]) t = a(t);
                        else try {
                            t = a(t)
                        } catch (d) {
                            return {
                                state: "parsererror",
                                error: a ? d : "No conversion from " + l + " to " + o
                            }
                        }
                }
                return {
                    state: "success",
                    data: t
                }
            }

            function H(e, t, i, n) {
                var r;
                if (J.isArray(t)) J.each(t, function(t, r) {
                    i || Tt.test(e) ? n(e, r) : H(e + "[" + ("object" == typeof r ? t : "") + "]", r, i, n)
                });
                else if (i || "object" !== J.type(t)) n(e, t);
                else
                    for (r in t) H(e + "[" + r + "]", t[r], i, n)
            }

            function U(e) {
                return J.isWindow(e) ? e : 9 === e.nodeType && e.defaultView
            }
            var W = [],
                G = W.slice,
                j = W.concat,
                q = W.push,
                V = W.indexOf,
                Z = {},
                Y = Z.toString,
                K = Z.hasOwnProperty,
                X = {},
                $ = e.document,
                Q = "2.1.4",
                J = function(e, t) {
                    return new J.fn.init(e, t)
                },
                ee = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,
                te = /^-ms-/,
                ie = /-([\da-z])/gi,
                ne = function(e, t) {
                    return t.toUpperCase()
                };
            J.fn = J.prototype = {
                jquery: Q,
                constructor: J,
                selector: "",
                length: 0,
                toArray: function() {
                    return G.call(this)
                },
                get: function(e) {
                    return null != e ? 0 > e ? this[e + this.length] : this[e] : G.call(this)
                },
                pushStack: function(e) {
                    var t = J.merge(this.constructor(), e);
                    return t.prevObject = this, t.context = this.context, t
                },
                each: function(e, t) {
                    return J.each(this, e, t)
                },
                map: function(e) {
                    return this.pushStack(J.map(this, function(t, i) {
                        return e.call(t, i, t)
                    }))
                },
                slice: function() {
                    return this.pushStack(G.apply(this, arguments))
                },
                first: function() {
                    return this.eq(0)
                },
                last: function() {
                    return this.eq(-1)
                },
                eq: function(e) {
                    var t = this.length,
                        i = +e + (0 > e ? t : 0);
                    return this.pushStack(i >= 0 && t > i ? [this[i]] : [])
                },
                end: function() {
                    return this.prevObject || this.constructor(null)
                },
                push: q,
                sort: W.sort,
                splice: W.splice
            }, J.extend = J.fn.extend = function() {
                var e, t, i, n, r, o, a = arguments[0] || {},
                    s = 1,
                    l = arguments.length,
                    h = !1;
                for ("boolean" == typeof a && (h = a, a = arguments[s] || {}, s++), "object" == typeof a || J.isFunction(a) || (a = {}), s === l && (a = this, s--); l > s; s++)
                    if (null != (e = arguments[s]))
                        for (t in e) i = a[t], n = e[t], a !== n && (h && n && (J.isPlainObject(n) || (r = J.isArray(n))) ? (r ? (r = !1, o = i && J.isArray(i) ? i : []) : o = i && J.isPlainObject(i) ? i : {}, a[t] = J.extend(h, o, n)) : void 0 !== n && (a[t] = n));
                return a
            }, J.extend({
                expando: "jQuery" + (Q + Math.random()).replace(/\D/g, ""),
                isReady: !0,
                error: function(e) {
                    throw new Error(e)
                },
                noop: function() {},
                isFunction: function(e) {
                    return "function" === J.type(e)
                },
                isArray: Array.isArray,
                isWindow: function(e) {
                    return null != e && e === e.window
                },
                isNumeric: function(e) {
                    return !J.isArray(e) && e - parseFloat(e) + 1 >= 0
                },
                isPlainObject: function(e) {
                    return "object" !== J.type(e) || e.nodeType || J.isWindow(e) ? !1 : e.constructor && !K.call(e.constructor.prototype, "isPrototypeOf") ? !1 : !0
                },
                isEmptyObject: function(e) {
                    var t;
                    for (t in e) return !1;
                    return !0
                },
                type: function(e) {
                    return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? Z[Y.call(e)] || "object" : typeof e
                },
                globalEval: function(e) {
                    var t, i = eval;
                    e = J.trim(e), e && (1 === e.indexOf("use strict") ? (t = $.createElement("script"), t.text = e, $.head.appendChild(t).parentNode.removeChild(t)) : i(e))
                },
                camelCase: function(e) {
                    return e.replace(te, "ms-").replace(ie, ne)
                },
                nodeName: function(e, t) {
                    return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase()
                },
                each: function(e, t, n) {
                    var r, o = 0,
                        a = e.length,
                        s = i(e);
                    if (n) {
                        if (s)
                            for (; a > o && (r = t.apply(e[o], n), r !== !1); o++);
                        else
                            for (o in e)
                                if (r = t.apply(e[o], n), r === !1) break
                    } else if (s)
                        for (; a > o && (r = t.call(e[o], o, e[o]), r !== !1); o++);
                    else
                        for (o in e)
                            if (r = t.call(e[o], o, e[o]), r === !1) break;
                    return e
                },
                trim: function(e) {
                    return null == e ? "" : (e + "").replace(ee, "")
                },
                makeArray: function(e, t) {
                    var n = t || [];
                    return null != e && (i(Object(e)) ? J.merge(n, "string" == typeof e ? [e] : e) : q.call(n, e)), n
                },
                inArray: function(e, t, i) {
                    return null == t ? -1 : V.call(t, e, i)
                },
                merge: function(e, t) {
                    for (var i = +t.length, n = 0, r = e.length; i > n; n++) e[r++] = t[n];
                    return e.length = r, e
                },
                grep: function(e, t, i) {
                    for (var n, r = [], o = 0, a = e.length, s = !i; a > o; o++) n = !t(e[o], o), n !== s && r.push(e[o]);
                    return r
                },
                map: function(e, t, n) {
                    var r, o = 0,
                        a = e.length,
                        s = i(e),
                        l = [];
                    if (s)
                        for (; a > o; o++) r = t(e[o], o, n), null != r && l.push(r);
                    else
                        for (o in e) r = t(e[o], o, n), null != r && l.push(r);
                    return j.apply([], l)
                },
                guid: 1,
                proxy: function(e, t) {
                    var i, n, r;
                    return "string" == typeof t && (i = e[t], t = e, e = i), J.isFunction(e) ? (n = G.call(arguments, 2), r = function() {
                        return e.apply(t || this, n.concat(G.call(arguments)))
                    }, r.guid = e.guid = e.guid || J.guid++, r) : void 0
                },
                now: Date.now,
                support: X
            }), J.each("Boolean Number String Function Array Date RegExp Object Error".split(" "), function(e, t) {
                Z["[object " + t + "]"] = t.toLowerCase()
            });
            var re = function(e) {
                function t(e, t, i, n) {
                    var r, o, a, s, l, h, d, f, p, m;
                    if ((t ? t.ownerDocument || t : H) !== R && A(t), t = t || R, i = i || [], s = t.nodeType, "string" != typeof e || !e || 1 !== s && 9 !== s && 11 !== s) return i;
                    if (!n && I) {
                        if (11 !== s && (r = ve.exec(e)))
                            if (a = r[1]) {
                                if (9 === s) {
                                    if (o = t.getElementById(a), !o || !o.parentNode) return i;
                                    if (o.id === a) return i.push(o), i
                                } else if (t.ownerDocument && (o = t.ownerDocument.getElementById(a)) && F(t, o) && o.id === a) return i.push(o), i
                            } else {
                                if (r[2]) return Q.apply(i, t.getElementsByTagName(e)), i;
                                if ((a = r[3]) && x.getElementsByClassName) return Q.apply(i, t.getElementsByClassName(a)), i
                            }
                        if (x.qsa && (!O || !O.test(e))) {
                            if (f = d = z, p = t, m = 1 !== s && e, 1 === s && "object" !== t.nodeName.toLowerCase()) {
                                for (h = S(e), (d = t.getAttribute("id")) ? f = d.replace(be, "\\$&") : t.setAttribute("id", f), f = "[id='" + f + "'] ", l = h.length; l--;) h[l] = f + c(h[l]);
                                p = ye.test(e) && u(t.parentNode) || t, m = h.join(",")
                            }
                            if (m) try {
                                return Q.apply(i, p.querySelectorAll(m)), i
                            } catch (g) {} finally {
                                d || t.removeAttribute("id")
                            }
                        }
                    }
                    return E(e.replace(le, "$1"), t, i, n)
                }

                function i() {
                    function e(i, n) {
                        return t.push(i + " ") > w.cacheLength && delete e[t.shift()], e[i + " "] = n
                    }
                    var t = [];
                    return e
                }

                function n(e) {
                    return e[z] = !0, e
                }

                function r(e) {
                    var t = R.createElement("div");
                    try {
                        return !!e(t)
                    } catch (i) {
                        return !1
                    } finally {
                        t.parentNode && t.parentNode.removeChild(t), t = null
                    }
                }

                function o(e, t) {
                    for (var i = e.split("|"), n = e.length; n--;) w.attrHandle[i[n]] = t
                }

                function a(e, t) {
                    var i = t && e,
                        n = i && 1 === e.nodeType && 1 === t.nodeType && (~t.sourceIndex || Z) - (~e.sourceIndex || Z);
                    if (n) return n;
                    if (i)
                        for (; i = i.nextSibling;)
                            if (i === t) return -1;
                    return e ? 1 : -1
                }

                function s(e) {
                    return function(t) {
                        var i = t.nodeName.toLowerCase();
                        return "input" === i && t.type === e
                    }
                }

                function l(e) {
                    return function(t) {
                        var i = t.nodeName.toLowerCase();
                        return ("input" === i || "button" === i) && t.type === e
                    }
                }

                function h(e) {
                    return n(function(t) {
                        return t = +t, n(function(i, n) {
                            for (var r, o = e([], i.length, t), a = o.length; a--;) i[r = o[a]] && (i[r] = !(n[r] = i[r]))
                        })
                    })
                }

                function u(e) {
                    return e && "undefined" != typeof e.getElementsByTagName && e
                }

                function d() {}

                function c(e) {
                    for (var t = 0, i = e.length, n = ""; i > t; t++) n += e[t].value;
                    return n
                }

                function f(e, t, i) {
                    var n = t.dir,
                        r = i && "parentNode" === n,
                        o = W++;
                    return t.first ? function(t, i, o) {
                        for (; t = t[n];)
                            if (1 === t.nodeType || r) return e(t, i, o)
                    } : function(t, i, a) {
                        var s, l, h = [U, o];
                        if (a) {
                            for (; t = t[n];)
                                if ((1 === t.nodeType || r) && e(t, i, a)) return !0
                        } else
                            for (; t = t[n];)
                                if (1 === t.nodeType || r) {
                                    if (l = t[z] || (t[z] = {}), (s = l[n]) && s[0] === U && s[1] === o) return h[2] = s[2];
                                    if (l[n] = h, h[2] = e(t, i, a)) return !0
                                }
                    }
                }

                function p(e) {
                    return e.length > 1 ? function(t, i, n) {
                        for (var r = e.length; r--;)
                            if (!e[r](t, i, n)) return !1;
                        return !0
                    } : e[0]
                }

                function m(e, i, n) {
                    for (var r = 0, o = i.length; o > r; r++) t(e, i[r], n);
                    return n
                }

                function g(e, t, i, n, r) {
                    for (var o, a = [], s = 0, l = e.length, h = null != t; l > s; s++)(o = e[s]) && (!i || i(o, n, r)) && (a.push(o), h && t.push(s));
                    return a
                }

                function _(e, t, i, r, o, a) {
                    return r && !r[z] && (r = _(r)), o && !o[z] && (o = _(o, a)), n(function(n, a, s, l) {
                        var h, u, d, c = [],
                            f = [],
                            p = a.length,
                            _ = n || m(t || "*", s.nodeType ? [s] : s, []),
                            v = !e || !n && t ? _ : g(_, c, e, s, l),
                            y = i ? o || (n ? e : p || r) ? [] : a : v;
                        if (i && i(v, y, s, l), r)
                            for (h = g(y, f), r(h, [], s, l), u = h.length; u--;)(d = h[u]) && (y[f[u]] = !(v[f[u]] = d));
                        if (n) {
                            if (o || e) {
                                if (o) {
                                    for (h = [], u = y.length; u--;)(d = y[u]) && h.push(v[u] = d);
                                    o(null, y = [], h, l)
                                }
                                for (u = y.length; u--;)(d = y[u]) && (h = o ? ee(n, d) : c[u]) > -1 && (n[h] = !(a[h] = d))
                            }
                        } else y = g(y === a ? y.splice(p, y.length) : y), o ? o(null, a, y, l) : Q.apply(a, y)
                    })
                }

                function v(e) {
                    for (var t, i, n, r = e.length, o = w.relative[e[0].type], a = o || w.relative[" "], s = o ? 1 : 0, l = f(function(e) {
                            return e === t
                        }, a, !0), h = f(function(e) {
                            return ee(t, e) > -1
                        }, a, !0), u = [function(e, i, n) {
                            var r = !o && (n || i !== k) || ((t = i).nodeType ? l(e, i, n) : h(e, i, n));
                            return t = null, r
                        }]; r > s; s++)
                        if (i = w.relative[e[s].type]) u = [f(p(u), i)];
                        else {
                            if (i = w.filter[e[s].type].apply(null, e[s].matches), i[z]) {
                                for (n = ++s; r > n && !w.relative[e[n].type]; n++);
                                return _(s > 1 && p(u), s > 1 && c(e.slice(0, s - 1).concat({
                                    value: " " === e[s - 2].type ? "*" : ""
                                })).replace(le, "$1"), i, n > s && v(e.slice(s, n)), r > n && v(e = e.slice(n)), r > n && c(e))
                            }
                            u.push(i)
                        }
                    return p(u)
                }

                function y(e, i) {
                    var r = i.length > 0,
                        o = e.length > 0,
                        a = function(n, a, s, l, h) {
                            var u, d, c, f = 0,
                                p = "0",
                                m = n && [],
                                _ = [],
                                v = k,
                                y = n || o && w.find.TAG("*", h),
                                b = U += null == v ? 1 : Math.random() || .1,
                                x = y.length;
                            for (h && (k = a !== R && a); p !== x && null != (u = y[p]); p++) {
                                if (o && u) {
                                    for (d = 0; c = e[d++];)
                                        if (c(u, a, s)) {
                                            l.push(u);
                                            break
                                        }
                                    h && (U = b)
                                }
                                r && ((u = !c && u) && f--, n && m.push(u))
                            }
                            if (f += p, r && p !== f) {
                                for (d = 0; c = i[d++];) c(m, _, a, s);
                                if (n) {
                                    if (f > 0)
                                        for (; p--;) m[p] || _[p] || (_[p] = X.call(l));
                                    _ = g(_)
                                }
                                Q.apply(l, _), h && !n && _.length > 0 && f + i.length > 1 && t.uniqueSort(l)
                            }
                            return h && (U = b, k = v), m
                        };
                    return r ? n(a) : a
                }
                var b, x, w, M, T, S, C, E, k, L, P, A, R, D, I, O, N, B, F, z = "sizzle" + 1 * new Date,
                    H = e.document,
                    U = 0,
                    W = 0,
                    G = i(),
                    j = i(),
                    q = i(),
                    V = function(e, t) {
                        return e === t && (P = !0), 0
                    },
                    Z = 1 << 31,
                    Y = {}.hasOwnProperty,
                    K = [],
                    X = K.pop,
                    $ = K.push,
                    Q = K.push,
                    J = K.slice,
                    ee = function(e, t) {
                        for (var i = 0, n = e.length; n > i; i++)
                            if (e[i] === t) return i;
                        return -1
                    },
                    te = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",
                    ie = "[\\x20\\t\\r\\n\\f]",
                    ne = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",
                    re = ne.replace("w", "w#"),
                    oe = "\\[" + ie + "*(" + ne + ")(?:" + ie + "*([*^$|!~]?=)" + ie + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + re + "))|)" + ie + "*\\]",
                    ae = ":(" + ne + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + oe + ")*)|.*)\\)|)",
                    se = new RegExp(ie + "+", "g"),
                    le = new RegExp("^" + ie + "+|((?:^|[^\\\\])(?:\\\\.)*)" + ie + "+$", "g"),
                    he = new RegExp("^" + ie + "*," + ie + "*"),
                    ue = new RegExp("^" + ie + "*([>+~]|" + ie + ")" + ie + "*"),
                    de = new RegExp("=" + ie + "*([^\\]'\"]*?)" + ie + "*\\]", "g"),
                    ce = new RegExp(ae),
                    fe = new RegExp("^" + re + "$"),
                    pe = {
                        ID: new RegExp("^#(" + ne + ")"),
                        CLASS: new RegExp("^\\.(" + ne + ")"),
                        TAG: new RegExp("^(" + ne.replace("w", "w*") + ")"),
                        ATTR: new RegExp("^" + oe),
                        PSEUDO: new RegExp("^" + ae),
                        CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + ie + "*(even|odd|(([+-]|)(\\d*)n|)" + ie + "*(?:([+-]|)" + ie + "*(\\d+)|))" + ie + "*\\)|)", "i"),
                        bool: new RegExp("^(?:" + te + ")$", "i"),
                        needsContext: new RegExp("^" + ie + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + ie + "*((?:-\\d)?\\d*)" + ie + "*\\)|)(?=[^-]|$)", "i")
                    },
                    me = /^(?:input|select|textarea|button)$/i,
                    ge = /^h\d$/i,
                    _e = /^[^{]+\{\s*\[native \w/,
                    ve = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,
                    ye = /[+~]/,
                    be = /'|\\/g,
                    xe = new RegExp("\\\\([\\da-f]{1,6}" + ie + "?|(" + ie + ")|.)", "ig"),
                    we = function(e, t, i) {
                        var n = "0x" + t - 65536;
                        return n !== n || i ? t : 0 > n ? String.fromCharCode(n + 65536) : String.fromCharCode(n >> 10 | 55296, 1023 & n | 56320)
                    },
                    Me = function() {
                        A()
                    };
                try {
                    Q.apply(K = J.call(H.childNodes), H.childNodes), K[H.childNodes.length].nodeType
                } catch (Te) {
                    Q = {
                        apply: K.length ? function(e, t) {
                            $.apply(e, J.call(t))
                        } : function(e, t) {
                            for (var i = e.length, n = 0; e[i++] = t[n++];);
                            e.length = i - 1
                        }
                    }
                }
                x = t.support = {}, T = t.isXML = function(e) {
                    var t = e && (e.ownerDocument || e).documentElement;
                    return t ? "HTML" !== t.nodeName : !1
                }, A = t.setDocument = function(e) {
                    var t, i, n = e ? e.ownerDocument || e : H;
                    return n !== R && 9 === n.nodeType && n.documentElement ? (R = n, D = n.documentElement, i = n.defaultView, i && i !== i.top && (i.addEventListener ? i.addEventListener("unload", Me, !1) : i.attachEvent && i.attachEvent("onunload", Me)), I = !T(n), x.attributes = r(function(e) {
                        return e.className = "i", !e.getAttribute("className")
                    }), x.getElementsByTagName = r(function(e) {
                        return e.appendChild(n.createComment("")), !e.getElementsByTagName("*").length
                    }), x.getElementsByClassName = _e.test(n.getElementsByClassName), x.getById = r(function(e) {
                        return D.appendChild(e).id = z, !n.getElementsByName || !n.getElementsByName(z).length
                    }), x.getById ? (w.find.ID = function(e, t) {
                        if ("undefined" != typeof t.getElementById && I) {
                            var i = t.getElementById(e);
                            return i && i.parentNode ? [i] : []
                        }
                    }, w.filter.ID = function(e) {
                        var t = e.replace(xe, we);
                        return function(e) {
                            return e.getAttribute("id") === t
                        }
                    }) : (delete w.find.ID, w.filter.ID = function(e) {
                        var t = e.replace(xe, we);
                        return function(e) {
                            var i = "undefined" != typeof e.getAttributeNode && e.getAttributeNode("id");
                            return i && i.value === t
                        }
                    }), w.find.TAG = x.getElementsByTagName ? function(e, t) {
                        return "undefined" != typeof t.getElementsByTagName ? t.getElementsByTagName(e) : x.qsa ? t.querySelectorAll(e) : void 0
                    } : function(e, t) {
                        var i, n = [],
                            r = 0,
                            o = t.getElementsByTagName(e);
                        if ("*" === e) {
                            for (; i = o[r++];) 1 === i.nodeType && n.push(i);
                            return n
                        }
                        return o
                    }, w.find.CLASS = x.getElementsByClassName && function(e, t) {
                        return I ? t.getElementsByClassName(e) : void 0
                    }, N = [], O = [], (x.qsa = _e.test(n.querySelectorAll)) && (r(function(e) {
                        D.appendChild(e).innerHTML = "<a id='" + z + "'></a><select id='" + z + "-\f]' msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && O.push("[*^$]=" + ie + "*(?:''|\"\")"), e.querySelectorAll("[selected]").length || O.push("\\[" + ie + "*(?:value|" + te + ")"), e.querySelectorAll("[id~=" + z + "-]").length || O.push("~="), e.querySelectorAll(":checked").length || O.push(":checked"), e.querySelectorAll("a#" + z + "+*").length || O.push(".#.+[+~]")
                    }), r(function(e) {
                        var t = n.createElement("input");
                        t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && O.push("name" + ie + "*[*^$|!~]?="), e.querySelectorAll(":enabled").length || O.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), O.push(",.*:")
                    })), (x.matchesSelector = _e.test(B = D.matches || D.webkitMatchesSelector || D.mozMatchesSelector || D.oMatchesSelector || D.msMatchesSelector)) && r(function(e) {
                        x.disconnectedMatch = B.call(e, "div"), B.call(e, "[s!='']:x"), N.push("!=", ae)
                    }), O = O.length && new RegExp(O.join("|")), N = N.length && new RegExp(N.join("|")), t = _e.test(D.compareDocumentPosition), F = t || _e.test(D.contains) ? function(e, t) {
                        var i = 9 === e.nodeType ? e.documentElement : e,
                            n = t && t.parentNode;
                        return e === n || !(!n || 1 !== n.nodeType || !(i.contains ? i.contains(n) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(n)))
                    } : function(e, t) {
                        if (t)
                            for (; t = t.parentNode;)
                                if (t === e) return !0;
                        return !1
                    }, V = t ? function(e, t) {
                        if (e === t) return P = !0, 0;
                        var i = !e.compareDocumentPosition - !t.compareDocumentPosition;
                        return i ? i : (i = (e.ownerDocument || e) === (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1, 1 & i || !x.sortDetached && t.compareDocumentPosition(e) === i ? e === n || e.ownerDocument === H && F(H, e) ? -1 : t === n || t.ownerDocument === H && F(H, t) ? 1 : L ? ee(L, e) - ee(L, t) : 0 : 4 & i ? -1 : 1)
                    } : function(e, t) {
                        if (e === t) return P = !0, 0;
                        var i, r = 0,
                            o = e.parentNode,
                            s = t.parentNode,
                            l = [e],
                            h = [t];
                        if (!o || !s) return e === n ? -1 : t === n ? 1 : o ? -1 : s ? 1 : L ? ee(L, e) - ee(L, t) : 0;
                        if (o === s) return a(e, t);
                        for (i = e; i = i.parentNode;) l.unshift(i);
                        for (i = t; i = i.parentNode;) h.unshift(i);
                        for (; l[r] === h[r];) r++;
                        return r ? a(l[r], h[r]) : l[r] === H ? -1 : h[r] === H ? 1 : 0
                    }, n) : R
                }, t.matches = function(e, i) {
                    return t(e, null, null, i)
                }, t.matchesSelector = function(e, i) {
                    if ((e.ownerDocument || e) !== R && A(e), i = i.replace(de, "='$1']"), x.matchesSelector && I && (!N || !N.test(i)) && (!O || !O.test(i))) try {
                        var n = B.call(e, i);
                        if (n || x.disconnectedMatch || e.document && 11 !== e.document.nodeType) return n
                    } catch (r) {}
                    return t(i, R, null, [e]).length > 0
                }, t.contains = function(e, t) {
                    return (e.ownerDocument || e) !== R && A(e), F(e, t)
                }, t.attr = function(e, t) {
                    (e.ownerDocument || e) !== R && A(e);
                    var i = w.attrHandle[t.toLowerCase()],
                        n = i && Y.call(w.attrHandle, t.toLowerCase()) ? i(e, t, !I) : void 0;
                    return void 0 !== n ? n : x.attributes || !I ? e.getAttribute(t) : (n = e.getAttributeNode(t)) && n.specified ? n.value : null
                }, t.error = function(e) {
                    throw new Error("Syntax error, unrecognized expression: " + e)
                }, t.uniqueSort = function(e) {
                    var t, i = [],
                        n = 0,
                        r = 0;
                    if (P = !x.detectDuplicates, L = !x.sortStable && e.slice(0), e.sort(V), P) {
                        for (; t = e[r++];) t === e[r] && (n = i.push(r));
                        for (; n--;) e.splice(i[n], 1)
                    }
                    return L = null, e
                }, M = t.getText = function(e) {
                    var t, i = "",
                        n = 0,
                        r = e.nodeType;
                    if (r) {
                        if (1 === r || 9 === r || 11 === r) {
                            if ("string" == typeof e.textContent) return e.textContent;
                            for (e = e.firstChild; e; e = e.nextSibling) i += M(e)
                        } else if (3 === r || 4 === r) return e.nodeValue
                    } else
                        for (; t = e[n++];) i += M(t);
                    return i
                }, w = t.selectors = {
                    cacheLength: 50,
                    createPseudo: n,
                    match: pe,
                    attrHandle: {},
                    find: {},
                    relative: {
                        ">": {
                            dir: "parentNode",
                            first: !0
                        },
                        " ": {
                            dir: "parentNode"
                        },
                        "+": {
                            dir: "previousSibling",
                            first: !0
                        },
                        "~": {
                            dir: "previousSibling"
                        }
                    },
                    preFilter: {
                        ATTR: function(e) {
                            return e[1] = e[1].replace(xe, we), e[3] = (e[3] || e[4] || e[5] || "").replace(xe, we), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4)
                        },
                        CHILD: function(e) {
                            return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || t.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && t.error(e[0]), e
                        },
                        PSEUDO: function(e) {
                            var t, i = !e[6] && e[2];
                            return pe.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : i && ce.test(i) && (t = S(i, !0)) && (t = i.indexOf(")", i.length - t) - i.length) && (e[0] = e[0].slice(0, t), e[2] = i.slice(0, t)), e.slice(0, 3))
                        }
                    },
                    filter: {
                        TAG: function(e) {
                            var t = e.replace(xe, we).toLowerCase();
                            return "*" === e ? function() {
                                return !0
                            } : function(e) {
                                return e.nodeName && e.nodeName.toLowerCase() === t
                            }
                        },
                        CLASS: function(e) {
                            var t = G[e + " "];
                            return t || (t = new RegExp("(^|" + ie + ")" + e + "(" + ie + "|$)")) && G(e, function(e) {
                                return t.test("string" == typeof e.className && e.className || "undefined" != typeof e.getAttribute && e.getAttribute("class") || "")
                            })
                        },
                        ATTR: function(e, i, n) {
                            return function(r) {
                                var o = t.attr(r, e);
                                return null == o ? "!=" === i : i ? (o += "", "=" === i ? o === n : "!=" === i ? o !== n : "^=" === i ? n && 0 === o.indexOf(n) : "*=" === i ? n && o.indexOf(n) > -1 : "$=" === i ? n && o.slice(-n.length) === n : "~=" === i ? (" " + o.replace(se, " ") + " ").indexOf(n) > -1 : "|=" === i ? o === n || o.slice(0, n.length + 1) === n + "-" : !1) : !0
                            }
                        },
                        CHILD: function(e, t, i, n, r) {
                            var o = "nth" !== e.slice(0, 3),
                                a = "last" !== e.slice(-4),
                                s = "of-type" === t;
                            return 1 === n && 0 === r ? function(e) {
                                return !!e.parentNode
                            } : function(t, i, l) {
                                var h, u, d, c, f, p, m = o !== a ? "nextSibling" : "previousSibling",
                                    g = t.parentNode,
                                    _ = s && t.nodeName.toLowerCase(),
                                    v = !l && !s;
                                if (g) {
                                    if (o) {
                                        for (; m;) {
                                            for (d = t; d = d[m];)
                                                if (s ? d.nodeName.toLowerCase() === _ : 1 === d.nodeType) return !1;
                                            p = m = "only" === e && !p && "nextSibling"
                                        }
                                        return !0
                                    }
                                    if (p = [a ? g.firstChild : g.lastChild], a && v) {
                                        for (u = g[z] || (g[z] = {}), h = u[e] || [], f = h[0] === U && h[1], c = h[0] === U && h[2], d = f && g.childNodes[f]; d = ++f && d && d[m] || (c = f = 0) || p.pop();)
                                            if (1 === d.nodeType && ++c && d === t) {
                                                u[e] = [U, f, c];
                                                break
                                            }
                                    } else if (v && (h = (t[z] || (t[z] = {}))[e]) && h[0] === U) c = h[1];
                                    else
                                        for (;
                                            (d = ++f && d && d[m] || (c = f = 0) || p.pop()) && ((s ? d.nodeName.toLowerCase() !== _ : 1 !== d.nodeType) || !++c || (v && ((d[z] || (d[z] = {}))[e] = [U, c]), d !== t)););
                                    return c -= r, c === n || c % n === 0 && c / n >= 0
                                }
                            }
                        },
                        PSEUDO: function(e, i) {
                            var r, o = w.pseudos[e] || w.setFilters[e.toLowerCase()] || t.error("unsupported pseudo: " + e);
                            return o[z] ? o(i) : o.length > 1 ? (r = [e, e, "", i], w.setFilters.hasOwnProperty(e.toLowerCase()) ? n(function(e, t) {
                                for (var n, r = o(e, i), a = r.length; a--;) n = ee(e, r[a]), e[n] = !(t[n] = r[a])
                            }) : function(e) {
                                return o(e, 0, r)
                            }) : o
                        }
                    },
                    pseudos: {
                        not: n(function(e) {
                            var t = [],
                                i = [],
                                r = C(e.replace(le, "$1"));
                            return r[z] ? n(function(e, t, i, n) {
                                for (var o, a = r(e, null, n, []), s = e.length; s--;)(o = a[s]) && (e[s] = !(t[s] = o))
                            }) : function(e, n, o) {
                                return t[0] = e, r(t, null, o, i), t[0] = null, !i.pop()
                            }
                        }),
                        has: n(function(e) {
                            return function(i) {
                                return t(e, i).length > 0
                            }
                        }),
                        contains: n(function(e) {
                            return e = e.replace(xe, we),
                                function(t) {
                                    return (t.textContent || t.innerText || M(t)).indexOf(e) > -1
                                }
                        }),
                        lang: n(function(e) {
                            return fe.test(e || "") || t.error("unsupported lang: " + e), e = e.replace(xe, we).toLowerCase(),
                                function(t) {
                                    var i;
                                    do
                                        if (i = I ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return i = i.toLowerCase(), i === e || 0 === i.indexOf(e + "-"); while ((t = t.parentNode) && 1 === t.nodeType);
                                    return !1
                                }
                        }),
                        target: function(t) {
                            var i = e.location && e.location.hash;
                            return i && i.slice(1) === t.id
                        },
                        root: function(e) {
                            return e === D
                        },
                        focus: function(e) {
                            return e === R.activeElement && (!R.hasFocus || R.hasFocus()) && !!(e.type || e.href || ~e.tabIndex)
                        },
                        enabled: function(e) {
                            return e.disabled === !1
                        },
                        disabled: function(e) {
                            return e.disabled === !0
                        },
                        checked: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return "input" === t && !!e.checked || "option" === t && !!e.selected
                        },
                        selected: function(e) {
                            return e.parentNode && e.parentNode.selectedIndex, e.selected === !0
                        },
                        empty: function(e) {
                            for (e = e.firstChild; e; e = e.nextSibling)
                                if (e.nodeType < 6) return !1;
                            return !0
                        },
                        parent: function(e) {
                            return !w.pseudos.empty(e)
                        },
                        header: function(e) {
                            return ge.test(e.nodeName)
                        },
                        input: function(e) {
                            return me.test(e.nodeName)
                        },
                        button: function(e) {
                            var t = e.nodeName.toLowerCase();
                            return "input" === t && "button" === e.type || "button" === t
                        },
                        text: function(e) {
                            var t;
                            return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase())
                        },
                        first: h(function() {
                            return [0]
                        }),
                        last: h(function(e, t) {
                            return [t - 1]
                        }),
                        eq: h(function(e, t, i) {
                            return [0 > i ? i + t : i]
                        }),
                        even: h(function(e, t) {
                            for (var i = 0; t > i; i += 2) e.push(i);
                            return e
                        }),
                        odd: h(function(e, t) {
                            for (var i = 1; t > i; i += 2) e.push(i);
                            return e
                        }),
                        lt: h(function(e, t, i) {
                            for (var n = 0 > i ? i + t : i; --n >= 0;) e.push(n);
                            return e
                        }),
                        gt: h(function(e, t, i) {
                            for (var n = 0 > i ? i + t : i; ++n < t;) e.push(n);
                            return e
                        })
                    }
                }, w.pseudos.nth = w.pseudos.eq;
                for (b in {
                        radio: !0,
                        checkbox: !0,
                        file: !0,
                        password: !0,
                        image: !0
                    }) w.pseudos[b] = s(b);
                for (b in {
                        submit: !0,
                        reset: !0
                    }) w.pseudos[b] = l(b);
                return d.prototype = w.filters = w.pseudos, w.setFilters = new d, S = t.tokenize = function(e, i) {
                    var n, r, o, a, s, l, h, u = j[e + " "];
                    if (u) return i ? 0 : u.slice(0);
                    for (s = e, l = [], h = w.preFilter; s;) {
                        (!n || (r = he.exec(s))) && (r && (s = s.slice(r[0].length) || s), l.push(o = [])), n = !1, (r = ue.exec(s)) && (n = r.shift(), o.push({
                            value: n,
                            type: r[0].replace(le, " ")
                        }), s = s.slice(n.length));
                        for (a in w.filter) !(r = pe[a].exec(s)) || h[a] && !(r = h[a](r)) || (n = r.shift(), o.push({
                            value: n,
                            type: a,
                            matches: r
                        }), s = s.slice(n.length));
                        if (!n) break
                    }
                    return i ? s.length : s ? t.error(e) : j(e, l).slice(0)
                }, C = t.compile = function(e, t) {
                    var i, n = [],
                        r = [],
                        o = q[e + " "];
                    if (!o) {
                        for (t || (t = S(e)), i = t.length; i--;) o = v(t[i]), o[z] ? n.push(o) : r.push(o);
                        o = q(e, y(r, n)), o.selector = e
                    }
                    return o
                }, E = t.select = function(e, t, i, n) {
                    var r, o, a, s, l, h = "function" == typeof e && e,
                        d = !n && S(e = h.selector || e);
                    if (i = i || [], 1 === d.length) {
                        if (o = d[0] = d[0].slice(0), o.length > 2 && "ID" === (a = o[0]).type && x.getById && 9 === t.nodeType && I && w.relative[o[1].type]) {
                            if (t = (w.find.ID(a.matches[0].replace(xe, we), t) || [])[0], !t) return i;
                            h && (t = t.parentNode), e = e.slice(o.shift().value.length)
                        }
                        for (r = pe.needsContext.test(e) ? 0 : o.length; r-- && (a = o[r], !w.relative[s = a.type]);)
                            if ((l = w.find[s]) && (n = l(a.matches[0].replace(xe, we), ye.test(o[0].type) && u(t.parentNode) || t))) {
                                if (o.splice(r, 1), e = n.length && c(o), !e) return Q.apply(i, n), i;
                                break
                            }
                    }
                    return (h || C(e, d))(n, t, !I, i, ye.test(e) && u(t.parentNode) || t), i
                }, x.sortStable = z.split("").sort(V).join("") === z, x.detectDuplicates = !!P, A(), x.sortDetached = r(function(e) {
                    return 1 & e.compareDocumentPosition(R.createElement("div"))
                }), r(function(e) {
                    return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href")
                }) || o("type|href|height|width", function(e, t, i) {
                    return i ? void 0 : e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2)
                }), x.attributes && r(function(e) {
                    return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value")
                }) || o("value", function(e, t, i) {
                    return i || "input" !== e.nodeName.toLowerCase() ? void 0 : e.defaultValue
                }), r(function(e) {
                    return null == e.getAttribute("disabled")
                }) || o(te, function(e, t, i) {
                    var n;
                    return i ? void 0 : e[t] === !0 ? t.toLowerCase() : (n = e.getAttributeNode(t)) && n.specified ? n.value : null
                }), t
            }(e);
            J.find = re, J.expr = re.selectors, J.expr[":"] = J.expr.pseudos, J.unique = re.uniqueSort, J.text = re.getText, J.isXMLDoc = re.isXML, J.contains = re.contains;
            var oe = J.expr.match.needsContext,
                ae = /^<(\w+)\s*\/?>(?:<\/\1>|)$/,
                se = /^.[^:#\[\.,]*$/;
            J.filter = function(e, t, i) {
                var n = t[0];
                return i && (e = ":not(" + e + ")"), 1 === t.length && 1 === n.nodeType ? J.find.matchesSelector(n, e) ? [n] : [] : J.find.matches(e, J.grep(t, function(e) {
                    return 1 === e.nodeType
                }))
            }, J.fn.extend({
                find: function(e) {
                    var t, i = this.length,
                        n = [],
                        r = this;
                    if ("string" != typeof e) return this.pushStack(J(e).filter(function() {
                        for (t = 0; i > t; t++)
                            if (J.contains(r[t], this)) return !0
                    }));
                    for (t = 0; i > t; t++) J.find(e, r[t], n);
                    return n = this.pushStack(i > 1 ? J.unique(n) : n), n.selector = this.selector ? this.selector + " " + e : e, n
                },
                filter: function(e) {
                    return this.pushStack(n(this, e || [], !1))
                },
                not: function(e) {
                    return this.pushStack(n(this, e || [], !0))
                },
                is: function(e) {
                    return !!n(this, "string" == typeof e && oe.test(e) ? J(e) : e || [], !1).length
                }
            });
            var le, he = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,
                ue = J.fn.init = function(e, t) {
                    var i, n;
                    if (!e) return this;
                    if ("string" == typeof e) {
                        if (i = "<" === e[0] && ">" === e[e.length - 1] && e.length >= 3 ? [null, e, null] : he.exec(e), !i || !i[1] && t) return !t || t.jquery ? (t || le).find(e) : this.constructor(t).find(e);
                        if (i[1]) {
                            if (t = t instanceof J ? t[0] : t, J.merge(this, J.parseHTML(i[1], t && t.nodeType ? t.ownerDocument || t : $, !0)), ae.test(i[1]) && J.isPlainObject(t))
                                for (i in t) J.isFunction(this[i]) ? this[i](t[i]) : this.attr(i, t[i]);
                            return this
                        }
                        return n = $.getElementById(i[2]), n && n.parentNode && (this.length = 1, this[0] = n), this.context = $, this.selector = e, this
                    }
                    return e.nodeType ? (this.context = this[0] = e, this.length = 1, this) : J.isFunction(e) ? "undefined" != typeof le.ready ? le.ready(e) : e(J) : (void 0 !== e.selector && (this.selector = e.selector, this.context = e.context), J.makeArray(e, this))
                };
            ue.prototype = J.fn, le = J($);
            var de = /^(?:parents|prev(?:Until|All))/,
                ce = {
                    children: !0,
                    contents: !0,
                    next: !0,
                    prev: !0
                };
            J.extend({
                dir: function(e, t, i) {
                    for (var n = [], r = void 0 !== i;
                        (e = e[t]) && 9 !== e.nodeType;)
                        if (1 === e.nodeType) {
                            if (r && J(e).is(i)) break;
                            n.push(e)
                        }
                    return n
                },
                sibling: function(e, t) {
                    for (var i = []; e; e = e.nextSibling) 1 === e.nodeType && e !== t && i.push(e);
                    return i
                }
            }), J.fn.extend({
                has: function(e) {
                    var t = J(e, this),
                        i = t.length;
                    return this.filter(function() {
                        for (var e = 0; i > e; e++)
                            if (J.contains(this, t[e])) return !0
                    })
                },
                closest: function(e, t) {
                    for (var i, n = 0, r = this.length, o = [], a = oe.test(e) || "string" != typeof e ? J(e, t || this.context) : 0; r > n; n++)
                        for (i = this[n]; i && i !== t; i = i.parentNode)
                            if (i.nodeType < 11 && (a ? a.index(i) > -1 : 1 === i.nodeType && J.find.matchesSelector(i, e))) {
                                o.push(i);
                                break
                            }
                    return this.pushStack(o.length > 1 ? J.unique(o) : o)
                },
                index: function(e) {
                    return e ? "string" == typeof e ? V.call(J(e), this[0]) : V.call(this, e.jquery ? e[0] : e) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1
                },
                add: function(e, t) {
                    return this.pushStack(J.unique(J.merge(this.get(), J(e, t))))
                },
                addBack: function(e) {
                    return this.add(null == e ? this.prevObject : this.prevObject.filter(e))
                }
            }), J.each({
                parent: function(e) {
                    var t = e.parentNode;
                    return t && 11 !== t.nodeType ? t : null
                },
                parents: function(e) {
                    return J.dir(e, "parentNode")
                },
                parentsUntil: function(e, t, i) {
                    return J.dir(e, "parentNode", i)
                },
                next: function(e) {
                    return r(e, "nextSibling")
                },
                prev: function(e) {
                    return r(e, "previousSibling")
                },
                nextAll: function(e) {
                    return J.dir(e, "nextSibling")
                },
                prevAll: function(e) {
                    return J.dir(e, "previousSibling")
                },
                nextUntil: function(e, t, i) {
                    return J.dir(e, "nextSibling", i)
                },
                prevUntil: function(e, t, i) {
                    return J.dir(e, "previousSibling", i)
                },
                siblings: function(e) {
                    return J.sibling((e.parentNode || {}).firstChild, e)
                },
                children: function(e) {
                    return J.sibling(e.firstChild)
                },
                contents: function(e) {
                    return e.contentDocument || J.merge([], e.childNodes)
                }
            }, function(e, t) {
                J.fn[e] = function(i, n) {
                    var r = J.map(this, t, i);
                    return "Until" !== e.slice(-5) && (n = i), n && "string" == typeof n && (r = J.filter(n, r)), this.length > 1 && (ce[e] || J.unique(r), de.test(e) && r.reverse()), this.pushStack(r)
                }
            });
            var fe = /\S+/g,
                pe = {};
            J.Callbacks = function(e) {
                e = "string" == typeof e ? pe[e] || o(e) : J.extend({}, e);
                var t, i, n, r, a, s, l = [],
                    h = !e.once && [],
                    u = function(o) {
                        for (t = e.memory && o, i = !0, s = r || 0, r = 0, a = l.length, n = !0; l && a > s; s++)
                            if (l[s].apply(o[0], o[1]) === !1 && e.stopOnFalse) {
                                t = !1;
                                break
                            }
                        n = !1, l && (h ? h.length && u(h.shift()) : t ? l = [] : d.disable())
                    },
                    d = {
                        add: function() {
                            if (l) {
                                var i = l.length;
                                ! function o(t) {
                                    J.each(t, function(t, i) {
                                        var n = J.type(i);
                                        "function" === n ? e.unique && d.has(i) || l.push(i) : i && i.length && "string" !== n && o(i)
                                    })
                                }(arguments), n ? a = l.length : t && (r = i, u(t))
                            }
                            return this
                        },
                        remove: function() {
                            return l && J.each(arguments, function(e, t) {
                                for (var i;
                                    (i = J.inArray(t, l, i)) > -1;) l.splice(i, 1), n && (a >= i && a--, s >= i && s--)
                            }), this
                        },
                        has: function(e) {
                            return e ? J.inArray(e, l) > -1 : !(!l || !l.length)
                        },
                        empty: function() {
                            return l = [], a = 0, this
                        },
                        disable: function() {
                            return l = h = t = void 0, this
                        },
                        disabled: function() {
                            return !l
                        },
                        lock: function() {
                            return h = void 0, t || d.disable(), this
                        },
                        locked: function() {
                            return !h
                        },
                        fireWith: function(e, t) {
                            return !l || i && !h || (t = t || [], t = [e, t.slice ? t.slice() : t], n ? h.push(t) : u(t)), this
                        },
                        fire: function() {
                            return d.fireWith(this, arguments), this
                        },
                        fired: function() {
                            return !!i
                        }
                    };
                return d
            }, J.extend({
                Deferred: function(e) {
                    var t = [
                            ["resolve", "done", J.Callbacks("once memory"), "resolved"],
                            ["reject", "fail", J.Callbacks("once memory"), "rejected"],
                            ["notify", "progress", J.Callbacks("memory")]
                        ],
                        i = "pending",
                        n = {
                            state: function() {
                                return i
                            },
                            always: function() {
                                return r.done(arguments).fail(arguments), this
                            },
                            then: function() {
                                var e = arguments;
                                return J.Deferred(function(i) {
                                    J.each(t, function(t, o) {
                                        var a = J.isFunction(e[t]) && e[t];
                                        r[o[1]](function() {
                                            var e = a && a.apply(this, arguments);
                                            e && J.isFunction(e.promise) ? e.promise().done(i.resolve).fail(i.reject).progress(i.notify) : i[o[0] + "With"](this === n ? i.promise() : this, a ? [e] : arguments)
                                        })
                                    }), e = null
                                }).promise()
                            },
                            promise: function(e) {
                                return null != e ? J.extend(e, n) : n
                            }
                        },
                        r = {};
                    return n.pipe = n.then, J.each(t, function(e, o) {
                        var a = o[2],
                            s = o[3];
                        n[o[1]] = a.add, s && a.add(function() {
                            i = s
                        }, t[1 ^ e][2].disable, t[2][2].lock), r[o[0]] = function() {
                            return r[o[0] + "With"](this === r ? n : this, arguments), this
                        }, r[o[0] + "With"] = a.fireWith
                    }), n.promise(r), e && e.call(r, r), r
                },
                when: function(e) {
                    var t, i, n, r = 0,
                        o = G.call(arguments),
                        a = o.length,
                        s = 1 !== a || e && J.isFunction(e.promise) ? a : 0,
                        l = 1 === s ? e : J.Deferred(),
                        h = function(e, i, n) {
                            return function(r) {
                                i[e] = this, n[e] = arguments.length > 1 ? G.call(arguments) : r, n === t ? l.notifyWith(i, n) : --s || l.resolveWith(i, n)
                            }
                        };
                    if (a > 1)
                        for (t = new Array(a), i = new Array(a), n = new Array(a); a > r; r++) o[r] && J.isFunction(o[r].promise) ? o[r].promise().done(h(r, n, o)).fail(l.reject).progress(h(r, i, t)) : --s;
                    return s || l.resolveWith(n, o), l.promise()
                }
            });
            var me;
            J.fn.ready = function(e) {
                return J.ready.promise().done(e), this
            }, J.extend({
                isReady: !1,
                readyWait: 1,
                holdReady: function(e) {
                    e ? J.readyWait++ : J.ready(!0)
                },
                ready: function(e) {
                    (e === !0 ? --J.readyWait : J.isReady) || (J.isReady = !0, e !== !0 && --J.readyWait > 0 || (me.resolveWith($, [J]), J.fn.triggerHandler && (J($).triggerHandler("ready"), J($).off("ready"))))
                }
            }), J.ready.promise = function(t) {
                return me || (me = J.Deferred(), "complete" === $.readyState ? setTimeout(J.ready) : ($.addEventListener("DOMContentLoaded", a, !1), e.addEventListener("load", a, !1))), me.promise(t)
            }, J.ready.promise();
            var ge = J.access = function(e, t, i, n, r, o, a) {
                var s = 0,
                    l = e.length,
                    h = null == i;
                if ("object" === J.type(i)) {
                    r = !0;
                    for (s in i) J.access(e, t, s, i[s], !0, o, a)
                } else if (void 0 !== n && (r = !0, J.isFunction(n) || (a = !0), h && (a ? (t.call(e, n), t = null) : (h = t, t = function(e, t, i) {
                        return h.call(J(e), i)
                    })), t))
                    for (; l > s; s++) t(e[s], i, a ? n : n.call(e[s], s, t(e[s], i)));
                return r ? e : h ? t.call(e) : l ? t(e[0], i) : o
            };
            J.acceptData = function(e) {
                return 1 === e.nodeType || 9 === e.nodeType || !+e.nodeType
            }, s.uid = 1, s.accepts = J.acceptData, s.prototype = {
                key: function(e) {
                    if (!s.accepts(e)) return 0;
                    var t = {},
                        i = e[this.expando];
                    if (!i) {
                        i = s.uid++;
                        try {
                            t[this.expando] = {
                                value: i
                            }, Object.defineProperties(e, t)
                        } catch (n) {
                            t[this.expando] = i, J.extend(e, t)
                        }
                    }
                    return this.cache[i] || (this.cache[i] = {}), i
                },
                set: function(e, t, i) {
                    var n, r = this.key(e),
                        o = this.cache[r];
                    if ("string" == typeof t) o[t] = i;
                    else if (J.isEmptyObject(o)) J.extend(this.cache[r], t);
                    else
                        for (n in t) o[n] = t[n];
                    return o
                },
                get: function(e, t) {
                    var i = this.cache[this.key(e)];
                    return void 0 === t ? i : i[t]
                },
                access: function(e, t, i) {
                    var n;
                    return void 0 === t || t && "string" == typeof t && void 0 === i ? (n = this.get(e, t), void 0 !== n ? n : this.get(e, J.camelCase(t))) : (this.set(e, t, i), void 0 !== i ? i : t)
                },
                remove: function(e, t) {
                    var i, n, r, o = this.key(e),
                        a = this.cache[o];
                    if (void 0 === t) this.cache[o] = {};
                    else {
                        J.isArray(t) ? n = t.concat(t.map(J.camelCase)) : (r = J.camelCase(t), t in a ? n = [t, r] : (n = r, n = n in a ? [n] : n.match(fe) || [])), i = n.length;
                        for (; i--;) delete a[n[i]]
                    }
                },
                hasData: function(e) {
                    return !J.isEmptyObject(this.cache[e[this.expando]] || {})
                },
                discard: function(e) {
                    e[this.expando] && delete this.cache[e[this.expando]]
                }
            };
            var _e = new s,
                ve = new s,
                ye = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,
                be = /([A-Z])/g;
            J.extend({
                hasData: function(e) {
                    return ve.hasData(e) || _e.hasData(e)
                },
                data: function(e, t, i) {
                    return ve.access(e, t, i)
                },
                removeData: function(e, t) {
                    ve.remove(e, t)
                },
                _data: function(e, t, i) {
                    return _e.access(e, t, i)
                },
                _removeData: function(e, t) {
                    _e.remove(e, t)
                }
            }), J.fn.extend({
                data: function(e, t) {
                    var i, n, r, o = this[0],
                        a = o && o.attributes;
                    if (void 0 === e) {
                        if (this.length && (r = ve.get(o), 1 === o.nodeType && !_e.get(o, "hasDataAttrs"))) {
                            for (i = a.length; i--;) a[i] && (n = a[i].name, 0 === n.indexOf("data-") && (n = J.camelCase(n.slice(5)), l(o, n, r[n])));
                            _e.set(o, "hasDataAttrs", !0)
                        }
                        return r
                    }
                    return "object" == typeof e ? this.each(function() {
                        ve.set(this, e)
                    }) : ge(this, function(t) {
                        var i, n = J.camelCase(e);
                        if (o && void 0 === t) {
                            if (i = ve.get(o, e), void 0 !== i) return i;
                            if (i = ve.get(o, n), void 0 !== i) return i;
                            if (i = l(o, n, void 0), void 0 !== i) return i
                        } else this.each(function() {
                            var i = ve.get(this, n);
                            ve.set(this, n, t), -1 !== e.indexOf("-") && void 0 !== i && ve.set(this, e, t)
                        })
                    }, null, t, arguments.length > 1, null, !0)
                },
                removeData: function(e) {
                    return this.each(function() {
                        ve.remove(this, e)
                    })
                }
            }), J.extend({
                queue: function(e, t, i) {
                    var n;
                    return e ? (t = (t || "fx") + "queue", n = _e.get(e, t), i && (!n || J.isArray(i) ? n = _e.access(e, t, J.makeArray(i)) : n.push(i)), n || []) : void 0
                },
                dequeue: function(e, t) {
                    t = t || "fx";
                    var i = J.queue(e, t),
                        n = i.length,
                        r = i.shift(),
                        o = J._queueHooks(e, t),
                        a = function() {
                            J.dequeue(e, t)
                        };
                    "inprogress" === r && (r = i.shift(), n--), r && ("fx" === t && i.unshift("inprogress"), delete o.stop, r.call(e, a, o)), !n && o && o.empty.fire()
                },
                _queueHooks: function(e, t) {
                    var i = t + "queueHooks";
                    return _e.get(e, i) || _e.access(e, i, {
                        empty: J.Callbacks("once memory").add(function() {
                            _e.remove(e, [t + "queue", i])
                        })
                    })
                }
            }), J.fn.extend({
                queue: function(e, t) {
                    var i = 2;
                    return "string" != typeof e && (t = e, e = "fx", i--), arguments.length < i ? J.queue(this[0], e) : void 0 === t ? this : this.each(function() {
                        var i = J.queue(this, e, t);
                        J._queueHooks(this, e), "fx" === e && "inprogress" !== i[0] && J.dequeue(this, e)
                    })
                },
                dequeue: function(e) {
                    return this.each(function() {
                        J.dequeue(this, e)
                    })
                },
                clearQueue: function(e) {
                    return this.queue(e || "fx", [])
                },
                promise: function(e, t) {
                    var i, n = 1,
                        r = J.Deferred(),
                        o = this,
                        a = this.length,
                        s = function() {
                            --n || r.resolveWith(o, [o])
                        };
                    for ("string" != typeof e && (t = e, e = void 0), e = e || "fx"; a--;) i = _e.get(o[a], e + "queueHooks"), i && i.empty && (n++, i.empty.add(s));
                    return s(), r.promise(t)
                }
            });
            var xe = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
                we = ["Top", "Right", "Bottom", "Left"],
                Me = function(e, t) {
                    return e = t || e, "none" === J.css(e, "display") || !J.contains(e.ownerDocument, e)
                },
                Te = /^(?:checkbox|radio)$/i;
            ! function() {
                var e = $.createDocumentFragment(),
                    t = e.appendChild($.createElement("div")),
                    i = $.createElement("input");
                i.setAttribute("type", "radio"), i.setAttribute("checked", "checked"), i.setAttribute("name", "t"), t.appendChild(i), X.checkClone = t.cloneNode(!0).cloneNode(!0).lastChild.checked, t.innerHTML = "<textarea>x</textarea>", X.noCloneChecked = !!t.cloneNode(!0).lastChild.defaultValue
            }();
            var Se = "undefined";
            X.focusinBubbles = "onfocusin" in e;
            var Ce = /^key/,
                Ee = /^(?:mouse|pointer|contextmenu)|click/,
                ke = /^(?:focusinfocus|focusoutblur)$/,
                Le = /^([^.]*)(?:\.(.+)|)$/;
            J.event = {
                global: {},
                add: function(e, t, i, n, r) {
                    var o, a, s, l, h, u, d, c, f, p, m, g = _e.get(e);
                    if (g)
                        for (i.handler && (o = i, i = o.handler, r = o.selector), i.guid || (i.guid = J.guid++), (l = g.events) || (l = g.events = {}), (a = g.handle) || (a = g.handle = function(t) {
                                return typeof J !== Se && J.event.triggered !== t.type ? J.event.dispatch.apply(e, arguments) : void 0
                            }), t = (t || "").match(fe) || [""], h = t.length; h--;) s = Le.exec(t[h]) || [], f = m = s[1], p = (s[2] || "").split(".").sort(), f && (d = J.event.special[f] || {}, f = (r ? d.delegateType : d.bindType) || f, d = J.event.special[f] || {}, u = J.extend({
                            type: f,
                            origType: m,
                            data: n,
                            handler: i,
                            guid: i.guid,
                            selector: r,
                            needsContext: r && J.expr.match.needsContext.test(r),
                            namespace: p.join(".")
                        }, o), (c = l[f]) || (c = l[f] = [], c.delegateCount = 0, d.setup && d.setup.call(e, n, p, a) !== !1 || e.addEventListener && e.addEventListener(f, a, !1)), d.add && (d.add.call(e, u), u.handler.guid || (u.handler.guid = i.guid)), r ? c.splice(c.delegateCount++, 0, u) : c.push(u), J.event.global[f] = !0)
                },
                remove: function(e, t, i, n, r) {
                    var o, a, s, l, h, u, d, c, f, p, m, g = _e.hasData(e) && _e.get(e);
                    if (g && (l = g.events)) {
                        for (t = (t || "").match(fe) || [""], h = t.length; h--;)
                            if (s = Le.exec(t[h]) || [], f = m = s[1], p = (s[2] || "").split(".").sort(), f) {
                                for (d = J.event.special[f] || {}, f = (n ? d.delegateType : d.bindType) || f, c = l[f] || [], s = s[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = o = c.length; o--;) u = c[o], !r && m !== u.origType || i && i.guid !== u.guid || s && !s.test(u.namespace) || n && n !== u.selector && ("**" !== n || !u.selector) || (c.splice(o, 1), u.selector && c.delegateCount--, d.remove && d.remove.call(e, u));
                                a && !c.length && (d.teardown && d.teardown.call(e, p, g.handle) !== !1 || J.removeEvent(e, f, g.handle), delete l[f])
                            } else
                                for (f in l) J.event.remove(e, f + t[h], i, n, !0);
                        J.isEmptyObject(l) && (delete g.handle, _e.remove(e, "events"))
                    }
                },
                trigger: function(t, i, n, r) {
                    var o, a, s, l, h, u, d, c = [n || $],
                        f = K.call(t, "type") ? t.type : t,
                        p = K.call(t, "namespace") ? t.namespace.split(".") : [];
                    if (a = s = n = n || $, 3 !== n.nodeType && 8 !== n.nodeType && !ke.test(f + J.event.triggered) && (f.indexOf(".") >= 0 && (p = f.split("."), f = p.shift(), p.sort()), h = f.indexOf(":") < 0 && "on" + f, t = t[J.expando] ? t : new J.Event(f, "object" == typeof t && t), t.isTrigger = r ? 2 : 3, t.namespace = p.join("."), t.namespace_re = t.namespace ? new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = void 0, t.target || (t.target = n), i = null == i ? [t] : J.makeArray(i, [t]), d = J.event.special[f] || {}, r || !d.trigger || d.trigger.apply(n, i) !== !1)) {
                        if (!r && !d.noBubble && !J.isWindow(n)) {
                            for (l = d.delegateType || f, ke.test(l + f) || (a = a.parentNode); a; a = a.parentNode) c.push(a), s = a;
                            s === (n.ownerDocument || $) && c.push(s.defaultView || s.parentWindow || e)
                        }
                        for (o = 0;
                            (a = c[o++]) && !t.isPropagationStopped();) t.type = o > 1 ? l : d.bindType || f, u = (_e.get(a, "events") || {})[t.type] && _e.get(a, "handle"), u && u.apply(a, i), u = h && a[h], u && u.apply && J.acceptData(a) && (t.result = u.apply(a, i), t.result === !1 && t.preventDefault());
                        return t.type = f, r || t.isDefaultPrevented() || d._default && d._default.apply(c.pop(), i) !== !1 || !J.acceptData(n) || h && J.isFunction(n[f]) && !J.isWindow(n) && (s = n[h], s && (n[h] = null), J.event.triggered = f, n[f](), J.event.triggered = void 0, s && (n[h] = s)), t.result
                    }
                },
                dispatch: function(e) {
                    e = J.event.fix(e);
                    var t, i, n, r, o, a = [],
                        s = G.call(arguments),
                        l = (_e.get(this, "events") || {})[e.type] || [],
                        h = J.event.special[e.type] || {};
                    if (s[0] = e, e.delegateTarget = this, !h.preDispatch || h.preDispatch.call(this, e) !== !1) {
                        for (a = J.event.handlers.call(this, e, l), t = 0;
                            (r = a[t++]) && !e.isPropagationStopped();)
                            for (e.currentTarget = r.elem, i = 0;
                                (o = r.handlers[i++]) && !e.isImmediatePropagationStopped();)(!e.namespace_re || e.namespace_re.test(o.namespace)) && (e.handleObj = o, e.data = o.data, n = ((J.event.special[o.origType] || {}).handle || o.handler).apply(r.elem, s), void 0 !== n && (e.result = n) === !1 && (e.preventDefault(), e.stopPropagation()));
                        return h.postDispatch && h.postDispatch.call(this, e), e.result
                    }
                },
                handlers: function(e, t) {
                    var i, n, r, o, a = [],
                        s = t.delegateCount,
                        l = e.target;
                    if (s && l.nodeType && (!e.button || "click" !== e.type))
                        for (; l !== this; l = l.parentNode || this)
                            if (l.disabled !== !0 || "click" !== e.type) {
                                for (n = [], i = 0; s > i; i++) o = t[i], r = o.selector + " ", void 0 === n[r] && (n[r] = o.needsContext ? J(r, this).index(l) >= 0 : J.find(r, this, null, [l]).length), n[r] && n.push(o);
                                n.length && a.push({
                                    elem: l,
                                    handlers: n
                                })
                            }
                    return s < t.length && a.push({
                        elem: this,
                        handlers: t.slice(s)
                    }), a
                },
                props: "altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),
                fixHooks: {},
                keyHooks: {
                    props: "char charCode key keyCode".split(" "),
                    filter: function(e, t) {
                        return null == e.which && (e.which = null != t.charCode ? t.charCode : t.keyCode), e
                    }
                },
                mouseHooks: {
                    props: "button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),
                    filter: function(e, t) {
                        var i, n, r, o = t.button;
                        return null == e.pageX && null != t.clientX && (i = e.target.ownerDocument || $, n = i.documentElement, r = i.body, e.pageX = t.clientX + (n && n.scrollLeft || r && r.scrollLeft || 0) - (n && n.clientLeft || r && r.clientLeft || 0), e.pageY = t.clientY + (n && n.scrollTop || r && r.scrollTop || 0) - (n && n.clientTop || r && r.clientTop || 0)), e.which || void 0 === o || (e.which = 1 & o ? 1 : 2 & o ? 3 : 4 & o ? 2 : 0), e
                    }
                },
                fix: function(e) {
                    if (e[J.expando]) return e;
                    var t, i, n, r = e.type,
                        o = e,
                        a = this.fixHooks[r];
                    for (a || (this.fixHooks[r] = a = Ee.test(r) ? this.mouseHooks : Ce.test(r) ? this.keyHooks : {}), n = a.props ? this.props.concat(a.props) : this.props, e = new J.Event(o), t = n.length; t--;) i = n[t], e[i] = o[i];
                    return e.target || (e.target = $), 3 === e.target.nodeType && (e.target = e.target.parentNode), a.filter ? a.filter(e, o) : e
                },
                special: {
                    load: {
                        noBubble: !0
                    },
                    focus: {
                        trigger: function() {
                            return this !== d() && this.focus ? (this.focus(), !1) : void 0
                        },
                        delegateType: "focusin"
                    },
                    blur: {
                        trigger: function() {
                            return this === d() && this.blur ? (this.blur(), !1) : void 0
                        },
                        delegateType: "focusout"
                    },
                    click: {
                        trigger: function() {
                            return "checkbox" === this.type && this.click && J.nodeName(this, "input") ? (this.click(), !1) : void 0
                        },
                        _default: function(e) {
                            return J.nodeName(e.target, "a")
                        }
                    },
                    beforeunload: {
                        postDispatch: function(e) {
                            void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result)
                        }
                    }
                },
                simulate: function(e, t, i, n) {
                    var r = J.extend(new J.Event, i, {
                        type: e,
                        isSimulated: !0,
                        originalEvent: {}
                    });
                    n ? J.event.trigger(r, null, t) : J.event.dispatch.call(t, r), r.isDefaultPrevented() && i.preventDefault()
                }
            }, J.removeEvent = function(e, t, i) {
                e.removeEventListener && e.removeEventListener(t, i, !1)
            }, J.Event = function(e, t) {
                return this instanceof J.Event ? (e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || void 0 === e.defaultPrevented && e.returnValue === !1 ? h : u) : this.type = e, t && J.extend(this, t), this.timeStamp = e && e.timeStamp || J.now(), void(this[J.expando] = !0)) : new J.Event(e, t)
            }, J.Event.prototype = {
                isDefaultPrevented: u,
                isPropagationStopped: u,
                isImmediatePropagationStopped: u,
                preventDefault: function() {
                    var e = this.originalEvent;
                    this.isDefaultPrevented = h, e && e.preventDefault && e.preventDefault()
                },
                stopPropagation: function() {
                    var e = this.originalEvent;
                    this.isPropagationStopped = h, e && e.stopPropagation && e.stopPropagation()
                },
                stopImmediatePropagation: function() {
                    var e = this.originalEvent;
                    this.isImmediatePropagationStopped = h, e && e.stopImmediatePropagation && e.stopImmediatePropagation(), this.stopPropagation()
                }
            }, J.each({
                mouseenter: "mouseover",
                mouseleave: "mouseout",
                pointerenter: "pointerover",
                pointerleave: "pointerout"
            }, function(e, t) {
                J.event.special[e] = {
                    delegateType: t,
                    bindType: t,
                    handle: function(e) {
                        var i, n = this,
                            r = e.relatedTarget,
                            o = e.handleObj;
                        return (!r || r !== n && !J.contains(n, r)) && (e.type = o.origType, i = o.handler.apply(this, arguments), e.type = t), i
                    }
                }
            }), X.focusinBubbles || J.each({
                focus: "focusin",
                blur: "focusout"
            }, function(e, t) {
                var i = function(e) {
                    J.event.simulate(t, e.target, J.event.fix(e), !0)
                };
                J.event.special[t] = {
                    setup: function() {
                        var n = this.ownerDocument || this,
                            r = _e.access(n, t);
                        r || n.addEventListener(e, i, !0), _e.access(n, t, (r || 0) + 1)
                    },
                    teardown: function() {
                        var n = this.ownerDocument || this,
                            r = _e.access(n, t) - 1;
                        r ? _e.access(n, t, r) : (n.removeEventListener(e, i, !0), _e.remove(n, t))
                    }
                }
            }), J.fn.extend({
                on: function(e, t, i, n, r) {
                    var o, a;
                    if ("object" == typeof e) {
                        "string" != typeof t && (i = i || t, t = void 0);
                        for (a in e) this.on(a, t, i, e[a], r);
                        return this
                    }
                    if (null == i && null == n ? (n = t, i = t = void 0) : null == n && ("string" == typeof t ? (n = i, i = void 0) : (n = i, i = t, t = void 0)), n === !1) n = u;
                    else if (!n) return this;
                    return 1 === r && (o = n, n = function(e) {
                        return J().off(e), o.apply(this, arguments)
                    }, n.guid = o.guid || (o.guid = J.guid++)), this.each(function() {
                        J.event.add(this, e, n, i, t)
                    })
                },
                one: function(e, t, i, n) {
                    return this.on(e, t, i, n, 1)
                },
                off: function(e, t, i) {
                    var n, r;
                    if (e && e.preventDefault && e.handleObj) return n = e.handleObj, J(e.delegateTarget).off(n.namespace ? n.origType + "." + n.namespace : n.origType, n.selector, n.handler), this;
                    if ("object" == typeof e) {
                        for (r in e) this.off(r, t, e[r]);
                        return this
                    }
                    return (t === !1 || "function" == typeof t) && (i = t, t = void 0), i === !1 && (i = u), this.each(function() {
                        J.event.remove(this, e, i, t)
                    })
                },
                trigger: function(e, t) {
                    return this.each(function() {
                        J.event.trigger(e, t, this)
                    })
                },
                triggerHandler: function(e, t) {
                    var i = this[0];
                    return i ? J.event.trigger(e, t, i, !0) : void 0
                }
            });
            var Pe = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,
                Ae = /<([\w:]+)/,
                Re = /<|&#?\w+;/,
                De = /<(?:script|style|link)/i,
                Ie = /checked\s*(?:[^=]|=\s*.checked.)/i,
                Oe = /^$|\/(?:java|ecma)script/i,
                Ne = /^true\/(.*)/,
                Be = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,
                Fe = {
                    option: [1, "<select multiple='multiple'>", "</select>"],
                    thead: [1, "<table>", "</table>"],
                    col: [2, "<table><colgroup>", "</colgroup></table>"],
                    tr: [2, "<table><tbody>", "</tbody></table>"],
                    td: [3, "<table><tbody><tr>", "</tr></tbody></table>"],
                    _default: [0, "", ""]
                };
            Fe.optgroup = Fe.option, Fe.tbody = Fe.tfoot = Fe.colgroup = Fe.caption = Fe.thead, Fe.th = Fe.td, J.extend({
                clone: function(e, t, i) {
                    var n, r, o, a, s = e.cloneNode(!0),
                        l = J.contains(e.ownerDocument, e);
                    if (!(X.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || J.isXMLDoc(e)))
                        for (a = _(s), o = _(e), n = 0, r = o.length; r > n; n++) v(o[n], a[n]);
                    if (t)
                        if (i)
                            for (o = o || _(e), a = a || _(s), n = 0, r = o.length; r > n; n++) g(o[n], a[n]);
                        else g(e, s);
                    return a = _(s, "script"), a.length > 0 && m(a, !l && _(e, "script")), s
                },
                buildFragment: function(e, t, i, n) {
                    for (var r, o, a, s, l, h, u = t.createDocumentFragment(), d = [], c = 0, f = e.length; f > c; c++)
                        if (r = e[c], r || 0 === r)
                            if ("object" === J.type(r)) J.merge(d, r.nodeType ? [r] : r);
                            else if (Re.test(r)) {
                        for (o = o || u.appendChild(t.createElement("div")), a = (Ae.exec(r) || ["", ""])[1].toLowerCase(), s = Fe[a] || Fe._default, o.innerHTML = s[1] + r.replace(Pe, "<$1></$2>") + s[2], h = s[0]; h--;) o = o.lastChild;
                        J.merge(d, o.childNodes), o = u.firstChild, o.textContent = ""
                    } else d.push(t.createTextNode(r));
                    for (u.textContent = "", c = 0; r = d[c++];)
                        if ((!n || -1 === J.inArray(r, n)) && (l = J.contains(r.ownerDocument, r), o = _(u.appendChild(r), "script"), l && m(o), i))
                            for (h = 0; r = o[h++];) Oe.test(r.type || "") && i.push(r);
                    return u
                },
                cleanData: function(e) {
                    for (var t, i, n, r, o = J.event.special, a = 0; void 0 !== (i = e[a]); a++) {
                        if (J.acceptData(i) && (r = i[_e.expando], r && (t = _e.cache[r]))) {
                            if (t.events)
                                for (n in t.events) o[n] ? J.event.remove(i, n) : J.removeEvent(i, n, t.handle);
                            _e.cache[r] && delete _e.cache[r]
                        }
                        delete ve.cache[i[ve.expando]]
                    }
                }
            }), J.fn.extend({
                text: function(e) {
                    return ge(this, function(e) {
                        return void 0 === e ? J.text(this) : this.empty().each(function() {
                            (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) && (this.textContent = e)
                        })
                    }, null, e, arguments.length)
                },
                append: function() {
                    return this.domManip(arguments, function(e) {
                        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                            var t = c(this, e);
                            t.appendChild(e)
                        }
                    })
                },
                prepend: function() {
                    return this.domManip(arguments, function(e) {
                        if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) {
                            var t = c(this, e);
                            t.insertBefore(e, t.firstChild)
                        }
                    })
                },
                before: function() {
                    return this.domManip(arguments, function(e) {
                        this.parentNode && this.parentNode.insertBefore(e, this)
                    })
                },
                after: function() {
                    return this.domManip(arguments, function(e) {
                        this.parentNode && this.parentNode.insertBefore(e, this.nextSibling)
                    })
                },
                remove: function(e, t) {
                    for (var i, n = e ? J.filter(e, this) : this, r = 0; null != (i = n[r]); r++) t || 1 !== i.nodeType || J.cleanData(_(i)), i.parentNode && (t && J.contains(i.ownerDocument, i) && m(_(i, "script")), i.parentNode.removeChild(i));
                    return this
                },
                empty: function() {
                    for (var e, t = 0; null != (e = this[t]); t++) 1 === e.nodeType && (J.cleanData(_(e, !1)), e.textContent = "");
                    return this
                },
                clone: function(e, t) {
                    return e = null == e ? !1 : e, t = null == t ? e : t, this.map(function() {
                        return J.clone(this, e, t)
                    })
                },
                html: function(e) {
                    return ge(this, function(e) {
                        var t = this[0] || {},
                            i = 0,
                            n = this.length;
                        if (void 0 === e && 1 === t.nodeType) return t.innerHTML;
                        if ("string" == typeof e && !De.test(e) && !Fe[(Ae.exec(e) || ["", ""])[1].toLowerCase()]) {
                            e = e.replace(Pe, "<$1></$2>");
                            try {
                                for (; n > i; i++) t = this[i] || {}, 1 === t.nodeType && (J.cleanData(_(t, !1)), t.innerHTML = e);
                                t = 0
                            } catch (r) {}
                        }
                        t && this.empty().append(e)
                    }, null, e, arguments.length)
                },
                replaceWith: function() {
                    var e = arguments[0];
                    return this.domManip(arguments, function(t) {
                        e = this.parentNode, J.cleanData(_(this)), e && e.replaceChild(t, this)
                    }), e && (e.length || e.nodeType) ? this : this.remove()
                },
                detach: function(e) {
                    return this.remove(e, !0)
                },
                domManip: function(e, t) {
                    e = j.apply([], e);
                    var i, n, r, o, a, s, l = 0,
                        h = this.length,
                        u = this,
                        d = h - 1,
                        c = e[0],
                        m = J.isFunction(c);
                    if (m || h > 1 && "string" == typeof c && !X.checkClone && Ie.test(c)) return this.each(function(i) {
                        var n = u.eq(i);
                        m && (e[0] = c.call(this, i, n.html())), n.domManip(e, t)
                    });
                    if (h && (i = J.buildFragment(e, this[0].ownerDocument, !1, this), n = i.firstChild, 1 === i.childNodes.length && (i = n), n)) {
                        for (r = J.map(_(i, "script"), f), o = r.length; h > l; l++) a = i, l !== d && (a = J.clone(a, !0, !0), o && J.merge(r, _(a, "script"))), t.call(this[l], a, l);
                        if (o)
                            for (s = r[r.length - 1].ownerDocument, J.map(r, p), l = 0; o > l; l++) a = r[l], Oe.test(a.type || "") && !_e.access(a, "globalEval") && J.contains(s, a) && (a.src ? J._evalUrl && J._evalUrl(a.src) : J.globalEval(a.textContent.replace(Be, "")))
                    }
                    return this
                }
            }), J.each({
                appendTo: "append",
                prependTo: "prepend",
                insertBefore: "before",
                insertAfter: "after",
                replaceAll: "replaceWith"
            }, function(e, t) {
                J.fn[e] = function(e) {
                    for (var i, n = [], r = J(e), o = r.length - 1, a = 0; o >= a; a++) i = a === o ? this : this.clone(!0), J(r[a])[t](i), q.apply(n, i.get());
                    return this.pushStack(n)
                }
            });
            var ze, He = {},
                Ue = /^margin/,
                We = new RegExp("^(" + xe + ")(?!px)[a-z%]+$", "i"),
                Ge = function(t) {
                    return t.ownerDocument.defaultView.opener ? t.ownerDocument.defaultView.getComputedStyle(t, null) : e.getComputedStyle(t, null)
                };
            ! function() {
                function t() {
                    a.style.cssText = "-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute", a.innerHTML = "", r.appendChild(o);
                    var t = e.getComputedStyle(a, null);
                    i = "1%" !== t.top, n = "4px" === t.width, r.removeChild(o)
                }
                var i, n, r = $.documentElement,
                    o = $.createElement("div"),
                    a = $.createElement("div");
                a.style && (a.style.backgroundClip = "content-box", a.cloneNode(!0).style.backgroundClip = "", X.clearCloneStyle = "content-box" === a.style.backgroundClip, o.style.cssText = "border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute", o.appendChild(a), e.getComputedStyle && J.extend(X, {
                    pixelPosition: function() {
                        return t(), i
                    },
                    boxSizingReliable: function() {
                        return null == n && t(), n
                    },
                    reliableMarginRight: function() {
                        var t, i = a.appendChild($.createElement("div"));
                        return i.style.cssText = a.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", i.style.marginRight = i.style.width = "0", a.style.width = "1px", r.appendChild(o), t = !parseFloat(e.getComputedStyle(i, null).marginRight), r.removeChild(o), a.removeChild(i), t
                    }
                }))
            }(), J.swap = function(e, t, i, n) {
                var r, o, a = {};
                for (o in t) a[o] = e.style[o], e.style[o] = t[o];
                r = i.apply(e, n || []);
                for (o in t) e.style[o] = a[o];
                return r
            };
            var je = /^(none|table(?!-c[ea]).+)/,
                qe = new RegExp("^(" + xe + ")(.*)$", "i"),
                Ve = new RegExp("^([+-])=(" + xe + ")", "i"),
                Ze = {
                    position: "absolute",
                    visibility: "hidden",
                    display: "block"
                },
                Ye = {
                    letterSpacing: "0",
                    fontWeight: "400"
                },
                Ke = ["Webkit", "O", "Moz", "ms"];
            J.extend({
                cssHooks: {
                    opacity: {
                        get: function(e, t) {
                            if (t) {
                                var i = x(e, "opacity");
                                return "" === i ? "1" : i
                            }
                        }
                    }
                },
                cssNumber: {
                    columnCount: !0,
                    fillOpacity: !0,
                    flexGrow: !0,
                    flexShrink: !0,
                    fontWeight: !0,
                    lineHeight: !0,
                    opacity: !0,
                    order: !0,
                    orphans: !0,
                    widows: !0,
                    zIndex: !0,
                    zoom: !0
                },
                cssProps: {
                    "float": "cssFloat"
                },
                style: function(e, t, i, n) {
                    if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) {
                        var r, o, a, s = J.camelCase(t),
                            l = e.style;
                        return t = J.cssProps[s] || (J.cssProps[s] = M(l, s)), a = J.cssHooks[t] || J.cssHooks[s], void 0 === i ? a && "get" in a && void 0 !== (r = a.get(e, !1, n)) ? r : l[t] : (o = typeof i, "string" === o && (r = Ve.exec(i)) && (i = (r[1] + 1) * r[2] + parseFloat(J.css(e, t)), o = "number"), null != i && i === i && ("number" !== o || J.cssNumber[s] || (i += "px"), X.clearCloneStyle || "" !== i || 0 !== t.indexOf("background") || (l[t] = "inherit"), a && "set" in a && void 0 === (i = a.set(e, i, n)) || (l[t] = i)), void 0)
                    }
                },
                css: function(e, t, i, n) {
                    var r, o, a, s = J.camelCase(t);
                    return t = J.cssProps[s] || (J.cssProps[s] = M(e.style, s)), a = J.cssHooks[t] || J.cssHooks[s], a && "get" in a && (r = a.get(e, !0, i)), void 0 === r && (r = x(e, t, n)), "normal" === r && t in Ye && (r = Ye[t]), "" === i || i ? (o = parseFloat(r), i === !0 || J.isNumeric(o) ? o || 0 : r) : r
                }
            }), J.each(["height", "width"], function(e, t) {
                J.cssHooks[t] = {
                    get: function(e, i, n) {
                        return i ? je.test(J.css(e, "display")) && 0 === e.offsetWidth ? J.swap(e, Ze, function() {
                            return C(e, t, n)
                        }) : C(e, t, n) : void 0
                    },
                    set: function(e, i, n) {
                        var r = n && Ge(e);
                        return T(e, i, n ? S(e, t, n, "border-box" === J.css(e, "boxSizing", !1, r), r) : 0)
                    }
                }
            }), J.cssHooks.marginRight = w(X.reliableMarginRight, function(e, t) {
                return t ? J.swap(e, {
                    display: "inline-block"
                }, x, [e, "marginRight"]) : void 0
            }), J.each({
                margin: "",
                padding: "",
                border: "Width"
            }, function(e, t) {
                J.cssHooks[e + t] = {
                    expand: function(i) {
                        for (var n = 0, r = {}, o = "string" == typeof i ? i.split(" ") : [i]; 4 > n; n++) r[e + we[n] + t] = o[n] || o[n - 2] || o[0];
                        return r
                    }
                }, Ue.test(e) || (J.cssHooks[e + t].set = T)
            }), J.fn.extend({
                css: function(e, t) {
                    return ge(this, function(e, t, i) {
                        var n, r, o = {},
                            a = 0;
                        if (J.isArray(t)) {
                            for (n = Ge(e), r = t.length; r > a; a++) o[t[a]] = J.css(e, t[a], !1, n);
                            return o
                        }
                        return void 0 !== i ? J.style(e, t, i) : J.css(e, t)
                    }, e, t, arguments.length > 1)
                },
                show: function() {
                    return E(this, !0)
                },
                hide: function() {
                    return E(this)
                },
                toggle: function(e) {
                    return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function() {
                        Me(this) ? J(this).show() : J(this).hide()
                    })
                }
            }), J.Tween = k, k.prototype = {
                constructor: k,
                init: function(e, t, i, n, r, o) {
                    this.elem = e, this.prop = i, this.easing = r || "swing", this.options = t, this.start = this.now = this.cur(), this.end = n, this.unit = o || (J.cssNumber[i] ? "" : "px")
                },
                cur: function() {
                    var e = k.propHooks[this.prop];
                    return e && e.get ? e.get(this) : k.propHooks._default.get(this)
                },
                run: function(e) {
                    var t, i = k.propHooks[this.prop];
                    return this.options.duration ? this.pos = t = J.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), i && i.set ? i.set(this) : k.propHooks._default.set(this), this
                }
            }, k.prototype.init.prototype = k.prototype, k.propHooks = {
                _default: {
                    get: function(e) {
                        var t;
                        return null == e.elem[e.prop] || e.elem.style && null != e.elem.style[e.prop] ? (t = J.css(e.elem, e.prop, ""), t && "auto" !== t ? t : 0) : e.elem[e.prop]
                    },
                    set: function(e) {
                        J.fx.step[e.prop] ? J.fx.step[e.prop](e) : e.elem.style && (null != e.elem.style[J.cssProps[e.prop]] || J.cssHooks[e.prop]) ? J.style(e.elem, e.prop, e.now + e.unit) : e.elem[e.prop] = e.now
                    }
                }
            }, k.propHooks.scrollTop = k.propHooks.scrollLeft = {
                set: function(e) {
                    e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now)
                }
            }, J.easing = {
                linear: function(e) {
                    return e
                },
                swing: function(e) {
                    return .5 - Math.cos(e * Math.PI) / 2
                }
            }, J.fx = k.prototype.init, J.fx.step = {};
            var Xe, $e, Qe = /^(?:toggle|show|hide)$/,
                Je = new RegExp("^(?:([+-])=|)(" + xe + ")([a-z%]*)$", "i"),
                et = /queueHooks$/,
                tt = [R],
                it = {
                    "*": [function(e, t) {
                        var i = this.createTween(e, t),
                            n = i.cur(),
                            r = Je.exec(t),
                            o = r && r[3] || (J.cssNumber[e] ? "" : "px"),
                            a = (J.cssNumber[e] || "px" !== o && +n) && Je.exec(J.css(i.elem, e)),
                            s = 1,
                            l = 20;
                        if (a && a[3] !== o) {
                            o = o || a[3], r = r || [], a = +n || 1;
                            do s = s || ".5", a /= s, J.style(i.elem, e, a + o); while (s !== (s = i.cur() / n) && 1 !== s && --l)
                        }
                        return r && (a = i.start = +a || +n || 0, i.unit = o, i.end = r[1] ? a + (r[1] + 1) * r[2] : +r[2]), i
                    }]
                };
            J.Animation = J.extend(I, {
                    tweener: function(e, t) {
                        J.isFunction(e) ? (t = e, e = ["*"]) : e = e.split(" ");
                        for (var i, n = 0, r = e.length; r > n; n++) i = e[n], it[i] = it[i] || [], it[i].unshift(t)
                    },
                    prefilter: function(e, t) {
                        t ? tt.unshift(e) : tt.push(e)
                    }
                }), J.speed = function(e, t, i) {
                    var n = e && "object" == typeof e ? J.extend({}, e) : {
                        complete: i || !i && t || J.isFunction(e) && e,
                        duration: e,
                        easing: i && t || t && !J.isFunction(t) && t
                    };
                    return n.duration = J.fx.off ? 0 : "number" == typeof n.duration ? n.duration : n.duration in J.fx.speeds ? J.fx.speeds[n.duration] : J.fx.speeds._default, (null == n.queue || n.queue === !0) && (n.queue = "fx"), n.old = n.complete, n.complete = function() {
                        J.isFunction(n.old) && n.old.call(this), n.queue && J.dequeue(this, n.queue)
                    }, n
                }, J.fn.extend({
                    fadeTo: function(e, t, i, n) {
                        return this.filter(Me).css("opacity", 0).show().end().animate({
                            opacity: t
                        }, e, i, n)
                    },
                    animate: function(e, t, i, n) {
                        var r = J.isEmptyObject(e),
                            o = J.speed(t, i, n),
                            a = function() {
                                var t = I(this, J.extend({}, e), o);
                                (r || _e.get(this, "finish")) && t.stop(!0)
                            };
                        return a.finish = a, r || o.queue === !1 ? this.each(a) : this.queue(o.queue, a)
                    },
                    stop: function(e, t, i) {
                        var n = function(e) {
                            var t = e.stop;
                            delete e.stop, t(i)
                        };
                        return "string" != typeof e && (i = t, t = e, e = void 0), t && e !== !1 && this.queue(e || "fx", []), this.each(function() {
                            var t = !0,
                                r = null != e && e + "queueHooks",
                                o = J.timers,
                                a = _e.get(this);
                            if (r) a[r] && a[r].stop && n(a[r]);
                            else
                                for (r in a) a[r] && a[r].stop && et.test(r) && n(a[r]);
                            for (r = o.length; r--;) o[r].elem !== this || null != e && o[r].queue !== e || (o[r].anim.stop(i), t = !1, o.splice(r, 1));
                            (t || !i) && J.dequeue(this, e)
                        })
                    },
                    finish: function(e) {
                        return e !== !1 && (e = e || "fx"), this.each(function() {
                            var t, i = _e.get(this),
                                n = i[e + "queue"],
                                r = i[e + "queueHooks"],
                                o = J.timers,
                                a = n ? n.length : 0;
                            for (i.finish = !0, J.queue(this, e, []), r && r.stop && r.stop.call(this, !0), t = o.length; t--;) o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1));
                            for (t = 0; a > t; t++) n[t] && n[t].finish && n[t].finish.call(this);
                            delete i.finish
                        })
                    }
                }), J.each(["toggle", "show", "hide"], function(e, t) {
                    var i = J.fn[t];
                    J.fn[t] = function(e, n, r) {
                        return null == e || "boolean" == typeof e ? i.apply(this, arguments) : this.animate(P(t, !0), e, n, r)
                    }
                }), J.each({
                    slideDown: P("show"),
                    slideUp: P("hide"),
                    slideToggle: P("toggle"),
                    fadeIn: {
                        opacity: "show"
                    },
                    fadeOut: {
                        opacity: "hide"
                    },
                    fadeToggle: {
                        opacity: "toggle"
                    }
                }, function(e, t) {
                    J.fn[e] = function(e, i, n) {
                        return this.animate(t, e, i, n)
                    }
                }), J.timers = [], J.fx.tick = function() {
                    var e, t = 0,
                        i = J.timers;
                    for (Xe = J.now(); t < i.length; t++) e = i[t], e() || i[t] !== e || i.splice(t--, 1);
                    i.length || J.fx.stop(), Xe = void 0
                }, J.fx.timer = function(e) {
                    J.timers.push(e), e() ? J.fx.start() : J.timers.pop()
                }, J.fx.interval = 13, J.fx.start = function() {
                    $e || ($e = setInterval(J.fx.tick, J.fx.interval))
                }, J.fx.stop = function() {
                    clearInterval($e), $e = null
                }, J.fx.speeds = {
                    slow: 600,
                    fast: 200,
                    _default: 400
                }, J.fn.delay = function(e, t) {
                    return e = J.fx ? J.fx.speeds[e] || e : e, t = t || "fx", this.queue(t, function(t, i) {
                        var n = setTimeout(t, e);
                        i.stop = function() {
                            clearTimeout(n)
                        }
                    })
                },
                function() {
                    var e = $.createElement("input"),
                        t = $.createElement("select"),
                        i = t.appendChild($.createElement("option"));
                    e.type = "checkbox", X.checkOn = "" !== e.value, X.optSelected = i.selected, t.disabled = !0, X.optDisabled = !i.disabled, e = $.createElement("input"), e.value = "t", e.type = "radio", X.radioValue = "t" === e.value
                }();
            var nt, rt, ot = J.expr.attrHandle;
            J.fn.extend({
                attr: function(e, t) {
                    return ge(this, J.attr, e, t, arguments.length > 1)
                },
                removeAttr: function(e) {
                    return this.each(function() {
                        J.removeAttr(this, e)
                    })
                }
            }), J.extend({
                attr: function(e, t, i) {
                    var n, r, o = e.nodeType;
                    if (e && 3 !== o && 8 !== o && 2 !== o) return typeof e.getAttribute === Se ? J.prop(e, t, i) : (1 === o && J.isXMLDoc(e) || (t = t.toLowerCase(), n = J.attrHooks[t] || (J.expr.match.bool.test(t) ? rt : nt)), void 0 === i ? n && "get" in n && null !== (r = n.get(e, t)) ? r : (r = J.find.attr(e, t), null == r ? void 0 : r) : null !== i ? n && "set" in n && void 0 !== (r = n.set(e, i, t)) ? r : (e.setAttribute(t, i + ""), i) : void J.removeAttr(e, t))
                },
                removeAttr: function(e, t) {
                    var i, n, r = 0,
                        o = t && t.match(fe);
                    if (o && 1 === e.nodeType)
                        for (; i = o[r++];) n = J.propFix[i] || i, J.expr.match.bool.test(i) && (e[n] = !1), e.removeAttribute(i)
                },
                attrHooks: {
                    type: {
                        set: function(e, t) {
                            if (!X.radioValue && "radio" === t && J.nodeName(e, "input")) {
                                var i = e.value;
                                return e.setAttribute("type", t), i && (e.value = i), t
                            }
                        }
                    }
                }
            }), rt = {
                set: function(e, t, i) {
                    return t === !1 ? J.removeAttr(e, i) : e.setAttribute(i, i), i
                }
            }, J.each(J.expr.match.bool.source.match(/\w+/g), function(e, t) {
                var i = ot[t] || J.find.attr;
                ot[t] = function(e, t, n) {
                    var r, o;
                    return n || (o = ot[t], ot[t] = r, r = null != i(e, t, n) ? t.toLowerCase() : null, ot[t] = o), r
                }
            });
            var at = /^(?:input|select|textarea|button)$/i;
            J.fn.extend({
                prop: function(e, t) {
                    return ge(this, J.prop, e, t, arguments.length > 1)
                },
                removeProp: function(e) {
                    return this.each(function() {
                        delete this[J.propFix[e] || e]
                    })
                }
            }), J.extend({
                propFix: {
                    "for": "htmlFor",
                    "class": "className"
                },
                prop: function(e, t, i) {
                    var n, r, o, a = e.nodeType;
                    if (e && 3 !== a && 8 !== a && 2 !== a) return o = 1 !== a || !J.isXMLDoc(e), o && (t = J.propFix[t] || t, r = J.propHooks[t]), void 0 !== i ? r && "set" in r && void 0 !== (n = r.set(e, i, t)) ? n : e[t] = i : r && "get" in r && null !== (n = r.get(e, t)) ? n : e[t]
                },
                propHooks: {
                    tabIndex: {
                        get: function(e) {
                            return e.hasAttribute("tabindex") || at.test(e.nodeName) || e.href ? e.tabIndex : -1
                        }
                    }
                }
            }), X.optSelected || (J.propHooks.selected = {
                get: function(e) {
                    var t = e.parentNode;
                    return t && t.parentNode && t.parentNode.selectedIndex, null
                }
            }), J.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function() {
                J.propFix[this.toLowerCase()] = this
            });
            var st = /[\t\r\n\f]/g;
            J.fn.extend({
                addClass: function(e) {
                    var t, i, n, r, o, a, s = "string" == typeof e && e,
                        l = 0,
                        h = this.length;
                    if (J.isFunction(e)) return this.each(function(t) {
                        J(this).addClass(e.call(this, t, this.className))
                    });
                    if (s)
                        for (t = (e || "").match(fe) || []; h > l; l++)
                            if (i = this[l], n = 1 === i.nodeType && (i.className ? (" " + i.className + " ").replace(st, " ") : " ")) {
                                for (o = 0; r = t[o++];) n.indexOf(" " + r + " ") < 0 && (n += r + " ");
                                a = J.trim(n), i.className !== a && (i.className = a)
                            }
                    return this
                },
                removeClass: function(e) {
                    var t, i, n, r, o, a, s = 0 === arguments.length || "string" == typeof e && e,
                        l = 0,
                        h = this.length;
                    if (J.isFunction(e)) return this.each(function(t) {
                        J(this).removeClass(e.call(this, t, this.className))
                    });
                    if (s)
                        for (t = (e || "").match(fe) || []; h > l; l++)
                            if (i = this[l], n = 1 === i.nodeType && (i.className ? (" " + i.className + " ").replace(st, " ") : "")) {
                                for (o = 0; r = t[o++];)
                                    for (; n.indexOf(" " + r + " ") >= 0;) n = n.replace(" " + r + " ", " ");
                                a = e ? J.trim(n) : "", i.className !== a && (i.className = a)
                            }
                    return this
                },
                toggleClass: function(e, t) {
                    var i = typeof e;
                    return "boolean" == typeof t && "string" === i ? t ? this.addClass(e) : this.removeClass(e) : J.isFunction(e) ? this.each(function(i) {
                        J(this).toggleClass(e.call(this, i, this.className, t), t)
                    }) : this.each(function() {
                        if ("string" === i)
                            for (var t, n = 0, r = J(this), o = e.match(fe) || []; t = o[n++];) r.hasClass(t) ? r.removeClass(t) : r.addClass(t);
                        else(i === Se || "boolean" === i) && (this.className && _e.set(this, "__className__", this.className), this.className = this.className || e === !1 ? "" : _e.get(this, "__className__") || "")
                    })
                },
                hasClass: function(e) {
                    for (var t = " " + e + " ", i = 0, n = this.length; n > i; i++)
                        if (1 === this[i].nodeType && (" " + this[i].className + " ").replace(st, " ").indexOf(t) >= 0) return !0;
                    return !1
                }
            });
            var lt = /\r/g;
            J.fn.extend({
                val: function(e) {
                    var t, i, n, r = this[0]; {
                        if (arguments.length) return n = J.isFunction(e), this.each(function(i) {
                            var r;
                            1 === this.nodeType && (r = n ? e.call(this, i, J(this).val()) : e, null == r ? r = "" : "number" == typeof r ? r += "" : J.isArray(r) && (r = J.map(r, function(e) {
                                return null == e ? "" : e + ""
                            })), t = J.valHooks[this.type] || J.valHooks[this.nodeName.toLowerCase()], t && "set" in t && void 0 !== t.set(this, r, "value") || (this.value = r))
                        });
                        if (r) return t = J.valHooks[r.type] || J.valHooks[r.nodeName.toLowerCase()], t && "get" in t && void 0 !== (i = t.get(r, "value")) ? i : (i = r.value, "string" == typeof i ? i.replace(lt, "") : null == i ? "" : i)
                    }
                }
            }), J.extend({
                valHooks: {
                    option: {
                        get: function(e) {
                            var t = J.find.attr(e, "value");
                            return null != t ? t : J.trim(J.text(e))
                        }
                    },
                    select: {
                        get: function(e) {
                            for (var t, i, n = e.options, r = e.selectedIndex, o = "select-one" === e.type || 0 > r, a = o ? null : [], s = o ? r + 1 : n.length, l = 0 > r ? s : o ? r : 0; s > l; l++)
                                if (i = n[l], (i.selected || l === r) && (X.optDisabled ? !i.disabled : null === i.getAttribute("disabled")) && (!i.parentNode.disabled || !J.nodeName(i.parentNode, "optgroup"))) {
                                    if (t = J(i).val(), o) return t;
                                    a.push(t)
                                }
                            return a
                        },
                        set: function(e, t) {
                            for (var i, n, r = e.options, o = J.makeArray(t), a = r.length; a--;) n = r[a], (n.selected = J.inArray(n.value, o) >= 0) && (i = !0);
                            return i || (e.selectedIndex = -1), o
                        }
                    }
                }
            }), J.each(["radio", "checkbox"], function() {
                J.valHooks[this] = {
                    set: function(e, t) {
                        return J.isArray(t) ? e.checked = J.inArray(J(e).val(), t) >= 0 : void 0
                    }
                }, X.checkOn || (J.valHooks[this].get = function(e) {
                    return null === e.getAttribute("value") ? "on" : e.value
                })
            }), J.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function(e, t) {
                J.fn[t] = function(e, i) {
                    return arguments.length > 0 ? this.on(t, null, e, i) : this.trigger(t)
                }
            }), J.fn.extend({
                hover: function(e, t) {
                    return this.mouseenter(e).mouseleave(t || e)
                },
                bind: function(e, t, i) {
                    return this.on(e, null, t, i)
                },
                unbind: function(e, t) {
                    return this.off(e, null, t)
                },
                delegate: function(e, t, i, n) {
                    return this.on(t, e, i, n)
                },
                undelegate: function(e, t, i) {
                    return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", i)
                }
            });
            var ht = J.now(),
                ut = /\?/;
            J.parseJSON = function(e) {
                return JSON.parse(e + "")
            }, J.parseXML = function(e) {
                var t, i;
                if (!e || "string" != typeof e) return null;
                try {
                    i = new DOMParser, t = i.parseFromString(e, "text/xml")
                } catch (n) {
                    t = void 0
                }
                return (!t || t.getElementsByTagName("parsererror").length) && J.error("Invalid XML: " + e), t
            };
            var dt = /#.*$/,
                ct = /([?&])_=[^&]*/,
                ft = /^(.*?):[ \t]*([^\r\n]*)$/gm,
                pt = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,
                mt = /^(?:GET|HEAD)$/,
                gt = /^\/\//,
                _t = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,
                vt = {},
                yt = {},
                bt = "*/".concat("*"),
                xt = e.location.href,
                wt = _t.exec(xt.toLowerCase()) || [];
            J.extend({
                active: 0,
                lastModified: {},
                etag: {},
                ajaxSettings: {
                    url: xt,
                    type: "GET",
                    isLocal: pt.test(wt[1]),
                    global: !0,
                    processData: !0,
                    async: !0,
                    contentType: "application/x-www-form-urlencoded; charset=UTF-8",
                    accepts: {
                        "*": bt,
                        text: "text/plain",
                        html: "text/html",
                        xml: "application/xml, text/xml",
                        json: "application/json, text/javascript"
                    },
                    contents: {
                        xml: /xml/,
                        html: /html/,
                        json: /json/
                    },
                    responseFields: {
                        xml: "responseXML",
                        text: "responseText",
                        json: "responseJSON"
                    },
                    converters: {
                        "* text": String,
                        "text html": !0,
                        "text json": J.parseJSON,
                        "text xml": J.parseXML
                    },
                    flatOptions: {
                        url: !0,
                        context: !0
                    }
                },
                ajaxSetup: function(e, t) {
                    return t ? B(B(e, J.ajaxSettings), t) : B(J.ajaxSettings, e)
                },
                ajaxPrefilter: O(vt),
                ajaxTransport: O(yt),
                ajax: function(e, t) {
                    function i(e, t, i, a) {
                        var l, u, _, v, b, w = t;
                        2 !== y && (y = 2, s && clearTimeout(s), n = void 0, o = a || "", x.readyState = e > 0 ? 4 : 0, l = e >= 200 && 300 > e || 304 === e, i && (v = F(d, x, i)), v = z(d, v, x, l), l ? (d.ifModified && (b = x.getResponseHeader("Last-Modified"), b && (J.lastModified[r] = b), b = x.getResponseHeader("etag"), b && (J.etag[r] = b)), 204 === e || "HEAD" === d.type ? w = "nocontent" : 304 === e ? w = "notmodified" : (w = v.state, u = v.data, _ = v.error, l = !_)) : (_ = w, (e || !w) && (w = "error", 0 > e && (e = 0))), x.status = e, x.statusText = (t || w) + "", l ? p.resolveWith(c, [u, w, x]) : p.rejectWith(c, [x, w, _]), x.statusCode(g), g = void 0, h && f.trigger(l ? "ajaxSuccess" : "ajaxError", [x, d, l ? u : _]), m.fireWith(c, [x, w]), h && (f.trigger("ajaxComplete", [x, d]), --J.active || J.event.trigger("ajaxStop")))
                    }
                    "object" == typeof e && (t = e, e = void 0), t = t || {};
                    var n, r, o, a, s, l, h, u, d = J.ajaxSetup({}, t),
                        c = d.context || d,
                        f = d.context && (c.nodeType || c.jquery) ? J(c) : J.event,
                        p = J.Deferred(),
                        m = J.Callbacks("once memory"),
                        g = d.statusCode || {},
                        _ = {},
                        v = {},
                        y = 0,
                        b = "canceled",
                        x = {
                            readyState: 0,
                            getResponseHeader: function(e) {
                                var t;
                                if (2 === y) {
                                    if (!a)
                                        for (a = {}; t = ft.exec(o);) a[t[1].toLowerCase()] = t[2];
                                    t = a[e.toLowerCase()]
                                }
                                return null == t ? null : t
                            },
                            getAllResponseHeaders: function() {
                                return 2 === y ? o : null
                            },
                            setRequestHeader: function(e, t) {
                                var i = e.toLowerCase();
                                return y || (e = v[i] = v[i] || e, _[e] = t), this
                            },
                            overrideMimeType: function(e) {
                                return y || (d.mimeType = e), this
                            },
                            statusCode: function(e) {
                                var t;
                                if (e)
                                    if (2 > y)
                                        for (t in e) g[t] = [g[t], e[t]];
                                    else x.always(e[x.status]);
                                return this
                            },
                            abort: function(e) {
                                var t = e || b;
                                return n && n.abort(t), i(0, t), this
                            }
                        };
                    if (p.promise(x).complete = m.add, x.success = x.done, x.error = x.fail, d.url = ((e || d.url || xt) + "").replace(dt, "").replace(gt, wt[1] + "//"), d.type = t.method || t.type || d.method || d.type, d.dataTypes = J.trim(d.dataType || "*").toLowerCase().match(fe) || [""], null == d.crossDomain && (l = _t.exec(d.url.toLowerCase()), d.crossDomain = !(!l || l[1] === wt[1] && l[2] === wt[2] && (l[3] || ("http:" === l[1] ? "80" : "443")) === (wt[3] || ("http:" === wt[1] ? "80" : "443")))), d.data && d.processData && "string" != typeof d.data && (d.data = J.param(d.data, d.traditional)), N(vt, d, t, x), 2 === y) return x;
                    h = J.event && d.global, h && 0 === J.active++ && J.event.trigger("ajaxStart"), d.type = d.type.toUpperCase(), d.hasContent = !mt.test(d.type), r = d.url, d.hasContent || (d.data && (r = d.url += (ut.test(r) ? "&" : "?") + d.data, delete d.data), d.cache === !1 && (d.url = ct.test(r) ? r.replace(ct, "$1_=" + ht++) : r + (ut.test(r) ? "&" : "?") + "_=" + ht++)), d.ifModified && (J.lastModified[r] && x.setRequestHeader("If-Modified-Since", J.lastModified[r]), J.etag[r] && x.setRequestHeader("If-None-Match", J.etag[r])), (d.data && d.hasContent && d.contentType !== !1 || t.contentType) && x.setRequestHeader("Content-Type", d.contentType), x.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + ("*" !== d.dataTypes[0] ? ", " + bt + "; q=0.01" : "") : d.accepts["*"]);
                    for (u in d.headers) x.setRequestHeader(u, d.headers[u]);
                    if (d.beforeSend && (d.beforeSend.call(c, x, d) === !1 || 2 === y)) return x.abort();
                    b = "abort";
                    for (u in {
                            success: 1,
                            error: 1,
                            complete: 1
                        }) x[u](d[u]);
                    if (n = N(yt, d, t, x)) {
                        x.readyState = 1, h && f.trigger("ajaxSend", [x, d]), d.async && d.timeout > 0 && (s = setTimeout(function() {
                            x.abort("timeout")
                        }, d.timeout));
                        try {
                            y = 1, n.send(_, i)
                        } catch (w) {
                            if (!(2 > y)) throw w;
                            i(-1, w)
                        }
                    } else i(-1, "No Transport");
                    return x
                },
                getJSON: function(e, t, i) {
                    return J.get(e, t, i, "json")
                },
                getScript: function(e, t) {
                    return J.get(e, void 0, t, "script")
                }
            }), J.each(["get", "post"], function(e, t) {
                J[t] = function(e, i, n, r) {
                    return J.isFunction(i) && (r = r || n, n = i, i = void 0), J.ajax({
                        url: e,
                        type: t,
                        dataType: r,
                        data: i,
                        success: n
                    })
                }
            }), J._evalUrl = function(e) {
                return J.ajax({
                    url: e,
                    type: "GET",
                    dataType: "script",
                    async: !1,
                    global: !1,
                    "throws": !0
                })
            }, J.fn.extend({
                wrapAll: function(e) {
                    var t;
                    return J.isFunction(e) ? this.each(function(t) {
                        J(this).wrapAll(e.call(this, t))
                    }) : (this[0] && (t = J(e, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && t.insertBefore(this[0]), t.map(function() {
                        for (var e = this; e.firstElementChild;) e = e.firstElementChild;
                        return e
                    }).append(this)), this)
                },
                wrapInner: function(e) {
                    return J.isFunction(e) ? this.each(function(t) {
                        J(this).wrapInner(e.call(this, t))
                    }) : this.each(function() {
                        var t = J(this),
                            i = t.contents();
                        i.length ? i.wrapAll(e) : t.append(e)
                    })
                },
                wrap: function(e) {
                    var t = J.isFunction(e);
                    return this.each(function(i) {
                        J(this).wrapAll(t ? e.call(this, i) : e)
                    })
                },
                unwrap: function() {
                    return this.parent().each(function() {
                        J.nodeName(this, "body") || J(this).replaceWith(this.childNodes)
                    }).end()
                }
            }), J.expr.filters.hidden = function(e) {
                return e.offsetWidth <= 0 && e.offsetHeight <= 0
            }, J.expr.filters.visible = function(e) {
                return !J.expr.filters.hidden(e)
            };
            var Mt = /%20/g,
                Tt = /\[\]$/,
                St = /\r?\n/g,
                Ct = /^(?:submit|button|image|reset|file)$/i,
                Et = /^(?:input|select|textarea|keygen)/i;
            J.param = function(e, t) {
                var i, n = [],
                    r = function(e, t) {
                        t = J.isFunction(t) ? t() : null == t ? "" : t, n[n.length] = encodeURIComponent(e) + "=" + encodeURIComponent(t)
                    };
                if (void 0 === t && (t = J.ajaxSettings && J.ajaxSettings.traditional), J.isArray(e) || e.jquery && !J.isPlainObject(e)) J.each(e, function() {
                    r(this.name, this.value)
                });
                else
                    for (i in e) H(i, e[i], t, r);
                return n.join("&").replace(Mt, "+")
            }, J.fn.extend({
                serialize: function() {
                    return J.param(this.serializeArray())
                },
                serializeArray: function() {
                    return this.map(function() {
                        var e = J.prop(this, "elements");
                        return e ? J.makeArray(e) : this
                    }).filter(function() {
                        var e = this.type;
                        return this.name && !J(this).is(":disabled") && Et.test(this.nodeName) && !Ct.test(e) && (this.checked || !Te.test(e))
                    }).map(function(e, t) {
                        var i = J(this).val();
                        return null == i ? null : J.isArray(i) ? J.map(i, function(e) {
                            return {
                                name: t.name,
                                value: e.replace(St, "\r\n")
                            }
                        }) : {
                            name: t.name,
                            value: i.replace(St, "\r\n")
                        }
                    }).get()
                }
            }), J.ajaxSettings.xhr = function() {
                try {
                    return new XMLHttpRequest
                } catch (e) {}
            };
            var kt = 0,
                Lt = {},
                Pt = {
                    0: 200,
                    1223: 204
                },
                At = J.ajaxSettings.xhr();
            e.attachEvent && e.attachEvent("onunload", function() {
                for (var e in Lt) Lt[e]()
            }), X.cors = !!At && "withCredentials" in At, X.ajax = At = !!At, J.ajaxTransport(function(e) {
                var t;
                return X.cors || At && !e.crossDomain ? {
                    send: function(i, n) {
                        var r, o = e.xhr(),
                            a = ++kt;
                        if (o.open(e.type, e.url, e.async, e.username, e.password), e.xhrFields)
                            for (r in e.xhrFields) o[r] = e.xhrFields[r];
                        e.mimeType && o.overrideMimeType && o.overrideMimeType(e.mimeType), e.crossDomain || i["X-Requested-With"] || (i["X-Requested-With"] = "XMLHttpRequest");
                        for (r in i) o.setRequestHeader(r, i[r]);
                        t = function(e) {
                            return function() {
                                t && (delete Lt[a], t = o.onload = o.onerror = null, "abort" === e ? o.abort() : "error" === e ? n(o.status, o.statusText) : n(Pt[o.status] || o.status, o.statusText, "string" == typeof o.responseText ? {
                                    text: o.responseText
                                } : void 0, o.getAllResponseHeaders()))
                            }
                        }, o.onload = t(), o.onerror = t("error"), t = Lt[a] = t("abort");
                        try {
                            o.send(e.hasContent && e.data || null)
                        } catch (s) {
                            if (t) throw s
                        }
                    },
                    abort: function() {
                        t && t()
                    }
                } : void 0
            }), J.ajaxSetup({
                accepts: {
                    script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"
                },
                contents: {
                    script: /(?:java|ecma)script/
                },
                converters: {
                    "text script": function(e) {
                        return J.globalEval(e), e
                    }
                }
            }), J.ajaxPrefilter("script", function(e) {
                void 0 === e.cache && (e.cache = !1), e.crossDomain && (e.type = "GET")
            }), J.ajaxTransport("script", function(e) {
                if (e.crossDomain) {
                    var t, i;
                    return {
                        send: function(n, r) {
                            t = J("<script>").prop({
                                async: !0,
                                charset: e.scriptCharset,
                                src: e.url
                            }).on("load error", i = function(e) {
                                t.remove(), i = null, e && r("error" === e.type ? 404 : 200, e.type)
                            }), $.head.appendChild(t[0])
                        },
                        abort: function() {
                            i && i()
                        }
                    }
                }
            });
            var Rt = [],
                Dt = /(=)\?(?=&|$)|\?\?/;
            J.ajaxSetup({
                jsonp: "callback",
                jsonpCallback: function() {
                    var e = Rt.pop() || J.expando + "_" + ht++;
                    return this[e] = !0, e
                }
            }), J.ajaxPrefilter("json jsonp", function(t, i, n) {
                var r, o, a, s = t.jsonp !== !1 && (Dt.test(t.url) ? "url" : "string" == typeof t.data && !(t.contentType || "").indexOf("application/x-www-form-urlencoded") && Dt.test(t.data) && "data");
                return s || "jsonp" === t.dataTypes[0] ? (r = t.jsonpCallback = J.isFunction(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, s ? t[s] = t[s].replace(Dt, "$1" + r) : t.jsonp !== !1 && (t.url += (ut.test(t.url) ? "&" : "?") + t.jsonp + "=" + r), t.converters["script json"] = function() {
                    return a || J.error(r + " was not called"), a[0]
                }, t.dataTypes[0] = "json", o = e[r], e[r] = function() {
                    a = arguments
                }, n.always(function() {
                    e[r] = o, t[r] && (t.jsonpCallback = i.jsonpCallback, Rt.push(r)), a && J.isFunction(o) && o(a[0]), a = o = void 0
                }), "script") : void 0
            }), J.parseHTML = function(e, t, i) {
                if (!e || "string" != typeof e) return null;
                "boolean" == typeof t && (i = t, t = !1), t = t || $;
                var n = ae.exec(e),
                    r = !i && [];
                return n ? [t.createElement(n[1])] : (n = J.buildFragment([e], t, r), r && r.length && J(r).remove(), J.merge([], n.childNodes))
            };
            var It = J.fn.load;
            J.fn.load = function(e, t, i) {
                if ("string" != typeof e && It) return It.apply(this, arguments);
                var n, r, o, a = this,
                    s = e.indexOf(" ");
                return s >= 0 && (n = J.trim(e.slice(s)), e = e.slice(0, s)), J.isFunction(t) ? (i = t, t = void 0) : t && "object" == typeof t && (r = "POST"), a.length > 0 && J.ajax({
                    url: e,
                    type: r,
                    dataType: "html",
                    data: t
                }).done(function(e) {
                    o = arguments, a.html(n ? J("<div>").append(J.parseHTML(e)).find(n) : e)
                }).complete(i && function(e, t) {
                    a.each(i, o || [e.responseText, t, e])
                }), this
            }, J.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function(e, t) {
                J.fn[t] = function(e) {
                    return this.on(t, e)
                }
            }), J.expr.filters.animated = function(e) {
                return J.grep(J.timers, function(t) {
                    return e === t.elem
                }).length
            };
            var Ot = e.document.documentElement;
            J.offset = {
                setOffset: function(e, t, i) {
                    var n, r, o, a, s, l, h, u = J.css(e, "position"),
                        d = J(e),
                        c = {};
                    "static" === u && (e.style.position = "relative"), s = d.offset(), o = J.css(e, "top"), l = J.css(e, "left"), h = ("absolute" === u || "fixed" === u) && (o + l).indexOf("auto") > -1, h ? (n = d.position(), a = n.top, r = n.left) : (a = parseFloat(o) || 0, r = parseFloat(l) || 0), J.isFunction(t) && (t = t.call(e, i, s)), null != t.top && (c.top = t.top - s.top + a), null != t.left && (c.left = t.left - s.left + r), "using" in t ? t.using.call(e, c) : d.css(c)
                }
            }, J.fn.extend({
                offset: function(e) {
                    if (arguments.length) return void 0 === e ? this : this.each(function(t) {
                        J.offset.setOffset(this, e, t)
                    });
                    var t, i, n = this[0],
                        r = {
                            top: 0,
                            left: 0
                        },
                        o = n && n.ownerDocument;
                    if (o) return t = o.documentElement, J.contains(t, n) ? (typeof n.getBoundingClientRect !== Se && (r = n.getBoundingClientRect()), i = U(o), {
                        top: r.top + i.pageYOffset - t.clientTop,
                        left: r.left + i.pageXOffset - t.clientLeft
                    }) : r
                },
                position: function() {
                    if (this[0]) {
                        var e, t, i = this[0],
                            n = {
                                top: 0,
                                left: 0
                            };
                        return "fixed" === J.css(i, "position") ? t = i.getBoundingClientRect() : (e = this.offsetParent(), t = this.offset(), J.nodeName(e[0], "html") || (n = e.offset()), n.top += J.css(e[0], "borderTopWidth", !0), n.left += J.css(e[0], "borderLeftWidth", !0)), {
                            top: t.top - n.top - J.css(i, "marginTop", !0),
                            left: t.left - n.left - J.css(i, "marginLeft", !0)
                        }
                    }
                },
                offsetParent: function() {
                    return this.map(function() {
                        for (var e = this.offsetParent || Ot; e && !J.nodeName(e, "html") && "static" === J.css(e, "position");) e = e.offsetParent;
                        return e || Ot
                    })
                }
            }), J.each({
                scrollLeft: "pageXOffset",
                scrollTop: "pageYOffset"
            }, function(t, i) {
                var n = "pageYOffset" === i;
                J.fn[t] = function(r) {
                    return ge(this, function(t, r, o) {
                        var a = U(t);
                        return void 0 === o ? a ? a[i] : t[r] : void(a ? a.scrollTo(n ? e.pageXOffset : o, n ? o : e.pageYOffset) : t[r] = o)
                    }, t, r, arguments.length, null)
                }
            }), J.each(["top", "left"], function(e, t) {
                J.cssHooks[t] = w(X.pixelPosition, function(e, i) {
                    return i ? (i = x(e, t), We.test(i) ? J(e).position()[t] + "px" : i) : void 0
                })
            }), J.each({
                Height: "height",
                Width: "width"
            }, function(e, t) {
                J.each({
                    padding: "inner" + e,
                    content: t,
                    "": "outer" + e
                }, function(i, n) {
                    J.fn[n] = function(n, r) {
                        var o = arguments.length && (i || "boolean" != typeof n),
                            a = i || (n === !0 || r === !0 ? "margin" : "border");
                        return ge(this, function(t, i, n) {
                            var r;
                            return J.isWindow(t) ? t.document.documentElement["client" + e] : 9 === t.nodeType ? (r = t.documentElement, Math.max(t.body["scroll" + e], r["scroll" + e], t.body["offset" + e], r["offset" + e], r["client" + e])) : void 0 === n ? J.css(t, i, a) : J.style(t, i, n, a)
                        }, t, o ? n : void 0, o, null)
                    }
                })
            }), J.fn.size = function() {
                return this.length
            }, J.fn.andSelf = J.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function() {
                return J
            });
            var Nt = e.jQuery,
                Bt = e.$;
            return J.noConflict = function(t) {
                return e.$ === J && (e.$ = Bt), t && e.jQuery === J && (e.jQuery = Nt), J
            }, typeof t === Se && (e.jQuery = e.$ = J), J
        })
    }, {}],
    112: [function(e, t, i) {
        "use strict";
        var n = e("./utils"),
            r = e("./support"),
            o = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
        i.encode = function(e) {
            for (var t, i, r, a, s, l, h, u = [], d = 0, c = e.length, f = c, p = "string" !== n.getTypeOf(e); d < e.length;) f = c - d, p ? (t = e[d++], i = c > d ? e[d++] : 0, r = c > d ? e[d++] : 0) : (t = e.charCodeAt(d++), i = c > d ? e.charCodeAt(d++) : 0, r = c > d ? e.charCodeAt(d++) : 0), a = t >> 2, s = (3 & t) << 4 | i >> 4, l = f > 1 ? (15 & i) << 2 | r >> 6 : 64, h = f > 2 ? 63 & r : 64, u.push(o.charAt(a) + o.charAt(s) + o.charAt(l) + o.charAt(h));
            return u.join("")
        }, i.decode = function(e) {
            var t, i, n, a, s, l, h, u = 0,
                d = 0;
            e = e.replace(/[^A-Za-z0-9\+\/\=]/g, "");
            var c = 3 * e.length / 4;
            e.charAt(e.length - 1) === o.charAt(64) && c--, e.charAt(e.length - 2) === o.charAt(64) && c--;
            var f;
            for (f = r.uint8array ? new Uint8Array(c) : new Array(c); u < e.length;) a = o.indexOf(e.charAt(u++)), s = o.indexOf(e.charAt(u++)), l = o.indexOf(e.charAt(u++)), h = o.indexOf(e.charAt(u++)), t = a << 2 | s >> 4, i = (15 & s) << 4 | l >> 2, n = (3 & l) << 6 | h, f[d++] = t, 64 !== l && (f[d++] = i), 64 !== h && (f[d++] = n);
            return f
        }
    }, {
        "./support": 140,
        "./utils": 142
    }],
    113: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, r) {
            this.compressedSize = e, this.uncompressedSize = t, this.crc32 = i, this.compression = n, this.compressedContent = r
        }
        var r = e("./external"),
            o = e("./stream/DataWorker"),
            a = e("./stream/DataLengthProbe"),
            s = e("./stream/Crc32Probe"),
            a = e("./stream/DataLengthProbe");
        n.prototype = {
            getContentWorker: function() {
                var e = new o(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),
                    t = this;
                return e.on("end", function() {
                    if (this.streamInfo.data_length !== t.uncompressedSize) throw new Error("Bug : uncompressed data size mismatch")
                }), e
            },
            getCompressedWorker: function() {
                return new o(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize", this.compressedSize).withStreamInfo("uncompressedSize", this.uncompressedSize).withStreamInfo("crc32", this.crc32).withStreamInfo("compression", this.compression)
            }
        }, n.createWorkerFrom = function(e, t, i) {
            return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new a("compressedSize")).withStreamInfo("compression", t)
        }, t.exports = n
    }, {
        "./external": 117,
        "./stream/Crc32Probe": 135,
        "./stream/DataLengthProbe": 136,
        "./stream/DataWorker": 137
    }],
    114: [function(e, t, i) {
        "use strict";
        var n = e("./stream/GenericWorker");
        i.STORE = {
            magic: "\x00\x00",
            compressWorker: function(e) {
                return new n("STORE compression")
            },
            uncompressWorker: function() {
                return new n("STORE decompression")
            }
        }, i.DEFLATE = e("./flate")
    }, {
        "./flate": 118,
        "./stream/GenericWorker": 138
    }],
    115: [function(e, t, i) {
        "use strict";

        function n() {
            for (var e, t = [], i = 0; 256 > i; i++) {
                e = i;
                for (var n = 0; 8 > n; n++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
                t[i] = e
            }
            return t
        }

        function r(e, t, i, n) {
            var r = s,
                o = n + i;
            e = -1 ^ e;
            for (var a = n; o > a; a++) e = e >>> 8 ^ r[255 & (e ^ t[a])];
            return -1 ^ e
        }

        function o(e, t, i, n) {
            var r = s,
                o = n + i;
            e = -1 ^ e;
            for (var a = n; o > a; a++) e = e >>> 8 ^ r[255 & (e ^ t.charCodeAt(a))];
            return -1 ^ e
        }
        var a = e("./utils"),
            s = n();
        t.exports = function(e, t) {
            if ("undefined" == typeof e || !e.length) return 0;
            var i = "string" !== a.getTypeOf(e);
            return i ? r(0 | t, e, e.length, 0) : o(0 | t, e, e.length, 0)
        }
    }, {
        "./utils": 142
    }],
    116: [function(e, t, i) {
        "use strict";
        i.base64 = !1, i.binary = !1, i.dir = !1, i.createFolders = !0, i.date = null, i.compression = null, i.compressionOptions = null, i.comment = null, i.unixPermissions = null, i.dosPermissions = null
    }, {}],
    117: [function(e, t, i) {
        "use strict";
        var n = e("es6-promise").Promise;
        t.exports = {
            Promise: n
        }
    }, {
        "es6-promise": 98
    }],
    118: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            s.call(this, "FlateWorker/" + e), this._pako = new o[e]({
                raw: !0,
                level: t.level || -1
            }), this.meta = {};
            var i = this;
            this._pako.onData = function(e) {
                i.push({
                    data: e,
                    meta: i.meta
                })
            }
        }
        var r = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Uint32Array,
            o = e("pako"),
            a = e("./utils"),
            s = e("./stream/GenericWorker"),
            l = r ? "uint8array" : "array";
        i.magic = "\b\x00", a.inherits(n, s), n.prototype.processChunk = function(e) {
            this.meta = e.meta, this._pako.push(a.transformTo(l, e.data), !1)
        }, n.prototype.flush = function() {
            s.prototype.flush.call(this), this._pako.push([], !0)
        }, n.prototype.cleanUp = function() {
            s.prototype.cleanUp.call(this), this._pako = null
        }, i.compressWorker = function(e) {
            return new n("Deflate", e)
        }, i.uncompressWorker = function() {
            return new n("Inflate", {})
        }
    }, {
        "./stream/GenericWorker": 138,
        "./utils": 142,
        pako: 151
    }],
    119: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            o.call(this, "ZipFileWorker"), this.bytesWritten = 0, this.zipComment = t, this.zipPlatform = i, this.encodeFileName = n, this.streamFiles = e, this.accumulate = !1, this.contentBuffer = [], this.dirRecords = [], this.currentSourceOffset = 0, this.entriesCount = 0, this.currentFile = null, this._sources = []
        }
        var r = e("../utils"),
            o = e("../stream/GenericWorker"),
            a = e("../utf8"),
            s = e("../crc32"),
            l = e("../signature"),
            h = function(e, t) {
                var i, n = "";
                for (i = 0; t > i; i++) n += String.fromCharCode(255 & e), e >>>= 8;
                return n
            },
            u = function(e, t) {
                var i = e;
                return e || (i = t ? 16893 : 33204), (65535 & i) << 16
            },
            d = function(e, t) {
                return 63 & (e || 0)
            },
            c = function(e, t, i, n, o, c) {
                var f, p, m = e.file,
                    g = e.compression,
                    _ = c !== a.utf8encode,
                    v = r.transformTo("string", c(m.name)),
                    y = r.transformTo("string", a.utf8encode(m.name)),
                    b = m.comment,
                    x = r.transformTo("string", c(b)),
                    w = r.transformTo("string", a.utf8encode(b)),
                    M = y.length !== m.name.length,
                    T = w.length !== b.length,
                    S = "",
                    C = "",
                    E = "",
                    k = m.dir,
                    L = m.date,
                    P = {
                        crc32: 0,
                        compressedSize: 0,
                        uncompressedSize: 0
                    };
                (!t || i) && (P.crc32 = e.crc32, P.compressedSize = e.compressedSize, P.uncompressedSize = e.uncompressedSize);
                var A = 0;
                t && (A |= 8), _ || !M && !T || (A |= 2048);
                var R = 0,
                    D = 0;
                k && (R |= 16), "UNIX" === o ? (D = 798, R |= u(m.unixPermissions, k)) : (D = 20, R |= d(m.dosPermissions, k)), f = L.getUTCHours(), f <<= 6, f |= L.getUTCMinutes(), f <<= 5, f |= L.getUTCSeconds() / 2, p = L.getUTCFullYear() - 1980, p <<= 4, p |= L.getUTCMonth() + 1, p <<= 5, p |= L.getUTCDate(), M && (C = h(1, 1) + h(s(v), 4) + y, S += "up" + h(C.length, 2) + C), T && (E = h(1, 1) + h(s(x), 4) + w, S += "uc" + h(E.length, 2) + E);
                var I = "";
                I += "\n\x00", I += h(A, 2), I += g.magic, I += h(f, 2), I += h(p, 2), I += h(P.crc32, 4), I += h(P.compressedSize, 4), I += h(P.uncompressedSize, 4), I += h(v.length, 2), I += h(S.length, 2);
                var O = l.LOCAL_FILE_HEADER + I + v + S,
                    N = l.CENTRAL_FILE_HEADER + h(D, 2) + I + h(x.length, 2) + "\x00\x00\x00\x00" + h(R, 4) + h(n, 4) + v + S + x;
                return {
                    fileRecord: O,
                    dirRecord: N
                }
            },
            f = function(e, t, i, n, o) {
                var a = "",
                    s = r.transformTo("string", o(n));
                return a = l.CENTRAL_DIRECTORY_END + "\x00\x00\x00\x00" + h(e, 2) + h(e, 2) + h(t, 4) + h(i, 4) + h(s.length, 2) + s
            },
            p = function(e) {
                var t = "";
                return t = l.DATA_DESCRIPTOR + h(e.crc32, 4) + h(e.compressedSize, 4) + h(e.uncompressedSize, 4)
            };
        r.inherits(n, o), n.prototype.push = function(e) {
            var t = e.meta.percent || 0,
                i = this.entriesCount,
                n = this._sources.length;
            this.accumulate ? this.contentBuffer.push(e) : (this.bytesWritten += e.data.length, o.prototype.push.call(this, {
                data: e.data,
                meta: {
                    currentFile: this.currentFile,
                    percent: i ? (t + 100 * (i - n - 1)) / i : 100
                }
            }))
        }, n.prototype.openedSource = function(e) {
            if (this.currentSourceOffset = this.bytesWritten, this.currentFile = e.file.name, this.streamFiles && !e.file.dir) {
                var t = c(e, this.streamFiles, !1, this.currentSourceOffset, this.zipPlatform, this.encodeFileName);
                this.push({
                    data: t.fileRecord,
                    meta: {
                        percent: 0
                    }
                })
            } else this.accumulate = !0
        }, n.prototype.closedSource = function(e) {
            this.accumulate = !1;
            var t = c(e, this.streamFiles, !0, this.currentSourceOffset, this.zipPlatform, this.encodeFileName);
            if (this.dirRecords.push(t.dirRecord), this.streamFiles && !e.file.dir) this.push({
                data: p(e),
                meta: {
                    percent: 100
                }
            });
            else
                for (this.push({
                        data: t.fileRecord,
                        meta: {
                            percent: 0
                        }
                    }); this.contentBuffer.length;) this.push(this.contentBuffer.shift());
            this.currentFile = null
        }, n.prototype.flush = function() {
            for (var e = this.bytesWritten, t = 0; t < this.dirRecords.length; t++) this.push({
                data: this.dirRecords[t],
                meta: {
                    percent: 100
                }
            });
            var i = this.bytesWritten - e,
                n = f(this.dirRecords.length, i, e, this.zipComment, this.encodeFileName);
            this.push({
                data: n,
                meta: {
                    percent: 100
                }
            })
        }, n.prototype.prepareNextSource = function() {
            this.previous = this._sources.shift(), this.openedSource(this.previous.streamInfo), this.isPaused ? this.previous.pause() : this.previous.resume()
        }, n.prototype.registerPrevious = function(e) {
            this._sources.push(e);
            var t = this;
            return e.on("data", function(e) {
                t.processChunk(e)
            }), e.on("end", function() {
                t.closedSource(t.previous.streamInfo), t._sources.length ? t.prepareNextSource() : t.end()
            }), e.on("error", function(e) {
                t.error(e)
            }), this
        }, n.prototype.resume = function() {
            return o.prototype.resume.call(this) ? !this.previous && this._sources.length ? (this.prepareNextSource(), !0) : this.previous || this._sources.length || this.generatedError ? void 0 : (this.end(), !0) : !1
        }, n.prototype.error = function(e) {
            var t = this._sources;
            if (!o.prototype.error.call(this, e)) return !1;
            for (var i = 0; i < t.length; i++) try {
                t[i].error(e)
            } catch (e) {}
            return !0
        }, n.prototype.lock = function() {
            o.prototype.lock.call(this);
            for (var e = this._sources, t = 0; t < e.length; t++) e[t].lock()
        }, t.exports = n
    }, {
        "../crc32": 115,
        "../signature": 133,
        "../stream/GenericWorker": 138,
        "../utf8": 141,
        "../utils": 142
    }],
    120: [function(e, t, i) {
        "use strict";
        var n = e("../compressions"),
            r = e("./ZipFileWorker"),
            o = function(e, t) {
                var i = e || t,
                    r = n[i];
                if (!r) throw new Error(i + " is not a valid compression method !");
                return r
            };
        i.generateWorker = function(e, t, i) {
            var n = new r(t.streamFiles, i, t.platform, t.encodeFileName),
                a = 0;
            try {
                e.forEach(function(e, i) {
                    a++;
                    var r = o(i.options.compression, t.compression),
                        s = i.options.compressionOptions || t.compressionOptions || {},
                        l = i.dir,
                        h = i.date;
                    i._compressWorker(r, s).withStreamInfo("file", {
                        name: e,
                        dir: l,
                        date: h,
                        comment: i.comment || "",
                        unixPermissions: i.unixPermissions,
                        dosPermissions: i.dosPermissions
                    }).pipe(n)
                }), n.entriesCount = a
            } catch (s) {
                n.error(s)
            }
            return n
        }
    }, {
        "../compressions": 114,
        "./ZipFileWorker": 119
    }],
    121: [function(e, t, i) {
        "use strict";

        function n() {
            if (!(this instanceof n)) return new n;
            if (arguments.length) throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");
            this.files = {}, this.comment = null, this.root = "", this.clone = function() {
                var e = new n;
                for (var t in this) "function" != typeof this[t] && (e[t] = this[t]);
                return e
            }
        }
        n.prototype = e("./object"), n.prototype.loadAsync = e("./load"), n.support = e("./support"), n.defaults = e("./defaults"), n.loadAsync = function(e, t) {
            return (new n).loadAsync(e, t)
        }, n.external = e("./external"), t.exports = n
    }, {
        "./defaults": 116,
        "./external": 117,
        "./load": 122,
        "./object": 126,
        "./support": 140
    }],
    122: [function(e, t, i) {
        "use strict";

        function n(e) {
            return new o.Promise(function(t, i) {
                var n = e.decompressed.getContentWorker().pipe(new l);
                n.on("error", function(e) {
                    i(e)
                }).on("end", function() {
                    n.streamInfo.crc32 !== e.decompressed.crc32 ? i(new Error("Corrupted zip : CRC32 mismatch")) : t()
                }).resume()
            })
        }
        var r = e("./utils"),
            o = e("./external"),
            a = e("./utf8"),
            r = e("./utils"),
            s = e("./zipEntries"),
            l = e("./stream/Crc32Probe"),
            h = e("./nodejsUtils");
        t.exports = function(e, t) {
            var i = this;
            return t = r.extend(t || {}, {
                base64: !1,
                checkCRC32: !1,
                optimizedBinaryString: !1,
                createFolders: !1,
                decodeFileName: a.utf8decode
            }), h.isNode && h.isStream(e) ? o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")) : r.prepareContent("the loaded zip file", e, !0, t.optimizedBinaryString, t.base64).then(function(e) {
                var i = new s(t);
                return i.load(e), i
            }).then(function(e) {
                var i = [o.Promise.resolve(e)],
                    r = e.files;
                if (t.checkCRC32)
                    for (var a = 0; a < r.length; a++) i.push(n(r[a]));
                return o.Promise.all(i)
            }).then(function(e) {
                for (var n = e.shift(), r = n.files, o = 0; o < r.length; o++) {
                    var a = r[o];
                    i.file(a.fileNameStr, a.decompressed, {
                        binary: !0,
                        optimizedBinaryString: !0,
                        date: a.date,
                        dir: a.dir,
                        comment: a.fileCommentStr.length ? a.fileCommentStr : null,
                        unixPermissions: a.unixPermissions,
                        dosPermissions: a.dosPermissions,
                        createFolders: t.createFolders
                    })
                }
                return n.zipComment.length && (i.comment = n.zipComment), i
            })
        }
    }, {
        "./external": 117,
        "./nodejsUtils": 125,
        "./stream/Crc32Probe": 135,
        "./utf8": 141,
        "./utils": 142,
        "./zipEntries": 143
    }],
    123: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            o.call(this, "Nodejs stream input adapter for " + e), this._upstreamEnded = !1, this._bindStream(t)
        }
        var r = e("../utils"),
            o = e("../stream/GenericWorker");
        r.inherits(n, o), n.prototype._bindStream = function(e) {
            var t = this;
            this._stream = e, e.pause(), e.on("data", function(e) {
                t.push({
                    data: e,
                    meta: {
                        percent: 0
                    }
                })
            }).on("error", function(e) {
                t.isPaused ? this.generatedError = e : t.error(e)
            }).on("end", function() {
                t.isPaused ? t._upstreamEnded = !0 : t.end()
            })
        }, n.prototype.pause = function() {
            return o.prototype.pause.call(this) ? (this._stream.pause(), !0) : !1
        }, n.prototype.resume = function() {
            return o.prototype.resume.call(this) ? (this._upstreamEnded ? this.end() : this._stream.resume(), !0) : !1
        }, t.exports = n
    }, {
        "../stream/GenericWorker": 138,
        "../utils": 142
    }],
    124: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            r.call(this, t), this._helper = e;
            var n = this;
            e.on("data", function(e, t) {
                n.push(e) || n._helper.pause(), i && i(t)
            }).on("error", function(e) {
                n.emit("error", e)
            }).on("end", function() {
                n.push(null)
            })
        }
        var r = e("readable-stream").Readable,
            o = e("util");
        o.inherits(n, r), n.prototype._read = function() {
            this._helper.resume()
        }, t.exports = n
    }, {
        "readable-stream": 192,
        util: 212
    }],
    125: [function(e, t, i) {
        (function(e) {
            "use strict";
            t.exports = {
                isNode: "undefined" != typeof e,
                newBuffer: function(t, i) {
                    return new e(t, i)
                },
                isBuffer: function(t) {
                    return e.isBuffer(t)
                },
                isStream: function(e) {
                    return e && "function" == typeof e.on && "function" == typeof e.pause && "function" == typeof e.resume
                }
            }
        }).call(this, e("buffer").Buffer)
    }, {
        buffer: 6
    }],
    126: [function(e, t, i) {
        "use strict";

        function n(e) {
            return "[object RegExp]" === Object.prototype.toString.call(e)
        }
        var r = e("./utf8"),
            o = e("./utils"),
            a = e("./stream/GenericWorker"),
            s = e("./stream/StreamHelper"),
            l = e("./defaults"),
            h = e("./compressedObject"),
            u = e("./zipObject"),
            d = e("./generate"),
            c = e("./nodejsUtils"),
            f = e("./nodejs/NodejsStreamInputAdapter"),
            p = function(e, t, i) {
                var n, r = o.getTypeOf(t);
                i = o.extend(i || {}, l), i.date = i.date || new Date, null !== i.compression && (i.compression = i.compression.toUpperCase()), "string" == typeof i.unixPermissions && (i.unixPermissions = parseInt(i.unixPermissions, 8)), i.unixPermissions && 16384 & i.unixPermissions && (i.dir = !0), i.dosPermissions && 16 & i.dosPermissions && (i.dir = !0), i.dir && (e = g(e)), i.createFolders && (n = m(e)) && _.call(this, n, !0);
                var s = "string" === r && i.binary === !1 && i.base64 === !1;
                i.binary = !s;
                var d = t instanceof h && 0 === t.uncompressedSize;
                (d || i.dir || !t || 0 === t.length) && (i.base64 = !1, i.binary = !0, t = "", i.compression = "STORE", r = "string");
                var p = null;
                p = t instanceof h || t instanceof a ? t : c.isNode && c.isStream(t) ? new f(e, t) : o.prepareContent(e, t, i.binary, i.optimizedBinaryString, i.base64);
                var v = new u(e, p, i);
                this.files[e] = v
            },
            m = function(e) {
                "/" === e.slice(-1) && (e = e.substring(0, e.length - 1));
                var t = e.lastIndexOf("/");
                return t > 0 ? e.substring(0, t) : ""
            },
            g = function(e) {
                return "/" !== e.slice(-1) && (e += "/"), e
            },
            _ = function(e, t) {
                return t = "undefined" != typeof t ? t : l.createFolders, e = g(e), this.files[e] || p.call(this, e, null, {
                    dir: !0,
                    createFolders: t
                }), this.files[e]
            },
            v = {
                load: function() {
                    throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")
                },
                forEach: function(e) {
                    var t, i, n;
                    for (t in this.files) this.files.hasOwnProperty(t) && (n = this.files[t], i = t.slice(this.root.length, t.length), i && t.slice(0, this.root.length) === this.root && e(i, n))
                },
                filter: function(e) {
                    var t = [];
                    return this.forEach(function(i, n) {
                        e(i, n) && t.push(n)
                    }), t
                },
                file: function(e, t, i) {
                    if (1 === arguments.length) {
                        if (n(e)) {
                            var r = e;
                            return this.filter(function(e, t) {
                                return !t.dir && r.test(e)
                            })
                        }
                        var o = this.files[this.root + e];
                        return o && !o.dir ? o : null
                    }
                    return e = this.root + e, p.call(this, e, t, i), this
                },
                folder: function(e) {
                    if (!e) return this;
                    if (n(e)) return this.filter(function(t, i) {
                        return i.dir && e.test(t)
                    });
                    var t = this.root + e,
                        i = _.call(this, t),
                        r = this.clone();
                    return r.root = i.name, r
                },
                remove: function(e) {
                    e = this.root + e;
                    var t = this.files[e];
                    if (t || ("/" !== e.slice(-1) && (e += "/"), t = this.files[e]), t && !t.dir) delete this.files[e];
                    else
                        for (var i = this.filter(function(t, i) {
                                return i.name.slice(0, e.length) === e
                            }), n = 0; n < i.length; n++) delete this.files[i[n].name];
                    return this
                },
                generate: function(e) {
                    throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")
                },
                generateInternalStream: function(e) {
                    var t, i = {};
                    try {
                        if (i = o.extend(e || {}, {
                                streamFiles: !1,
                                compression: "STORE",
                                compressionOptions: null,
                                type: "",
                                platform: "DOS",
                                comment: null,
                                mimeType: "application/zip",
                                encodeFileName: r.utf8encode
                            }), i.type = i.type.toLowerCase(), i.compression = i.compression.toUpperCase(), "binarystring" === i.type && (i.type = "string"), !i.type) throw new Error("No output type specified.");
                        o.checkSupport(i.type), ("darwin" === e.platform || "freebsd" === e.platform || "linux" === e.platform || "sunos" === e.platform) && (e.platform = "UNIX"), "win32" === e.platform && (e.platform = "DOS");
                        var n = i.comment || this.comment || "";
                        t = d.generateWorker(this, i, n)
                    } catch (l) {
                        t = new a("error"), t.error(l)
                    }
                    return new s(t, i.type || "string", i.mimeType)
                },
                generateAsync: function(e, t) {
                    return this.generateInternalStream(e).accumulate(t)
                },
                generateNodeStream: function(e, t) {
                    return e = e || {}, e.type || (e.type = "nodebuffer"), this.generateInternalStream(e).toNodejsStream(t)
                }
            };
        t.exports = v
    }, {
        "./compressedObject": 113,
        "./defaults": 116,
        "./generate": 120,
        "./nodejs/NodejsStreamInputAdapter": 123,
        "./nodejsUtils": 125,
        "./stream/GenericWorker": 138,
        "./stream/StreamHelper": 139,
        "./utf8": 141,
        "./utils": 142,
        "./zipObject": 145
    }],
    127: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this, e);
            for (var t = 0; t < this.data.length; t++) e[t] = 255 & e[t]
        }
        var r = e("./DataReader"),
            o = e("../utils");
        o.inherits(n, r), n.prototype.byteAt = function(e) {
            return this.data[this.zero + e]
        }, n.prototype.lastIndexOfSignature = function(e) {
            for (var t = e.charCodeAt(0), i = e.charCodeAt(1), n = e.charCodeAt(2), r = e.charCodeAt(3), o = this.length - 4; o >= 0; --o)
                if (this.data[o] === t && this.data[o + 1] === i && this.data[o + 2] === n && this.data[o + 3] === r) return o - this.zero;
            return -1
        }, n.prototype.readAndCheckSignature = function(e) {
            var t = e.charCodeAt(0),
                i = e.charCodeAt(1),
                n = e.charCodeAt(2),
                r = e.charCodeAt(3),
                o = this.readData(4);
            return t === o[0] && i === o[1] && n === o[2] && r === o[3]
        }, n.prototype.readData = function(e) {
            if (this.checkOffset(e), 0 === e) return [];
            var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
            return this.index += e, t
        }, t.exports = n
    }, {
        "../utils": 142,
        "./DataReader": 128
    }],
    128: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.data = e, this.length = e.length, this.index = 0, this.zero = 0
        }
        var r = e("../utils");
        n.prototype = {
            checkOffset: function(e) {
                this.checkIndex(this.index + e)
            },
            checkIndex: function(e) {
                if (this.length < this.zero + e || 0 > e) throw new Error("End of data reached (data length = " + this.length + ", asked index = " + e + "). Corrupted zip ?")
            },
            setIndex: function(e) {
                this.checkIndex(e), this.index = e
            },
            skip: function(e) {
                this.setIndex(this.index + e)
            },
            byteAt: function(e) {},
            readInt: function(e) {
                var t, i = 0;
                for (this.checkOffset(e), t = this.index + e - 1; t >= this.index; t--) i = (i << 8) + this.byteAt(t);
                return this.index += e, i
            },
            readString: function(e) {
                return r.transformTo("string", this.readData(e))
            },
            readData: function(e) {},
            lastIndexOfSignature: function(e) {},
            readAndCheckSignature: function(e) {},
            readDate: function() {
                var e = this.readInt(4);
                return new Date(Date.UTC((e >> 25 & 127) + 1980, (e >> 21 & 15) - 1, e >> 16 & 31, e >> 11 & 31, e >> 5 & 63, (31 & e) << 1))
            }
        }, t.exports = n
    }, {
        "../utils": 142
    }],
    129: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this, e)
        }
        var r = e("./Uint8ArrayReader"),
            o = e("../utils");
        o.inherits(n, r), n.prototype.readData = function(e) {
            this.checkOffset(e);
            var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
            return this.index += e, t
        }, t.exports = n
    }, {
        "../utils": 142,
        "./Uint8ArrayReader": 131
    }],
    130: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this, e)
        }
        var r = e("./DataReader"),
            o = e("../utils");
        o.inherits(n, r), n.prototype.byteAt = function(e) {
            return this.data.charCodeAt(this.zero + e)
        }, n.prototype.lastIndexOfSignature = function(e) {
            return this.data.lastIndexOf(e) - this.zero
        }, n.prototype.readAndCheckSignature = function(e) {
            var t = this.readData(4);
            return e === t
        }, n.prototype.readData = function(e) {
            this.checkOffset(e);
            var t = this.data.slice(this.zero + this.index, this.zero + this.index + e);
            return this.index += e, t
        }, t.exports = n
    }, {
        "../utils": 142,
        "./DataReader": 128
    }],
    131: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this, e)
        }
        var r = e("./ArrayReader"),
            o = e("../utils");
        o.inherits(n, r), n.prototype.readData = function(e) {
            if (this.checkOffset(e), 0 === e) return new Uint8Array(0);
            var t = this.data.subarray(this.zero + this.index, this.zero + this.index + e);
            return this.index += e, t
        }, t.exports = n
    }, {
        "../utils": 142,
        "./ArrayReader": 127
    }],
    132: [function(e, t, i) {
        "use strict";
        var n = e("../utils"),
            r = e("../support"),
            o = e("./ArrayReader"),
            a = e("./StringReader"),
            s = e("./NodeBufferReader"),
            l = e("./Uint8ArrayReader");
        t.exports = function(e) {
            var t = n.getTypeOf(e);
            return n.checkSupport(t), "string" !== t || r.uint8array ? "nodebuffer" === t ? new s(e) : r.uint8array ? new l(n.transformTo("uint8array", e)) : new o(n.transformTo("array", e)) : new a(e)
        }
    }, {
        "../support": 140,
        "../utils": 142,
        "./ArrayReader": 127,
        "./NodeBufferReader": 129,
        "./StringReader": 130,
        "./Uint8ArrayReader": 131
    }],
    133: [function(e, t, i) {
        "use strict";
        i.LOCAL_FILE_HEADER = "PK", i.CENTRAL_FILE_HEADER = "PK", i.CENTRAL_DIRECTORY_END = "PK", i.ZIP64_CENTRAL_DIRECTORY_LOCATOR = "PK", i.ZIP64_CENTRAL_DIRECTORY_END = "PK", i.DATA_DESCRIPTOR = "PK\b"
    }, {}],
    134: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this, "ConvertWorker to " + e), this.destType = e
        }
        var r = e("./GenericWorker"),
            o = e("../utils");
        o.inherits(n, r), n.prototype.processChunk = function(e) {
            this.push({
                data: o.transformTo(this.destType, e.data),
                meta: e.meta
            })
        }, t.exports = n
    }, {
        "../utils": 142,
        "./GenericWorker": 138
    }],
    135: [function(e, t, i) {
        "use strict";

        function n() {
            r.call(this, "Crc32Probe")
        }
        var r = e("./GenericWorker"),
            o = e("../crc32"),
            a = e("../utils");
        a.inherits(n, r), n.prototype.processChunk = function(e) {
            this.streamInfo.crc32 = o(e.data, this.streamInfo.crc32 || 0), this.push(e)
        }, t.exports = n
    }, {
        "../crc32": 115,
        "../utils": 142,
        "./GenericWorker": 138
    }],
    136: [function(e, t, i) {
        "use strict";

        function n(e) {
            o.call(this, "DataLengthProbe for " + e), this.propName = e, this.withStreamInfo(e, 0)
        }
        var r = e("../utils"),
            o = e("./GenericWorker");
        r.inherits(n, o), n.prototype.processChunk = function(e) {
            if (e) {
                var t = this.streamInfo[this.propName] || 0;
                this.streamInfo[this.propName] = t + e.data.length
            }
            o.prototype.processChunk.call(this, e)
        }, t.exports = n
    }, {
        "../utils": 142,
        "./GenericWorker": 138
    }],
    137: [function(e, t, i) {
        "use strict";

        function n(e) {
            o.call(this, "DataWorker");
            var t = this;
            this.dataIsReady = !1, this.index = 0, this.max = 0, this.data = null, this.type = "", this._tickScheduled = !1, e.then(function(e) {
                t.dataIsReady = !0, t.data = e, t.max = e && e.length || 0, t.type = r.getTypeOf(e), t.isPaused || t._tickAndRepeat()
            }, function(e) {
                t.error(e)
            })
        }
        var r = e("../utils"),
            o = e("./GenericWorker"),
            a = 16384;
        r.inherits(n, o), n.prototype.cleanUp = function() {
            o.prototype.cleanUp.call(this), this.data = null
        }, n.prototype.resume = function() {
            return o.prototype.resume.call(this) ? (!this._tickScheduled && this.dataIsReady && (this._tickScheduled = !0, r.delay(this._tickAndRepeat, [], this)), !0) : !1
        }, n.prototype._tickAndRepeat = function() {
            this._tickScheduled = !1, this.isPaused || this.isFinished || (this._tick(), this.isFinished || (r.delay(this._tickAndRepeat, [], this), this._tickScheduled = !0))
        }, n.prototype._tick = function() {
            if (this.isPaused || this.isFinished) return !1;
            var e = a,
                t = null,
                i = Math.min(this.max, this.index + e);
            if (this.index >= this.max) return this.end();
            switch (this.type) {
                case "string":
                    t = this.data.substring(this.index, i);
                    break;
                case "uint8array":
                    t = this.data.subarray(this.index, i);
                    break;
                case "array":
                case "nodebuffer":
                    t = this.data.slice(this.index, i)
            }
            return this.index = i, this.push({
                data: t,
                meta: {
                    percent: this.max ? this.index / this.max * 100 : 0
                }
            })
        }, t.exports = n
    }, {
        "../utils": 142,
        "./GenericWorker": 138
    }],
    138: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.name = e || "default", this.streamInfo = {}, this.generatedError = null, this.extraStreamInfo = {}, this.isPaused = !0, this.isFinished = !1, this.isLocked = !1, this._listeners = {
                data: [],
                end: [],
                error: []
            }, this.previous = null
        }
        n.prototype = {
            push: function(e) {
                this.emit("data", e)
            },
            end: function() {
                if (this.isFinished) return !1;
                this.flush();
                try {
                    this.emit("end"), this.cleanUp(), this.isFinished = !0
                } catch (e) {
                    this.emit("error", e)
                }
                return !0
            },
            error: function(e) {
                return this.isFinished ? !1 : (this.isPaused ? this.generatedError = e : (this.isFinished = !0, this.emit("error", e), this.previous && this.previous.error(e), this.cleanUp()), !0)
            },
            on: function(e, t) {
                return this._listeners[e].push(t), this
            },
            cleanUp: function() {
                this.streamInfo = this.generatedError = this.extraStreamInfo = null, this._listeners = []
            },
            emit: function(e, t) {
                if (this._listeners[e])
                    for (var i = 0; i < this._listeners[e].length; i++) this._listeners[e][i].call(this, t)
            },
            pipe: function(e) {
                return e.registerPrevious(this)
            },
            registerPrevious: function(e) {
                if (this.isLocked) throw new Error("The stream '" + this + "' has already been used.");
                this.streamInfo = e.streamInfo, this.mergeStreamInfo(), this.previous = e;
                var t = this;
                return e.on("data", function(e) {
                    t.processChunk(e)
                }), e.on("end", function() {
                    t.end()
                }), e.on("error", function(e) {
                    t.error(e)
                }), this
            },
            pause: function() {
                return this.isPaused || this.isFinished ? !1 : (this.isPaused = !0, this.previous && this.previous.pause(), !0)
            },
            resume: function() {
                if (!this.isPaused || this.isFinished) return !1;
                this.isPaused = !1;
                var e = !1;
                return this.generatedError && (this.error(this.generatedError), e = !0), this.previous && this.previous.resume(), !e
            },
            flush: function() {},
            processChunk: function(e) {
                this.push(e)
            },
            withStreamInfo: function(e, t) {
                return this.extraStreamInfo[e] = t, this.mergeStreamInfo(), this
            },
            mergeStreamInfo: function() {
                for (var e in this.extraStreamInfo) this.extraStreamInfo.hasOwnProperty(e) && (this.streamInfo[e] = this.extraStreamInfo[e])
            },
            lock: function() {
                if (this.isLocked) throw new Error("The stream '" + this + "' has already been used.");
                this.isLocked = !0, this.previous && this.previous.lock()
            },
            toString: function() {
                var e = "Worker " + this.name;
                return this.previous ? this.previous + " -> " + e : e
            }
        }, t.exports = n
    }, {}],
    139: [function(e, t, i) {
        (function(i) {
            "use strict";

            function n(e, t, i) {
                switch (e) {
                    case "blob":
                        return s.newBlob(s.transformTo("arraybuffer", t), i);
                    case "base64":
                        return u.encode(t);
                    default:
                        return s.transformTo(e, t)
                }
            }

            function r(e, t) {
                var n, r = 0,
                    o = null,
                    a = 0;
                for (n = 0; n < t.length; n++) a += t[n].length;
                switch (e) {
                    case "string":
                        return t.join("");
                    case "array":
                        return Array.prototype.concat.apply([], t);
                    case "uint8array":
                        for (o = new Uint8Array(a), n = 0; n < t.length; n++) o.set(t[n], r), r += t[n].length;
                        return o;
                    case "nodebuffer":
                        return i.concat(t);
                    default:
                        throw new Error("concat : unsupported type '" + e + "'")
                }
            }

            function o(e, t) {
                return new c.Promise(function(i, o) {
                    var a = [],
                        s = e._internalType,
                        l = e._outputType,
                        h = e._mimeType;
                    e.on("data", function(e, i) {
                        a.push(e), t && t(i)
                    }).on("error", function(e) {
                        a = [], o(e)
                    }).on("end", function() {
                        try {
                            var e = n(l, r(s, a), h);
                            i(e)
                        } catch (t) {
                            o(t)
                        }
                        a = []
                    }).resume()
                })
            }

            function a(e, t, i) {
                var n = t;
                switch (t) {
                    case "blob":
                    case "arraybuffer":
                        n = "uint8array";
                        break;
                    case "base64":
                        n = "string"
                }
                try {
                    this._internalType = n, this._outputType = t, this._mimeType = i, s.checkSupport(n), this._worker = e.pipe(new l(n)), e.lock()
                } catch (r) {
                    this._worker = new h("error"), this._worker.error(r)
                }
            }
            var s = e("../utils"),
                l = e("./ConvertWorker"),
                h = e("./GenericWorker"),
                u = e("../base64"),
                d = e("../nodejs/NodejsStreamOutputAdapter"),
                c = e("../external");
            a.prototype = {
                accumulate: function(e) {
                    return o(this, e)
                },
                on: function(e, t) {
                    var i = this;
                    return "data" === e ? this._worker.on(e, function(e) {
                        t.call(i, e.data, e.meta)
                    }) : this._worker.on(e, function() {
                        s.delay(t, arguments, i)
                    }), this
                },
                resume: function() {
                    return s.delay(this._worker.resume, [], this._worker), this
                },
                pause: function() {
                    return this._worker.pause(), this
                },
                toNodejsStream: function(e) {
                    if (s.checkSupport("nodestream"), "nodebuffer" !== this._outputType) throw new Error(this._outputType + " is not supported by this method");
                    return new d(this, {
                        objectMode: "nodebuffer" !== this._outputType
                    }, e)
                }
            }, t.exports = a
        }).call(this, e("buffer").Buffer)
    }, {
        "../base64": 112,
        "../external": 117,
        "../nodejs/NodejsStreamOutputAdapter": 124,
        "../utils": 142,
        "./ConvertWorker": 134,
        "./GenericWorker": 138,
        buffer: 6
    }],
    140: [function(e, t, i) {
        (function(t) {
            "use strict";
            if (i.base64 = !0, i.array = !0, i.string = !0, i.arraybuffer = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array, i.nodebuffer = "undefined" != typeof t, i.uint8array = "undefined" != typeof Uint8Array, "undefined" == typeof ArrayBuffer) i.blob = !1;
            else {
                var n = new ArrayBuffer(0);
                try {
                    i.blob = 0 === new Blob([n], {
                        type: "application/zip"
                    }).size
                } catch (r) {
                    try {
                        var o = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder,
                            a = new o;
                        a.append(n), i.blob = 0 === a.getBlob("application/zip").size
                    } catch (r) {
                        i.blob = !1
                    }
                }
            }
            i.nodestream = !!e("./nodejs/NodejsStreamOutputAdapter").prototype
        }).call(this, e("buffer").Buffer)
    }, {
        "./nodejs/NodejsStreamOutputAdapter": 124,
        buffer: 6
    }],
    141: [function(e, t, i) {
        "use strict";

        function n() {
            l.call(this, "utf-8 decode"), this.leftOver = null
        }

        function r() {
            l.call(this, "utf-8 encode")
        }
        for (var o = e("./utils"), a = e("./support"), s = e("./nodejsUtils"), l = e("./stream/GenericWorker"), h = new Array(256), u = 0; 256 > u; u++) h[u] = u >= 252 ? 6 : u >= 248 ? 5 : u >= 240 ? 4 : u >= 224 ? 3 : u >= 192 ? 2 : 1;
        h[254] = h[254] = 1;
        var d = function(e) {
                var t, i, n, r, o, s = e.length,
                    l = 0;
                for (r = 0; s > r; r++) i = e.charCodeAt(r), 55296 === (64512 & i) && s > r + 1 && (n = e.charCodeAt(r + 1), 56320 === (64512 & n) && (i = 65536 + (i - 55296 << 10) + (n - 56320), r++)), l += 128 > i ? 1 : 2048 > i ? 2 : 65536 > i ? 3 : 4;
                for (t = a.uint8array ? new Uint8Array(l) : new Array(l), o = 0, r = 0; l > o; r++) i = e.charCodeAt(r), 55296 === (64512 & i) && s > r + 1 && (n = e.charCodeAt(r + 1), 56320 === (64512 & n) && (i = 65536 + (i - 55296 << 10) + (n - 56320), r++)), 128 > i ? t[o++] = i : 2048 > i ? (t[o++] = 192 | i >>> 6, t[o++] = 128 | 63 & i) : 65536 > i ? (t[o++] = 224 | i >>> 12, t[o++] = 128 | i >>> 6 & 63, t[o++] = 128 | 63 & i) : (t[o++] = 240 | i >>> 18, t[o++] = 128 | i >>> 12 & 63, t[o++] = 128 | i >>> 6 & 63, t[o++] = 128 | 63 & i);
                return t
            },
            c = function(e, t) {
                var i;
                for (t = t || e.length, t > e.length && (t = e.length), i = t - 1; i >= 0 && 128 === (192 & e[i]);) i--;
                return 0 > i ? t : 0 === i ? t : i + h[e[i]] > t ? i : t
            },
            f = function(e) {
                var t, i, n, r, a = e.length,
                    s = new Array(2 * a);
                for (i = 0, t = 0; a > t;)
                    if (n = e[t++], 128 > n) s[i++] = n;
                    else if (r = h[n], r > 4) s[i++] = 65533, t += r - 1;
                else {
                    for (n &= 2 === r ? 31 : 3 === r ? 15 : 7; r > 1 && a > t;) n = n << 6 | 63 & e[t++], r--;
                    r > 1 ? s[i++] = 65533 : 65536 > n ? s[i++] = n : (n -= 65536, s[i++] = 55296 | n >> 10 & 1023, s[i++] = 56320 | 1023 & n)
                }
                return s.length !== i && (s.subarray ? s = s.subarray(0, i) : s.length = i), o.applyFromCharCode(s)
            };
        i.utf8encode = function(e) {
            return a.nodebuffer ? s.newBuffer(e, "utf-8") : d(e)
        }, i.utf8decode = function(e) {
            return a.nodebuffer ? o.transformTo("nodebuffer", e).toString("utf-8") : (e = o.transformTo(a.uint8array ? "uint8array" : "array", e), f(e))
        }, o.inherits(n, l), n.prototype.processChunk = function(e) {
            var t = o.transformTo(a.uint8array ? "uint8array" : "array", e.data);
            if (this.leftOver && this.leftOver.length) {
                if (a.uint8array) {
                    var n = t;
                    t = new Uint8Array(n.length + this.leftOver.length), t.set(this.leftOver, 0), t.set(n, this.leftOver.length)
                } else t = this.leftOver.concat(t);
                this.leftOver = null
            }
            var r = c(t),
                s = t;
            r !== t.length && (a.uint8array ? (s = t.subarray(0, r), this.leftOver = t.subarray(r, t.length)) : (s = t.slice(0, r), this.leftOver = t.slice(r, t.length))), this.push({
                data: i.utf8decode(s),
                meta: e.meta
            })
        }, n.prototype.flush = function() {
            this.leftOver && this.leftOver.length && (this.push({
                data: i.utf8decode(this.leftOver),
                meta: {}
            }), this.leftOver = null)
        }, i.Utf8DecodeWorker = n, o.inherits(r, l), r.prototype.processChunk = function(e) {
            this.push({
                data: i.utf8encode(e.data),
                meta: e.meta
            })
        }, i.Utf8EncodeWorker = r
    }, {
        "./nodejsUtils": 125,
        "./stream/GenericWorker": 138,
        "./support": 140,
        "./utils": 142
    }],
    142: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = null;
            return t = l.uint8array ? new Uint8Array(e.length) : new Array(e.length), o(e, t)
        }

        function r(e) {
            return e
        }

        function o(e, t) {
            for (var i = 0; i < e.length; ++i) t[i] = 255 & e.charCodeAt(i);
            return t
        }

        function a(e) {
            var t = 65536,
                n = i.getTypeOf(e),
                r = !0;
            if ("uint8array" === n ? r = f.applyCanBeUsed.uint8array : "nodebuffer" === n && (r = f.applyCanBeUsed.nodebuffer), r)
                for (; t > 1;) try {
                    return f.stringifyByChunk(e, n, t)
                } catch (o) {
                    t = Math.floor(t / 2)
                }
            return f.stringifyByChar(e)
        }

        function s(e, t) {
            for (var i = 0; i < e.length; i++) t[i] = e[i];
            return t
        }
        var l = e("./support"),
            h = e("./base64"),
            u = e("./nodejsUtils"),
            d = e("asap"),
            c = e("./external");
        i.newBlob = function(e, t) {
            i.checkSupport("blob");
            try {
                return new Blob([e], {
                    type: t
                })
            } catch (n) {
                try {
                    var r = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder,
                        o = new r;
                    return o.append(e), o.getBlob(t)
                } catch (n) {
                    throw new Error("Bug : can't construct the Blob.")
                }
            }
        };
        var f = {
            stringifyByChunk: function(e, t, i) {
                var n = [],
                    r = 0,
                    o = e.length;
                if (i >= o) return String.fromCharCode.apply(null, e);
                for (; o > r;) "array" === t || "nodebuffer" === t ? n.push(String.fromCharCode.apply(null, e.slice(r, Math.min(r + i, o)))) : n.push(String.fromCharCode.apply(null, e.subarray(r, Math.min(r + i, o)))), r += i;
                return n.join("")
            },
            stringifyByChar: function(e) {
                for (var t = "", i = 0; i < e.length; i++) t += String.fromCharCode(e[i]);
                return t
            },
            applyCanBeUsed: {
                uint8array: function() {
                    try {
                        return l.uint8array && 1 === String.fromCharCode.apply(null, new Uint8Array(1)).length
                    } catch (e) {
                        return !1
                    }
                }(),
                nodebuffer: function() {
                    try {
                        return l.nodebuffer && 1 === String.fromCharCode.apply(null, u.newBuffer(1)).length
                    } catch (e) {
                        return !1
                    }
                }()
            }
        };
        i.applyFromCharCode = a;
        var p = {};
        p.string = {
            string: r,
            array: function(e) {
                return o(e, new Array(e.length))
            },
            arraybuffer: function(e) {
                return p.string.uint8array(e).buffer
            },
            uint8array: function(e) {
                return o(e, new Uint8Array(e.length))
            },
            nodebuffer: function(e) {
                return o(e, u.newBuffer(e.length))
            }
        }, p.array = {
            string: a,
            array: r,
            arraybuffer: function(e) {
                return new Uint8Array(e).buffer
            },
            uint8array: function(e) {
                return new Uint8Array(e)
            },
            nodebuffer: function(e) {
                return u.newBuffer(e)
            }
        }, p.arraybuffer = {
            string: function(e) {
                return a(new Uint8Array(e))
            },
            array: function(e) {
                return s(new Uint8Array(e), new Array(e.byteLength))
            },
            arraybuffer: r,
            uint8array: function(e) {
                return new Uint8Array(e)
            },
            nodebuffer: function(e) {
                return u.newBuffer(new Uint8Array(e))
            }
        }, p.uint8array = {
            string: a,
            array: function(e) {
                return s(e, new Array(e.length))
            },
            arraybuffer: function(e) {
                return e.buffer
            },
            uint8array: r,
            nodebuffer: function(e) {
                return u.newBuffer(e)
            }
        }, p.nodebuffer = {
            string: a,
            array: function(e) {
                return s(e, new Array(e.length))
            },
            arraybuffer: function(e) {
                return p.nodebuffer.uint8array(e).buffer
            },
            uint8array: function(e) {
                return s(e, new Uint8Array(e.length))
            },
            nodebuffer: r
        }, i.transformTo = function(e, t) {
            if (t || (t = ""), !e) return t;
            i.checkSupport(e);
            var n = i.getTypeOf(t),
                r = p[n][e](t);
            return r
        }, i.getTypeOf = function(e) {
            return "string" == typeof e ? "string" : "[object Array]" === Object.prototype.toString.call(e) ? "array" : l.nodebuffer && u.isBuffer(e) ? "nodebuffer" : l.uint8array && e instanceof Uint8Array ? "uint8array" : l.arraybuffer && e instanceof ArrayBuffer ? "arraybuffer" : void 0
        }, i.checkSupport = function(e) {
            var t = l[e.toLowerCase()];
            if (!t) throw new Error(e + " is not supported by this platform")
        }, i.MAX_VALUE_16BITS = 65535, i.MAX_VALUE_32BITS = -1, i.pretty = function(e) {
            var t, i, n = "";
            for (i = 0; i < (e || "").length; i++) t = e.charCodeAt(i), n += "\\x" + (16 > t ? "0" : "") + t.toString(16).toUpperCase();
            return n
        }, i.delay = function(e, t, i) {
            d(function() {
                e.apply(i || null, t || [])
            })
        }, i.inherits = function(e, t) {
            var i = function() {};
            i.prototype = t.prototype, e.prototype = new i
        }, i.extend = function() {
            var e, t, i = {};
            for (e = 0; e < arguments.length; e++)
                for (t in arguments[e]) arguments[e].hasOwnProperty(t) && "undefined" == typeof i[t] && (i[t] = arguments[e][t]);
            return i
        }, i.prepareContent = function(e, t, r, o, a) {
            var s = null;
            return s = l.blob && t instanceof Blob && "undefined" != typeof FileReader ? new c.Promise(function(e, i) {
                var n = new FileReader;
                n.onload = function(t) {
                    e(t.target.result)
                }, n.onerror = function(e) {
                    i(e.target.error)
                }, n.readAsArrayBuffer(t)
            }) : c.Promise.resolve(t), s.then(function(t) {
                var s = i.getTypeOf(t);
                return s ? ("arraybuffer" === s ? t = i.transformTo("uint8array", t) : "string" === s && (a ? t = h.decode(t) : r && o !== !0 && (t = n(t))), t) : c.Promise.reject(new Error("The data of '" + e + "' is in an unsupported format !"))
            })
        }
    }, {
        "./base64": 112,
        "./external": 117,
        "./nodejsUtils": 125,
        "./support": 140,
        asap: 1
    }],
    143: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.files = [], this.loadOptions = e
        }
        var r = e("./reader/readerFor"),
            o = e("./utils"),
            a = e("./signature"),
            s = e("./zipEntry"),
            l = (e("./utf8"), e("./support"));
        n.prototype = {
            checkSignature: function(e) {
                if (!this.reader.readAndCheckSignature(e)) {
                    this.reader.index -= 4;
                    var t = this.reader.readString(4);
                    throw new Error("Corrupted zip or bug : unexpected signature (" + o.pretty(t) + ", expected " + o.pretty(e) + ")")
                }
            },
            isSignature: function(e, t) {
                var i = this.reader.index;
                this.reader.setIndex(e);
                var n = this.reader.readString(4),
                    r = n === t;
                return this.reader.setIndex(i), r
            },
            readBlockEndOfCentral: function() {
                this.diskNumber = this.reader.readInt(2), this.diskWithCentralDirStart = this.reader.readInt(2), this.centralDirRecordsOnThisDisk = this.reader.readInt(2), this.centralDirRecords = this.reader.readInt(2), this.centralDirSize = this.reader.readInt(4), this.centralDirOffset = this.reader.readInt(4), this.zipCommentLength = this.reader.readInt(2);
                var e = this.reader.readData(this.zipCommentLength),
                    t = l.uint8array ? "uint8array" : "array",
                    i = o.transformTo(t, e);
                this.zipComment = this.loadOptions.decodeFileName(i)
            },
            readBlockZip64EndOfCentral: function() {
                this.zip64EndOfCentralSize = this.reader.readInt(8), this.reader.skip(4), this.diskNumber = this.reader.readInt(4), this.diskWithCentralDirStart = this.reader.readInt(4), this.centralDirRecordsOnThisDisk = this.reader.readInt(8), this.centralDirRecords = this.reader.readInt(8), this.centralDirSize = this.reader.readInt(8), this.centralDirOffset = this.reader.readInt(8), this.zip64ExtensibleData = {};
                for (var e, t, i, n = this.zip64EndOfCentralSize - 44, r = 0; n > r;) e = this.reader.readInt(2), t = this.reader.readInt(4), i = this.reader.readData(t), this.zip64ExtensibleData[e] = {
                    id: e,
                    length: t,
                    value: i
                }
            },
            readBlockZip64EndOfCentralLocator: function() {
                if (this.diskWithZip64CentralDirStart = this.reader.readInt(4), this.relativeOffsetEndOfZip64CentralDir = this.reader.readInt(8), this.disksCount = this.reader.readInt(4), this.disksCount > 1) throw new Error("Multi-volumes zip are not supported")
            },
            readLocalFiles: function() {
                var e, t;
                for (e = 0; e < this.files.length; e++) t = this.files[e], this.reader.setIndex(t.localHeaderOffset), this.checkSignature(a.LOCAL_FILE_HEADER), t.readLocalPart(this.reader), t.handleUTF8(), t.processAttributes()
            },
            readCentralDir: function() {
                var e;
                for (this.reader.setIndex(this.centralDirOffset); this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);) e = new s({
                    zip64: this.zip64
                }, this.loadOptions), e.readCentralPart(this.reader), this.files.push(e);
                if (this.centralDirRecords !== this.files.length && 0 !== this.centralDirRecords && 0 === this.files.length) throw new Error("Corrupted zip or bug: expected " + this.centralDirRecords + " records in central dir, got " + this.files.length)
            },
            readEndOfCentral: function() {
                var e = this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);
                if (0 > e) {
                    var t = !this.isSignature(0, a.LOCAL_FILE_HEADER);
                    throw t ? new Error("Can't find end of central directory : is this a zip file ? If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html") : new Error("Corrupted zip : can't find end of central directory")
                }
                this.reader.setIndex(e);
                var i = e;
                if (this.checkSignature(a.CENTRAL_DIRECTORY_END), this.readBlockEndOfCentral(), this.diskNumber === o.MAX_VALUE_16BITS || this.diskWithCentralDirStart === o.MAX_VALUE_16BITS || this.centralDirRecordsOnThisDisk === o.MAX_VALUE_16BITS || this.centralDirRecords === o.MAX_VALUE_16BITS || this.centralDirSize === o.MAX_VALUE_32BITS || this.centralDirOffset === o.MAX_VALUE_32BITS) {
                    if (this.zip64 = !0, e = this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR), 0 > e) throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");
                    if (this.reader.setIndex(e), this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),
                        this.readBlockZip64EndOfCentralLocator(), !this.isSignature(this.relativeOffsetEndOfZip64CentralDir, a.ZIP64_CENTRAL_DIRECTORY_END) && (this.relativeOffsetEndOfZip64CentralDir = this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END), this.relativeOffsetEndOfZip64CentralDir < 0)) throw new Error("Corrupted zip : can't find the ZIP64 end of central directory");
                    this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir), this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END), this.readBlockZip64EndOfCentral()
                }
                var n = this.centralDirOffset + this.centralDirSize;
                this.zip64 && (n += 20, n += 12 + this.zip64EndOfCentralSize);
                var r = i - n;
                if (r > 0) this.isSignature(i, a.CENTRAL_FILE_HEADER) || (this.reader.zero = r);
                else if (0 > r) throw new Error("Corrupted zip: missing " + Math.abs(r) + " bytes.")
            },
            prepareReader: function(e) {
                this.reader = r(e)
            },
            load: function(e) {
                this.prepareReader(e), this.readEndOfCentral(), this.readCentralDir(), this.readLocalFiles()
            }
        }, t.exports = n
    }, {
        "./reader/readerFor": 132,
        "./signature": 133,
        "./support": 140,
        "./utf8": 141,
        "./utils": 142,
        "./zipEntry": 144
    }],
    144: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.options = e, this.loadOptions = t
        }
        var r = e("./reader/readerFor"),
            o = e("./utils"),
            a = e("./compressedObject"),
            s = e("./crc32"),
            l = e("./utf8"),
            h = e("./compressions"),
            u = e("./support"),
            d = 0,
            c = 3,
            f = function(e) {
                for (var t in h)
                    if (h.hasOwnProperty(t) && h[t].magic === e) return h[t];
                return null
            };
        n.prototype = {
            isEncrypted: function() {
                return 1 === (1 & this.bitFlag)
            },
            useUTF8: function() {
                return 2048 === (2048 & this.bitFlag)
            },
            readLocalPart: function(e) {
                var t, i;
                if (e.skip(22), this.fileNameLength = e.readInt(2), i = e.readInt(2), this.fileName = e.readData(this.fileNameLength), e.skip(i), -1 === this.compressedSize || -1 === this.uncompressedSize) throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");
                if (t = f(this.compressionMethod), null === t) throw new Error("Corrupted zip : compression " + o.pretty(this.compressionMethod) + " unknown (inner file : " + o.transformTo("string", this.fileName) + ")");
                this.decompressed = new a(this.compressedSize, this.uncompressedSize, this.crc32, t, e.readData(this.compressedSize))
            },
            readCentralPart: function(e) {
                this.versionMadeBy = e.readInt(2), e.skip(2), this.bitFlag = e.readInt(2), this.compressionMethod = e.readString(2), this.date = e.readDate(), this.crc32 = e.readInt(4), this.compressedSize = e.readInt(4), this.uncompressedSize = e.readInt(4);
                var t = e.readInt(2);
                if (this.extraFieldsLength = e.readInt(2), this.fileCommentLength = e.readInt(2), this.diskNumberStart = e.readInt(2), this.internalFileAttributes = e.readInt(2), this.externalFileAttributes = e.readInt(4), this.localHeaderOffset = e.readInt(4), this.isEncrypted()) throw new Error("Encrypted zip are not supported");
                e.skip(t), this.readExtraFields(e), this.parseZIP64ExtraField(e), this.fileComment = e.readData(this.fileCommentLength)
            },
            processAttributes: function() {
                this.unixPermissions = null, this.dosPermissions = null;
                var e = this.versionMadeBy >> 8;
                this.dir = 16 & this.externalFileAttributes ? !0 : !1, e === d && (this.dosPermissions = 63 & this.externalFileAttributes), e === c && (this.unixPermissions = this.externalFileAttributes >> 16 & 65535), this.dir || "/" !== this.fileNameStr.slice(-1) || (this.dir = !0)
            },
            parseZIP64ExtraField: function(e) {
                if (this.extraFields[1]) {
                    var t = r(this.extraFields[1].value);
                    this.uncompressedSize === o.MAX_VALUE_32BITS && (this.uncompressedSize = t.readInt(8)), this.compressedSize === o.MAX_VALUE_32BITS && (this.compressedSize = t.readInt(8)), this.localHeaderOffset === o.MAX_VALUE_32BITS && (this.localHeaderOffset = t.readInt(8)), this.diskNumberStart === o.MAX_VALUE_32BITS && (this.diskNumberStart = t.readInt(4))
                }
            },
            readExtraFields: function(e) {
                var t, i, n, r = e.index + this.extraFieldsLength;
                for (this.extraFields || (this.extraFields = {}); e.index < r;) t = e.readInt(2), i = e.readInt(2), n = e.readData(i), this.extraFields[t] = {
                    id: t,
                    length: i,
                    value: n
                }
            },
            handleUTF8: function() {
                var e = u.uint8array ? "uint8array" : "array";
                if (this.useUTF8()) this.fileNameStr = l.utf8decode(this.fileName), this.fileCommentStr = l.utf8decode(this.fileComment);
                else {
                    var t = this.findExtraFieldUnicodePath();
                    if (null !== t) this.fileNameStr = t;
                    else {
                        var i = o.transformTo(e, this.fileName);
                        this.fileNameStr = this.loadOptions.decodeFileName(i)
                    }
                    var n = this.findExtraFieldUnicodeComment();
                    if (null !== n) this.fileCommentStr = n;
                    else {
                        var r = o.transformTo(e, this.fileComment);
                        this.fileCommentStr = this.loadOptions.decodeFileName(r)
                    }
                }
            },
            findExtraFieldUnicodePath: function() {
                var e = this.extraFields[28789];
                if (e) {
                    var t = r(e.value);
                    return 1 !== t.readInt(1) ? null : s(this.fileName) !== t.readInt(4) ? null : l.utf8decode(t.readData(e.length - 5))
                }
                return null
            },
            findExtraFieldUnicodeComment: function() {
                var e = this.extraFields[25461];
                if (e) {
                    var t = r(e.value);
                    return 1 !== t.readInt(1) ? null : s(this.fileComment) !== t.readInt(4) ? null : l.utf8decode(t.readData(e.length - 5))
                }
                return null
            }
        }, t.exports = n
    }, {
        "./compressedObject": 113,
        "./compressions": 114,
        "./crc32": 115,
        "./reader/readerFor": 132,
        "./support": 140,
        "./utf8": 141,
        "./utils": 142
    }],
    145: [function(e, t, i) {
        "use strict";
        var n = e("./stream/StreamHelper"),
            r = e("./stream/DataWorker"),
            o = e("./utf8"),
            a = e("./compressedObject"),
            s = e("./stream/GenericWorker"),
            l = function(e, t, i) {
                this.name = e, this.dir = i.dir, this.date = i.date, this.comment = i.comment, this.unixPermissions = i.unixPermissions, this.dosPermissions = i.dosPermissions, this._data = t, this._dataBinary = i.binary, this.options = {
                    compression: i.compression,
                    compressionOptions: i.compressionOptions
                }
            };
        l.prototype = {
            internalStream: function(e) {
                var t = e.toLowerCase(),
                    i = "string" === t || "text" === t;
                ("binarystring" === t || "text" === t) && (t = "string");
                var r = this._decompressWorker(),
                    a = !this._dataBinary;
                return a && !i && (r = r.pipe(new o.Utf8EncodeWorker)), !a && i && (r = r.pipe(new o.Utf8DecodeWorker)), new n(r, t, "")
            },
            async: function(e, t) {
                return this.internalStream(e).accumulate(t)
            },
            nodeStream: function(e, t) {
                return this.internalStream(e || "nodebuffer").toNodejsStream(t)
            },
            _compressWorker: function(e, t) {
                if (this._data instanceof a && this._data.compression.magic === e.magic) return this._data.getCompressedWorker();
                var i = this._decompressWorker();
                return this._dataBinary || (i = i.pipe(new o.Utf8EncodeWorker)), a.createWorkerFrom(i, e, t)
            },
            _decompressWorker: function() {
                return this._data instanceof a ? this._data.getContentWorker() : this._data instanceof s ? this._data : new r(this._data)
            }
        };
        for (var h = ["asText", "asBinary", "asNodeBuffer", "asUint8Array", "asArrayBuffer"], u = function() {
                throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")
            }, d = 0; d < h.length; d++) l.prototype[h[d]] = u;
        t.exports = l
    }, {
        "./compressedObject": 113,
        "./stream/DataWorker": 137,
        "./stream/GenericWorker": 138,
        "./stream/StreamHelper": 139,
        "./utf8": 141
    }],
    146: [function(e, t, i) {
        ! function() {
            "use strict";

            function e(t) {
                return this instanceof e ? (this._canvas = t = "string" == typeof t ? document.getElementById(t) : t, this._ctx = t.getContext("2d"), this._width = t.width, this._height = t.height, this._max = 1, void this.clear()) : new e(t)
            }
            e.prototype = {
                defaultRadius: 25,
                defaultGradient: {
                    .4: "blue",
                    .6: "cyan",
                    .7: "lime",
                    .8: "yellow",
                    1: "red"
                },
                data: function(e) {
                    return this._data = e, this
                },
                max: function(e) {
                    return this._max = e, this
                },
                add: function(e) {
                    return this._data.push(e), this
                },
                clear: function() {
                    return this._data = [], this
                },
                radius: function(e, t) {
                    t = t || 15;
                    var i = this._circle = document.createElement("canvas"),
                        n = i.getContext("2d"),
                        r = this._r = e + t;
                    return i.width = i.height = 2 * r, n.shadowOffsetX = n.shadowOffsetY = 200, n.shadowBlur = t, n.shadowColor = "black", n.beginPath(), n.arc(r - 200, r - 200, e, 0, 2 * Math.PI, !0), n.closePath(), n.fill(), this
                },
                gradient: function(e) {
                    var t = document.createElement("canvas"),
                        i = t.getContext("2d"),
                        n = i.createLinearGradient(0, 0, 0, 256);
                    t.width = 1, t.height = 256;
                    for (var r in e) n.addColorStop(r, e[r]);
                    return i.fillStyle = n, i.fillRect(0, 0, 1, 256), this._grad = i.getImageData(0, 0, 1, 256).data, this
                },
                draw: function(e) {
                    this._circle || this.radius(this.defaultRadius), this._grad || this.gradient(this.defaultGradient);
                    var t = this._ctx;
                    t.clearRect(0, 0, this._width, this._height);
                    for (var i, n = 0, r = this._data.length; r > n; n++) i = this._data[n], t.globalAlpha = Math.max(i[2] / this._max, e || .05), t.drawImage(this._circle, i[0] - this._r, i[1] - this._r);
                    var o = t.getImageData(0, 0, this._width, this._height);
                    return this._colorize(o.data, this._grad), t.putImageData(o, 0, 0), this
                },
                _colorize: function(e, t) {
                    for (var i, n = 3, r = e.length; r > n; n += 4) i = 4 * e[n], i && (e[n - 3] = t[i], e[n - 2] = t[i + 1], e[n - 1] = t[i + 2])
                }
            }, window.simpleheat = e
        }(), L.HeatLayer = (L.Layer ? L.Layer : L.Class).extend({
            initialize: function(e, t) {
                this._latlngs = e, L.setOptions(this, t)
            },
            setLatLngs: function(e) {
                return this._latlngs = e, this.redraw()
            },
            addLatLng: function(e) {
                return this._latlngs.push(e), this.redraw()
            },
            setOptions: function(e) {
                return L.setOptions(this, e), this._heat && this._updateOptions(), this.redraw()
            },
            redraw: function() {
                return !this._heat || this._frame || this._map._animating || (this._frame = L.Util.requestAnimFrame(this._redraw, this)), this
            },
            onAdd: function(e) {
                this._map = e, this._canvas || this._initCanvas(), e._panes.overlayPane.appendChild(this._canvas), e.on("moveend", this._reset, this), e.options.zoomAnimation && L.Browser.any3d && e.on("zoomanim", this._animateZoom, this), this._reset()
            },
            onRemove: function(e) {
                e.getPanes().overlayPane.removeChild(this._canvas), e.off("moveend", this._reset, this), e.options.zoomAnimation && e.off("zoomanim", this._animateZoom, this)
            },
            addTo: function(e) {
                return e.addLayer(this), this
            },
            _initCanvas: function() {
                var e = this._canvas = L.DomUtil.create("canvas", "leaflet-heatmap-layer leaflet-layer"),
                    t = this._map.getSize();
                e.width = t.x, e.height = t.y;
                var i = this._map.options.zoomAnimation && L.Browser.any3d;
                L.DomUtil.addClass(e, "leaflet-zoom-" + (i ? "animated" : "hide")), this._heat = simpleheat(e), this._updateOptions()
            },
            _updateOptions: function() {
                this._heat.radius(this.options.radius || this._heat.defaultRadius, this.options.blur), this.options.gradient && this._heat.gradient(this.options.gradient), this.options.max && this._heat.max(this.options.max)
            },
            _reset: function() {
                var e = this._map.containerPointToLayerPoint([0, 0]);
                L.DomUtil.setPosition(this._canvas, e);
                var t = this._map.getSize();
                this._heat._width !== t.x && (this._canvas.width = this._heat._width = t.x), this._heat._height !== t.y && (this._canvas.height = this._heat._height = t.y), this._redraw()
            },
            _redraw: function() {
                var e, t, i, n, r, o, a, s, l, h = [],
                    u = this._heat._r,
                    d = this._map.getSize(),
                    c = new L.LatLngBounds(this._map.containerPointToLatLng(L.point([-u, -u])), this._map.containerPointToLatLng(d.add([u, u]))),
                    f = void 0 === this.options.maxZoom ? this._map.getMaxZoom() : this.options.maxZoom,
                    p = 1 / Math.pow(2, Math.max(0, Math.min(f - this._map.getZoom(), 12))),
                    m = u / 2,
                    g = [],
                    _ = this._map._getMapPanePos(),
                    v = _.x % m,
                    y = _.y % m;
                for (e = 0, t = this._latlngs.length; t > e; e++)
                    if (c.contains(this._latlngs[e])) {
                        i = this._map.latLngToContainerPoint(this._latlngs[e]), r = Math.floor((i.x - v) / m) + 2, o = Math.floor((i.y - y) / m) + 2;
                        var b = void 0 !== this._latlngs[e].alt ? this._latlngs[e].alt : void 0 !== this._latlngs[e][2] ? +this._latlngs[e][2] : 1;
                        l = b * p, g[o] = g[o] || [], n = g[o][r], n ? (n[0] = (n[0] * n[2] + i.x * l) / (n[2] + l), n[1] = (n[1] * n[2] + i.y * l) / (n[2] + l), n[2] += l) : g[o][r] = [i.x, i.y, l]
                    }
                for (e = 0, t = g.length; t > e; e++)
                    if (g[e])
                        for (a = 0, s = g[e].length; s > a; a++) n = g[e][a], n && h.push([Math.round(n[0]), Math.round(n[1]), Math.min(n[2], 1)]);
                this._heat.data(h).draw(this.options.minOpacity), this._frame = null
            },
            _animateZoom: function(e) {
                var t = this._map.getZoomScale(e.zoom),
                    i = this._map._getCenterOffset(e.center)._multiplyBy(-t).subtract(this._map._getMapPanePos());
                L.DomUtil.setTransform ? L.DomUtil.setTransform(this._canvas, i, t) : this._canvas.style[L.DomUtil.TRANSFORM] = L.DomUtil.getTranslateString(i) + " scale(" + t + ")"
            }
        }), L.heatLayer = function(e, t) {
            return new L.HeatLayer(e, t)
        }
    }, {}],
    147: [function(e, t, i) {
        function n(e) {
            return e * c
        }

        function r(e) {
            return e *= c, 2 * Math.atan(Math.exp(e * p)) * m - 90
        }

        function o(e) {
            return e * f
        }

        function a(e) {
            return e = Math.log(Math.tan((90 + e) * p / 2)) * m, e = Math.max(-d, Math.min(d, e)), e * f
        }

        function s(e) {
            return {
                lon: o(e.lon),
                lat: a(e.lat)
            }
        }

        function l(e) {
            return {
                lon: n(e.lon),
                lat: r(e.lat)
            }
        }

        function h(e, t) {
            var i = u.decode(e),
                n = {
                    lat: i.latitude[2],
                    lon: i.longitude[2]
                };
            return t && (n = t(n)), n
        }
        var u = e("geohash"),
            d = 20037508.34,
            c = 180 / d,
            f = d / 180,
            p = Math.PI / 180,
            m = 180 / Math.PI;
        t.exports = {
            MAX_EXTENT: d,
            convertLon900913To4326: n,
            convertLat900913To4326: r,
            convertLon4326To900913: o,
            convertLat4326To900913: a,
            convert4326to900913: s,
            convert900913to4326: l,
            geoHashToLonLat: h
        }
    }, {
        geohash: 104
    }],
    148: [function(e, t, i) {
        ! function(n, r) {
            "object" == typeof i && "undefined" != typeof t && "function" == typeof e ? r(e("../moment")) : "function" == typeof define && define.amd ? define(["../moment"], r) : r(n.moment)
        }(this, function(e) {
            "use strict";
            var t = e.defineLocale("fr", {
                months: "janvier_fÃ©vrier_mars_avril_mai_juin_juillet_aoÃ»t_septembre_octobre_novembre_dÃ©cembre".split("_"),
                monthsShort: "janv._fÃ©vr._mars_avr._mai_juin_juil._aoÃ»t_sept._oct._nov._dÃ©c.".split("_"),
                monthsParseExact: !0,
                weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),
                weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"),
                weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),
                weekdaysParseExact: !0,
                longDateFormat: {
                    LT: "HH:mm",
                    LTS: "HH:mm:ss",
                    L: "DD/MM/YYYY",
                    LL: "D MMMM YYYY",
                    LLL: "D MMMM YYYY HH:mm",
                    LLLL: "dddd D MMMM YYYY HH:mm"
                },
                calendar: {
                    sameDay: "[Aujourd'hui Ã ] LT",
                    nextDay: "[Demain Ã ] LT",
                    nextWeek: "dddd [Ã ] LT",
                    lastDay: "[Hier Ã ] LT",
                    lastWeek: "dddd [dernier Ã ] LT",
                    sameElse: "L"
                },
                relativeTime: {
                    future: "dans %s",
                    past: "il y a %s",
                    s: "quelques secondes",
                    m: "une minute",
                    mm: "%d minutes",
                    h: "une heure",
                    hh: "%d heures",
                    d: "un jour",
                    dd: "%d jours",
                    M: "un mois",
                    MM: "%d mois",
                    y: "un an",
                    yy: "%d ans"
                },
                ordinalParse: /\d{1,2}(er|)/,
                ordinal: function(e) {
                    return e + (1 === e ? "er" : "")
                },
                week: {
                    dow: 1,
                    doy: 4
                }
            });
            return t
        })
    }, {
        "../moment": 149
    }],
    149: [function(e, t, i) {
        ! function(e, n) {
            "object" == typeof i && "undefined" != typeof t ? t.exports = n() : "function" == typeof define && define.amd ? define(n) : e.moment = n()
        }(this, function() {
            "use strict";

            function i() {
                return _n.apply(null, arguments)
            }

            function n(e) {
                _n = e
            }

            function r(e) {
                return e instanceof Array || "[object Array]" === Object.prototype.toString.call(e)
            }

            function o(e) {
                return null != e && "[object Object]" === Object.prototype.toString.call(e)
            }

            function a(e) {
                var t;
                for (t in e) return !1;
                return !0
            }

            function s(e) {
                return "number" == typeof e || "[object Number]" === Object.prototype.toString.call(e)
            }

            function l(e) {
                return e instanceof Date || "[object Date]" === Object.prototype.toString.call(e)
            }

            function h(e, t) {
                var i, n = [];
                for (i = 0; i < e.length; ++i) n.push(t(e[i], i));
                return n
            }

            function u(e, t) {
                return Object.prototype.hasOwnProperty.call(e, t)
            }

            function d(e, t) {
                for (var i in t) u(t, i) && (e[i] = t[i]);
                return u(t, "toString") && (e.toString = t.toString), u(t, "valueOf") && (e.valueOf = t.valueOf), e
            }

            function c(e, t, i, n) {
                return yt(e, t, i, n, !0).utc()
            }

            function f() {
                return {
                    empty: !1,
                    unusedTokens: [],
                    unusedInput: [],
                    overflow: -2,
                    charsLeftOver: 0,
                    nullInput: !1,
                    invalidMonth: null,
                    invalidFormat: !1,
                    userInvalidated: !1,
                    iso: !1,
                    parsedDateParts: [],
                    meridiem: null
                }
            }

            function p(e) {
                return null == e._pf && (e._pf = f()), e._pf
            }

            function m(e) {
                if (null == e._isValid) {
                    var t = p(e),
                        i = yn.call(t.parsedDateParts, function(e) {
                            return null != e
                        }),
                        n = !isNaN(e._d.getTime()) && t.overflow < 0 && !t.empty && !t.invalidMonth && !t.invalidWeekday && !t.nullInput && !t.invalidFormat && !t.userInvalidated && (!t.meridiem || t.meridiem && i);
                    if (e._strict && (n = n && 0 === t.charsLeftOver && 0 === t.unusedTokens.length && void 0 === t.bigHour), null != Object.isFrozen && Object.isFrozen(e)) return n;
                    e._isValid = n
                }
                return e._isValid
            }

            function g(e) {
                var t = c(NaN);
                return null != e ? d(p(t), e) : p(t).userInvalidated = !0, t
            }

            function _(e) {
                return void 0 === e
            }

            function v(e, t) {
                var i, n, r;
                if (_(t._isAMomentObject) || (e._isAMomentObject = t._isAMomentObject), _(t._i) || (e._i = t._i), _(t._f) || (e._f = t._f), _(t._l) || (e._l = t._l), _(t._strict) || (e._strict = t._strict), _(t._tzm) || (e._tzm = t._tzm), _(t._isUTC) || (e._isUTC = t._isUTC), _(t._offset) || (e._offset = t._offset), _(t._pf) || (e._pf = p(t)), _(t._locale) || (e._locale = t._locale), bn.length > 0)
                    for (i in bn) n = bn[i], r = t[n], _(r) || (e[n] = r);
                return e
            }

            function y(e) {
                v(this, e), this._d = new Date(null != e._d ? e._d.getTime() : NaN), this.isValid() || (this._d = new Date(NaN)), xn === !1 && (xn = !0, i.updateOffset(this), xn = !1)
            }

            function b(e) {
                return e instanceof y || null != e && null != e._isAMomentObject
            }

            function x(e) {
                return 0 > e ? Math.ceil(e) || 0 : Math.floor(e)
            }

            function w(e) {
                var t = +e,
                    i = 0;
                return 0 !== t && isFinite(t) && (i = x(t)), i
            }

            function M(e, t, i) {
                var n, r = Math.min(e.length, t.length),
                    o = Math.abs(e.length - t.length),
                    a = 0;
                for (n = 0; r > n; n++)(i && e[n] !== t[n] || !i && w(e[n]) !== w(t[n])) && a++;
                return a + o
            }

            function T(e) {
                i.suppressDeprecationWarnings === !1 && "undefined" != typeof console && console.warn && console.warn("Deprecation warning: " + e)
            }

            function S(e, t) {
                var n = !0;
                return d(function() {
                    if (null != i.deprecationHandler && i.deprecationHandler(null, e), n) {
                        for (var r, o = [], a = 0; a < arguments.length; a++) {
                            if (r = "", "object" == typeof arguments[a]) {
                                r += "\n[" + a + "] ";
                                for (var s in arguments[0]) r += s + ": " + arguments[0][s] + ", ";
                                r = r.slice(0, -2)
                            } else r = arguments[a];
                            o.push(r)
                        }
                        T(e + "\nArguments: " + Array.prototype.slice.call(o).join("") + "\n" + (new Error).stack), n = !1
                    }
                    return t.apply(this, arguments)
                }, t)
            }

            function C(e, t) {
                null != i.deprecationHandler && i.deprecationHandler(e, t), wn[e] || (T(t), wn[e] = !0)
            }

            function E(e) {
                return e instanceof Function || "[object Function]" === Object.prototype.toString.call(e)
            }

            function k(e) {
                var t, i;
                for (i in e) t = e[i], E(t) ? this[i] = t : this["_" + i] = t;
                this._config = e, this._ordinalParseLenient = new RegExp(this._ordinalParse.source + "|" + /\d{1,2}/.source)
            }

            function L(e, t) {
                var i, n = d({}, e);
                for (i in t) u(t, i) && (o(e[i]) && o(t[i]) ? (n[i] = {}, d(n[i], e[i]), d(n[i], t[i])) : null != t[i] ? n[i] = t[i] : delete n[i]);
                for (i in e) u(e, i) && !u(t, i) && o(e[i]) && (n[i] = d({}, n[i]));
                return n
            }

            function P(e) {
                null != e && this.set(e)
            }

            function A(e, t, i) {
                var n = this._calendar[e] || this._calendar.sameElse;
                return E(n) ? n.call(t, i) : n
            }

            function R(e) {
                var t = this._longDateFormat[e],
                    i = this._longDateFormat[e.toUpperCase()];
                return t || !i ? t : (this._longDateFormat[e] = i.replace(/MMMM|MM|DD|dddd/g, function(e) {
                    return e.slice(1)
                }), this._longDateFormat[e])
            }

            function D() {
                return this._invalidDate
            }

            function I(e) {
                return this._ordinal.replace("%d", e)
            }

            function O(e, t, i, n) {
                var r = this._relativeTime[i];
                return E(r) ? r(e, t, i, n) : r.replace(/%d/i, e)
            }

            function N(e, t) {
                var i = this._relativeTime[e > 0 ? "future" : "past"];
                return E(i) ? i(t) : i.replace(/%s/i, t)
            }

            function B(e, t) {
                var i = e.toLowerCase();
                Rn[i] = Rn[i + "s"] = Rn[t] = e
            }

            function F(e) {
                return "string" == typeof e ? Rn[e] || Rn[e.toLowerCase()] : void 0
            }

            function z(e) {
                var t, i, n = {};
                for (i in e) u(e, i) && (t = F(i), t && (n[t] = e[i]));
                return n
            }

            function H(e, t) {
                Dn[e] = t
            }

            function U(e) {
                var t = [];
                for (var i in e) t.push({
                    unit: i,
                    priority: Dn[i]
                });
                return t.sort(function(e, t) {
                    return e.priority - t.priority
                }), t
            }

            function W(e, t) {
                return function(n) {
                    return null != n ? (j(this, e, n), i.updateOffset(this, t), this) : G(this, e)
                }
            }

            function G(e, t) {
                return e.isValid() ? e._d["get" + (e._isUTC ? "UTC" : "") + t]() : NaN
            }

            function j(e, t, i) {
                e.isValid() && e._d["set" + (e._isUTC ? "UTC" : "") + t](i)
            }

            function q(e) {
                return e = F(e), E(this[e]) ? this[e]() : this
            }

            function V(e, t) {
                if ("object" == typeof e) {
                    e = z(e);
                    for (var i = U(e), n = 0; n < i.length; n++) this[i[n].unit](e[i[n].unit])
                } else if (e = F(e), E(this[e])) return this[e](t);
                return this
            }

            function Z(e, t, i) {
                var n = "" + Math.abs(e),
                    r = t - n.length,
                    o = e >= 0;
                return (o ? i ? "+" : "" : "-") + Math.pow(10, Math.max(0, r)).toString().substr(1) + n
            }

            function Y(e, t, i, n) {
                var r = n;
                "string" == typeof n && (r = function() {
                    return this[n]()
                }), e && (Bn[e] = r), t && (Bn[t[0]] = function() {
                    return Z(r.apply(this, arguments), t[1], t[2])
                }), i && (Bn[i] = function() {
                    return this.localeData().ordinal(r.apply(this, arguments), e)
                })
            }

            function K(e) {
                return e.match(/\[[\s\S]/) ? e.replace(/^\[|\]$/g, "") : e.replace(/\\/g, "")
            }

            function X(e) {
                var t, i, n = e.match(In);
                for (t = 0, i = n.length; i > t; t++) Bn[n[t]] ? n[t] = Bn[n[t]] : n[t] = K(n[t]);
                return function(t) {
                    var r, o = "";
                    for (r = 0; i > r; r++) o += n[r] instanceof Function ? n[r].call(t, e) : n[r];
                    return o
                }
            }

            function $(e, t) {
                return e.isValid() ? (t = Q(t, e.localeData()), Nn[t] = Nn[t] || X(t), Nn[t](e)) : e.localeData().invalidDate()
            }

            function Q(e, t) {
                function i(e) {
                    return t.longDateFormat(e) || e
                }
                var n = 5;
                for (On.lastIndex = 0; n >= 0 && On.test(e);) e = e.replace(On, i), On.lastIndex = 0, n -= 1;
                return e
            }

            function J(e, t, i) {
                tr[e] = E(t) ? t : function(e, n) {
                    return e && i ? i : t
                }
            }

            function ee(e, t) {
                return u(tr, e) ? tr[e](t._strict, t._locale) : new RegExp(te(e))
            }

            function te(e) {
                return ie(e.replace("\\", "").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function(e, t, i, n, r) {
                    return t || i || n || r
                }))
            }

            function ie(e) {
                return e.replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&")
            }

            function ne(e, t) {
                var i, n = t;
                for ("string" == typeof e && (e = [e]), s(t) && (n = function(e, i) {
                        i[t] = w(e)
                    }), i = 0; i < e.length; i++) ir[e[i]] = n
            }

            function re(e, t) {
                ne(e, function(e, i, n, r) {
                    n._w = n._w || {}, t(e, n._w, n, r)
                })
            }

            function oe(e, t, i) {
                null != t && u(ir, e) && ir[e](t, i._a, i, e)
            }

            function ae(e, t) {
                return new Date(Date.UTC(e, t + 1, 0)).getUTCDate()
            }

            function se(e, t) {
                return e ? r(this._months) ? this._months[e.month()] : this._months[(this._months.isFormat || fr).test(t) ? "format" : "standalone"][e.month()] : this._months
            }

            function le(e, t) {
                return e ? r(this._monthsShort) ? this._monthsShort[e.month()] : this._monthsShort[fr.test(t) ? "format" : "standalone"][e.month()] : this._monthsShort
            }

            function he(e, t, i) {
                var n, r, o, a = e.toLocaleLowerCase();
                if (!this._monthsParse)
                    for (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = [], n = 0; 12 > n; ++n) o = c([2e3, n]), this._shortMonthsParse[n] = this.monthsShort(o, "").toLocaleLowerCase(), this._longMonthsParse[n] = this.months(o, "").toLocaleLowerCase();
                return i ? "MMM" === t ? (r = cr.call(this._shortMonthsParse, a), -1 !== r ? r : null) : (r = cr.call(this._longMonthsParse, a), -1 !== r ? r : null) : "MMM" === t ? (r = cr.call(this._shortMonthsParse, a), -1 !== r ? r : (r = cr.call(this._longMonthsParse, a), -1 !== r ? r : null)) : (r = cr.call(this._longMonthsParse, a), -1 !== r ? r : (r = cr.call(this._shortMonthsParse, a), -1 !== r ? r : null))
            }

            function ue(e, t, i) {
                var n, r, o;
                if (this._monthsParseExact) return he.call(this, e, t, i);
                for (this._monthsParse || (this._monthsParse = [], this._longMonthsParse = [], this._shortMonthsParse = []), n = 0; 12 > n; n++) {
                    if (r = c([2e3, n]), i && !this._longMonthsParse[n] && (this._longMonthsParse[n] = new RegExp("^" + this.months(r, "").replace(".", "") + "$", "i"), this._shortMonthsParse[n] = new RegExp("^" + this.monthsShort(r, "").replace(".", "") + "$", "i")), i || this._monthsParse[n] || (o = "^" + this.months(r, "") + "|^" + this.monthsShort(r, ""), this._monthsParse[n] = new RegExp(o.replace(".", ""), "i")), i && "MMMM" === t && this._longMonthsParse[n].test(e)) return n;
                    if (i && "MMM" === t && this._shortMonthsParse[n].test(e)) return n;
                    if (!i && this._monthsParse[n].test(e)) return n
                }
            }

            function de(e, t) {
                var i;
                if (!e.isValid()) return e;
                if ("string" == typeof t)
                    if (/^\d+$/.test(t)) t = w(t);
                    else if (t = e.localeData().monthsParse(t), !s(t)) return e;
                return i = Math.min(e.date(), ae(e.year(), t)), e._d["set" + (e._isUTC ? "UTC" : "") + "Month"](t, i), e
            }

            function ce(e) {
                return null != e ? (de(this, e), i.updateOffset(this, !0), this) : G(this, "Month")
            }

            function fe() {
                return ae(this.year(), this.month())
            }

            function pe(e) {
                return this._monthsParseExact ? (u(this, "_monthsRegex") || ge.call(this), e ? this._monthsShortStrictRegex : this._monthsShortRegex) : (u(this, "_monthsShortRegex") || (this._monthsShortRegex = gr), this._monthsShortStrictRegex && e ? this._monthsShortStrictRegex : this._monthsShortRegex)
            }

            function me(e) {
                return this._monthsParseExact ? (u(this, "_monthsRegex") || ge.call(this), e ? this._monthsStrictRegex : this._monthsRegex) : (u(this, "_monthsRegex") || (this._monthsRegex = _r), this._monthsStrictRegex && e ? this._monthsStrictRegex : this._monthsRegex)
            }

            function ge() {
                function e(e, t) {
                    return t.length - e.length
                }
                var t, i, n = [],
                    r = [],
                    o = [];
                for (t = 0; 12 > t; t++) i = c([2e3, t]), n.push(this.monthsShort(i, "")), r.push(this.months(i, "")), o.push(this.months(i, "")), o.push(this.monthsShort(i, ""));
                for (n.sort(e), r.sort(e), o.sort(e), t = 0; 12 > t; t++) n[t] = ie(n[t]), r[t] = ie(r[t]);
                for (t = 0; 24 > t; t++) o[t] = ie(o[t]);
                this._monthsRegex = new RegExp("^(" + o.join("|") + ")", "i"), this._monthsShortRegex = this._monthsRegex, this._monthsStrictRegex = new RegExp("^(" + r.join("|") + ")", "i"), this._monthsShortStrictRegex = new RegExp("^(" + n.join("|") + ")", "i")
            }

            function _e(e) {
                return ve(e) ? 366 : 365
            }

            function ve(e) {
                return e % 4 === 0 && e % 100 !== 0 || e % 400 === 0
            }

            function ye() {
                return ve(this.year())
            }

            function be(e, t, i, n, r, o, a) {
                var s = new Date(e, t, i, n, r, o, a);
                return 100 > e && e >= 0 && isFinite(s.getFullYear()) && s.setFullYear(e), s
            }

            function xe(e) {
                var t = new Date(Date.UTC.apply(null, arguments));
                return 100 > e && e >= 0 && isFinite(t.getUTCFullYear()) && t.setUTCFullYear(e), t
            }

            function we(e, t, i) {
                var n = 7 + t - i,
                    r = (7 + xe(e, 0, n).getUTCDay() - t) % 7;
                return -r + n - 1
            }

            function Me(e, t, i, n, r) {
                var o, a, s = (7 + i - n) % 7,
                    l = we(e, n, r),
                    h = 1 + 7 * (t - 1) + s + l;
                return 0 >= h ? (o = e - 1, a = _e(o) + h) : h > _e(e) ? (o = e + 1, a = h - _e(e)) : (o = e, a = h), {
                    year: o,
                    dayOfYear: a
                }
            }

            function Te(e, t, i) {
                var n, r, o = we(e.year(), t, i),
                    a = Math.floor((e.dayOfYear() - o - 1) / 7) + 1;
                return 1 > a ? (r = e.year() - 1, n = a + Se(r, t, i)) : a > Se(e.year(), t, i) ? (n = a - Se(e.year(), t, i), r = e.year() + 1) : (r = e.year(), n = a), {
                    week: n,
                    year: r
                }
            }

            function Se(e, t, i) {
                var n = we(e, t, i),
                    r = we(e + 1, t, i);
                return (_e(e) - n + r) / 7
            }

            function Ce(e) {
                return Te(e, this._week.dow, this._week.doy).week
            }

            function Ee() {
                return this._week.dow
            }

            function ke() {
                return this._week.doy
            }

            function Le(e) {
                var t = this.localeData().week(this);
                return null == e ? t : this.add(7 * (e - t), "d")
            }

            function Pe(e) {
                var t = Te(this, 1, 4).week;
                return null == e ? t : this.add(7 * (e - t), "d")
            }

            function Ae(e, t) {
                return "string" != typeof e ? e : isNaN(e) ? (e = t.weekdaysParse(e), "number" == typeof e ? e : null) : parseInt(e, 10)
            }

            function Re(e, t) {
                return "string" == typeof e ? t.weekdaysParse(e) % 7 || 7 : isNaN(e) ? null : e
            }

            function De(e, t) {
                return e ? r(this._weekdays) ? this._weekdays[e.day()] : this._weekdays[this._weekdays.isFormat.test(t) ? "format" : "standalone"][e.day()] : this._weekdays
            }

            function Ie(e) {
                return e ? this._weekdaysShort[e.day()] : this._weekdaysShort
            }

            function Oe(e) {
                return e ? this._weekdaysMin[e.day()] : this._weekdaysMin
            }

            function Ne(e, t, i) {
                var n, r, o, a = e.toLocaleLowerCase();
                if (!this._weekdaysParse)
                    for (this._weekdaysParse = [], this._shortWeekdaysParse = [], this._minWeekdaysParse = [], n = 0; 7 > n; ++n) o = c([2e3, 1]).day(n), this._minWeekdaysParse[n] = this.weekdaysMin(o, "").toLocaleLowerCase(), this._shortWeekdaysParse[n] = this.weekdaysShort(o, "").toLocaleLowerCase(), this._weekdaysParse[n] = this.weekdays(o, "").toLocaleLowerCase();
                return i ? "dddd" === t ? (r = cr.call(this._weekdaysParse, a), -1 !== r ? r : null) : "ddd" === t ? (r = cr.call(this._shortWeekdaysParse, a), -1 !== r ? r : null) : (r = cr.call(this._minWeekdaysParse, a), -1 !== r ? r : null) : "dddd" === t ? (r = cr.call(this._weekdaysParse, a), -1 !== r ? r : (r = cr.call(this._shortWeekdaysParse, a), -1 !== r ? r : (r = cr.call(this._minWeekdaysParse, a), -1 !== r ? r : null))) : "ddd" === t ? (r = cr.call(this._shortWeekdaysParse, a), -1 !== r ? r : (r = cr.call(this._weekdaysParse, a), -1 !== r ? r : (r = cr.call(this._minWeekdaysParse, a), -1 !== r ? r : null))) : (r = cr.call(this._minWeekdaysParse, a), -1 !== r ? r : (r = cr.call(this._weekdaysParse, a), -1 !== r ? r : (r = cr.call(this._shortWeekdaysParse, a), -1 !== r ? r : null)))
            }

            function Be(e, t, i) {
                var n, r, o;
                if (this._weekdaysParseExact) return Ne.call(this, e, t, i);
                for (this._weekdaysParse || (this._weekdaysParse = [], this._minWeekdaysParse = [], this._shortWeekdaysParse = [], this._fullWeekdaysParse = []), n = 0; 7 > n; n++) {
                    if (r = c([2e3, 1]).day(n), i && !this._fullWeekdaysParse[n] && (this._fullWeekdaysParse[n] = new RegExp("^" + this.weekdays(r, "").replace(".", ".?") + "$", "i"), this._shortWeekdaysParse[n] = new RegExp("^" + this.weekdaysShort(r, "").replace(".", ".?") + "$", "i"), this._minWeekdaysParse[n] = new RegExp("^" + this.weekdaysMin(r, "").replace(".", ".?") + "$", "i")), this._weekdaysParse[n] || (o = "^" + this.weekdays(r, "") + "|^" + this.weekdaysShort(r, "") + "|^" + this.weekdaysMin(r, ""), this._weekdaysParse[n] = new RegExp(o.replace(".", ""), "i")), i && "dddd" === t && this._fullWeekdaysParse[n].test(e)) return n;
                    if (i && "ddd" === t && this._shortWeekdaysParse[n].test(e)) return n;
                    if (i && "dd" === t && this._minWeekdaysParse[n].test(e)) return n;
                    if (!i && this._weekdaysParse[n].test(e)) return n
                }
            }

            function Fe(e) {
                if (!this.isValid()) return null != e ? this : NaN;
                var t = this._isUTC ? this._d.getUTCDay() : this._d.getDay();
                return null != e ? (e = Ae(e, this.localeData()), this.add(e - t, "d")) : t
            }

            function ze(e) {
                if (!this.isValid()) return null != e ? this : NaN;
                var t = (this.day() + 7 - this.localeData()._week.dow) % 7;
                return null == e ? t : this.add(e - t, "d")
            }

            function He(e) {
                if (!this.isValid()) return null != e ? this : NaN;
                if (null != e) {
                    var t = Re(e, this.localeData());
                    return this.day(this.day() % 7 ? t : t - 7)
                }
                return this.day() || 7
            }

            function Ue(e) {
                return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || je.call(this), e ? this._weekdaysStrictRegex : this._weekdaysRegex) : (u(this, "_weekdaysRegex") || (this._weekdaysRegex = Mr), this._weekdaysStrictRegex && e ? this._weekdaysStrictRegex : this._weekdaysRegex)
            }

            function We(e) {
                return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || je.call(this), e ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex) : (u(this, "_weekdaysShortRegex") || (this._weekdaysShortRegex = Tr), this._weekdaysShortStrictRegex && e ? this._weekdaysShortStrictRegex : this._weekdaysShortRegex)
            }

            function Ge(e) {
                return this._weekdaysParseExact ? (u(this, "_weekdaysRegex") || je.call(this), e ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex) : (u(this, "_weekdaysMinRegex") || (this._weekdaysMinRegex = Sr), this._weekdaysMinStrictRegex && e ? this._weekdaysMinStrictRegex : this._weekdaysMinRegex)
            }

            function je() {
                function e(e, t) {
                    return t.length - e.length
                }
                var t, i, n, r, o, a = [],
                    s = [],
                    l = [],
                    h = [];
                for (t = 0; 7 > t; t++) i = c([2e3, 1]).day(t), n = this.weekdaysMin(i, ""), r = this.weekdaysShort(i, ""), o = this.weekdays(i, ""), a.push(n), s.push(r), l.push(o), h.push(n), h.push(r), h.push(o);
                for (a.sort(e), s.sort(e), l.sort(e), h.sort(e), t = 0; 7 > t; t++) s[t] = ie(s[t]), l[t] = ie(l[t]), h[t] = ie(h[t]);
                this._weekdaysRegex = new RegExp("^(" + h.join("|") + ")", "i"), this._weekdaysShortRegex = this._weekdaysRegex, this._weekdaysMinRegex = this._weekdaysRegex, this._weekdaysStrictRegex = new RegExp("^(" + l.join("|") + ")", "i"), this._weekdaysShortStrictRegex = new RegExp("^(" + s.join("|") + ")", "i"), this._weekdaysMinStrictRegex = new RegExp("^(" + a.join("|") + ")", "i")
            }

            function qe() {
                return this.hours() % 12 || 12
            }

            function Ve() {
                return this.hours() || 24
            }

            function Ze(e, t) {
                Y(e, 0, 0, function() {
                    return this.localeData().meridiem(this.hours(), this.minutes(), t)
                })
            }

            function Ye(e, t) {
                return t._meridiemParse
            }

            function Ke(e) {
                return "p" === (e + "").toLowerCase().charAt(0)
            }

            function Xe(e, t, i) {
                return e > 11 ? i ? "pm" : "PM" : i ? "am" : "AM"
            }

            function $e(e) {
                return e ? e.toLowerCase().replace("_", "-") : e
            }

            function Qe(e) {
                for (var t, i, n, r, o = 0; o < e.length;) {
                    for (r = $e(e[o]).split("-"), t = r.length, i = $e(e[o + 1]), i = i ? i.split("-") : null; t > 0;) {
                        if (n = Je(r.slice(0, t).join("-"))) return n;
                        if (i && i.length >= t && M(r, i, !0) >= t - 1) break;
                        t--
                    }
                    o++
                }
                return null
            }

            function Je(i) {
                var n = null;
                if (!Pr[i] && "undefined" != typeof t && t && t.exports) try {
                    n = Cr._abbr, e("./locale/" + i), et(n)
                } catch (r) {}
                return Pr[i]
            }

            function et(e, t) {
                var i;
                return e && (i = _(t) ? nt(e) : tt(e, t), i && (Cr = i)), Cr._abbr
            }

            function tt(e, t) {
                if (null !== t) {
                    var i = Lr;
                    if (t.abbr = e, null != Pr[e]) C("defineLocaleOverride", "use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."), i = Pr[e]._config;
                    else if (null != t.parentLocale) {
                        if (null == Pr[t.parentLocale]) return Ar[t.parentLocale] || (Ar[t.parentLocale] = []), Ar[t.parentLocale].push({
                            name: e,
                            config: t
                        }), null;
                        i = Pr[t.parentLocale]._config
                    }
                    return Pr[e] = new P(L(i, t)), Ar[e] && Ar[e].forEach(function(e) {
                        tt(e.name, e.config)
                    }), et(e), Pr[e]
                }
                return delete Pr[e], null
            }

            function it(e, t) {
                if (null != t) {
                    var i, n = Lr;
                    null != Pr[e] && (n = Pr[e]._config), t = L(n, t), i = new P(t), i.parentLocale = Pr[e], Pr[e] = i, et(e)
                } else null != Pr[e] && (null != Pr[e].parentLocale ? Pr[e] = Pr[e].parentLocale : null != Pr[e] && delete Pr[e]);
                return Pr[e]
            }

            function nt(e) {
                var t;
                if (e && e._locale && e._locale._abbr && (e = e._locale._abbr), !e) return Cr;
                if (!r(e)) {
                    if (t = Je(e)) return t;
                    e = [e]
                }
                return Qe(e)
            }

            function rt() {
                return Sn(Pr)
            }

            function ot(e) {
                var t, i = e._a;
                return i && -2 === p(e).overflow && (t = i[rr] < 0 || i[rr] > 11 ? rr : i[or] < 1 || i[or] > ae(i[nr], i[rr]) ? or : i[ar] < 0 || i[ar] > 24 || 24 === i[ar] && (0 !== i[sr] || 0 !== i[lr] || 0 !== i[hr]) ? ar : i[sr] < 0 || i[sr] > 59 ? sr : i[lr] < 0 || i[lr] > 59 ? lr : i[hr] < 0 || i[hr] > 999 ? hr : -1, p(e)._overflowDayOfYear && (nr > t || t > or) && (t = or), p(e)._overflowWeeks && -1 === t && (t = ur), p(e)._overflowWeekday && -1 === t && (t = dr), p(e).overflow = t), e
            }

            function at(e) {
                var t, i, n, r, o, a, s = e._i,
                    l = Rr.exec(s) || Dr.exec(s);
                if (l) {
                    for (p(e).iso = !0, t = 0, i = Or.length; i > t; t++)
                        if (Or[t][1].exec(l[1])) {
                            r = Or[t][0], n = Or[t][2] !== !1;
                            break
                        }
                    if (null == r) return void(e._isValid = !1);
                    if (l[3]) {
                        for (t = 0, i = Nr.length; i > t; t++)
                            if (Nr[t][1].exec(l[3])) {
                                o = (l[2] || " ") + Nr[t][0];
                                break
                            }
                        if (null == o) return void(e._isValid = !1)
                    }
                    if (!n && null != o) return void(e._isValid = !1);
                    if (l[4]) {
                        if (!Ir.exec(l[4])) return void(e._isValid = !1);
                        a = "Z"
                    }
                    e._f = r + (o || "") + (a || ""), ct(e)
                } else e._isValid = !1
            }

            function st(e) {
                var t = Br.exec(e._i);
                return null !== t ? void(e._d = new Date(+t[1])) : (at(e), void(e._isValid === !1 && (delete e._isValid, i.createFromInputFallback(e))))
            }

            function lt(e, t, i) {
                return null != e ? e : null != t ? t : i
            }

            function ht(e) {
                var t = new Date(i.now());
                return e._useUTC ? [t.getUTCFullYear(), t.getUTCMonth(), t.getUTCDate()] : [t.getFullYear(), t.getMonth(), t.getDate()]
            }

            function ut(e) {
                var t, i, n, r, o = [];
                if (!e._d) {
                    for (n = ht(e), e._w && null == e._a[or] && null == e._a[rr] && dt(e), e._dayOfYear && (r = lt(e._a[nr], n[nr]), e._dayOfYear > _e(r) && (p(e)._overflowDayOfYear = !0), i = xe(r, 0, e._dayOfYear), e._a[rr] = i.getUTCMonth(), e._a[or] = i.getUTCDate()), t = 0; 3 > t && null == e._a[t]; ++t) e._a[t] = o[t] = n[t];
                    for (; 7 > t; t++) e._a[t] = o[t] = null == e._a[t] ? 2 === t ? 1 : 0 : e._a[t];
                    24 === e._a[ar] && 0 === e._a[sr] && 0 === e._a[lr] && 0 === e._a[hr] && (e._nextDay = !0, e._a[ar] = 0), e._d = (e._useUTC ? xe : be).apply(null, o), null != e._tzm && e._d.setUTCMinutes(e._d.getUTCMinutes() - e._tzm), e._nextDay && (e._a[ar] = 24)
                }
            }

            function dt(e) {
                var t, i, n, r, o, a, s, l;
                if (t = e._w, null != t.GG || null != t.W || null != t.E) o = 1, a = 4, i = lt(t.GG, e._a[nr], Te(bt(), 1, 4).year), n = lt(t.W, 1), r = lt(t.E, 1), (1 > r || r > 7) && (l = !0);
                else {
                    o = e._locale._week.dow, a = e._locale._week.doy;
                    var h = Te(bt(), o, a);
                    i = lt(t.gg, e._a[nr], h.year), n = lt(t.w, h.week), null != t.d ? (r = t.d, (0 > r || r > 6) && (l = !0)) : null != t.e ? (r = t.e + o, (t.e < 0 || t.e > 6) && (l = !0)) : r = o
                }
                1 > n || n > Se(i, o, a) ? p(e)._overflowWeeks = !0 : null != l ? p(e)._overflowWeekday = !0 : (s = Me(i, n, r, o, a), e._a[nr] = s.year, e._dayOfYear = s.dayOfYear)
            }

            function ct(e) {
                if (e._f === i.ISO_8601) return void at(e);
                e._a = [], p(e).empty = !0;
                var t, n, r, o, a, s = "" + e._i,
                    l = s.length,
                    h = 0;
                for (r = Q(e._f, e._locale).match(In) || [], t = 0; t < r.length; t++) o = r[t], n = (s.match(ee(o, e)) || [])[0], n && (a = s.substr(0, s.indexOf(n)), a.length > 0 && p(e).unusedInput.push(a), s = s.slice(s.indexOf(n) + n.length), h += n.length), Bn[o] ? (n ? p(e).empty = !1 : p(e).unusedTokens.push(o), oe(o, n, e)) : e._strict && !n && p(e).unusedTokens.push(o);
                p(e).charsLeftOver = l - h, s.length > 0 && p(e).unusedInput.push(s), e._a[ar] <= 12 && p(e).bigHour === !0 && e._a[ar] > 0 && (p(e).bigHour = void 0), p(e).parsedDateParts = e._a.slice(0), p(e).meridiem = e._meridiem, e._a[ar] = ft(e._locale, e._a[ar], e._meridiem), ut(e), ot(e)
            }

            function ft(e, t, i) {
                var n;
                return null == i ? t : null != e.meridiemHour ? e.meridiemHour(t, i) : null != e.isPM ? (n = e.isPM(i), n && 12 > t && (t += 12), n || 12 !== t || (t = 0), t) : t
            }

            function pt(e) {
                var t, i, n, r, o;
                if (0 === e._f.length) return p(e).invalidFormat = !0, void(e._d = new Date(NaN));
                for (r = 0; r < e._f.length; r++) o = 0, t = v({}, e), null != e._useUTC && (t._useUTC = e._useUTC), t._f = e._f[r], ct(t), m(t) && (o += p(t).charsLeftOver, o += 10 * p(t).unusedTokens.length, p(t).score = o, (null == n || n > o) && (n = o, i = t));
                d(e, i || t)
            }

            function mt(e) {
                if (!e._d) {
                    var t = z(e._i);
                    e._a = h([t.year, t.month, t.day || t.date, t.hour, t.minute, t.second, t.millisecond], function(e) {
                        return e && parseInt(e, 10)
                    }), ut(e)
                }
            }

            function gt(e) {
                var t = new y(ot(_t(e)));
                return t._nextDay && (t.add(1, "d"), t._nextDay = void 0), t
            }

            function _t(e) {
                var t = e._i,
                    i = e._f;
                return e._locale = e._locale || nt(e._l), null === t || void 0 === i && "" === t ? g({
                    nullInput: !0
                }) : ("string" == typeof t && (e._i = t = e._locale.preparse(t)), b(t) ? new y(ot(t)) : (l(t) ? e._d = t : r(i) ? pt(e) : i ? ct(e) : vt(e), m(e) || (e._d = null), e))
            }

            function vt(e) {
                var t = e._i;
                void 0 === t ? e._d = new Date(i.now()) : l(t) ? e._d = new Date(t.valueOf()) : "string" == typeof t ? st(e) : r(t) ? (e._a = h(t.slice(0), function(e) {
                    return parseInt(e, 10)
                }), ut(e)) : "object" == typeof t ? mt(e) : s(t) ? e._d = new Date(t) : i.createFromInputFallback(e)
            }

            function yt(e, t, i, n, s) {
                var l = {};
                return (i === !0 || i === !1) && (n = i, i = void 0), (o(e) && a(e) || r(e) && 0 === e.length) && (e = void 0), l._isAMomentObject = !0, l._useUTC = l._isUTC = s, l._l = i, l._i = e, l._f = t, l._strict = n, gt(l)
            }

            function bt(e, t, i, n) {
                return yt(e, t, i, n, !1)
            }

            function xt(e, t) {
                var i, n;
                if (1 === t.length && r(t[0]) && (t = t[0]), !t.length) return bt();
                for (i = t[0], n = 1; n < t.length; ++n)(!t[n].isValid() || t[n][e](i)) && (i = t[n]);
                return i
            }

            function wt() {
                var e = [].slice.call(arguments, 0);
                return xt("isBefore", e)
            }

            function Mt() {
                var e = [].slice.call(arguments, 0);
                return xt("isAfter", e)
            }

            function Tt(e) {
                var t = z(e),
                    i = t.year || 0,
                    n = t.quarter || 0,
                    r = t.month || 0,
                    o = t.week || 0,
                    a = t.day || 0,
                    s = t.hour || 0,
                    l = t.minute || 0,
                    h = t.second || 0,
                    u = t.millisecond || 0;
                this._milliseconds = +u + 1e3 * h + 6e4 * l + 1e3 * s * 60 * 60, this._days = +a + 7 * o, this._months = +r + 3 * n + 12 * i, this._data = {}, this._locale = nt(), this._bubble()
            }

            function St(e) {
                return e instanceof Tt
            }

            function Ct(e) {
                return 0 > e ? -1 * Math.round(-1 * e) : Math.round(e)
            }

            function Et(e, t) {
                Y(e, 0, 0, function() {
                    var e = this.utcOffset(),
                        i = "+";
                    return 0 > e && (e = -e, i = "-"), i + Z(~~(e / 60), 2) + t + Z(~~e % 60, 2)
                })
            }

            function kt(e, t) {
                var i = (t || "").match(e);
                if (null === i) return null;
                var n = i[i.length - 1] || [],
                    r = (n + "").match(Ur) || ["-", 0, 0],
                    o = +(60 * r[1]) + w(r[2]);
                return 0 === o ? 0 : "+" === r[0] ? o : -o
            }

            function Lt(e, t) {
                var n, r;
                return t._isUTC ? (n = t.clone(), r = (b(e) || l(e) ? e.valueOf() : bt(e).valueOf()) - n.valueOf(), n._d.setTime(n._d.valueOf() + r), i.updateOffset(n, !1), n) : bt(e).local()
            }

            function Pt(e) {
                return 15 * -Math.round(e._d.getTimezoneOffset() / 15)
            }

            function At(e, t) {
                var n, r = this._offset || 0;
                if (!this.isValid()) return null != e ? this : NaN;
                if (null != e) {
                    if ("string" == typeof e) {
                        if (e = kt(Qn, e), null === e) return this
                    } else Math.abs(e) < 16 && (e = 60 * e);
                    return !this._isUTC && t && (n = Pt(this)), this._offset = e, this._isUTC = !0, null != n && this.add(n, "m"), r !== e && (!t || this._changeInProgress ? Zt(this, Wt(e - r, "m"), 1, !1) : this._changeInProgress || (this._changeInProgress = !0, i.updateOffset(this, !0), this._changeInProgress = null)), this
                }
                return this._isUTC ? r : Pt(this)
            }

            function Rt(e, t) {
                return null != e ? ("string" != typeof e && (e = -e), this.utcOffset(e, t), this) : -this.utcOffset()
            }

            function Dt(e) {
                return this.utcOffset(0, e)
            }

            function It(e) {
                return this._isUTC && (this.utcOffset(0, e), this._isUTC = !1, e && this.subtract(Pt(this), "m")), this
            }

            function Ot() {
                if (null != this._tzm) this.utcOffset(this._tzm);
                else if ("string" == typeof this._i) {
                    var e = kt($n, this._i);
                    null != e ? this.utcOffset(e) : this.utcOffset(0, !0)
                }
                return this
            }

            function Nt(e) {
                return this.isValid() ? (e = e ? bt(e).utcOffset() : 0, (this.utcOffset() - e) % 60 === 0) : !1
            }

            function Bt() {
                return this.utcOffset() > this.clone().month(0).utcOffset() || this.utcOffset() > this.clone().month(5).utcOffset()
            }

            function Ft() {
                if (!_(this._isDSTShifted)) return this._isDSTShifted;
                var e = {};
                if (v(e, this), e = _t(e), e._a) {
                    var t = e._isUTC ? c(e._a) : bt(e._a);
                    this._isDSTShifted = this.isValid() && M(e._a, t.toArray()) > 0
                } else this._isDSTShifted = !1;
                return this._isDSTShifted
            }

            function zt() {
                return this.isValid() ? !this._isUTC : !1
            }

            function Ht() {
                return this.isValid() ? this._isUTC : !1
            }

            function Ut() {
                return this.isValid() ? this._isUTC && 0 === this._offset : !1
            }

            function Wt(e, t) {
                var i, n, r, o = e,
                    a = null;
                return St(e) ? o = {
                    ms: e._milliseconds,
                    d: e._days,
                    M: e._months
                } : s(e) ? (o = {}, t ? o[t] = e : o.milliseconds = e) : (a = Wr.exec(e)) ? (i = "-" === a[1] ? -1 : 1, o = {
                    y: 0,
                    d: w(a[or]) * i,
                    h: w(a[ar]) * i,
                    m: w(a[sr]) * i,
                    s: w(a[lr]) * i,
                    ms: w(Ct(1e3 * a[hr])) * i
                }) : (a = Gr.exec(e)) ? (i = "-" === a[1] ? -1 : 1, o = {
                    y: Gt(a[2], i),
                    M: Gt(a[3], i),
                    w: Gt(a[4], i),
                    d: Gt(a[5], i),
                    h: Gt(a[6], i),
                    m: Gt(a[7], i),
                    s: Gt(a[8], i)
                }) : null == o ? o = {} : "object" == typeof o && ("from" in o || "to" in o) && (r = qt(bt(o.from), bt(o.to)), o = {}, o.ms = r.milliseconds, o.M = r.months), n = new Tt(o), St(e) && u(e, "_locale") && (n._locale = e._locale), n
            }

            function Gt(e, t) {
                var i = e && parseFloat(e.replace(",", "."));
                return (isNaN(i) ? 0 : i) * t
            }

            function jt(e, t) {
                var i = {
                    milliseconds: 0,
                    months: 0
                };
                return i.months = t.month() - e.month() + 12 * (t.year() - e.year()), e.clone().add(i.months, "M").isAfter(t) && --i.months, i.milliseconds = +t - +e.clone().add(i.months, "M"), i
            }

            function qt(e, t) {
                var i;
                return e.isValid() && t.isValid() ? (t = Lt(t, e), e.isBefore(t) ? i = jt(e, t) : (i = jt(t, e), i.milliseconds = -i.milliseconds, i.months = -i.months), i) : {
                    milliseconds: 0,
                    months: 0
                }
            }

            function Vt(e, t) {
                return function(i, n) {
                    var r, o;
                    return null === n || isNaN(+n) || (C(t, "moment()." + t + "(period, number) is deprecated. Please use moment()." + t + "(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."), o = i, i = n, n = o), i = "string" == typeof i ? +i : i, r = Wt(i, n), Zt(this, r, e), this
                }
            }

            function Zt(e, t, n, r) {
                var o = t._milliseconds,
                    a = Ct(t._days),
                    s = Ct(t._months);
                e.isValid() && (r = null == r ? !0 : r, o && e._d.setTime(e._d.valueOf() + o * n), a && j(e, "Date", G(e, "Date") + a * n), s && de(e, G(e, "Month") + s * n), r && i.updateOffset(e, a || s))
            }

            function Yt(e, t) {
                var i = e.diff(t, "days", !0);
                return -6 > i ? "sameElse" : -1 > i ? "lastWeek" : 0 > i ? "lastDay" : 1 > i ? "sameDay" : 2 > i ? "nextDay" : 7 > i ? "nextWeek" : "sameElse"
            }

            function Kt(e, t) {
                var n = e || bt(),
                    r = Lt(n, this).startOf("day"),
                    o = i.calendarFormat(this, r) || "sameElse",
                    a = t && (E(t[o]) ? t[o].call(this, n) : t[o]);
                return this.format(a || this.localeData().calendar(o, this, bt(n)))
            }

            function Xt() {
                return new y(this)
            }

            function $t(e, t) {
                var i = b(e) ? e : bt(e);
                return this.isValid() && i.isValid() ? (t = F(_(t) ? "millisecond" : t), "millisecond" === t ? this.valueOf() > i.valueOf() : i.valueOf() < this.clone().startOf(t).valueOf()) : !1
            }

            function Qt(e, t) {
                var i = b(e) ? e : bt(e);
                return this.isValid() && i.isValid() ? (t = F(_(t) ? "millisecond" : t), "millisecond" === t ? this.valueOf() < i.valueOf() : this.clone().endOf(t).valueOf() < i.valueOf()) : !1
            }

            function Jt(e, t, i, n) {
                return n = n || "()", ("(" === n[0] ? this.isAfter(e, i) : !this.isBefore(e, i)) && (")" === n[1] ? this.isBefore(t, i) : !this.isAfter(t, i))
            }

            function ei(e, t) {
                var i, n = b(e) ? e : bt(e);
                return this.isValid() && n.isValid() ? (t = F(t || "millisecond"), "millisecond" === t ? this.valueOf() === n.valueOf() : (i = n.valueOf(), this.clone().startOf(t).valueOf() <= i && i <= this.clone().endOf(t).valueOf())) : !1
            }

            function ti(e, t) {
                return this.isSame(e, t) || this.isAfter(e, t)
            }

            function ii(e, t) {
                return this.isSame(e, t) || this.isBefore(e, t)
            }

            function ni(e, t, i) {
                var n, r, o, a;
                return this.isValid() ? (n = Lt(e, this), n.isValid() ? (r = 6e4 * (n.utcOffset() - this.utcOffset()), t = F(t), "year" === t || "month" === t || "quarter" === t ? (a = ri(this, n), "quarter" === t ? a /= 3 : "year" === t && (a /= 12)) : (o = this - n, a = "second" === t ? o / 1e3 : "minute" === t ? o / 6e4 : "hour" === t ? o / 36e5 : "day" === t ? (o - r) / 864e5 : "week" === t ? (o - r) / 6048e5 : o), i ? a : x(a)) : NaN) : NaN
            }

            function ri(e, t) {
                var i, n, r = 12 * (t.year() - e.year()) + (t.month() - e.month()),
                    o = e.clone().add(r, "months");
                return 0 > t - o ? (i = e.clone().add(r - 1, "months"), n = (t - o) / (o - i)) : (i = e.clone().add(r + 1, "months"), n = (t - o) / (i - o)), -(r + n) || 0
            }

            function oi() {
                return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
            }

            function ai() {
                var e = this.clone().utc();
                return 0 < e.year() && e.year() <= 9999 ? E(Date.prototype.toISOString) ? this.toDate().toISOString() : $(e, "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]") : $(e, "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
            }

            function si() {
                if (!this.isValid()) return "moment.invalid(/* " + this._i + " */)";
                var e = "moment",
                    t = "";
                this.isLocal() || (e = 0 === this.utcOffset() ? "moment.utc" : "moment.parseZone", t = "Z");
                var i = "[" + e + '("]',
                    n = 0 < this.year() && this.year() <= 9999 ? "YYYY" : "YYYYYY",
                    r = "-MM-DD[T]HH:mm:ss.SSS",
                    o = t + '[")]';
                return this.format(i + n + r + o)
            }

            function li(e) {
                e || (e = this.isUtc() ? i.defaultFormatUtc : i.defaultFormat);
                var t = $(this, e);
                return this.localeData().postformat(t)
            }

            function hi(e, t) {
                return this.isValid() && (b(e) && e.isValid() || bt(e).isValid()) ? Wt({
                    to: this,
                    from: e
                }).locale(this.locale()).humanize(!t) : this.localeData().invalidDate()
            }

            function ui(e) {
                return this.from(bt(), e)
            }

            function di(e, t) {
                return this.isValid() && (b(e) && e.isValid() || bt(e).isValid()) ? Wt({
                    from: this,
                    to: e
                }).locale(this.locale()).humanize(!t) : this.localeData().invalidDate()
            }

            function ci(e) {
                return this.to(bt(), e)
            }

            function fi(e) {
                var t;
                return void 0 === e ? this._locale._abbr : (t = nt(e), null != t && (this._locale = t), this)
            }

            function pi() {
                return this._locale
            }

            function mi(e) {
                switch (e = F(e)) {
                    case "year":
                        this.month(0);
                    case "quarter":
                    case "month":
                        this.date(1);
                    case "week":
                    case "isoWeek":
                    case "day":
                    case "date":
                        this.hours(0);
                    case "hour":
                        this.minutes(0);
                    case "minute":
                        this.seconds(0);
                    case "second":
                        this.milliseconds(0)
                }
                return "week" === e && this.weekday(0), "isoWeek" === e && this.isoWeekday(1), "quarter" === e && this.month(3 * Math.floor(this.month() / 3)), this
            }

            function gi(e) {
                return e = F(e), void 0 === e || "millisecond" === e ? this : ("date" === e && (e = "day"), this.startOf(e).add(1, "isoWeek" === e ? "week" : e).subtract(1, "ms"))
            }

            function _i() {
                return this._d.valueOf() - 6e4 * (this._offset || 0)
            }

            function vi() {
                return Math.floor(this.valueOf() / 1e3)
            }

            function yi() {
                return new Date(this.valueOf())
            }

            function bi() {
                var e = this;
                return [e.year(), e.month(), e.date(), e.hour(), e.minute(), e.second(), e.millisecond()]
            }

            function xi() {
                var e = this;
                return {
                    years: e.year(),
                    months: e.month(),
                    date: e.date(),
                    hours: e.hours(),
                    minutes: e.minutes(),
                    seconds: e.seconds(),
                    milliseconds: e.milliseconds()
                }
            }

            function wi() {
                return this.isValid() ? this.toISOString() : null
            }

            function Mi() {
                return m(this)
            }

            function Ti() {
                return d({}, p(this))
            }

            function Si() {
                return p(this).overflow
            }

            function Ci() {
                return {
                    input: this._i,
                    format: this._f,
                    locale: this._locale,
                    isUTC: this._isUTC,
                    strict: this._strict
                }
            }

            function Ei(e, t) {
                Y(0, [e, e.length], 0, t)
            }

            function ki(e) {
                return Ri.call(this, e, this.week(), this.weekday(), this.localeData()._week.dow, this.localeData()._week.doy)
            }

            function Li(e) {
                return Ri.call(this, e, this.isoWeek(), this.isoWeekday(), 1, 4)
            }

            function Pi() {
                return Se(this.year(), 1, 4)
            }

            function Ai() {
                var e = this.localeData()._week;
                return Se(this.year(), e.dow, e.doy)
            }

            function Ri(e, t, i, n, r) {
                var o;
                return null == e ? Te(this, n, r).year : (o = Se(e, n, r), t > o && (t = o), Di.call(this, e, t, i, n, r))
            }

            function Di(e, t, i, n, r) {
                var o = Me(e, t, i, n, r),
                    a = xe(o.year, 0, o.dayOfYear);
                return this.year(a.getUTCFullYear()), this.month(a.getUTCMonth()), this.date(a.getUTCDate()), this
            }

            function Ii(e) {
                return null == e ? Math.ceil((this.month() + 1) / 3) : this.month(3 * (e - 1) + this.month() % 3)
            }

            function Oi(e) {
                var t = Math.round((this.clone().startOf("day") - this.clone().startOf("year")) / 864e5) + 1;
                return null == e ? t : this.add(e - t, "d")
            }

            function Ni(e, t) {
                t[hr] = w(1e3 * ("0." + e))
            }

            function Bi() {
                return this._isUTC ? "UTC" : ""
            }

            function Fi() {
                return this._isUTC ? "Coordinated Universal Time" : ""
            }

            function zi(e) {
                return bt(1e3 * e)
            }

            function Hi() {
                return bt.apply(null, arguments).parseZone()
            }

            function Ui(e) {
                return e
            }

            function Wi(e, t, i, n) {
                var r = nt(),
                    o = c().set(n, t);
                return r[i](o, e)
            }

            function Gi(e, t, i) {
                if (s(e) && (t = e, e = void 0), e = e || "", null != t) return Wi(e, t, i, "month");
                var n, r = [];
                for (n = 0; 12 > n; n++) r[n] = Wi(e, n, i, "month");
                return r
            }

            function ji(e, t, i, n) {
                "boolean" == typeof e ? (s(t) && (i = t, t = void 0), t = t || "") : (t = e, i = t, e = !1, s(t) && (i = t, t = void 0), t = t || "");
                var r = nt(),
                    o = e ? r._week.dow : 0;
                if (null != i) return Wi(t, (i + o) % 7, n, "day");
                var a, l = [];
                for (a = 0; 7 > a; a++) l[a] = Wi(t, (a + o) % 7, n, "day");
                return l
            }

            function qi(e, t) {
                return Gi(e, t, "months")
            }

            function Vi(e, t) {
                return Gi(e, t, "monthsShort")
            }

            function Zi(e, t, i) {
                return ji(e, t, i, "weekdays")
            }

            function Yi(e, t, i) {
                return ji(e, t, i, "weekdaysShort")
            }

            function Ki(e, t, i) {
                return ji(e, t, i, "weekdaysMin")
            }

            function Xi() {
                var e = this._data;
                return this._milliseconds = eo(this._milliseconds), this._days = eo(this._days), this._months = eo(this._months), e.milliseconds = eo(e.milliseconds), e.seconds = eo(e.seconds), e.minutes = eo(e.minutes), e.hours = eo(e.hours), e.months = eo(e.months), e.years = eo(e.years), this
            }

            function $i(e, t, i, n) {
                var r = Wt(t, i);
                return e._milliseconds += n * r._milliseconds, e._days += n * r._days, e._months += n * r._months, e._bubble()
            }

            function Qi(e, t) {
                return $i(this, e, t, 1)
            }

            function Ji(e, t) {
                return $i(this, e, t, -1)
            }

            function en(e) {
                return 0 > e ? Math.floor(e) : Math.ceil(e)
            }

            function tn() {
                var e, t, i, n, r, o = this._milliseconds,
                    a = this._days,
                    s = this._months,
                    l = this._data;
                return o >= 0 && a >= 0 && s >= 0 || 0 >= o && 0 >= a && 0 >= s || (o += 864e5 * en(rn(s) + a), a = 0, s = 0), l.milliseconds = o % 1e3, e = x(o / 1e3), l.seconds = e % 60, t = x(e / 60), l.minutes = t % 60, i = x(t / 60), l.hours = i % 24, a += x(i / 24), r = x(nn(a)), s += r, a -= en(rn(r)), n = x(s / 12), s %= 12, l.days = a, l.months = s, l.years = n, this
            }

            function nn(e) {
                return 4800 * e / 146097
            }

            function rn(e) {
                return 146097 * e / 4800
            }

            function on(e) {
                var t, i, n = this._milliseconds;
                if (e = F(e), "month" === e || "year" === e) return t = this._days + n / 864e5, i = this._months + nn(t), "month" === e ? i : i / 12;
                switch (t = this._days + Math.round(rn(this._months)), e) {
                    case "week":
                        return t / 7 + n / 6048e5;
                    case "day":
                        return t + n / 864e5;
                    case "hour":
                        return 24 * t + n / 36e5;
                    case "minute":
                        return 1440 * t + n / 6e4;
                    case "second":
                        return 86400 * t + n / 1e3;
                    case "millisecond":
                        return Math.floor(864e5 * t) + n;
                    default:
                        throw new Error("Unknown unit " + e)
                }
            }

            function an() {
                return this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * w(this._months / 12)
            }

            function sn(e) {
                return function() {
                    return this.as(e)
                }
            }

            function ln(e) {
                return e = F(e), this[e + "s"]()
            }

            function hn(e) {
                return function() {
                    return this._data[e]
                }
            }

            function un() {
                return x(this.days() / 7)
            }

            function dn(e, t, i, n, r) {
                return r.relativeTime(t || 1, !!i, e, n)
            }

            function cn(e, t, i) {
                var n = Wt(e).abs(),
                    r = _o(n.as("s")),
                    o = _o(n.as("m")),
                    a = _o(n.as("h")),
                    s = _o(n.as("d")),
                    l = _o(n.as("M")),
                    h = _o(n.as("y")),
                    u = r < vo.s && ["s", r] || 1 >= o && ["m"] || o < vo.m && ["mm", o] || 1 >= a && ["h"] || a < vo.h && ["hh", a] || 1 >= s && ["d"] || s < vo.d && ["dd", s] || 1 >= l && ["M"] || l < vo.M && ["MM", l] || 1 >= h && ["y"] || ["yy", h];
                return u[2] = t, u[3] = +e > 0, u[4] = i, dn.apply(null, u)
            }

            function fn(e) {
                return void 0 === e ? _o : "function" == typeof e ? (_o = e, !0) : !1
            }

            function pn(e, t) {
                return void 0 === vo[e] ? !1 : void 0 === t ? vo[e] : (vo[e] = t, !0)
            }

            function mn(e) {
                var t = this.localeData(),
                    i = cn(this, !e, t);
                return e && (i = t.pastFuture(+this, i)), t.postformat(i)
            }

            function gn() {
                var e, t, i, n = yo(this._milliseconds) / 1e3,
                    r = yo(this._days),
                    o = yo(this._months);
                e = x(n / 60), t = x(e / 60), n %= 60, e %= 60, i = x(o / 12), o %= 12;
                var a = i,
                    s = o,
                    l = r,
                    h = t,
                    u = e,
                    d = n,
                    c = this.asSeconds();
                return c ? (0 > c ? "-" : "") + "P" + (a ? a + "Y" : "") + (s ? s + "M" : "") + (l ? l + "D" : "") + (h || u || d ? "T" : "") + (h ? h + "H" : "") + (u ? u + "M" : "") + (d ? d + "S" : "") : "P0D"
            }
            var _n, vn;
            vn = Array.prototype.some ? Array.prototype.some : function(e) {
                for (var t = Object(this), i = t.length >>> 0, n = 0; i > n; n++)
                    if (n in t && e.call(this, t[n], n, t)) return !0;
                return !1
            };
            var yn = vn,
                bn = i.momentProperties = [],
                xn = !1,
                wn = {};
            i.suppressDeprecationWarnings = !1, i.deprecationHandler = null;
            var Mn;
            Mn = Object.keys ? Object.keys : function(e) {
                var t, i = [];
                for (t in e) u(e, t) && i.push(t);
                return i
            };
            var Tn, Sn = Mn,
                Cn = {
                    sameDay: "[Today at] LT",
                    nextDay: "[Tomorrow at] LT",
                    nextWeek: "dddd [at] LT",
                    lastDay: "[Yesterday at] LT",
                    lastWeek: "[Last] dddd [at] LT",
                    sameElse: "L"
                },
                En = {
                    LTS: "h:mm:ss A",
                    LT: "h:mm A",
                    L: "MM/DD/YYYY",
                    LL: "MMMM D, YYYY",
                    LLL: "MMMM D, YYYY h:mm A",
                    LLLL: "dddd, MMMM D, YYYY h:mm A"
                },
                kn = "Invalid date",
                Ln = "%d",
                Pn = /\d{1,2}/,
                An = {
                    future: "in %s",
                    past: "%s ago",
                    s: "a few seconds",
                    m: "a minute",
                    mm: "%d minutes",
                    h: "an hour",
                    hh: "%d hours",
                    d: "a day",
                    dd: "%d days",
                    M: "a month",
                    MM: "%d months",
                    y: "a year",
                    yy: "%d years"
                },
                Rn = {},
                Dn = {},
                In = /(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,
                On = /(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,
                Nn = {},
                Bn = {},
                Fn = /\d/,
                zn = /\d\d/,
                Hn = /\d{3}/,
                Un = /\d{4}/,
                Wn = /[+-]?\d{6}/,
                Gn = /\d\d?/,
                jn = /\d\d\d\d?/,
                qn = /\d\d\d\d\d\d?/,
                Vn = /\d{1,3}/,
                Zn = /\d{1,4}/,
                Yn = /[+-]?\d{1,6}/,
                Kn = /\d+/,
                Xn = /[+-]?\d+/,
                $n = /Z|[+-]\d\d:?\d\d/gi,
                Qn = /Z|[+-]\d\d(?::?\d\d)?/gi,
                Jn = /[+-]?\d+(\.\d{1,3})?/,
                er = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,
                tr = {},
                ir = {},
                nr = 0,
                rr = 1,
                or = 2,
                ar = 3,
                sr = 4,
                lr = 5,
                hr = 6,
                ur = 7,
                dr = 8;
            Tn = Array.prototype.indexOf ? Array.prototype.indexOf : function(e) {
                var t;
                for (t = 0; t < this.length; ++t)
                    if (this[t] === e) return t;
                return -1
            };
            var cr = Tn;
            Y("M", ["MM", 2], "Mo", function() {
                return this.month() + 1
            }), Y("MMM", 0, 0, function(e) {
                return this.localeData().monthsShort(this, e)
            }), Y("MMMM", 0, 0, function(e) {
                return this.localeData().months(this, e)
            }), B("month", "M"), H("month", 8), J("M", Gn), J("MM", Gn, zn), J("MMM", function(e, t) {
                return t.monthsShortRegex(e)
            }), J("MMMM", function(e, t) {
                return t.monthsRegex(e)
            }), ne(["M", "MM"], function(e, t) {
                t[rr] = w(e) - 1
            }), ne(["MMM", "MMMM"], function(e, t, i, n) {
                var r = i._locale.monthsParse(e, n, i._strict);
                null != r ? t[rr] = r : p(i).invalidMonth = e
            });
            var fr = /D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,
                pr = "January_February_March_April_May_June_July_August_September_October_November_December".split("_"),
                mr = "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),
                gr = er,
                _r = er;
            Y("Y", 0, 0, function() {
                var e = this.year();
                return 9999 >= e ? "" + e : "+" + e
            }), Y(0, ["YY", 2], 0, function() {
                return this.year() % 100
            }), Y(0, ["YYYY", 4], 0, "year"), Y(0, ["YYYYY", 5], 0, "year"), Y(0, ["YYYYYY", 6, !0], 0, "year"), B("year", "y"), H("year", 1), J("Y", Xn), J("YY", Gn, zn), J("YYYY", Zn, Un), J("YYYYY", Yn, Wn), J("YYYYYY", Yn, Wn), ne(["YYYYY", "YYYYYY"], nr), ne("YYYY", function(e, t) {
                t[nr] = 2 === e.length ? i.parseTwoDigitYear(e) : w(e)
            }), ne("YY", function(e, t) {
                t[nr] = i.parseTwoDigitYear(e)
            }), ne("Y", function(e, t) {
                t[nr] = parseInt(e, 10)
            }), i.parseTwoDigitYear = function(e) {
                return w(e) + (w(e) > 68 ? 1900 : 2e3)
            };
            var vr = W("FullYear", !0);
            Y("w", ["ww", 2], "wo", "week"), Y("W", ["WW", 2], "Wo", "isoWeek"), B("week", "w"), B("isoWeek", "W"), H("week", 5), H("isoWeek", 5), J("w", Gn), J("ww", Gn, zn), J("W", Gn), J("WW", Gn, zn), re(["w", "ww", "W", "WW"], function(e, t, i, n) {
                t[n.substr(0, 1)] = w(e)
            });
            var yr = {
                dow: 0,
                doy: 6
            };
            Y("d", 0, "do", "day"), Y("dd", 0, 0, function(e) {
                return this.localeData().weekdaysMin(this, e)
            }), Y("ddd", 0, 0, function(e) {
                return this.localeData().weekdaysShort(this, e)
            }), Y("dddd", 0, 0, function(e) {
                return this.localeData().weekdays(this, e)
            }), Y("e", 0, 0, "weekday"), Y("E", 0, 0, "isoWeekday"), B("day", "d"), B("weekday", "e"), B("isoWeekday", "E"), H("day", 11), H("weekday", 11), H("isoWeekday", 11), J("d", Gn), J("e", Gn), J("E", Gn), J("dd", function(e, t) {
                return t.weekdaysMinRegex(e)
            }), J("ddd", function(e, t) {
                return t.weekdaysShortRegex(e)
            }), J("dddd", function(e, t) {
                return t.weekdaysRegex(e)
            }), re(["dd", "ddd", "dddd"], function(e, t, i, n) {
                var r = i._locale.weekdaysParse(e, n, i._strict);
                null != r ? t.d = r : p(i).invalidWeekday = e
            }), re(["d", "e", "E"], function(e, t, i, n) {
                t[n] = w(e)
            });
            var br = "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),
                xr = "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),
                wr = "Su_Mo_Tu_We_Th_Fr_Sa".split("_"),
                Mr = er,
                Tr = er,
                Sr = er;
            Y("H", ["HH", 2], 0, "hour"), Y("h", ["hh", 2], 0, qe), Y("k", ["kk", 2], 0, Ve), Y("hmm", 0, 0, function() {
                return "" + qe.apply(this) + Z(this.minutes(), 2)
            }), Y("hmmss", 0, 0, function() {
                return "" + qe.apply(this) + Z(this.minutes(), 2) + Z(this.seconds(), 2)
            }), Y("Hmm", 0, 0, function() {
                return "" + this.hours() + Z(this.minutes(), 2)
            }), Y("Hmmss", 0, 0, function() {
                return "" + this.hours() + Z(this.minutes(), 2) + Z(this.seconds(), 2)
            }), Ze("a", !0), Ze("A", !1), B("hour", "h"), H("hour", 13), J("a", Ye), J("A", Ye), J("H", Gn), J("h", Gn), J("HH", Gn, zn), J("hh", Gn, zn), J("hmm", jn), J("hmmss", qn), J("Hmm", jn), J("Hmmss", qn), ne(["H", "HH"], ar), ne(["a", "A"], function(e, t, i) {
                i._isPm = i._locale.isPM(e), i._meridiem = e
            }), ne(["h", "hh"], function(e, t, i) {
                t[ar] = w(e), p(i).bigHour = !0
            }), ne("hmm", function(e, t, i) {
                var n = e.length - 2;
                t[ar] = w(e.substr(0, n)), t[sr] = w(e.substr(n)), p(i).bigHour = !0
            }), ne("hmmss", function(e, t, i) {
                var n = e.length - 4,
                    r = e.length - 2;
                t[ar] = w(e.substr(0, n)), t[sr] = w(e.substr(n, 2)), t[lr] = w(e.substr(r)), p(i).bigHour = !0
            }), ne("Hmm", function(e, t, i) {
                var n = e.length - 2;
                t[ar] = w(e.substr(0, n)), t[sr] = w(e.substr(n))
            }), ne("Hmmss", function(e, t, i) {
                var n = e.length - 4,
                    r = e.length - 2;
                t[ar] = w(e.substr(0, n)), t[sr] = w(e.substr(n, 2)), t[lr] = w(e.substr(r))
            });
            var Cr, Er = /[ap]\.?m?\.?/i,
                kr = W("Hours", !0),
                Lr = {
                    calendar: Cn,
                    longDateFormat: En,
                    invalidDate: kn,
                    ordinal: Ln,
                    ordinalParse: Pn,
                    relativeTime: An,
                    months: pr,
                    monthsShort: mr,
                    week: yr,
                    weekdays: br,
                    weekdaysMin: wr,
                    weekdaysShort: xr,
                    meridiemParse: Er
                },
                Pr = {},
                Ar = {},
                Rr = /^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
                Dr = /^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,
                Ir = /Z|[+-]\d\d(?::?\d\d)?/,
                Or = [
                    ["YYYYYY-MM-DD", /[+-]\d{6}-\d\d-\d\d/],
                    ["YYYY-MM-DD", /\d{4}-\d\d-\d\d/],
                    ["GGGG-[W]WW-E", /\d{4}-W\d\d-\d/],
                    ["GGGG-[W]WW", /\d{4}-W\d\d/, !1],
                    ["YYYY-DDD", /\d{4}-\d{3}/],
                    ["YYYY-MM", /\d{4}-\d\d/, !1],
                    ["YYYYYYMMDD", /[+-]\d{10}/],
                    ["YYYYMMDD", /\d{8}/],
                    ["GGGG[W]WWE", /\d{4}W\d{3}/],
                    ["GGGG[W]WW", /\d{4}W\d{2}/, !1],
                    ["YYYYDDD", /\d{7}/]
                ],
                Nr = [
                    ["HH:mm:ss.SSSS", /\d\d:\d\d:\d\d\.\d+/],
                    ["HH:mm:ss,SSSS", /\d\d:\d\d:\d\d,\d+/],
                    ["HH:mm:ss", /\d\d:\d\d:\d\d/],
                    ["HH:mm", /\d\d:\d\d/],
                    ["HHmmss.SSSS", /\d\d\d\d\d\d\.\d+/],
                    ["HHmmss,SSSS", /\d\d\d\d\d\d,\d+/],
                    ["HHmmss", /\d\d\d\d\d\d/],
                    ["HHmm", /\d\d\d\d/],
                    ["HH", /\d\d/]
                ],
                Br = /^\/?Date\((\-?\d+)/i;
            i.createFromInputFallback = S("value provided is not in a recognized ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.", function(e) {
                e._d = new Date(e._i + (e._useUTC ? " UTC" : ""))
            }), i.ISO_8601 = function() {};
            var Fr = S("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/", function() {
                    var e = bt.apply(null, arguments);
                    return this.isValid() && e.isValid() ? this > e ? this : e : g()
                }),
                zr = S("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/", function() {
                    var e = bt.apply(null, arguments);
                    return this.isValid() && e.isValid() ? e > this ? this : e : g()
                }),
                Hr = function() {
                    return Date.now ? Date.now() : +new Date
                };
            Et("Z", ":"), Et("ZZ", ""), J("Z", Qn), J("ZZ", Qn), ne(["Z", "ZZ"], function(e, t, i) {
                i._useUTC = !0, i._tzm = kt(Qn, e)
            });
            var Ur = /([\+\-]|\d\d)/gi;
            i.updateOffset = function() {};
            var Wr = /^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,
                Gr = /^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;
            Wt.fn = Tt.prototype;
            var jr = Vt(1, "add"),
                qr = Vt(-1, "subtract");
            i.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ", i.defaultFormatUtc = "YYYY-MM-DDTHH:mm:ss[Z]";
            var Vr = S("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.", function(e) {
                return void 0 === e ? this.localeData() : this.locale(e)
            });
            Y(0, ["gg", 2], 0, function() {
                return this.weekYear() % 100
            }), Y(0, ["GG", 2], 0, function() {
                return this.isoWeekYear() % 100
            }), Ei("gggg", "weekYear"), Ei("ggggg", "weekYear"), Ei("GGGG", "isoWeekYear"), Ei("GGGGG", "isoWeekYear"), B("weekYear", "gg"), B("isoWeekYear", "GG"), H("weekYear", 1), H("isoWeekYear", 1), J("G", Xn), J("g", Xn), J("GG", Gn, zn), J("gg", Gn, zn), J("GGGG", Zn, Un), J("gggg", Zn, Un), J("GGGGG", Yn, Wn), J("ggggg", Yn, Wn), re(["gggg", "ggggg", "GGGG", "GGGGG"], function(e, t, i, n) {
                t[n.substr(0, 2)] = w(e)
            }), re(["gg", "GG"], function(e, t, n, r) {
                t[r] = i.parseTwoDigitYear(e)
            }), Y("Q", 0, "Qo", "quarter"), B("quarter", "Q"), H("quarter", 7), J("Q", Fn), ne("Q", function(e, t) {
                t[rr] = 3 * (w(e) - 1)
            }), Y("D", ["DD", 2], "Do", "date"), B("date", "D"), H("date", 9), J("D", Gn), J("DD", Gn, zn), J("Do", function(e, t) {
                return e ? t._ordinalParse : t._ordinalParseLenient
            }), ne(["D", "DD"], or), ne("Do", function(e, t) {
                t[or] = w(e.match(Gn)[0], 10)
            });
            var Zr = W("Date", !0);
            Y("DDD", ["DDDD", 3], "DDDo", "dayOfYear"), B("dayOfYear", "DDD"), H("dayOfYear", 4), J("DDD", Vn), J("DDDD", Hn), ne(["DDD", "DDDD"], function(e, t, i) {
                i._dayOfYear = w(e)
            }), Y("m", ["mm", 2], 0, "minute"), B("minute", "m"), H("minute", 14), J("m", Gn), J("mm", Gn, zn), ne(["m", "mm"], sr);
            var Yr = W("Minutes", !1);
            Y("s", ["ss", 2], 0, "second"), B("second", "s"), H("second", 15), J("s", Gn), J("ss", Gn, zn), ne(["s", "ss"], lr);
            var Kr = W("Seconds", !1);
            Y("S", 0, 0, function() {
                return ~~(this.millisecond() / 100)
            }), Y(0, ["SS", 2], 0, function() {
                return ~~(this.millisecond() / 10)
            }), Y(0, ["SSS", 3], 0, "millisecond"), Y(0, ["SSSS", 4], 0, function() {
                return 10 * this.millisecond()
            }), Y(0, ["SSSSS", 5], 0, function() {
                return 100 * this.millisecond()
            }), Y(0, ["SSSSSS", 6], 0, function() {
                return 1e3 * this.millisecond()
            }), Y(0, ["SSSSSSS", 7], 0, function() {
                return 1e4 * this.millisecond()
            }), Y(0, ["SSSSSSSS", 8], 0, function() {
                return 1e5 * this.millisecond()
            }), Y(0, ["SSSSSSSSS", 9], 0, function() {
                return 1e6 * this.millisecond()
            }), B("millisecond", "ms"), H("millisecond", 16), J("S", Vn, Fn), J("SS", Vn, zn), J("SSS", Vn, Hn);
            var Xr;
            for (Xr = "SSSS"; Xr.length <= 9; Xr += "S") J(Xr, Kn);
            for (Xr = "S"; Xr.length <= 9; Xr += "S") ne(Xr, Ni);
            var $r = W("Milliseconds", !1);
            Y("z", 0, 0, "zoneAbbr"), Y("zz", 0, 0, "zoneName");
            var Qr = y.prototype;
            Qr.add = jr, Qr.calendar = Kt, Qr.clone = Xt, Qr.diff = ni, Qr.endOf = gi, Qr.format = li, Qr.from = hi, Qr.fromNow = ui, Qr.to = di, Qr.toNow = ci, Qr.get = q, Qr.invalidAt = Si, Qr.isAfter = $t, Qr.isBefore = Qt, Qr.isBetween = Jt, Qr.isSame = ei, Qr.isSameOrAfter = ti, Qr.isSameOrBefore = ii, Qr.isValid = Mi, Qr.lang = Vr, Qr.locale = fi, Qr.localeData = pi, Qr.max = zr, Qr.min = Fr, Qr.parsingFlags = Ti, Qr.set = V, Qr.startOf = mi, Qr.subtract = qr, Qr.toArray = bi, Qr.toObject = xi, Qr.toDate = yi, Qr.toISOString = ai, Qr.inspect = si, Qr.toJSON = wi, Qr.toString = oi, Qr.unix = vi, Qr.valueOf = _i, Qr.creationData = Ci, Qr.year = vr, Qr.isLeapYear = ye, Qr.weekYear = ki, Qr.isoWeekYear = Li, Qr.quarter = Qr.quarters = Ii, Qr.month = ce, Qr.daysInMonth = fe, Qr.week = Qr.weeks = Le, Qr.isoWeek = Qr.isoWeeks = Pe, Qr.weeksInYear = Ai, Qr.isoWeeksInYear = Pi, Qr.date = Zr, Qr.day = Qr.days = Fe, Qr.weekday = ze, Qr.isoWeekday = He, Qr.dayOfYear = Oi, Qr.hour = Qr.hours = kr, Qr.minute = Qr.minutes = Yr, Qr.second = Qr.seconds = Kr, Qr.millisecond = Qr.milliseconds = $r, Qr.utcOffset = At, Qr.utc = Dt, Qr.local = It, Qr.parseZone = Ot, Qr.hasAlignedHourOffset = Nt, Qr.isDST = Bt, Qr.isLocal = zt, Qr.isUtcOffset = Ht, Qr.isUtc = Ut, Qr.isUTC = Ut, Qr.zoneAbbr = Bi, Qr.zoneName = Fi, Qr.dates = S("dates accessor is deprecated. Use date instead.", Zr), Qr.months = S("months accessor is deprecated. Use month instead", ce), Qr.years = S("years accessor is deprecated. Use year instead", vr), Qr.zone = S("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/", Rt), Qr.isDSTShifted = S("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information", Ft);
            var Jr = P.prototype;
            Jr.calendar = A, Jr.longDateFormat = R, Jr.invalidDate = D, Jr.ordinal = I, Jr.preparse = Ui, Jr.postformat = Ui, Jr.relativeTime = O, Jr.pastFuture = N, Jr.set = k, Jr.months = se, Jr.monthsShort = le, Jr.monthsParse = ue, Jr.monthsRegex = me, Jr.monthsShortRegex = pe, Jr.week = Ce, Jr.firstDayOfYear = ke, Jr.firstDayOfWeek = Ee, Jr.weekdays = De, Jr.weekdaysMin = Oe, Jr.weekdaysShort = Ie, Jr.weekdaysParse = Be, Jr.weekdaysRegex = Ue, Jr.weekdaysShortRegex = We, Jr.weekdaysMinRegex = Ge, Jr.isPM = Ke, Jr.meridiem = Xe, et("en", {
                ordinalParse: /\d{1,2}(th|st|nd|rd)/,
                ordinal: function(e) {
                    var t = e % 10,
                        i = 1 === w(e % 100 / 10) ? "th" : 1 === t ? "st" : 2 === t ? "nd" : 3 === t ? "rd" : "th";
                    return e + i
                }
            }), i.lang = S("moment.lang is deprecated. Use moment.locale instead.", et), i.langData = S("moment.langData is deprecated. Use moment.localeData instead.", nt);
            var eo = Math.abs,
                to = sn("ms"),
                io = sn("s"),
                no = sn("m"),
                ro = sn("h"),
                oo = sn("d"),
                ao = sn("w"),
                so = sn("M"),
                lo = sn("y"),
                ho = hn("milliseconds"),
                uo = hn("seconds"),
                co = hn("minutes"),
                fo = hn("hours"),
                po = hn("days"),
                mo = hn("months"),
                go = hn("years"),
                _o = Math.round,
                vo = {
                    s: 45,
                    m: 45,
                    h: 22,
                    d: 26,
                    M: 11
                },
                yo = Math.abs,
                bo = Tt.prototype;
            return bo.abs = Xi, bo.add = Qi, bo.subtract = Ji, bo.as = on, bo.asMilliseconds = to, bo.asSeconds = io, bo.asMinutes = no, bo.asHours = ro, bo.asDays = oo, bo.asWeeks = ao, bo.asMonths = so, bo.asYears = lo, bo.valueOf = an, bo._bubble = tn, bo.get = ln, bo.milliseconds = ho, bo.seconds = uo, bo.minutes = co, bo.hours = fo, bo.days = po, bo.weeks = un, bo.months = mo, bo.years = go, bo.humanize = mn, bo.toISOString = gn, bo.toString = gn, bo.toJSON = gn, bo.locale = fi, bo.localeData = pi, bo.toIsoString = S("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)", gn), bo.lang = Vr, Y("X", 0, 0, "unix"), Y("x", 0, 0, "valueOf"), J("x", Xn), J("X", Jn), ne("X", function(e, t, i) {
                i._d = new Date(1e3 * parseFloat(e, 10))
            }), ne("x", function(e, t, i) {
                i._d = new Date(w(e))
            }), i.version = "2.17.1", n(bt), i.fn = Qr, i.min = wt, i.max = Mt, i.now = Hr, i.utc = c, i.unix = zi, i.months = qi, i.isDate = l, i.locale = et, i.invalid = g, i.duration = Wt, i.isMoment = b, i.weekdays = Zi, i.parseZone = Hi, i.localeData = nt, i.isDuration = St, i.monthsShort = Vi, i.weekdaysMin = Ki, i.defineLocale = tt, i.updateLocale = it, i.locales = rt, i.weekdaysShort = Yi, i.normalizeUnits = F, i.relativeTimeRounding = fn, i.relativeTimeThreshold = pn, i.calendarFormat = Yt, i.prototype = Qr, i
        })
    }, {}],
    150: [function(e, t, i) {
        function n(e) {
            if ("[object Array]" === Object.prototype.toString.apply(e)) {
                if ("string" == typeof e[0] && "function" == typeof n[e[0]]) return new n[e[0]](e.slice(1, e.length));
                if (4 === e.length) return new n.RGB(e[0] / 255, e[1] / 255, e[2] / 255, e[3] / 255)
            } else {
                if ("[object Number]" === Object.prototype.toString.apply(e)) {
                    var t = Math.floor(e / 65536),
                        i = Math.floor((e - 65536 * t) / 256),
                        r = e - 65536 * t - 256 * i;
                    return new n.RGB(t / 255, i / 255, r / 255)
                }
                if ("string" == typeof e) {
                    var o = e.toLowerCase();
                    s[o] && (e = "#" + s[o]);
                    var a = e.match(d);
                    if (a) {
                        var h = a[1].toUpperCase(),
                            u = l(a[8]) ? a[8] : parseFloat(a[8]),
                            c = "H" === h[0],
                            f = a[3] ? 100 : c ? 360 : 255,
                            p = a[5] || c ? 100 : 255,
                            m = a[7] || c ? 100 : 255;
                        if (l(n[h])) throw new Error("one.color." + h + " is not installed.");
                        return new n[h](parseFloat(a[2]) / f, parseFloat(a[4]) / p, parseFloat(a[6]) / m, u)
                    }
                    e.length < 6 && (e = e.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i, "$1$1$2$2$3$3"));
                    var g = e.match(/^#?([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i);
                    if (g) return new n.RGB(parseInt(g[1], 16) / 255, parseInt(g[2], 16) / 255, parseInt(g[3], 16) / 255);
                    var _ = e.match(/^([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])$/i);
                    if (_) return new n.RGB(parseInt(_[4], 16) / 255, parseInt(_[3], 16) / 255, parseInt(_[2], 16) / 255, parseInt(_[1], 16) / 255)
                } else {
                    if ("object" == typeof e && e.isColor) return e;
                    if (!isNaN(e)) return new n.RGB((255 & e) / 255, ((65280 & e) >> 8) / 255, ((16711680 & e) >> 16) / 255)
                }
            }
            return !1
        }

        function r(e, t, i) {
            function r(e, t) {
                var i = {};
                i[t.toLowerCase()] = new Function("return this.rgb()." + t.toLowerCase() + "();"), n[t].propertyNames.forEach(function(e, n) {
                    i[e] = i["black" === e ? "k" : e[0]] = new Function("value", "isDelta", "return this." + t.toLowerCase() + "()." + e + "(value, isDelta);");
                });
                for (var r in i) i.hasOwnProperty(r) && void 0 === n[e].prototype[r] && (n[e].prototype[r] = i[r])
            }
            n[e] = new Function(t.join(","), "if (Object.prototype.toString.apply(" + t[0] + ") === '[object Array]') {" + t.map(function(e, i) {
                return e + "=" + t[0] + "[" + i + "];"
            }).reverse().join("") + "}if (" + t.filter(function(e) {
                return "alpha" !== e
            }).map(function(e) {
                return "isNaN(" + e + ")"
            }).join("||") + '){throw new Error("[' + e + ']: Invalid color: ("+' + t.join('+","+') + '+")");}' + t.map(function(e) {
                return "hue" === e ? "this._hue=hue<0?hue-Math.floor(hue):hue%1" : "alpha" === e ? "this._alpha=(isNaN(alpha)||alpha>1)?1:(alpha<0?0:alpha);" : "this._" + e + "=" + e + "<0?0:(" + e + ">1?1:" + e + ")"
            }).join(";") + ";"), n[e].propertyNames = t;
            var o = n[e].prototype;
            ["valueOf", "hex", "hexa", "css", "cssa", "threejs", "toNumber", "kml"].forEach(function(t) {
                o[t] = o[t] || ("RGB" === e ? o.hex : new Function("return this.rgb()." + t + "();"))
            }), o.isColor = !0, o.equals = function(i, n) {
                l(n) && (n = 1e-10), i = i[e.toLowerCase()]();
                for (var r = 0; r < t.length; r += 1)
                    if (Math.abs(this["_" + t[r]] - i["_" + t[r]]) > n) return !1;
                return !0
            }, o.toJSON = new Function("return ['" + e + "', " + t.map(function(e) {
                return "this._" + e
            }, this).join(", ") + "];");
            for (var s in i)
                if (i.hasOwnProperty(s)) {
                    var h = s.match(/^from(.*)$/);
                    h ? n[h[1].toUpperCase()].prototype[e.toLowerCase()] = i[s] : o[s] = i[s]
                }
            o[e.toLowerCase()] = function() {
                return this
            }, o.toString = new Function('return "[one.color.' + e + ':"+' + t.map(function(e, i) {
                return '" ' + t[i] + '="+this._' + e
            }).join("+") + '+"]";'), t.forEach(function(e, i) {
                o[e] = o["black" === e ? "k" : e[0]] = new Function("value", "isDelta", "if (typeof value === 'undefined') {return this._" + e + ";}if (isDelta) {return new this.constructor(" + t.map(function(t, i) {
                    return "this._" + t + (e === t ? "+value" : "")
                }).join(", ") + ");}return new this.constructor(" + t.map(function(t, i) {
                    return e === t ? "value" : "this._" + t
                }).join(", ") + ");")
            }), a.forEach(function(t) {
                r(e, t), r(t, e)
            }), a.push(e)
        }

        function o() {
            var e = this.rgb(),
                t = .3 * e._red + .59 * e._green + .11 * e._blue;
            return new n.RGB(t, t, t, this._alpha)
        }
        var a = [],
            s = {},
            l = function(e) {
                return "undefined" == typeof e
            },
            h = /\s*(\.\d+|\d+(?:\.\d+)?)(%)?\s*/,
            u = /\s*(\.\d+|\d+(?:\.\d+)?)\s*/,
            d = new RegExp("^(rgb|hsl|hsv)a?\\(" + h.source + "," + h.source + "," + h.source + "(?:," + u.source + ")?\\)$", "i");
        n.installMethod = function(e, t) {
            a.forEach(function(i) {
                n[i].prototype[e] = t
            })
        }, r("RGB", ["red", "green", "blue", "alpha"], {
            hex: function() {
                var e = (65536 * Math.round(255 * this._red) + 256 * Math.round(255 * this._green) + Math.round(255 * this._blue)).toString(16);
                return "#" + "00000".substr(0, 6 - e.length) + e
            },
            hexa: function() {
                var e = Math.round(255 * this._alpha).toString(16);
                return "#" + "00".substr(0, 2 - e.length) + e + this.hex().substr(1, 6)
            },
            css: function() {
                return "rgb(" + Math.round(255 * this._red) + "," + Math.round(255 * this._green) + "," + Math.round(255 * this._blue) + ")"
            },
            cssa: function() {
                return "rgba(" + Math.round(255 * this._red) + "," + Math.round(255 * this._green) + "," + Math.round(255 * this._blue) + "," + this._alpha + ")"
            },
            threejs: function() {
                return 65536 * Math.round(255 * this._red) + 256 * Math.round(255 * this._green) + Math.round(255 * this._blue)
            },
            toNumber: function() {
                return 65536 * Math.round(255 * this._red) + 256 * Math.round(255 * this._green) + Math.round(255 * this._blue)
            },
            kml: function() {
                var e = (16777216 * Math.round(255 * this._alpha) + 65536 * Math.round(255 * this._blue) + 256 * Math.round(255 * this._green) + Math.round(255 * this._red)).toString(16);
                return "0000000".substr(0, 8 - e.length) + e
            }
        }), "undefined" != typeof t ? t.exports = n : "function" != typeof define || l(define.amd) ? "undefined" != typeof jQuery && l(jQuery.color) ? jQuery.color = n : (one = window.one || {}, one.color = n) : define([], function() {
            return n
        }), s = {
            aliceblue: "f0f8ff",
            antiquewhite: "faebd7",
            aqua: "0ff",
            aquamarine: "7fffd4",
            azure: "f0ffff",
            beige: "f5f5dc",
            bisque: "ffe4c4",
            black: "000",
            blanchedalmond: "ffebcd",
            blue: "00f",
            blueviolet: "8a2be2",
            brown: "a52a2a",
            burlywood: "deb887",
            cadetblue: "5f9ea0",
            chartreuse: "7fff00",
            chocolate: "d2691e",
            coral: "ff7f50",
            cornflowerblue: "6495ed",
            cornsilk: "fff8dc",
            crimson: "dc143c",
            cyan: "0ff",
            darkblue: "00008b",
            darkcyan: "008b8b",
            darkgoldenrod: "b8860b",
            darkgray: "a9a9a9",
            darkgrey: "a9a9a9",
            darkgreen: "006400",
            darkkhaki: "bdb76b",
            darkmagenta: "8b008b",
            darkolivegreen: "556b2f",
            darkorange: "ff8c00",
            darkorchid: "9932cc",
            darkred: "8b0000",
            darksalmon: "e9967a",
            darkseagreen: "8fbc8f",
            darkslateblue: "483d8b",
            darkslategray: "2f4f4f",
            darkslategrey: "2f4f4f",
            darkturquoise: "00ced1",
            darkviolet: "9400d3",
            deeppink: "ff1493",
            deepskyblue: "00bfff",
            dimgray: "696969",
            dimgrey: "696969",
            dodgerblue: "1e90ff",
            firebrick: "b22222",
            floralwhite: "fffaf0",
            forestgreen: "228b22",
            fuchsia: "f0f",
            gainsboro: "dcdcdc",
            ghostwhite: "f8f8ff",
            gold: "ffd700",
            goldenrod: "daa520",
            gray: "808080",
            grey: "808080",
            green: "008000",
            greenyellow: "adff2f",
            honeydew: "f0fff0",
            hotpink: "ff69b4",
            indianred: "cd5c5c",
            indigo: "4b0082",
            ivory: "fffff0",
            khaki: "f0e68c",
            lavender: "e6e6fa",
            lavenderblush: "fff0f5",
            lawngreen: "7cfc00",
            lemonchiffon: "fffacd",
            lightblue: "add8e6",
            lightcoral: "f08080",
            lightcyan: "e0ffff",
            lightgoldenrodyellow: "fafad2",
            lightgray: "d3d3d3",
            lightgrey: "d3d3d3",
            lightgreen: "90ee90",
            lightpink: "ffb6c1",
            lightsalmon: "ffa07a",
            lightseagreen: "20b2aa",
            lightskyblue: "87cefa",
            lightslategray: "789",
            lightslategrey: "789",
            lightsteelblue: "b0c4de",
            lightyellow: "ffffe0",
            lime: "0f0",
            limegreen: "32cd32",
            linen: "faf0e6",
            magenta: "f0f",
            maroon: "800000",
            mediumaquamarine: "66cdaa",
            mediumblue: "0000cd",
            mediumorchid: "ba55d3",
            mediumpurple: "9370d8",
            mediumseagreen: "3cb371",
            mediumslateblue: "7b68ee",
            mediumspringgreen: "00fa9a",
            mediumturquoise: "48d1cc",
            mediumvioletred: "c71585",
            midnightblue: "191970",
            mintcream: "f5fffa",
            mistyrose: "ffe4e1",
            moccasin: "ffe4b5",
            navajowhite: "ffdead",
            navy: "000080",
            oldlace: "fdf5e6",
            olive: "808000",
            olivedrab: "6b8e23",
            orange: "ffa500",
            orangered: "ff4500",
            orchid: "da70d6",
            palegoldenrod: "eee8aa",
            palegreen: "98fb98",
            paleturquoise: "afeeee",
            palevioletred: "d87093",
            papayawhip: "ffefd5",
            peachpuff: "ffdab9",
            peru: "cd853f",
            pink: "ffc0cb",
            plum: "dda0dd",
            powderblue: "b0e0e6",
            purple: "800080",
            red: "f00",
            rosybrown: "bc8f8f",
            royalblue: "4169e1",
            saddlebrown: "8b4513",
            salmon: "fa8072",
            sandybrown: "f4a460",
            seagreen: "2e8b57",
            seashell: "fff5ee",
            sienna: "a0522d",
            silver: "c0c0c0",
            skyblue: "87ceeb",
            slateblue: "6a5acd",
            slategray: "708090",
            slategrey: "708090",
            snow: "fffafa",
            springgreen: "00ff7f",
            steelblue: "4682b4",
            tan: "d2b48c",
            teal: "008080",
            thistle: "d8bfd8",
            tomato: "ff6347",
            turquoise: "40e0d0",
            violet: "ee82ee",
            wheat: "f5deb3",
            white: "fff",
            whitesmoke: "f5f5f5",
            yellow: "ff0",
            yellowgreen: "9acd32"
        }, r("HSV", ["hue", "saturation", "value", "alpha"], {
            rgb: function() {
                var e, t, i, r = this._hue,
                    o = this._saturation,
                    a = this._value,
                    s = Math.min(5, Math.floor(6 * r)),
                    l = 6 * r - s,
                    h = a * (1 - o),
                    u = a * (1 - l * o),
                    d = a * (1 - (1 - l) * o);
                switch (s) {
                    case 0:
                        e = a, t = d, i = h;
                        break;
                    case 1:
                        e = u, t = a, i = h;
                        break;
                    case 2:
                        e = h, t = a, i = d;
                        break;
                    case 3:
                        e = h, t = u, i = a;
                        break;
                    case 4:
                        e = d, t = h, i = a;
                        break;
                    case 5:
                        e = a, t = h, i = u
                }
                return new n.RGB(e, t, i, this._alpha)
            },
            hsl: function() {
                var e, t = (2 - this._saturation) * this._value,
                    i = this._saturation * this._value,
                    r = 1 >= t ? t : 2 - t;
                return e = 1e-9 > r ? 0 : i / r, new n.HSL(this._hue, e, t / 2, this._alpha)
            },
            fromRgb: function() {
                var e, t = this._red,
                    i = this._green,
                    r = this._blue,
                    o = Math.max(t, i, r),
                    a = Math.min(t, i, r),
                    s = o - a,
                    l = 0 === o ? 0 : s / o,
                    h = o;
                if (0 === s) e = 0;
                else switch (o) {
                    case t:
                        e = (i - r) / s / 6 + (r > i ? 1 : 0);
                        break;
                    case i:
                        e = (r - t) / s / 6 + 1 / 3;
                        break;
                    case r:
                        e = (t - i) / s / 6 + 2 / 3
                }
                return new n.HSV(e, l, h, this._alpha)
            }
        }), r("HSL", ["hue", "saturation", "lightness", "alpha"], {
            hsv: function() {
                var e, t = 2 * this._lightness,
                    i = this._saturation * (1 >= t ? t : 2 - t);
                return e = 1e-9 > t + i ? 0 : 2 * i / (t + i), new n.HSV(this._hue, e, (t + i) / 2, this._alpha)
            },
            rgb: function() {
                return this.hsv().rgb()
            },
            fromRgb: function() {
                return this.hsv().hsl()
            }
        }), r("CMYK", ["cyan", "magenta", "yellow", "black", "alpha"], {
            rgb: function() {
                return new n.RGB(1 - this._cyan * (1 - this._black) - this._black, 1 - this._magenta * (1 - this._black) - this._black, 1 - this._yellow * (1 - this._black) - this._black, this._alpha)
            },
            fromRgb: function() {
                var e = this._red,
                    t = this._green,
                    i = this._blue,
                    r = 1 - e,
                    o = 1 - t,
                    a = 1 - i,
                    s = 1;
                return e || t || i ? (s = Math.min(r, Math.min(o, a)), r = (r - s) / (1 - s), o = (o - s) / (1 - s), a = (a - s) / (1 - s)) : s = 1, new n.CMYK(r, o, a, s, this._alpha)
            }
        }), n.installMethod("clearer", function(e) {
            return this.alpha(isNaN(e) ? -.1 : -e, !0)
        }), n.installMethod("darken", function(e) {
            return this.lightness(isNaN(e) ? -.1 : -e, !0)
        }), n.installMethod("desaturate", function(e) {
            return this.saturation(isNaN(e) ? -.1 : -e, !0)
        }), n.installMethod("greyscale", o), n.installMethod("grayscale", o), n.installMethod("lighten", function(e) {
            return this.lightness(isNaN(e) ? .1 : e, !0)
        }), n.installMethod("mix", function(e, t) {
            e = n(e).rgb(), t = 1 - (isNaN(t) ? .5 : t);
            var i = 2 * t - 1,
                r = this._alpha - e._alpha,
                o = ((i * r === -1 ? i : (i + r) / (1 + i * r)) + 1) / 2,
                a = 1 - o,
                s = this.rgb();
            return new n.RGB(s._red * o + e._red * a, s._green * o + e._green * a, s._blue * o + e._blue * a, s._alpha * t + e._alpha * (1 - t))
        }), n.installMethod("negate", function() {
            var e = this.rgb();
            return new n.RGB(1 - e._red, 1 - e._green, 1 - e._blue, this._alpha)
        }), n.installMethod("opaquer", function(e) {
            return this.alpha(isNaN(e) ? .1 : e, !0)
        }), n.installMethod("rotate", function(e) {
            return this.hue((e || 0) / 360, !0)
        }), n.installMethod("saturate", function(e) {
            return this.saturation(isNaN(e) ? .1 : e, !0)
        }), n.installMethod("toAlpha", function(e) {
            var t = this.rgb(),
                i = n(e).rgb(),
                r = 1e-10,
                o = new n.RGB(0, 0, 0, t._alpha),
                a = ["_red", "_green", "_blue"];
            return a.forEach(function(e) {
                t[e] < r ? o[e] = t[e] : t[e] > i[e] ? o[e] = (t[e] - i[e]) / (1 - i[e]) : t[e] > i[e] ? o[e] = (i[e] - t[e]) / i[e] : o[e] = 0
            }), o._red > o._green ? o._red > o._blue ? t._alpha = o._red : t._alpha = o._blue : o._green > o._blue ? t._alpha = o._green : t._alpha = o._blue, t._alpha < r ? t : (a.forEach(function(e) {
                t[e] = (t[e] - i[e]) / t._alpha + i[e]
            }), t._alpha *= o._alpha, t)
        })
    }, {}],
    151: [function(e, t, i) {
        "use strict";
        var n = e("./lib/utils/common").assign,
            r = e("./lib/deflate"),
            o = e("./lib/inflate"),
            a = e("./lib/zlib/constants"),
            s = {};
        n(s, r, o, a), t.exports = s
    }, {
        "./lib/deflate": 152,
        "./lib/inflate": 153,
        "./lib/utils/common": 154,
        "./lib/zlib/constants": 157
    }],
    152: [function(e, t, i) {
        "use strict";

        function n(e) {
            if (!(this instanceof n)) return new n(e);
            this.options = l.assign({
                level: v,
                method: b,
                chunkSize: 16384,
                windowBits: 15,
                memLevel: 8,
                strategy: y,
                to: ""
            }, e || {});
            var t = this.options;
            t.raw && t.windowBits > 0 ? t.windowBits = -t.windowBits : t.gzip && t.windowBits > 0 && t.windowBits < 16 && (t.windowBits += 16), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new d, this.strm.avail_out = 0;
            var i = s.deflateInit2(this.strm, t.level, t.method, t.windowBits, t.memLevel, t.strategy);
            if (i !== m) throw new Error(u[i]);
            if (t.header && s.deflateSetHeader(this.strm, t.header), t.dictionary) {
                var r;
                if (r = "string" == typeof t.dictionary ? h.string2buf(t.dictionary) : "[object ArrayBuffer]" === c.call(t.dictionary) ? new Uint8Array(t.dictionary) : t.dictionary, i = s.deflateSetDictionary(this.strm, r), i !== m) throw new Error(u[i]);
                this._dict_set = !0
            }
        }

        function r(e, t) {
            var i = new n(t);
            if (i.push(e, !0), i.err) throw i.msg || u[i.err];
            return i.result
        }

        function o(e, t) {
            return t = t || {}, t.raw = !0, r(e, t)
        }

        function a(e, t) {
            return t = t || {}, t.gzip = !0, r(e, t)
        }
        var s = e("./zlib/deflate"),
            l = e("./utils/common"),
            h = e("./utils/strings"),
            u = e("./zlib/messages"),
            d = e("./zlib/zstream"),
            c = Object.prototype.toString,
            f = 0,
            p = 4,
            m = 0,
            g = 1,
            _ = 2,
            v = -1,
            y = 0,
            b = 8;
        n.prototype.push = function(e, t) {
            var i, n, r = this.strm,
                o = this.options.chunkSize;
            if (this.ended) return !1;
            n = t === ~~t ? t : t === !0 ? p : f, "string" == typeof e ? r.input = h.string2buf(e) : "[object ArrayBuffer]" === c.call(e) ? r.input = new Uint8Array(e) : r.input = e, r.next_in = 0, r.avail_in = r.input.length;
            do {
                if (0 === r.avail_out && (r.output = new l.Buf8(o), r.next_out = 0, r.avail_out = o), i = s.deflate(r, n), i !== g && i !== m) return this.onEnd(i), this.ended = !0, !1;
                (0 === r.avail_out || 0 === r.avail_in && (n === p || n === _)) && ("string" === this.options.to ? this.onData(h.buf2binstring(l.shrinkBuf(r.output, r.next_out))) : this.onData(l.shrinkBuf(r.output, r.next_out)))
            } while ((r.avail_in > 0 || 0 === r.avail_out) && i !== g);
            return n === p ? (i = s.deflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === m) : n === _ ? (this.onEnd(m), r.avail_out = 0, !0) : !0
        }, n.prototype.onData = function(e) {
            this.chunks.push(e)
        }, n.prototype.onEnd = function(e) {
            e === m && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = l.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg
        }, i.Deflate = n, i.deflate = r, i.deflateRaw = o, i.gzip = a
    }, {
        "./utils/common": 154,
        "./utils/strings": 155,
        "./zlib/deflate": 159,
        "./zlib/messages": 164,
        "./zlib/zstream": 166
    }],
    153: [function(e, t, i) {
        "use strict";

        function n(e) {
            if (!(this instanceof n)) return new n(e);
            this.options = s.assign({
                chunkSize: 16384,
                windowBits: 0,
                to: ""
            }, e || {});
            var t = this.options;
            t.raw && t.windowBits >= 0 && t.windowBits < 16 && (t.windowBits = -t.windowBits, 0 === t.windowBits && (t.windowBits = -15)), !(t.windowBits >= 0 && t.windowBits < 16) || e && e.windowBits || (t.windowBits += 32), t.windowBits > 15 && t.windowBits < 48 && 0 === (15 & t.windowBits) && (t.windowBits |= 15), this.err = 0, this.msg = "", this.ended = !1, this.chunks = [], this.strm = new d, this.strm.avail_out = 0;
            var i = a.inflateInit2(this.strm, t.windowBits);
            if (i !== h.Z_OK) throw new Error(u[i]);
            this.header = new c, a.inflateGetHeader(this.strm, this.header)
        }

        function r(e, t) {
            var i = new n(t);
            if (i.push(e, !0), i.err) throw i.msg || u[i.err];
            return i.result
        }

        function o(e, t) {
            return t = t || {}, t.raw = !0, r(e, t)
        }
        var a = e("./zlib/inflate"),
            s = e("./utils/common"),
            l = e("./utils/strings"),
            h = e("./zlib/constants"),
            u = e("./zlib/messages"),
            d = e("./zlib/zstream"),
            c = e("./zlib/gzheader"),
            f = Object.prototype.toString;
        n.prototype.push = function(e, t) {
            var i, n, r, o, u, d, c = this.strm,
                p = this.options.chunkSize,
                m = this.options.dictionary,
                g = !1;
            if (this.ended) return !1;
            n = t === ~~t ? t : t === !0 ? h.Z_FINISH : h.Z_NO_FLUSH, "string" == typeof e ? c.input = l.binstring2buf(e) : "[object ArrayBuffer]" === f.call(e) ? c.input = new Uint8Array(e) : c.input = e, c.next_in = 0, c.avail_in = c.input.length;
            do {
                if (0 === c.avail_out && (c.output = new s.Buf8(p), c.next_out = 0, c.avail_out = p), i = a.inflate(c, h.Z_NO_FLUSH), i === h.Z_NEED_DICT && m && (d = "string" == typeof m ? l.string2buf(m) : "[object ArrayBuffer]" === f.call(m) ? new Uint8Array(m) : m, i = a.inflateSetDictionary(this.strm, d)), i === h.Z_BUF_ERROR && g === !0 && (i = h.Z_OK, g = !1), i !== h.Z_STREAM_END && i !== h.Z_OK) return this.onEnd(i), this.ended = !0, !1;
                c.next_out && (0 === c.avail_out || i === h.Z_STREAM_END || 0 === c.avail_in && (n === h.Z_FINISH || n === h.Z_SYNC_FLUSH)) && ("string" === this.options.to ? (r = l.utf8border(c.output, c.next_out), o = c.next_out - r, u = l.buf2string(c.output, r), c.next_out = o, c.avail_out = p - o, o && s.arraySet(c.output, c.output, r, o, 0), this.onData(u)) : this.onData(s.shrinkBuf(c.output, c.next_out))), 0 === c.avail_in && 0 === c.avail_out && (g = !0)
            } while ((c.avail_in > 0 || 0 === c.avail_out) && i !== h.Z_STREAM_END);
            return i === h.Z_STREAM_END && (n = h.Z_FINISH), n === h.Z_FINISH ? (i = a.inflateEnd(this.strm), this.onEnd(i), this.ended = !0, i === h.Z_OK) : n === h.Z_SYNC_FLUSH ? (this.onEnd(h.Z_OK), c.avail_out = 0, !0) : !0
        }, n.prototype.onData = function(e) {
            this.chunks.push(e)
        }, n.prototype.onEnd = function(e) {
            e === h.Z_OK && ("string" === this.options.to ? this.result = this.chunks.join("") : this.result = s.flattenChunks(this.chunks)), this.chunks = [], this.err = e, this.msg = this.strm.msg
        }, i.Inflate = n, i.inflate = r, i.inflateRaw = o, i.ungzip = r
    }, {
        "./utils/common": 154,
        "./utils/strings": 155,
        "./zlib/constants": 157,
        "./zlib/gzheader": 160,
        "./zlib/inflate": 162,
        "./zlib/messages": 164,
        "./zlib/zstream": 166
    }],
    154: [function(e, t, i) {
        "use strict";
        var n = "undefined" != typeof Uint8Array && "undefined" != typeof Uint16Array && "undefined" != typeof Int32Array;
        i.assign = function(e) {
            for (var t = Array.prototype.slice.call(arguments, 1); t.length;) {
                var i = t.shift();
                if (i) {
                    if ("object" != typeof i) throw new TypeError(i + "must be non-object");
                    for (var n in i) i.hasOwnProperty(n) && (e[n] = i[n])
                }
            }
            return e
        }, i.shrinkBuf = function(e, t) {
            return e.length === t ? e : e.subarray ? e.subarray(0, t) : (e.length = t, e)
        };
        var r = {
                arraySet: function(e, t, i, n, r) {
                    if (t.subarray && e.subarray) return void e.set(t.subarray(i, i + n), r);
                    for (var o = 0; n > o; o++) e[r + o] = t[i + o]
                },
                flattenChunks: function(e) {
                    var t, i, n, r, o, a;
                    for (n = 0, t = 0, i = e.length; i > t; t++) n += e[t].length;
                    for (a = new Uint8Array(n), r = 0, t = 0, i = e.length; i > t; t++) o = e[t], a.set(o, r), r += o.length;
                    return a
                }
            },
            o = {
                arraySet: function(e, t, i, n, r) {
                    for (var o = 0; n > o; o++) e[r + o] = t[i + o]
                },
                flattenChunks: function(e) {
                    return [].concat.apply([], e)
                }
            };
        i.setTyped = function(e) {
            e ? (i.Buf8 = Uint8Array, i.Buf16 = Uint16Array, i.Buf32 = Int32Array, i.assign(i, r)) : (i.Buf8 = Array, i.Buf16 = Array, i.Buf32 = Array, i.assign(i, o))
        }, i.setTyped(n)
    }, {}],
    155: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (65537 > t && (e.subarray && a || !e.subarray && o)) return String.fromCharCode.apply(null, r.shrinkBuf(e, t));
            for (var i = "", n = 0; t > n; n++) i += String.fromCharCode(e[n]);
            return i
        }
        var r = e("./common"),
            o = !0,
            a = !0;
        try {
            String.fromCharCode.apply(null, [0])
        } catch (s) {
            o = !1
        }
        try {
            String.fromCharCode.apply(null, new Uint8Array(1))
        } catch (s) {
            a = !1
        }
        for (var l = new r.Buf8(256), h = 0; 256 > h; h++) l[h] = h >= 252 ? 6 : h >= 248 ? 5 : h >= 240 ? 4 : h >= 224 ? 3 : h >= 192 ? 2 : 1;
        l[254] = l[254] = 1, i.string2buf = function(e) {
            var t, i, n, o, a, s = e.length,
                l = 0;
            for (o = 0; s > o; o++) i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (n = e.charCodeAt(o + 1), 56320 === (64512 & n) && (i = 65536 + (i - 55296 << 10) + (n - 56320), o++)), l += 128 > i ? 1 : 2048 > i ? 2 : 65536 > i ? 3 : 4;
            for (t = new r.Buf8(l), a = 0, o = 0; l > a; o++) i = e.charCodeAt(o), 55296 === (64512 & i) && s > o + 1 && (n = e.charCodeAt(o + 1), 56320 === (64512 & n) && (i = 65536 + (i - 55296 << 10) + (n - 56320), o++)), 128 > i ? t[a++] = i : 2048 > i ? (t[a++] = 192 | i >>> 6, t[a++] = 128 | 63 & i) : 65536 > i ? (t[a++] = 224 | i >>> 12, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i) : (t[a++] = 240 | i >>> 18, t[a++] = 128 | i >>> 12 & 63, t[a++] = 128 | i >>> 6 & 63, t[a++] = 128 | 63 & i);
            return t
        }, i.buf2binstring = function(e) {
            return n(e, e.length)
        }, i.binstring2buf = function(e) {
            for (var t = new r.Buf8(e.length), i = 0, n = t.length; n > i; i++) t[i] = e.charCodeAt(i);
            return t
        }, i.buf2string = function(e, t) {
            var i, r, o, a, s = t || e.length,
                h = new Array(2 * s);
            for (r = 0, i = 0; s > i;)
                if (o = e[i++], 128 > o) h[r++] = o;
                else if (a = l[o], a > 4) h[r++] = 65533, i += a - 1;
            else {
                for (o &= 2 === a ? 31 : 3 === a ? 15 : 7; a > 1 && s > i;) o = o << 6 | 63 & e[i++], a--;
                a > 1 ? h[r++] = 65533 : 65536 > o ? h[r++] = o : (o -= 65536, h[r++] = 55296 | o >> 10 & 1023, h[r++] = 56320 | 1023 & o)
            }
            return n(h, r)
        }, i.utf8border = function(e, t) {
            var i;
            for (t = t || e.length, t > e.length && (t = e.length), i = t - 1; i >= 0 && 128 === (192 & e[i]);) i--;
            return 0 > i ? t : 0 === i ? t : i + l[e[i]] > t ? i : t
        }
    }, {
        "./common": 154
    }],
    156: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            for (var r = 65535 & e | 0, o = e >>> 16 & 65535 | 0, a = 0; 0 !== i;) {
                a = i > 2e3 ? 2e3 : i, i -= a;
                do r = r + t[n++] | 0, o = o + r | 0; while (--a);
                r %= 65521, o %= 65521
            }
            return r | o << 16 | 0
        }
        t.exports = n
    }, {}],
    157: [function(e, t, i) {
        "use strict";
        t.exports = {
            Z_NO_FLUSH: 0,
            Z_PARTIAL_FLUSH: 1,
            Z_SYNC_FLUSH: 2,
            Z_FULL_FLUSH: 3,
            Z_FINISH: 4,
            Z_BLOCK: 5,
            Z_TREES: 6,
            Z_OK: 0,
            Z_STREAM_END: 1,
            Z_NEED_DICT: 2,
            Z_ERRNO: -1,
            Z_STREAM_ERROR: -2,
            Z_DATA_ERROR: -3,
            Z_BUF_ERROR: -5,
            Z_NO_COMPRESSION: 0,
            Z_BEST_SPEED: 1,
            Z_BEST_COMPRESSION: 9,
            Z_DEFAULT_COMPRESSION: -1,
            Z_FILTERED: 1,
            Z_HUFFMAN_ONLY: 2,
            Z_RLE: 3,
            Z_FIXED: 4,
            Z_DEFAULT_STRATEGY: 0,
            Z_BINARY: 0,
            Z_TEXT: 1,
            Z_UNKNOWN: 2,
            Z_DEFLATED: 8
        }
    }, {}],
    158: [function(e, t, i) {
        "use strict";

        function n() {
            for (var e, t = [], i = 0; 256 > i; i++) {
                e = i;
                for (var n = 0; 8 > n; n++) e = 1 & e ? 3988292384 ^ e >>> 1 : e >>> 1;
                t[i] = e
            }
            return t
        }

        function r(e, t, i, n) {
            var r = o,
                a = n + i;
            e ^= -1;
            for (var s = n; a > s; s++) e = e >>> 8 ^ r[255 & (e ^ t[s])];
            return -1 ^ e
        }
        var o = n();
        t.exports = r
    }, {}],
    159: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            return e.msg = I[t], t
        }

        function r(e) {
            return (e << 1) - (e > 4 ? 9 : 0)
        }

        function o(e) {
            for (var t = e.length; --t >= 0;) e[t] = 0
        }

        function a(e) {
            var t = e.state,
                i = t.pending;
            i > e.avail_out && (i = e.avail_out), 0 !== i && (P.arraySet(e.output, t.pending_buf, t.pending_out, i, e.next_out), e.next_out += i, t.pending_out += i, e.total_out += i, e.avail_out -= i, t.pending -= i, 0 === t.pending && (t.pending_out = 0))
        }

        function s(e, t) {
            A._tr_flush_block(e, e.block_start >= 0 ? e.block_start : -1, e.strstart - e.block_start, t), e.block_start = e.strstart, a(e.strm)
        }

        function l(e, t) {
            e.pending_buf[e.pending++] = t
        }

        function h(e, t) {
            e.pending_buf[e.pending++] = t >>> 8 & 255, e.pending_buf[e.pending++] = 255 & t
        }

        function u(e, t, i, n) {
            var r = e.avail_in;
            return r > n && (r = n), 0 === r ? 0 : (e.avail_in -= r, P.arraySet(t, e.input, e.next_in, r, i), 1 === e.state.wrap ? e.adler = R(e.adler, t, r, i) : 2 === e.state.wrap && (e.adler = D(e.adler, t, r, i)), e.next_in += r, e.total_in += r, r)
        }

        function d(e, t) {
            var i, n, r = e.max_chain_length,
                o = e.strstart,
                a = e.prev_length,
                s = e.nice_match,
                l = e.strstart > e.w_size - de ? e.strstart - (e.w_size - de) : 0,
                h = e.window,
                u = e.w_mask,
                d = e.prev,
                c = e.strstart + ue,
                f = h[o + a - 1],
                p = h[o + a];
            e.prev_length >= e.good_match && (r >>= 2), s > e.lookahead && (s = e.lookahead);
            do
                if (i = t, h[i + a] === p && h[i + a - 1] === f && h[i] === h[o] && h[++i] === h[o + 1]) {
                    o += 2, i++;
                    do; while (h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && h[++o] === h[++i] && c > o);
                    if (n = ue - (c - o), o = c - ue, n > a) {
                        if (e.match_start = t, a = n, n >= s) break;
                        f = h[o + a - 1], p = h[o + a]
                    }
                }
            while ((t = d[t & u]) > l && 0 !== --r);
            return a <= e.lookahead ? a : e.lookahead
        }

        function c(e) {
            var t, i, n, r, o, a = e.w_size;
            do {
                if (r = e.window_size - e.lookahead - e.strstart, e.strstart >= a + (a - de)) {
                    P.arraySet(e.window, e.window, a, a, 0), e.match_start -= a, e.strstart -= a, e.block_start -= a, i = e.hash_size, t = i;
                    do n = e.head[--t], e.head[t] = n >= a ? n - a : 0; while (--i);
                    i = a, t = i;
                    do n = e.prev[--t], e.prev[t] = n >= a ? n - a : 0; while (--i);
                    r += a
                }
                if (0 === e.strm.avail_in) break;
                if (i = u(e.strm, e.window, e.strstart + e.lookahead, r), e.lookahead += i, e.lookahead + e.insert >= he)
                    for (o = e.strstart - e.insert, e.ins_h = e.window[o], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[o + 1]) & e.hash_mask; e.insert && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[o + he - 1]) & e.hash_mask, e.prev[o & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = o, o++, e.insert--, !(e.lookahead + e.insert < he)););
            } while (e.lookahead < de && 0 !== e.strm.avail_in)
        }

        function f(e, t) {
            var i = 65535;
            for (i > e.pending_buf_size - 5 && (i = e.pending_buf_size - 5);;) {
                if (e.lookahead <= 1) {
                    if (c(e), 0 === e.lookahead && t === O) return be;
                    if (0 === e.lookahead) break
                }
                e.strstart += e.lookahead, e.lookahead = 0;
                var n = e.block_start + i;
                if ((0 === e.strstart || e.strstart >= n) && (e.lookahead = e.strstart - n, e.strstart = n, s(e, !1), 0 === e.strm.avail_out)) return be;
                if (e.strstart - e.block_start >= e.w_size - de && (s(e, !1), 0 === e.strm.avail_out)) return be
            }
            return e.insert = 0, t === F ? (s(e, !0), 0 === e.strm.avail_out ? we : Me) : e.strstart > e.block_start && (s(e, !1), 0 === e.strm.avail_out) ? be : be
        }

        function p(e, t) {
            for (var i, n;;) {
                if (e.lookahead < de) {
                    if (c(e), e.lookahead < de && t === O) return be;
                    if (0 === e.lookahead) break
                }
                if (i = 0, e.lookahead >= he && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + he - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), 0 !== i && e.strstart - i <= e.w_size - de && (e.match_length = d(e, i)), e.match_length >= he)
                    if (n = A._tr_tally(e, e.strstart - e.match_start, e.match_length - he), e.lookahead -= e.match_length, e.match_length <= e.max_lazy_match && e.lookahead >= he) {
                        e.match_length--;
                        do e.strstart++, e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + he - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart; while (0 !== --e.match_length);
                        e.strstart++
                    } else e.strstart += e.match_length, e.match_length = 0, e.ins_h = e.window[e.strstart], e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + 1]) & e.hash_mask;
                else n = A._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++;
                if (n && (s(e, !1), 0 === e.strm.avail_out)) return be
            }
            return e.insert = e.strstart < he - 1 ? e.strstart : he - 1, t === F ? (s(e, !0), 0 === e.strm.avail_out ? we : Me) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? be : xe
        }

        function m(e, t) {
            for (var i, n, r;;) {
                if (e.lookahead < de) {
                    if (c(e), e.lookahead < de && t === O) return be;
                    if (0 === e.lookahead) break
                }
                if (i = 0, e.lookahead >= he && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + he - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart), e.prev_length = e.match_length, e.prev_match = e.match_start, e.match_length = he - 1, 0 !== i && e.prev_length < e.max_lazy_match && e.strstart - i <= e.w_size - de && (e.match_length = d(e, i), e.match_length <= 5 && (e.strategy === V || e.match_length === he && e.strstart - e.match_start > 4096) && (e.match_length = he - 1)), e.prev_length >= he && e.match_length <= e.prev_length) {
                    r = e.strstart + e.lookahead - he, n = A._tr_tally(e, e.strstart - 1 - e.prev_match, e.prev_length - he), e.lookahead -= e.prev_length - 1, e.prev_length -= 2;
                    do ++e.strstart <= r && (e.ins_h = (e.ins_h << e.hash_shift ^ e.window[e.strstart + he - 1]) & e.hash_mask, i = e.prev[e.strstart & e.w_mask] = e.head[e.ins_h], e.head[e.ins_h] = e.strstart); while (0 !== --e.prev_length);
                    if (e.match_available = 0, e.match_length = he - 1, e.strstart++, n && (s(e, !1), 0 === e.strm.avail_out)) return be
                } else if (e.match_available) {
                    if (n = A._tr_tally(e, 0, e.window[e.strstart - 1]), n && s(e, !1), e.strstart++, e.lookahead--, 0 === e.strm.avail_out) return be
                } else e.match_available = 1, e.strstart++, e.lookahead--
            }
            return e.match_available && (n = A._tr_tally(e, 0, e.window[e.strstart - 1]), e.match_available = 0), e.insert = e.strstart < he - 1 ? e.strstart : he - 1, t === F ? (s(e, !0), 0 === e.strm.avail_out ? we : Me) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? be : xe
        }

        function g(e, t) {
            for (var i, n, r, o, a = e.window;;) {
                if (e.lookahead <= ue) {
                    if (c(e), e.lookahead <= ue && t === O) return be;
                    if (0 === e.lookahead) break
                }
                if (e.match_length = 0, e.lookahead >= he && e.strstart > 0 && (r = e.strstart - 1, n = a[r], n === a[++r] && n === a[++r] && n === a[++r])) {
                    o = e.strstart + ue;
                    do; while (n === a[++r] && n === a[++r] && n === a[++r] && n === a[++r] && n === a[++r] && n === a[++r] && n === a[++r] && n === a[++r] && o > r);
                    e.match_length = ue - (o - r), e.match_length > e.lookahead && (e.match_length = e.lookahead)
                }
                if (e.match_length >= he ? (i = A._tr_tally(e, 1, e.match_length - he), e.lookahead -= e.match_length, e.strstart += e.match_length, e.match_length = 0) : (i = A._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++), i && (s(e, !1), 0 === e.strm.avail_out)) return be
            }
            return e.insert = 0, t === F ? (s(e, !0), 0 === e.strm.avail_out ? we : Me) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? be : xe
        }

        function _(e, t) {
            for (var i;;) {
                if (0 === e.lookahead && (c(e), 0 === e.lookahead)) {
                    if (t === O) return be;
                    break
                }
                if (e.match_length = 0, i = A._tr_tally(e, 0, e.window[e.strstart]), e.lookahead--, e.strstart++, i && (s(e, !1), 0 === e.strm.avail_out)) return be
            }
            return e.insert = 0, t === F ? (s(e, !0), 0 === e.strm.avail_out ? we : Me) : e.last_lit && (s(e, !1), 0 === e.strm.avail_out) ? be : xe
        }

        function v(e, t, i, n, r) {
            this.good_length = e, this.max_lazy = t, this.nice_length = i, this.max_chain = n, this.func = r
        }

        function y(e) {
            e.window_size = 2 * e.w_size, o(e.head), e.max_lazy_match = L[e.level].max_lazy, e.good_match = L[e.level].good_length, e.nice_match = L[e.level].nice_length, e.max_chain_length = L[e.level].max_chain, e.strstart = 0, e.block_start = 0, e.lookahead = 0, e.insert = 0, e.match_length = e.prev_length = he - 1, e.match_available = 0, e.ins_h = 0
        }

        function b() {
            this.strm = null, this.status = 0, this.pending_buf = null, this.pending_buf_size = 0, this.pending_out = 0, this.pending = 0, this.wrap = 0, this.gzhead = null, this.gzindex = 0, this.method = Q, this.last_flush = -1, this.w_size = 0, this.w_bits = 0, this.w_mask = 0, this.window = null, this.window_size = 0, this.prev = null, this.head = null, this.ins_h = 0, this.hash_size = 0, this.hash_bits = 0, this.hash_mask = 0, this.hash_shift = 0, this.block_start = 0, this.match_length = 0, this.prev_match = 0, this.match_available = 0, this.strstart = 0, this.match_start = 0, this.lookahead = 0, this.prev_length = 0, this.max_chain_length = 0, this.max_lazy_match = 0, this.level = 0, this.strategy = 0, this.good_match = 0, this.nice_match = 0, this.dyn_ltree = new P.Buf16(2 * se), this.dyn_dtree = new P.Buf16(2 * (2 * oe + 1)), this.bl_tree = new P.Buf16(2 * (2 * ae + 1)), o(this.dyn_ltree), o(this.dyn_dtree), o(this.bl_tree), this.l_desc = null, this.d_desc = null, this.bl_desc = null, this.bl_count = new P.Buf16(le + 1), this.heap = new P.Buf16(2 * re + 1), o(this.heap), this.heap_len = 0, this.heap_max = 0, this.depth = new P.Buf16(2 * re + 1), o(this.depth), this.l_buf = 0, this.lit_bufsize = 0, this.last_lit = 0, this.d_buf = 0, this.opt_len = 0, this.static_len = 0, this.matches = 0, this.insert = 0, this.bi_buf = 0, this.bi_valid = 0
        }

        function x(e) {
            var t;
            return e && e.state ? (e.total_in = e.total_out = 0, e.data_type = $, t = e.state, t.pending = 0, t.pending_out = 0, t.wrap < 0 && (t.wrap = -t.wrap), t.status = t.wrap ? fe : ve, e.adler = 2 === t.wrap ? 0 : 1, t.last_flush = O, A._tr_init(t), H) : n(e, W)
        }

        function w(e) {
            var t = x(e);
            return t === H && y(e.state), t
        }

        function M(e, t) {
            return e && e.state ? 2 !== e.state.wrap ? W : (e.state.gzhead = t, H) : W
        }

        function T(e, t, i, r, o, a) {
            if (!e) return W;
            var s = 1;
            if (t === q && (t = 6), 0 > r ? (s = 0, r = -r) : r > 15 && (s = 2, r -= 16), 1 > o || o > J || i !== Q || 8 > r || r > 15 || 0 > t || t > 9 || 0 > a || a > K) return n(e, W);
            8 === r && (r = 9);
            var l = new b;
            return e.state = l, l.strm = e, l.wrap = s, l.gzhead = null, l.w_bits = r, l.w_size = 1 << l.w_bits, l.w_mask = l.w_size - 1, l.hash_bits = o + 7, l.hash_size = 1 << l.hash_bits, l.hash_mask = l.hash_size - 1, l.hash_shift = ~~((l.hash_bits + he - 1) / he), l.window = new P.Buf8(2 * l.w_size), l.head = new P.Buf16(l.hash_size), l.prev = new P.Buf16(l.w_size), l.lit_bufsize = 1 << o + 6, l.pending_buf_size = 4 * l.lit_bufsize, l.pending_buf = new P.Buf8(l.pending_buf_size), l.d_buf = 1 * l.lit_bufsize, l.l_buf = 3 * l.lit_bufsize, l.level = t, l.strategy = a, l.method = i, w(e)
        }

        function S(e, t) {
            return T(e, t, Q, ee, te, X)
        }

        function C(e, t) {
            var i, s, u, d;
            if (!e || !e.state || t > z || 0 > t) return e ? n(e, W) : W;
            if (s = e.state, !e.output || !e.input && 0 !== e.avail_in || s.status === ye && t !== F) return n(e, 0 === e.avail_out ? j : W);
            if (s.strm = e, i = s.last_flush, s.last_flush = t, s.status === fe)
                if (2 === s.wrap) e.adler = 0, l(s, 31), l(s, 139), l(s, 8), s.gzhead ? (l(s, (s.gzhead.text ? 1 : 0) + (s.gzhead.hcrc ? 2 : 0) + (s.gzhead.extra ? 4 : 0) + (s.gzhead.name ? 8 : 0) + (s.gzhead.comment ? 16 : 0)), l(s, 255 & s.gzhead.time), l(s, s.gzhead.time >> 8 & 255), l(s, s.gzhead.time >> 16 & 255), l(s, s.gzhead.time >> 24 & 255), l(s, 9 === s.level ? 2 : s.strategy >= Z || s.level < 2 ? 4 : 0), l(s, 255 & s.gzhead.os), s.gzhead.extra && s.gzhead.extra.length && (l(s, 255 & s.gzhead.extra.length), l(s, s.gzhead.extra.length >> 8 & 255)), s.gzhead.hcrc && (e.adler = D(e.adler, s.pending_buf, s.pending, 0)), s.gzindex = 0, s.status = pe) : (l(s, 0), l(s, 0), l(s, 0), l(s, 0), l(s, 0), l(s, 9 === s.level ? 2 : s.strategy >= Z || s.level < 2 ? 4 : 0), l(s, Te), s.status = ve);
                else {
                    var c = Q + (s.w_bits - 8 << 4) << 8,
                        f = -1;
                    f = s.strategy >= Z || s.level < 2 ? 0 : s.level < 6 ? 1 : 6 === s.level ? 2 : 3, c |= f << 6, 0 !== s.strstart && (c |= ce), c += 31 - c % 31, s.status = ve, h(s, c), 0 !== s.strstart && (h(s, e.adler >>> 16), h(s, 65535 & e.adler)), e.adler = 1
                }
            if (s.status === pe)
                if (s.gzhead.extra) {
                    for (u = s.pending; s.gzindex < (65535 & s.gzhead.extra.length) && (s.pending !== s.pending_buf_size || (s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending !== s.pending_buf_size));) l(s, 255 & s.gzhead.extra[s.gzindex]), s.gzindex++;
                    s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), s.gzindex === s.gzhead.extra.length && (s.gzindex = 0, s.status = me)
                } else s.status = me;
            if (s.status === me)
                if (s.gzhead.name) {
                    u = s.pending;
                    do {
                        if (s.pending === s.pending_buf_size && (s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending === s.pending_buf_size)) {
                            d = 1;
                            break
                        }
                        d = s.gzindex < s.gzhead.name.length ? 255 & s.gzhead.name.charCodeAt(s.gzindex++) : 0, l(s, d)
                    } while (0 !== d);
                    s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), 0 === d && (s.gzindex = 0, s.status = ge)
                } else s.status = ge;
            if (s.status === ge)
                if (s.gzhead.comment) {
                    u = s.pending;
                    do {
                        if (s.pending === s.pending_buf_size && (s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), a(e), u = s.pending, s.pending === s.pending_buf_size)) {
                            d = 1;
                            break
                        }
                        d = s.gzindex < s.gzhead.comment.length ? 255 & s.gzhead.comment.charCodeAt(s.gzindex++) : 0, l(s, d)
                    } while (0 !== d);
                    s.gzhead.hcrc && s.pending > u && (e.adler = D(e.adler, s.pending_buf, s.pending - u, u)), 0 === d && (s.status = _e)
                } else s.status = _e;
            if (s.status === _e && (s.gzhead.hcrc ? (s.pending + 2 > s.pending_buf_size && a(e), s.pending + 2 <= s.pending_buf_size && (l(s, 255 & e.adler), l(s, e.adler >> 8 & 255), e.adler = 0, s.status = ve)) : s.status = ve), 0 !== s.pending) {
                if (a(e), 0 === e.avail_out) return s.last_flush = -1, H
            } else if (0 === e.avail_in && r(t) <= r(i) && t !== F) return n(e, j);
            if (s.status === ye && 0 !== e.avail_in) return n(e, j);
            if (0 !== e.avail_in || 0 !== s.lookahead || t !== O && s.status !== ye) {
                var p = s.strategy === Z ? _(s, t) : s.strategy === Y ? g(s, t) : L[s.level].func(s, t);
                if ((p === we || p === Me) && (s.status = ye), p === be || p === we) return 0 === e.avail_out && (s.last_flush = -1), H;
                if (p === xe && (t === N ? A._tr_align(s) : t !== z && (A._tr_stored_block(s, 0, 0, !1), t === B && (o(s.head), 0 === s.lookahead && (s.strstart = 0, s.block_start = 0, s.insert = 0))), a(e), 0 === e.avail_out)) return s.last_flush = -1, H
            }
            return t !== F ? H : s.wrap <= 0 ? U : (2 === s.wrap ? (l(s, 255 & e.adler), l(s, e.adler >> 8 & 255), l(s, e.adler >> 16 & 255), l(s, e.adler >> 24 & 255), l(s, 255 & e.total_in), l(s, e.total_in >> 8 & 255), l(s, e.total_in >> 16 & 255), l(s, e.total_in >> 24 & 255)) : (h(s, e.adler >>> 16), h(s, 65535 & e.adler)), a(e), s.wrap > 0 && (s.wrap = -s.wrap), 0 !== s.pending ? H : U)
        }

        function E(e) {
            var t;
            return e && e.state ? (t = e.state.status, t !== fe && t !== pe && t !== me && t !== ge && t !== _e && t !== ve && t !== ye ? n(e, W) : (e.state = null, t === ve ? n(e, G) : H)) : W
        }

        function k(e, t) {
            var i, n, r, a, s, l, h, u, d = t.length;
            if (!e || !e.state) return W;
            if (i = e.state, a = i.wrap, 2 === a || 1 === a && i.status !== fe || i.lookahead) return W;
            for (1 === a && (e.adler = R(e.adler, t, d, 0)), i.wrap = 0, d >= i.w_size && (0 === a && (o(i.head), i.strstart = 0, i.block_start = 0, i.insert = 0), u = new P.Buf8(i.w_size), P.arraySet(u, t, d - i.w_size, i.w_size, 0), t = u, d = i.w_size), s = e.avail_in, l = e.next_in, h = e.input, e.avail_in = d, e.next_in = 0, e.input = t, c(i); i.lookahead >= he;) {
                n = i.strstart, r = i.lookahead - (he - 1);
                do i.ins_h = (i.ins_h << i.hash_shift ^ i.window[n + he - 1]) & i.hash_mask, i.prev[n & i.w_mask] = i.head[i.ins_h], i.head[i.ins_h] = n, n++; while (--r);
                i.strstart = n, i.lookahead = he - 1, c(i)
            }
            return i.strstart += i.lookahead, i.block_start = i.strstart, i.insert = i.lookahead, i.lookahead = 0, i.match_length = i.prev_length = he - 1, i.match_available = 0, e.next_in = l, e.input = h,
                e.avail_in = s, i.wrap = a, H
        }
        var L, P = e("../utils/common"),
            A = e("./trees"),
            R = e("./adler32"),
            D = e("./crc32"),
            I = e("./messages"),
            O = 0,
            N = 1,
            B = 3,
            F = 4,
            z = 5,
            H = 0,
            U = 1,
            W = -2,
            G = -3,
            j = -5,
            q = -1,
            V = 1,
            Z = 2,
            Y = 3,
            K = 4,
            X = 0,
            $ = 2,
            Q = 8,
            J = 9,
            ee = 15,
            te = 8,
            ie = 29,
            ne = 256,
            re = ne + 1 + ie,
            oe = 30,
            ae = 19,
            se = 2 * re + 1,
            le = 15,
            he = 3,
            ue = 258,
            de = ue + he + 1,
            ce = 32,
            fe = 42,
            pe = 69,
            me = 73,
            ge = 91,
            _e = 103,
            ve = 113,
            ye = 666,
            be = 1,
            xe = 2,
            we = 3,
            Me = 4,
            Te = 3;
        L = [new v(0, 0, 0, 0, f), new v(4, 4, 8, 4, p), new v(4, 5, 16, 8, p), new v(4, 6, 32, 32, p), new v(4, 4, 16, 16, m), new v(8, 16, 32, 32, m), new v(8, 16, 128, 128, m), new v(8, 32, 128, 256, m), new v(32, 128, 258, 1024, m), new v(32, 258, 258, 4096, m)], i.deflateInit = S, i.deflateInit2 = T, i.deflateReset = w, i.deflateResetKeep = x, i.deflateSetHeader = M, i.deflate = C, i.deflateEnd = E, i.deflateSetDictionary = k, i.deflateInfo = "pako deflate (from Nodeca project)"
    }, {
        "../utils/common": 154,
        "./adler32": 156,
        "./crc32": 158,
        "./messages": 164,
        "./trees": 165
    }],
    160: [function(e, t, i) {
        "use strict";

        function n() {
            this.text = 0, this.time = 0, this.xflags = 0, this.os = 0, this.extra = null, this.extra_len = 0, this.name = "", this.comment = "", this.hcrc = 0, this.done = !1
        }
        t.exports = n
    }, {}],
    161: [function(e, t, i) {
        "use strict";
        var n = 30,
            r = 12;
        t.exports = function(e, t) {
            var i, o, a, s, l, h, u, d, c, f, p, m, g, _, v, y, b, x, w, M, T, S, C, E, k;
            i = e.state, o = e.next_in, E = e.input, a = o + (e.avail_in - 5), s = e.next_out, k = e.output, l = s - (t - e.avail_out), h = s + (e.avail_out - 257), u = i.dmax, d = i.wsize, c = i.whave, f = i.wnext, p = i.window, m = i.hold, g = i.bits, _ = i.lencode, v = i.distcode, y = (1 << i.lenbits) - 1, b = (1 << i.distbits) - 1;
            e: do {
                15 > g && (m += E[o++] << g, g += 8, m += E[o++] << g, g += 8), x = _[m & y];
                t: for (;;) {
                    if (w = x >>> 24, m >>>= w, g -= w, w = x >>> 16 & 255, 0 === w) k[s++] = 65535 & x;
                    else {
                        if (!(16 & w)) {
                            if (0 === (64 & w)) {
                                x = _[(65535 & x) + (m & (1 << w) - 1)];
                                continue t
                            }
                            if (32 & w) {
                                i.mode = r;
                                break e
                            }
                            e.msg = "invalid literal/length code", i.mode = n;
                            break e
                        }
                        M = 65535 & x, w &= 15, w && (w > g && (m += E[o++] << g, g += 8), M += m & (1 << w) - 1, m >>>= w, g -= w), 15 > g && (m += E[o++] << g, g += 8, m += E[o++] << g, g += 8), x = v[m & b];
                        i: for (;;) {
                            if (w = x >>> 24, m >>>= w, g -= w, w = x >>> 16 & 255, !(16 & w)) {
                                if (0 === (64 & w)) {
                                    x = v[(65535 & x) + (m & (1 << w) - 1)];
                                    continue i
                                }
                                e.msg = "invalid distance code", i.mode = n;
                                break e
                            }
                            if (T = 65535 & x, w &= 15, w > g && (m += E[o++] << g, g += 8, w > g && (m += E[o++] << g, g += 8)), T += m & (1 << w) - 1, T > u) {
                                e.msg = "invalid distance too far back", i.mode = n;
                                break e
                            }
                            if (m >>>= w, g -= w, w = s - l, T > w) {
                                if (w = T - w, w > c && i.sane) {
                                    e.msg = "invalid distance too far back", i.mode = n;
                                    break e
                                }
                                if (S = 0, C = p, 0 === f) {
                                    if (S += d - w, M > w) {
                                        M -= w;
                                        do k[s++] = p[S++]; while (--w);
                                        S = s - T, C = k
                                    }
                                } else if (w > f) {
                                    if (S += d + f - w, w -= f, M > w) {
                                        M -= w;
                                        do k[s++] = p[S++]; while (--w);
                                        if (S = 0, M > f) {
                                            w = f, M -= w;
                                            do k[s++] = p[S++]; while (--w);
                                            S = s - T, C = k
                                        }
                                    }
                                } else if (S += f - w, M > w) {
                                    M -= w;
                                    do k[s++] = p[S++]; while (--w);
                                    S = s - T, C = k
                                }
                                for (; M > 2;) k[s++] = C[S++], k[s++] = C[S++], k[s++] = C[S++], M -= 3;
                                M && (k[s++] = C[S++], M > 1 && (k[s++] = C[S++]))
                            } else {
                                S = s - T;
                                do k[s++] = k[S++], k[s++] = k[S++], k[s++] = k[S++], M -= 3; while (M > 2);
                                M && (k[s++] = k[S++], M > 1 && (k[s++] = k[S++]))
                            }
                            break
                        }
                    }
                    break
                }
            } while (a > o && h > s);
            M = g >> 3, o -= M, g -= M << 3, m &= (1 << g) - 1, e.next_in = o, e.next_out = s, e.avail_in = a > o ? 5 + (a - o) : 5 - (o - a), e.avail_out = h > s ? 257 + (h - s) : 257 - (s - h), i.hold = m, i.bits = g
        }
    }, {}],
    162: [function(e, t, i) {
        "use strict";

        function n(e) {
            return (e >>> 24 & 255) + (e >>> 8 & 65280) + ((65280 & e) << 8) + ((255 & e) << 24)
        }

        function r() {
            this.mode = 0, this.last = !1, this.wrap = 0, this.havedict = !1, this.flags = 0, this.dmax = 0, this.check = 0, this.total = 0, this.head = null, this.wbits = 0, this.wsize = 0, this.whave = 0, this.wnext = 0, this.window = null, this.hold = 0, this.bits = 0, this.length = 0, this.offset = 0, this.extra = 0, this.lencode = null, this.distcode = null, this.lenbits = 0, this.distbits = 0, this.ncode = 0, this.nlen = 0, this.ndist = 0, this.have = 0, this.next = null, this.lens = new v.Buf16(320), this.work = new v.Buf16(288), this.lendyn = null, this.distdyn = null, this.sane = 0, this.back = 0, this.was = 0
        }

        function o(e) {
            var t;
            return e && e.state ? (t = e.state, e.total_in = e.total_out = t.total = 0, e.msg = "", t.wrap && (e.adler = 1 & t.wrap), t.mode = B, t.last = 0, t.havedict = 0, t.dmax = 32768, t.head = null, t.hold = 0, t.bits = 0, t.lencode = t.lendyn = new v.Buf32(me), t.distcode = t.distdyn = new v.Buf32(ge), t.sane = 1, t.back = -1, L) : R
        }

        function a(e) {
            var t;
            return e && e.state ? (t = e.state, t.wsize = 0, t.whave = 0, t.wnext = 0, o(e)) : R
        }

        function s(e, t) {
            var i, n;
            return e && e.state ? (n = e.state, 0 > t ? (i = 0, t = -t) : (i = (t >> 4) + 1, 48 > t && (t &= 15)), t && (8 > t || t > 15) ? R : (null !== n.window && n.wbits !== t && (n.window = null), n.wrap = i, n.wbits = t, a(e))) : R
        }

        function l(e, t) {
            var i, n;
            return e ? (n = new r, e.state = n, n.window = null, i = s(e, t), i !== L && (e.state = null), i) : R
        }

        function h(e) {
            return l(e, ve)
        }

        function u(e) {
            if (ye) {
                var t;
                for (g = new v.Buf32(512), _ = new v.Buf32(32), t = 0; 144 > t;) e.lens[t++] = 8;
                for (; 256 > t;) e.lens[t++] = 9;
                for (; 280 > t;) e.lens[t++] = 7;
                for (; 288 > t;) e.lens[t++] = 8;
                for (w(T, e.lens, 0, 288, g, 0, e.work, {
                        bits: 9
                    }), t = 0; 32 > t;) e.lens[t++] = 5;
                w(S, e.lens, 0, 32, _, 0, e.work, {
                    bits: 5
                }), ye = !1
            }
            e.lencode = g, e.lenbits = 9, e.distcode = _, e.distbits = 5
        }

        function d(e, t, i, n) {
            var r, o = e.state;
            return null === o.window && (o.wsize = 1 << o.wbits, o.wnext = 0, o.whave = 0, o.window = new v.Buf8(o.wsize)), n >= o.wsize ? (v.arraySet(o.window, t, i - o.wsize, o.wsize, 0), o.wnext = 0, o.whave = o.wsize) : (r = o.wsize - o.wnext, r > n && (r = n), v.arraySet(o.window, t, i - n, r, o.wnext), n -= r, n ? (v.arraySet(o.window, t, i - n, n, 0), o.wnext = n, o.whave = o.wsize) : (o.wnext += r, o.wnext === o.wsize && (o.wnext = 0), o.whave < o.wsize && (o.whave += r))), 0
        }

        function c(e, t) {
            var i, r, o, a, s, l, h, c, f, p, m, g, _, me, ge, _e, ve, ye, be, xe, we, Me, Te, Se, Ce = 0,
                Ee = new v.Buf8(4),
                ke = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15];
            if (!e || !e.state || !e.output || !e.input && 0 !== e.avail_in) return R;
            i = e.state, i.mode === Y && (i.mode = K), s = e.next_out, o = e.output, h = e.avail_out, a = e.next_in, r = e.input, l = e.avail_in, c = i.hold, f = i.bits, p = l, m = h, Me = L;
            e: for (;;) switch (i.mode) {
                case B:
                    if (0 === i.wrap) {
                        i.mode = K;
                        break
                    }
                    for (; 16 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if (2 & i.wrap && 35615 === c) {
                        i.check = 0, Ee[0] = 255 & c, Ee[1] = c >>> 8 & 255, i.check = b(i.check, Ee, 2, 0), c = 0, f = 0, i.mode = F;
                        break
                    }
                    if (i.flags = 0, i.head && (i.head.done = !1), !(1 & i.wrap) || (((255 & c) << 8) + (c >> 8)) % 31) {
                        e.msg = "incorrect header check", i.mode = ce;
                        break
                    }
                    if ((15 & c) !== N) {
                        e.msg = "unknown compression method", i.mode = ce;
                        break
                    }
                    if (c >>>= 4, f -= 4, we = (15 & c) + 8, 0 === i.wbits) i.wbits = we;
                    else if (we > i.wbits) {
                        e.msg = "invalid window size", i.mode = ce;
                        break
                    }
                    i.dmax = 1 << we, e.adler = i.check = 1, i.mode = 512 & c ? V : Y, c = 0, f = 0;
                    break;
                case F:
                    for (; 16 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if (i.flags = c, (255 & i.flags) !== N) {
                        e.msg = "unknown compression method", i.mode = ce;
                        break
                    }
                    if (57344 & i.flags) {
                        e.msg = "unknown header flags set", i.mode = ce;
                        break
                    }
                    i.head && (i.head.text = c >> 8 & 1), 512 & i.flags && (Ee[0] = 255 & c, Ee[1] = c >>> 8 & 255, i.check = b(i.check, Ee, 2, 0)), c = 0, f = 0, i.mode = z;
                case z:
                    for (; 32 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    i.head && (i.head.time = c), 512 & i.flags && (Ee[0] = 255 & c, Ee[1] = c >>> 8 & 255, Ee[2] = c >>> 16 & 255, Ee[3] = c >>> 24 & 255, i.check = b(i.check, Ee, 4, 0)), c = 0, f = 0, i.mode = H;
                case H:
                    for (; 16 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    i.head && (i.head.xflags = 255 & c, i.head.os = c >> 8), 512 & i.flags && (Ee[0] = 255 & c, Ee[1] = c >>> 8 & 255, i.check = b(i.check, Ee, 2, 0)), c = 0, f = 0, i.mode = U;
                case U:
                    if (1024 & i.flags) {
                        for (; 16 > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        i.length = c, i.head && (i.head.extra_len = c), 512 & i.flags && (Ee[0] = 255 & c, Ee[1] = c >>> 8 & 255, i.check = b(i.check, Ee, 2, 0)), c = 0, f = 0
                    } else i.head && (i.head.extra = null);
                    i.mode = W;
                case W:
                    if (1024 & i.flags && (g = i.length, g > l && (g = l), g && (i.head && (we = i.head.extra_len - i.length, i.head.extra || (i.head.extra = new Array(i.head.extra_len)), v.arraySet(i.head.extra, r, a, g, we)), 512 & i.flags && (i.check = b(i.check, r, g, a)), l -= g, a += g, i.length -= g), i.length)) break e;
                    i.length = 0, i.mode = G;
                case G:
                    if (2048 & i.flags) {
                        if (0 === l) break e;
                        g = 0;
                        do we = r[a + g++], i.head && we && i.length < 65536 && (i.head.name += String.fromCharCode(we)); while (we && l > g);
                        if (512 & i.flags && (i.check = b(i.check, r, g, a)), l -= g, a += g, we) break e
                    } else i.head && (i.head.name = null);
                    i.length = 0, i.mode = j;
                case j:
                    if (4096 & i.flags) {
                        if (0 === l) break e;
                        g = 0;
                        do we = r[a + g++], i.head && we && i.length < 65536 && (i.head.comment += String.fromCharCode(we)); while (we && l > g);
                        if (512 & i.flags && (i.check = b(i.check, r, g, a)), l -= g, a += g, we) break e
                    } else i.head && (i.head.comment = null);
                    i.mode = q;
                case q:
                    if (512 & i.flags) {
                        for (; 16 > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        if (c !== (65535 & i.check)) {
                            e.msg = "header crc mismatch", i.mode = ce;
                            break
                        }
                        c = 0, f = 0
                    }
                    i.head && (i.head.hcrc = i.flags >> 9 & 1, i.head.done = !0), e.adler = i.check = 0, i.mode = Y;
                    break;
                case V:
                    for (; 32 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    e.adler = i.check = n(c), c = 0, f = 0, i.mode = Z;
                case Z:
                    if (0 === i.havedict) return e.next_out = s, e.avail_out = h, e.next_in = a, e.avail_in = l, i.hold = c, i.bits = f, A;
                    e.adler = i.check = 1, i.mode = Y;
                case Y:
                    if (t === E || t === k) break e;
                case K:
                    if (i.last) {
                        c >>>= 7 & f, f -= 7 & f, i.mode = he;
                        break
                    }
                    for (; 3 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    switch (i.last = 1 & c, c >>>= 1, f -= 1, 3 & c) {
                        case 0:
                            i.mode = X;
                            break;
                        case 1:
                            if (u(i), i.mode = ie, t === k) {
                                c >>>= 2, f -= 2;
                                break e
                            }
                            break;
                        case 2:
                            i.mode = J;
                            break;
                        case 3:
                            e.msg = "invalid block type", i.mode = ce
                    }
                    c >>>= 2, f -= 2;
                    break;
                case X:
                    for (c >>>= 7 & f, f -= 7 & f; 32 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if ((65535 & c) !== (c >>> 16 ^ 65535)) {
                        e.msg = "invalid stored block lengths", i.mode = ce;
                        break
                    }
                    if (i.length = 65535 & c, c = 0, f = 0, i.mode = $, t === k) break e;
                case $:
                    i.mode = Q;
                case Q:
                    if (g = i.length) {
                        if (g > l && (g = l), g > h && (g = h), 0 === g) break e;
                        v.arraySet(o, r, a, g, s), l -= g, a += g, h -= g, s += g, i.length -= g;
                        break
                    }
                    i.mode = Y;
                    break;
                case J:
                    for (; 14 > f;) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if (i.nlen = (31 & c) + 257, c >>>= 5, f -= 5, i.ndist = (31 & c) + 1, c >>>= 5, f -= 5, i.ncode = (15 & c) + 4, c >>>= 4, f -= 4, i.nlen > 286 || i.ndist > 30) {
                        e.msg = "too many length or distance symbols", i.mode = ce;
                        break
                    }
                    i.have = 0, i.mode = ee;
                case ee:
                    for (; i.have < i.ncode;) {
                        for (; 3 > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        i.lens[ke[i.have++]] = 7 & c, c >>>= 3, f -= 3
                    }
                    for (; i.have < 19;) i.lens[ke[i.have++]] = 0;
                    if (i.lencode = i.lendyn, i.lenbits = 7, Te = {
                            bits: i.lenbits
                        }, Me = w(M, i.lens, 0, 19, i.lencode, 0, i.work, Te), i.lenbits = Te.bits, Me) {
                        e.msg = "invalid code lengths set", i.mode = ce;
                        break
                    }
                    i.have = 0, i.mode = te;
                case te:
                    for (; i.have < i.nlen + i.ndist;) {
                        for (; Ce = i.lencode[c & (1 << i.lenbits) - 1], ge = Ce >>> 24, _e = Ce >>> 16 & 255, ve = 65535 & Ce, !(f >= ge);) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        if (16 > ve) c >>>= ge, f -= ge, i.lens[i.have++] = ve;
                        else {
                            if (16 === ve) {
                                for (Se = ge + 2; Se > f;) {
                                    if (0 === l) break e;
                                    l--, c += r[a++] << f, f += 8
                                }
                                if (c >>>= ge, f -= ge, 0 === i.have) {
                                    e.msg = "invalid bit length repeat", i.mode = ce;
                                    break
                                }
                                we = i.lens[i.have - 1], g = 3 + (3 & c), c >>>= 2, f -= 2
                            } else if (17 === ve) {
                                for (Se = ge + 3; Se > f;) {
                                    if (0 === l) break e;
                                    l--, c += r[a++] << f, f += 8
                                }
                                c >>>= ge, f -= ge, we = 0, g = 3 + (7 & c), c >>>= 3, f -= 3
                            } else {
                                for (Se = ge + 7; Se > f;) {
                                    if (0 === l) break e;
                                    l--, c += r[a++] << f, f += 8
                                }
                                c >>>= ge, f -= ge, we = 0, g = 11 + (127 & c), c >>>= 7, f -= 7
                            }
                            if (i.have + g > i.nlen + i.ndist) {
                                e.msg = "invalid bit length repeat", i.mode = ce;
                                break
                            }
                            for (; g--;) i.lens[i.have++] = we
                        }
                    }
                    if (i.mode === ce) break;
                    if (0 === i.lens[256]) {
                        e.msg = "invalid code -- missing end-of-block", i.mode = ce;
                        break
                    }
                    if (i.lenbits = 9, Te = {
                            bits: i.lenbits
                        }, Me = w(T, i.lens, 0, i.nlen, i.lencode, 0, i.work, Te), i.lenbits = Te.bits, Me) {
                        e.msg = "invalid literal/lengths set", i.mode = ce;
                        break
                    }
                    if (i.distbits = 6, i.distcode = i.distdyn, Te = {
                            bits: i.distbits
                        }, Me = w(S, i.lens, i.nlen, i.ndist, i.distcode, 0, i.work, Te), i.distbits = Te.bits, Me) {
                        e.msg = "invalid distances set", i.mode = ce;
                        break
                    }
                    if (i.mode = ie, t === k) break e;
                case ie:
                    i.mode = ne;
                case ne:
                    if (l >= 6 && h >= 258) {
                        e.next_out = s, e.avail_out = h, e.next_in = a, e.avail_in = l, i.hold = c, i.bits = f, x(e, m), s = e.next_out, o = e.output, h = e.avail_out, a = e.next_in, r = e.input, l = e.avail_in, c = i.hold, f = i.bits, i.mode === Y && (i.back = -1);
                        break
                    }
                    for (i.back = 0; Ce = i.lencode[c & (1 << i.lenbits) - 1], ge = Ce >>> 24, _e = Ce >>> 16 & 255, ve = 65535 & Ce, !(f >= ge);) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if (_e && 0 === (240 & _e)) {
                        for (ye = ge, be = _e, xe = ve; Ce = i.lencode[xe + ((c & (1 << ye + be) - 1) >> ye)], ge = Ce >>> 24, _e = Ce >>> 16 & 255, ve = 65535 & Ce, !(f >= ye + ge);) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        c >>>= ye, f -= ye, i.back += ye
                    }
                    if (c >>>= ge, f -= ge, i.back += ge, i.length = ve, 0 === _e) {
                        i.mode = le;
                        break
                    }
                    if (32 & _e) {
                        i.back = -1, i.mode = Y;
                        break
                    }
                    if (64 & _e) {
                        e.msg = "invalid literal/length code", i.mode = ce;
                        break
                    }
                    i.extra = 15 & _e, i.mode = re;
                case re:
                    if (i.extra) {
                        for (Se = i.extra; Se > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        i.length += c & (1 << i.extra) - 1, c >>>= i.extra, f -= i.extra, i.back += i.extra
                    }
                    i.was = i.length, i.mode = oe;
                case oe:
                    for (; Ce = i.distcode[c & (1 << i.distbits) - 1], ge = Ce >>> 24, _e = Ce >>> 16 & 255, ve = 65535 & Ce, !(f >= ge);) {
                        if (0 === l) break e;
                        l--, c += r[a++] << f, f += 8
                    }
                    if (0 === (240 & _e)) {
                        for (ye = ge, be = _e, xe = ve; Ce = i.distcode[xe + ((c & (1 << ye + be) - 1) >> ye)], ge = Ce >>> 24, _e = Ce >>> 16 & 255, ve = 65535 & Ce, !(f >= ye + ge);) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        c >>>= ye, f -= ye, i.back += ye
                    }
                    if (c >>>= ge, f -= ge, i.back += ge, 64 & _e) {
                        e.msg = "invalid distance code", i.mode = ce;
                        break
                    }
                    i.offset = ve, i.extra = 15 & _e, i.mode = ae;
                case ae:
                    if (i.extra) {
                        for (Se = i.extra; Se > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        i.offset += c & (1 << i.extra) - 1, c >>>= i.extra, f -= i.extra, i.back += i.extra
                    }
                    if (i.offset > i.dmax) {
                        e.msg = "invalid distance too far back", i.mode = ce;
                        break
                    }
                    i.mode = se;
                case se:
                    if (0 === h) break e;
                    if (g = m - h, i.offset > g) {
                        if (g = i.offset - g, g > i.whave && i.sane) {
                            e.msg = "invalid distance too far back", i.mode = ce;
                            break
                        }
                        g > i.wnext ? (g -= i.wnext, _ = i.wsize - g) : _ = i.wnext - g, g > i.length && (g = i.length), me = i.window
                    } else me = o, _ = s - i.offset, g = i.length;
                    g > h && (g = h), h -= g, i.length -= g;
                    do o[s++] = me[_++]; while (--g);
                    0 === i.length && (i.mode = ne);
                    break;
                case le:
                    if (0 === h) break e;
                    o[s++] = i.length, h--, i.mode = ne;
                    break;
                case he:
                    if (i.wrap) {
                        for (; 32 > f;) {
                            if (0 === l) break e;
                            l--, c |= r[a++] << f, f += 8
                        }
                        if (m -= h, e.total_out += m, i.total += m, m && (e.adler = i.check = i.flags ? b(i.check, o, m, s - m) : y(i.check, o, m, s - m)), m = h, (i.flags ? c : n(c)) !== i.check) {
                            e.msg = "incorrect data check", i.mode = ce;
                            break
                        }
                        c = 0, f = 0
                    }
                    i.mode = ue;
                case ue:
                    if (i.wrap && i.flags) {
                        for (; 32 > f;) {
                            if (0 === l) break e;
                            l--, c += r[a++] << f, f += 8
                        }
                        if (c !== (4294967295 & i.total)) {
                            e.msg = "incorrect length check", i.mode = ce;
                            break
                        }
                        c = 0, f = 0
                    }
                    i.mode = de;
                case de:
                    Me = P;
                    break e;
                case ce:
                    Me = D;
                    break e;
                case fe:
                    return I;
                case pe:
                default:
                    return R
            }
            return e.next_out = s, e.avail_out = h, e.next_in = a, e.avail_in = l, i.hold = c, i.bits = f, (i.wsize || m !== e.avail_out && i.mode < ce && (i.mode < he || t !== C)) && d(e, e.output, e.next_out, m - e.avail_out) ? (i.mode = fe, I) : (p -= e.avail_in, m -= e.avail_out, e.total_in += p, e.total_out += m, i.total += m, i.wrap && m && (e.adler = i.check = i.flags ? b(i.check, o, m, e.next_out - m) : y(i.check, o, m, e.next_out - m)), e.data_type = i.bits + (i.last ? 64 : 0) + (i.mode === Y ? 128 : 0) + (i.mode === ie || i.mode === $ ? 256 : 0), (0 === p && 0 === m || t === C) && Me === L && (Me = O), Me)
        }

        function f(e) {
            if (!e || !e.state) return R;
            var t = e.state;
            return t.window && (t.window = null), e.state = null, L
        }

        function p(e, t) {
            var i;
            return e && e.state ? (i = e.state, 0 === (2 & i.wrap) ? R : (i.head = t, t.done = !1, L)) : R
        }

        function m(e, t) {
            var i, n, r, o = t.length;
            return e && e.state ? (i = e.state, 0 !== i.wrap && i.mode !== Z ? R : i.mode === Z && (n = 1, n = y(n, t, o, 0), n !== i.check) ? D : (r = d(e, t, o, o)) ? (i.mode = fe, I) : (i.havedict = 1, L)) : R
        }
        var g, _, v = e("../utils/common"),
            y = e("./adler32"),
            b = e("./crc32"),
            x = e("./inffast"),
            w = e("./inftrees"),
            M = 0,
            T = 1,
            S = 2,
            C = 4,
            E = 5,
            k = 6,
            L = 0,
            P = 1,
            A = 2,
            R = -2,
            D = -3,
            I = -4,
            O = -5,
            N = 8,
            B = 1,
            F = 2,
            z = 3,
            H = 4,
            U = 5,
            W = 6,
            G = 7,
            j = 8,
            q = 9,
            V = 10,
            Z = 11,
            Y = 12,
            K = 13,
            X = 14,
            $ = 15,
            Q = 16,
            J = 17,
            ee = 18,
            te = 19,
            ie = 20,
            ne = 21,
            re = 22,
            oe = 23,
            ae = 24,
            se = 25,
            le = 26,
            he = 27,
            ue = 28,
            de = 29,
            ce = 30,
            fe = 31,
            pe = 32,
            me = 852,
            ge = 592,
            _e = 15,
            ve = _e,
            ye = !0;
        i.inflateReset = a, i.inflateReset2 = s, i.inflateResetKeep = o, i.inflateInit = h, i.inflateInit2 = l, i.inflate = c, i.inflateEnd = f, i.inflateGetHeader = p, i.inflateSetDictionary = m, i.inflateInfo = "pako inflate (from Nodeca project)"
    }, {
        "../utils/common": 154,
        "./adler32": 156,
        "./crc32": 158,
        "./inffast": 161,
        "./inftrees": 163
    }],
    163: [function(e, t, i) {
        "use strict";
        var n = e("../utils/common"),
            r = 15,
            o = 852,
            a = 592,
            s = 0,
            l = 1,
            h = 2,
            u = [3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 19, 23, 27, 31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 0, 0],
            d = [16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 18, 18, 18, 18, 19, 19, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 16, 72, 78],
            c = [1, 2, 3, 4, 5, 7, 9, 13, 17, 25, 33, 49, 65, 97, 129, 193, 257, 385, 513, 769, 1025, 1537, 2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 0, 0],
            f = [16, 16, 16, 16, 17, 17, 18, 18, 19, 19, 20, 20, 21, 21, 22, 22, 23, 23, 24, 24, 25, 25, 26, 26, 27, 27, 28, 28, 29, 29, 64, 64];
        t.exports = function(e, t, i, p, m, g, _, v) {
            var y, b, x, w, M, T, S, C, E, k = v.bits,
                L = 0,
                P = 0,
                A = 0,
                R = 0,
                D = 0,
                I = 0,
                O = 0,
                N = 0,
                B = 0,
                F = 0,
                z = null,
                H = 0,
                U = new n.Buf16(r + 1),
                W = new n.Buf16(r + 1),
                G = null,
                j = 0;
            for (L = 0; r >= L; L++) U[L] = 0;
            for (P = 0; p > P; P++) U[t[i + P]]++;
            for (D = k, R = r; R >= 1 && 0 === U[R]; R--);
            if (D > R && (D = R), 0 === R) return m[g++] = 20971520, m[g++] = 20971520, v.bits = 1, 0;
            for (A = 1; R > A && 0 === U[A]; A++);
            for (A > D && (D = A), N = 1, L = 1; r >= L; L++)
                if (N <<= 1, N -= U[L], 0 > N) return -1;
            if (N > 0 && (e === s || 1 !== R)) return -1;
            for (W[1] = 0, L = 1; r > L; L++) W[L + 1] = W[L] + U[L];
            for (P = 0; p > P; P++) 0 !== t[i + P] && (_[W[t[i + P]]++] = P);
            if (e === s ? (z = G = _, T = 19) : e === l ? (z = u, H -= 257, G = d, j -= 257, T = 256) : (z = c, G = f, T = -1), F = 0, P = 0, L = A, M = g, I = D, O = 0, x = -1, B = 1 << D, w = B - 1, e === l && B > o || e === h && B > a) return 1;
            for (;;) {
                S = L - O, _[P] < T ? (C = 0, E = _[P]) : _[P] > T ? (C = G[j + _[P]], E = z[H + _[P]]) : (C = 96, E = 0), y = 1 << L - O, b = 1 << I, A = b;
                do b -= y, m[M + (F >> O) + b] = S << 24 | C << 16 | E | 0; while (0 !== b);
                for (y = 1 << L - 1; F & y;) y >>= 1;
                if (0 !== y ? (F &= y - 1, F += y) : F = 0, P++, 0 === --U[L]) {
                    if (L === R) break;
                    L = t[i + _[P]]
                }
                if (L > D && (F & w) !== x) {
                    for (0 === O && (O = D), M += A, I = L - O, N = 1 << I; R > I + O && (N -= U[I + O], !(0 >= N));) I++, N <<= 1;
                    if (B += 1 << I, e === l && B > o || e === h && B > a) return 1;
                    x = F & w, m[x] = D << 24 | I << 16 | M - g | 0
                }
            }
            return 0 !== F && (m[M + F] = L - O << 24 | 64 << 16 | 0), v.bits = D, 0
        }
    }, {
        "../utils/common": 154
    }],
    164: [function(e, t, i) {
        "use strict";
        t.exports = {
            2: "need dictionary",
            1: "stream end",
            0: "",
            "-1": "file error",
            "-2": "stream error",
            "-3": "data error",
            "-4": "insufficient memory",
            "-5": "buffer error",
            "-6": "incompatible version"
        }
    }, {}],
    165: [function(e, t, i) {
        "use strict";

        function n(e) {
            for (var t = e.length; --t >= 0;) e[t] = 0
        }

        function r(e, t, i, n, r) {
            this.static_tree = e, this.extra_bits = t, this.extra_base = i, this.elems = n, this.max_length = r, this.has_stree = e && e.length
        }

        function o(e, t) {
            this.dyn_tree = e, this.max_code = 0, this.stat_desc = t
        }

        function a(e) {
            return 256 > e ? le[e] : le[256 + (e >>> 7)]
        }

        function s(e, t) {
            e.pending_buf[e.pending++] = 255 & t, e.pending_buf[e.pending++] = t >>> 8 & 255
        }

        function l(e, t, i) {
            e.bi_valid > K - i ? (e.bi_buf |= t << e.bi_valid & 65535, s(e, e.bi_buf), e.bi_buf = t >> K - e.bi_valid, e.bi_valid += i - K) : (e.bi_buf |= t << e.bi_valid & 65535, e.bi_valid += i)
        }

        function h(e, t, i) {
            l(e, i[2 * t], i[2 * t + 1])
        }

        function u(e, t) {
            var i = 0;
            do i |= 1 & e, e >>>= 1, i <<= 1; while (--t > 0);
            return i >>> 1
        }

        function d(e) {
            16 === e.bi_valid ? (s(e, e.bi_buf), e.bi_buf = 0, e.bi_valid = 0) : e.bi_valid >= 8 && (e.pending_buf[e.pending++] = 255 & e.bi_buf, e.bi_buf >>= 8, e.bi_valid -= 8)
        }

        function c(e, t) {
            var i, n, r, o, a, s, l = t.dyn_tree,
                h = t.max_code,
                u = t.stat_desc.static_tree,
                d = t.stat_desc.has_stree,
                c = t.stat_desc.extra_bits,
                f = t.stat_desc.extra_base,
                p = t.stat_desc.max_length,
                m = 0;
            for (o = 0; Y >= o; o++) e.bl_count[o] = 0;
            for (l[2 * e.heap[e.heap_max] + 1] = 0, i = e.heap_max + 1; Z > i; i++) n = e.heap[i], o = l[2 * l[2 * n + 1] + 1] + 1, o > p && (o = p, m++), l[2 * n + 1] = o, n > h || (e.bl_count[o]++, a = 0, n >= f && (a = c[n - f]), s = l[2 * n], e.opt_len += s * (o + a), d && (e.static_len += s * (u[2 * n + 1] + a)));
            if (0 !== m) {
                do {
                    for (o = p - 1; 0 === e.bl_count[o];) o--;
                    e.bl_count[o]--, e.bl_count[o + 1] += 2, e.bl_count[p]--, m -= 2
                } while (m > 0);
                for (o = p; 0 !== o; o--)
                    for (n = e.bl_count[o]; 0 !== n;) r = e.heap[--i], r > h || (l[2 * r + 1] !== o && (e.opt_len += (o - l[2 * r + 1]) * l[2 * r], l[2 * r + 1] = o), n--)
            }
        }

        function f(e, t, i) {
            var n, r, o = new Array(Y + 1),
                a = 0;
            for (n = 1; Y >= n; n++) o[n] = a = a + i[n - 1] << 1;
            for (r = 0; t >= r; r++) {
                var s = e[2 * r + 1];
                0 !== s && (e[2 * r] = u(o[s]++, s))
            }
        }

        function p() {
            var e, t, i, n, o, a = new Array(Y + 1);
            for (i = 0, n = 0; W - 1 > n; n++)
                for (ue[n] = i, e = 0; e < 1 << te[n]; e++) he[i++] = n;
            for (he[i - 1] = n, o = 0, n = 0; 16 > n; n++)
                for (de[n] = o, e = 0; e < 1 << ie[n]; e++) le[o++] = n;
            for (o >>= 7; q > n; n++)
                for (de[n] = o << 7, e = 0; e < 1 << ie[n] - 7; e++) le[256 + o++] = n;
            for (t = 0; Y >= t; t++) a[t] = 0;
            for (e = 0; 143 >= e;) ae[2 * e + 1] = 8, e++, a[8]++;
            for (; 255 >= e;) ae[2 * e + 1] = 9, e++, a[9]++;
            for (; 279 >= e;) ae[2 * e + 1] = 7, e++, a[7]++;
            for (; 287 >= e;) ae[2 * e + 1] = 8, e++, a[8]++;
            for (f(ae, j + 1, a), e = 0; q > e; e++) se[2 * e + 1] = 5, se[2 * e] = u(e, 5);
            ce = new r(ae, te, G + 1, j, Y), fe = new r(se, ie, 0, q, Y), pe = new r(new Array(0), ne, 0, V, X)
        }

        function m(e) {
            var t;
            for (t = 0; j > t; t++) e.dyn_ltree[2 * t] = 0;
            for (t = 0; q > t; t++) e.dyn_dtree[2 * t] = 0;
            for (t = 0; V > t; t++) e.bl_tree[2 * t] = 0;
            e.dyn_ltree[2 * $] = 1, e.opt_len = e.static_len = 0, e.last_lit = e.matches = 0
        }

        function g(e) {
            e.bi_valid > 8 ? s(e, e.bi_buf) : e.bi_valid > 0 && (e.pending_buf[e.pending++] = e.bi_buf), e.bi_buf = 0, e.bi_valid = 0
        }

        function _(e, t, i, n) {
            g(e), n && (s(e, i), s(e, ~i)), R.arraySet(e.pending_buf, e.window, t, i, e.pending), e.pending += i
        }

        function v(e, t, i, n) {
            var r = 2 * t,
                o = 2 * i;
            return e[r] < e[o] || e[r] === e[o] && n[t] <= n[i]
        }

        function y(e, t, i) {
            for (var n = e.heap[i], r = i << 1; r <= e.heap_len && (r < e.heap_len && v(t, e.heap[r + 1], e.heap[r], e.depth) && r++, !v(t, n, e.heap[r], e.depth));) e.heap[i] = e.heap[r], i = r, r <<= 1;
            e.heap[i] = n
        }

        function b(e, t, i) {
            var n, r, o, s, u = 0;
            if (0 !== e.last_lit)
                do n = e.pending_buf[e.d_buf + 2 * u] << 8 | e.pending_buf[e.d_buf + 2 * u + 1], r = e.pending_buf[e.l_buf + u], u++, 0 === n ? h(e, r, t) : (o = he[r], h(e, o + G + 1, t), s = te[o], 0 !== s && (r -= ue[o], l(e, r, s)), n--, o = a(n), h(e, o, i), s = ie[o], 0 !== s && (n -= de[o], l(e, n, s))); while (u < e.last_lit);
            h(e, $, t)
        }

        function x(e, t) {
            var i, n, r, o = t.dyn_tree,
                a = t.stat_desc.static_tree,
                s = t.stat_desc.has_stree,
                l = t.stat_desc.elems,
                h = -1;
            for (e.heap_len = 0, e.heap_max = Z, i = 0; l > i; i++) 0 !== o[2 * i] ? (e.heap[++e.heap_len] = h = i, e.depth[i] = 0) : o[2 * i + 1] = 0;
            for (; e.heap_len < 2;) r = e.heap[++e.heap_len] = 2 > h ? ++h : 0, o[2 * r] = 1, e.depth[r] = 0, e.opt_len--, s && (e.static_len -= a[2 * r + 1]);
            for (t.max_code = h, i = e.heap_len >> 1; i >= 1; i--) y(e, o, i);
            r = l;
            do i = e.heap[1], e.heap[1] = e.heap[e.heap_len--], y(e, o, 1), n = e.heap[1], e.heap[--e.heap_max] = i, e.heap[--e.heap_max] = n, o[2 * r] = o[2 * i] + o[2 * n], e.depth[r] = (e.depth[i] >= e.depth[n] ? e.depth[i] : e.depth[n]) + 1, o[2 * i + 1] = o[2 * n + 1] = r, e.heap[1] = r++, y(e, o, 1); while (e.heap_len >= 2);
            e.heap[--e.heap_max] = e.heap[1], c(e, t), f(o, h, e.bl_count)
        }

        function w(e, t, i) {
            var n, r, o = -1,
                a = t[1],
                s = 0,
                l = 7,
                h = 4;
            for (0 === a && (l = 138, h = 3), t[2 * (i + 1) + 1] = 65535, n = 0; i >= n; n++) r = a, a = t[2 * (n + 1) + 1], ++s < l && r === a || (h > s ? e.bl_tree[2 * r] += s : 0 !== r ? (r !== o && e.bl_tree[2 * r]++, e.bl_tree[2 * Q]++) : 10 >= s ? e.bl_tree[2 * J]++ : e.bl_tree[2 * ee]++, s = 0, o = r, 0 === a ? (l = 138, h = 3) : r === a ? (l = 6, h = 3) : (l = 7, h = 4))
        }

        function M(e, t, i) {
            var n, r, o = -1,
                a = t[1],
                s = 0,
                u = 7,
                d = 4;
            for (0 === a && (u = 138, d = 3), n = 0; i >= n; n++)
                if (r = a, a = t[2 * (n + 1) + 1], !(++s < u && r === a)) {
                    if (d > s) {
                        do h(e, r, e.bl_tree); while (0 !== --s)
                    } else 0 !== r ? (r !== o && (h(e, r, e.bl_tree), s--), h(e, Q, e.bl_tree), l(e, s - 3, 2)) : 10 >= s ? (h(e, J, e.bl_tree), l(e, s - 3, 3)) : (h(e, ee, e.bl_tree), l(e, s - 11, 7));
                    s = 0, o = r, 0 === a ? (u = 138, d = 3) : r === a ? (u = 6, d = 3) : (u = 7, d = 4)
                }
        }

        function T(e) {
            var t;
            for (w(e, e.dyn_ltree, e.l_desc.max_code), w(e, e.dyn_dtree, e.d_desc.max_code), x(e, e.bl_desc), t = V - 1; t >= 3 && 0 === e.bl_tree[2 * re[t] + 1]; t--);
            return e.opt_len += 3 * (t + 1) + 5 + 5 + 4, t
        }

        function S(e, t, i, n) {
            var r;
            for (l(e, t - 257, 5), l(e, i - 1, 5), l(e, n - 4, 4), r = 0; n > r; r++) l(e, e.bl_tree[2 * re[r] + 1], 3);
            M(e, e.dyn_ltree, t - 1), M(e, e.dyn_dtree, i - 1)
        }

        function C(e) {
            var t, i = 4093624447;
            for (t = 0; 31 >= t; t++, i >>>= 1)
                if (1 & i && 0 !== e.dyn_ltree[2 * t]) return I;
            if (0 !== e.dyn_ltree[18] || 0 !== e.dyn_ltree[20] || 0 !== e.dyn_ltree[26]) return O;
            for (t = 32; G > t; t++)
                if (0 !== e.dyn_ltree[2 * t]) return O;
            return I
        }

        function E(e) {
            me || (p(), me = !0), e.l_desc = new o(e.dyn_ltree, ce), e.d_desc = new o(e.dyn_dtree, fe), e.bl_desc = new o(e.bl_tree, pe), e.bi_buf = 0, e.bi_valid = 0, m(e)
        }

        function k(e, t, i, n) {
            l(e, (B << 1) + (n ? 1 : 0), 3), _(e, t, i, !0)
        }

        function L(e) {
            l(e, F << 1, 3), h(e, $, ae), d(e)
        }

        function P(e, t, i, n) {
            var r, o, a = 0;
            e.level > 0 ? (e.strm.data_type === N && (e.strm.data_type = C(e)), x(e, e.l_desc), x(e, e.d_desc), a = T(e), r = e.opt_len + 3 + 7 >>> 3, o = e.static_len + 3 + 7 >>> 3, r >= o && (r = o)) : r = o = i + 5, r >= i + 4 && -1 !== t ? k(e, t, i, n) : e.strategy === D || o === r ? (l(e, (F << 1) + (n ? 1 : 0), 3), b(e, ae, se)) : (l(e, (z << 1) + (n ? 1 : 0), 3), S(e, e.l_desc.max_code + 1, e.d_desc.max_code + 1, a + 1), b(e, e.dyn_ltree, e.dyn_dtree)), m(e), n && g(e)
        }

        function A(e, t, i) {
            return e.pending_buf[e.d_buf + 2 * e.last_lit] = t >>> 8 & 255, e.pending_buf[e.d_buf + 2 * e.last_lit + 1] = 255 & t, e.pending_buf[e.l_buf + e.last_lit] = 255 & i, e.last_lit++, 0 === t ? e.dyn_ltree[2 * i]++ : (e.matches++, t--, e.dyn_ltree[2 * (he[i] + G + 1)]++, e.dyn_dtree[2 * a(t)]++), e.last_lit === e.lit_bufsize - 1
        }
        var R = e("../utils/common"),
            D = 4,
            I = 0,
            O = 1,
            N = 2,
            B = 0,
            F = 1,
            z = 2,
            H = 3,
            U = 258,
            W = 29,
            G = 256,
            j = G + 1 + W,
            q = 30,
            V = 19,
            Z = 2 * j + 1,
            Y = 15,
            K = 16,
            X = 7,
            $ = 256,
            Q = 16,
            J = 17,
            ee = 18,
            te = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0],
            ie = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13],
            ne = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7],
            re = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15],
            oe = 512,
            ae = new Array(2 * (j + 2));
        n(ae);
        var se = new Array(2 * q);
        n(se);
        var le = new Array(oe);
        n(le);
        var he = new Array(U - H + 1);
        n(he);
        var ue = new Array(W);
        n(ue);
        var de = new Array(q);
        n(de);
        var ce, fe, pe, me = !1;
        i._tr_init = E, i._tr_stored_block = k, i._tr_flush_block = P, i._tr_tally = A, i._tr_align = L
    }, {
        "../utils/common": 154
    }],
    166: [function(e, t, i) {
        "use strict";

        function n() {
            this.input = null, this.next_in = 0, this.avail_in = 0, this.total_in = 0, this.output = null, this.next_out = 0, this.avail_out = 0, this.total_out = 0, this.msg = "", this.state = null, this.data_type = 2, this.adler = 0
        }
        t.exports = n
    }, {}],
    167: [function(e, t, i) {
        function n(e) {
            var t = new Int32Array(e, 0, _);
            if (t[v] !== a) throw new Error("Invalid magic number in DDS header");
            if (!t[T] & l) throw new Error("Unsupported format, must contain a FourCC code");
            var i, n, r = t[S];
            switch (r) {
                case h:
                    i = 8, n = "dxt1";
                    break;
                case u:
                    i = 16, n = "dxt3";
                    break;
                case d:
                    i = 16, n = "dxt5";
                    break;
                case f:
                    n = "rgba32f";
                    break;
                case c:
                    var E = new Uint32Array(e.slice(128, 148));
                    n = E[0];
                    var k = E[1];
                    E[2], E[3], E[4];
                    if (k !== m || n !== g) throw new Error("Unsupported DX10 texture format " + n);
                    n = "rgba32f";
                    break;
                default:
                    throw new Error("Unsupported FourCC code: " + o(r))
            }
            var L = t[b],
                P = 1;
            L & s && (P = Math.max(1, t[M]));
            var A = !1,
                R = t[C];
            R & p && (A = !0);
            var D, I = t[w],
                O = t[x],
                N = t[y] + 4,
                B = I,
                F = O,
                z = [];
            if (r === c && (N += 20), A)
                for (var H = 0; 6 > H; H++) {
                    if ("rgba32f" !== n) throw new Error("Only RGBA32f cubemaps are supported");
                    var U = 16;
                    I = B, O = F;
                    for (var W = Math.log(I) / Math.log(2) + 1, G = 0; W > G; G++) D = I * O * U, z.push({
                        offset: N,
                        length: D,
                        shape: [I, O]
                    }), P > G && (N += D), I = Math.floor(I / 2), O = Math.floor(O / 2)
                } else
                    for (var G = 0; P > G; G++) D = Math.max(4, I) / 4 * Math.max(4, O) / 4 * i, z.push({
                        offset: N,
                        length: D,
                        shape: [I, O]
                    }), N += D, I = Math.floor(I / 2), O = Math.floor(O / 2);
            return {
                shape: [B, F],
                images: z,
                format: n,
                flags: L,
                cubemap: A
            }
        }

        function r(e) {
            return e.charCodeAt(0) + (e.charCodeAt(1) << 8) + (e.charCodeAt(2) << 16) + (e.charCodeAt(3) << 24)
        }

        function o(e) {
            return String.fromCharCode(255 & e, e >> 8 & 255, e >> 16 & 255, e >> 24 & 255)
        }
        var a = 542327876,
            s = 131072,
            l = 4,
            h = r("DXT1"),
            u = r("DXT3"),
            d = r("DXT5"),
            c = r("DX10"),
            f = 116,
            p = 512,
            m = 3,
            g = 2,
            _ = 31,
            v = 0,
            y = 1,
            b = 2,
            x = 3,
            w = 4,
            M = 7,
            T = 20,
            S = 21,
            C = 28;
        t.exports = n
    }, {}],
    168: [function(e, t, i) {
        t.exports = {
            version: "1.4.1"
        }
    }, {}],
    169: [function(e, t, i) {
        "use strict";
        var n = function(e, t) {
                this.point = e, this.triangle = t || null, this.next = null, this.prev = null, this.value = e.x
            },
            r = function(e, t) {
                this.head_ = e, this.tail_ = t, this.search_node_ = e
            };
        r.prototype.head = function() {
            return this.head_
        }, r.prototype.setHead = function(e) {
            this.head_ = e
        }, r.prototype.tail = function() {
            return this.tail_
        }, r.prototype.setTail = function(e) {
            this.tail_ = e
        }, r.prototype.search = function() {
            return this.search_node_
        }, r.prototype.setSearch = function(e) {
            this.search_node_ = e
        }, r.prototype.findSearchNode = function() {
            return this.search_node_
        }, r.prototype.locateNode = function(e) {
            var t = this.search_node_;
            if (e < t.value) {
                for (; t = t.prev;)
                    if (e >= t.value) return this.search_node_ = t, t
            } else
                for (; t = t.next;)
                    if (e < t.value) return this.search_node_ = t.prev, t.prev;
            return null
        }, r.prototype.locatePoint = function(e) {
            var t = e.x,
                i = this.findSearchNode(t),
                n = i.point.x;
            if (t === n) {
                if (e !== i.point)
                    if (e === i.prev.point) i = i.prev;
                    else {
                        if (e !== i.next.point) throw new Error("poly2tri Invalid AdvancingFront.locatePoint() call");
                        i = i.next
                    }
            } else if (n > t)
                for (;
                    (i = i.prev) && e !== i.point;);
            else
                for (;
                    (i = i.next) && e !== i.point;);
            return i && (this.search_node_ = i), i
        }, t.exports = r, t.exports.Node = n
    }, {}],
    170: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (!e) throw new Error(t || "Assert Failed")
        }
        t.exports = n
    }, {}],
    171: [function(e, t, i) {
        "use strict";
        var n = e("./xy"),
            r = function(e, t) {
                this.x = +e || 0, this.y = +t || 0, this._p2t_edge_list = null
            };
        r.prototype.toString = function() {
            return n.toStringBase(this)
        }, r.prototype.toJSON = function() {
            return {
                x: this.x,
                y: this.y
            }
        }, r.prototype.clone = function() {
            return new r(this.x, this.y)
        }, r.prototype.set_zero = function() {
            return this.x = 0, this.y = 0, this
        }, r.prototype.set = function(e, t) {
            return this.x = +e || 0, this.y = +t || 0, this
        }, r.prototype.negate = function() {
            return this.x = -this.x, this.y = -this.y, this
        }, r.prototype.add = function(e) {
            return this.x += e.x, this.y += e.y, this
        }, r.prototype.sub = function(e) {
            return this.x -= e.x, this.y -= e.y, this
        }, r.prototype.mul = function(e) {
            return this.x *= e, this.y *= e, this
        }, r.prototype.length = function() {
            return Math.sqrt(this.x * this.x + this.y * this.y)
        }, r.prototype.normalize = function() {
            var e = this.length();
            return this.x /= e, this.y /= e, e
        }, r.prototype.equals = function(e) {
            return this.x === e.x && this.y === e.y
        }, r.negate = function(e) {
            return new r(-e.x, -e.y)
        }, r.add = function(e, t) {
            return new r(e.x + t.x, e.y + t.y)
        }, r.sub = function(e, t) {
            return new r(e.x - t.x, e.y - t.y)
        }, r.mul = function(e, t) {
            return new r(e * t.x, e * t.y)
        }, r.cross = function(e, t) {
            return "number" == typeof e ? "number" == typeof t ? e * t : new r(-e * t.y, e * t.x) : "number" == typeof t ? new r(t * e.y, -t * e.x) : e.x * t.y - e.y * t.x
        }, r.toString = n.toString, r.compare = n.compare, r.cmp = n.compare, r.equals = n.equals, r.dot = function(e, t) {
            return e.x * t.x + e.y * t.y
        }, t.exports = r
    }, {
        "./xy": 178
    }],
    172: [function(e, t, i) {
        "use strict";
        var n = e("./xy"),
            r = function(e, t) {
                this.name = "PointError", this.points = t = t || [], this.message = e || "Invalid Points!";
                for (var i = 0; i < t.length; i++) this.message += " " + n.toString(t[i])
            };
        r.prototype = new Error, r.prototype.constructor = r, t.exports = r
    }, {
        "./xy": 178
    }],
    173: [function(e, t, i) {
        (function(t) {
            "use strict";
            var n = t.poly2tri;
            i.noConflict = function() {
                return t.poly2tri = n, i
            }, i.VERSION = e("../dist/version.json").version, i.PointError = e("./pointerror"), i.Point = e("./point"), i.Triangle = e("./triangle"), i.SweepContext = e("./sweepcontext");
            var r = e("./sweep");
            i.triangulate = r.triangulate, i.sweep = {
                Triangulate: r.triangulate
            }
        }).call(this, window)
    }, {
        "../dist/version.json": 168,
        "./point": 171,
        "./pointerror": 172,
        "./sweep": 174,
        "./sweepcontext": 175,
        "./triangle": 176
    }],
    174: [function(e, t, i) {
        "use strict";

        function n(e) {
            e.initTriangulation(), e.createAdvancingFront(), r(e), o(e)
        }

        function r(e) {
            var t, i = e.pointCount();
            for (t = 1; i > t; ++t)
                for (var n = e.getPoint(t), r = a(e, n), o = n._p2t_edge_list, l = 0; o && l < o.length; ++l) s(e, o[l], r)
        }

        function o(e) {
            for (var t = e.front().head().next.triangle, i = e.front().head().next.point; !t.getConstrainedEdgeCW(i);) t = t.neighborCCW(i);
            e.meshClean(t)
        }

        function a(e, t) {
            var i = e.locateNode(t),
                n = u(e, t, i);
            return t.x <= i.point.x + F && d(e, i), c(e, n), n
        }

        function s(e, t, i) {
            e.edge_event.constrained_edge = t, e.edge_event.right = t.p.x > t.q.x, h(i.triangle, t.p, t.q) || (b(e, t, i), l(e, t.p, t.q, i.triangle, t.q))
        }

        function l(e, t, i, n, r) {
            if (!h(n, t, i)) {
                var o = n.pointCCW(r),
                    a = H(i, o, t);
                if (a === z.COLLINEAR) throw new I("poly2tri EdgeEvent: Collinear not supported!", [i, o, t]);
                var s = n.pointCW(r),
                    u = H(i, s, t);
                if (u === z.COLLINEAR) throw new I("poly2tri EdgeEvent: Collinear not supported!", [i, s, t]);
                a === u ? (n = a === z.CW ? n.neighborCCW(r) : n.neighborCW(r), l(e, t, i, n, r)) : L(e, t, i, n, r)
            }
        }

        function h(e, t, i) {
            var n = e.edgeIndex(t, i);
            if (-1 !== n) {
                e.markConstrainedEdgeByIndex(n);
                var r = e.getNeighbor(n);
                return r && r.markConstrainedEdgeByPoints(t, i), !0
            }
            return !1
        }

        function u(e, t, i) {
            var n = new O(t, i.point, i.next.point);
            n.markNeighbor(i.triangle), e.addToMap(n);
            var r = new N(t);
            return r.next = i.next, r.prev = i, i.next.prev = r, i.next = r, p(e, n) || e.mapTriangleToNodes(n), r
        }

        function d(e, t) {
            var i = new O(t.prev.point, t.point, t.next.point);
            i.markNeighbor(t.prev.triangle), i.markNeighbor(t.triangle), e.addToMap(i), t.prev.next = t.next, t.next.prev = t.prev, p(e, i) || e.mapTriangleToNodes(i)
        }

        function c(e, t) {
            for (var i = t.next; i.next && !W(i.point, i.next.point, i.prev.point);) d(e, i), i = i.next;
            for (i = t.prev; i.prev && !W(i.point, i.next.point, i.prev.point);) d(e, i), i = i.prev;
            t.next && t.next.next && f(t) && _(e, t)
        }

        function f(e) {
            var t = e.point.x - e.next.next.point.x,
                i = e.point.y - e.next.next.point.y;
            return D(i >= 0, "unordered y"), t >= 0 || Math.abs(t) < i
        }

        function p(e, t) {
            for (var i = 0; 3 > i; ++i)
                if (!t.delaunay_edge[i]) {
                    var n = t.getNeighbor(i);
                    if (n) {
                        var r = t.getPoint(i),
                            o = n.oppositePoint(t, r),
                            a = n.index(o);
                        if (n.constrained_edge[a] || n.delaunay_edge[a]) {
                            t.constrained_edge[i] = n.constrained_edge[a];
                            continue
                        }
                        var s = m(r, t.pointCCW(r), t.pointCW(r), o);
                        if (s) {
                            t.delaunay_edge[i] = !0, n.delaunay_edge[a] = !0, g(t, r, n, o);
                            var l = !p(e, t);
                            return l && e.mapTriangleToNodes(t), l = !p(e, n), l && e.mapTriangleToNodes(n), t.delaunay_edge[i] = !1, n.delaunay_edge[a] = !1, !0
                        }
                    }
                }
            return !1
        }

        function m(e, t, i, n) {
            var r = e.x - n.x,
                o = e.y - n.y,
                a = t.x - n.x,
                s = t.y - n.y,
                l = r * s,
                h = a * o,
                u = l - h;
            if (0 >= u) return !1;
            var d = i.x - n.x,
                c = i.y - n.y,
                f = d * o,
                p = r * c,
                m = f - p;
            if (0 >= m) return !1;
            var g = a * c,
                _ = d * s,
                v = r * r + o * o,
                y = a * a + s * s,
                b = d * d + c * c,
                x = v * (g - _) + y * m + b * u;
            return x > 0
        }

        function g(e, t, i, n) {
            var r, o, a, s;
            r = e.neighborCCW(t), o = e.neighborCW(t), a = i.neighborCCW(n), s = i.neighborCW(n);
            var l, h, u, d;
            l = e.getConstrainedEdgeCCW(t), h = e.getConstrainedEdgeCW(t), u = i.getConstrainedEdgeCCW(n), d = i.getConstrainedEdgeCW(n);
            var c, f, p, m;
            c = e.getDelaunayEdgeCCW(t), f = e.getDelaunayEdgeCW(t), p = i.getDelaunayEdgeCCW(n), m = i.getDelaunayEdgeCW(n), e.legalize(t, n), i.legalize(n, t), i.setDelaunayEdgeCCW(t, c), e.setDelaunayEdgeCW(t, f), e.setDelaunayEdgeCCW(n, p), i.setDelaunayEdgeCW(n, m), i.setConstrainedEdgeCCW(t, l), e.setConstrainedEdgeCW(t, h), e.setConstrainedEdgeCCW(n, u), i.setConstrainedEdgeCW(n, d), e.clearNeighbors(), i.clearNeighbors(), r && i.markNeighbor(r), o && e.markNeighbor(o), a && e.markNeighbor(a), s && i.markNeighbor(s), e.markNeighbor(i)
        }

        function _(e, t) {
            for (H(t.point, t.next.point, t.next.next.point) === z.CCW ? e.basin.left_node = t.next.next : e.basin.left_node = t.next, e.basin.bottom_node = e.basin.left_node; e.basin.bottom_node.next && e.basin.bottom_node.point.y >= e.basin.bottom_node.next.point.y;) e.basin.bottom_node = e.basin.bottom_node.next;
            if (e.basin.bottom_node !== e.basin.left_node) {
                for (e.basin.right_node = e.basin.bottom_node; e.basin.right_node.next && e.basin.right_node.point.y < e.basin.right_node.next.point.y;) e.basin.right_node = e.basin.right_node.next;
                e.basin.right_node !== e.basin.bottom_node && (e.basin.width = e.basin.right_node.point.x - e.basin.left_node.point.x, e.basin.left_highest = e.basin.left_node.point.y > e.basin.right_node.point.y, v(e, e.basin.bottom_node))
            }
        }

        function v(e, t) {
            if (!y(e, t)) {
                d(e, t);
                var i;
                if (t.prev !== e.basin.left_node || t.next !== e.basin.right_node) {
                    if (t.prev === e.basin.left_node) {
                        if (i = H(t.point, t.next.point, t.next.next.point), i === z.CW) return;
                        t = t.next
                    } else if (t.next === e.basin.right_node) {
                        if (i = H(t.point, t.prev.point, t.prev.prev.point), i === z.CCW) return;
                        t = t.prev
                    } else t = t.prev.point.y < t.next.point.y ? t.prev : t.next;
                    v(e, t)
                }
            }
        }

        function y(e, t) {
            var i;
            return i = e.basin.left_highest ? e.basin.left_node.point.y - t.point.y : e.basin.right_node.point.y - t.point.y, e.basin.width > i ? !0 : !1
        }

        function b(e, t, i) {
            e.edge_event.right ? x(e, t, i) : S(e, t, i)
        }

        function x(e, t, i) {
            for (; i.next.point.x < t.p.x;) H(t.q, i.next.point, t.p) === z.CCW ? w(e, t, i) : i = i.next
        }

        function w(e, t, i) {
            i.point.x < t.p.x && (H(i.point, i.next.point, i.next.next.point) === z.CCW ? M(e, t, i) : (T(e, t, i), w(e, t, i)))
        }

        function M(e, t, i) {
            d(e, i.next), i.next.point !== t.p && H(t.q, i.next.point, t.p) === z.CCW && H(i.point, i.next.point, i.next.next.point) === z.CCW && M(e, t, i)
        }

        function T(e, t, i) {
            H(i.next.point, i.next.next.point, i.next.next.next.point) === z.CCW ? M(e, t, i.next) : H(t.q, i.next.next.point, t.p) === z.CCW && T(e, t, i.next)
        }

        function S(e, t, i) {
            for (; i.prev.point.x > t.p.x;) H(t.q, i.prev.point, t.p) === z.CW ? C(e, t, i) : i = i.prev
        }

        function C(e, t, i) {
            i.point.x > t.p.x && (H(i.point, i.prev.point, i.prev.prev.point) === z.CW ? k(e, t, i) : (E(e, t, i), C(e, t, i)))
        }

        function E(e, t, i) {
            H(i.prev.point, i.prev.prev.point, i.prev.prev.prev.point) === z.CW ? k(e, t, i.prev) : H(t.q, i.prev.prev.point, t.p) === z.CW && E(e, t, i.prev)
        }

        function k(e, t, i) {
            d(e, i.prev), i.prev.point !== t.p && H(t.q, i.prev.point, t.p) === z.CW && H(i.point, i.prev.point, i.prev.prev.point) === z.CW && k(e, t, i)
        }

        function L(e, t, i, n, r) {
            var o = n.neighborAcross(r);
            D(o, "FLIP failed due to missing triangle!");
            var a = o.oppositePoint(n, r);
            if (n.getConstrainedEdgeAcross(r)) {
                var s = n.index(r);
                throw new I("poly2tri Intersecting Constraints", [r, a, n.getPoint((s + 1) % 3), n.getPoint((s + 2) % 3)])
            }
            if (U(r, n.pointCCW(r), n.pointCW(r), a))
                if (g(n, r, o, a), e.mapTriangleToNodes(n), e.mapTriangleToNodes(o), r === i && a === t) i === e.edge_event.constrained_edge.q && t === e.edge_event.constrained_edge.p && (n.markConstrainedEdgeByPoints(t, i), o.markConstrainedEdgeByPoints(t, i), p(e, n), p(e, o));
                else {
                    var h = H(i, a, t);
                    n = P(e, h, n, o, r, a), L(e, t, i, n, r)
                }
            else {
                var u = A(t, i, o, a);
                R(e, t, i, n, o, u), l(e, t, i, n, r)
            }
        }

        function P(e, t, i, n, r, o) {
            var a;
            return t === z.CCW ? (a = n.edgeIndex(r, o), n.delaunay_edge[a] = !0, p(e, n), n.clearDelaunayEdges(), i) : (a = i.edgeIndex(r, o), i.delaunay_edge[a] = !0, p(e, i), i.clearDelaunayEdges(), n)
        }

        function A(e, t, i, n) {
            var r = H(t, n, e);
            if (r === z.CW) return i.pointCCW(n);
            if (r === z.CCW) return i.pointCW(n);
            throw new I("poly2tri [Unsupported] nextFlipPoint: opposing point on constrained edge!", [t, n, e])
        }

        function R(e, t, i, n, r, o) {
            var a = r.neighborAcross(o);
            D(a, "FLIP failed due to missing triangle");
            var s = a.oppositePoint(r, o);
            if (U(i, n.pointCCW(i), n.pointCW(i), s)) L(e, i, s, a, s);
            else {
                var l = A(t, i, a, s);
                R(e, t, i, n, a, l)
            }
        }
        var D = e("./assert"),
            I = e("./pointerror"),
            O = e("./triangle"),
            N = e("./advancingfront").Node,
            B = e("./utils"),
            F = B.EPSILON,
            z = B.Orientation,
            H = B.orient2d,
            U = B.inScanArea,
            W = B.isAngleObtuse;
        i.triangulate = n
    }, {
        "./advancingfront": 169,
        "./assert": 170,
        "./pointerror": 172,
        "./triangle": 176,
        "./utils": 177
    }],
    175: [function(e, t, i) {
        "use strict";
        var n = e("./pointerror"),
            r = e("./point"),
            o = e("./triangle"),
            a = e("./sweep"),
            s = e("./advancingfront"),
            l = s.Node,
            h = .3,
            u = function(e, t) {
                if (this.p = e, this.q = t, e.y > t.y) this.q = e, this.p = t;
                else if (e.y === t.y)
                    if (e.x > t.x) this.q = e, this.p = t;
                    else if (e.x === t.x) throw new n("poly2tri Invalid Edge constructor: repeated points!", [e]);
                this.q._p2t_edge_list || (this.q._p2t_edge_list = []), this.q._p2t_edge_list.push(this)
            },
            d = function() {
                this.left_node = null, this.bottom_node = null, this.right_node = null, this.width = 0, this.left_highest = !1
            };
        d.prototype.clear = function() {
            this.left_node = null, this.bottom_node = null, this.right_node = null, this.width = 0, this.left_highest = !1
        };
        var c = function() {
                this.constrained_edge = null, this.right = !1
            },
            f = function(e, t) {
                t = t || {}, this.triangles_ = [], this.map_ = [], this.points_ = t.cloneArrays ? e.slice(0) : e, this.edge_list = [], this.pmin_ = this.pmax_ = null, this.front_ = null, this.head_ = null, this.tail_ = null, this.af_head_ = null, this.af_middle_ = null, this.af_tail_ = null, this.basin = new d, this.edge_event = new c, this.initEdges(this.points_)
            };
        f.prototype.addHole = function(e) {
            this.initEdges(e);
            var t, i = e.length;
            for (t = 0; i > t; t++) this.points_.push(e[t]);
            return this
        }, f.prototype.AddHole = f.prototype.addHole, f.prototype.addHoles = function(e) {
            var t, i = e.length;
            for (t = 0; i > t; t++) this.initEdges(e[t]);
            return this.points_ = this.points_.concat.apply(this.points_, e), this
        }, f.prototype.addPoint = function(e) {
            return this.points_.push(e), this
        }, f.prototype.AddPoint = f.prototype.addPoint, f.prototype.addPoints = function(e) {
            return this.points_ = this.points_.concat(e), this
        }, f.prototype.triangulate = function() {
            return a.triangulate(this), this
        }, f.prototype.getBoundingBox = function() {
            return {
                min: this.pmin_,
                max: this.pmax_
            }
        }, f.prototype.getTriangles = function() {
            return this.triangles_
        }, f.prototype.GetTriangles = f.prototype.getTriangles, f.prototype.front = function() {
            return this.front_
        }, f.prototype.pointCount = function() {
            return this.points_.length
        }, f.prototype.head = function() {
            return this.head_
        }, f.prototype.setHead = function(e) {
            this.head_ = e
        }, f.prototype.tail = function() {
            return this.tail_
        }, f.prototype.setTail = function(e) {
            this.tail_ = e
        }, f.prototype.getMap = function() {
            return this.map_
        }, f.prototype.initTriangulation = function() {
            var e, t = this.points_[0].x,
                i = this.points_[0].x,
                n = this.points_[0].y,
                o = this.points_[0].y,
                a = this.points_.length;
            for (e = 1; a > e; e++) {
                var s = this.points_[e];
                s.x > t && (t = s.x), s.x < i && (i = s.x), s.y > n && (n = s.y), s.y < o && (o = s.y)
            }
            this.pmin_ = new r(i, o), this.pmax_ = new r(t, n);
            var l = h * (t - i),
                u = h * (n - o);
            this.head_ = new r(t + l, o - u), this.tail_ = new r(i - l, o - u), this.points_.sort(r.compare)
        }, f.prototype.initEdges = function(e) {
            var t, i = e.length;
            for (t = 0; i > t; ++t) this.edge_list.push(new u(e[t], e[(t + 1) % i]))
        }, f.prototype.getPoint = function(e) {
            return this.points_[e]
        }, f.prototype.addToMap = function(e) {
            this.map_.push(e)
        }, f.prototype.locateNode = function(e) {
            return this.front_.locateNode(e.x)
        }, f.prototype.createAdvancingFront = function() {
            var e, t, i, n = new o(this.points_[0], this.tail_, this.head_);
            this.map_.push(n), e = new l(n.getPoint(1), n), t = new l(n.getPoint(0), n), i = new l(n.getPoint(2)), this.front_ = new s(e, i), e.next = t, t.next = i, t.prev = e, i.prev = t
        }, f.prototype.removeNode = function(e) {}, f.prototype.mapTriangleToNodes = function(e) {
            for (var t = 0; 3 > t; ++t)
                if (!e.getNeighbor(t)) {
                    var i = this.front_.locatePoint(e.pointCW(e.getPoint(t)));
                    i && (i.triangle = e)
                }
        }, f.prototype.removeFromMap = function(e) {
            var t, i = this.map_,
                n = i.length;
            for (t = 0; n > t; t++)
                if (i[t] === e) {
                    i.splice(t, 1);
                    break
                }
        }, f.prototype.meshClean = function(e) {
            for (var t, i, n = [e]; t = n.pop();)
                if (!t.isInterior())
                    for (t.setInterior(!0), this.triangles_.push(t), i = 0; 3 > i; i++) t.constrained_edge[i] || n.push(t.getNeighbor(i))
        }, t.exports = f
    }, {
        "./advancingfront": 169,
        "./point": 171,
        "./pointerror": 172,
        "./sweep": 174,
        "./triangle": 176
    }],
    176: [function(e, t, i) {
        "use strict";
        var n = e("./xy"),
            r = function(e, t, i) {
                this.points_ = [e, t, i], this.neighbors_ = [null, null, null], this.interior_ = !1, this.constrained_edge = [!1, !1, !1], this.delaunay_edge = [!1, !1, !1]
            },
            o = n.toString;
        r.prototype.toString = function() {
            return "[" + o(this.points_[0]) + o(this.points_[1]) + o(this.points_[2]) + "]"
        }, r.prototype.getPoint = function(e) {
            return this.points_[e]
        }, r.prototype.GetPoint = r.prototype.getPoint, r.prototype.getPoints = function() {
            return this.points_
        }, r.prototype.getNeighbor = function(e) {
            return this.neighbors_[e]
        }, r.prototype.containsPoint = function(e) {
            var t = this.points_;
            return e === t[0] || e === t[1] || e === t[2]
        }, r.prototype.containsEdge = function(e) {
            return this.containsPoint(e.p) && this.containsPoint(e.q)
        }, r.prototype.containsPoints = function(e, t) {
            return this.containsPoint(e) && this.containsPoint(t)
        }, r.prototype.isInterior = function() {
            return this.interior_
        }, r.prototype.setInterior = function(e) {
            return this.interior_ = e, this
        }, r.prototype.markNeighborPointers = function(e, t, i) {
            var n = this.points_;
            if (e === n[2] && t === n[1] || e === n[1] && t === n[2]) this.neighbors_[0] = i;
            else if (e === n[0] && t === n[2] || e === n[2] && t === n[0]) this.neighbors_[1] = i;
            else {
                if (!(e === n[0] && t === n[1] || e === n[1] && t === n[0])) throw new Error("poly2tri Invalid Triangle.markNeighborPointers() call");
                this.neighbors_[2] = i
            }
        }, r.prototype.markNeighbor = function(e) {
            var t = this.points_;
            e.containsPoints(t[1], t[2]) ? (this.neighbors_[0] = e, e.markNeighborPointers(t[1], t[2], this)) : e.containsPoints(t[0], t[2]) ? (this.neighbors_[1] = e, e.markNeighborPointers(t[0], t[2], this)) : e.containsPoints(t[0], t[1]) && (this.neighbors_[2] = e, e.markNeighborPointers(t[0], t[1], this))
        }, r.prototype.clearNeighbors = function() {
            this.neighbors_[0] = null, this.neighbors_[1] = null, this.neighbors_[2] = null
        }, r.prototype.clearDelaunayEdges = function() {
            this.delaunay_edge[0] = !1, this.delaunay_edge[1] = !1, this.delaunay_edge[2] = !1
        }, r.prototype.pointCW = function(e) {
            var t = this.points_;
            return e === t[0] ? t[2] : e === t[1] ? t[0] : e === t[2] ? t[1] : null
        }, r.prototype.pointCCW = function(e) {
            var t = this.points_;
            return e === t[0] ? t[1] : e === t[1] ? t[2] : e === t[2] ? t[0] : null
        }, r.prototype.neighborCW = function(e) {
            return e === this.points_[0] ? this.neighbors_[1] : e === this.points_[1] ? this.neighbors_[2] : this.neighbors_[0]
        }, r.prototype.neighborCCW = function(e) {
            return e === this.points_[0] ? this.neighbors_[2] : e === this.points_[1] ? this.neighbors_[0] : this.neighbors_[1]
        }, r.prototype.getConstrainedEdgeCW = function(e) {
            return e === this.points_[0] ? this.constrained_edge[1] : e === this.points_[1] ? this.constrained_edge[2] : this.constrained_edge[0]
        }, r.prototype.getConstrainedEdgeCCW = function(e) {
            return e === this.points_[0] ? this.constrained_edge[2] : e === this.points_[1] ? this.constrained_edge[0] : this.constrained_edge[1]
        }, r.prototype.getConstrainedEdgeAcross = function(e) {
            return e === this.points_[0] ? this.constrained_edge[0] : e === this.points_[1] ? this.constrained_edge[1] : this.constrained_edge[2]
        }, r.prototype.setConstrainedEdgeCW = function(e, t) {
            e === this.points_[0] ? this.constrained_edge[1] = t : e === this.points_[1] ? this.constrained_edge[2] = t : this.constrained_edge[0] = t
        }, r.prototype.setConstrainedEdgeCCW = function(e, t) {
            e === this.points_[0] ? this.constrained_edge[2] = t : e === this.points_[1] ? this.constrained_edge[0] = t : this.constrained_edge[1] = t
        }, r.prototype.getDelaunayEdgeCW = function(e) {
            return e === this.points_[0] ? this.delaunay_edge[1] : e === this.points_[1] ? this.delaunay_edge[2] : this.delaunay_edge[0]
        }, r.prototype.getDelaunayEdgeCCW = function(e) {
            return e === this.points_[0] ? this.delaunay_edge[2] : e === this.points_[1] ? this.delaunay_edge[0] : this.delaunay_edge[1]
        }, r.prototype.setDelaunayEdgeCW = function(e, t) {
            e === this.points_[0] ? this.delaunay_edge[1] = t : e === this.points_[1] ? this.delaunay_edge[2] = t : this.delaunay_edge[0] = t
        }, r.prototype.setDelaunayEdgeCCW = function(e, t) {
            e === this.points_[0] ? this.delaunay_edge[2] = t : e === this.points_[1] ? this.delaunay_edge[0] = t : this.delaunay_edge[1] = t
        }, r.prototype.neighborAcross = function(e) {
            return e === this.points_[0] ? this.neighbors_[0] : e === this.points_[1] ? this.neighbors_[1] : this.neighbors_[2]
        }, r.prototype.oppositePoint = function(e, t) {
            var i = e.pointCW(t);
            return this.pointCW(i)
        }, r.prototype.legalize = function(e, t) {
            var i = this.points_;
            if (e === i[0]) i[1] = i[0], i[0] = i[2], i[2] = t;
            else if (e === i[1]) i[2] = i[1], i[1] = i[0], i[0] = t;
            else {
                if (e !== i[2]) throw new Error("poly2tri Invalid Triangle.legalize() call");
                i[0] = i[2], i[2] = i[1], i[1] = t
            }
        }, r.prototype.index = function(e) {
            var t = this.points_;
            if (e === t[0]) return 0;
            if (e === t[1]) return 1;
            if (e === t[2]) return 2;
            throw new Error("poly2tri Invalid Triangle.index() call")
        }, r.prototype.edgeIndex = function(e, t) {
            var i = this.points_;
            if (e === i[0]) {
                if (t === i[1]) return 2;
                if (t === i[2]) return 1
            } else if (e === i[1]) {
                if (t === i[2]) return 0;
                if (t === i[0]) return 2
            } else if (e === i[2]) {
                if (t === i[0]) return 1;
                if (t === i[1]) return 0
            }
            return -1
        }, r.prototype.markConstrainedEdgeByIndex = function(e) {
            this.constrained_edge[e] = !0
        }, r.prototype.markConstrainedEdgeByEdge = function(e) {
            this.markConstrainedEdgeByPoints(e.p, e.q)
        }, r.prototype.markConstrainedEdgeByPoints = function(e, t) {
            var i = this.points_;
            t === i[0] && e === i[1] || t === i[1] && e === i[0] ? this.constrained_edge[2] = !0 : t === i[0] && e === i[2] || t === i[2] && e === i[0] ? this.constrained_edge[1] = !0 : (t === i[1] && e === i[2] || t === i[2] && e === i[1]) && (this.constrained_edge[0] = !0)
        }, t.exports = r
    }, {
        "./xy": 178
    }],
    177: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = (e.x - i.x) * (t.y - i.y),
                r = (e.y - i.y) * (t.x - i.x),
                o = n - r;
            return o > -a && a > o ? s.COLLINEAR : o > 0 ? s.CCW : s.CW
        }

        function r(e, t, i, n) {
            var r = (e.x - t.x) * (n.y - t.y) - (n.x - t.x) * (e.y - t.y);
            if (r >= -a) return !1;
            var o = (e.x - i.x) * (n.y - i.y) - (n.x - i.x) * (e.y - i.y);
            return a >= o ? !1 : !0
        }

        function o(e, t, i) {
            var n = t.x - e.x,
                r = t.y - e.y,
                o = i.x - e.x,
                a = i.y - e.y;
            return 0 > n * o + r * a
        }
        var a = 1e-12;
        i.EPSILON = a;
        var s = {
            CW: 1,
            CCW: -1,
            COLLINEAR: 0
        };
        i.Orientation = s, i.orient2d = n, i.inScanArea = r, i.isAngleObtuse = o
    }, {}],
    178: [function(e, t, i) {
        "use strict";

        function n(e) {
            return "(" + e.x + ";" + e.y + ")"
        }

        function r(e) {
            var t = e.toString();
            return "[object Object]" === t ? n(e) : t
        }

        function o(e, t) {
            return e.y === t.y ? e.x - t.x : e.y - t.y
        }

        function a(e, t) {
            return e.x === t.x && e.y === t.y
        }
        t.exports = {
            toString: r,
            toStringBase: n,
            compare: o,
            equals: a
        }
    }, {}],
    179: [function(e, t, i) {
        function n(e, t) {
            e = Math.round(e * t), e <<= 1, 0 > e && (e = ~e);
            for (var i = ""; e >= 32;) i += String.fromCharCode((32 | 31 & e) + 63), e >>= 5;
            return i += String.fromCharCode(e + 63)
        }
        var r = {};
        r.decode = function(e, t) {
            for (var i, n, r = 0, o = 0, a = 0, s = [], l = 0, h = 0, u = null, d = Math.pow(10, t || 5); r < e.length;) {
                u = null, l = 0, h = 0;
                do u = e.charCodeAt(r++) - 63, h |= (31 & u) << l, l += 5; while (u >= 32);
                i = 1 & h ? ~(h >> 1) : h >> 1, l = h = 0;
                do u = e.charCodeAt(r++) - 63, h |= (31 & u) << l, l += 5; while (u >= 32);
                n = 1 & h ? ~(h >> 1) : h >> 1, o += i, a += n, s.push([o / d, a / d])
            }
            return s
        }, r.encode = function(e, t) {
            if (!e.length) return "";
            for (var i = Math.pow(10, t || 5), r = n(e[0][0], i) + n(e[0][1], i), o = 1; o < e.length; o++) {
                var a = e[o],
                    s = e[o - 1];
                r += n(a[0] - s[0], i), r += n(a[1] - s[1], i)
            }
            return r
        }, void 0 !== typeof t && (t.exports = r)
    }, {}],
    180: [function(e, t, i) {
        (function(e) {
            "use strict";

            function i(t, i, n, r) {
                if ("function" != typeof t) throw new TypeError('"callback" argument must be a function');
                var o, a, s = arguments.length;
                switch (s) {
                    case 0:
                    case 1:
                        return e.nextTick(t);
                    case 2:
                        return e.nextTick(function() {
                            t.call(null, i)
                        });
                    case 3:
                        return e.nextTick(function() {
                            t.call(null, i, n)
                        });
                    case 4:
                        return e.nextTick(function() {
                            t.call(null, i, n, r)
                        });
                    default:
                        for (o = new Array(s - 1), a = 0; a < o.length;) o[a++] = arguments[a];
                        return e.nextTick(function() {
                            t.apply(null, o)
                        })
                }
            }!e.version || 0 === e.version.indexOf("v0.") || 0 === e.version.indexOf("v1.") && 0 !== e.version.indexOf("v1.8.") ? t.exports = i : t.exports = e.nextTick
        }).call(this, e("_process"))
    }, {
        _process: 181
    }],
    181: [function(e, t, i) {
        function n() {
            throw new Error("setTimeout has not been defined")
        }

        function r() {
            throw new Error("clearTimeout has not been defined")
        }

        function o(e) {
            if (d === setTimeout) return setTimeout(e, 0);
            if ((d === n || !d) && setTimeout) return d = setTimeout, setTimeout(e, 0);
            try {
                return d(e, 0)
            } catch (t) {
                try {
                    return d.call(null, e, 0)
                } catch (t) {
                    return d.call(this, e, 0)
                }
            }
        }

        function a(e) {
            if (c === clearTimeout) return clearTimeout(e);
            if ((c === r || !c) && clearTimeout) return c = clearTimeout, clearTimeout(e);
            try {
                return c(e)
            } catch (t) {
                try {
                    return c.call(null, e)
                } catch (t) {
                    return c.call(this, e)
                }
            }
        }

        function s() {
            g && p && (g = !1, p.length ? m = p.concat(m) : _ = -1, m.length && l())
        }

        function l() {
            if (!g) {
                var e = o(s);
                g = !0;
                for (var t = m.length; t;) {
                    for (p = m, m = []; ++_ < t;) p && p[_].run();
                    _ = -1, t = m.length
                }
                p = null, g = !1, a(e)
            }
        }

        function h(e, t) {
            this.fun = e, this.array = t
        }

        function u() {}
        var d, c, f = t.exports = {};
        ! function() {
            try {
                d = "function" == typeof setTimeout ? setTimeout : n
            } catch (e) {
                d = n
            }
            try {
                c = "function" == typeof clearTimeout ? clearTimeout : r
            } catch (e) {
                c = r
            }
        }();
        var p, m = [],
            g = !1,
            _ = -1;
        f.nextTick = function(e) {
            var t = new Array(arguments.length - 1);
            if (arguments.length > 1)
                for (var i = 1; i < arguments.length; i++) t[i - 1] = arguments[i];
            m.push(new h(e, t)), 1 !== m.length || g || o(l)
        }, h.prototype.run = function() {
            this.fun.apply(null, this.array)
        }, f.title = "browser", f.browser = !0, f.env = {}, f.argv = [], f.version = "", f.versions = {}, f.on = u, f.addListener = u, f.once = u, f.off = u, f.removeListener = u, f.removeAllListeners = u, f.emit = u, f.binding = function(e) {
            throw new Error("process.binding is not supported")
        }, f.cwd = function() {
            return "/"
        }, f.chdir = function(e) {
            throw new Error("process.chdir is not supported")
        }, f.umask = function() {
            return 0
        }
    }, {}],
    182: [function(e, t, i) {
        (function(e) {
            ! function(n) {
                function r(e) {
                    throw new RangeError(D[e])
                }

                function o(e, t) {
                    for (var i = e.length, n = []; i--;) n[i] = t(e[i]);
                    return n
                }

                function a(e, t) {
                    var i = e.split("@"),
                        n = "";
                    i.length > 1 && (n = i[0] + "@", e = i[1]), e = e.replace(R, ".");
                    var r = e.split("."),
                        a = o(r, t).join(".");
                    return n + a
                }

                function s(e) {
                    for (var t, i, n = [], r = 0, o = e.length; o > r;) t = e.charCodeAt(r++), t >= 55296 && 56319 >= t && o > r ? (i = e.charCodeAt(r++), 56320 == (64512 & i) ? n.push(((1023 & t) << 10) + (1023 & i) + 65536) : (n.push(t), r--)) : n.push(t);
                    return n
                }

                function l(e) {
                    return o(e, function(e) {
                        var t = "";
                        return e > 65535 && (e -= 65536, t += N(e >>> 10 & 1023 | 55296), e = 56320 | 1023 & e), t += N(e)
                    }).join("")
                }

                function h(e) {
                    return 10 > e - 48 ? e - 22 : 26 > e - 65 ? e - 65 : 26 > e - 97 ? e - 97 : w
                }

                function u(e, t) {
                    return e + 22 + 75 * (26 > e) - ((0 != t) << 5)
                }

                function d(e, t, i) {
                    var n = 0;
                    for (e = i ? O(e / C) : e >> 1, e += O(e / t); e > I * T >> 1; n += w) e = O(e / I);
                    return O(n + (I + 1) * e / (e + S))
                }

                function c(e) {
                    var t, i, n, o, a, s, u, c, f, p, m = [],
                        g = e.length,
                        _ = 0,
                        v = k,
                        y = E;
                    for (i = e.lastIndexOf(L), 0 > i && (i = 0), n = 0; i > n; ++n) e.charCodeAt(n) >= 128 && r("not-basic"), m.push(e.charCodeAt(n));
                    for (o = i > 0 ? i + 1 : 0; g > o;) {
                        for (a = _, s = 1, u = w; o >= g && r("invalid-input"), c = h(e.charCodeAt(o++)), (c >= w || c > O((x - _) / s)) && r("overflow"), _ += c * s, f = y >= u ? M : u >= y + T ? T : u - y, !(f > c); u += w) p = w - f, s > O(x / p) && r("overflow"), s *= p;
                        t = m.length + 1, y = d(_ - a, t, 0 == a), O(_ / t) > x - v && r("overflow"), v += O(_ / t), _ %= t, m.splice(_++, 0, v)
                    }
                    return l(m)
                }

                function f(e) {
                    var t, i, n, o, a, l, h, c, f, p, m, g, _, v, y, b = [];
                    for (e = s(e), g = e.length, t = k, i = 0, a = E, l = 0; g > l; ++l) m = e[l], 128 > m && b.push(N(m));
                    for (n = o = b.length, o && b.push(L); g > n;) {
                        for (h = x, l = 0; g > l; ++l) m = e[l], m >= t && h > m && (h = m);
                        for (_ = n + 1, h - t > O((x - i) / _) && r("overflow"), i += (h - t) * _, t = h, l = 0; g > l; ++l)
                            if (m = e[l], t > m && ++i > x && r("overflow"), m == t) {
                                for (c = i, f = w; p = a >= f ? M : f >= a + T ? T : f - a, !(p > c); f += w) y = c - p, v = w - p, b.push(N(u(p + y % v, 0))), c = O(y / v);
                                b.push(N(u(c, 0))), a = d(i, _, n == o), i = 0, ++n
                            }++i, ++t
                    }
                    return b.join("")
                }

                function p(e) {
                    return a(e, function(e) {
                        return P.test(e) ? c(e.slice(4).toLowerCase()) : e
                    })
                }

                function m(e) {
                    return a(e, function(e) {
                        return A.test(e) ? "xn--" + f(e) : e
                    })
                }
                var g = "object" == typeof i && i && !i.nodeType && i,
                    _ = "object" == typeof t && t && !t.nodeType && t,
                    v = "object" == typeof e && e;
                (v.global === v || v.window === v || v.self === v) && (n = v);
                var y, b, x = 2147483647,
                    w = 36,
                    M = 1,
                    T = 26,
                    S = 38,
                    C = 700,
                    E = 72,
                    k = 128,
                    L = "-",
                    P = /^xn--/,
                    A = /[^\x20-\x7E]/,
                    R = /[\x2E\u3002\uFF0E\uFF61]/g,
                    D = {
                        overflow: "Overflow: input needs wider integers to process",
                        "not-basic": "Illegal input >= 0x80 (not a basic code point)",
                        "invalid-input": "Invalid input"
                    },
                    I = w - M,
                    O = Math.floor,
                    N = String.fromCharCode;
                if (y = {
                        version: "1.4.1",
                        ucs2: {
                            decode: s,
                            encode: l
                        },
                        decode: c,
                        encode: f,
                        toASCII: m,
                        toUnicode: p
                    }, "function" == typeof define && "object" == typeof define.amd && define.amd) define("punycode", function() {
                    return y
                });
                else if (g && _)
                    if (t.exports == g) _.exports = y;
                    else
                        for (b in y) y.hasOwnProperty(b) && (g[b] = y[b]);
                else n.punycode = y
            }(this)
        }).call(this, window)
    }, {}],
    183: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            return Object.prototype.hasOwnProperty.call(e, t)
        }
        t.exports = function(e, t, i, o) {
            t = t || "&", i = i || "=";
            var a = {};
            if ("string" != typeof e || 0 === e.length) return a;
            var s = /\+/g;
            e = e.split(t);
            var l = 1e3;
            o && "number" == typeof o.maxKeys && (l = o.maxKeys);
            var h = e.length;
            l > 0 && h > l && (h = l);
            for (var u = 0; h > u; ++u) {
                var d, c, f, p, m = e[u].replace(s, "%20"),
                    g = m.indexOf(i);
                g >= 0 ? (d = m.substr(0, g), c = m.substr(g + 1)) : (d = m, c = ""), f = decodeURIComponent(d), p = decodeURIComponent(c), n(a, f) ? r(a[f]) ? a[f].push(p) : a[f] = [a[f], p] : a[f] = p
            }
            return a
        };
        var r = Array.isArray || function(e) {
            return "[object Array]" === Object.prototype.toString.call(e)
        }
    }, {}],
    184: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (e.map) return e.map(t);
            for (var i = [], n = 0; n < e.length; n++) i.push(t(e[n], n));
            return i
        }
        var r = function(e) {
            switch (typeof e) {
                case "string":
                    return e;
                case "boolean":
                    return e ? "true" : "false";
                case "number":
                    return isFinite(e) ? e : "";
                default:
                    return ""
            }
        };
        t.exports = function(e, t, i, s) {
            return t = t || "&", i = i || "=", null === e && (e = void 0), "object" == typeof e ? n(a(e), function(a) {
                var s = encodeURIComponent(r(a)) + i;
                return o(e[a]) ? n(e[a], function(e) {
                    return s + encodeURIComponent(r(e))
                }).join(t) : s + encodeURIComponent(r(e[a]))
            }).join(t) : s ? encodeURIComponent(r(s)) + i + encodeURIComponent(r(e)) : ""
        };
        var o = Array.isArray || function(e) {
                return "[object Array]" === Object.prototype.toString.call(e)
            },
            a = Object.keys || function(e) {
                var t = [];
                for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && t.push(i);
                return t
            }
    }, {}],
    185: [function(e, t, i) {
        "use strict";
        i.decode = i.parse = e("./decode"), i.encode = i.stringify = e("./encode")
    }, {
        "./decode": 183,
        "./encode": 184
    }],
    186: [function(e, t, i) {
        "use strict";

        function n(e) {
            return this instanceof n ? (h.call(this, e), u.call(this, e), e && e.readable === !1 && (this.readable = !1), e && e.writable === !1 && (this.writable = !1), this.allowHalfOpen = !0, e && e.allowHalfOpen === !1 && (this.allowHalfOpen = !1), void this.once("end", r)) : new n(e)
        }

        function r() {
            this.allowHalfOpen || this._writableState.ended || s(o, this)
        }

        function o(e) {
            e.end()
        }
        var a = Object.keys || function(e) {
            var t = [];
            for (var i in e) t.push(i);
            return t
        };
        t.exports = n;
        var s = e("process-nextick-args"),
            l = e("core-util-is");
        l.inherits = e("inherits");
        var h = e("./_stream_readable"),
            u = e("./_stream_writable");
        l.inherits(n, h);
        for (var d = a(u.prototype), c = 0; c < d.length; c++) {
            var f = d[c];
            n.prototype[f] || (n.prototype[f] = u.prototype[f])
        }
    }, {
        "./_stream_readable": 188,
        "./_stream_writable": 190,
        "core-util-is": 8,
        inherits: 107,
        "process-nextick-args": 180
    }],
    187: [function(e, t, i) {
        "use strict";

        function n(e) {
            return this instanceof n ? void r.call(this, e) : new n(e)
        }
        t.exports = n;
        var r = e("./_stream_transform"),
            o = e("core-util-is");
        o.inherits = e("inherits"), o.inherits(n, r), n.prototype._transform = function(e, t, i) {
            i(null, e)
        }
    }, {
        "./_stream_transform": 189,
        "core-util-is": 8,
        inherits: 107
    }],
    188: [function(e, t, i) {
        (function(i) {
            "use strict";

            function n(t, i) {
                I = I || e("./_stream_duplex"), t = t || {}, this.objectMode = !!t.objectMode, i instanceof I && (this.objectMode = this.objectMode || !!t.readableObjectMode);
                var n = t.highWaterMark,
                    r = this.objectMode ? 16 : 16384;
                this.highWaterMark = n || 0 === n ? n : r, this.highWaterMark = ~~this.highWaterMark, this.buffer = [], this.length = 0, this.pipes = null, this.pipesCount = 0, this.flowing = null, this.ended = !1, this.endEmitted = !1, this.reading = !1, this.sync = !0, this.needReadable = !1, this.emittedReadable = !1, this.readableListening = !1, this.resumeScheduled = !1, this.defaultEncoding = t.defaultEncoding || "utf8", this.ranOut = !1, this.awaitDrain = 0, this.readingMore = !1, this.decoder = null, this.encoding = null, t.encoding && (D || (D = e("string_decoder/").StringDecoder), this.decoder = new D(t.encoding), this.encoding = t.encoding)
            }

            function r(t) {
                return I = I || e("./_stream_duplex"), this instanceof r ? (this._readableState = new n(t, this), this.readable = !0, t && "function" == typeof t.read && (this._read = t.read), void k.call(this)) : new r(t)
            }

            function o(e, t, i, n, r) {
                var o = h(t, i);
                if (o) e.emit("error", o);
                else if (null === i) t.reading = !1, u(e, t);
                else if (t.objectMode || i && i.length > 0)
                    if (t.ended && !r) {
                        var s = new Error("stream.push() after EOF");
                        e.emit("error", s)
                    } else if (t.endEmitted && r) {
                    var s = new Error("stream.unshift() after end event");
                    e.emit("error", s)
                } else {
                    var l;
                    !t.decoder || r || n || (i = t.decoder.write(i), l = !t.objectMode && 0 === i.length), r || (t.reading = !1), l || (t.flowing && 0 === t.length && !t.sync ? (e.emit("data", i), e.read(0)) : (t.length += t.objectMode ? 1 : i.length, r ? t.buffer.unshift(i) : t.buffer.push(i), t.needReadable && d(e))), f(e, t)
                } else r || (t.reading = !1);
                return a(t)
            }

            function a(e) {
                return !e.ended && (e.needReadable || e.length < e.highWaterMark || 0 === e.length)
            }

            function s(e) {
                return e >= O ? e = O : (e--, e |= e >>> 1, e |= e >>> 2, e |= e >>> 4, e |= e >>> 8, e |= e >>> 16, e++), e
            }

            function l(e, t) {
                return 0 === t.length && t.ended ? 0 : t.objectMode ? 0 === e ? 0 : 1 : null === e || isNaN(e) ? t.flowing && t.buffer.length ? t.buffer[0].length : t.length : 0 >= e ? 0 : (e > t.highWaterMark && (t.highWaterMark = s(e)), e > t.length ? t.ended ? t.length : (t.needReadable = !0, 0) : e)
            }

            function h(e, t) {
                var i = null;
                return E.isBuffer(t) || "string" == typeof t || null === t || void 0 === t || e.objectMode || (i = new TypeError("Invalid non-string/buffer chunk")), i
            }

            function u(e, t) {
                if (!t.ended) {
                    if (t.decoder) {
                        var i = t.decoder.end();
                        i && i.length && (t.buffer.push(i), t.length += t.objectMode ? 1 : i.length)
                    }
                    t.ended = !0, d(e)
                }
            }

            function d(e) {
                var t = e._readableState;
                t.needReadable = !1, t.emittedReadable || (R("emitReadable", t.flowing), t.emittedReadable = !0, t.sync ? S(c, e) : c(e))
            }

            function c(e) {
                R("emit readable"), e.emit("readable"), y(e)
            }

            function f(e, t) {
                t.readingMore || (t.readingMore = !0, S(p, e, t))
            }

            function p(e, t) {
                for (var i = t.length; !t.reading && !t.flowing && !t.ended && t.length < t.highWaterMark && (R("maybeReadMore read 0"), e.read(0), i !== t.length);) i = t.length;
                t.readingMore = !1
            }

            function m(e) {
                return function() {
                    var t = e._readableState;
                    R("pipeOnDrain", t.awaitDrain), t.awaitDrain && t.awaitDrain--, 0 === t.awaitDrain && L(e, "data") && (t.flowing = !0, y(e))
                }
            }

            function g(e) {
                R("readable nexttick read 0"), e.read(0)
            }

            function _(e, t) {
                t.resumeScheduled || (t.resumeScheduled = !0, S(v, e, t))
            }

            function v(e, t) {
                t.reading || (R("resume read 0"), e.read(0)), t.resumeScheduled = !1, e.emit("resume"), y(e), t.flowing && !t.reading && e.read(0)
            }

            function y(e) {
                var t = e._readableState;
                if (R("flow", t.flowing), t.flowing)
                    do var i = e.read(); while (null !== i && t.flowing)
            }

            function b(e, t) {
                var i, n = t.buffer,
                    r = t.length,
                    o = !!t.decoder,
                    a = !!t.objectMode;
                if (0 === n.length) return null;
                if (0 === r) i = null;
                else if (a) i = n.shift();
                else if (!e || e >= r) i = o ? n.join("") : 1 === n.length ? n[0] : E.concat(n, r), n.length = 0;
                else if (e < n[0].length) {
                    var s = n[0];
                    i = s.slice(0, e), n[0] = s.slice(e)
                } else if (e === n[0].length) i = n.shift();
                else {
                    i = o ? "" : new E(e);
                    for (var l = 0, h = 0, u = n.length; u > h && e > l; h++) {
                        var s = n[0],
                            d = Math.min(e - l, s.length);
                        o ? i += s.slice(0, d) : s.copy(i, l, 0, d), d < s.length ? n[0] = s.slice(d) : n.shift(), l += d
                    }
                }
                return i
            }

            function x(e) {
                var t = e._readableState;
                if (t.length > 0) throw new Error("endReadable called on non-empty stream");
                t.endEmitted || (t.ended = !0, S(w, t, e))
            }

            function w(e, t) {
                e.endEmitted || 0 !== e.length || (e.endEmitted = !0, t.readable = !1, t.emit("end"))
            }

            function M(e, t) {
                for (var i = 0, n = e.length; n > i; i++) t(e[i], i)
            }

            function T(e, t) {
                for (var i = 0, n = e.length; n > i; i++)
                    if (e[i] === t) return i;
                return -1
            }
            t.exports = r;
            var S = e("process-nextick-args"),
                C = e("isarray"),
                E = e("buffer").Buffer;
            r.ReadableState = n;
            var k, L = (e("events"), function(e, t) {
                return e.listeners(t).length
            });
            ! function() {
                try {
                    k = e("stream")
                } catch (t) {} finally {
                    k || (k = e("events").EventEmitter)
                }
            }();
            var E = e("buffer").Buffer,
                P = e("core-util-is");
            P.inherits = e("inherits");
            var A = e("util"),
                R = void 0;
            R = A && A.debuglog ? A.debuglog("stream") : function() {};
            var D;
            P.inherits(r, k);
            var I, I;
            r.prototype.push = function(e, t) {
                var i = this._readableState;
                return i.objectMode || "string" != typeof e || (t = t || i.defaultEncoding, t !== i.encoding && (e = new E(e, t), t = "")), o(this, i, e, t, !1)
            }, r.prototype.unshift = function(e) {
                var t = this._readableState;
                return o(this, t, e, "", !0)
            }, r.prototype.isPaused = function() {
                return this._readableState.flowing === !1
            }, r.prototype.setEncoding = function(t) {
                return D || (D = e("string_decoder/").StringDecoder), this._readableState.decoder = new D(t), this._readableState.encoding = t, this
            };
            var O = 8388608;
            r.prototype.read = function(e) {
                R("read", e);
                var t = this._readableState,
                    i = e;
                if (("number" != typeof e || e > 0) && (t.emittedReadable = !1), 0 === e && t.needReadable && (t.length >= t.highWaterMark || t.ended)) return R("read: emitReadable", t.length, t.ended), 0 === t.length && t.ended ? x(this) : d(this), null;
                if (e = l(e, t), 0 === e && t.ended) return 0 === t.length && x(this), null;
                var n = t.needReadable;
                R("need readable", n), (0 === t.length || t.length - e < t.highWaterMark) && (n = !0, R("length less than watermark", n)), (t.ended || t.reading) && (n = !1, R("reading or ended", n)), n && (R("do read"), t.reading = !0, t.sync = !0, 0 === t.length && (t.needReadable = !0), this._read(t.highWaterMark), t.sync = !1), n && !t.reading && (e = l(i, t));
                var r;
                return r = e > 0 ? b(e, t) : null, null === r && (t.needReadable = !0, e = 0), t.length -= e, 0 !== t.length || t.ended || (t.needReadable = !0), i !== e && t.ended && 0 === t.length && x(this), null !== r && this.emit("data", r), r
            }, r.prototype._read = function(e) {
                this.emit("error", new Error("not implemented"))
            }, r.prototype.pipe = function(e, t) {
                function n(e) {
                    R("onunpipe"), e === d && o()
                }

                function r() {
                    R("onend"), e.end()
                }

                function o() {
                    R("cleanup"), e.removeListener("close", l), e.removeListener("finish", h), e.removeListener("drain", g), e.removeListener("error", s), e.removeListener("unpipe", n), d.removeListener("end", r), d.removeListener("end", o), d.removeListener("data", a), _ = !0, !c.awaitDrain || e._writableState && !e._writableState.needDrain || g()
                }

                function a(t) {
                    R("ondata");
                    var i = e.write(t);
                    !1 === i && (1 !== c.pipesCount || c.pipes[0] !== e || 1 !== d.listenerCount("data") || _ || (R("false write response, pause", d._readableState.awaitDrain), d._readableState.awaitDrain++), d.pause())
                }

                function s(t) {
                    R("onerror", t), u(), e.removeListener("error", s), 0 === L(e, "error") && e.emit("error", t)
                }

                function l() {
                    e.removeListener("finish", h), u()
                }

                function h() {
                    R("onfinish"), e.removeListener("close", l), u()
                }

                function u() {
                    R("unpipe"), d.unpipe(e)
                }
                var d = this,
                    c = this._readableState;
                switch (c.pipesCount) {
                    case 0:
                        c.pipes = e;
                        break;
                    case 1:
                        c.pipes = [c.pipes, e];
                        break;
                    default:
                        c.pipes.push(e)
                }
                c.pipesCount += 1, R("pipe count=%d opts=%j", c.pipesCount, t);
                var f = (!t || t.end !== !1) && e !== i.stdout && e !== i.stderr,
                    p = f ? r : o;
                c.endEmitted ? S(p) : d.once("end", p), e.on("unpipe", n);
                var g = m(d);
                e.on("drain", g);
                var _ = !1;
                return d.on("data", a), e._events && e._events.error ? C(e._events.error) ? e._events.error.unshift(s) : e._events.error = [s, e._events.error] : e.on("error", s), e.once("close", l), e.once("finish", h), e.emit("pipe", d), c.flowing || (R("pipe resume"), d.resume()), e
            }, r.prototype.unpipe = function(e) {
                var t = this._readableState;
                if (0 === t.pipesCount) return this;
                if (1 === t.pipesCount) return e && e !== t.pipes ? this : (e || (e = t.pipes), t.pipes = null, t.pipesCount = 0, t.flowing = !1, e && e.emit("unpipe", this), this);
                if (!e) {
                    var i = t.pipes,
                        n = t.pipesCount;
                    t.pipes = null, t.pipesCount = 0, t.flowing = !1;
                    for (var r = 0; n > r; r++) i[r].emit("unpipe", this);
                    return this
                }
                var o = T(t.pipes, e);
                return -1 === o ? this : (t.pipes.splice(o, 1), t.pipesCount -= 1, 1 === t.pipesCount && (t.pipes = t.pipes[0]), e.emit("unpipe", this), this)
            }, r.prototype.on = function(e, t) {
                var i = k.prototype.on.call(this, e, t);
                if ("data" === e && !1 !== this._readableState.flowing && this.resume(), "readable" === e && !this._readableState.endEmitted) {
                    var n = this._readableState;
                    n.readableListening || (n.readableListening = !0, n.emittedReadable = !1, n.needReadable = !0, n.reading ? n.length && d(this, n) : S(g, this))
                }
                return i
            }, r.prototype.addListener = r.prototype.on, r.prototype.resume = function() {
                var e = this._readableState;
                return e.flowing || (R("resume"), e.flowing = !0, _(this, e)), this
            }, r.prototype.pause = function() {
                return R("call pause flowing=%j", this._readableState.flowing), !1 !== this._readableState.flowing && (R("pause"), this._readableState.flowing = !1, this.emit("pause")), this
            }, r.prototype.wrap = function(e) {
                var t = this._readableState,
                    i = !1,
                    n = this;
                e.on("end", function() {
                    if (R("wrapped end"), t.decoder && !t.ended) {
                        var e = t.decoder.end();
                        e && e.length && n.push(e)
                    }
                    n.push(null)
                }), e.on("data", function(r) {
                    if (R("wrapped data"), t.decoder && (r = t.decoder.write(r)), (!t.objectMode || null !== r && void 0 !== r) && (t.objectMode || r && r.length)) {
                        var o = n.push(r);
                        o || (i = !0, e.pause())
                    }
                });
                for (var r in e) void 0 === this[r] && "function" == typeof e[r] && (this[r] = function(t) {
                    return function() {
                        return e[t].apply(e, arguments)
                    }
                }(r));
                var o = ["error", "close", "destroy", "pause", "resume"];
                return M(o, function(t) {
                    e.on(t, n.emit.bind(n, t))
                }), n._read = function(t) {
                    R("wrapped _read", t), i && (i = !1, e.resume())
                }, n
            }, r._fromList = b
        }).call(this, e("_process"))
    }, {
        "./_stream_duplex": 186,
        _process: 181,
        buffer: 6,
        "core-util-is": 8,
        events: 99,
        inherits: 107,
        isarray: 191,
        "process-nextick-args": 180,
        "string_decoder/": 201,
        util: 5
    }],
    189: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.afterTransform = function(t, i) {
                return r(e, t, i)
            }, this.needTransform = !1, this.transforming = !1, this.writecb = null, this.writechunk = null, this.writeencoding = null
        }

        function r(e, t, i) {
            var n = e._transformState;
            n.transforming = !1;
            var r = n.writecb;
            if (!r) return e.emit("error", new Error("no writecb in Transform class"));
            n.writechunk = null, n.writecb = null, null !== i && void 0 !== i && e.push(i), r(t);
            var o = e._readableState;
            o.reading = !1, (o.needReadable || o.length < o.highWaterMark) && e._read(o.highWaterMark)
        }

        function o(e) {
            if (!(this instanceof o)) return new o(e);
            s.call(this, e), this._transformState = new n(this);
            var t = this;
            this._readableState.needReadable = !0, this._readableState.sync = !1, e && ("function" == typeof e.transform && (this._transform = e.transform),
                "function" == typeof e.flush && (this._flush = e.flush)), this.once("prefinish", function() {
                "function" == typeof this._flush ? this._flush(function(e) {
                    a(t, e)
                }) : a(t)
            })
        }

        function a(e, t) {
            if (t) return e.emit("error", t);
            var i = e._writableState,
                n = e._transformState;
            if (i.length) throw new Error("calling transform done when ws.length != 0");
            if (n.transforming) throw new Error("calling transform done when still transforming");
            return e.push(null)
        }
        t.exports = o;
        var s = e("./_stream_duplex"),
            l = e("core-util-is");
        l.inherits = e("inherits"), l.inherits(o, s), o.prototype.push = function(e, t) {
            return this._transformState.needTransform = !1, s.prototype.push.call(this, e, t)
        }, o.prototype._transform = function(e, t, i) {
            throw new Error("not implemented")
        }, o.prototype._write = function(e, t, i) {
            var n = this._transformState;
            if (n.writecb = i, n.writechunk = e, n.writeencoding = t, !n.transforming) {
                var r = this._readableState;
                (n.needTransform || r.needReadable || r.length < r.highWaterMark) && this._read(r.highWaterMark)
            }
        }, o.prototype._read = function(e) {
            var t = this._transformState;
            null !== t.writechunk && t.writecb && !t.transforming ? (t.transforming = !0, this._transform(t.writechunk, t.writeencoding, t.afterTransform)) : t.needTransform = !0
        }
    }, {
        "./_stream_duplex": 186,
        "core-util-is": 8,
        inherits: 107
    }],
    190: [function(e, t, i) {
        (function(i) {
            "use strict";

            function n() {}

            function r(e, t, i) {
                this.chunk = e, this.encoding = t, this.callback = i, this.next = null
            }

            function o(t, i) {
                L = L || e("./_stream_duplex"), t = t || {}, this.objectMode = !!t.objectMode, i instanceof L && (this.objectMode = this.objectMode || !!t.writableObjectMode);
                var n = t.highWaterMark,
                    r = this.objectMode ? 16 : 16384;
                this.highWaterMark = n || 0 === n ? n : r, this.highWaterMark = ~~this.highWaterMark, this.needDrain = !1, this.ending = !1, this.ended = !1, this.finished = !1;
                var o = t.decodeStrings === !1;
                this.decodeStrings = !o, this.defaultEncoding = t.defaultEncoding || "utf8", this.length = 0, this.writing = !1, this.corked = 0, this.sync = !0, this.bufferProcessing = !1, this.onwrite = function(e) {
                    p(i, e)
                }, this.writecb = null, this.writelen = 0, this.bufferedRequest = null, this.lastBufferedRequest = null, this.pendingcb = 0, this.prefinished = !1, this.errorEmitted = !1, this.bufferedRequestCount = 0, this.corkedRequestsFree = new w(this), this.corkedRequestsFree.next = new w(this)
            }

            function a(t) {
                return L = L || e("./_stream_duplex"), this instanceof a || this instanceof L ? (this._writableState = new o(t, this), this.writable = !0, t && ("function" == typeof t.write && (this._write = t.write), "function" == typeof t.writev && (this._writev = t.writev)), void E.call(this)) : new a(t)
            }

            function s(e, t) {
                var i = new Error("write after end");
                e.emit("error", i), M(t, i)
            }

            function l(e, t, i, n) {
                var r = !0;
                if (!S.isBuffer(i) && "string" != typeof i && null !== i && void 0 !== i && !t.objectMode) {
                    var o = new TypeError("Invalid non-string/buffer chunk");
                    e.emit("error", o), M(n, o), r = !1
                }
                return r
            }

            function h(e, t, i) {
                return e.objectMode || e.decodeStrings === !1 || "string" != typeof t || (t = new S(t, i)), t
            }

            function u(e, t, i, n, o) {
                i = h(t, i, n), S.isBuffer(i) && (n = "buffer");
                var a = t.objectMode ? 1 : i.length;
                t.length += a;
                var s = t.length < t.highWaterMark;
                if (s || (t.needDrain = !0), t.writing || t.corked) {
                    var l = t.lastBufferedRequest;
                    t.lastBufferedRequest = new r(i, n, o), l ? l.next = t.lastBufferedRequest : t.bufferedRequest = t.lastBufferedRequest, t.bufferedRequestCount += 1
                } else d(e, t, !1, a, i, n, o);
                return s
            }

            function d(e, t, i, n, r, o, a) {
                t.writelen = n, t.writecb = a, t.writing = !0, t.sync = !0, i ? e._writev(r, t.onwrite) : e._write(r, o, t.onwrite), t.sync = !1
            }

            function c(e, t, i, n, r) {
                --t.pendingcb, i ? M(r, n) : r(n), e._writableState.errorEmitted = !0, e.emit("error", n)
            }

            function f(e) {
                e.writing = !1, e.writecb = null, e.length -= e.writelen, e.writelen = 0
            }

            function p(e, t) {
                var i = e._writableState,
                    n = i.sync,
                    r = i.writecb;
                if (f(i), t) c(e, i, n, t, r);
                else {
                    var o = v(i);
                    o || i.corked || i.bufferProcessing || !i.bufferedRequest || _(e, i), n ? T(m, e, i, o, r) : m(e, i, o, r)
                }
            }

            function m(e, t, i, n) {
                i || g(e, t), t.pendingcb--, n(), b(e, t)
            }

            function g(e, t) {
                0 === t.length && t.needDrain && (t.needDrain = !1, e.emit("drain"))
            }

            function _(e, t) {
                t.bufferProcessing = !0;
                var i = t.bufferedRequest;
                if (e._writev && i && i.next) {
                    var n = t.bufferedRequestCount,
                        r = new Array(n),
                        o = t.corkedRequestsFree;
                    o.entry = i;
                    for (var a = 0; i;) r[a] = i, i = i.next, a += 1;
                    d(e, t, !0, t.length, r, "", o.finish), t.pendingcb++, t.lastBufferedRequest = null, t.corkedRequestsFree = o.next, o.next = null
                } else {
                    for (; i;) {
                        var s = i.chunk,
                            l = i.encoding,
                            h = i.callback,
                            u = t.objectMode ? 1 : s.length;
                        if (d(e, t, !1, u, s, l, h), i = i.next, t.writing) break
                    }
                    null === i && (t.lastBufferedRequest = null)
                }
                t.bufferedRequestCount = 0, t.bufferedRequest = i, t.bufferProcessing = !1
            }

            function v(e) {
                return e.ending && 0 === e.length && null === e.bufferedRequest && !e.finished && !e.writing
            }

            function y(e, t) {
                t.prefinished || (t.prefinished = !0, e.emit("prefinish"))
            }

            function b(e, t) {
                var i = v(t);
                return i && (0 === t.pendingcb ? (y(e, t), t.finished = !0, e.emit("finish")) : y(e, t)), i
            }

            function x(e, t, i) {
                t.ending = !0, b(e, t), i && (t.finished ? M(i) : e.once("finish", i)), t.ended = !0, e.writable = !1
            }

            function w(e) {
                var t = this;
                this.next = null, this.entry = null, this.finish = function(i) {
                    var n = t.entry;
                    for (t.entry = null; n;) {
                        var r = n.callback;
                        e.pendingcb--, r(i), n = n.next
                    }
                    e.corkedRequestsFree ? e.corkedRequestsFree.next = t : e.corkedRequestsFree = t
                }
            }
            t.exports = a;
            var M = e("process-nextick-args"),
                T = !i.browser && ["v0.10", "v0.9."].indexOf(i.version.slice(0, 5)) > -1 ? setImmediate : M,
                S = e("buffer").Buffer;
            a.WritableState = o;
            var C = e("core-util-is");
            C.inherits = e("inherits");
            var E, k = {
                deprecate: e("util-deprecate")
            };
            ! function() {
                try {
                    E = e("stream")
                } catch (t) {} finally {
                    E || (E = e("events").EventEmitter)
                }
            }();
            var S = e("buffer").Buffer;
            C.inherits(a, E);
            var L;
            o.prototype.getBuffer = function() {
                    for (var e = this.bufferedRequest, t = []; e;) t.push(e), e = e.next;
                    return t
                },
                function() {
                    try {
                        Object.defineProperty(o.prototype, "buffer", {
                            get: k.deprecate(function() {
                                return this.getBuffer()
                            }, "_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")
                        })
                    } catch (e) {}
                }();
            var L;
            a.prototype.pipe = function() {
                this.emit("error", new Error("Cannot pipe. Not readable."))
            }, a.prototype.write = function(e, t, i) {
                var r = this._writableState,
                    o = !1;
                return "function" == typeof t && (i = t, t = null), S.isBuffer(e) ? t = "buffer" : t || (t = r.defaultEncoding), "function" != typeof i && (i = n), r.ended ? s(this, i) : l(this, r, e, i) && (r.pendingcb++, o = u(this, r, e, t, i)), o
            }, a.prototype.cork = function() {
                var e = this._writableState;
                e.corked++
            }, a.prototype.uncork = function() {
                var e = this._writableState;
                e.corked && (e.corked--, e.writing || e.corked || e.finished || e.bufferProcessing || !e.bufferedRequest || _(this, e))
            }, a.prototype.setDefaultEncoding = function(e) {
                if ("string" == typeof e && (e = e.toLowerCase()), !(["hex", "utf8", "utf-8", "ascii", "binary", "base64", "ucs2", "ucs-2", "utf16le", "utf-16le", "raw"].indexOf((e + "").toLowerCase()) > -1)) throw new TypeError("Unknown encoding: " + e);
                this._writableState.defaultEncoding = e
            }, a.prototype._write = function(e, t, i) {
                i(new Error("not implemented"))
            }, a.prototype._writev = null, a.prototype.end = function(e, t, i) {
                var n = this._writableState;
                "function" == typeof e ? (i = e, e = null, t = null) : "function" == typeof t && (i = t, t = null), null !== e && void 0 !== e && this.write(e, t), n.corked && (n.corked = 1, this.uncork()), n.ending || n.finished || x(this, n, i)
            }
        }).call(this, e("_process"))
    }, {
        "./_stream_duplex": 186,
        _process: 181,
        buffer: 6,
        "core-util-is": 8,
        events: 99,
        inherits: 107,
        "process-nextick-args": 180,
        "util-deprecate": 210
    }],
    191: [function(e, t, i) {
        arguments[4][7][0].apply(i, arguments)
    }, {
        dup: 7
    }],
    192: [function(e, t, i) {
        var n = function() {
            try {
                return e("stream")
            } catch (t) {}
        }();
        i = t.exports = e("./lib/_stream_readable.js"), i.Stream = n || i, i.Readable = i, i.Writable = e("./lib/_stream_writable.js"), i.Duplex = e("./lib/_stream_duplex.js"), i.Transform = e("./lib/_stream_transform.js"), i.PassThrough = e("./lib/_stream_passthrough.js")
    }, {
        "./lib/_stream_duplex.js": 186,
        "./lib/_stream_passthrough.js": 187,
        "./lib/_stream_readable.js": 188,
        "./lib/_stream_transform.js": 189,
        "./lib/_stream_writable.js": 190
    }],
    193: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            for (var i = new Array(e.length - 1), n = 1; n < e.length; ++n)
                for (var r = i[n - 1] = new Array(e.length - 1), o = 0, a = 0; o < e.length; ++o) o !== t && (r[a++] = e[n][o]);
            return i
        }

        function r(e) {
            for (var t = new Array(e), i = 0; e > i; ++i) {
                t[i] = new Array(e);
                for (var n = 0; e > n; ++n) t[i][n] = ["m", n, "[", e - i - 1, "]"].join("")
            }
            return t
        }

        function o(e) {
            return 1 & e ? "-" : ""
        }

        function a(e) {
            if (1 === e.length) return e[0];
            if (2 === e.length) return ["sum(", e[0], ",", e[1], ")"].join("");
            var t = e.length >> 1;
            return ["sum(", a(e.slice(0, t)), ",", a(e.slice(t)), ")"].join("")
        }

        function s(e) {
            if (2 === e.length) return [
                ["sum(prod(", e[0][0], ",", e[1][1], "),prod(-", e[0][1], ",", e[1][0], "))"].join("")
            ];
            for (var t = [], i = 0; i < e.length; ++i) t.push(["scale(", a(s(n(e, i))), ",", o(i), e[0][i], ")"].join(""));
            return t
        }

        function l(e) {
            for (var t = [], i = [], o = r(e), l = [], h = 0; e > h; ++h) 0 === (1 & h) ? t.push.apply(t, s(n(o, h))) : i.push.apply(i, s(n(o, h))), l.push("m" + h);
            var u = a(t),
                m = a(i),
                g = "orientation" + e + "Exact",
                _ = ["function ", g, "(", l.join(), "){var p=", u, ",n=", m, ",d=sub(p,n);return d[d.length-1];};return ", g].join(""),
                v = new Function("sum", "prod", "scale", "sub", _);
            return v(c, d, f, p)
        }

        function h(e) {
            var t = x[e.length];
            return t || (t = x[e.length] = l(e.length)), t.apply(void 0, e)
        }

        function u() {
            for (; x.length <= m;) x.push(l(x.length));
            for (var e = [], i = ["slow"], n = 0; m >= n; ++n) e.push("a" + n), i.push("o" + n);
            for (var r = ["function getOrientation(", e.join(), "){switch(arguments.length){case 0:case 1:return 0;"], n = 2; m >= n; ++n) r.push("case ", n, ":return o", n, "(", e.slice(0, n).join(), ");");
            r.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"), i.push(r.join(""));
            var o = Function.apply(void 0, i);
            t.exports = o.apply(void 0, [h].concat(x));
            for (var n = 0; m >= n; ++n) t.exports[n] = x[n]
        }
        var d = e("two-product"),
            c = e("robust-sum"),
            f = e("robust-scale"),
            p = e("robust-subtract"),
            m = 5,
            g = 1.1102230246251565e-16,
            _ = (3 + 16 * g) * g,
            v = (7 + 56 * g) * g,
            y = l(3),
            b = l(4),
            x = [function() {
                return 0
            }, function() {
                return 0
            }, function(e, t) {
                return t[0] - e[0]
            }, function(e, t, i) {
                var n, r = (e[1] - i[1]) * (t[0] - i[0]),
                    o = (e[0] - i[0]) * (t[1] - i[1]),
                    a = r - o;
                if (r > 0) {
                    if (0 >= o) return a;
                    n = r + o
                } else {
                    if (!(0 > r)) return a;
                    if (o >= 0) return a;
                    n = -(r + o)
                }
                var s = _ * n;
                return a >= s || -s >= a ? a : y(e, t, i)
            }, function(e, t, i, n) {
                var r = e[0] - n[0],
                    o = t[0] - n[0],
                    a = i[0] - n[0],
                    s = e[1] - n[1],
                    l = t[1] - n[1],
                    h = i[1] - n[1],
                    u = e[2] - n[2],
                    d = t[2] - n[2],
                    c = i[2] - n[2],
                    f = o * h,
                    p = a * l,
                    m = a * s,
                    g = r * h,
                    _ = r * l,
                    y = o * s,
                    x = u * (f - p) + d * (m - g) + c * (_ - y),
                    w = (Math.abs(f) + Math.abs(p)) * Math.abs(u) + (Math.abs(m) + Math.abs(g)) * Math.abs(d) + (Math.abs(_) + Math.abs(y)) * Math.abs(c),
                    M = v * w;
                return x > M || -x > M ? x : b(e, t, i, n)
            }];
        u()
    }, {
        "robust-scale": 195,
        "robust-subtract": 196,
        "robust-sum": 197,
        "two-product": 204
    }],
    194: [function(e, t, i) {
        function n(e, t) {
            for (var i = t[0], n = t[1], o = e.length, a = 1, s = o, l = 0, h = o - 1; s > l; h = l++) {
                var u = e[l],
                    d = e[h],
                    c = u[1],
                    f = d[1];
                if (c > f) {
                    if (n > f && c > n) {
                        var p = r(u, d, t);
                        if (0 === p) return 0;
                        a ^= p > 0 | 0
                    } else if (n === c) {
                        var m = e[(l + 1) % o],
                            g = m[1];
                        if (g > c) {
                            var p = r(u, d, t);
                            if (0 === p) return 0;
                            a ^= p > 0 | 0
                        }
                    }
                } else if (f > c) {
                    if (n > c && f > n) {
                        var p = r(u, d, t);
                        if (0 === p) return 0;
                        a ^= 0 > p | 0
                    } else if (n === c) {
                        var m = e[(l + 1) % o],
                            g = m[1];
                        if (c > g) {
                            var p = r(u, d, t);
                            if (0 === p) return 0;
                            a ^= 0 > p | 0
                        }
                    }
                } else if (n === c) {
                    var _ = Math.min(u[0], d[0]),
                        v = Math.max(u[0], d[0]);
                    if (0 === l) {
                        for (; h > 0;) {
                            var y = (h + o - 1) % o,
                                b = e[y];
                            if (b[1] !== n) break;
                            var x = b[0];
                            _ = Math.min(_, x), v = Math.max(v, x), h = y
                        }
                        if (0 === h) return i >= _ && v >= i ? 0 : 1;
                        s = h + 1
                    }
                    for (var w = e[(h + o - 1) % o][1]; s > l + 1;) {
                        var b = e[l + 1];
                        if (b[1] !== n) break;
                        var x = b[0];
                        _ = Math.min(_, x), v = Math.max(v, x), l += 1
                    }
                    if (i >= _ && v >= i) return 0;
                    var M = e[(l + 1) % o][1];
                    _ > i && n > w != n > M && (a ^= 1)
                }
            }
            return 2 * a - 1
        }
        t.exports = n;
        var r = e("robust-orientation")
    }, {
        "robust-orientation": 193
    }],
    195: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i = e.length;
            if (1 === i) {
                var n = r(e[0], t);
                return n[0] ? n : [n[1]]
            }
            var a = new Array(2 * i),
                s = [.1, .1],
                l = [.1, .1],
                h = 0;
            r(e[0], t, s), s[0] && (a[h++] = s[0]);
            for (var u = 1; i > u; ++u) {
                r(e[u], t, l);
                var d = s[1];
                o(d, l[0], s), s[0] && (a[h++] = s[0]);
                var c = l[1],
                    f = s[1],
                    p = c + f,
                    m = p - c,
                    g = f - m;
                s[1] = p, g && (a[h++] = g)
            }
            return s[1] && (a[h++] = s[1]), 0 === h && (a[h++] = 0), a.length = h, a
        }
        var r = e("two-product"),
            o = e("two-sum");
        t.exports = n
    }, {
        "two-product": 204,
        "two-sum": 205
    }],
    196: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i = e + t,
                n = i - e,
                r = i - n,
                o = t - n,
                a = e - r,
                s = a + o;
            return s ? [s, i] : [i]
        }

        function r(e, t) {
            var i = 0 | e.length,
                r = 0 | t.length;
            if (1 === i && 1 === r) return n(e[0], -t[0]);
            var o, a, s = i + r,
                l = new Array(s),
                h = 0,
                u = 0,
                d = 0,
                c = Math.abs,
                f = e[u],
                p = c(f),
                m = -t[d],
                g = c(m);
            g > p ? (a = f, u += 1, i > u && (f = e[u], p = c(f))) : (a = m, d += 1, r > d && (m = -t[d], g = c(m))), i > u && g > p || d >= r ? (o = f, u += 1, i > u && (f = e[u], p = c(f))) : (o = m, d += 1, r > d && (m = -t[d], g = c(m)));
            for (var _, v, y, b, x, w = o + a, M = w - o, T = a - M, S = T, C = w; i > u && r > d;) g > p ? (o = f, u += 1, i > u && (f = e[u], p = c(f))) : (o = m, d += 1, r > d && (m = -t[d], g = c(m))), a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _;
            for (; i > u;) o = f, a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _, u += 1, i > u && (f = e[u]);
            for (; r > d;) o = m, a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _, d += 1, r > d && (m = -t[d]);
            return S && (l[h++] = S), C && (l[h++] = C), h || (l[h++] = 0), l.length = h, l
        }
        t.exports = r
    }, {}],
    197: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i = e + t,
                n = i - e,
                r = i - n,
                o = t - n,
                a = e - r,
                s = a + o;
            return s ? [s, i] : [i]
        }

        function r(e, t) {
            var i = 0 | e.length,
                r = 0 | t.length;
            if (1 === i && 1 === r) return n(e[0], t[0]);
            var o, a, s = i + r,
                l = new Array(s),
                h = 0,
                u = 0,
                d = 0,
                c = Math.abs,
                f = e[u],
                p = c(f),
                m = t[d],
                g = c(m);
            g > p ? (a = f, u += 1, i > u && (f = e[u], p = c(f))) : (a = m, d += 1, r > d && (m = t[d], g = c(m))), i > u && g > p || d >= r ? (o = f, u += 1, i > u && (f = e[u], p = c(f))) : (o = m, d += 1, r > d && (m = t[d], g = c(m)));
            for (var _, v, y, b, x, w = o + a, M = w - o, T = a - M, S = T, C = w; i > u && r > d;) g > p ? (o = f, u += 1, i > u && (f = e[u], p = c(f))) : (o = m, d += 1, r > d && (m = t[d], g = c(m))), a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _;
            for (; i > u;) o = f, a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _, u += 1, i > u && (f = e[u]);
            for (; r > d;) o = m, a = S, w = o + a, M = w - o, T = a - M, T && (l[h++] = T), _ = C + w, v = _ - C, y = _ - v, b = w - v, x = C - y, S = x + b, C = _, d += 1, r > d && (m = t[d]);
            return S && (l[h++] = S), C && (l[h++] = C), h || (l[h++] = 0), l.length = h, l
        }
        t.exports = r
    }, {}],
    198: [function(e, t, i) {
        ! function() {
            "use strict";

            function e(e, t) {
                var i = e[0] - t[0],
                    n = e[1] - t[1];
                return i * i + n * n
            }

            function i(e, t, i) {
                var n = t[0],
                    r = t[1],
                    o = i[0] - n,
                    a = i[1] - r;
                if (0 !== o || 0 !== a) {
                    var s = ((e[0] - n) * o + (e[1] - r) * a) / (o * o + a * a);
                    s > 1 ? (n = i[0], r = i[1]) : s > 0 && (n += o * s, r += a * s)
                }
                return o = e[0] - n, a = e[1] - r, o * o + a * a
            }

            function n(t, i) {
                for (var n, r = t[0], o = [r], a = 1, s = t.length; s > a; a++) n = t[a], e(n, r) > i && (o.push(n), r = n);
                return r !== n && o.push(n), o
            }

            function r(e, t) {
                var n, r, o, a, s = e.length,
                    l = "undefined" != typeof Uint8Array ? Uint8Array : Array,
                    h = new l(s),
                    u = 0,
                    d = s - 1,
                    c = [],
                    f = [];
                for (h[u] = h[d] = 1; d;) {
                    for (r = 0, n = u + 1; d > n; n++) o = i(e[n], e[u], e[d]), o > r && (a = n, r = o);
                    r > t && (h[a] = 1, c.push(u, a, a, d)), d = c.pop(), u = c.pop()
                }
                for (n = 0; s > n; n++) h[n] && f.push(e[n]);
                return f
            }

            function o(e, t, i) {
                var o = void 0 !== t ? t * t : 1;
                return e = i ? e : n(e, o), e = r(e, o)
            }
            "function" == typeof define && define.amd ? define(function() {
                return o
            }) : "undefined" != typeof t ? t.exports = o : window.simplify = o
        }()
    }, {}],
    199: [function(e, t, i) {
        ! function() {
            "use strict";

            function e(e) {
                return e.clone ? e.clone() : {
                    x: e.x,
                    y: e.y
                }
            }

            function i(e, t) {
                var i = e.x - t.x,
                    n = e.y - t.y;
                return i * i + n * n
            }

            function n(e, t, i) {
                var n = t.x,
                    r = t.y,
                    o = i.x - n,
                    a = i.y - r;
                if (0 !== o || 0 !== a) {
                    var s = ((e.x - n) * o + (e.y - r) * a) / (o * o + a * a);
                    s > 1 ? (n = i.x, r = i.y) : s > 0 && (n += o * s, r += a * s)
                }
                return o = e.x - n, a = e.y - r, o * o + a * a
            }

            function r(e, t) {
                for (var n, r = e[0], o = [r], a = 1, s = e.length; s > a; a++) n = e[a], i(n, r) > t && (o.push(n), r = n);
                return r !== n && o.push(n), o
            }

            function o(t, r) {
                if (t.length <= 3 || i(t[0], t[t.length - 1]) > 0) return t;
                for (var o = 0, a = t[o], s = t.length - 2, l = t[s]; s > o + 1 && n(a, t[o + 1], l) <= r;) o++, a = t[o];
                return t = t.slice(o, -1), t.push(e(t[0])), t
            }

            function a(e, t) {
                var i, r, o, a, s = e.length,
                    l = "undefined" != typeof Uint8Array ? Uint8Array : Array,
                    h = new l(s),
                    u = 0,
                    d = s - 1,
                    c = [],
                    f = [];
                for (h[u] = h[d] = 1; d;) {
                    for (r = 0, i = u + 1; d > i; i++) o = n(e[i], e[u], e[d]), o > r && (a = i, r = o);
                    r > t && (h[a] = 1, c.push(u, a, a, d)), d = c.pop(), u = c.pop()
                }
                for (i = 0; s > i; i++) h[i] && f.push(e[i]);
                return f
            }

            function s(e, t, i) {
                if (e.length <= 1) return e;
                var n = void 0 !== t ? t * t : 1;
                return e = i ? e : r(e, n), e = i ? e : o(e, n), e = a(e, n)
            }
            "function" == typeof define && define.amd ? define(function() {
                return s
            }) : "undefined" != typeof t ? t.exports = s : "undefined" != typeof self ? self.simplify = s : window.simplify = s
        }()
    }, {}],
    200: [function(e, t, i) {
        function n(e) {
            return e * (Math.PI / 180)
        }

        function r(e) {
            return e * (180 / Math.PI)
        }
        var o = e("wgs84");
        t.exports.heading = function(e, t) {
            var i = Math.sin(Math.PI * (e[0] - t[0]) / 180) * Math.cos(Math.PI * t[1] / 180),
                n = Math.cos(Math.PI * e[1] / 180) * Math.sin(Math.PI * t[1] / 180) - Math.sin(Math.PI * e[1] / 180) * Math.cos(Math.PI * t[1] / 180) * Math.cos(Math.PI * (e[0] - t[0]) / 180);
            return 180 * Math.atan2(i, n) / Math.PI
        }, t.exports.distance = function(e, t, i) {
            i = i || o.RADIUS;
            var n = Math.sin(Math.PI * (t[0] - e[0]) / 360),
                r = Math.sin(Math.PI * (t[1] - e[1]) / 360),
                a = r * r + n * n * Math.cos(Math.PI * e[1] / 180) * Math.cos(Math.PI * t[1] / 180);
            return 2 * i * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))
        }, t.exports.radial = function(e, t, i, a, s) {
            s = s || o.RADIUS;
            var l, h = n(t),
                u = i / s,
                d = n(e[0]),
                c = n(e[1]),
                f = Math.asin(Math.sin(c) * Math.cos(u) + Math.cos(c) * Math.sin(u) * Math.cos(h)),
                p = Math.atan2(Math.sin(h) * Math.sin(u) * Math.cos(c), Math.cos(u) - Math.sin(c) * Math.sin(f));
            return l = a ? (d - p + Math.PI) % (2 * Math.PI) - Math.PI : d - p + Math.PI - Math.PI, [r(l), r(f)]
        }
    }, {
        wgs84: 214
    }],
    201: [function(e, t, i) {
        function n(e) {
            if (e && !l(e)) throw new Error("Unknown encoding: " + e)
        }

        function r(e) {
            return e.toString(this.encoding)
        }

        function o(e) {
            this.charReceived = e.length % 2, this.charLength = this.charReceived ? 2 : 0
        }

        function a(e) {
            this.charReceived = e.length % 3, this.charLength = this.charReceived ? 3 : 0
        }
        var s = e("buffer").Buffer,
            l = s.isEncoding || function(e) {
                switch (e && e.toLowerCase()) {
                    case "hex":
                    case "utf8":
                    case "utf-8":
                    case "ascii":
                    case "binary":
                    case "base64":
                    case "ucs2":
                    case "ucs-2":
                    case "utf16le":
                    case "utf-16le":
                    case "raw":
                        return !0;
                    default:
                        return !1
                }
            },
            h = i.StringDecoder = function(e) {
                switch (this.encoding = (e || "utf8").toLowerCase().replace(/[-_]/, ""), n(e), this.encoding) {
                    case "utf8":
                        this.surrogateSize = 3;
                        break;
                    case "ucs2":
                    case "utf16le":
                        this.surrogateSize = 2, this.detectIncompleteChar = o;
                        break;
                    case "base64":
                        this.surrogateSize = 3, this.detectIncompleteChar = a;
                        break;
                    default:
                        return void(this.write = r)
                }
                this.charBuffer = new s(6), this.charReceived = 0, this.charLength = 0
            };
        h.prototype.write = function(e) {
            for (var t = ""; this.charLength;) {
                var i = e.length >= this.charLength - this.charReceived ? this.charLength - this.charReceived : e.length;
                if (e.copy(this.charBuffer, this.charReceived, 0, i), this.charReceived += i, this.charReceived < this.charLength) return "";
                e = e.slice(i, e.length), t = this.charBuffer.slice(0, this.charLength).toString(this.encoding);
                var n = t.charCodeAt(t.length - 1);
                if (!(n >= 55296 && 56319 >= n)) {
                    if (this.charReceived = this.charLength = 0, 0 === e.length) return t;
                    break
                }
                this.charLength += this.surrogateSize, t = ""
            }
            this.detectIncompleteChar(e);
            var r = e.length;
            this.charLength && (e.copy(this.charBuffer, 0, e.length - this.charReceived, r), r -= this.charReceived), t += e.toString(this.encoding, 0, r);
            var r = t.length - 1,
                n = t.charCodeAt(r);
            if (n >= 55296 && 56319 >= n) {
                var o = this.surrogateSize;
                return this.charLength += o, this.charReceived += o, this.charBuffer.copy(this.charBuffer, o, 0, o), e.copy(this.charBuffer, 0, 0, o), t.substring(0, r)
            }
            return t
        }, h.prototype.detectIncompleteChar = function(e) {
            for (var t = e.length >= 3 ? 3 : e.length; t > 0; t--) {
                var i = e[e.length - t];
                if (1 == t && i >> 5 == 6) {
                    this.charLength = 2;
                    break
                }
                if (2 >= t && i >> 4 == 14) {
                    this.charLength = 3;
                    break
                }
                if (3 >= t && i >> 3 == 30) {
                    this.charLength = 4;
                    break
                }
            }
            this.charReceived = t
        }, h.prototype.end = function(e) {
            var t = "";
            if (e && e.length && (t = this.write(e)), this.charReceived) {
                var i = this.charReceived,
                    n = this.charBuffer,
                    r = this.encoding;
                t += n.slice(0, i).toString(r)
            }
            return t
        }
    }, {
        buffer: 6
    }],
    202: [function(e, t, i) {
        ! function() {
            "use strict";

            function e(e) {
                return e.valueOf() / L - .5 + P
            }

            function n(e) {
                return new Date((e + .5 - P) * L)
            }

            function r(t) {
                return e(t) - A
            }

            function o(e, t) {
                return C(w(e) * M(R) - T(t) * w(R), M(e))
            }

            function a(e, t) {
                return S(w(t) * M(R) + M(t) * w(R) * w(e))
            }

            function s(e, t, i) {
                return C(w(e), M(e) * w(t) - T(i) * M(t))
            }

            function l(e, t, i) {
                return S(w(t) * w(i) + M(t) * M(i) * M(e))
            }

            function h(e, t) {
                return k * (280.16 + 360.9856235 * e) - t
            }

            function u(e) {
                return 0 > e && (e = 0), 2967e-7 / Math.tan(e + .00312536 / (e + .08901179))
            }

            function d(e) {
                return k * (357.5291 + .98560028 * e)
            }

            function c(e) {
                var t = k * (1.9148 * w(e) + .02 * w(2 * e) + 3e-4 * w(3 * e)),
                    i = 102.9372 * k;
                return e + t + i + x
            }

            function f(e) {
                var t = d(e),
                    i = c(t);
                return {
                    dec: a(i, 0),
                    ra: o(i, 0)
                }
            }

            function p(e, t) {
                return Math.round(e - O - t / (2 * x))
            }

            function m(e, t, i) {
                return O + (e + t) / (2 * x) + i
            }

            function g(e, t, i) {
                return A + e + .0053 * w(t) - .0069 * w(2 * i)
            }

            function _(e, t, i) {
                return E((w(e) - w(t) * w(i)) / (M(t) * M(i)))
            }

            function v(e, t, i, n, r, o, a) {
                var s = _(e, i, n),
                    l = m(s, t, r);
                return g(l, o, a)
            }

            function y(e) {
                var t = k * (218.316 + 13.176396 * e),
                    i = k * (134.963 + 13.064993 * e),
                    n = k * (93.272 + 13.22935 * e),
                    r = t + 6.289 * k * w(i),
                    s = 5.128 * k * w(n),
                    l = 385001 - 20905 * M(i);
                return {
                    ra: o(r, s),
                    dec: a(r, s),
                    dist: l
                }
            }

            function b(e, t) {
                return new Date(e.valueOf() + t * L / 24)
            }
            var x = Math.PI,
                w = Math.sin,
                M = Math.cos,
                T = Math.tan,
                S = Math.asin,
                C = Math.atan2,
                E = Math.acos,
                k = x / 180,
                L = 864e5,
                P = 2440588,
                A = 2451545,
                R = 23.4397 * k,
                D = {};
            D.getPosition = function(e, t, i) {
                var n = k * -i,
                    o = k * t,
                    a = r(e),
                    u = f(a),
                    d = h(a, n) - u.ra;
                return {
                    azimuth: s(d, o, u.dec),
                    altitude: l(d, o, u.dec)
                }
            };
            var I = D.times = [
                [-.833, "sunrise", "sunset"],
                [-.3, "sunriseEnd", "sunsetStart"],
                [-6, "dawn", "dusk"],
                [-12, "nauticalDawn", "nauticalDusk"],
                [-18, "nightEnd", "night"],
                [6, "goldenHourEnd", "goldenHour"]
            ];
            D.addTime = function(e, t, i) {
                I.push([e, t, i])
            };
            var O = 9e-4;
            D.getTimes = function(e, t, i) {
                var o, s, l, h, u, f = k * -i,
                    _ = k * t,
                    y = r(e),
                    b = p(y, f),
                    x = m(0, f, b),
                    w = d(x),
                    M = c(w),
                    T = a(M, 0),
                    S = g(x, w, M),
                    C = {
                        solarNoon: n(S),
                        nadir: n(S - .5)
                    };
                for (o = 0, s = I.length; s > o; o += 1) l = I[o], h = v(l[0] * k, f, _, T, b, w, M), u = S - (h - S), C[l[1]] = n(u), C[l[2]] = n(h);
                return C
            }, D.getMoonPosition = function(e, t, i) {
                var n = k * -i,
                    o = k * t,
                    a = r(e),
                    d = y(a),
                    c = h(a, n) - d.ra,
                    f = l(c, o, d.dec),
                    p = C(w(c), T(o) * M(d.dec) - w(d.dec) * M(c));
                return f += u(f), {
                    azimuth: s(c, o, d.dec),
                    altitude: f,
                    distance: d.dist,
                    parallacticAngle: p
                }
            }, D.getMoonIllumination = function(e) {
                var t = r(e || new Date),
                    i = f(t),
                    n = y(t),
                    o = 149598e3,
                    a = E(w(i.dec) * w(n.dec) + M(i.dec) * M(n.dec) * M(i.ra - n.ra)),
                    s = C(o * w(a), n.dist - o * M(a)),
                    l = C(M(i.dec) * w(i.ra - n.ra), w(i.dec) * M(n.dec) - M(i.dec) * w(n.dec) * M(i.ra - n.ra));
                return {
                    fraction: (1 + M(s)) / 2,
                    phase: .5 + .5 * s * (0 > l ? -1 : 1) / Math.PI,
                    angle: l
                }
            }, D.getMoonTimes = function(e, t, i, n) {
                var r = new Date(e);
                n ? r.setUTCHours(0, 0, 0, 0) : r.setHours(0, 0, 0, 0);
                for (var o, a, s, l, h, u, d, c, f, p, m, g, _, v = .133 * k, y = D.getMoonPosition(r, t, i).altitude - v, x = 1; 24 >= x && (o = D.getMoonPosition(b(r, x), t, i).altitude - v, a = D.getMoonPosition(b(r, x + 1), t, i).altitude - v, h = (y + a) / 2 - o, u = (a - y) / 2, d = -u / (2 * h), c = (h * d + u) * d + o, f = u * u - 4 * h * o, p = 0, f >= 0 && (_ = Math.sqrt(f) / (2 * Math.abs(h)), m = d - _, g = d + _, Math.abs(m) <= 1 && p++, Math.abs(g) <= 1 && p++, -1 > m && (m = g)), 1 === p ? 0 > y ? s = x + m : l = x + m : 2 === p && (s = x + (0 > c ? g : m), l = x + (0 > c ? m : g)), !s || !l); x += 2) y = a;
                var w = {};
                return s && (w.rise = b(r, s)), l && (w.set = b(r, l)), s || l || (w[c > 0 ? "alwaysUp" : "alwaysDown"] = !0), w
            }, "object" == typeof i && "undefined" != typeof t ? t.exports = D : "function" == typeof define && define.amd ? define(D) : window.SunCalc = D
        }()
    }, {}],
    203: [function(e, t, i) {
        (function(n) {
            var r = function() {
                "use strict";

                function t(e) {
                    if (!e || !e.length) return 0;
                    for (var t = 0, i = 0; t < e.length; t++) i = (i << 5) - i + e.charCodeAt(t) | 0;
                    return i
                }

                function r(e, t) {
                    return e.getElementsByTagName(t)
                }

                function o(e, t) {
                    return e.getAttribute(t)
                }

                function a(e, t) {
                    return parseFloat(o(e, t))
                }

                function s(e, t) {
                    var i = r(e, t);
                    return i.length ? i[0] : null
                }

                function l(e) {
                    return e.normalize && e.normalize(), e
                }

                function h(e) {
                    for (var t = 0, i = []; t < e.length; t++) i[t] = parseFloat(e[t]);
                    return i
                }

                function u(e) {
                    var t = {};
                    for (var i in e) e[i] && (t[i] = e[i]);
                    return t
                }

                function d(e) {
                    return e && l(e), e && e.firstChild && e.firstChild.nodeValue || ""
                }

                function c(e) {
                    return h(e.replace(v, "").split(","))
                }

                function f(e) {
                    for (var t = e.replace(y, "").split(b), i = [], n = 0; n < t.length; n++) i.push(c(t[n]));
                    return i
                }

                function p(e) {
                    var t, i = [a(e, "lon"), a(e, "lat")],
                        n = s(e, "ele"),
                        r = s(e, "gpxtpx:hr") || s(e, "hr"),
                        o = s(e, "time");
                    return n && (t = parseFloat(d(n)), t && i.push(t)), {
                        coordinates: i,
                        time: o ? d(o) : null,
                        heartRate: r ? parseFloat(d(r)) : null
                    }
                }

                function m() {
                    return {
                        type: "FeatureCollection",
                        features: []
                    }
                }

                function g(e) {
                    return void 0 !== e.xml ? e.xml : _.serializeToString(e)
                }
                var _, v = /\s*/g,
                    y = /^\s*|\s*$/g,
                    b = /\s+/;
                "undefined" != typeof XMLSerializer ? _ = new XMLSerializer : "object" != typeof i || "object" != typeof n || n.browser || (_ = new(e("xmldom").XMLSerializer));
                var x = {
                    kml: function(e) {
                        function i(e) {
                            var t, i;
                            return e = e || "", "#" === e.substr(0, 1) && (e = e.substr(1)), (6 === e.length || 3 === e.length) && (t = e), 8 === e.length && (i = parseInt(e.substr(0, 2), 16) / 255, t = e.substr(2)), [t, isNaN(i) ? void 0 : i]
                        }

                        function n(e) {
                            return h(e.split(" "))
                        }

                        function a(e) {
                            var t = r(e, "coord", "gx"),
                                i = [],
                                o = [];
                            0 === t.length && (t = r(e, "gx:coord"));
                            for (var a = 0; a < t.length; a++) i.push(n(d(t[a])));
                            for (var s = r(e, "when"), a = 0; a < s.length; a++) o.push(d(s[a]));
                            return {
                                coords: i,
                                times: o
                            }
                        }

                        function l(e) {
                            var t, i, n, o, h, u = [],
                                p = [];
                            if (s(e, "MultiGeometry")) return l(s(e, "MultiGeometry"));
                            if (s(e, "MultiTrack")) return l(s(e, "MultiTrack"));
                            if (s(e, "gx:MultiTrack")) return l(s(e, "gx:MultiTrack"));
                            for (n = 0; n < v.length; n++)
                                if (i = r(e, v[n]))
                                    for (o = 0; o < i.length; o++)
                                        if (t = i[o], "Point" === v[n]) u.push({
                                            type: "Point",
                                            coordinates: c(d(s(t, "coordinates")))
                                        });
                                        else if ("LineString" === v[n]) u.push({
                                type: "LineString",
                                coordinates: f(d(s(t, "coordinates")))
                            });
                            else if ("Polygon" === v[n]) {
                                var m = r(t, "LinearRing"),
                                    g = [];
                                for (h = 0; h < m.length; h++) g.push(f(d(s(m[h], "coordinates"))));
                                u.push({
                                    type: "Polygon",
                                    coordinates: g
                                })
                            } else if ("Track" === v[n] || "gx:Track" === v[n]) {
                                var _ = a(t);
                                u.push({
                                    type: "LineString",
                                    coordinates: _.coords
                                }), _.times.length && p.push(_.times)
                            }
                            return {
                                geoms: u,
                                coordTimes: p
                            }
                        }

                        function u(e) {
                            var t, n = l(e),
                                a = {},
                                h = d(s(e, "name")),
                                u = d(s(e, "styleUrl")),
                                c = d(s(e, "description")),
                                f = s(e, "TimeSpan"),
                                p = s(e, "ExtendedData"),
                                m = s(e, "LineStyle"),
                                g = s(e, "PolyStyle");
                            if (!n.geoms.length) return [];
                            if (h && (a.name = h), u && _[u] && (a.styleUrl = u, a.styleHash = _[u]), c && (a.description = c), f) {
                                var v = d(s(f, "begin")),
                                    y = d(s(f, "end"));
                                a.timespan = {
                                    begin: v,
                                    end: y
                                }
                            }
                            if (m) {
                                var b = i(d(s(m, "color"))),
                                    x = b[0],
                                    w = b[1],
                                    M = parseFloat(d(s(m, "width")));
                                x && (a.stroke = x), isNaN(w) || (a["stroke-opacity"] = w), isNaN(M) || (a["stroke-width"] = M)
                            }
                            if (g) {
                                var T = i(d(s(g, "color"))),
                                    S = T[0],
                                    C = T[1],
                                    E = d(s(g, "fill")),
                                    k = d(s(g, "outline"));
                                S && (a.fill = S), isNaN(C) || (a["fill-opacity"] = C), E && (a["fill-opacity"] = "1" === E ? 1 : 0), k && (a["stroke-opacity"] = "1" === k ? 1 : 0)
                            }
                            if (p) {
                                var L = r(p, "Data"),
                                    P = r(p, "SimpleData");
                                for (t = 0; t < L.length; t++) a[L[t].getAttribute("name")] = d(s(L[t], "value"));
                                for (t = 0; t < P.length; t++) a[P[t].getAttribute("name")] = d(P[t])
                            }
                            n.coordTimes.length && (a.coordTimes = 1 === n.coordTimes.length ? n.coordTimes[0] : n.coordTimes);
                            var A = {
                                type: "Feature",
                                geometry: 1 === n.geoms.length ? n.geoms[0] : {
                                    type: "GeometryCollection",
                                    geometries: n.geoms
                                },
                                properties: a
                            };
                            return o(e, "id") && (A.id = o(e, "id")), [A]
                        }
                        for (var p = m(), _ = {}, v = ["Polygon", "LineString", "Point", "Track", "gx:Track"], y = r(e, "Placemark"), b = r(e, "Style"), x = 0; x < b.length; x++) _["#" + o(b[x], "id")] = t(g(b[x])).toString(16);
                        for (var w = 0; w < y.length; w++) p.features = p.features.concat(u(y[w]));
                        return p
                    },
                    gpx: function(e) {
                        function t(e, t) {
                            var i = r(e, t),
                                n = [],
                                o = [],
                                a = [],
                                s = i.length;
                            if (2 > s) return {};
                            for (var l = 0; s > l; l++) {
                                var h = p(i[l]);
                                n.push(h.coordinates), h.time && o.push(h.time), h.heartRate && a.push(h.heartRate)
                            }
                            return {
                                line: n,
                                times: o,
                                heartRates: a
                            }
                        }

                        function i(e) {
                            for (var i, n = r(e, "trkseg"), o = [], s = [], l = [], h = 0; h < n.length; h++) i = t(n[h], "trkpt"), i.line && o.push(i.line), i.times && i.times.length && s.push(i.times), i.heartRates && i.heartRates.length && l.push(i.heartRates);
                            if (0 !== o.length) {
                                var u = a(e);
                                return s.length && (u.coordTimes = 1 === o.length ? s[0] : s), l.length && (u.heartRates = 1 === o.length ? l[0] : l), {
                                    type: "Feature",
                                    properties: u,
                                    geometry: {
                                        type: 1 === o.length ? "LineString" : "MultiLineString",
                                        coordinates: 1 === o.length ? o[0] : o
                                    }
                                }
                            }
                        }

                        function n(e) {
                            var i = t(e, "rtept");
                            if (i) {
                                var n = {
                                    type: "Feature",
                                    properties: a(e),
                                    geometry: {
                                        type: "LineString",
                                        coordinates: i
                                    }
                                };
                                return i.times.length && (n.geometry.times = i.times), n
                            }
                        }

                        function o(e) {
                            var t = a(e);
                            return t.sym = d(s(e, "sym")), {
                                type: "Feature",
                                properties: t,
                                geometry: {
                                    type: "Point",
                                    coordinates: p(e).coordinates
                                }
                            }
                        }

                        function a(e) {
                            var t, i = ["name", "desc", "author", "copyright", "link", "time", "keywords"],
                                n = {};
                            for (t = 0; t < i.length; t++) n[i[t]] = d(s(e, i[t]));
                            return u(n)
                        }
                        var l, h, c = r(e, "trk"),
                            f = r(e, "rte"),
                            g = r(e, "wpt"),
                            _ = m();
                        for (l = 0; l < c.length; l++) h = i(c[l]), h && _.features.push(h);
                        for (l = 0; l < f.length; l++) h = n(f[l]), h && _.features.push(h);
                        for (l = 0; l < g.length; l++) _.features.push(o(g[l]));
                        return _
                    }
                };
                return x
            }();
            "undefined" != typeof t && (t.exports = r)
        }).call(this, e("_process"))
    }, {
        _process: 181,
        xmldom: 5
    }],
    204: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = e * t,
                o = r * e,
                a = o - e,
                s = o - a,
                l = e - s,
                h = r * t,
                u = h - t,
                d = h - u,
                c = t - d,
                f = n - s * d,
                p = f - l * d,
                m = p - s * c,
                g = l * c - m;
            return i ? (i[0] = g, i[1] = n, i) : [g, n]
        }
        t.exports = n;
        var r = +(Math.pow(2, 27) + 1)
    }, {}],
    205: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = e + t,
                r = n - e,
                o = n - r,
                a = t - r,
                s = e - o;
            return i ? (i[0] = s + a, i[1] = n, i) : [s + a, n]
        }
        t.exports = n
    }, {}],
    206: [function(e, t, i) {
        ! function(e, n) {
            "use strict";

            function r(e, t) {
                var i, n, r = e.toLowerCase();
                for (t = [].concat(t), i = 0; i < t.length; i += 1)
                    if (n = t[i]) {
                        if (n.test && n.test(e)) return !0;
                        if (n.toLowerCase() === r) return !0
                    }
            }
            var o = n.prototype.trim,
                a = n.prototype.trimRight,
                s = n.prototype.trimLeft,
                l = function(e) {
                    return 1 * e || 0
                },
                h = function(e, t) {
                    if (1 > t) return "";
                    for (var i = ""; t > 0;) 1 & t && (i += e), t >>= 1, e += e;
                    return i
                },
                u = [].slice,
                d = function(e) {
                    return null == e ? "\\s" : e.source ? e.source : "[" + g.escapeRegExp(e) + "]"
                },
                c = {
                    lt: "<",
                    gt: ">",
                    quot: '"',
                    amp: "&",
                    apos: "'"
                },
                f = {};
            for (var p in c) f[c[p]] = p;
            f["'"] = "#39";
            var m = function() {
                    function e(e) {
                        return Object.prototype.toString.call(e).slice(8, -1).toLowerCase()
                    }
                    var t = h,
                        i = function() {
                            return i.cache.hasOwnProperty(arguments[0]) || (i.cache[arguments[0]] = i.parse(arguments[0])), i.format.call(null, i.cache[arguments[0]], arguments)
                        };
                    return i.format = function(i, r) {
                        var o, a, s, l, h, u, d, c = 1,
                            f = i.length,
                            p = "",
                            g = [];
                        for (a = 0; f > a; a++)
                            if (p = e(i[a]), "string" === p) g.push(i[a]);
                            else if ("array" === p) {
                            if (l = i[a], l[2])
                                for (o = r[c], s = 0; s < l[2].length; s++) {
                                    if (!o.hasOwnProperty(l[2][s])) throw new Error(m('[_.sprintf] property "%s" does not exist', l[2][s]));
                                    o = o[l[2][s]]
                                } else o = l[1] ? r[l[1]] : r[c++];
                            if (/[^s]/.test(l[8]) && "number" != e(o)) throw new Error(m("[_.sprintf] expecting number but found %s", e(o)));
                            switch (l[8]) {
                                case "b":
                                    o = o.toString(2);
                                    break;
                                case "c":
                                    o = n.fromCharCode(o);
                                    break;
                                case "d":
                                    o = parseInt(o, 10);
                                    break;
                                case "e":
                                    o = l[7] ? o.toExponential(l[7]) : o.toExponential();
                                    break;
                                case "f":
                                    o = l[7] ? parseFloat(o).toFixed(l[7]) : parseFloat(o);
                                    break;
                                case "o":
                                    o = o.toString(8);
                                    break;
                                case "s":
                                    o = (o = n(o)) && l[7] ? o.substring(0, l[7]) : o;
                                    break;
                                case "u":
                                    o = Math.abs(o);
                                    break;
                                case "x":
                                    o = o.toString(16);
                                    break;
                                case "X":
                                    o = o.toString(16).toUpperCase()
                            }
                            o = /[def]/.test(l[8]) && l[3] && o >= 0 ? "+" + o : o, u = l[4] ? "0" == l[4] ? "0" : l[4].charAt(1) : " ", d = l[6] - n(o).length, h = l[6] ? t(u, d) : "", g.push(l[5] ? o + h : h + o)
                        }
                        return g.join("")
                    }, i.cache = {}, i.parse = function(e) {
                        for (var t = e, i = [], n = [], r = 0; t;) {
                            if (null !== (i = /^[^\x25]+/.exec(t))) n.push(i[0]);
                            else if (null !== (i = /^\x25{2}/.exec(t))) n.push("%");
                            else {
                                if (null === (i = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))) throw new Error("[_.sprintf] huh?");
                                if (i[2]) {
                                    r |= 1;
                                    var o = [],
                                        a = i[2],
                                        s = [];
                                    if (null === (s = /^([a-z_][a-z_\d]*)/i.exec(a))) throw new Error("[_.sprintf] huh?");
                                    for (o.push(s[1]);
                                        "" !== (a = a.substring(s[0].length));)
                                        if (null !== (s = /^\.([a-z_][a-z_\d]*)/i.exec(a))) o.push(s[1]);
                                        else {
                                            if (null === (s = /^\[(\d+)\]/.exec(a))) throw new Error("[_.sprintf] huh?");
                                            o.push(s[1])
                                        }
                                    i[2] = o
                                } else r |= 2;
                                if (3 === r) throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");
                                n.push(i)
                            }
                            t = t.substring(i[0].length)
                        }
                        return n
                    }, i
                }(),
                g = {
                    VERSION: "2.3.0",
                    isBlank: function(e) {
                        return null == e && (e = ""), /^\s*$/.test(e)
                    },
                    stripTags: function(e) {
                        return null == e ? "" : n(e).replace(/<\/?[^>]+>/g, "")
                    },
                    capitalize: function(e) {
                        return e = null == e ? "" : n(e), e.charAt(0).toUpperCase() + e.slice(1)
                    },
                    chop: function(e, t) {
                        return null == e ? [] : (e = n(e), t = ~~t, t > 0 ? e.match(new RegExp(".{1," + t + "}", "g")) : [e])
                    },
                    clean: function(e) {
                        return g.strip(e).replace(/\s+/g, " ")
                    },
                    count: function(e, t) {
                        if (null == e || null == t) return 0;
                        e = n(e), t = n(t);
                        for (var i = 0, r = 0, o = t.length;;) {
                            if (r = e.indexOf(t, r), -1 === r) break;
                            i++, r += o
                        }
                        return i
                    },
                    chars: function(e) {
                        return null == e ? [] : n(e).split("")
                    },
                    swapCase: function(e) {
                        return null == e ? "" : n(e).replace(/\S/g, function(e) {
                            return e === e.toUpperCase() ? e.toLowerCase() : e.toUpperCase()
                        })
                    },
                    escapeHTML: function(e) {
                        return null == e ? "" : n(e).replace(/[&<>"']/g, function(e) {
                            return "&" + f[e] + ";"
                        })
                    },
                    unescapeHTML: function(e) {
                        return null == e ? "" : n(e).replace(/\&([^;]+);/g, function(e, t) {
                            var i;
                            return t in c ? c[t] : (i = t.match(/^#x([\da-fA-F]+)$/)) ? n.fromCharCode(parseInt(i[1], 16)) : (i = t.match(/^#(\d+)$/)) ? n.fromCharCode(~~i[1]) : e
                        })
                    },
                    escapeRegExp: function(e) {
                        return null == e ? "" : n(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1")
                    },
                    splice: function(e, t, i, n) {
                        var r = g.chars(e);
                        return r.splice(~~t, ~~i, n), r.join("")
                    },
                    insert: function(e, t, i) {
                        return g.splice(e, t, 0, i)
                    },
                    include: function(e, t) {
                        return "" === t ? !0 : null == e ? !1 : -1 !== n(e).indexOf(t)
                    },
                    join: function() {
                        var e = u.call(arguments),
                            t = e.shift();
                        return null == t && (t = ""), e.join(t)
                    },
                    lines: function(e) {
                        return null == e ? [] : n(e).split("\n")
                    },
                    reverse: function(e) {
                        return g.chars(e).reverse().join("")
                    },
                    startsWith: function(e, t) {
                        return "" === t ? !0 : null == e || null == t ? !1 : (e = n(e), t = n(t), e.length >= t.length && e.slice(0, t.length) === t);
                    },
                    endsWith: function(e, t) {
                        return "" === t ? !0 : null == e || null == t ? !1 : (e = n(e), t = n(t), e.length >= t.length && e.slice(e.length - t.length) === t)
                    },
                    succ: function(e) {
                        return null == e ? "" : (e = n(e), e.slice(0, -1) + n.fromCharCode(e.charCodeAt(e.length - 1) + 1))
                    },
                    titleize: function(e) {
                        return null == e ? "" : (e = n(e).toLowerCase(), e.replace(/(?:^|\s|-)\S/g, function(e) {
                            return e.toUpperCase()
                        }))
                    },
                    camelize: function(e) {
                        return g.trim(e).replace(/[-_\s]+(.)?/g, function(e, t) {
                            return t ? t.toUpperCase() : ""
                        })
                    },
                    underscored: function(e) {
                        return g.trim(e).replace(/([a-z\d])([A-Z]+)/g, "$1_$2").replace(/[-\s]+/g, "_").toLowerCase()
                    },
                    dasherize: function(e) {
                        return g.trim(e).replace(/([A-Z])/g, "-$1").replace(/[-_\s]+/g, "-").toLowerCase()
                    },
                    classify: function(e) {
                        return g.titleize(n(e).replace(/[\W_]/g, " ")).replace(/\s/g, "")
                    },
                    humanize: function(e) {
                        return g.capitalize(g.underscored(e).replace(/_id$/, "").replace(/_/g, " "))
                    },
                    trim: function(e, t) {
                        return null == e ? "" : !t && o ? o.call(e) : (t = d(t), n(e).replace(new RegExp("^" + t + "+|" + t + "+$", "g"), ""))
                    },
                    ltrim: function(e, t) {
                        return null == e ? "" : !t && s ? s.call(e) : (t = d(t), n(e).replace(new RegExp("^" + t + "+"), ""))
                    },
                    rtrim: function(e, t) {
                        return null == e ? "" : !t && a ? a.call(e) : (t = d(t), n(e).replace(new RegExp(t + "+$"), ""))
                    },
                    truncate: function(e, t, i) {
                        return null == e ? "" : (e = n(e), i = i || "...", t = ~~t, e.length > t ? e.slice(0, t) + i : e)
                    },
                    prune: function(e, t, i) {
                        if (null == e) return "";
                        if (e = n(e), t = ~~t, i = null != i ? n(i) : "...", e.length <= t) return e;
                        var r = function(e) {
                                return e.toUpperCase() !== e.toLowerCase() ? "A" : " "
                            },
                            o = e.slice(0, t + 1).replace(/.(?=\W*\w*$)/g, r);
                        return o = o.slice(o.length - 2).match(/\w\w/) ? o.replace(/\s*\S+$/, "") : g.rtrim(o.slice(0, o.length - 1)), (o + i).length > e.length ? e : e.slice(0, o.length) + i
                    },
                    words: function(e, t) {
                        return g.isBlank(e) ? [] : g.trim(e, t).split(t || /\s+/)
                    },
                    pad: function(e, t, i, r) {
                        e = null == e ? "" : n(e), t = ~~t;
                        var o = 0;
                        switch (i ? i.length > 1 && (i = i.charAt(0)) : i = " ", r) {
                            case "right":
                                return o = t - e.length, e + h(i, o);
                            case "both":
                                return o = t - e.length, h(i, Math.ceil(o / 2)) + e + h(i, Math.floor(o / 2));
                            default:
                                return o = t - e.length, h(i, o) + e
                        }
                    },
                    lpad: function(e, t, i) {
                        return g.pad(e, t, i)
                    },
                    rpad: function(e, t, i) {
                        return g.pad(e, t, i, "right")
                    },
                    lrpad: function(e, t, i) {
                        return g.pad(e, t, i, "both")
                    },
                    sprintf: m,
                    vsprintf: function(e, t) {
                        return t.unshift(e), m.apply(null, t)
                    },
                    toNumber: function(e, t) {
                        return e ? (e = g.trim(e), e.match(/^-?\d+(?:\.\d+)?$/) ? l(l(e).toFixed(~~t)) : NaN) : 0
                    },
                    numberFormat: function(e, t, i, n) {
                        if (isNaN(e) || null == e) return "";
                        e = e.toFixed(~~t), n = "string" == typeof n ? n : ",";
                        var r = e.split("."),
                            o = r[0],
                            a = r[1] ? (i || ".") + r[1] : "";
                        return o.replace(/(\d)(?=(?:\d{3})+$)/g, "$1" + n) + a
                    },
                    strRight: function(e, t) {
                        if (null == e) return "";
                        e = n(e), t = null != t ? n(t) : t;
                        var i = t ? e.indexOf(t) : -1;
                        return ~i ? e.slice(i + t.length, e.length) : e
                    },
                    strRightBack: function(e, t) {
                        if (null == e) return "";
                        e = n(e), t = null != t ? n(t) : t;
                        var i = t ? e.lastIndexOf(t) : -1;
                        return ~i ? e.slice(i + t.length, e.length) : e
                    },
                    strLeft: function(e, t) {
                        if (null == e) return "";
                        e = n(e), t = null != t ? n(t) : t;
                        var i = t ? e.indexOf(t) : -1;
                        return ~i ? e.slice(0, i) : e
                    },
                    strLeftBack: function(e, t) {
                        if (null == e) return "";
                        e += "", t = null != t ? "" + t : t;
                        var i = e.lastIndexOf(t);
                        return ~i ? e.slice(0, i) : e
                    },
                    toSentence: function(e, t, i, n) {
                        t = t || ", ", i = i || " and ";
                        var r = e.slice(),
                            o = r.pop();
                        return e.length > 2 && n && (i = g.rtrim(t) + i), r.length ? r.join(t) + i + o : o
                    },
                    toSentenceSerial: function() {
                        var e = u.call(arguments);
                        return e[3] = !0, g.toSentence.apply(g, e)
                    },
                    slugify: function(e) {
                        if (null == e) return "";
                        var t = "Ä…Ã Ã¡Ã¤Ã¢Ã£Ã¥Ã¦ÄƒÄ‡Ä™Ã¨Ã©Ã«ÃªÃ¬Ã­Ã¯Ã®Å‚Å„Ã²Ã³Ã¶Ã´ÃµÃ¸Å›È™È›Ã¹ÃºÃ¼Ã»Ã±Ã§Å¼Åº",
                            i = "aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",
                            r = new RegExp(d(t), "g");
                        return e = n(e).toLowerCase().replace(r, function(e) {
                            var n = t.indexOf(e);
                            return i.charAt(n) || "-"
                        }), g.dasherize(e.replace(/[^\w\s-]/g, ""))
                    },
                    surround: function(e, t) {
                        return [t, e, t].join("")
                    },
                    quote: function(e, t) {
                        return g.surround(e, t || '"')
                    },
                    unquote: function(e, t) {
                        return t = t || '"', e[0] === t && e[e.length - 1] === t ? e.slice(1, e.length - 1) : e
                    },
                    exports: function() {
                        var e = {};
                        for (var t in this) this.hasOwnProperty(t) && !t.match(/^(?:include|contains|reverse)$/) && (e[t] = this[t]);
                        return e
                    },
                    repeat: function(e, t, i) {
                        if (null == e) return "";
                        if (t = ~~t, null == i) return h(n(e), t);
                        for (var r = []; t > 0; r[--t] = e);
                        return r.join(i)
                    },
                    naturalCmp: function(e, t) {
                        if (e == t) return 0;
                        if (!e) return -1;
                        if (!t) return 1;
                        for (var i = /(\.\d+)|(\d+)|(\D+)/g, r = n(e).toLowerCase().match(i), o = n(t).toLowerCase().match(i), a = Math.min(r.length, o.length), s = 0; a > s; s++) {
                            var l = r[s],
                                h = o[s];
                            if (l !== h) {
                                var u = parseInt(l, 10);
                                if (!isNaN(u)) {
                                    var d = parseInt(h, 10);
                                    if (!isNaN(d) && u - d) return u - d
                                }
                                return h > l ? -1 : 1
                            }
                        }
                        return r.length === o.length ? r.length - o.length : t > e ? -1 : 1
                    },
                    levenshtein: function(e, t) {
                        if (null == e && null == t) return 0;
                        if (null == e) return n(t).length;
                        if (null == t) return n(e).length;
                        e = n(e), t = n(t);
                        for (var i, r, o = [], a = 0; a <= t.length; a++)
                            for (var s = 0; s <= e.length; s++) r = a && s ? e.charAt(s - 1) === t.charAt(a - 1) ? i : Math.min(o[s], o[s - 1], i) + 1 : a + s, i = o[s], o[s] = r;
                        return o.pop()
                    },
                    toBoolean: function(e, t, i) {
                        return "number" == typeof e && (e = "" + e), "string" != typeof e ? !!e : (e = g.trim(e), r(e, t || ["true", "1"]) ? !0 : r(e, i || ["false", "0"]) ? !1 : void 0)
                    }
                };
            g.strip = g.trim, g.lstrip = g.ltrim, g.rstrip = g.rtrim, g.center = g.lrpad, g.rjust = g.lpad, g.ljust = g.rpad, g.contains = g.include, g.q = g.quote, g.toBool = g.toBoolean, "undefined" != typeof i && ("undefined" != typeof t && t.exports && (t.exports = g), i._s = g), "function" == typeof define && define.amd && define("underscore.string", [], function() {
                return g
            }), e._ = e._ || {}, e._.string = e._.str = g
        }(this, String)
    }, {}],
    207: [function(e, t, i) {
        (function() {
            function e(e) {
                function t(t, i, n, r, o, a) {
                    for (; o >= 0 && a > o; o += e) {
                        var s = r ? r[o] : o;
                        n = i(n, t[s], s, t)
                    }
                    return n
                }
                return function(i, n, r, o) {
                    n = x(n, o, 4);
                    var a = !k(i) && b.keys(i),
                        s = (a || i).length,
                        l = e > 0 ? 0 : s - 1;
                    return arguments.length < 3 && (r = i[a ? a[l] : l], l += e), t(i, n, r, a, l, s)
                }
            }

            function n(e) {
                return function(t, i, n) {
                    i = w(i, n);
                    for (var r = E(t), o = e > 0 ? 0 : r - 1; o >= 0 && r > o; o += e)
                        if (i(t[o], o, t)) return o;
                    return -1
                }
            }

            function r(e, t, i) {
                return function(n, r, o) {
                    var a = 0,
                        s = E(n);
                    if ("number" == typeof o) e > 0 ? a = o >= 0 ? o : Math.max(o + s, a) : s = o >= 0 ? Math.min(o + 1, s) : o + s + 1;
                    else if (i && o && s) return o = i(n, r), n[o] === r ? o : -1;
                    if (r !== r) return o = t(c.call(n, a, s), b.isNaN), o >= 0 ? o + a : -1;
                    for (o = e > 0 ? a : s - 1; o >= 0 && s > o; o += e)
                        if (n[o] === r) return o;
                    return -1
                }
            }

            function o(e, t) {
                var i = D.length,
                    n = e.constructor,
                    r = b.isFunction(n) && n.prototype || h,
                    o = "constructor";
                for (b.has(e, o) && !b.contains(t, o) && t.push(o); i--;) o = D[i], o in e && e[o] !== r[o] && !b.contains(t, o) && t.push(o)
            }
            var a = this,
                s = a._,
                l = Array.prototype,
                h = Object.prototype,
                u = Function.prototype,
                d = l.push,
                c = l.slice,
                f = h.toString,
                p = h.hasOwnProperty,
                m = Array.isArray,
                g = Object.keys,
                _ = u.bind,
                v = Object.create,
                y = function() {},
                b = function(e) {
                    return e instanceof b ? e : this instanceof b ? void(this._wrapped = e) : new b(e)
                };
            "undefined" != typeof i ? ("undefined" != typeof t && t.exports && (i = t.exports = b), i._ = b) : a._ = b, b.VERSION = "1.8.3";
            var x = function(e, t, i) {
                    if (void 0 === t) return e;
                    switch (null == i ? 3 : i) {
                        case 1:
                            return function(i) {
                                return e.call(t, i)
                            };
                        case 2:
                            return function(i, n) {
                                return e.call(t, i, n)
                            };
                        case 3:
                            return function(i, n, r) {
                                return e.call(t, i, n, r)
                            };
                        case 4:
                            return function(i, n, r, o) {
                                return e.call(t, i, n, r, o)
                            }
                    }
                    return function() {
                        return e.apply(t, arguments)
                    }
                },
                w = function(e, t, i) {
                    return null == e ? b.identity : b.isFunction(e) ? x(e, t, i) : b.isObject(e) ? b.matcher(e) : b.property(e)
                };
            b.iteratee = function(e, t) {
                return w(e, t, 1 / 0)
            };
            var M = function(e, t) {
                    return function(i) {
                        var n = arguments.length;
                        if (2 > n || null == i) return i;
                        for (var r = 1; n > r; r++)
                            for (var o = arguments[r], a = e(o), s = a.length, l = 0; s > l; l++) {
                                var h = a[l];
                                t && void 0 !== i[h] || (i[h] = o[h])
                            }
                        return i
                    }
                },
                T = function(e) {
                    if (!b.isObject(e)) return {};
                    if (v) return v(e);
                    y.prototype = e;
                    var t = new y;
                    return y.prototype = null, t
                },
                S = function(e) {
                    return function(t) {
                        return null == t ? void 0 : t[e]
                    }
                },
                C = Math.pow(2, 53) - 1,
                E = S("length"),
                k = function(e) {
                    var t = E(e);
                    return "number" == typeof t && t >= 0 && C >= t
                };
            b.each = b.forEach = function(e, t, i) {
                t = x(t, i);
                var n, r;
                if (k(e))
                    for (n = 0, r = e.length; r > n; n++) t(e[n], n, e);
                else {
                    var o = b.keys(e);
                    for (n = 0, r = o.length; r > n; n++) t(e[o[n]], o[n], e)
                }
                return e
            }, b.map = b.collect = function(e, t, i) {
                t = w(t, i);
                for (var n = !k(e) && b.keys(e), r = (n || e).length, o = Array(r), a = 0; r > a; a++) {
                    var s = n ? n[a] : a;
                    o[a] = t(e[s], s, e)
                }
                return o
            }, b.reduce = b.foldl = b.inject = e(1), b.reduceRight = b.foldr = e(-1), b.find = b.detect = function(e, t, i) {
                var n;
                return n = k(e) ? b.findIndex(e, t, i) : b.findKey(e, t, i), void 0 !== n && -1 !== n ? e[n] : void 0
            }, b.filter = b.select = function(e, t, i) {
                var n = [];
                return t = w(t, i), b.each(e, function(e, i, r) {
                    t(e, i, r) && n.push(e)
                }), n
            }, b.reject = function(e, t, i) {
                return b.filter(e, b.negate(w(t)), i)
            }, b.every = b.all = function(e, t, i) {
                t = w(t, i);
                for (var n = !k(e) && b.keys(e), r = (n || e).length, o = 0; r > o; o++) {
                    var a = n ? n[o] : o;
                    if (!t(e[a], a, e)) return !1
                }
                return !0
            }, b.some = b.any = function(e, t, i) {
                t = w(t, i);
                for (var n = !k(e) && b.keys(e), r = (n || e).length, o = 0; r > o; o++) {
                    var a = n ? n[o] : o;
                    if (t(e[a], a, e)) return !0
                }
                return !1
            }, b.contains = b.includes = b.include = function(e, t, i, n) {
                return k(e) || (e = b.values(e)), ("number" != typeof i || n) && (i = 0), b.indexOf(e, t, i) >= 0
            }, b.invoke = function(e, t) {
                var i = c.call(arguments, 2),
                    n = b.isFunction(t);
                return b.map(e, function(e) {
                    var r = n ? t : e[t];
                    return null == r ? r : r.apply(e, i)
                })
            }, b.pluck = function(e, t) {
                return b.map(e, b.property(t))
            }, b.where = function(e, t) {
                return b.filter(e, b.matcher(t))
            }, b.findWhere = function(e, t) {
                return b.find(e, b.matcher(t))
            }, b.max = function(e, t, i) {
                var n, r, o = -(1 / 0),
                    a = -(1 / 0);
                if (null == t && null != e) {
                    e = k(e) ? e : b.values(e);
                    for (var s = 0, l = e.length; l > s; s++) n = e[s], n > o && (o = n)
                } else t = w(t, i), b.each(e, function(e, i, n) {
                    r = t(e, i, n), (r > a || r === -(1 / 0) && o === -(1 / 0)) && (o = e, a = r)
                });
                return o
            }, b.min = function(e, t, i) {
                var n, r, o = 1 / 0,
                    a = 1 / 0;
                if (null == t && null != e) {
                    e = k(e) ? e : b.values(e);
                    for (var s = 0, l = e.length; l > s; s++) n = e[s], o > n && (o = n)
                } else t = w(t, i), b.each(e, function(e, i, n) {
                    r = t(e, i, n), (a > r || r === 1 / 0 && o === 1 / 0) && (o = e, a = r)
                });
                return o
            }, b.shuffle = function(e) {
                for (var t, i = k(e) ? e : b.values(e), n = i.length, r = Array(n), o = 0; n > o; o++) t = b.random(0, o), t !== o && (r[o] = r[t]), r[t] = i[o];
                return r
            }, b.sample = function(e, t, i) {
                return null == t || i ? (k(e) || (e = b.values(e)), e[b.random(e.length - 1)]) : b.shuffle(e).slice(0, Math.max(0, t))
            }, b.sortBy = function(e, t, i) {
                return t = w(t, i), b.pluck(b.map(e, function(e, i, n) {
                    return {
                        value: e,
                        index: i,
                        criteria: t(e, i, n)
                    }
                }).sort(function(e, t) {
                    var i = e.criteria,
                        n = t.criteria;
                    if (i !== n) {
                        if (i > n || void 0 === i) return 1;
                        if (n > i || void 0 === n) return -1
                    }
                    return e.index - t.index
                }), "value")
            };
            var L = function(e) {
                return function(t, i, n) {
                    var r = {};
                    return i = w(i, n), b.each(t, function(n, o) {
                        var a = i(n, o, t);
                        e(r, n, a)
                    }), r
                }
            };
            b.groupBy = L(function(e, t, i) {
                b.has(e, i) ? e[i].push(t) : e[i] = [t]
            }), b.indexBy = L(function(e, t, i) {
                e[i] = t
            }), b.countBy = L(function(e, t, i) {
                b.has(e, i) ? e[i]++ : e[i] = 1
            }), b.toArray = function(e) {
                return e ? b.isArray(e) ? c.call(e) : k(e) ? b.map(e, b.identity) : b.values(e) : []
            }, b.size = function(e) {
                return null == e ? 0 : k(e) ? e.length : b.keys(e).length
            }, b.partition = function(e, t, i) {
                t = w(t, i);
                var n = [],
                    r = [];
                return b.each(e, function(e, i, o) {
                    (t(e, i, o) ? n : r).push(e)
                }), [n, r]
            }, b.first = b.head = b.take = function(e, t, i) {
                return null == e ? void 0 : null == t || i ? e[0] : b.initial(e, e.length - t)
            }, b.initial = function(e, t, i) {
                return c.call(e, 0, Math.max(0, e.length - (null == t || i ? 1 : t)))
            }, b.last = function(e, t, i) {
                return null == e ? void 0 : null == t || i ? e[e.length - 1] : b.rest(e, Math.max(0, e.length - t))
            }, b.rest = b.tail = b.drop = function(e, t, i) {
                return c.call(e, null == t || i ? 1 : t)
            }, b.compact = function(e) {
                return b.filter(e, b.identity)
            };
            var P = function(e, t, i, n) {
                for (var r = [], o = 0, a = n || 0, s = E(e); s > a; a++) {
                    var l = e[a];
                    if (k(l) && (b.isArray(l) || b.isArguments(l))) {
                        t || (l = P(l, t, i));
                        var h = 0,
                            u = l.length;
                        for (r.length += u; u > h;) r[o++] = l[h++]
                    } else i || (r[o++] = l)
                }
                return r
            };
            b.flatten = function(e, t) {
                return P(e, t, !1)
            }, b.without = function(e) {
                return b.difference(e, c.call(arguments, 1))
            }, b.uniq = b.unique = function(e, t, i, n) {
                b.isBoolean(t) || (n = i, i = t, t = !1), null != i && (i = w(i, n));
                for (var r = [], o = [], a = 0, s = E(e); s > a; a++) {
                    var l = e[a],
                        h = i ? i(l, a, e) : l;
                    t ? (a && o === h || r.push(l), o = h) : i ? b.contains(o, h) || (o.push(h), r.push(l)) : b.contains(r, l) || r.push(l)
                }
                return r
            }, b.union = function() {
                return b.uniq(P(arguments, !0, !0))
            }, b.intersection = function(e) {
                for (var t = [], i = arguments.length, n = 0, r = E(e); r > n; n++) {
                    var o = e[n];
                    if (!b.contains(t, o)) {
                        for (var a = 1; i > a && b.contains(arguments[a], o); a++);
                        a === i && t.push(o)
                    }
                }
                return t
            }, b.difference = function(e) {
                var t = P(arguments, !0, !0, 1);
                return b.filter(e, function(e) {
                    return !b.contains(t, e)
                })
            }, b.zip = function() {
                return b.unzip(arguments)
            }, b.unzip = function(e) {
                for (var t = e && b.max(e, E).length || 0, i = Array(t), n = 0; t > n; n++) i[n] = b.pluck(e, n);
                return i
            }, b.object = function(e, t) {
                for (var i = {}, n = 0, r = E(e); r > n; n++) t ? i[e[n]] = t[n] : i[e[n][0]] = e[n][1];
                return i
            }, b.findIndex = n(1), b.findLastIndex = n(-1), b.sortedIndex = function(e, t, i, n) {
                i = w(i, n, 1);
                for (var r = i(t), o = 0, a = E(e); a > o;) {
                    var s = Math.floor((o + a) / 2);
                    i(e[s]) < r ? o = s + 1 : a = s
                }
                return o
            }, b.indexOf = r(1, b.findIndex, b.sortedIndex), b.lastIndexOf = r(-1, b.findLastIndex), b.range = function(e, t, i) {
                null == t && (t = e || 0, e = 0), i = i || 1;
                for (var n = Math.max(Math.ceil((t - e) / i), 0), r = Array(n), o = 0; n > o; o++, e += i) r[o] = e;
                return r
            };
            var A = function(e, t, i, n, r) {
                if (!(n instanceof t)) return e.apply(i, r);
                var o = T(e.prototype),
                    a = e.apply(o, r);
                return b.isObject(a) ? a : o
            };
            b.bind = function(e, t) {
                if (_ && e.bind === _) return _.apply(e, c.call(arguments, 1));
                if (!b.isFunction(e)) throw new TypeError("Bind must be called on a function");
                var i = c.call(arguments, 2),
                    n = function() {
                        return A(e, n, t, this, i.concat(c.call(arguments)))
                    };
                return n
            }, b.partial = function(e) {
                var t = c.call(arguments, 1),
                    i = function() {
                        for (var n = 0, r = t.length, o = Array(r), a = 0; r > a; a++) o[a] = t[a] === b ? arguments[n++] : t[a];
                        for (; n < arguments.length;) o.push(arguments[n++]);
                        return A(e, i, this, this, o)
                    };
                return i
            }, b.bindAll = function(e) {
                var t, i, n = arguments.length;
                if (1 >= n) throw new Error("bindAll must be passed function names");
                for (t = 1; n > t; t++) i = arguments[t], e[i] = b.bind(e[i], e);
                return e
            }, b.memoize = function(e, t) {
                var i = function(n) {
                    var r = i.cache,
                        o = "" + (t ? t.apply(this, arguments) : n);
                    return b.has(r, o) || (r[o] = e.apply(this, arguments)), r[o]
                };
                return i.cache = {}, i
            }, b.delay = function(e, t) {
                var i = c.call(arguments, 2);
                return setTimeout(function() {
                    return e.apply(null, i)
                }, t)
            }, b.defer = b.partial(b.delay, b, 1), b.throttle = function(e, t, i) {
                var n, r, o, a = null,
                    s = 0;
                i || (i = {});
                var l = function() {
                    s = i.leading === !1 ? 0 : b.now(), a = null, o = e.apply(n, r), a || (n = r = null)
                };
                return function() {
                    var h = b.now();
                    s || i.leading !== !1 || (s = h);
                    var u = t - (h - s);
                    return n = this, r = arguments, 0 >= u || u > t ? (a && (clearTimeout(a), a = null), s = h, o = e.apply(n, r), a || (n = r = null)) : a || i.trailing === !1 || (a = setTimeout(l, u)), o
                }
            }, b.debounce = function(e, t, i) {
                var n, r, o, a, s, l = function() {
                    var h = b.now() - a;
                    t > h && h >= 0 ? n = setTimeout(l, t - h) : (n = null, i || (s = e.apply(o, r), n || (o = r = null)))
                };
                return function() {
                    o = this, r = arguments, a = b.now();
                    var h = i && !n;
                    return n || (n = setTimeout(l, t)), h && (s = e.apply(o, r), o = r = null), s
                }
            }, b.wrap = function(e, t) {
                return b.partial(t, e)
            }, b.negate = function(e) {
                return function() {
                    return !e.apply(this, arguments)
                }
            }, b.compose = function() {
                var e = arguments,
                    t = e.length - 1;
                return function() {
                    for (var i = t, n = e[t].apply(this, arguments); i--;) n = e[i].call(this, n);
                    return n
                }
            }, b.after = function(e, t) {
                return function() {
                    return --e < 1 ? t.apply(this, arguments) : void 0
                }
            }, b.before = function(e, t) {
                var i;
                return function() {
                    return --e > 0 && (i = t.apply(this, arguments)), 1 >= e && (t = null), i
                }
            }, b.once = b.partial(b.before, 2);
            var R = !{
                    toString: null
                }.propertyIsEnumerable("toString"),
                D = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"];
            b.keys = function(e) {
                if (!b.isObject(e)) return [];
                if (g) return g(e);
                var t = [];
                for (var i in e) b.has(e, i) && t.push(i);
                return R && o(e, t), t
            }, b.allKeys = function(e) {
                if (!b.isObject(e)) return [];
                var t = [];
                for (var i in e) t.push(i);
                return R && o(e, t), t
            }, b.values = function(e) {
                for (var t = b.keys(e), i = t.length, n = Array(i), r = 0; i > r; r++) n[r] = e[t[r]];
                return n
            }, b.mapObject = function(e, t, i) {
                t = w(t, i);
                for (var n, r = b.keys(e), o = r.length, a = {}, s = 0; o > s; s++) n = r[s], a[n] = t(e[n], n, e);
                return a
            }, b.pairs = function(e) {
                for (var t = b.keys(e), i = t.length, n = Array(i), r = 0; i > r; r++) n[r] = [t[r], e[t[r]]];
                return n
            }, b.invert = function(e) {
                for (var t = {}, i = b.keys(e), n = 0, r = i.length; r > n; n++) t[e[i[n]]] = i[n];
                return t
            }, b.functions = b.methods = function(e) {
                var t = [];
                for (var i in e) b.isFunction(e[i]) && t.push(i);
                return t.sort()
            }, b.extend = M(b.allKeys), b.extendOwn = b.assign = M(b.keys), b.findKey = function(e, t, i) {
                t = w(t, i);
                for (var n, r = b.keys(e), o = 0, a = r.length; a > o; o++)
                    if (n = r[o], t(e[n], n, e)) return n
            }, b.pick = function(e, t, i) {
                var n, r, o = {},
                    a = e;
                if (null == a) return o;
                b.isFunction(t) ? (r = b.allKeys(a), n = x(t, i)) : (r = P(arguments, !1, !1, 1), n = function(e, t, i) {
                    return t in i
                }, a = Object(a));
                for (var s = 0, l = r.length; l > s; s++) {
                    var h = r[s],
                        u = a[h];
                    n(u, h, a) && (o[h] = u)
                }
                return o
            }, b.omit = function(e, t, i) {
                if (b.isFunction(t)) t = b.negate(t);
                else {
                    var n = b.map(P(arguments, !1, !1, 1), String);
                    t = function(e, t) {
                        return !b.contains(n, t)
                    }
                }
                return b.pick(e, t, i)
            }, b.defaults = M(b.allKeys, !0), b.create = function(e, t) {
                var i = T(e);
                return t && b.extendOwn(i, t), i
            }, b.clone = function(e) {
                return b.isObject(e) ? b.isArray(e) ? e.slice() : b.extend({}, e) : e
            }, b.tap = function(e, t) {
                return t(e), e
            }, b.isMatch = function(e, t) {
                var i = b.keys(t),
                    n = i.length;
                if (null == e) return !n;
                for (var r = Object(e), o = 0; n > o; o++) {
                    var a = i[o];
                    if (t[a] !== r[a] || !(a in r)) return !1
                }
                return !0
            };
            var I = function(e, t, i, n) {
                if (e === t) return 0 !== e || 1 / e === 1 / t;
                if (null == e || null == t) return e === t;
                e instanceof b && (e = e._wrapped), t instanceof b && (t = t._wrapped);
                var r = f.call(e);
                if (r !== f.call(t)) return !1;
                switch (r) {
                    case "[object RegExp]":
                    case "[object String]":
                        return "" + e == "" + t;
                    case "[object Number]":
                        return +e !== +e ? +t !== +t : 0 === +e ? 1 / +e === 1 / t : +e === +t;
                    case "[object Date]":
                    case "[object Boolean]":
                        return +e === +t
                }
                var o = "[object Array]" === r;
                if (!o) {
                    if ("object" != typeof e || "object" != typeof t) return !1;
                    var a = e.constructor,
                        s = t.constructor;
                    if (a !== s && !(b.isFunction(a) && a instanceof a && b.isFunction(s) && s instanceof s) && "constructor" in e && "constructor" in t) return !1
                }
                i = i || [], n = n || [];
                for (var l = i.length; l--;)
                    if (i[l] === e) return n[l] === t;
                if (i.push(e), n.push(t), o) {
                    if (l = e.length, l !== t.length) return !1;
                    for (; l--;)
                        if (!I(e[l], t[l], i, n)) return !1
                } else {
                    var h, u = b.keys(e);
                    if (l = u.length, b.keys(t).length !== l) return !1;
                    for (; l--;)
                        if (h = u[l], !b.has(t, h) || !I(e[h], t[h], i, n)) return !1
                }
                return i.pop(), n.pop(), !0
            };
            b.isEqual = function(e, t) {
                return I(e, t)
            }, b.isEmpty = function(e) {
                return null == e ? !0 : k(e) && (b.isArray(e) || b.isString(e) || b.isArguments(e)) ? 0 === e.length : 0 === b.keys(e).length
            }, b.isElement = function(e) {
                return !(!e || 1 !== e.nodeType)
            }, b.isArray = m || function(e) {
                return "[object Array]" === f.call(e)
            }, b.isObject = function(e) {
                var t = typeof e;
                return "function" === t || "object" === t && !!e
            }, b.each(["Arguments", "Function", "String", "Number", "Date", "RegExp", "Error"], function(e) {
                b["is" + e] = function(t) {
                    return f.call(t) === "[object " + e + "]"
                }
            }), b.isArguments(arguments) || (b.isArguments = function(e) {
                return b.has(e, "callee")
            }), "function" != typeof /./ && "object" != typeof Int8Array && (b.isFunction = function(e) {
                return "function" == typeof e || !1
            }), b.isFinite = function(e) {
                return isFinite(e) && !isNaN(parseFloat(e))
            }, b.isNaN = function(e) {
                return b.isNumber(e) && e !== +e
            }, b.isBoolean = function(e) {
                return e === !0 || e === !1 || "[object Boolean]" === f.call(e)
            }, b.isNull = function(e) {
                return null === e
            }, b.isUndefined = function(e) {
                return void 0 === e
            }, b.has = function(e, t) {
                return null != e && p.call(e, t)
            }, b.noConflict = function() {
                return a._ = s, this
            }, b.identity = function(e) {
                return e
            }, b.constant = function(e) {
                return function() {
                    return e
                }
            }, b.noop = function() {}, b.property = S, b.propertyOf = function(e) {
                return null == e ? function() {} : function(t) {
                    return e[t]
                }
            }, b.matcher = b.matches = function(e) {
                return e = b.extendOwn({}, e),
                    function(t) {
                        return b.isMatch(t, e)
                    }
            }, b.times = function(e, t, i) {
                var n = Array(Math.max(0, e));
                t = x(t, i, 1);
                for (var r = 0; e > r; r++) n[r] = t(r);
                return n
            }, b.random = function(e, t) {
                return null == t && (t = e, e = 0), e + Math.floor(Math.random() * (t - e + 1))
            }, b.now = Date.now || function() {
                return (new Date).getTime()
            };
            var O = {
                    "&": "&amp;",
                    "<": "&lt;",
                    ">": "&gt;",
                    '"': "&quot;",
                    "'": "&#x27;",
                    "`": "&#x60;"
                },
                N = b.invert(O),
                B = function(e) {
                    var t = function(t) {
                            return e[t]
                        },
                        i = "(?:" + b.keys(e).join("|") + ")",
                        n = RegExp(i),
                        r = RegExp(i, "g");
                    return function(e) {
                        return e = null == e ? "" : "" + e, n.test(e) ? e.replace(r, t) : e
                    }
                };
            b.escape = B(O), b.unescape = B(N), b.result = function(e, t, i) {
                var n = null == e ? void 0 : e[t];
                return void 0 === n && (n = i), b.isFunction(n) ? n.call(e) : n
            };
            var F = 0;
            b.uniqueId = function(e) {
                var t = ++F + "";
                return e ? e + t : t
            }, b.templateSettings = {
                evaluate: /<%([\s\S]+?)%>/g,
                interpolate: /<%=([\s\S]+?)%>/g,
                escape: /<%-([\s\S]+?)%>/g
            };
            var z = /(.)^/,
                H = {
                    "'": "'",
                    "\\": "\\",
                    "\r": "r",
                    "\n": "n",
                    "\u2028": "u2028",
                    "\u2029": "u2029"
                },
                U = /\\|'|\r|\n|\u2028|\u2029/g,
                W = function(e) {
                    return "\\" + H[e]
                };
            b.template = function(e, t, i) {
                !t && i && (t = i), t = b.defaults({}, t, b.templateSettings);
                var n = RegExp([(t.escape || z).source, (t.interpolate || z).source, (t.evaluate || z).source].join("|") + "|$", "g"),
                    r = 0,
                    o = "__p+='";
                e.replace(n, function(t, i, n, a, s) {
                    return o += e.slice(r, s).replace(U, W), r = s + t.length, i ? o += "'+\n((__t=(" + i + "))==null?'':_.escape(__t))+\n'" : n ? o += "'+\n((__t=(" + n + "))==null?'':__t)+\n'" : a && (o += "';\n" + a + "\n__p+='"), t
                }), o += "';\n", t.variable || (o = "with(obj||{}){\n" + o + "}\n"), o = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + o + "return __p;\n";
                try {
                    var a = new Function(t.variable || "obj", "_", o)
                } catch (s) {
                    throw s.source = o, s
                }
                var l = function(e) {
                        return a.call(this, e, b)
                    },
                    h = t.variable || "obj";
                return l.source = "function(" + h + "){\n" + o + "}", l
            }, b.chain = function(e) {
                var t = b(e);
                return t._chain = !0, t
            };
            var G = function(e, t) {
                return e._chain ? b(t).chain() : t
            };
            b.mixin = function(e) {
                b.each(b.functions(e), function(t) {
                    var i = b[t] = e[t];
                    b.prototype[t] = function() {
                        var e = [this._wrapped];
                        return d.apply(e, arguments), G(this, i.apply(b, e))
                    }
                })
            }, b.mixin(b), b.each(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(e) {
                var t = l[e];
                b.prototype[e] = function() {
                    var i = this._wrapped;
                    return t.apply(i, arguments), "shift" !== e && "splice" !== e || 0 !== i.length || delete i[0], G(this, i)
                }
            }), b.each(["concat", "join", "slice"], function(e) {
                var t = l[e];
                b.prototype[e] = function() {
                    return G(this, t.apply(this._wrapped, arguments))
                }
            }), b.prototype.value = function() {
                return this._wrapped
            }, b.prototype.valueOf = b.prototype.toJSON = b.prototype.value, b.prototype.toString = function() {
                return "" + this._wrapped
            }, "function" == typeof define && define.amd && define("underscore", [], function() {
                return b
            })
        }).call(this)
    }, {}],
    208: [function(e, t, i) {
        "use strict";

        function n() {
            this.protocol = null, this.slashes = null, this.auth = null, this.host = null, this.port = null, this.hostname = null, this.hash = null, this.search = null, this.query = null, this.pathname = null, this.path = null, this.href = null
        }

        function r(e, t, i) {
            if (e && h.isObject(e) && e instanceof n) return e;
            var r = new n;
            return r.parse(e, t, i), r
        }

        function o(e) {
            return h.isString(e) && (e = r(e)), e instanceof n ? e.format() : n.prototype.format.call(e)
        }

        function a(e, t) {
            return r(e, !1, !0).resolve(t)
        }

        function s(e, t) {
            return e ? r(e, !1, !0).resolveObject(t) : t
        }
        var l = e("punycode"),
            h = e("./util");
        i.parse = r, i.resolve = a, i.resolveObject = s, i.format = o, i.Url = n;
        var u = /^([a-z0-9.+-]+:)/i,
            d = /:[0-9]*$/,
            c = /^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,
            f = ["<", ">", '"', "`", " ", "\r", "\n", "	"],
            p = ["{", "}", "|", "\\", "^", "`"].concat(f),
            m = ["'"].concat(p),
            g = ["%", "/", "?", ";", "#"].concat(m),
            _ = ["/", "?", "#"],
            v = 255,
            y = /^[+a-z0-9A-Z_-]{0,63}$/,
            b = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,
            x = {
                javascript: !0,
                "javascript:": !0
            },
            w = {
                javascript: !0,
                "javascript:": !0
            },
            M = {
                http: !0,
                https: !0,
                ftp: !0,
                gopher: !0,
                file: !0,
                "http:": !0,
                "https:": !0,
                "ftp:": !0,
                "gopher:": !0,
                "file:": !0
            },
            T = e("querystring");
        n.prototype.parse = function(e, t, i) {
            if (!h.isString(e)) throw new TypeError("Parameter 'url' must be a string, not " + typeof e);
            var n = e.indexOf("?"),
                r = -1 !== n && n < e.indexOf("#") ? "?" : "#",
                o = e.split(r),
                a = /\\/g;
            o[0] = o[0].replace(a, "/"), e = o.join(r);
            var s = e;
            if (s = s.trim(), !i && 1 === e.split("#").length) {
                var d = c.exec(s);
                if (d) return this.path = s, this.href = s, this.pathname = d[1], d[2] ? (this.search = d[2], t ? this.query = T.parse(this.search.substr(1)) : this.query = this.search.substr(1)) : t && (this.search = "", this.query = {}), this
            }
            var f = u.exec(s);
            if (f) {
                f = f[0];
                var p = f.toLowerCase();
                this.protocol = p, s = s.substr(f.length)
            }
            if (i || f || s.match(/^\/\/[^@\/]+@[^@\/]+/)) {
                var S = "//" === s.substr(0, 2);
                !S || f && w[f] || (s = s.substr(2), this.slashes = !0)
            }
            if (!w[f] && (S || f && !M[f])) {
                for (var C = -1, E = 0; E < _.length; E++) {
                    var k = s.indexOf(_[E]); - 1 !== k && (-1 === C || C > k) && (C = k)
                }
                var L, P;
                P = -1 === C ? s.lastIndexOf("@") : s.lastIndexOf("@", C), -1 !== P && (L = s.slice(0, P), s = s.slice(P + 1), this.auth = decodeURIComponent(L)), C = -1;
                for (var E = 0; E < g.length; E++) {
                    var k = s.indexOf(g[E]); - 1 !== k && (-1 === C || C > k) && (C = k)
                } - 1 === C && (C = s.length), this.host = s.slice(0, C), s = s.slice(C), this.parseHost(), this.hostname = this.hostname || "";
                var A = "[" === this.hostname[0] && "]" === this.hostname[this.hostname.length - 1];
                if (!A)
                    for (var R = this.hostname.split(/\./), E = 0, D = R.length; D > E; E++) {
                        var I = R[E];
                        if (I && !I.match(y)) {
                            for (var O = "", N = 0, B = I.length; B > N; N++) O += I.charCodeAt(N) > 127 ? "x" : I[N];
                            if (!O.match(y)) {
                                var F = R.slice(0, E),
                                    z = R.slice(E + 1),
                                    H = I.match(b);
                                H && (F.push(H[1]), z.unshift(H[2])), z.length && (s = "/" + z.join(".") + s), this.hostname = F.join(".");
                                break
                            }
                        }
                    }
                this.hostname.length > v ? this.hostname = "" : this.hostname = this.hostname.toLowerCase(), A || (this.hostname = l.toASCII(this.hostname));
                var U = this.port ? ":" + this.port : "",
                    W = this.hostname || "";
                this.host = W + U, this.href += this.host, A && (this.hostname = this.hostname.substr(1, this.hostname.length - 2), "/" !== s[0] && (s = "/" + s))
            }
            if (!x[p])
                for (var E = 0, D = m.length; D > E; E++) {
                    var G = m[E];
                    if (-1 !== s.indexOf(G)) {
                        var j = encodeURIComponent(G);
                        j === G && (j = escape(G)), s = s.split(G).join(j)
                    }
                }
            var q = s.indexOf("#"); - 1 !== q && (this.hash = s.substr(q), s = s.slice(0, q));
            var V = s.indexOf("?");
            if (-1 !== V ? (this.search = s.substr(V), this.query = s.substr(V + 1), t && (this.query = T.parse(this.query)), s = s.slice(0, V)) : t && (this.search = "", this.query = {}), s && (this.pathname = s), M[p] && this.hostname && !this.pathname && (this.pathname = "/"), this.pathname || this.search) {
                var U = this.pathname || "",
                    Z = this.search || "";
                this.path = U + Z
            }
            return this.href = this.format(), this
        }, n.prototype.format = function() {
            var e = this.auth || "";
            e && (e = encodeURIComponent(e), e = e.replace(/%3A/i, ":"), e += "@");
            var t = this.protocol || "",
                i = this.pathname || "",
                n = this.hash || "",
                r = !1,
                o = "";
            this.host ? r = e + this.host : this.hostname && (r = e + (-1 === this.hostname.indexOf(":") ? this.hostname : "[" + this.hostname + "]"), this.port && (r += ":" + this.port)), this.query && h.isObject(this.query) && Object.keys(this.query).length && (o = T.stringify(this.query));
            var a = this.search || o && "?" + o || "";
            return t && ":" !== t.substr(-1) && (t += ":"), this.slashes || (!t || M[t]) && r !== !1 ? (r = "//" + (r || ""), i && "/" !== i.charAt(0) && (i = "/" + i)) : r || (r = ""), n && "#" !== n.charAt(0) && (n = "#" + n), a && "?" !== a.charAt(0) && (a = "?" + a), i = i.replace(/[?#]/g, function(e) {
                return encodeURIComponent(e)
            }), a = a.replace("#", "%23"), t + r + i + a + n
        }, n.prototype.resolve = function(e) {
            return this.resolveObject(r(e, !1, !0)).format()
        }, n.prototype.resolveObject = function(e) {
            if (h.isString(e)) {
                var t = new n;
                t.parse(e, !1, !0), e = t
            }
            for (var i = new n, r = Object.keys(this), o = 0; o < r.length; o++) {
                var a = r[o];
                i[a] = this[a]
            }
            if (i.hash = e.hash, "" === e.href) return i.href = i.format(), i;
            if (e.slashes && !e.protocol) {
                for (var s = Object.keys(e), l = 0; l < s.length; l++) {
                    var u = s[l];
                    "protocol" !== u && (i[u] = e[u])
                }
                return M[i.protocol] && i.hostname && !i.pathname && (i.path = i.pathname = "/"), i.href = i.format(), i
            }
            if (e.protocol && e.protocol !== i.protocol) {
                if (!M[e.protocol]) {
                    for (var d = Object.keys(e), c = 0; c < d.length; c++) {
                        var f = d[c];
                        i[f] = e[f]
                    }
                    return i.href = i.format(), i
                }
                if (i.protocol = e.protocol, e.host || w[e.protocol]) i.pathname = e.pathname;
                else {
                    for (var p = (e.pathname || "").split("/"); p.length && !(e.host = p.shift()););
                    e.host || (e.host = ""), e.hostname || (e.hostname = ""), "" !== p[0] && p.unshift(""), p.length < 2 && p.unshift(""), i.pathname = p.join("/")
                }
                if (i.search = e.search, i.query = e.query, i.host = e.host || "", i.auth = e.auth, i.hostname = e.hostname || e.host, i.port = e.port, i.pathname || i.search) {
                    var m = i.pathname || "",
                        g = i.search || "";
                    i.path = m + g
                }
                return i.slashes = i.slashes || e.slashes, i.href = i.format(), i
            }
            var _ = i.pathname && "/" === i.pathname.charAt(0),
                v = e.host || e.pathname && "/" === e.pathname.charAt(0),
                y = v || _ || i.host && e.pathname,
                b = y,
                x = i.pathname && i.pathname.split("/") || [],
                p = e.pathname && e.pathname.split("/") || [],
                T = i.protocol && !M[i.protocol];
            if (T && (i.hostname = "", i.port = null, i.host && ("" === x[0] ? x[0] = i.host : x.unshift(i.host)), i.host = "", e.protocol && (e.hostname = null, e.port = null, e.host && ("" === p[0] ? p[0] = e.host : p.unshift(e.host)), e.host = null), y = y && ("" === p[0] || "" === x[0])), v) i.host = e.host || "" === e.host ? e.host : i.host, i.hostname = e.hostname || "" === e.hostname ? e.hostname : i.hostname, i.search = e.search, i.query = e.query, x = p;
            else if (p.length) x || (x = []), x.pop(), x = x.concat(p), i.search = e.search, i.query = e.query;
            else if (!h.isNullOrUndefined(e.search)) {
                if (T) {
                    i.hostname = i.host = x.shift();
                    var S = i.host && i.host.indexOf("@") > 0 ? i.host.split("@") : !1;
                    S && (i.auth = S.shift(), i.host = i.hostname = S.shift())
                }
                return i.search = e.search, i.query = e.query, h.isNull(i.pathname) && h.isNull(i.search) || (i.path = (i.pathname ? i.pathname : "") + (i.search ? i.search : "")), i.href = i.format(), i
            }
            if (!x.length) return i.pathname = null, i.search ? i.path = "/" + i.search : i.path = null, i.href = i.format(), i;
            for (var C = x.slice(-1)[0], E = (i.host || e.host || x.length > 1) && ("." === C || ".." === C) || "" === C, k = 0, L = x.length; L >= 0; L--) C = x[L], "." === C ? x.splice(L, 1) : ".." === C ? (x.splice(L, 1), k++) : k && (x.splice(L, 1), k--);
            if (!y && !b)
                for (; k--; k) x.unshift("..");
            !y || "" === x[0] || x[0] && "/" === x[0].charAt(0) || x.unshift(""), E && "/" !== x.join("/").substr(-1) && x.push("");
            var P = "" === x[0] || x[0] && "/" === x[0].charAt(0);
            if (T) {
                i.hostname = i.host = P ? "" : x.length ? x.shift() : "";
                var S = i.host && i.host.indexOf("@") > 0 ? i.host.split("@") : !1;
                S && (i.auth = S.shift(), i.host = i.hostname = S.shift())
            }
            return y = y || i.host && x.length, y && !P && x.unshift(""), x.length ? i.pathname = x.join("/") : (i.pathname = null, i.path = null), h.isNull(i.pathname) && h.isNull(i.search) || (i.path = (i.pathname ? i.pathname : "") + (i.search ? i.search : "")), i.auth = e.auth || i.auth, i.slashes = i.slashes || e.slashes, i.href = i.format(), i
        }, n.prototype.parseHost = function() {
            var e = this.host,
                t = d.exec(e);
            t && (t = t[0], ":" !== t && (this.port = t.substr(1)), e = e.substr(0, e.length - t.length)), e && (this.hostname = e)
        }
    }, {
        "./util": 209,
        punycode: 182,
        querystring: 185
    }],
    209: [function(e, t, i) {
        "use strict";
        t.exports = {
            isString: function(e) {
                return "string" == typeof e
            },
            isObject: function(e) {
                return "object" == typeof e && null !== e
            },
            isNull: function(e) {
                return null === e
            },
            isNullOrUndefined: function(e) {
                return null == e
            }
        }
    }, {}],
    210: [function(e, t, i) {
        (function(e) {
            function i(e, t) {
                function i() {
                    if (!r) {
                        if (n("throwDeprecation")) throw new Error(t);
                        n("traceDeprecation") ? console.trace(t) : console.warn(t), r = !0
                    }
                    return e.apply(this, arguments)
                }
                if (n("noDeprecation")) return e;
                var r = !1;
                return i
            }

            function n(t) {
                try {
                    if (!e.localStorage) return !1
                } catch (i) {
                    return !1
                }
                var n = e.localStorage[t];
                return null == n ? !1 : "true" === String(n).toLowerCase()
            }
            t.exports = i
        }).call(this, window)
    }, {}],
    211: [function(e, t, i) {
        t.exports = function(e) {
            return e && "object" == typeof e && "function" == typeof e.copy && "function" == typeof e.fill && "function" == typeof e.readUInt8
        }
    }, {}],
    212: [function(e, t, i) {
        (function(t, n) {
            function r(e, t) {
                var n = {
                    seen: [],
                    stylize: a
                };
                return arguments.length >= 3 && (n.depth = arguments[2]), arguments.length >= 4 && (n.colors = arguments[3]), m(t) ? n.showHidden = t : t && i._extend(n, t), x(n.showHidden) && (n.showHidden = !1), x(n.depth) && (n.depth = 2), x(n.colors) && (n.colors = !1), x(n.customInspect) && (n.customInspect = !0), n.colors && (n.stylize = o), l(n, e, n.depth)
            }

            function o(e, t) {
                var i = r.styles[t];
                return i ? "[" + r.colors[i][0] + "m" + e + "[" + r.colors[i][1] + "m" : e
            }

            function a(e, t) {
                return e
            }

            function s(e) {
                var t = {};
                return e.forEach(function(e, i) {
                    t[e] = !0
                }), t
            }

            function l(e, t, n) {
                if (e.customInspect && t && C(t.inspect) && t.inspect !== i.inspect && (!t.constructor || t.constructor.prototype !== t)) {
                    var r = t.inspect(n, e);
                    return y(r) || (r = l(e, r, n)), r
                }
                var o = h(e, t);
                if (o) return o;
                var a = Object.keys(t),
                    m = s(a);
                if (e.showHidden && (a = Object.getOwnPropertyNames(t)), S(t) && (a.indexOf("message") >= 0 || a.indexOf("description") >= 0)) return u(t);
                if (0 === a.length) {
                    if (C(t)) {
                        var g = t.name ? ": " + t.name : "";
                        return e.stylize("[Function" + g + "]", "special")
                    }
                    if (w(t)) return e.stylize(RegExp.prototype.toString.call(t), "regexp");
                    if (T(t)) return e.stylize(Date.prototype.toString.call(t), "date");
                    if (S(t)) return u(t)
                }
                var _ = "",
                    v = !1,
                    b = ["{", "}"];
                if (p(t) && (v = !0, b = ["[", "]"]), C(t)) {
                    var x = t.name ? ": " + t.name : "";
                    _ = " [Function" + x + "]"
                }
                if (w(t) && (_ = " " + RegExp.prototype.toString.call(t)), T(t) && (_ = " " + Date.prototype.toUTCString.call(t)), S(t) && (_ = " " + u(t)), 0 === a.length && (!v || 0 == t.length)) return b[0] + _ + b[1];
                if (0 > n) return w(t) ? e.stylize(RegExp.prototype.toString.call(t), "regexp") : e.stylize("[Object]", "special");
                e.seen.push(t);
                var M;
                return M = v ? d(e, t, n, m, a) : a.map(function(i) {
                    return c(e, t, n, m, i, v)
                }), e.seen.pop(), f(M, _, b)
            }

            function h(e, t) {
                if (x(t)) return e.stylize("undefined", "undefined");
                if (y(t)) {
                    var i = "'" + JSON.stringify(t).replace(/^"|"$/g, "").replace(/'/g, "\\'").replace(/\\"/g, '"') + "'";
                    return e.stylize(i, "string")
                }
                return v(t) ? e.stylize("" + t, "number") : m(t) ? e.stylize("" + t, "boolean") : g(t) ? e.stylize("null", "null") : void 0
            }

            function u(e) {
                return "[" + Error.prototype.toString.call(e) + "]"
            }

            function d(e, t, i, n, r) {
                for (var o = [], a = 0, s = t.length; s > a; ++a) A(t, String(a)) ? o.push(c(e, t, i, n, String(a), !0)) : o.push("");
                return r.forEach(function(r) {
                    r.match(/^\d+$/) || o.push(c(e, t, i, n, r, !0))
                }), o;
            }

            function c(e, t, i, n, r, o) {
                var a, s, h;
                if (h = Object.getOwnPropertyDescriptor(t, r) || {
                        value: t[r]
                    }, h.get ? s = h.set ? e.stylize("[Getter/Setter]", "special") : e.stylize("[Getter]", "special") : h.set && (s = e.stylize("[Setter]", "special")), A(n, r) || (a = "[" + r + "]"), s || (e.seen.indexOf(h.value) < 0 ? (s = g(i) ? l(e, h.value, null) : l(e, h.value, i - 1), s.indexOf("\n") > -1 && (s = o ? s.split("\n").map(function(e) {
                        return "  " + e
                    }).join("\n").substr(2) : "\n" + s.split("\n").map(function(e) {
                        return "   " + e
                    }).join("\n"))) : s = e.stylize("[Circular]", "special")), x(a)) {
                    if (o && r.match(/^\d+$/)) return s;
                    a = JSON.stringify("" + r), a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/) ? (a = a.substr(1, a.length - 2), a = e.stylize(a, "name")) : (a = a.replace(/'/g, "\\'").replace(/\\"/g, '"').replace(/(^"|"$)/g, "'"), a = e.stylize(a, "string"))
                }
                return a + ": " + s
            }

            function f(e, t, i) {
                var n = 0,
                    r = e.reduce(function(e, t) {
                        return n++, t.indexOf("\n") >= 0 && n++, e + t.replace(/\u001b\[\d\d?m/g, "").length + 1
                    }, 0);
                return r > 60 ? i[0] + ("" === t ? "" : t + "\n ") + " " + e.join(",\n  ") + " " + i[1] : i[0] + t + " " + e.join(", ") + " " + i[1]
            }

            function p(e) {
                return Array.isArray(e)
            }

            function m(e) {
                return "boolean" == typeof e
            }

            function g(e) {
                return null === e
            }

            function _(e) {
                return null == e
            }

            function v(e) {
                return "number" == typeof e
            }

            function y(e) {
                return "string" == typeof e
            }

            function b(e) {
                return "symbol" == typeof e
            }

            function x(e) {
                return void 0 === e
            }

            function w(e) {
                return M(e) && "[object RegExp]" === k(e)
            }

            function M(e) {
                return "object" == typeof e && null !== e
            }

            function T(e) {
                return M(e) && "[object Date]" === k(e)
            }

            function S(e) {
                return M(e) && ("[object Error]" === k(e) || e instanceof Error)
            }

            function C(e) {
                return "function" == typeof e
            }

            function E(e) {
                return null === e || "boolean" == typeof e || "number" == typeof e || "string" == typeof e || "symbol" == typeof e || "undefined" == typeof e
            }

            function k(e) {
                return Object.prototype.toString.call(e)
            }

            function L(e) {
                return 10 > e ? "0" + e.toString(10) : e.toString(10)
            }

            function P() {
                var e = new Date,
                    t = [L(e.getHours()), L(e.getMinutes()), L(e.getSeconds())].join(":");
                return [e.getDate(), O[e.getMonth()], t].join(" ")
            }

            function A(e, t) {
                return Object.prototype.hasOwnProperty.call(e, t)
            }
            var R = /%[sdj%]/g;
            i.format = function(e) {
                if (!y(e)) {
                    for (var t = [], i = 0; i < arguments.length; i++) t.push(r(arguments[i]));
                    return t.join(" ")
                }
                for (var i = 1, n = arguments, o = n.length, a = String(e).replace(R, function(e) {
                        if ("%%" === e) return "%";
                        if (i >= o) return e;
                        switch (e) {
                            case "%s":
                                return String(n[i++]);
                            case "%d":
                                return Number(n[i++]);
                            case "%j":
                                try {
                                    return JSON.stringify(n[i++])
                                } catch (t) {
                                    return "[Circular]"
                                }
                            default:
                                return e
                        }
                    }), s = n[i]; o > i; s = n[++i]) a += g(s) || !M(s) ? " " + s : " " + r(s);
                return a
            }, i.deprecate = function(e, r) {
                function o() {
                    if (!a) {
                        if (t.throwDeprecation) throw new Error(r);
                        t.traceDeprecation ? console.trace(r) : console.error(r), a = !0
                    }
                    return e.apply(this, arguments)
                }
                if (x(n.process)) return function() {
                    return i.deprecate(e, r).apply(this, arguments)
                };
                if (t.noDeprecation === !0) return e;
                var a = !1;
                return o
            };
            var D, I = {};
            i.debuglog = function(e) {
                if (x(D) && (D = t.env.NODE_DEBUG || ""), e = e.toUpperCase(), !I[e])
                    if (new RegExp("\\b" + e + "\\b", "i").test(D)) {
                        var n = t.pid;
                        I[e] = function() {
                            var t = i.format.apply(i, arguments);
                            console.error("%s %d: %s", e, n, t)
                        }
                    } else I[e] = function() {};
                return I[e]
            }, i.inspect = r, r.colors = {
                bold: [1, 22],
                italic: [3, 23],
                underline: [4, 24],
                inverse: [7, 27],
                white: [37, 39],
                grey: [90, 39],
                black: [30, 39],
                blue: [34, 39],
                cyan: [36, 39],
                green: [32, 39],
                magenta: [35, 39],
                red: [31, 39],
                yellow: [33, 39]
            }, r.styles = {
                special: "cyan",
                number: "yellow",
                "boolean": "yellow",
                undefined: "grey",
                "null": "bold",
                string: "green",
                date: "magenta",
                regexp: "red"
            }, i.isArray = p, i.isBoolean = m, i.isNull = g, i.isNullOrUndefined = _, i.isNumber = v, i.isString = y, i.isSymbol = b, i.isUndefined = x, i.isRegExp = w, i.isObject = M, i.isDate = T, i.isError = S, i.isFunction = C, i.isPrimitive = E, i.isBuffer = e("./support/isBuffer");
            var O = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];
            i.log = function() {
                console.log("%s - %s", P(), i.format.apply(i, arguments))
            }, i.inherits = e("inherits"), i._extend = function(e, t) {
                if (!t || !M(t)) return e;
                for (var i = Object.keys(t), n = i.length; n--;) e[i[n]] = t[i[n]];
                return e
            }
        }).call(this, e("_process"), window)
    }, {
        "./support/isBuffer": 211,
        _process: 181,
        inherits: 107
    }],
    213: [function(e, t, i) {
        function n(e) {
            function t(t) {
                return t.length > 1 && !r.call(e, t, m) ? null : (m += t.length, t)
            }

            function i(e) {
                return e && p && !isNaN(parseInt(p)) && (e.crs = {
                    type: "name",
                    properties: {
                        name: "urn:ogc:def:crs:EPSG::" + p
                    }
                }), e
            }

            function n() {
                for (; m < e.length && o.indexOf(e.charAt(m)) >= 0;) ++m
            }

            function h() {
                n();
                for (var t, i, r, o = 0, s = [], l = [s], h = s; m < e.length;) {
                    if (t = e.charAt(m), "(" === t) ++m, l.push(h), h = [], l[l.length - 1].push(h), o++;
                    else if (")" === t) {
                        if (++m, h = l.pop(), o--, 0 == o) break
                    } else if ("," === t) ++m, h = [], l[l.length - 1].push(h);
                    else {
                        if (t = e.substring(m), i = parseFloat(t), isNaN(i)) break;
                        h.push(i);
                        var r = t.match(a);
                        r && (m += r[0].length)
                    }
                    n()
                }
                return l.length = 0, 0 !== o ? null : s
            }

            function u() {
                var e, i;
                for (i = 0; i < s.length; ++i)
                    if (e = t(s[i])) {
                        var r = h();
                        return "point" == e && (r = r[0]), n(), {
                            type: l[e],
                            coordinates: r
                        }
                    }
                return null
            }

            function d() {
                var i, r = [];
                if (!t("geometrycollection")) return null;
                if (n(), "(" != e.charAt(m)) return null;
                for (++m; i = c();) r.push(i), n(), "," == e.charAt(m) && (++m, n());
                return ")" != e.charAt(m) ? null : (++m, {
                    type: "GeometryCollection",
                    geometries: r
                })
            }

            function c() {
                return u() || d()
            }
            var f = e.split(";"),
                e = f.pop().toLowerCase(),
                p = (f.shift() || "").split("=").pop(),
                m = 0;
            return i(c())
        }
        t.exports = n;
        var r = String.prototype.startsWith;
        r || (r = function(e, t) {
            return t = t || 0, this.substring(t, t + e.length) === e
        });
        var o = " \f\n\r	â€‹Â áš€â€‹á Žâ€€â€‹â€â€‚â€‹â€ƒâ€„â€‹â€…â€†â€‹â€‡â€ˆâ€‹â€‰â€Šâ€‹\u2028\u2029â€‹â€‹â€¯âŸâ€‹ã€€",
            a = /^[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,
            s = ["point", "multipoint", "multilinestring", "linestring", "polygon", "multipolygon"],
            l = {
                point: "Point",
                multipoint: "MultiPoint",
                multilinestring: "MultiLineString",
                linestring: "LineString",
                polygon: "Polygon",
                multipolygon: "MultiPolygon"
            }
    }, {}],
    214: [function(e, t, i) {
        t.exports.RADIUS = 6378137, t.exports.FLATTENING = 1 / 298.257223563, t.exports.POLAR_RADIUS = 6356752.3142
    }, {}],
    215: [function(e, t, i) {
        "use strict";

        function n(e) {
            a.call(this, c, {
                cookie: "options"
            }), e || this.updateHref()
        }

        function r() {
            return h.isMobile() || h.isTablet() || "ontouchstart" in window || navigator.msMaxTouchPoints > 0
        }
        var o = e("../js/utils/LocationHelper"),
            a = e("../js/utils/ConfigurationHref"),
            s = e("underscore"),
            l = e("util"),
            h = e("browser-detect"),
            u = e("../js/utils/StaticFileResolver"),
            d = function() {
                return navigator.language ? navigator.language : navigator.userLanguage
            }(),
            c = {
                language: d,
                lat: 0,
                lon: 0,
                zoom: 3,
                enableWebGL: !0,
                webGLMinShaderVersion: .9,
                "3d": !0,
                forceDT: !1,
                minDT: 40,
                cutFeaturesByTile: !0,
                textureUnloadPeriod: 1e4,
                updateHRef: !1,
                disableTextManager: !1,
                onlyCanvas: !1,
                draggable: !0,
                draggableTouch: !0,
                scrollwheel: !0,
                disableDoubleClickZoom: !1,
                workOnMove: !1,
                useWebWorkers: !(h.isMobile() || h.isTablet()),
                eyes3dDistance: 15,
                depthMapNear: 10,
                depthMapFar: 500,
                minColorDepthMap: 0,
                maxColorDepthMap: 256,
                factorFarDepthMap: 8,
                fixedFrameRate: null,
                blockVersion: {
                    enable: !0,
                    width: 100,
                    height: 20,
                    borderX: 10,
                    borderY: 0
                },
                mapScale: {
                    width: 200,
                    height: 20,
                    border: 20,
                    debugRender: !1,
                    roundTable: [1e7, 5e6, 2e6, 1e6, 5e5, 2e5, 1e5, 5e4, 2e4, 1e4, 5e3, 2e3, 1e3, 500, 200, 100, 50, 20, 10, 5, 2, 1]
                },
                kml: "",
                cookie: "options",
                limit: {
                    displayed: !0,
                    canEscape: !1,
                    margin: 2e3
                },
                zoomControl: !0,
                ui: {
                    overlaysPickingEnabled: !0,
                    touch: r(),
                    enableGeoloc: !0,
                    enableLoadingSpinner: !0,
                    showOsmSync: !0,
                    buttonActionSamplingInMs: 20,
                    minButtonActionDurationInMs: 100,
                    translationNamespace: "translation"
                },
                controls: {
                    useCtrlToTurn: !1,
                    inverseKeyboardHorizontalRotation: !0,
                    inverseKeyboardVerticalRotation: !1,
                    inverseMouseHorizontalRotation: !1,
                    inverseMouseVerticalRotation: !1
                },
                ssaoParams: {
                    outlineColor: 13684944,
                    outlineTolerance: 2e-4,
                    ssaoRadius: 4,
                    ssaoMaxValue: .25,
                    ssaoContrast: 400
                },
                shadows: {
                    maxDistance: 4e3,
                    bias: .003,
                    size: 2048,
                    color: 9015459,
                    useCsm: !(h.isMobile() || h.isTablet()),
                    usePcf: !1,
                    useLerp: !1,
                    debugShadowMap: !1,
                    debugShadowArea: !1,
                    csm: {
                        maxFar: 4e3,
                        minFar: 1e3,
                        bias: 5e-4,
                        slopeBiasFactor: 7e-4,
                        splitWeight: .75,
                        overlapRatio: 1.005,
                        splitQuantity: 4,
                        detailsShadows: !0,
                        elevationShadows: !0,
                        planar: {
                            maxFar: 8e3,
                            bias: 5e-5,
                            splitWeight: .75,
                            shadowProjectionNearExtend: 1500
                        },
                        elevation: {
                            maxFar: 15e4,
                            bias: 5e-5,
                            splitWeight: .95,
                            shadowProjectionNearExtend: 3e3
                        }
                    }
                },
                tiles: {
                    enabled: !0,
                    enableUpdate: !0,
                    tileTextureCacheSize: 128,
                    useTextureProcessor: !1,
                    ajaxDownload: !0,
                    useRawBlob: !1,
                    blendingDuration: 100,
                    nearScreenQuality: 100,
                    midScreenQuality: 440,
                    farScreenQuality: 200,
                    veryFarScreenQuality: 0,
                    enableMovingSubdivide: !0,
                    movingSubdivideDelay: 2e3,
                    nearScreenQualityElevation: 100,
                    midScreenQualityElevation: 500,
                    farScreenQualityElevation: 500,
                    veryFarScreenQualityElevation: 0,
                    qualityMoving: 2,
                    maxZoom: 19,
                    minZoom: null,
                    maxServerCount: 4,
                    loadTextureTimeout: 1e4,
                    layer3d: "f4_3d",
                    layer2d: "f4_2d"
                },
                treeTileManager: {
                    enabled: !0,
                    refreshPeriod: 100
                },
                multiTouch: {
                    rotationThreshold: 8,
                    rotationSpeedFactor: 8
                },
                textOverlays: {
                    showText: !0,
                    spaceBetweenPinsAndText: 2,
                    decalShadowX: 0,
                    decalShadowY: 1,
                    enableShadow: !0,
                    textAlign: "center",
                    fillColor: "rgba(0,0,0,1)",
                    backgroundColor: "rgba(255,255,255,1)",
                    hoveredBackgroundColor: "rgba(0,0,0,1)",
                    outlineWidth: "2",
                    outlineColor: "rgba(255,255,255,1)",
                    font: "11px Arial",
                    textBaseline: "alphabetic",
                    baselineOffset: 11,
                    maxDistance: 4e4,
                    maxWidth: 150,
                    maxLineHeight: 500,
                    paddingLeft: 4,
                    paddingRight: 8,
                    paddingTop: 2,
                    paddingBottom: 4,
                    backgroundTip: 8,
                    clearHoveredPinZone: !0,
                    hSpacing: 12,
                    vSpacing: 12,
                    selectedEffect: {
                        enabled: !0,
                        fillStyle: "#333",
                        strokeStyle: "black"
                    }
                },
                buildings: {
                    maxDistanceLoad: 7500,
                    maxDistanceUnload: 1e4,
                    queryMaxAgeInS: 43200,
                    keepSoftwareGeometries: !1,
                    workOnMoveWithWorker: !0,
                    enableMinimisedBuildingData: !0,
                    useIndexedGeometries: !0
                },
                details: {
                    lodDistance: 500,
                    queryMaxAgeInS: 43200,
                    boat: !1,
                    car: !1,
                    bus: !1,
                    distanceFilteringEnabled: !0,
                    extraPacking: !0,
                    vehiclePacking: !0,
                    categoryMeshGrouping: !0,
                    animPacking: !0,
                    useIndexedGeometries: !0
                },
                elevations: {
                    queryMaxAgeInS: 604800,
                    zoom: 12,
                    useNormalMap: !0,
                    geometryDivisions: 32,
                    dataSource: "binary",
                    preloadParent: !0,
                    textureSize: 64,
                    granularityInM: 50,
                    minElevationZoom: 10,
                    fastNormalMapCalc: !0,
                    vertexNormalMap: !1,
                    normalMapRequest: !0,
                    source: "vfp_dem3"
                },
                area: {
                    simplifyTolerance: 5e5,
                    maxPointsToClip: 10,
                    altitude: .01,
                    useIndexedGeometries: !0,
                    elevationsEnabled: !1
                },
                line: {
                    altitude: .02,
                    maxPointsToClip: 500
                },
                circle: {
                    altitude: .03,
                    maxPointsToClip: 500
                },
                pins: {
                    lineColor: 6710886,
                    primaryColor: 26291,
                    meshRecenterDistance: 4e6,
                    show: "",
                    hide: "",
                    size: 32,
                    viewMaxDistance: 3e3,
                    minHeight: 17,
                    minBuildingHeight: 5,
                    centerOnItemThresholdInPixel: 50,
                    hidePinsOnMove: !1,
                    sizeForTiles: 500,
                    enableClickableText: !1
                },
                debug: {
                    enableWebGLDebug: !1,
                    showTilesShape: !1,
                    showElevations: !1,
                    debugBuildingColors: !1,
                    blockRandomColor: !1,
                    renderSSAO: !1
                },
                time: {
                    initialDate: "",
                    ratioToRealtime: 1
                },
                environment: {
                    envmapPath: u("data/textures/EnvMap.jpg"),
                    waterReflectionRate: .4,
                    tileWaterColor: {
                        r: .564,
                        g: .623,
                        b: .717
                    }
                },
                heatmapLayer: {
                    renderTextureSize: 128,
                    colorizedRenderTextureSize: 256
                },
                workProcessor: {
                    overallMinDuration: 1,
                    overallMinDurationMoving: 1,
                    overallMaxDuration: 30,
                    overallMaxDurationMoving: 1,
                    heightPinsInterval: 1,
                    heightPinsDuration: 10,
                    heightPinsIntervalMoving: 100,
                    heightPinsDurationMoving: 1,
                    detailsPackInterval: 1,
                    detailsPackDuration: 20,
                    detailsPackIntervalMoving: 100,
                    detailsPackDurationMoving: 1,
                    textManagerInterval: 1,
                    textManagerDuration: 1,
                    textureInterval: 1,
                    textureDuration: 1,
                    textureIntervalMoving: 20,
                    textureDurationMoving: 1,
                    elevationInterval: 1,
                    elevationDuration: 10,
                    elevationIntervalMoving: 1,
                    elevationDurationMoving: 1,
                    tilesInterval: 1,
                    tilesDuration: 20,
                    tilesIntervalMoving: 100,
                    tilesDurationMoving: 10,
                    tilesUpdateInterval: 10,
                    tilesUpdateDuration: 1,
                    tilesUpdateIntervalMoving: 100,
                    tilesUpdateDurationMoving: 1,
                    featuresInterval: 1,
                    featuresDuration: 30,
                    featuresIntervalMoving: 100,
                    featuresDurationMoving: 1,
                    heatmapInterval: 1,
                    heatmapDuration: 10,
                    heatmapIntervalMoving: 20,
                    heatmapDurationMoving: 1,
                    dataLayerInterval: 1,
                    dataLayerDuration: 10,
                    dataLayerIntervalMoving: 20,
                    dataLayerDurationMoving: 1,
                    blockWorkerProcessorInterval: 1,
                    blockWorkerProcessorDuration: 20,
                    blockWorkerProcessorIntervalMoving: 2,
                    blockWorkerProcessorDurationMoving: 2
                },
                downloads: {
                    elevations: {
                        priority: 1,
                        hasToWaitAll: !1,
                        workOnMove: !0
                    },
                    tiles: {
                        priority: 2,
                        hasToWaitAll: !1,
                        workOnMove: !0,
                        isTexture: !0
                    },
                    buildings: {
                        priority: 3,
                        hasToWaitAll: !1,
                        workOnMove: !1
                    },
                    details: {
                        priority: 4,
                        hasToWaitAll: !1,
                        workOnMove: !1
                    }
                },
                camera: {
                    elevationCameraHeight: !0,
                    clipToScreen: !1,
                    rotateSpeed: .001,
                    moveSpeed: 5e-4,
                    theta: 45,
                    phi: 0,
                    near: 10,
                    far: 15e3,
                    farWithElevations: 15e4,
                    fov: 35,
                    distForTransitionPoint: 5e4,
                    stepsBetweenZoomLevels: 1,
                    referenceHeight: 1200,
                    referenceFov: 35,
                    minZ: 100,
                    maxZ: 2e7,
                    defaultZoomMin: 3,
                    zoomMax: 21,
                    extraZoomMax: 24,
                    defaultMaxTheta: 80,
                    stabilizationDelayInMs: 200,
                    stabilizationDelayInMsForOL: 400,
                    inertiaDelay: 1e3 / 60,
                    inertiaFriction: .8,
                    inertiaMinSpeed: 1,
                    minDistToZoomOnItem: 250,
                    "2d": {
                        zoomMax: 19
                    }
                },
                renderer: {
                    ground3dShader: "ground3D",
                    ground2dShader: "ground2D",
                    dataLayerShaderSuffix: "_dataLayer",
                    colorFilterShaderSuffix: "_colorFilter",
                    colorFilterEnabled: !1,
                    remapColorsEnabled: !1
                },
                map2d: {
                    zoomMin: 1,
                    zoomMax: 19,
                    keyboardSlideFactor: 200
                },
                canvas: {
                    width: 0,
                    height: 0
                }
            };
        t.exports = n, l.inherits(n, a);
        var f = n.prototype;
        f.getLonLat90013 = function() {
            return o.convert4326to900913(this.getLonLat4326())
        }, f.getLonLat4326 = function() {
            return {
                lon: parseFloat(this.get("lon")),
                lat: parseFloat(this.get("lat"))
            }
        }, f.setLonLat90013 = function(e) {
            var t = o.convert900913to4326(e);
            this.set("lon", t.lon), this.set("lat", t.lat)
        }, f.getLanguage = function() {
            var e = this.get("language") || "";
            return e = e.split(",")[0], e = e.split("-")[0], e = e.split("_")[0].toLowerCase(), s.contains(["en", "fr"], e) || (e = "en"), e
        }
    }, {
        "../js/utils/ConfigurationHref": 401,
        "../js/utils/LocationHelper": 407,
        "../js/utils/StaticFileResolver": 410,
        "browser-detect": 4,
        underscore: 207,
        util: 212
    }],
    216: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.renderer = e.mapRenderer, l.call(this), e = e || {}, this._canProcessAllRequestsFunction = e.canProcessAllRequests, this.initPriority(), this._featuresProcessor = new u(this.renderer, {
                intervalIdle: this.renderer.conf.get("workProcessor.featuresInterval"),
                maxDurationIdle: this.renderer.conf.get("workProcessor.featuresDuration"),
                workWhenCameraMove: !0,
                intervalMoving: this.renderer.conf.get("workProcessor.featuresIntervalMoving"),
                maxDurationMoving: this.renderer.conf.get("workProcessor.featuresDurationMoving"),
                name: "featuresProcessor"
            }), this._featuresProcessor.registerWorker(a.bind(this.getWork, this), "FeaturesRequestManager::getWork"), this._featuresProcessor.start(), this._onCameraChangedHandler = a.bind(this.onCameraChanged, this), this.renderer.on("cameraChanged", this._onCameraChangedHandler), this.info = {
                requests: {
                    sent: 0,
                    received: 0,
                    failed: 0,
                    startTime: Date.now(),
                    endTime: 0
                },
                traffic: {
                    dataReceived: 0,
                    dataRate: 0,
                    cumulativeTime: 0
                }
            }, this.working = !1, this._callbacksOnWorkFinished = []
        }

        function r(e, t) {
            if (t.aborted) return 1;
            if (e.aborted) return -1;
            var i = e.bounds && e.bounds.zoom || 0,
                n = t.bounds && t.bounds.zoom || 0;
            return i != n ? i > n ? -1 : 1 : e.distanceToCamera != t.distanceToCamera ? e.distanceToCamera < t.distanceToCamera ? -1 : 1 : 0
        }

        function o(e, t, i, n) {
            this.featuresRequestManager = e, this.xhr = null, this.url = t, this.serverName = n.serverName || "", this.params = i, this.options = n, this.method = n.method || null, this.tileKey = n.tileKey, this.aborted = !1, this.received = !1, this.postProcessItems = [], this.infoList = {}, this.center = n.center || null, this.bounds = n.bounds || null, this.protocol = n.protocol || "", this.creationTime = Date.now(), this.sentTime = null, this.receivedTime = null, this.rawDataSize = 0, this.binary = n.binary || !1, this._cleared = !1
        }
        var a = e("underscore"),
            s = e("./utils/Ajax"),
            l = e("events").EventEmitter,
            h = e("util"),
            u = e("./utils/WorkProcessor"),
            d = window.URL || window.webkitURL ? (window.URL || window.webkitURL).createObjectURL : null,
            c = window.URL || window.webkitURL ? (window.URL || window.webkitURL).revokeObjectURL : null,
            f = "image/png",
            p = e("./utils/PriorityRequestsHandler");
        h.inherits(n, l), n.prototype.onDivRemoved = function() {
            this.renderer.removeListener("cameraChanged", this._onCameraChangedHandler), delete this._onCameraChangedHandler, this._featuresProcessor.release(), delete this._featuresProcessor
        }, n.prototype.initPriority = function() {
            if (this.priorityRequests) {
                var e = this;
                a.each(this.priorityRequests, function(t) {
                    a.each(t.pendingRequests, function(t) {
                        e.abortRequest(t)
                    }), a.each(t.requestsWithData, function(t) {
                        e.abortRequest(t)
                    })
                })
            }
            this.priorityRequests = new p, a.each(this.renderer.conf.get("downloads"), function(e) {
                this.priorityRequests.init(e)
            }, this)
        }, n.prototype.ajaxDownloadCanBeEnabled = function() {
            if (!d) return !1;
            try {
                return d(new Blob([], {
                    type: f
                })), !0
            } catch (e) {
                return !1
            }
        }, n.prototype.onCameraChanged = function() {
            this.priorityRequests.setNeedToSort()
        }, n.prototype.askTileToServer = function(e, t) {
            return t.appendQueryString = "/" + e.z + "/" + e.x + "/" + e.y, this.askToServer(t)
        }, n.prototype.askToServer = function(e) {
            var t = e.server || "",
                i = t + "/query";
            e.fullQueryString ? i = t + "/" + e.fullQueryString : e.queryString && (i += "/" + e.queryString), e.appendQueryString && (i += e.appendQueryString);
            var n = new o(this, i, a.clone(e.params), e);
            return this.priorityRequests.queue(n), !this.working && this.hasWork() && (this.working = !0, this.emit("workstarted")), n
        }, n.prototype.askTextureToServer = function(e, t) {
            var i = a.extend({}, t.params);
            t.isPureAjax = !0, t.contentType = f, t.isTexture = !0;
            var n = new o(this, e, i, t);
            return this.priorityRequests.queue(n), n
        }, n.prototype.abortRequest = function(e) {
            e.aborted || e.received || !e.xhr || this.priorityRequests.getPriorityRequest(e.options.priority).ongoingRequestsNbr--, e.aborted = !0, e.xhr && !e.received && e.xhr.abort()
        }, n.prototype.canProcessAllRequests = function() {
            return this._canProcessAllRequestsFunction ? this._canProcessAllRequestsFunction() : !0
        }, n.prototype.updateDistanceToCamera = function(e) {
            var t = 0;
            if (!e.aborted) {
                var i = e.center;
                i ? t = this.renderer.computeDistanceToCenter(i) : console.warn("no request.center", e.url, e)
            }
            e.distanceToCamera = t
        }, n.prototype.sortRequest = function(e) {
            var t = this.priorityRequests.getPriorityRequest(e);
            t.needToSort && (t.needToSort = !1, a.each(t.pendingRequests, this.updateDistanceToCamera, this), t.pendingRequests.sort(r), a.each(t.requestsWithData, this.updateDistanceToCamera, this), t.requestsWithData.sort(r))
        }, n.prototype.onWorkFinished = function(e) {
            this.hasWork() ? this._callbacksOnWorkFinished.push(e) : e()
        }, n.prototype.sendOnWorkFinished = function() {
            var e = this;
            this._callbacksOnWorkFinished.length && a.defer(function() {
                requestAnimationFrame(function() {
                    e.hasWork() || (a.each(e._callbacksOnWorkFinished, function(e) {
                        return e()
                    }), e._callbacksOnWorkFinished = [])
                })
            })
        }, n.prototype.hasWork = function() {
            return a.some(this.priorityRequests.all(), function(e) {
                return e && (e.pendingRequests.length || e.requestsWithData.length || e.ongoingRequestsNbr)
            })
        }, n.prototype.getWork = function() {
            var e = this,
                t = this.hasWork();
            this.working && !t && (this.working = !1, this.emit("workended"), this.sendOnWorkFinished());
            var i = {
                callback: null,
                hadWork: !1
            };
            return a.some(this.priorityRequests.all(), a.bind(this.processPriorityRequest, this, i), this), i.hadWork && (this.hasWork() || a.defer(function() {
                e.emit("drain")
            }, this)), this._callbacksOnWorkFinished.length && !this.hasWork() && this.sendOnWorkFinished(), i.callback
        }, n.prototype.processPriorityRequest = function(e, t) {
            if (!t || this.renderer.isMoving() && !t.workOnMove) return !1;
            for (var i; !e.callback && t.pendingRequests.length;) {
                for (e.hadWork = !0, t.needToSort && this.sortRequest(t.priority), i = t.pendingRequests.shift(); t.pendingRequests.length && i.aborted;) i = t.pendingRequests.shift();
                i && !i.aborted && (t.isTexture ? e.callback = a.bind(this._sendTextureRequest, this, t, i) : e.callback = a.bind(this._sendRequest, this, t, i))
            }
            for (; !e.callback && t.requestsWithData.length;) e.hadWork = !0, i = t.requestsWithData[0], i.xhr && i.rawData ? i.options.isTexture ? e.callback = a.bind(this._parseTexture, this, t, i) : i.options.processRawData ? e.callback = a.bind(this._processRawData, this, i) : e.callback = a.bind(this._parseData, this, i) : i.xhr && i.data && i.data.length ? e.callback = a.bind(this._processData, this, i) : i.xhr && i.options.postProcessData && i.postProcessItems ? e.callback = a.bind(this._postProcessData, this, i) : t.requestsWithData.shift().clear();
            return e.callback ? !0 : t.ongoingRequestsNbr > 0 && t.hasToWaitAll && t.timeToWait && Date.now() - t.lastReceivedDate < t.timeToWait
        }, n.prototype._sendRequest = function(e, t) {
            if (!t.aborted) {
                e.ongoingRequestsNbr++;
                var i = null;
                i = t.options.noStringify ? t.params : {
                    query: JSON.stringify(t.params)
                }, t.sentTime = Date.now();
                var n = this.info;
                n.requests.sent++;
                var r = this.priorityRequests;
                t.xhr = s.download(t.serverName, {
                    url: t.url,
                    type: t.method || "GET",
                    dataType: t.binary ? "binary" : "text",
                    responseType: t.binary ? "arraybuffer" : "text",
                    data: i,
                    complete: function() {
                        if (!t.aborted && t.options) {
                            var e = r.getPriorityRequest(t.options.priority);
                            e.ongoingRequestsNbr--, e.needToSort = !0, e.lastReceivedDate = Date.now()
                        }
                        t.received = !0
                    },
                    success: function(e) {
                        if (t.xhr) {
                            t.rawData = e;
                            var i = r.getPriorityRequest(t.options.priority);
                            t.receivedTime = Date.now(), t.rawDataSize = e.length, n.requests.received++, n.traffic.cumulativeTime += t.getRequestDurationS(), n.traffic.dataReceived += t.rawDataSize, n.traffic.dataRate += t.rawDataSize / t.getRequestDurationS(), i.requestsWithData.push(t)
                        }
                    },
                    error: function(e) {
                        t.options && t.options.onError && t.options.onError(e), t.clear(), n.requests.failed++
                    }
                }, t.protocol)
            }
        }, n.prototype._sendTextureRequest = function(e, t) {
            if (!t.aborted) {
                e.ongoingRequestsNbr++;
                var i;
                t.sentTime = Date.now();
                var n = this.info;
                n.requests.sent++;
                var r = this.renderer.conf.get("tiles.useRawBlob");
                i = r ? s.downloadBlob(t.url, this.renderer) : s.downloadArrayBuffer(t.url, this.renderer);
                var o = this.priorityRequests;
                t.xhr = i.always(function() {
                    if (!t.aborted) {
                        var e = o.getPriorityRequest(t.options.priority);
                        e.ongoingRequestsNbr--, e.needToSort = !0, e.lastReceivedDate = Date.now()
                    }
                    t.received = !0
                }).done(function(e) {
                    if (t.xhr) {
                        var i;
                        i = r ? e : new Blob([e], {
                            type: f
                        }), t.rawData = d(i), t.objectUrl = t.rawData;
                        var a = o.getPriorityRequest(t.options.priority);
                        a.requestsWithData.push(t), t.receivedTime = Date.now(), t.rawDataSize = e.byteLength, n.requests.received++, n.traffic.cumulativeTime += t.getRequestDurationS(), n.traffic.dataReceived += t.rawDataSize, n.traffic.dataRate += t.rawDataSize / t.getRequestDurationS()
                    }
                }).fail(function(e) {
                    t.options && t.options.onError && t.options.onError(e), t.clear(), n.requests.failed++
                })
            }
        }, n.prototype._postProcessData = function(e) {
            e.xhr && (e.options.postProcessData(e.postProcessItems, e), delete e.postProcessItems)
        }, n.prototype._processData = function(e) {
            if (e.xhr) {
                var t = e.options.groupPostProcess,
                    i = e.data.shift(),
                    n = i;
                e.options.processData && (n = e.options.processData(i, e)), e.options.postProcessData && n && (t ? e.postProcessItems.push(n) : e.options.postProcessData([n], e))
            }
        }, n.prototype._parseData = function(e) {
            if (e.xhr && e.rawData) {
                try {
                    e.data = JSON.parse(e.rawData)
                } catch (t) {
                    console.error("Invalid JSON: %s (%s)", e.rawData, t)
                }
                a.isObject(e.data) && a.isArray(e.data.values) && (e.data = e.data.values), e.params.format && "geojson" == e.params.format.out && (e.data = e.data.features), delete e.rawData
            }
        }, n.prototype._processRawData = function(e) {
            if (e.xhr && e.rawData) {
                var t = e.rawData;
                delete e.rawData, e.options.processRawData(t, e)
            }
        }, n.prototype._parseTexture = function(e, t) {
            t.options.onSuccess && t.options.onSuccess(t.rawData), delete t.rawData, e.requestsWithData.shift().clear()
        }, n.prototype.initStats = function() {
            this.info.requests.sent = 0, this.info.requests.received = 0, this.info.requests.failed = 0, this.info.requests.startTime = Date.now(), this.info.requests.endTime = 0, this.info.traffic.dataReceived = 0, this.info.traffic.cumulativeTime = 0, this.info.traffic.cumulativeTime = 0
        }, n.prototype.finalizeAndGetStats = function() {
            this.info.requests.endTime = Date.now();
            var e = .001 * (this.info.requests.endTime - this.info.requests.startTime);
            if (e > 0) {
                var t = 0 == this.info.requests.received ? 0 : this.info.traffic.cumulativeTime / this.info.requests.received,
                    i = 0 == this.info.requests.received ? 0 : this.info.traffic.dataRate / this.info.requests.received;
                return {
                    duration: e,
                    requests: {
                        received: this.info.requests.received,
                        sent: this.info.requests.sent,
                        failed: this.info.requests.failed
                    },
                    traffic: {
                        dataReceived: this.info.traffic.dataReceived,
                        averageRequestTime: t,
                        averageDataRate: i
                    }
                }
            }
            return null
        }, o.prototype.abort = function() {
            this.featuresRequestManager && this.featuresRequestManager.abortRequest(this), this.clear()
        }, o.prototype.getRequestDurationS = function() {
            return .001 * (this.receivedTime - this.sentTime)
        }, o.prototype.clear = function() {
            this.objectUrl && (c(this.objectUrl), delete this.objectUrl);
            var e;
            this.featuresRequestManager = null, this.data = null, this.rawData = null, this.options && (this.options.onError = null, this.options.onSuccess = null, this.options.texture && (this.options.texture.request = null, this.options.texture = null), e = this.options.onClear, this.options.onClear = null, this.options = null), this.params = null, this.xhr = null, this.postProcessItems = null, this.center = null, this.bounds = null, this.infoList = null, !this._cleared && e && e(), this._cleared = !0
        }, t.exports = n
    }, {
        "./utils/Ajax": 397,
        "./utils/PriorityRequestsHandler": 409,
        "./utils/WorkProcessor": 416,
        events: 99,
        underscore: 207,
        util: 212
    }],
    217: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i;
            if (e.features) {
                i = [];
                for (var n = 0; n < e.features.length; n++) i.push(c(e.features[n].geometry, t, e.features[n].properties))
            } else i = f('Invalid GeoJSON object: FeatureCollection object missing "features" member.');
            return i
        }

        function r(e, t) {
            var i;
            if (e.geometries) {
                i = [];
                for (var n = 0; n < e.geometries.length; n++) i.push(c(e.geometries[n], t))
            } else i = f('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');
            return i
        }

        function o(e, t) {
            var i, o = t || {};
            switch (e.type) {
                case "FeatureCollection":
                    i = n(e, o);
                    break;
                case "GeometryCollection":
                    i = r(e, o);
                    break;
                case "Feature":
                    i = e.properties && e.geometry ? c(e.geometry, o, e.properties) : f('Invalid GeoJSON object: Feature object missing "properties" or "geometry" member.');
                    break;
                case "Point":
                case "MultiPoint":
                case "LineString":
                case "MultiLineString":
                case "Polygon":
                case "MultiPolygon":
                    i = e.coordinates, i ? i = c(e, o) : f('Invalid GeoJSON object: Geometry object missing "coordinates" member.');
                    break;
                default:
                    i = f('Invalid GeoJSON object: GeoJSON object must be one of "Point", "LineString", "Polygon", "MultiPolygon", "Feature", "FeatureCollection" or "GeometryCollection".')
            }
            return i
        }

        function a(e, t, i) {
            t.position = new g(e.coordinates[1], e.coordinates[0]);
            var n = new _(t);
            return i && n.set("geojsonProperties", i), n
        }

        function s(e, t, i) {
            for (var n = [], r = 0; r < e.coordinates.length; r++) t.position = new g(e.coordinates[r][1], e.coordinates[r][0]), n.push(new _(t));
            if (i)
                for (var o = 0; o < n.length; o++) n[o].set("geojsonProperties", i);
            return n
        }

        function l(e, t, i) {
            for (var n = [], r = 0; r < e.coordinates.length; r++) {
                var o = e.coordinates[r],
                    a = new g(o[1], o[0]);
                n.push(a)
            }
            t.path = n;
            var s = new v(t);
            return i && s.set("geojsonProperties", i), s
        }

        function h(e, t, i) {
            for (var n = [], r = 0; r < e.coordinates.length; r++) {
                for (var o = [], a = 0; a < e.coordinates[r].length; a++) {
                    var s = e.coordinates[r][a],
                        l = new g(s[1], s[0]);
                    o.push(l)
                }
                t.path = o, n.push(new v(t))
            }
            if (i)
                for (var h = 0; h < n.length; h++) n[h].set("geojsonProperties", i);
            return n
        }

        function u(e, t, i) {
            for (var n, r, o = [], a = 0; a < e.coordinates.length; a++) {
                for (var s = [], l = 0; l < e.coordinates[a].length; l++) {
                    var h = new g(e.coordinates[a][l][1], e.coordinates[a][l][0]);
                    s.push(h)
                }
                a ? 1 == a ? (r = p(s), n == r ? o.push(s.reverse()) : o.push(s)) : n == r ? o.push(s.reverse()) : o.push(s) : (n = p(s), o.push(s))
            }
            t.paths = o;
            var u = new y(t);
            return i && u.set("geojsonProperties", i), u
        }

        function d(e, t, i) {
            for (var n = [], r = 0; r < e.coordinates.length; r++) {
                for (var o, a, s = [], l = 0; l < e.coordinates[r].length; l++) {
                    for (var h = [], u = 0; u < e.coordinates[r][l].length; u++) {
                        var d = new g(e.coordinates[r][l][u][1], e.coordinates[r][l][u][0]);
                        h.push(d)
                    }
                    l ? 1 == l ? (a = p(h), o == a ? s.push(h.reverse()) : s.push(h)) : o == a ? s.push(h.reverse()) : s.push(h) : (o = p(h), s.push(h))
                }
                t.paths = s, n.push(new y(t))
            }
            if (i)
                for (var c = 0; c < n.length; c++) n[c].set("geojsonProperties", i);
            return n
        }

        function c(e, t, i) {
            var n, r = m(t);
            switch (e.type) {
                case "Point":
                    n = a(e, r, i);
                    break;
                case "MultiPoint":
                    n = s(e, r, i);
                    break;
                case "LineString":
                    n = l(e, r, i);
                    break;
                case "MultiLineString":
                    n = h(e, r, i);
                    break;
                case "Polygon":
                    n = u(e, r, i);
                    break;
                case "MultiPolygon":
                    n = d(e, r, i);
                    break;
                case "GeometryCollection":
                    if (n = [], e.geometries)
                        for (var o = 0; o < e.geometries.length; o++) n.push(c(e.geometries[o], r, i || null));
                    else n = f('Invalid GeoJSON object: GeometryCollection object missing "geometries" member.');
                    break;
                default:
                    n = f('Invalid GeoJSON object: Geometry object must be one of "Point", "LineString", "Polygon" or "MultiPolygon".')
            }
            return n
        }

        function f(e) {
            return {
                type: "Error",
                message: e
            }
        }

        function p(e) {
            for (var t, i = 0, n = 0; n < e.length - 2; n++) i += (e[n + 1].lat() - e[n].lat()) * (e[n + 2].lng() - e[n].lng()) - (e[n + 2].lat() - e[n].lat()) * (e[n + 1].lng() - e[n].lng());
            return t = i > 0
        }

        function m(e) {
            var t = {};
            for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]);
            return t
        }
        var g = e("./api/LatLng"),
            _ = e("./api/Marker"),
            v = e("./api/Polyline"),
            y = e("./api/Polygon");
        t.exports = o
    }, {
        "./api/LatLng": 233,
        "./api/Marker": 241,
        "./api/Polygon": 247,
        "./api/Polyline": 248
    }],
    218: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            l.call(this, e, t, i), this._isMoving = !1, this.computeFov(), this.idleEvent = null, this._heatMapLayers = [], this.zoomMax = this.conf.get("map2d.zoomMax"), this.zoomMin = this.conf.get("camera.defaultZoomMin"), this.lastMousePos = {
                x: 0,
                y: 0
            }, this.currentTime = Date.now(), this.oldTime = this.currentTime, this.postRenderTimeoutID = window.setInterval(o.bind(this.sendPrePostRender, this), 50);
            var n = this.conf.getLonLat90013(),
                r = this.conf.get("zoom");
            r = Math.round(r), r = Math.max(this.zoomMin, r), r = Math.min(this.zoomMax, r);
            var s = a('<div class="f4map-ol"></div>').prependTo(this.$parentNode);
            this.$mapContainer = s, leafletF4.Draggable.prototype._freeze = !1;
            var d = leafletF4.Draggable.prototype._updatePosition;
            leafletF4.Draggable.prototype._updatePosition = function() {
                this._freeze || d.apply(this, arguments)
            }, this._mapLeaf = leafletF4.map(s.get(0), {
                keyboardPanOffset: 256,
                zoomControl: !1,
                attributionControl: !1
            }), this.setCenter(n, r), leafletF4.Icon.prototype.createShadow = function() {
                return null
            }, e = this.conf;
            var c = this;
            b.onServerHostReady("tile", function(t) {
                var i = t + "/tiles/" + e.get("tiles.layer2d") + "/{z}/{x}/{y}.png",
                    n = [];
                if (-1 != i.indexOf("%d")) {
                    i = i.replace("%d", "{s}");
                    for (var r = 0; r < e.get("tiles.maxServerCount"); ++r) n.push("" + r)
                }
                c.tileLayer || (c.tileLayer = leafletF4.tileLayer(i, {
                    noWrap: !0,
                    continuousWorld: !0,
                    subdomains: n,
                    maxZoom: c.zoomMax,
                    minZoom: c.zoomMin
                }), c.tileLayer.addTo(c._mapLeaf))
            }), this.initNavigation(), this._mapLeaf.on({
                zoomstart: o.bind(this.onZoomStart, this),
                zoomend: o.bind(this.onZoomEnd, this),
                movestart: o.bind(this.onMoveStart, this),
                move: o.bind(this.onMove, this),
                moveend: o.bind(this.onMoveEnd, this),
                mousedown: o.bind(this.onMouseDown, this),
                mousemove: o.bind(this.onMouseMove, this),
                mouseup: o.bind(this.onMouseUp, this),
                touchstart: o.bind(this.onTouchStart, this),
                touchmove: o.bind(this.onTouchMove, this),
                touchend: o.bind(this.onTouchEnd, this),
                dblclick: o.bind(this.onDblClick, this),
                contextmenu: o.bind(this.onContextMenu, this),
                "dblclick ": o.bind(this.onDblClick, this)
            }), leafletF4.DomEvent.addListener(this._mapLeaf._container, "touchstart", o.bind(this.onTouchStart, this)), leafletF4.DomEvent.addListener(this._mapLeaf._container, "touchmove", o.bind(this.onTouchMove, this)), leafletF4.DomEvent.addListener(this._mapLeaf._container, "touchend", o.bind(this.onTouchEnd, this)), leafletF4.DomEvent.addListener(this._mapLeaf._container, "mousewheel", o.bind(this.onMouseWheel, this));
            var f = this.getScreenSize();
            if (this.width = f.x, this.height = f.y, this._pinsManager = new u(this), this.resize(this.makeIdleEvent(!1)), this.cameraStabilized(this.makeIdleEvent(!1)), !this.conf.get("disableTextManager")) {
                this.textManager = new h(this, this.$parentNode);
                var p = this.textManager.container2d;
                p.detach().insertAfter(this.$mapContainer), p.css("z-index", a(this.$mapContainer).css("z-index") + 1)
            }
            this.manageMapReady()
        }

        function r(e) {
            var t = e.clientX,
                i = e.clientY;
            e.changedTouches.length && (t = e.changedTouches[0].clientX, i = e.changedTouches[0].clientY);
            var n = e.type;
            return {
                originalEvent: {
                    clientX: t,
                    clientY: i,
                    type: n
                }
            }
        }
        var o = e("underscore"),
            a = e("jquery"),
            s = e("util"),
            l = e("./MapRenderer"),
            h = e("./graphic/text/TextManager"),
            u = e("./graphic/pins/PinsManager"),
            d = e("./graphic/area/AreaLeaf"),
            c = e("./graphic/camera/CameraHelper"),
            f = e("engine"),
            p = f.Vector2,
            m = f.Vector3,
            g = e("./utils/LocationHelper"),
            _ = e("./graphic/pins/MarkerLeafRenderer"),
            v = e("./graphic/heatmap/HeatmapLayerLeafRenderer"),
            y = e("./api/MapTypeId"),
            b = e("./ServerConfig");
        t.exports = n, s.inherits(n, l);
        var x = n.prototype;
        x.setDate = function() {}, x.setTimeRatio = function() {}, x.getWebGLInfo = function() {
            return {
                supported: !1
            }
        }, x.setSize = function(e, t) {
            this.idleEvent = t, this.setCanvasSize(e), this.computeFov()
        }, x.addHeatMap = function(t, i) {
            return this._mapLeaf ? (e("leaflet.heat"), leafletF4.heatLayer(t, i).addTo(this._mapLeaf)) : void 0
        }, x.removeHeatMap = function(e) {
            this._mapLeaf && this._mapLeaf.removeLayer(e)
        }, x.getSize = function() {
            return {
                w: this.width,
                h: this.height
            }
        }, x.onDivRemoved = function() {
            this.isDestroyed = !0, this.postRenderTimeoutID && (clearInterval(this.postRenderTimeoutID), delete this.postRenderTimeoutID)
        }, x.computeFov = function() {
            var e = c.computeFov(this.conf, this.height);
            this.tanHalfFov = Math.tan(e / 2 * Math.PI / 180)
        }, x.cameraStabilized = function(e) {
            this.askForHover(), this.emit("cameraStabilized", e)
        }, x.onInitCameraFromApi = function() {}, x.onSetOptionsFromApi = function() {}, x.sendCameraChanged = function() {
            var e = this.getZoom(),
                t = this.getCenter();
            this.emit("cameraChanged", e, t)
        }, x.setMaxBounds = function(e) {
            if (this._mapLeaf) {
                var t = g.convert900913to4326({
                        lon: e.xMin,
                        lat: e.yMin
                    }),
                    i = window.leafletF4.latLng(t.lat, t.lon),
                    n = g.convert900913to4326({
                        lon: e.xMax,
                        lat: e.yMax
                    }),
                    r = window.leafletF4.latLng(n.lat, n.lon),
                    o = window.leafletF4.latLngBounds(i, r);
                this._mapLeaf.setMaxBounds(o)
            }
        }, x.setMinZoomLayer2dFromApi = function() {}, x.sendPreRender = function(e) {
            this.emit("preRender", e), this._pinsManager.onPreRender(e)
        }, x.createMarkerRenderer = function() {
            return new _(this)
        }, x.getPinsManager = function() {
            return this._pinsManager
        }, x.sendPostRender = function(e) {
            this.emit("postRender", e)
        }, x.sendToCamera = function() {
            this.idleEvent = this.makeIdleEvent(!0);
            var e = Array.prototype.splice.call(arguments, 0),
                t = e.shift();
            "zoomIn" == t ? this.onZoomIn() : "zoomOut" == t ? this.onZoomOut() : console.warn("MapLeafRenderer.sendToCamera not implemented", t)
        }, x.canSwitchBetween3dAnd2d = function() {
            return !1
        }, x.isIn3d = function() {
            return !1
        }, x.newArea = function(e) {
            return new d(e)
        }, x.getHeading = function() {
            return 0
        }, x.getTilt = function() {
            return 0
        }, x.lookAtNorth = function() {}, x.setTarget = function(e) {
            this.setCenter(e, this.getZoom())
        }, x.getCurrentCameraConfiguration = function() {
            var e = this.getCenter();
            return {
                lon: Math.round(e.lon),
                lat: Math.round(e.lat),
                zoom: this.getZoom(),
                camera: {
                    theta: 0,
                    phi: 0
                }
            }
        }, x.onDblClick = function() {
            this.idleEvent = this.makeIdleEvent(!0)
        }, x.onMouseWheel = function() {
            this.idleEvent = this.makeIdleEvent(!0)
        }, x.fitBounds = function(e, t) {
            this.idleEvent = t;
            var i = g.convert900913to4326({
                    lon: e.left,
                    lat: e.bottom
                }),
                n = leafletF4.latLng(i.lat, i.lon),
                r = g.convert900913to4326({
                    lon: e.right,
                    lat: e.top
                }),
                o = leafletF4.latLng(r.lat, r.lon),
                a = leafletF4.latLngBounds(n, o);
            this._mapLeaf && this._mapLeaf.fitBounds(a, {
                animate: !1
            })
        }, x.panToBounds = function(e, t) {
            this.idleEvent = t, this.fitBounds(e, t)
        }, x.teleport = function(e, t, i, n) {
            this.idleEvent = n;
            var r = this.getScreenSize(),
                o = this.computeLocationFromPixel({
                    x: .5 * r.x,
                    y: .5 * r.y
                }),
                a = {
                    lon: o.lon - e.lon,
                    lat: o.lat - e.lat
                },
                s = this.getCenter(),
                l = {
                    lon: s.lon,
                    lat: s.lat
                };
            l.lon -= a.lon, l.lat -= a.lat, t ? this.panTo(l, null, n) : this.setCenter(l, this.getZoom()), i && i()
        }, x.setView = function(e, t) {
            this._mapLeaf.setView(e, t)
        }, x.getProjectionScreenMatrix = function() {
            return null
        }, x.setZoom = function(e, t) {
            this.idleEvent = t, this._mapLeaf && this._mapLeaf.setZoom(e, {
                animate: !1
            }), this.conf.set("zoom", e)
        }, x.setHeading = function(e) {
            this.idleEvent = e
        }, x.set3d = function(e) {
            this.idleEvent = e
        }, x.setTilt = function(e) {
            this.idleEvent = e
        }, x.getPixelSizeInMeter = function(e) {
            var t = this.getScreenSize(),
                i = {
                    x: .5 * t.x,
                    y: .5 * t.y
                },
                n = .5 * e,
                r = {
                    x: i.x - n,
                    y: i.y + n
                },
                o = {
                    x: i.x + n,
                    y: i.y - n
                },
                a = this.computeLocationFromPixel(r),
                s = this.computeLocationFromPixel(o);
            return new p(a.lon, a.lat).distanceTo(new p(s.lon, s.lat))
        }, x.isMoving = function() {
            return this._isMoving
        }, x.setMoving = function(e) {
            this._isMoving = e
        }, x.getScreenSize = function() {
            return this._mapLeaf ? this._mapLeaf.getSize() : {}
        }, x.computeLonLatFromPixel = function(e) {
            if (this._mapLeaf) {
                var t = this._mapLeaf.containerPointToLatLng(leafletF4.point(e.x, e.y));
                return g.convert4326to900913(g.convertLonLatOrXYToLonLat(t))
            }
            return {
                lon: 0,
                lat: 0
            }
        }, x.computeLonLatFromPixel = function(e, t, i) {
            if (this._mapLeaf) {
                var n;
                if (i) {
                    var r = {
                        w: this.$parentNode.width(),
                        h: this.$parentNode.height()
                    };
                    return this.$parentNode.width(i.width), this.$parentNode.height(i.height), this.setSize({
                        w: i.width,
                        h: i.height
                    }, null), n = this._mapLeaf.containerPointToLatLng(leafletF4.point(e.x, e.y)), this.$parentNode.width(r.w), this.$parentNode.height(r.h), this.setSize({
                        w: r.w,
                        h: r.h
                    }, null), this.$parentNode.width("auto"), this.$parentNode.height("auto"), g.convert4326to900913(g.convertLonLatOrXYToLonLat(n))
                }
                return n = this._mapLeaf.containerPointToLatLng(new leafletF4.Point(e.x, e.y)), g.convert4326to900913(g.convertLonLatOrXYToLonLat(n))
            }
            return {
                lon: 0,
                lat: 0
            }
        }, x.computeLocationFromPixel = function(e) {
            return this.computeLonLatFromPixel(e)
        }, x.computeScreenPosInPixels = function(e) {
            if (this._mapLeaf) {
                var t = g.convertLonLatOrXYToLonLat(e);
                return this._mapLeaf.latLngToContainerPoint(g.convert900913to4326(t), this._mapLeaf.getZoom())
            }
            return {}
        }, x.getFrustumFull = function() {
            var e = this.getScreenSize(),
                t = this.computeLonLatFromPixel({
                    x: 0,
                    y: 0
                }),
                i = this.computeLonLatFromPixel(e);
            return {
                xMin: Math.min(t.lon, i.lon),
                xMax: Math.max(t.lon, i.lon),
                yMin: Math.min(t.lat, i.lat),
                yMax: Math.max(t.lat, i.lat)
            }
        }, x.getVisibleGroundBoundingBox = function() {
            var e = this.getFrustumFull();
            return [new m(e.xMin, e.yMax), new m(e.xMax, e.yMax), new m(e.xMax, e.yMin), new m(e.xMin, e.yMin)]
        }, x.computeDistanceToCenter = function(e) {
            var t = this.getCenter(),
                i = new m(t.lon, t.lat, 0);
            return i.distanceTo(e)
        }, x.getFrustumForZoom = function(e, t) {
            return this.getFrustumForZoomAndTarget(e, null, t)
        }, x.getFrustumForZoomAndTarget = function(e, t) {
            var i = this.backupCamera();
            this.setCenter(t ? t : this.getCenter(), e);
            var n = this.getFrustumFull();
            return this.restoreCamera(i), n
        }, x.backupCamera = function() {
            return {
                zoom: this.getZoom(),
                center: this.getCenter()
            }
        }, x.restoreCamera = function(e) {
            this.setCenter(e.center, e.zoom)
        }, x.getPosCamera = function() {
            var e = this.getCenter(),
                t = c.computeDistanceFromZoom(this.conf, this.getZoom());
            return {
                x: e.lon,
                y: e.lat,
                z: t
            }
        }, x.getPosFromTargetAndZoom = function(e, t) {
            var i = c.computeDistanceFromZoom(this.conf, t);
            return {
                x: e.lon,
                y: e.lat,
                z: i
            }
        }, x.setScrollwheel = function(e) {
            var t = this._mapLeaf;
            t && (e ? t.scrollWheelZoom.enable() : t.scrollWheelZoom.disable())
        }, x.setdisableDoubleClickZoom = function() {}, x.setDraggableTouch = function(e) {
            this.$parentNode.toggleClass("draggableTouch", e);
            var t = this._mapLeaf;
            this._mapLeaf && (e ? t.tap && (t.tap.enable(), t.dragging.enable()) : t.tap && (t.tap.disable(), t.dragging.disable()))
        }, x.setDraggable = function(e) {
            if (this._mapLeaf) {
                var t = this._mapLeaf.dragging;
                t._draggable._freeze = !e, e ? t.enable() : t.disable()
            }
        }, x.isDragging = function() {
            return this.hasDragged
        }, x.onCameraChangedFromApi = function() {
            this.cameraStabilized(this.makeIdleEvent(!1))
        }, x.update2dTo3d = function() {}, x.setElevationFromApi = function() {}, x.computePicked = function(e, t) {
            var i = {
                    picked: null,
                    type: null,
                    clickable: !0
                },
                n = this.conf.get("ui.overlaysPickingEnabled");
            if (n) {
                var r = this.getPickedArea();
                r && (i.picked = r, i.type = "lineOrArea", i.clickable = r.clickable)
            }
            return t(i, e)
        }, x.getPickedArea = function() {
            if (this._mapLeaf) {
                var e = [];
                return this._mapLeaf.eachLayer(function(t) {
                    t.hasBeenClicked && (t.options && t.options.area && e.push(t.options.area), delete t.hasBeenClicked)
                }), e && e[0]
            }
            return null
        }, x.forceRender = function() {}, x.getMapDate = function() {
            return Date.now()
        }, x.onMove = function() {
            this.sendCameraChanged(), this.sendPrePostRender()
        }, x.onMoveStart = function() {
            this.setMoving(!0)
        }, x.hasTouchMoved = function() {
            return this.hasMoved
        }, x.onMouseMove = function(e, t) {
            var i = e.originalEvent,
                n = Math.abs(this.lastMousePos.x - i.clientX) > 0 || Math.abs(this.lastMousePos.y - i.clientY > 0);
            return this.isDown && !this.hasMoved && n && (this.hasMoved = !0, this._onDragStart(i), this._isDragging = !0), this.lastMousePos.x = i.clientX, this.lastMousePos.y = i.clientY, this._isDragging ? this._onDrag(i) : t ? this._sendMouseMapEvent("mousemove", i) : l.prototype.onMouseMove.call(this, i), !this._isDragging
        }, x.onMoveEnd = function() {
            var e = this.getZoom(),
                t = this.getCenter();
            this.conf.setLonLat90013(t), this.conf.set("zoom", e), this.setMoving(!1), this.idleEvent && (this.cameraStabilized(this.idleEvent), this.idleEvent = null), this.sendPrePostRender()
        }, x.onZoomStart = function() {
            this.textManager && this.textManager.setVisibility(!1), this.sendPrePostRender()
        }, x.onZoomEnd = function() {
            this.textManager && this.textManager.setVisibility(!0), this.sendPrePostRender();
            var e = this.zoomMin;
            this.getZoom() < e && this.setZoom(e);
            var t = this.zoomMax;
            this.getZoom() > t && this.setZoom(t), o.each(this._heatMapLayers, function(e) {
                e.updateZoom()
            })
        }, x.setCameraConfig = function(e, t) {
            this.idleEvent = t, e.lat && e.lon && this.setCenter(e, e.zoom)
        }, x.setCanvasSize = function(e) {
            this._mapLeaf && (this.width = e.w, this.height = e.h, this._mapLeaf.invalidateSize(!1))
        }, x.addShapeFeature = function(e, t) {
            return leafletF4.geoJson(e, t)
        }, x.setShapeVisibility = function(e, t) {
            t ? this.addShape(e) : this.removeShape(e)
        }, x.addShape = function(e) {
            this._mapLeaf && this._mapLeaf.addLayer(e)
        }, x.removeShape = function(e) {
            this._mapLeaf && this._mapLeaf.removeLayer(e)
        }, x.addMarker = function(e, t) {
            if (this._mapLeaf) {
                var i = leafletF4.marker(g.convert900913to4326(e), t);
                return this._mapLeaf.addLayer(i), i
            }
            return null
        }, x.removeMarker = function(e) {
            this._mapLeaf && this._mapLeaf.removeLayer(e)
        }, x._hasMultiTouch = function(e) {
            var t;
            return e.targetTouches && (t = e.targetTouches), e.touches && (t = e.touches), t ? t.length > 1 : !1
        }, x.onTouchStart = function(e) {
            return this.onMouseDown(r(e))
        }, x.onTouchMove = function(e) {
            return this.conf.get("draggableTouch") || (this._hasMultiTouch(e) ? this._onTouchDragForcedStop() : this._onTouchDragForcedStart()), this.onMouseMove(r(e), !0)
        }, x.onTouchEnd = function(e) {
            return this.conf.get("draggableTouch") || this._onTouchDragForcedStop(), this.onMouseUp(r(e))
        }, x.onMouseDown = function(e) {
            var t = e.originalEvent;
            return this.hasMoved = !1, this.isDown = !0, this.lastMousePos.x = t.clientX, this.lastMousePos.y = t.clientY, this._onMouseDown(t), !0
        }, x.onMouseUp = function(e) {
            var t = e.originalEvent;
            return this._isDragging && (this._isDragging = !1, this._onDragStop(t)), this.hasMoved ? (this.idleEvent = this.makeIdleEvent(!0), this.hasMoved = !1) : 0 == t.button && this._onClick(t), this.isDown = !1, this._onMouseUp(t), !0
        }, x.onContextMenu = function(e) {
            var t = e.originalEvent;
            this._onRightClick(t)
        }, x.onDblClick = function(e) {
            var t = e.originalEvent;
            this._onDblClick(t)
        }, x.getCenter = function() {
            return this._mapLeaf ? g.convert4326to900913(g.convertLonLatOrXYToLonLat(this._mapLeaf.getCenter())) : {
                lon: 0,
                lat: 0
            }
        }, x.getZoom = function() {
            return this._mapLeaf ? this._mapLeaf.getZoom() : 0
        }, x.panTo = function(e) {
            this._mapLeaf && this._mapLeaf.panTo(g.convert900913to4326(e)), this.conf.setLonLat90013(e)
        }, x.getZoomFromBoundsFromApi = function(e) {
            var t = g.convertGoogleLatLngTo900913(e.sw),
                i = g.convertGoogleLatLngTo900913(e.ne),
                n = this.backupCamera();
            this.fitBounds({
                left: t.lon,
                right: i.lon,
                bottom: t.lat,
                top: i.lat
            });
            var r = this.getZoom();
            return this.restoreCamera(n), r
        }, x.lonLatToLeaf = function(e) {
            return leafletF4.latLng(e.lat, e.lon)
        }, x.leafToLonLat = function(e) {
            return {
                lon: e.lng,
                lat: e.lat
            }
        }, x.setCenter = function(e, t, i) {
            this.idleEvent = i, this._mapLeaf && this._mapLeaf.setView(g.convert900913to4326(e), t, {
                animate: !1
            }), this.conf.setLonLat90013(e), null != t && this.conf.set("zoom", t)
        }, x.onZoomIn = function() {
            this._mapLeaf && this._mapLeaf.zoomIn()
        }, x.onZoomOut = function() {
            this._mapLeaf && this._mapLeaf.zoomOut()
        }, x.initNavigation = function() {
            this._zoomInCallback = o.bind(this.onZoomIn, this), a(".nav_zoomIn").on("click", this._zoomInCallback), this._zoomOutCallback = o.bind(this.onZoomOut, this), a(".nav_zoomOut").on("click", this._zoomOutCallback)
        }, x.resetNavigation = function() {
            this._zoomInCallback && a(".nav_zoomIn").off("click", this._zoomInCallback), this._zoomOutCallback && a(".nav_zoomOut").off("click", this._zoomOutCallback)
        }, x.sendPrePostRender = function() {
            this.oldTime = this.currentTime, this.currentTime = Date.now();
            var e = this.currentTime - this.oldTime,
                t = {
                    dt: e
                };
            this.sendPreRender(t), this.overEvent && (this.computeHover(this.overEvent), this.overEvent = null), this.sendPostRender(t)
        }, x.setKeyboardShortcuts = function(e) {
            this._mapLeaf && (e ? this._mapLeaf.keyboard.enable() : this._mapLeaf.keyboard.disable())
        }, x.addHeatmapLayer = function(e, t) {
            var i = new v(this, e, t);
            return o.contains(this._heatMapLayers, i) || this._heatMapLayers.push(i), i
        }, x.removeHeatmapLayer = function(e) {
            if (null != e && o.contains(this._heatMapLayers, e)) {
                var t = this._heatMapLayers.indexOf(e);
                t > -1 && this._heatMapLayers.splice(t, 1)
            }
        }, x.createPopup = function(e) {
            e.popup2d = leafletF4.popup(), e.popup2d.setLatLng(g.convert900913to4326({
                lon: e.position.x,
                lat: e.position.y
            })), e.popup2d.backgroundColor = "transparent", a(e.popup2d.getContent()).addClass("popup2d").children().css("display", "none").end(), this._mapLeaf && this._mapLeaf.addLayer(e.popup2d)
        }, x.getRenderStats = function() {
            return null
        }, x.getMemoryStats = function() {
            return null
        }, x.setUrlTemplate2d = function(e) {
            this._mapLeaf && (this.tileLayer && this._mapLeaf.removeLayer(this.tileLayer), this.tileLayer = leafletF4.tileLayer(e, {
                noWrap: !0,
                continuousWorld: !0,
                subdomains: [],
                maxZoom: this.zoomMax,
                minZoom: this.zoomMin
            }), this.tileLayer.addTo(this._mapLeaf))
        }, x.setUrlTemplate3d = function() {}, x.removeColorFilter = function() {}, x.setColorFilter = function() {}, x.setColorsMapping = function() {
            console.warn("setColorsMapping not supported with leaflet")
        }, x.isWebGL = function() {
            return !1
        }, x.updateMinDtWork = function() {}, x.canUseDevicePixelRatio = function() {
            return !1
        }, x.renderNextFrame = function() {}, x.getNodeSize = function() {
            var e = a(this.$parentNode[0]);
            return e.length ? {
                w: e[0].clientWidth,
                h: e[0].clientHeight
            } : null
        }, x.setUseDevicePixelRatio = function() {}, x.setMapTypeId = function() {}, x.getDefaultMapTypeIdAtZoom = function() {
            return y.ROADMAP
        }
    }, {
        "./MapRenderer": 219,
        "./ServerConfig": 221,
        "./api/MapTypeId": 239,
        "./graphic/area/AreaLeaf": 313,
        "./graphic/camera/CameraHelper": 330,
        "./graphic/heatmap/HeatmapLayerLeafRenderer": 343,
        "./graphic/pins/MarkerLeafRenderer": 345,
        "./graphic/pins/PinsManager": 349,
        "./graphic/text/TextManager": 361,
        "./utils/LocationHelper": 407,
        engine: 10,
        jquery: 111,
        "leaflet.heat": 146,
        underscore: 207,
        util: 212
    }],
    219: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = this;
            l.call(this), this.setMaxListeners(0), i._renderer = this, this.conf = e, this.map = i, this.$parentNode = a(t), this.$parentNode.addClass("f4map"), this.$parentNode.addClass("draggableTouch"), this.$parentNode.attr("tabIndex", "0"), this.$parentNode.on("focus", function() {
                return n._isFocus = !0
            }), this.$parentNode.on("blur", function() {
                return n._isFocus = !1
            }), this.minDT = this.conf.get("minDT") || 0, this._maxZIndex = 16, this._wasDragging = !1, this._startWorking = Date.now(), this._startWorkingLastRender = 0, this._customPickingHandlers = [], this.width = Math.max(this.$parentNode.width(), 1), this.height = Math.max(this.$parentNode.height(), 1), this._interactiveMapOverlays = !0, this.generalSpinner = new g(this, this.$parentNode), this.areaEventManager = new y(this.map), this._featuresRequestManager = new v({
                mapRenderer: this,
                canProcessAllRequests: function() {
                    return !n.isMoving()
                }
            }), this._onFeaturesLoadingTerminatedHandler = o.bind(this.onFeaturesLoadingTerminated, this), this._onFeaturesLoadingStartedHandler = o.bind(this.onFeaturesLoadingStarted, this), this._featuresRequestManager.on("workended", this._onFeaturesLoadingTerminatedHandler), this._featuresRequestManager.on("workstarted", this._onFeaturesLoadingStartedHandler), _.init(this), this.initAjaxMonitoring(), this.conf.getMinZoomLayer2D = o.bind(this.getMinZoomLayer2D, this), this._mustUpdateHRefHandler = o.bind(this.mustUpdateHRef, this), this._onComputeEventHandler = o.bind(this.onComputeEvent, this), this._onPreRenderHandler = o.bind(this.onPreRender, this), this.conf.on("change", this._mustUpdateHRefHandler), this.on("compute", this._onComputeEventHandler), this.on("preRender", this._onPreRenderHandler), this._onMouseOutHandler = o.bind(this.onMouseOut, this), this._onMouseOverHandler = o.bind(this.onMouseOver, this), this.dispatchDragStartCallback = o.bind(this.dispatchDragStart, this), this.dispatchMouseHoverEventsCallback = o.bind(this.dispatchMouseHoverEvents, this), this.map.on("mouseout", this._onMouseOutHandler), this.map.on("mouseover", this._onMouseOverHandler), h.load(function(e, i) {
                e ? console.error("Could not get config", e) : x.checkAllowedApiUsage(i, t)
            }), this._touchDragDialog = new w(i), this.initTranslation(), this.on("cameraChanged", o.throttle(o.bind(this.updateMapBounds, this), 1e3 / 60))
        }

        function r() {
            throw new Error("abstract function")
        }
        var o = e("underscore"),
            a = e("jquery");
        e("./common_dependencies");
        var s = e("util"),
            l = e("events").EventEmitter,
            h = e("./ServerConfig"),
            u = e("./utils/LocationHelper"),
            d = e("engine"),
            c = d.Vector2,
            f = e("./api/LatLngBounds"),
            p = e("./api/LatLng"),
            m = e("./interface/MapOptionsView"),
            g = e("./interface/GeneralSpinner"),
            _ = e("./utils/moment"),
            v = e("./FeaturesRequestManager"),
            y = e("./graphic/area/AreaEventManager"),
            b = e("./translation"),
            x = e("./api/internal/ApiKeyCheck"),
            w = e("./interface/TouchDragDialog"),
            M = a(document);
        t.exports = n, s.inherits(n, l);
        var T = n.prototype;
        T.getNodeSize = r, T.isIn3d = r, T.canSwitchBetween3dAnd2d = r, T.newArea = r, T.getHeading = r, T.getTilt = r, T.setTilt = r, T.setHeading = r, T.setZoom = r, T.computePicked = r, T.set3d = r, T.setKeyboardShortcuts = r, T.createPopup = r, T.createMarkerRenderer = r, T.getPinsManager = r, T.setUrlTemplate2d = r, T.setUrlTemplate3d = r, T.removeColorFilter = r, T.setColorFilter = r, T.setColorsMapping = r, T.isWebGL = r, T.canUseDevicePixelRatio = r, T.manageMapReady = function() {
            var e = this;
            o.defer(function() {
                e.map && e.map._renderer && (e.map.emit("mapReady"), e.map.emit("tilesloaded"))
            })
        }, T.resize = function(e, t) {
            var i = this.getNodeSize();
            (i.w != this.width || i.h != this.height || t) && (this.width = i.w, this.height = i.h, this.setSize(i, e))
        }, T.initTranslation = function() {
            var e = this,
                t = this.generalSpinner;
            t.initializeInterface();
            var i = this.conf,
                n = this.$parentNode;
            this._mapOptionsView = new m(this, n), i.mapTypeControlOptions && this._mapOptionsView.setMapTypeControlOptions(i.mapTypeControlOptions), b.init(this.conf, function(i) {
                i || a(function() {
                    e.map && (t.initializeInterface(), e._mapOptionsView.init(), e._touchDragDialog && e._touchDragDialog.setTranslation(b.t))
                })
            })
        }, T.initAjaxMonitoring = function() {
            var e = this;
            M.ajaxStart(function() {
                e._loading = e.startLoading("ajax")
            }), M.ajaxStop(function() {
                e._loading ? e._loading.done() : console.warn("$.ajax called too early - call won't be monitored")
            })
        }, T.canWorkProcessorWorkMore = function(e) {
            var t = this._lastWorking,
                i = Date.now();
            this._startWorkingLastRender != t && (this._startWorking = i, this._startWorkingLastRender = t);
            var n = this.isMoving(),
                r = this.conf.workProcessor.overallMinDuration,
                o = this.conf.workProcessor.overallMaxDuration;
            !e._isInteracting && n && (r = this.conf.workProcessor.overallMinDurationMoving, o = this.conf.workProcessor.overallMaxDurationMoving);
            var a = i - this._startWorking,
                s = i - this._lastWorking;
            return null !== r && r > a ? !0 : s > this.minDT ? o > s : !0
        }, T.startLoading = function() {
            var e = this.generalSpinner;
            e.incLoading();
            var t = !0;
            return {
                done: function() {
                    t && (t = !1, e.decLoading())
                }
            }
        }, T.onComputeEvent = function(e) {
            this._lastWorking = e.time
        }, T.onPreRender = function() {
            this.delayedUpdateHRef()
        }, T.delayedUpdateHRef = function() {
            this.mustUpdateHRef && !this.isMoving() && (this.mustUpdateHRef = !1, this.conf.updateHref())
        }, T.mustUpdateHRef = function() {
            this.mustUpdateHRef = !0
        }, T.getCenter4326 = function() {
            return u.convert900913to4326(this.getCenter())
        }, T.zoomOnPoint = function(e) {
            var t = 100,
                i = {
                    left: e.lon - t,
                    right: e.lon + t,
                    top: e.lat + t,
                    bottom: e.lat - t
                };
            this.fitBounds(i)
        }, T.setMaxZoom = function(e) {
            this.conf.set("camera.zoomMax", e), this.conf.set("camera.2d.zoomMax", e)
        }, T.onFeaturesLoadingStarted = function() {
            this.map.handleOnFeaturesLoadingStarted()
        }, T.onFeaturesLoadingTerminated = function() {
            this.map.handleOnFeaturesLoadingTerminated()
        }, T.addLonLatToMouseEvent = function(e) {
            if (!e.lonLat) {
                e.xyInMapCanvas = this.clientXYToRelativeMapPosition(e.clientX, e.clientY);
                var t = this.computeLocationFromPixel(e.xyInMapCanvas);
                e.lonLat = u.convertLonLatOrXYToLonLat(t)
            }
        }, T.toggleInteractiveMapOverlays = function(e) {
            this._interactiveMapOverlays = e
        }, T.getCurrentHoveredOverlay = function() {
            return this._hoveredOverlay
        }, T.disableHover = function(e) {
            this.isHoverDisabled = e, e && this._hoveredOverlay && this.askForHover()
        }, T.addCustomPickingHandler = function(e) {
            this._customPickingHandlers.push(e)
        }, T.removeCustomPickingHandler = function(e) {
            var t = this._customPickingHandlers.indexOf(e);
            t > -1 && this._customPickingHandlers.splice(t, 1)
        }, T._findPicked = function(e, t, i) {
            for (var n = i.allowBuildingPicking, r = i.clickable, o = i.draggable, a = null, s = 0; s < this._customPickingHandlers.length && null == a; s++) a = this._customPickingHandlers[s](e);
            var l = null != a,
                h = a ? a.zIndex : -1e3,
                u = [];
            if (this._interactiveMapOverlays && (u = this.getPinsManager().getPinsPointed(e.xyInMapCanvas, {
                    clickable: r,
                    draggable: o
                })), u.length && (l = l && u[0].zIndex < h), l) return a.handlePicking(e);
            var d = "touchstart" == e.type || "touchend" == e.type || "touchmove" == e.type;
            if (this.mouseOffMap && !d) {
                var c = {
                    picked: null
                };
                return void t(c, e)
            }
            var f = u[0] && u[0].pin;
            if (f && (f.clickable || f.draggable)) {
                var p = {
                    picked: f,
                    type: "pins",
                    clickable: f.clickable,
                    draggable: f.draggable
                };
                return t(p, e)
            }
            return this.computePicked(e, t, n)
        }, T.onMouseMove = function(e) {
            this.lastMouseEvent = e, this.askForHover(e), this._sendMouseMapEvent("mousemove", e)
        }, T.askForHover = function(e) {
            null == e && (e = this.lastMouseEvent, delete this.lastMouseEvent), e && (this.overEvent = e)
        }, T.computeHover = function(e) {
            this.isHoverDisabled || (e = e || this.overEvent, e && (this.addLonLatToMouseEvent(e), this.isMoving() || this._findPicked(e, this.dispatchMouseHoverEventsCallback, {
                draggable: !0,
                clickable: !0
            })))
        }, T.dispatchMouseHoverEvents = function(e, t) {
            var i = this._hoveredOverlay == e.picked || this._hoveredOverlay && e.picked && this._hoveredOverlay == e.picked;
            if (!i) {
                var n = null,
                    r = null;
                this._hoveredOverlay && e.picked != this._hoveredOverlay && (n = this._hoveredOverlay), this._hoveredOverlay = e.picked, e.picked && (r = this._hoveredOverlay), n && (n.onMouseOut && n.onMouseOut(t), n.overlay && n.overlay.emit("mouseout", t)), r && (r.onMouseOver && r.onMouseOver(t), r.overlay && r.overlay.emit("mouseover", t))
            }
        }, T._dispatchMouseEventOnPickedElement = function(e, t) {
            var i = this;
            if (!this.mapPickingDisabled) {
                var n, r;
                ! function() {
                    i.addLonLatToMouseEvent(t), n = o.any(i.map._layersByType.buildings, function(e) {
                        return e.pickingEnabled
                    });
                    var a = o.bind(i._emitMouseEventOnPickedElement, i, e);
                    i.conf.enableWebGL ? i._findPicked(t, a, {
                        allowBuildingPicking: n,
                        clickable: !0
                    }) : (r = i, o.defer(function() {
                        r._findPicked(t, a, {
                            allowBuildingPicking: n,
                            clickable: !0
                        })
                    }))
                }()
            }
            this.hasDragged && this._onDragStop(t)
        }, T._onClick = function(e) {
            this._dispatchMouseEventOnPickedElement("click", e)
        }, T._onRightClick = function(e) {
            this._dispatchMouseEventOnPickedElement("rightclick", e)
        }, T._onDblClick = function(e) {
            this._dispatchMouseEventOnPickedElement("dblclick", e)
        }, T._onMouseDown = function(e) {
            this._dispatchMouseEventOnPickedElement("mousedown", e)
        }, T._onMouseUp = function(e) {
            this._dispatchMouseEventOnPickedElement("mouseup", e)
        }, T._emitMouseEventOnPickedElement = function(e, t, i) {
            t && t.picked && t.clickable && t.picked.emit ? (i.latLng = u.convert900913toGoogleLatLng(i.lonLat), t.picked.emit(e, i), t.picked.overlay && t.picked.overlay.emit(e, i)) : i.featurePicked && "click" == e ? (this._sendMouseMapEvent(e, i), this.emit("featurePicked", i)) : this._sendMouseMapEvent(e, i)
        }, T._onDragStart = function(e) {
            return this.addLonLatToMouseEvent(e), this._findPicked(e, this.dispatchDragStartCallback, {
                draggable: !0
            })
        }, T.dispatchDragStart = function(e, t) {
            var i = e.picked;
            return i && i.draggable && i.visible ? (this.hasDragged = !0, this.setDraggable(!1), this.emit("dragstart", t, i), !0) : !1
        }, T._onDrag = function(e) {
            this._wasDragging || (this._sendMouseMapEvent("dragstart", e), this._wasDragging = !0), this.addLonLatToMouseEvent(e), this.emit("drag", e), this._sendMouseMapEvent("drag", e)
        }, T._onTouchDragForcedStart = function() {
            this._touchDragDialog && this.map.getTouchDragDialogEnabled() && this._touchDragDialog.show()
        }, T._onTouchDragForcedStop = function() {
            this._touchDragDialog && this._touchDragDialog.hide()
        }, T._onDragStop = function(e) {
            this._wasDragging = !1, null == e && (e = this.lastMouseEvent), this.addLonLatToMouseEvent(e), this.setDraggable(!0), this.emit("dragend", e), this._sendMouseMapEvent("dragend", e)
        }, T.updateMapBounds = function() {
            if (this.map) {
                var e = this._bounds,
                    t = this._computeMapBounds();
                this.disableApiEvent = !0, this.map.setHeading(this.getHeading()), this.map.setTilt(this.getTilt()), this.map.setZoom(Math.round(this.getZoom()));
                var i = this.getCenter4326(),
                    n = new p(i.lat, i.lon);
                this.map.setCenter(n), this.disableApiEvent = !1, null == t || t.equals(e) || (this._bounds = t, this.map.emit("bounds_changed"))
            }
        }, T._computeMapBounds = function() {
            var e = this.getFrustumFull();
            if (e) {
                var t = u.convert900913toGoogleLatLng({
                        lat: e.yMax,
                        lon: e.xMax
                    }),
                    i = u.convert900913toGoogleLatLng({
                        lat: e.yMin,
                        lon: e.xMin
                    });
                return new f(i, t)
            }
            return null
        }, T.getMapBounds = function() {
            return this._bounds
        }, T._sendMouseMapEvent = function(e, t) {
            this.addLonLatToMouseEvent(t), t.latLng = u.convert900913toGoogleLatLng(t.lonLat), this.map.emit(e, t)
        }, T.setCenterFromApi = function(e, t) {
            this.onInitCameraFromApi(), this.setCenter(u.convertGoogleLatLngTo900913(e), this.getZoom(), null), t || this.onCameraChangedFromApi()
        }, T.makeIdleEvent = function(e) {
            return {
                isHuman: e
            }
        }, T.set3dFromApi = function(e, t) {
            this.onInitCameraFromApi(), this.set3d(e, null), t || this.onCameraChangedFromApi()
        }, T.setZoomFromApi = function(e, t) {
            this.onInitCameraFromApi(), this.setZoom(e, null), t || this.onCameraChangedFromApi()
        }, T.setHeadingFromApi = function(e, t) {
            this.onInitCameraFromApi(), this.setHeading(e, null), t || this.onCameraChangedFromApi()
        }, T.setTiltFromApi = function(e, t) {
            this.onInitCameraFromApi(), this.setTilt(e, null), t || this.onCameraChangedFromApi()
        }, T.fitBoundsFromApi = function(e, t) {
            this.onInitCameraFromApi();
            var i = u.convertGoogleLatLngTo900913(e.sw),
                n = u.convertGoogleLatLngTo900913(e.ne);
            this.fitBounds({
                left: i.lon,
                right: n.lon,
                bottom: i.lat,
                top: n.lat
            }, null), this.onCameraChangedFromApi(t)
        }, T.panToBoundsFromApi = function(e) {
            this.onInitCameraFromApi();
            var t = u.convertGoogleLatLngTo900913(e.sw),
                i = u.convertGoogleLatLngTo900913(e.ne);
            this.panToBounds({
                left: t.lon,
                right: i.lon,
                bottom: t.lat,
                top: i.lat
            }, this.makeIdleEvent(!1))
        }, T.panToFromApi = function(e, t, i) {
            this.onInitCameraFromApi();
            var n = null;
            i || (n = this.makeIdleEvent()), this.panTo(u.convertGoogleLatLngTo900913(e), t, n), i || this.onCameraChangedFromApi()
        }, T.setCenter = function(e, t, i) {
            this.teleport(e, !1, null, i)
        }, T.panTo = function(e, t, i) {
            this.teleport(e, !0, t, i)
        }, T.clientXYToRelativeMapPosition = function(e, t) {
            var i = a(window),
                n = this.$parentNode.offset(),
                r = this.$parentNode.css("padding-left");
            r = parseInt(r, 10);
            var o = this.$parentNode.css("padding-top");
            return o = parseInt(o, 10), new c(e - n.left + i.scrollLeft() - r, t - n.top + i.scrollTop() - o)
        }, T.isElevationEnabled = function() {
            return this.map.elevation
        }, T.getMinZoomIn3DWithElevation = function() {
            return this.conf.elevations.zoom
        }, T.getMinZoomIn3DWithoutElevation = function() {
            return this.map.minZoomLayer2D + 1
        }, T.canSwitchTo3DWithElevationAtZoom = function(e) {
            return e >= this.getMinZoomIn3DWithElevation()
        }, T.canSwitchTo3DWithoutElevationAtZoom = function(e) {
            return e >= this.getMinZoomIn3DWithoutElevation()
        }, T.getMinZoomIn3D = function() {
            return this.map.elevation ? this.getMinZoomIn3DWithElevation() : this.getMinZoomIn3DWithoutElevation()
        }, T.getMinZoomLayer2D = function() {
            return this.getMinZoomIn3D() - 1
        }, T.isDragging = function() {
            return this._wasDragging || this._mouseManager && this._mouseManager.isDragging()
        }, T.isFocus = function() {
            return this._isFocus
        }, T.onMouseOut = function(e) {
            this.mouseOffMap = !0, this.lastMouseEvent = e, this.askForHover(e), this.computeHover(e)
        }, T.onMouseOver = function(e) {
            this.mouseOffMap = !1, this.lastMouseEvent = e, this.askForHover(e)
        }, T.onDivRemoved = function() {
            M.off("ajaxStart"), M.off("ajaxStop"), this.conf.removeListener("change", this._mustUpdateHRefHandler), this.removeListener("compute", this._onComputeEventHandler), this.removeListener("preRender", this._onPreRenderHandler), this._touchDragDialog && this._touchDragDialog.hide(), b.onDivRemoved(), this._mapOptionsView && this._mapOptionsView.clear(), this.generalSpinner.clearInterface(), delete this._mustUpdateHRefHandler, delete this._onComputeEventHandler, delete this._onPreRenderHandler, delete this._mapOptionsView, delete this.generalSpinner, this._featuresRequestManager && (this._featuresRequestManager.removeListener("workended", this._onFeaturesLoadingTerminatedHandler), this._featuresRequestManager.removeListener("workstarted", this._onFeaturesLoadingStartedHandler), delete this._featuresRequestManager)
        }
    }, {
        "./FeaturesRequestManager": 216,
        "./ServerConfig": 221,
        "./api/LatLng": 233,
        "./api/LatLngBounds": 234,
        "./api/internal/ApiKeyCheck": 261,
        "./common_dependencies": 308,
        "./graphic/area/AreaEventManager": 312,
        "./interface/GeneralSpinner": 390,
        "./interface/MapOptionsView": 392,
        "./interface/TouchDragDialog": 394,
        "./translation": 396,
        "./utils/LocationHelper": 407,
        "./utils/moment": 420,
        engine: 10,
        events: 99,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    220: [function(e, t, i) {
        "use strict";

        function n(t, i, n, a) {
            this._maxZIndex = 1, this.conf = t, this.map = a;
            var f = document.createElement("canvas");
            f.width = o(n).width(), f.height = o(n).height(), o(n).append(f), t.shadow && (D.isMobile() || D.isTablet()) && (t.shadow.useCsm = !1), l.call(this, t, n, a);
            var m = {
                canvas: f,
                webGlContextAttributes: r.defaults({}, i.webGlContextAttributes || {}, e("./utils/WebGlContextAttributes")),
                debugEnabled: t.get("debug.enableWebGLDebug"),
                webGLMinShaderVersion: t.get("webGLMinShaderVersion"),
                minDT: t.get("minDT"),
                forceDT: t.get("forceDT"),
                requiredPointSpriteSize: 512,
                useDevicePixelRatio: i.useDevicePixelRatio,
                supportNegativeViewportOffset: !D.isMSIE(),
                serverConfig: F,
                textureUnloadPeriod: t.get("textureUnloadPeriod"),
                preZ: i.elevation,
                shadow: i.shadow,
                ssao: i.ssao,
                waterRipple: i.waterRipple,
                waterReflection: i.waterReflection,
                initShaders: C,
                getShadowMapBoundsCallback: r.bind(this.getShadowMapBounds, this),
                depthMap: i.depthMap,
                sideBySide: i.sideBySide,
                topToBottom: i.topToBottom
            };
            W && (m.webGlContextAttributes.preserveDrawingBuffer = !1, m.webGlContextAttributes.antialias = !1), this._renderEngine = new y(this.conf, m), this._renderEngine.canUseStencil() || t.setDefaultAndCurrentValue("environment.waterReflectionRate", 0), this.graphicBounds = null, this._cameraChanged = !1;
            var _ = this.getScene();
            _.tilesParent = new b, _.add(_.tilesParent), _.buildingsParent = new b, _.add(_.buildingsParent), _.linesAndAreaParent = new b, _.add(_.linesAndAreaParent), _.detailsParent = new b, _.add(_.detailsParent), _.marker3dParent = new b, _.add(_.marker3dParent), this._enabledChangedHandler = r.bind(this.enabledChanged, this), this._shadowChangedHandler = r.bind(this.shadowChanged, this), this._hideShadowsChangedHandler = r.bind(this.hideShadowsChanged, this), this._csmShadowChangedHandler = r.bind(this.shadowOptionsChanged, this, "useCsm"), this._pcfShadowOptionsChangedHandler = r.bind(this.shadowOptionsChanged, this, "usePcf"), this._lerpShadowOptionsChangedHandler = r.bind(this.shadowOptionsChanged, this, "useLerp"), this._ssaoChangedHandler = r.bind(this.ssaoChanged, this), this._waterReflectionChangedHandler = r.bind(this.waterReflectionChanged, this), this._renderEnabledHandler = r.bind(this._renderEnabledChanged, this), this._depthMapChangedHandler = r.bind(this._depthMapChanged, this), this._sideBySideChangedHandler = r.bind(this._sideBySideChanged, this), this._topToBottomChangedHandler = r.bind(this._topToBottomChanged, this), this.map.on("sidebyside_changed", this._sideBySideChangedHandler), this.map.on("toptobottom_changed", this._topToBottomChangedHandler), this.map.on("depthmap_changed", this._depthMapChangedHandler), this.map.on("renderenabled_changed", this._renderEnabledHandler), this.map.on("enabled_changed", this._enabledChangedHandler), this.map.on("enabled_changed", this._enabledChangedHandler), this.map.on("shadow_changed", this._shadowChangedHandler), this.map.on("hideshadows_changed", this._hideShadowsChangedHandler), this.map.on("usecsm_changed", this._csmShadowChangedHandler), this.map.on("usepcf_changed", this._pcfShadowOptionsChangedHandler), this.map.on("uselerp_changed", this._lerpShadowOptionsChangedHandler), this.map.on("ssao_changed", this._ssaoChangedHandler), this.map.on("waterreflection_changed", this._waterReflectionChangedHandler), this._env = new P(this), this._colorFilterManager = new A(this), this._mouseManager = new k(this), this._keyboardManager = new L(this), this._cameraManager = new u(this, this.width, this.height), this.conf.get("disableTextManager") || (this.textManager = new c(this, this.$parentNode)), this._tileManager = new d(this), this._dataLayerManager = new g(this), this._pinsManager = new h(this), this.enableWorkers(), this._modelCache = new O, this._modelCache.init(this, this.conf.get("useWebWorkers")), this._keyboardManager.bindEvents(), this._mouseManager.bindEvents(), p.initAreasMaterial(this), this._renderEngine.setCamera(this._cameraManager.camera), this.setSize(this.getNodeSize(), this.makeIdleEvent(!1)), this.setTimeRatio(), this.initMapDate(i.time || t.time), this.updateMinDtWork(), this.initializeDynamicLight(), i.enableWebGLBenchmarkTest && (this._webglBenchmarkScore = null, this._webGLBenchTester = new N(this._renderEngine._webGL), this._webGLBenchTester.test(r.bind(function(e, t) {
                    e || this.setWebGLBenchmarkScore(t.benchmarkScore), this._webGLBenchTester = null
                }, this))), this.isIn3d() ? this._tileManager.enter3d() : this._tileManager.enter2d(),
                this.elevationChanged(!0), this._eventPack = new s, this._onDragStartHandler = r.bind(this._onDragStart, this), this._onDragHandler = r.bind(this._onDrag, this), this._onTouchDragForcedStartHandler = r.bind(this._onTouchDragForcedStart, this), this._onTouchDragForcedStopHandler = r.bind(this._onTouchDragForcedStop, this), this._onDragStopHandler = r.bind(this._onDragStop, this), this._onClickHandler = r.bind(this._onClick, this), this._onRightClickHandler = r.bind(this._onRightClick, this), this._onMouseMoveHandler = r.bind(this.onMouseMove, this), this._onMouseOverHandler = r.bind(this._sendMouseMapEvent, this, "mouseover"), this._onMouseOutHandler = r.bind(this._sendMouseMapEvent, this, "mouseout"), this._mouseManager.on("leftDown", this._onDragStartHandler), this._mouseManager.on("leftDrag", this._onDragHandler), this._mouseManager.on("touchDragForcedStart", this._onTouchDragForcedStartHandler), this._mouseManager.on("touchDragForcedStop", this._onTouchDragForcedStopHandler), this._mouseManager.on("dragStop", this._onDragStopHandler), this._mouseManager.on("click", this._onClickHandler), this._mouseManager.on("rightclick", this._onRightClickHandler), this._mouseManager.on("mousemove", this._onMouseMoveHandler), this._mouseManager.on("mouseover", this._onMouseOverHandler), this._mouseManager.on("mouseout", this._onMouseOutHandler), this._eventPack.on(this._mouseManager, "mousedown", r.bind(this._onMouseDown, this)), this._eventPack.on(this._mouseManager, "mouseup", r.bind(this._onMouseUp, this)), this._onComputeHandler = r.bind(this.onCompute, this), this._sendPreRenderHandler = r.bind(this.sendPreRender, this), this._sendPostRenderHandler = r.bind(this.sendPostRender, this), this._renderEngine.on("compute", this._onComputeHandler), this._renderEngine.on("preRender", this._sendPreRenderHandler), this._renderEngine.on("postRender", this._sendPostRenderHandler), this.manageMapReady(), this.setEnabled(this.map.enabled), this._startListenForMapVisibility()
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("util"),
            s = e("./utils/EventPack"),
            l = e("./MapRenderer"),
            h = e("./graphic/pins/PinsManager"),
            u = e("./graphic/camera/CameraManager"),
            d = e("./graphic/tilemesh/TileMeshManager"),
            c = e("./graphic/text/TextManager"),
            f = e("./utils/LocationHelper"),
            p = e("./graphic/area/AreaWebGL"),
            m = e("./graphic/heatmap/HeatmapLayerWebGLRenderer"),
            g = e("./graphic/heatmap/DataLayerManager"),
            _ = e("suncalc"),
            v = e("engine"),
            y = v.RenderEngine,
            b = v.Object3D,
            x = v.Vector3,
            w = v.ShapeUtils,
            M = v.Geometry,
            T = v.Color,
            S = v.Constants,
            C = e("./graphic/shader/MapEffects"),
            E = e("./graphic/pins/MarkerWebGLRenderer"),
            k = e("./input/MouseManager"),
            L = e("./input/KeyboardManager"),
            P = e("./graphic/environment/Environment"),
            A = e("./graphic/environment/ColorFilterManager"),
            R = e("./graphic/camera/CameraHelper"),
            D = e("browser-detect"),
            I = e("./utils/worker/WorkerManager"),
            O = e("./utils/ModelCache"),
            N = e("./utils/WebGLBenchTester"),
            B = e("./graphic/area/AreaWorkerManager"),
            F = e("./ServerConfig"),
            z = e("./api/MapTypeId"),
            H = D.getIOSVersion(),
            U = D.isIOS(),
            W = U && H && H.major && +H.major >= 10,
            G = D.isEdge();
        t.exports = n, a.inherits(n, l);
        var j = n.prototype;
        j._startListenForMapVisibility = function() {
            if (this.map) {
                var e = r.bind(this._updateVisibility, this),
                    t = this.map.getDiv(),
                    i = window.MutationObserver || window.WebKitMutationObserver;
                null !== i && (this._observerVisibility = new i(e), this._observerVisibility.observe(t, {
                    attributes: !0,
                    childList: !1,
                    characterData: !1
                })), this._eventPack.on(o(t).parents(), "scroll", e), this._eventPack.on(o(window), {
                    scroll: e,
                    visibilitychange: e
                }), this._updateVisibility()
            }
        }, j._stopListenForMapVisibility = function() {
            this._observerVisibility && this._observerVisibility.disconnect()
        }, j._updateVisibility = function() {
            if (this.map) {
                var e = o(this.map.getDiv());
                this.map.setEnabled(e.visible(!0) && e.is(":visible") && "visible" == document.visibilityState)
            }
        }, j.setEnabled = function(e) {
            this._enabled != e && (this._enabled = e, e ? (this._renderEngine.resetDT(), this._renderEngine.startRenderLoop(e)) : this._renderEngine.stopRenderLoop(e))
        }, j.getTileManager = function() {
            return this._tileManager
        }, j.getEngineHelpers = function() {
            return v
        }, j.getRenderEngine = function() {
            return this._renderEngine
        }, j.getScene = function() {
            return this.getRenderEngine().getScene()
        }, j.registerEnvironmentPlugins = function(e) {
            return this._env.registerPlugins(e)
        }, j.unregisterEnvironmentPlugins = function(e) {
            return this._env.unregisterPlugins(e)
        }, j.getWebGLInfo = function() {
            return this.getRenderEngine().getWebGLInfo()
        }, j.getHeading = function() {
            var e = this.getCurrentCameraConfiguration();
            return e.camera.phi
        }, j.getTilt = function() {
            var e = this.getCurrentCameraConfiguration();
            return e.camera.theta
        }, j.getModelCache = function() {
            return this._modelCache
        }, j.setDate = function(e) {
            this._changeDate(e), this.conf.sun = null, this.updateEnvironmentLighting()
        }, j.setTimeRatio = function(e) {
            null != e ? this.changeRatioToRealTime(e) : this.changeRatioToRealTime(this.conf.get("time.ratioToRealtime"))
        }, j._changeDate = function(e) {
            this._prevMapDateUpdate = Date.now();
            var t = e || Date.now();
            this._prevMapDate = t, this._overridenDate = e
        }, j.setSunPosition = function(e) {
            this.setTimeRatio(0), this.conf.sun = e
        }, j.initMapDate = function(e) {
            var t;
            if (e && e.initialDate) {
                var i = Date.parse(e.initialDate);
                isNaN(i) ? console.warn("Could not parse initial date %s, see https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse", this.conf.get("time.initialDate")) : t = i, this.conf.sun = null
            }
            this._changeDate(t)
        }, j.getMapDate = function() {
            var e = Date.now(),
                t = e;
            if (1 != this.ratioToRealtime || this._overridenDate || this.conf.get("time.initialDate")) {
                var i = t - this._prevMapDateUpdate;
                t = new Date(new Date(this._prevMapDate).valueOf() + i * this.ratioToRealtime)
            }
            return this._prevMapDateUpdate = e, this._prevMapDate = t, new Date(t)
        }, j.isDragging = function() {
            return this._mouseManager && this._mouseManager.isDragging()
        }, j.changeRatioToRealTime = function(e) {
            this.ratioToRealtime = e, this.initializeDynamicLight()
        }, j.initializeDynamicLight = function() {
            var e = 3e4 / this.ratioToRealtime;
            e = Math.max(50, e), this.clearDynamicLight(), this._lightIntervalId = window.setInterval(r.bind(this.updateEnvironmentLighting, this), e)
        }, j.clearDynamicLight = function() {
            null != this._lightIntervalId && (window.clearInterval(this._lightIntervalId), delete this._lightIntervalId)
        }, j.onCompute = function(e) {
            this.emit("compute", e), this._keyboardManager.compute(e.dt), this.overEvent && !this.isMoving() && (this.computeHover(this.overEvent), this.overEvent = null)
        }, j.isIn3d = function() {
            return this.conf["3d"] && this.canSwitchBetween3dAnd2d()
        }, j.canSwitchBetween3dAnd2d = function() {
            var e = this.getMinZoomLayer2D();
            return this.conf.zoom > e
        }, j.setMinZoomLayer2dFromApi = function() {
            this._cameraManager.limits.rebuildLimits();
            var e = this.getMinZoomLayer2D();
            this.getZoom() > e && this.conf.get("3d") ? this.show3dWebGLMap() : this.show2dWebGLMap({}), this._cameraManager.update2dTo3d(this.makeIdleEvent(!0))
        }, j.setElevationFromApi = function(e, t) {
            this.elevationChanged(t)
        }, j.onInitCameraFromApi = function() {
            this._cameraManager.stopAnimation()
        }, j.onSetOptionsFromApi = function() {
            var e = this.conf["3d"] && this.conf.get("zoom") > this.getMinZoomLayer2D();
            e ? this.enter3dMode(!0) : this.enter2dMode(!0)
        }, j.onCameraChangedFromApi = function(e) {
            this._cameraManager.updateConfig(this._cameraManager.getCurrentCameraConfiguration()), this.updateMapBounds(), this._cameraManager.sendStabilized(this.makeIdleEvent(e))
        }, j.setUseDevicePixelRatio = function() {
            var e = this.map.getUseDevicePixelRatio() && !W;
            this._renderEngine.setUseDevicePixelRatio(e)
        }, j.update2dTo3d = function() {
            this._cameraManager.update2dTo3d(this.makeIdleEvent(!1), !0)
        }, j.onComputeEvent = function(e) {
            this._pinsManager.onCompute(e), l.prototype.onComputeEvent.apply(this, arguments)
        }, j.preRender = function(e) {
            this._cameraChanged && (this._cameraChanged = !1, this.sendCameraChanged());
            var t = this.isIn3d(),
                i = this.map.getUseDevicePixelRatio() && !U && (!this.isIn3d() || !this.isMoving());
            this._renderEngine.getUseDevicePixelRatio() != i && (this.map.getDepthMap() || this.map.getSideBySide() || this.map.getTopToBottom() || (this._renderEngine.setUseDevicePixelRatio(i), this.map.emit("devicePixelRatioOnMove_changed"))), this._renderEngine.setShadowEnabled(t && !this.map.hideShadows);
            var n = this.map.ssao && this.map.ssaoWhenMoving || !this.isMoving();
            this._renderEngine.setSSAOutlineEnabled(t && n), this.enableElevationMatrix(), this._pinsManager.onPreRender(e), this.map.elevation && r.each(this.map._layersByType.buildings, function(e) {
                e.updateElevations()
            })
        }, j.postRender = function() {
            this.disableElevationMatrix()
        }, j.enableElevationMatrix = function() {
            var e = this.isElevationMatrixActivated;
            if (this.map.elevation && this.isIn3d() && !this.isElevationMatrixActivated) {
                this.isElevationMatrixActivated = !0;
                var t = this.getCurrentPositionHeight();
                this._cameraManager.updateCameraHeight(), this._cameraManager.setCameraElevations(), Math.abs(this.getCurrentPositionHeight() - t) > .1 && this._cameraManager.cameraUpdated(this.makeIdleEvent(!0)), this._renderEngine.setCamera(this._cameraManager.camera)
            }
            return e
        }, j.disableElevationMatrix = function() {
            this.isElevationMatrixActivated && this.map.elevation && (this.isElevationMatrixActivated = !1, this._cameraManager.unsetCameraElevations(), this._renderEngine.setCamera(this._cameraManager.camera))
        }, j.getCenter = function() {
            var e = this._cameraManager.getTarget();
            return {
                lon: e.x,
                lat: e.y
            }
        }, j.getCenter4326 = function() {
            return f.convert900913to4326(this.getCenter())
        }, j.enter3dMode = function(e) {
            e || (this.conf.setNoEvent("3d", !0), this.map.set3d(!0), this._cameraManager.update2dTo3d(this.makeIdleEvent(!0))), this.show3dWebGLMap(), this.map.setMapTypeId(this.map.elevation ? z.TERRAIN : z.FLAT_TERRAIN)
        }, j.enter2dMode = function(e) {
            e || (this.conf.setNoEvent("3d", !1), this.map.set3d(!1), this._cameraManager.update2dTo3d(this.makeIdleEvent(!0))), this.show2dWebGLMap(), this.map.setMapTypeId(z.ROADMAP)
        }, j.getDefaultMapTypeIdAtZoom = function(e) {
            return this.map.elevation ? this.canSwitchTo3DWithElevationAtZoom(e) ? z.TERRAIN : z.ROADMAP : this.canSwitchTo3DWithoutElevationAtZoom(e) ? z.FLAT_TERRAIN : z.ROADMAP
        }, j.setMapTypeId = function(e, t) {
            switch (e) {
                case z.ROADMAP:
                case z.SATELLITE:
                case z.HYBRID:
                    this.enter2dMode(t);
                    break;
                case z.FLAT_TERRAIN:
                    this.map.setElevation(!1), this.canSwitchTo3DWithoutElevationAtZoom(this.conf.zoom) ? this.enter3dMode(t) : (this.map.setMapTypeId(z.ROADMAP), this.map.set3d(!0));
                    break;
                case z.TERRAIN:
                    this.map.setElevation(!0), this.canSwitchTo3DWithElevationAtZoom(this.conf.zoom) ? this.enter3dMode(t) : (this.map.setMapTypeId(z.ROADMAP), this.map.set3d(!0))
            }
        }, j.updateMinDtWork = function() {
            this._renderEngine._minDTEnabled = Boolean(this.isIn3d() && !this.map.skipWorkIn3d)
        }, j.show3dWebGLMap = function(e) {
            this.updateMinDtWork(), e = e || {}, this.noShading = !1, this.emit("enter3d", e);
            var t = this.map.elevation;
            this.map.shadow && this._renderEngine.enableShadows(), this.map.ssao && this._renderEngine.enableSSAO(t), this.map.waterReflection && !t && this._renderEngine.enableWaterReflection()
        }, j.show2dWebGLMap = function(e) {
            this.updateMinDtWork(), e = e || {}, this.noShading = !0, this.emit("enter2d", e), this._renderEngine.disableShadows(), this._renderEngine.disableSSAO(), this._renderEngine.disableWaterReflection()
        }, j.ssaoChanged = function() {
            this.isIn3d() && this._renderEngine.setSSAO(this.map.ssao)
        }, j.hideShadowsChanged = function() {
            this._renderEngine.clearShadows()
        }, j.shadowChanged = function() {
            this._renderEngine.setShadow(this.map.shadow, !1)
        }, j.enabledChanged = function() {
            this.setEnabled(this.map.enabled)
        }, j.shadowOptionsChanged = function(e) {
            this._renderEngine.setShadowOptions(e, this.map[e], !1), this._tileManager.onRefreshMaterial(), this.map.updateLayers()
        }, j.getElevationShadowsEnabled = function() {
            return this.map.shadow && this.conf.get("shadows.useCsm") && this.conf.get("shadows.csm.elevationShadows")
        }, j.onTileElevationsUpdated = function(e, t) {
            this.emit("tile_elevations_updated", e, t)
        }, j.elevationChanged = function(e) {
            if (this._cameraManager && this._cameraManager.elevationChanged(this.map.elevation), this.waterReflectionChanged(), this._renderEngine.setPreZ(this.map.elevation), this.map.elevation && this.conf.get("shadows.useCsm") && this.conf.get("shadows.csm.elevationShadows") ? (r.extend(this.conf.shadows.csm, this.conf.shadows.csm.elevation), r.extend(this.conf._defaultConfiguration.shadows.csm, this.conf.shadows.csm.elevation)) : (r.extend(this.conf.shadows.csm, this.conf.shadows.csm.planar), r.extend(this.conf._defaultConfiguration.shadows.csm, this.conf.shadows.csm.planar)), !e) {
                var t = this.getMinZoomLayer2D();
                this.conf.get("zoom") <= t ? this.enter2dMode() : this.enter3dMode()
            }
        }, j._depthMapChanged = function() {
            var e = this.map.getDepthMap();
            this._renderEngine.setDepthMap(e), this.map.emit("resize", !0), this._cameraManager.cameraUpdated(this.makeIdleEvent(!0))
        }, j._sideBySideChanged = function() {
            var e = this.map.getSideBySide();
            this._renderEngine.setSideBySide(e), this.map.emit("resize", !0), this._cameraManager.cameraUpdated(this.makeIdleEvent(!0))
        }, j._topToBottomChanged = function() {
            var e = this.map.getTopToBottom();
            this.map.emit("resize"), this._renderEngine.setTopToBottom(e), this._cameraManager.cameraUpdated(this.makeIdleEvent(!0))
        }, j._renderEnabledChanged = function() {
            this._renderEngine.renderEnabled(this.map.getRenderEnabled())
        }, j.renderNextFrame = function(e, t) {
            var i = this;
            this._renderEngine.renderNextFrame(e, function() {
                i._featuresRequestManager.onWorkFinished(t)
            })
        }, j.waterReflectionChanged = function() {
            this.isIn3d() && this.map.waterReflection && !this.map.elevation && this._renderEngine.canUseStencil() ? this._renderEngine.enableWaterReflection() : this._renderEngine.disableWaterReflection()
        }, j.updateEnvironmentLighting = function() {
            if (this.conf.sun) this._env.updateLightFromSunAndMoon({
                azimuth: this.conf.sun.azimuth * Math.PI / 180,
                altitude: this.conf.sun.altitude * Math.PI / 180
            }, null);
            else {
                var e = this.getMapDate(),
                    t = this.getCenter4326(),
                    i = _.getPosition(e, t.lat, t.lon),
                    n = _.getMoonPosition(e, t.lat, t.lon),
                    r = _.getMoonIllumination(e, t.lat, t.lon);
                n.angle = r.angle, n.fraction = r.fraction, n.phase = r.phase, this._env.updateLightFromSunAndMoon(i, n)
            }
            this.emit("lightingChanged")
        }, j.newArea = function(e, t) {
            return new p(e, t)
        }, j.createMarkerRenderer = function() {
            return new E(this)
        }, j.getPinsManager = function() {
            return this._pinsManager
        }, j.getShadowMapBounds = function(e) {
            var t = this.getGraphicBounds(e),
                i = this._cameraManager.getPosition();
            return t.zMin = this.findHeight(i) || 0, t
        }, j.getCurrentPositionHeight = function() {
            return this.map.elevation && this._cameraManager ? this._cameraManager.currentPositionHeight : 0
        }, j.setMaxBounds = function(e) {
            this.conf.limit.mockup = e, this._cameraManager.limits.updateLimits()
        }, j.getGraphicBounds = function(e) {
            var t = null;
            if (this.graphicBounds && (t = r.clone(this.graphicBounds)), this._cameraManager) {
                var i = this._cameraManager.getVisibleGroundBoundingBox(e);
                t ? (t.xMin = Math.max(t.xMin, r.min(r.pluck(i, "x"))), t.yMin = Math.max(t.yMin, r.min(r.pluck(i, "y"))), t.xMax = Math.min(t.xMax, r.max(r.pluck(i, "x"))), t.yMax = Math.min(t.yMax, r.max(r.pluck(i, "y")))) : t = {
                    xMin: r.min(r.pluck(i, "x")),
                    xMax: r.max(r.pluck(i, "x")),
                    yMin: r.min(r.pluck(i, "y")),
                    yMax: r.max(r.pluck(i, "y"))
                }, t.camBounds = i
            }
            return t
        }, j.setSize = function(e, t) {
            this._renderEngine.setSize(e), this._cameraManager && this._cameraManager.setCanvasSize(e, t), this.forceRender(), this._pinsManager && this._pinsManager.computeClipping()
        }, j.getSize = function() {
            return {
                w: this._cameraManager._width,
                h: this._cameraManager._height
            }
        }, j.sendCameraChanged = function() {
            var e = this._cameraManager;
            this.map.getDepthMap() && (e.camera.tilt = this.map.getTilt(), e.camera.heading = this.map.getHeading()), this._renderEngine.setCamera(e.camera), this.emit("cameraChanged", e.camera, e.getTarget()), this._cameraChanged = !1
        }, j.computeClipping = function(e) {
            var t = this.getSize(),
                i = t.w / 750,
                n = 1;
            this.map.elevation && (i *= 14, n *= 13), e.value.x = 3200 * i, e.value.y = 2500 * n
        }, j.cameraStabilized = function(e) {
            this._cameraChanged && this.sendCameraChanged(), this.askForHover(), this.updateEnvironmentLighting(), e && this.emit("cameraStabilized", e), this.forceRender()
        }, j.sendPreRender = function(e) {
            this.preRender(e), this.emit("preRender", e)
        }, j.sendPostRender = function(e) {
            this.postRender(e), this.emit("postRender", e)
        }, j.sendToCamera = function() {
            var e = Array.prototype.splice.call(arguments, 0),
                t = e.shift();
            if (this._cameraManager) {
                var i = this._cameraManager.controller,
                    n = i[t];
                n ? ("zoomIn" != t && "zoomOut" != t && this._cameraManager.stopAnimation(), n.apply(i, e)) : console.warn("MapWebGLRenderer.sendToCamera : method not found", t)
            }
        }, j.forceRender = function() {
            this._renderEngine.forceRender()
        }, j.forceUpdateShadow = function() {
            this._renderEngine.forceUpdateShadow()
        }, j.setCameraChanged = function() {
            this._cameraChanged = !0, this.forceRender()
        }, j.lookAtNorth = function() {
            this._cameraManager && this._cameraManager.lookAtNorth()
        }, j.isMoving = function() {
            return this.conf.workOnMove ? !1 : this._cameraManager && this._cameraManager._isCameraMoving
        }, j.setWorkOnMove = function(e) {
            this.conf.workOnMove != e && (this.conf.workOnMove = e)
        }, j.getCurrentCameraConfiguration = function() {
            return this._cameraManager.getCurrentCameraConfiguration()
        }, j.getCenterXYZ = function() {
            return this._cameraManager.getTarget().clone()
        }, j.setFov = function(e) {
            this.conf.set("camera.referenceFov", e), this._cameraManager && (this._cameraManager.updateCamera(this.makeIdleEvent()), this.getRenderEngine().forceUpdateShadow(), this.getRenderEngine().setCamera(this._cameraManager.camera))
        }, j.setNear = function(e) {
            this.conf.set("camera.near", e), this._cameraManager && (this._cameraManager.camera.near = e, this._cameraManager.updateCamera(this.makeIdleEvent()), this.getRenderEngine().forceUpdateShadow(), this.getRenderEngine().setCamera(this._cameraManager.camera))
        }, j.setMaxZoom = function(e, t) {
            var i = t.near,
                n = t.mid,
                r = t.far;
            this.conf.set("tiles.maxZoom", e), this.conf.set("tiles.midScreenQuality", i), this.conf.set("tiles.midScreenQuality", n), this.conf.set("tiles.farScreenQuality", r), this._tileManager && this._tileManager.createQualityTable()
        }, j.fitBounds = function(e, t) {
            this._cameraManager.fitBounds(e, !1, t)
        }, j.panToBounds = function(e, t) {
            this._cameraManager.panToBounds(e, t)
        }, j.getZoomFromBoundsFromApi = function(e) {
            var t = f.convertGoogleLatLngTo900913(e.sw),
                i = f.convertGoogleLatLngTo900913(e.ne);
            return this._cameraManager.getZoomFromBounds({
                left: t.lon,
                right: i.lon,
                bottom: t.lat,
                top: i.lat
            })
        }, j.setCanvasSize = function(e) {
            this._cameraManager.setCanvasSize(e)
        }, j.getFrustum = function() {
            return this._cameraManager.visibleBoundingBox
        }, j.getFrustumFull = function() {
            return this._cameraManager._frustum
        }, j.isInFrustum = function(e, t, i) {
            return w.isPointCloseToPointsList(i.bbox, e, t)
        }, j.getVisibleGroundBoundingBox = function(e) {
            return this._cameraManager.getVisibleGroundBoundingBox(e)
        }, j.findHeight = function(e) {
            return this._tileManager ? this._tileManager.findHeight(e) : null
        }, j.hasHeight = function(e) {
            return this._tileManager ? null != this._tileManager.findHeight(e) : null
        }, j.setZoom = function(e, t) {
            this._cameraManager.setZoom(e, t)
        }, j.setHeading = function(e, t) {
            var i = this.getCurrentCameraConfiguration();
            i.camera.phi = e, this._cameraManager.setCameraConfig(i, t)
        }, j.setTilt = function(e, t) {
            var i = this.getCurrentCameraConfiguration();
            i.camera.theta = e, this._cameraManager.setCameraConfig(i, t)
        }, j.set3d = function(e, t) {
            var i = this.getCurrentCameraConfiguration();
            i["3d"] = e, this._cameraManager.setCameraConfig(i, t)
        }, j.teleport = function(e, t, i, n) {
            this._cameraManager.moveToLonLat({
                lon: e.lon,
                lat: e.lat,
                smoothMovement: t,
                onArrivalCallback: i,
                idleEvent: n
            })
        }, j.setView = function(e, t) {
            var i = e._to900913();
            this._cameraManager.zoomOnPosAndZoom({
                lon: i.lon,
                lat: i.lat,
                zoom: t
            })
        }, j.getProjectionScreenMatrix = function() {
            return this._cameraManager.getProjectionScreenMatrix()
        }, j.setTarget = function(e) {
            this._cameraManager.setTarget(new x(e.lon, e.lat, 0))
        }, j.getZoom = function() {
            var e = this._cameraManager.getDistance();
            return R.computeRoundZoomFromDistance(this.conf, e)
        }, j.getPosCamera = function() {
            return this._cameraManager.getPosition().clone()
        }, j.getTargetCamera = function() {
            return this._cameraManager.getTarget().clone()
        }, j.getFrustumForZoom = function(e, t) {
            return this.getFrustumForZoomAndTarget(e, null, t)
        }, j.getFrustumForZoomAndTarget = function(e, t, i) {
            var n = this.backupCamera();
            this.setZoom(e, i), t && this.setTarget(t), t = this._cameraManager.getTarget();
            var o = this._cameraManager.getVisibleGroundBoundingBox(),
                a = .5 * this._cameraManager.getVisibleWidthAtTarget(),
                s = {
                    xMin: Math.max(r.min(r.pluck(o, "x")), t.x - a),
                    xMax: Math.min(r.max(r.pluck(o, "x")), t.x + a),
                    yMin: Math.max(r.min(r.pluck(o, "y")), t.y - a),
                    yMax: Math.min(r.max(r.pluck(o, "y")), t.y + a)
                };
            return this.restoreCamera(n), s
        }, j.backupCamera = function() {
            return {
                camera: this.getPosCamera().clone(),
                target: this._cameraManager.getTarget().clone()
            }
        }, j.restoreCamera = function(e) {
            this._cameraManager.setTargetAndPosition(e.target, e.camera)
        }, j.getPixelSizeInMeter = function(e) {
            var t = .5 * e,
                i = .5 * this.width,
                n = .5 * this.height,
                r = {
                    x: i - t,
                    y: n
                },
                o = {
                    x: i + t,
                    y: n
                },
                a = this.computeLocationFromPixel(r),
                s = this.computeLocationFromPixel(o);
            return a.distanceTo(s)
        }, j.computeLonLatFromPixel = function(e, t, i) {
            var n;
            if (i) {
                var r = {
                    w: this.$parentNode.width(),
                    h: this.$parentNode.height()
                };
                this.setSize({
                    w: i.width,
                    h: i.height
                }, null), n = this._cameraManager.computeLocationFromPixelInTheSky(e, t, i), this.setSize({
                    w: r.w,
                    h: r.h
                }, null)
            } else n = this._cameraManager.computeLocationFromPixelInTheSky(e, t);
            return f.convertLonLatOrXYToLonLat(n)
        }, j.computeLocationFromPixel = function(e, t) {
            return this._cameraManager.computeLocationFromPixel(e, t)
        }, j.computeDistanceToCenter = function(e) {
            return e.x = e.x || 0, e.y = e.y || 0, e.z = e.z || 0, this._cameraManager.getTarget().distanceTo(e)
        }, j.getPosFromTargetAndZoom = function(e, t, i) {
            return this._cameraManager.getPosFromTargetAndZoom(e, t, i)
        }, j.setCameraConfig = function(e, t) {
            this._cameraManager.setCameraConfig(e, t)
        }, j.computeScreenPosInPixels = function(e) {
            return this._cameraManager.computeScreenPosInPixels(e)
        }, j.setDraggable = function(e) {
            this._cameraManager.controller.setDraggable(e)
        }, j.setDraggableTouch = function(e) {
            G || this.$parentNode.toggleClass("draggableTouch", e), this._mouseManager.setDraggableTouch(e)
        }, j.setScrollwheel = function(e) {
            this._mouseManager.setScrollWheel(e), this._cameraManager.controller.setScrollwheel(e)
        }, j.setdisableDoubleClickZoom = function(e) {
            this._cameraManager.controller.setdisableDoubleClickZoom(e)
        }, j.getNodeSize = function() {
            var e = o(this.$parentNode[0]);
            return e.length ? {
                w: e.width(),
                h: e.height()
            } : null
        }, j.computePicked = function(e, t, i) {
            var n = {
                picked: null,
                type: null,
                clickable: !0
            };
            this.map.elevation && this._cameraManager.setCameraElevations(), this._cameraManager.computeRayForMap(e.xyInMapCanvas);
            var o = this.conf.get("ui.overlaysPickingEnabled");
            if (o) {
                var a = this.computePickedArea(e.xyInMapCanvas);
                if (a && (n.picked = a, n.type = "lineOrArea", n.clickable = a.clickable), "mouseup" == e.type && 1 == e.which) {
                    var s = this.map.elevation && this.conf.get("debug.showElevations"),
                        l = this.conf.get("debug.showTilesShape");
                    if (s || l) {
                        var h = this._cameraManager.ray.intersectAllChildren(this.getScene().tilesParent),
                            u = [];
                        r.each(h, function(e) {
                            e.object && e.object.tile && u.push(e.object.tile)
                        }), console.log("clickedTiles", u.length), r.each(u, function(e) {
                            e.onClicked()
                        })
                    }
                }
            }
            var d = this._cameraManager.ray.intersectAllChildren(this.getScene().marker3dParent);
            if (d.length) {
                var c = d[0],
                    f = c.object.owner;
                return e.lonLat.lon = c.point.x, e.lonLat.lat = c.point.y, n.type = "marker3d", n.picked = f, n.clickable = f.clickable, t(n, e)
            }
            if (o && i) {
                var p = this._cameraManager.ray.intersectAllChildren(this.getScene().buildingsParent);
                if (p.length) {
                    var m = p[0];
                    e.lonLat.lon = m.point.x, e.lonLat.lat = m.point.y, e.featurePicked = m
                }
            }
            return this.map.elevation && this._cameraManager.unsetCameraElevations(), t(n, e)
        }, j.computePickedArea = function(e) {
            var t = this.getPickableAreaMeshes(this.getScene().linesAndAreaParent);
            if (t.length < 0) return [];
            var i = this.getRenderEngine().pickMesh(t, e.x, e.y);
            return i && i.mesh ? i.mesh.owner : null
        }, j.getPickableAreaMeshes = function(e, t) {
            t = t || [], e.owner && e.owner.clickable && e.owner.emit && e.material && e.material.pickingMaterial && t.push(e);
            for (var i = 0; i < e.children.length; ++i) this.getPickableAreaMeshes(e.children[i], t);
            return t
        }, j.debugRenderLine = function(e, t, i, n, r) {
            var o = new M(S.LINES);
            o._positionArray = [], o.fixedColor = new T(null != r ? r : 16711680);
            for (var a = 0; a < e.length; ++a) {
                var s = e[a];
                o._positionArray.push(s.x, s.y, s.z), 0 != a && a != e.length - 1 && o._positionArray.push(s.x, s.y, s.z)
            }
            var l = this.getRenderEngine().createMesh(o, this.getRenderEngine().getDebugMaterial());
            l.position.set(t, i, n), l.updateMatrix(), this.getScene().add(l)
        }, j.debugRenderPointsAsLine = function(e, t, i, n) {
            for (var r = [], o = 0; o < e.length - 1; o++) r.push([e[o], e[o + 1]]);
            for (i && r.push([e[e.length - 1], e[0]]), o = 0; o < r.length; o++) {
                var a = n ? new T(n) : new T;
                n || a.random(), this.debugRenderLine(r[o], t.x, t.y, 0, a.getHex())
            }
        }, j.createPopup = function(e) {
            e.div3d = o("<div>").addClass("f4map-infoWindowPosition").css({
                left: 0,
                top: 0
            }), e.$mapContainer.append(e.div3d)
        }, j.setKeyboardShortcuts = function(e) {
            this._keyboardManager && (this._keyboardManager.keyboardShortcuts = e)
        }, j.getRenderStats = function() {
            return this._renderEngine.getRenderStats()
        }, j.getMemoryStats = function() {
            return this._renderEngine.getMemoryStats()
        }, j.setUrlTemplate2d = function(e) {
            this._tileManager.setUrlTemplate2d(e)
        }, j.setUrlTemplate3d = function(e) {
            this._tileManager.setUrlTemplate3d(e)
        }, j.getColorFilterManager = function() {
            return this._colorFilterManager
        }, j.removeColorFilter = function() {
            this._colorFilterManager.reset(), this.conf.set("renderer.colorFilterEnabled", !1), this._tileManager.onRefreshMaterial()
        }, j.setColorFilter = function(e) {
            this.conf.set("renderer.colorFilterEnabled", !0), "sepia" == e ? this._colorFilterManager.setSepiaEnabled(!0) : "blackAndWhite" == e ? this._colorFilterManager.setBlackAndWhiteEnabled(!0) : console.warn("setColorFilter unknown filter :", e), this._tileManager.onRefreshMaterial()
        }, j.setColorsMapping = function(e) {
            var t = this._renderEngine.getShaderLibrary(),
                i = Boolean(e["2d"] && e["2d"].length || e["3d"] && e["3d"].length);
            this.conf.set("renderer.remapColorsEnabled", i), e["2d"] && this._setColorsMappingInUniform(e["2d"], t.uniforms.remapColors2d.colorsMapping), e["3d"] && this._setColorsMappingInUniform(e["3d"], t.uniforms.remapColors3d.colorsMapping), this._tileManager.onRefreshMaterial()
        }, j._setColorsMappingInUniform = function(e, t) {
            for (var i = t.value, n = 0, r = 0, o = new T, a = new T; n < i.length;) {
                var s = r < e.length ? e[r] : null;
                s ? (o.setString(s.from), a.setString(s.to), i.set([o.r, o.g, o.b, a.r, a.g, a.b], n)) : i.set([0, 0, 0, 0, 0, 0], n), n += 6, ++r
            }
            r < e.length && console.warn("Does not support that many colors mapping")
        }, j.addHeatmapLayer = function(e, t) {
            var i = new m(this, e, t);
            return this._dataLayerManager.addLayer(i), i
        }, j.hasTouchMoved = function() {
            return this._mouseManager && this._mouseManager.hasTouchMoved()
        }, j.removeHeatmapLayer = function(e) {
            null != e && this._dataLayerManager.removeLayer(e)
        }, j.isWebGL = function() {
            return !0
        }, j.canUseDevicePixelRatio = function() {
            return this._renderEngine.canUseDevicePixelRatio()
        }, j.enableWorkers = function() {
            this.useWorkers = this.conf.get("useWebWorkers"), this.workersEnabled = !1, this.workersInitialised = !1, this.useWorkers && (I.onInitialised(r.bind(function() {
                this.workersInitialised = !0, this.workersEnabled = I.isWorkerEnabled(), this.emit("workersInitialised")
            }, this)), I.init())
        }, j.setWebGLBenchmarkScore = function(e) {
            this._webglBenchmarkScore = e
        }, j.getWebGLBenchmarkScore = function() {
            return this._webglBenchmarkScore
        }, j.onDivRemoved = function() {
            if (this.isDestroyed = !0, this._eventPack.removeAllListeners(), this._stopListenForMapVisibility(), this.map) {
                this.clearDynamicLight();
                var e = r.clone(this.map._layersByType);
                r.each(e, function(e) {
                    var t = r.clone(e);
                    r.each(t, function(e) {
                        e.setMap(null), e.onDivRemoved && e.onDivRemoved()
                    })
                }), delete this.conf.getMinZoomLayer2D, this.map._layersByType = {}, this.map.removeListener("mouseout", this._onMouseOutHandler), this.map.removeListener("onMouseOver", this._onMouseOverHandler), this._onDragStartHandler && this._mouseManager.removeListener("leftDown", this._onDragStartHandler), this._onDragHandler && this._mouseManager.removeListener("leftDrag", this._onDragHandler), this._onTouchDragForcedStartHandler && this._mouseManager.removeListener("touchDragForcedStart", this._onTouchDragForcedStartHandler), this._onTouchDragForcedStopHandler && this._mouseManager.removeListener("touchDragForcedStop", this._onTouchDragForcedStopHandler), this._onDragStopHandler && this._mouseManager.removeListener("dragStop", this._onDragStopHandler), this._onClickHandler && this._mouseManager.removeListener("click", this._onClickHandler), this._onRightClickHandler && this._mouseManager.removeListener("rightclick", this._onRightClickHandler), this._onMouseMoveHandler && this._mouseManager.removeListener("mousemove", this._onMouseMoveHandler), this._mouseManager.removeListener("mouseover", this._onMouseOverHandler), this._mouseManager.removeListener("mouseout", this._onMouseOutHandler), this._onComputeHandler && this._renderEngine.removeListener("compute", this._onComputeHandler), this._sendPreRenderHandler && this._renderEngine.removeListener("preRender", this._sendPreRenderHandler), this._sendPostRenderHandler && this._renderEngine.removeListener("postRender", this._sendPostRenderHandler), this._webGLBenchTester && this._webGLBenchTester.abort(), this.map.removeListener("topToBottom_changed", this._topToBottomChangedHandler), this.map.removeListener("sidebyside_changed", this._sideBySideChangedHandler), this.map.removeListener("depthmap_changed", this._depthMapChangedHandler), this.map.removeListener("enabled_changed", this._enabledChangedHandler), this.map.removeListener("shadow_changed", this._shadowChangedHandler), this.map.removeListener("hideShadows_changed", this._hideShadowsChangedHandler), this.map.removeListener("usecsm_changed", this._csmShadowChangedHandler), this.map.removeListener("usepcf_changed", this._pcfShadowOptionsChangedHandler), this.map.removeListener("uselerp_changed", this._lerpShadowOptionsChangedHandler), this.map.removeListener("ssao_changed", this._ssaoChangedHandler), this.map.removeListener("waterreflection_changed", this._waterReflectionChangedHandler), this.map.removeListener("renderenabled_changed", this._renderEnabledHandler), delete this._shadowChangedHandler, delete this._hideShadowsChangedHandler, delete this._ssaoChangedHandler, delete this._waterReflectionChangedHandler, delete this._onComputeHandler, delete this._sendPreRenderHandler, delete this._sendPostRenderHandler, delete this._onDragStartHandler, delete this._onDragHandler, delete this._onTouchDragForcedStartHandler, delete this._onTouchDragForcedStopHandler, delete this._onDragStopHandler, delete this._onClickHandler, delete this._onRightClickHandler, delete this._onMouseMoveHandler, delete this._onMouseOverHandler, delete this._onMouseOutHandler, delete this.dispatchMouseHoverEventsCallback, delete this.dispatchDragStartCallback, this._modelCache && (this._modelCache.clearAll(), delete this._modelCache), this._dataLayerManager.onDivRemoved(), this.textManager.onDivRemoved(), this._mouseManager.onDivRemoved(), this._keyboardManager.onDivRemoved(), this._pinsManager.onDivRemoved(), this._tileManager.onDivRemoved(), this._cameraManager.onDivRemoved(), this._env.onDivRemoved(), B.onDivRemoved(), this.areaEventManager.onDivRemoved(), this._featuresRequestManager.onDivRemoved(), this._renderEngine.onDivRemoved(), delete this._colorFilterManager, delete this._featuresRequestManager, delete this._cameraManager, delete this._mouseManager, delete this._keyboardManager, delete this._env, delete this._renderEngine, delete this.map, delete this._tileManager, delete this._tileMeshManager, delete this._pinsManager, delete this._dataLayerManager, l.prototype.onDivRemoved.apply(this, arguments)
            }
        }, j.onShadersReady = function(e) {
            return this._renderEngine.onShadersReady(e)
        }, j.getShadowExtensionName = function() {
            return this._renderEngine.getShadowExtensionName()
        }
    }, {
        "./MapRenderer": 219,
        "./ServerConfig": 221,
        "./api/MapTypeId": 239,
        "./graphic/area/AreaWebGL": 314,
        "./graphic/area/AreaWorkerManager": 315,
        "./graphic/camera/CameraHelper": 330,
        "./graphic/camera/CameraManager": 332,
        "./graphic/environment/ColorFilterManager": 339,
        "./graphic/environment/Environment": 340,
        "./graphic/heatmap/DataLayerManager": 342,
        "./graphic/heatmap/HeatmapLayerWebGLRenderer": 344,
        "./graphic/pins/MarkerWebGLRenderer": 347,
        "./graphic/pins/PinsManager": 349,
        "./graphic/shader/MapEffects": 350,
        "./graphic/text/TextManager": 361,
        "./graphic/tilemesh/TileMeshManager": 365,
        "./input/KeyboardManager": 387,
        "./input/MouseManager": 388,
        "./utils/EventPack": 403,
        "./utils/LocationHelper": 407,
        "./utils/ModelCache": 408,
        "./utils/WebGLBenchTester": 414,
        "./utils/WebGlContextAttributes": 415,
        "./utils/worker/WorkerManager": 422,
        "browser-detect": 4,
        engine: 10,
        jquery: 111,
        suncalc: 202,
        underscore: 207,
        util: 212
    }],
    221: [function(e, t, i) {
        "use strict";

        function n(e) {
            t.exports.config ? (r(), e && e(null, t.exports.config)) : a.ajax({
                url: s.resolve(l(), "/config"),
                data: {
                    api_key: l.getApiKey(),
                    referrer: location.href
                },
                dataType: "json",
                callback: function(i, n) {
                    if (t.exports.config = n, i || r(), e) e(i, n);
                    else if (i) throw i
                }
            })
        }

        function r() {
            var e = t.exports.config;
            u.logOnAuthorizationsResult(e), h.each(d, function(t, i) {
                var n = e.server[i];
                n || console.log("error flushDownloads unknwon server ", i), h.each(t, function(e) {
                    e.xhr = e.callback(n)
                }), d = {}
            })
        }

        function o(e, i) {
            function n() {
                a.xhr && a.xhr.abort(), r()
            }

            function r() {
                var e = s.indexOf(a);
                e > -1 && s.splice(e, 1)
            }
            if (!e) return i("");
            if (t.exports.config) {
                var o = t.exports.config.server[e];
                return o ? i(o) : (console.log("error unknwon server for url", e), null)
            }
            var a = {
                    callback: i,
                    abort: n,
                    done: r
                },
                s = d[e];
            return null == s ? s = d[e] = [a] : s.push(a), a
        }
        var a = e("jquery"),
            s = e("url"),
            l = e("./utils/apiUrl"),
            h = e("underscore"),
            u = e("./api/internal/ApiKeyCheck");
        t.exports = {
            load: n,
            onServerHostReady: o
        };
        var d = {}
    }, {
        "./api/internal/ApiKeyCheck": 261,
        "./utils/apiUrl": 417,
        jquery: 111,
        underscore: 207,
        url: 208
    }],
    222: [function(e, t, i) {
        "use strict";
        t.exports = {
            BOUNCE: 1,
            DROP: 2
        }
    }, {}],
    223: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._type = "buildings", this._isTileTooFarCbk = s.bind(this._isTileTooFar, this), e = s.defaults({}, e, {
                refreshPeriod: 200,
                zoom: 16,
                minZoom: 16,
                zoomForHeights: 19,
                pickingEnabled: !1,
                maxDistance: 7500,
                unloadDistance: 1e4,
                filter: null,
                alwaysExtrudeOSMBuildings: !1,
                useModelFootprints: !0,
                queryMaxAgeInS: 43200,
                displayLoadErrorInText: !1,
                name: !1,
                spawnAnimDurationMS: 1e3,
                easing: h.easing.easeOutExpo,
                defaultWallColor: "#DDDDDD",
                defaultWallGradientColor: "#CCCCCC",
                defaultRoofColor: "#FFFFFF",
                wallGradientColorEnabled: !0,
                wallColor: null,
                roofColor: null,
                heightScale: 1,
                workOnMove: !0,
                minimisedDataEnabled: !0,
                minimisedLevel: 255,
                minimisedGeoPrecision: .01,
                minimisedBinaryData: !0,
                requestOptions: null
            }), "buildingsNames" in e && !("name" in e) && (e.name = e.buildingsNames), this._nameGetter = this._getNameGetter(), this._loadedElevations = {}, this._pendingTileElevationsUpdates = {}, this.specialBuildings = e.specialBuildings || {}, delete e.specialBuildings, this._blockSpecialBuildings = {}, this._excludedBuildings = [], this._includedBuildings = [], this._exclusionZones = [], this._currentSpecialBuildings = [], this._elevationChangedCbk = s.bind(this._elevationChanged, this), this._enter2dCbk = s.bind(this._enter2d, this), this._enter3dCbk = s.bind(this._enter3d, this), this._postRenderCbk = s.bind(this._rebuildGraphicBounds, this), this._onTileElevationsUpdatedCbk = s.bind(this._onTileElevationsUpdated, this), this._onFeaturePickedCbk = s.bind(this.onFeaturePicked, this), this._onWorkersInitialisedCbk = s.bind(this.onWorkersInitialised, this), this._handleTileHandler = s.bind(this._handleTile, this), this.loadOnlyID = 0, this._blocks = {}, this.pickingBounds = {}, this.lastUnloadDate = Date.now(), this.graphicBoundsDirty = !0, this.blockMaterial = null, this.buildingCreationDurationMs = 0, d.call(this, e), s.each(E, function(e) {
                this.on(e.toLowerCase() + "_changed", s.bind(this.reloadAll, this))
            }, this), this.on("heightscale_changed", s.bind(this._handleHeightScaleChange, this)), this.on("specialbuildings_changed", s.bind(this._handleSpecialBuildingsChanged, this)), this._handleSpecialBuildingsData(), this._blocksPendingPreProcessing = [], this._blocksPendingPostProcessing = [], this._skipWorkerAction = !1
        }

        function r(e, t) {
            return e.lon < t.left || e.lon > t.right || e.lat < t.bottom || e.lat > t.top
        }

        function o(e) {
            return e.name ? e.name : null
        }

        function a(e) {
            return e.error ? e.error : o(e)
        }
        var s = e("underscore"),
            l = e("util"),
            h = e("jquery"),
            u = e("./MVCObject"),
            d = e("./layers/GridLayer"),
            c = e("../graphic/buildings/Block"),
            f = e("../graphic/buildings/BlockHelper"),
            p = e("../utils/TileHelper"),
            m = e("engine"),
            g = m.Vector3,
            _ = m.Constants,
            v = m.Ray,
            y = m.ShapeUtils,
            b = m.TriangulationUtils,
            x = m.Geometry,
            w = e("../graphic/buildings/building-generator"),
            M = e("wellknown"),
            T = e("../utils/WorkProcessor"),
            S = e("../utils/Ajax"),
            C = e("url");
        t.exports = n, l.inherits(n, d);
        var E = ["defaultWallColor", "defaultWallGradientColor", "defaultRoofColor", "wallColor", "roofColor", "filter", "specialBuildings", "alwaysExtrudeOSMBuildings", "useModelFootprints"],
            k = E.concat(["name", "heightscale"]);
        n.extendColorMapping = w.extendColorMapping;
        var L = n.prototype,
            P = d.prototype;
        u.createProperties(L, k), L.handleUnsetMap = function() {
            this.options && (this.options.map = null), P.handleUnsetMap.call(this);
            var e = this.map && this.map.conf.get("enableWebGL");
            e && (this.blockWorkerPreAndPostProcessor && (this.blockWorkerPreAndPostProcessor.release(), delete this.blockWorkerPreAndPostProcessor), this.clearHighlight(), this.unbindEvents(), this._bindListeners("removeListener"), this.removeListener("tile", this._handleTileHandler), this.blockMaterial && (this.map._renderer.getRenderEngine().releaseMaterial(this.blockMaterial), delete this.blockMaterial)), this.setEnabled(!1)
        }, L.setWorkOnMove = function(e) {
            if (this.map) {
                e = e && (this.map.conf.get("downloads.buildings.workOnMove") || this.map.conf.get("useWebWorkers") && this.map.conf.get("buildings.workOnMoveWithWorker")), this.workOnMove = e;
                var t = this.map.conf.get("downloads.buildings.priority"),
                    i = this.map._renderer._featuresRequestManager.priorityRequests.getPriorityRequest(t);
                i.workOnMove = e
            }
        }, L.handleSetMap = function() {
            this.maxDistance = this.map.conf.get("buildings.maxDistanceLoad"), this.unloadDistance = this.map.conf.get("buildings.maxDistanceUnload"), P.handleSetMap.call(this);
            var e = this.map && this.map.conf.get("enableWebGL");
            this.setEnabled(e), e && (this.setWorkOnMove(this.options.workOnMove), this.on("tile", this._handleTileHandler), this.bindEvents(), this.buildMaterial(), this._bindListeners("on"), this.map._renderer.isIn3d() ? this._enter3d() : this._enter2d(), this.map._renderer.useWorkers && (this.map._renderer.workersInitialised ? this.onWorkersInitialised() : this.map._renderer.on("workersInitialised", this._onWorkersInitialisedCbk)), this.minimisedDataEnabled = this.minimisedDataEnabled && this.map.conf.get("buildings.enableMinimisedBuildingData"), this.map.setExclusionZones("BuildingLayer", this._exclusionZones))
        }, L.rebuildMaterial = function() {
            this.blockMaterial = null, this.releaseAllTiles(), this.buildMaterial(), this.forceUpdateTiles()
        }, L.buildMaterial = function() {
            if (!this.blockMaterial) {
                var e = this.map._renderer.getRenderEngine(),
                    t = e.getShadowExtensionName();
                this.blockMaterial = e.createMaterial("dirlight_envmap" + t, _.NoBlending)
            }
        }, L.onWorkersInitialised = function() {
            if (this.map._renderer.workersEnabled) {
                var e = this.map.conf.get("downloads.buildings.priority"),
                    t = this.map._renderer._featuresRequestManager,
                    i = t.priorityRequests.getPriorityRequest(e);
                i.workOnMove = this.workOnMove, this.blockWorkerPreAndPostProcessor || (this.blockWorkerPreAndPostProcessor = new T(this.map._renderer, {
                    intervalIdle: this.map.conf.get("workProcessor.blockWorkerProcessorInterval"),
                    maxDurationIdle: this.map.conf.get("workProcessor.blockWorkerProcessorDuration"),
                    workWhenCameraMove: !0,
                    intervalMoving: this.map.conf.get("workProcessor.blockWorkerProcessorIntervalMoving"),
                    maxDurationMoving: this.map.conf.get("workProcessor.blockWorkerProcessorDurationMoving"),
                    name: "blockWorkerProcessor"
                }), this.blockWorkerPreAndPostProcessor.registerWorker(s.bind(this._getBlockWorkerProcessorWork, this), "BuildingLayer:blockWorkerProcessor")), this.blockWorkerPreAndPostProcessor.start()
            }
            this.map._renderer.removeListener("workersInitialised", this._onWorkersInitialisedCbk)
        }, L.bindEvents = function() {
            this.unbindEvents(), this.map && (this.map.elevation && this.map._renderer.on("tile_elevations_updated", this._onTileElevationsUpdatedCbk), this.pickingEnabled && this.map._renderer.on("featurePicked", this._onFeaturePickedCbk))
        }, L.unbindEvents = function() {
            this.map && (this.map._renderer.removeListener("elevation_changed", this._elevationChangedCbk), this.map._renderer.removeListener("featurePicked", this._onFeaturePickedCbk), this.map._renderer.removeListener("workersInitialised", this._onWorkersInitialisedCbk), this.map.elevation && this.map._renderer.removeListener("tile_elevations_updated", this._onTileElevationsUpdatedCbk), this.pickingEnabled && this.map._renderer.removeListener("featurePicked", this._onFeaturePickedCbk))
        }, L._isTileTooFar = function(e) {
            var t = this.map._renderer.getPosCamera();
            t.z = 0;
            var i = {
                x: e.center.x,
                y: e.center.y,
                z: 0
            };
            return t.distanceTo(i) > this.unloadDistance
        }, L._bindListeners = function(e) {
            var t = this.map && this.map._renderer;
            t && (t[e]("enter2d", this._enter2dCbk), t[e]("enter3d", this._enter3dCbk), t[e]("postRender", this._postRenderCbk), this.map[e]("elevation_changed", this._elevationChangedCbk))
        }, L._requestTile = function(e, t) {
            var i, n = {},
                r = {},
                o = "building";
            if (this.requestOptions && this.requestOptions.uri) {
                var a = C.parse(this.requestOptions.uri);
                o = a.host || "";
                var l = a.path;
                0 == l.indexOf("/") && (l = l.substr(1)), i = l, this.requestOptions.params && s.each(this.requestOptions.params, function(e, t) {
                    n[t] = e
                })
            } else this.minimisedDataEnabled ? (i = "buildings-mini/geojson", n = {}, this.minimisedBinaryData || (n.binary = !1), .01 != this.minimisedGeoPrecision && (n.precision = this.minimisedGeoPrecision), 255 != this.minimisedLevel && (n.minimiseLevel = this.minimisedLevel), r = {
                binary: this.minimisedBinaryData
            }) : i = t ? "buildings-split/geojson" : "buildings/geojson";
            var h = JSON.stringify(s.extend({
                    maxage: this.queryMaxAgeInS,
                    straightSkeleton: 1
                }, this.filter)),
                u = {
                    params: {
                        query: h
                    },
                    noStringify: !0,
                    serverName: o,
                    fullQueryString: i,
                    processData: s.bind(this._processBuildingData, this),
                    postProcessData: s.bind(this._postProcessItems, this),
                    processRawData: s.bind(this._processRawBuildingData, this),
                    groupPostProcess: !0,
                    cut: !1,
                    priority: this.map.conf.get("downloads.buildings.priority"),
                    bounds: e.bounds,
                    center: e.center,
                    tileKey: e.id
                };
            return s.extend(u, r), s.extend(u.params, n), this.map._renderer._featuresRequestManager.askTileToServer(e.coord, u)
        }, L._handleTile = function(e) {
            var t = this.map._renderer.workersEnabled,
                i = this._blocks[e.id];
            if (!i) {
                var n = this._requestTile(e, t);
                e.buildingRequest = n;
                var r = .707 * p.getTileSizeInMeters(e.key.z),
                    o = new g(e.center.x, e.center.y, 0),
                    a = this.map._renderer.getScene().buildingsParent,
                    l = ["colorBeforeProcess", "depth", "shadowDepth", "reflected"];
                i = new c({
                    buildingLayer: this,
                    position: o,
                    radius: r,
                    sceneParent: a,
                    material: this.blockMaterial,
                    renderPassToHandle: l,
                    tileKey: e.id,
                    bounds: e.bounds
                }), i._isHandledByWorker = t, i._minimised = this.minimisedDataEnabled, this._blocks[e.id] = i, this.graphicBoundsDirty = !0, e.on("released", s.bind(function() {
                    n.abort(), i.destruct(), this.removeBlockForPreProcessing(i), this.removeBlockForPostProcessing(i), delete this._blocks[e.id], this.graphicBoundsDirty = !0
                }, this))
            }
        }, L.adaptHeights = function(e) {
            var t = this._blocks[e.id];
            t && t.adaptHeights()
        }, L.reloadAll = function() {
            this.releaseAllTiles(), this.forceUpdateTiles()
        }, L._handleHeightScaleChange = function() {
            var e = this.heightScale;
            s.each(this._blocks, function(t) {
                t.animateHeightScale(e, this.spawnAnimDurationMS, this.easing)
            }, this)
        }, L._elevationChanged = function() {
            this.reloadAll(), this.bindEvents()
        }, L._rebuildGraphicBounds = function() {
            if (this.graphicBoundsDirty) {
                this.graphicBoundsDirty = !1;
                var e = null;
                0 != s.size(this._blocks) && (e = {
                    xMin: 1 / 0,
                    yMin: 1 / 0,
                    xMax: -(1 / 0),
                    yMax: -(1 / 0)
                }, s.each(this._blocks, function(t) {
                    var i = t.radius / 2;
                    e.xMin = Math.min(e.xMin, t.position.x - i), e.yMin = Math.min(e.yMin, t.position.y - i), e.xMax = Math.max(e.xMax, t.position.x + i), e.yMax = Math.max(e.yMax, t.position.y + i)
                })), this.map._renderer.graphicBounds = e
            }
        }, L.isBuildingAlreadyLoaded = function(e, t) {
            for (var i = 0; i < t.length; ++i) {
                var n = this._blocks[t[i]];
                if (n && n.buildings[e]) return !0
            }
            return !1
        }, L._processRawBuildingData = function(e, t) {
            var i = this._blocks[t.tileKey];
            if (i) {
                var n, r = i.isHandledByWorker();
                n = this.minimisedDataEnabled && this.minimisedBinaryData ? f.decodeBinaryBuildingData(e) : JSON.parse(e) || {};
                var o = n.defaultGeometryData;
                if (s.each(n.buildings, function(e) {
                        s.defaults(e, o)
                    }), i._minimised && n.miniRectData && i.setMinimisedBlockData(n), i.loadSpecialBuildings(), r) {
                    var a = i.processRawDataForWorker(n, this.loadOnlyID);
                    this.map._renderer.isMoving() && (this._skipWorkerAction = !0), t.rawData = a
                } else if (i._minimised) {
                    var l = n.buildings;
                    t.data = l, delete t.rawData
                } else t.rawData = e
            }
            t.options.processRawData = null
        }, L._getBlockWorkerProcessorWork = function() {
            return this._skipWorkerAction ? (this._skipWorkerAction = !1, this.blockWorkerPreAndPostProcessor._maxDurationInMs = 0, null) : (0 == this.blockWorkerPreAndPostProcessor._maxDurationInMs && this.blockWorkerPreAndPostProcessor._updateMaxDuration(), this._blocksPendingPostProcessing.length > 0 ? s.bind(this.handleBlockWorkerPostProcessing, this) : this._blocksPendingPreProcessing.length > 0 ? s.bind(this.handleBlockWorkerPreProcessing, this) : null)
        }, L.handleBlockWorkerPreProcessing = function() {
            var e = Date.now(),
                t = this._blocksPendingPreProcessing[0];
            t.handleWorkerPreProcessing();
            var i = Date.now();
            this.buildingCreationDurationMs += i - e
        }, L.handleBlockWorkerPostProcessing = function() {
            var e = Date.now(),
                t = this._blocksPendingPostProcessing[0];
            t.handleWorkerPostProcessing();
            var i = Date.now();
            this.buildingCreationDurationMs += i - e
        }, L.addBlockForPreProcessing = function(e) {
            this._blocksPendingPreProcessing.push(e)
        }, L.addBlockForPostProcessing = function(e) {
            this._blocksPendingPostProcessing.push(e)
        }, L.removeBlockForPreProcessing = function(e) {
            this._blocksPendingPreProcessing = s.without(this._blocksPendingPreProcessing, e)
        }, L.removeBlockForPostProcessing = function(e) {
            this._blocksPendingPostProcessing = s.without(this._blocksPendingPostProcessing, e)
        }, L.hasBlockWithForProcessing = function() {
            return this._blocksPendingPreProcessing.length > 0 || this._blocksPendingPostProcessing.length > 0
        }, L._processBuildingData = function(e, t) {
            if (0 != this.loadOnlyID) {
                var i = e.parentBuildingOsmId || e.osm_id;
                if (i != this.loadOnlyID) return null
            }
            var n = this._blocks[t.tileKey];
            if (n) {
                var r = !1,
                    o = e.osm_id;
                if (e.not_exceeding_tile || (r = this.isBuildingAlreadyLoaded(o, n._neighborBlockTileKeys)), !r && n) {
                    var a = Date.now();
                    n.loadBuilding(o, e);
                    var s = Date.now();
                    return this.buildingCreationDurationMs += s - a, !0
                }
            }
            return null
        }, L._postProcessItems = function(e, t) {
            t.postProcessed = !0;
            var i = this._blocks[t.tileKey],
                n = t.bounds;
            i.isHandledByWorker() || this._handleBlockLoaded(i, n), delete t.xhr
        }, L._handleBlockLoaded = function(e, t) {
            e && !e.isLoaded && this.map && (this.map._renderer._pinsManager.updatePinsHeightInBounds({
                left: t.xMin,
                right: t.xMax,
                top: t.yMax,
                bottom: t.yMin
            }), this.emit("block_loaded", t), e.onLoaded())
        }, L._loadItems = function(e) {
            s.each(e, function(e) {
                e.load()
            })
        }, L._unloadItems = function(e) {
            s.each(e, function(e) {
                e.unload()
            })
        }, L._enter2d = function() {
            var e = this.map._renderer.getScene();
            e.remove(e.buildingsParent), this.map._renderer.forceUpdateShadow()
        }, L._enter3d = function() {
            var e = this.map._renderer.getScene();
            e.add(e.buildingsParent), this.map._renderer.forceUpdateShadow()
        }, L.unregisterBoundingBox = function(e) {
            var t = e.id;
            s.each(e.tileKeysBoundingBox, function(e) {
                var i = this.pickingBounds[e];
                i && (delete i[t], --i.nbr, 0 == i.nbr && delete this.pickingBounds[e])
            }, this), delete e.tileKeysBoundingBox
        }, L._onTileElevationsUpdated = function(e, t) {
            s.each(this._tiles, function(i) {
                var n = i.id,
                    r = this._blocks[n];
                if (r) {
                    var o = i.bounds.xMin > t.xMax || i.bounds.xMax < t.xMin || i.bounds.yMax < t.yMin || i.bounds.yMin > t.yMax;
                    o || (this.isElevationDirty = !0, this._pendingTileElevationsUpdates[n] || (this._pendingTileElevationsUpdates[n] = {
                        tile: i,
                        elevationsTiles: {}
                    }), this._pendingTileElevationsUpdates[n].elevationsTiles[e] = t)
                }
            }, this)
        }, L.onFeaturePicked = function(e) {
            if (window.navigator.onLine === !1) return void this.emit("buildingPicked", null, e);
            var t = this,
                i = e.lonLat;
            S.download("geo", {
                url: "/query/picking",
                dataType: "json",
                timeout: 3e4,
                data: {
                    q: JSON.stringify({
                        maxage: 43200,
                        building: !0,
                        type: "polygon",
                        intersects: "POINT(" + i.lon + " " + i.lat + ")",
                        format: {
                            out: "wkt"
                        }
                    })
                },
                error: function(i, n, r) {
                    console.error("picking query failed", i, n, r), t.emit("buildingPicked", null, e)
                },
                success: function(i) {
                    if (i.length > 0) {
                        var n = i[0];
                        n.geometry = s.isString(n.way) ? M(n.way) : n.way, delete n.way, t.emit("buildingPicked", n, e)
                    }
                }
            })
        }, L.setTarget = function(e, t) {
            e || null == this._backupWorkOnMove ? e && (this._backupWorkOnMove = this.workOnMove, this.setWorkOnMove(t)) : (this.setWorkOnMove(this._backupWorkOnMove), delete this._backupWorkOnMove), P.setTarget.call(this, e)
        }, L.setOptions = function(e) {
            null != e.workOnMove && this.setWorkOnMove(e.workOnMove), P.setOptions.call(this, e)
        }, L.highlightBuilding = function(e) {
            var t = w.parseShape(e.geometry, null, !0),
                i = new x;
            i._positionArray = [], i._normalArray = [], s.each(t.rings, function(e) {
                y.setRingHeight(e, 50);
                var t = {
                    minHeight: 0,
                    height: 0,
                    color: null,
                    closed: !0,
                    repeatUv: !1,
                    normalSmoothing: !1
                };
                b.extrudeWall(i, e.shapePts, t)
            }), this._highlightGeometry(i, t.position, t.bounds)
        }, L._highlightGeometry = function(e, t, i) {
            this.clearHighlight();
            var n = this.map._renderer,
                r = n.getRenderEngine(),
                o = r.createMaterial("highlightBuilding", _.AdditiveAlphaBlending);
            o.transparent = m.Constants.Gradual, o.depthWrite = !1, o.depthTest = !1;
            var a = r.createMesh(e, o);
            if (a.position.copy(t), this.map.elevation) {
                var s = 0;
                if (i) {
                    for (var l = [{
                            x: i.left,
                            y: i.bottom
                        }, {
                            x: i.left,
                            y: i.top
                        }, {
                            x: i.right,
                            y: i.bottom
                        }, {
                            x: i.right,
                            y: i.top
                        }], h = 99999.9, u = 0; 4 > u; u++) h = Math.min(h, this.map._renderer.findHeight(l[u]));
                    s = h
                } else s = this.map._renderer.findHeight(t);
                a.position.z += s
            }
            a.doubleSided = !0, a.updateMatrix(), this.highlightMesh = a;
            var d = this.map._renderer.getScene().buildingsParent;
            d.add(a)
        }, L.clearHighlight = function() {
            var e = this.highlightMesh;
            if (e) {
                var t = this.map._renderer.getScene().buildingsParent;
                t.remove(e);
                var i = this.map._renderer.getRenderEngine();
                i.releaseGeometry(e.geometry), i.releaseMaterial(e.material), i.freeMesh(e), this.highlightMesh = null
            }
        }, L._highlightGeometry2d = function(e, t) {
            e.fixedColor = new m.Color, this.clearHighlight2d();
            var i = this.map._renderer,
                n = i.getRenderEngine(),
                r = n.createMaterial("nolight", _.AdditiveAlphaBlending);
            r.depthWrite = !1, r.depthTest = !1;
            var o = n.createMesh(e, r);
            o.position.copy(t), o.doubleSided = !0, o.updateMatrix(), this.highlightMesh2d = o;
            var a = this.map._renderer.getScene().linesAndAreaParent;
            a.add(o)
        }, L.clearHighlight2d = function() {
            var e = this.highlightMesh2d;
            if (e) {
                var t = this.map._renderer.getScene().linesAndAreaParent;
                t.remove(e);
                var i = this.map._renderer.getRenderEngine();
                i.releaseGeometry(e.geometry), i.releaseMaterial(e.material), i.freeMesh(e), this.highlightMesh2d = null
            }
        }, L.updateElevations = function() {
            if (this.map.elevation && this.isElevationDirty && this.canWork()) {
                var e = [];
                s.each(this._pendingTileElevationsUpdates, function(t, i) {
                    var n = this._blocks[i];
                    n ? n.isLoaded && (e.push(i), s.defer(function() {
                        n.adaptHeights()
                    })) : e.push(i)
                }, this), s.each(e, function(e) {
                    delete this._pendingTileElevationsUpdates[e]
                }, this), this.isElevationDirty = s.size(this._pendingTileElevationsUpdates) > 0
            }
        }, L.registerBoundingBox = function(e, t, i) {
            for (var n = e.id, r = p.sphericalMercatorToTile(t.left, t.bottom, this.zoomForHeights), o = p.sphericalMercatorToTile(t.right, t.top, this.zoomForHeights), a = [], s = o.y; s <= r.y; s += 1)
                for (var l = r.x; l <= o.x; l += 1) {
                    var h = p.generateKey({
                        x: l,
                        y: s,
                        z: this.zoomForHeights
                    });
                    a.push(h);
                    var u = this.pickingBounds[h];
                    null == u && (u = this.pickingBounds[h] = {}, u.nbr = 0);
                    var d = (t.top - t.bottom) * (t.right - t.left);
                    u[n] = {
                        bounds: t,
                        height: i,
                        building3d: e,
                        area: d
                    }, u.nbr++
                }
            e.tileKeysBoundingBox = a
        }, L.updateBoundingBoxHeight = function(e, t) {
            var i = e.tileKeysBoundingBox;
            if (i)
                for (var n = 0; n < i.length; n++) {
                    var r = i[n],
                        o = this.pickingBounds[r];
                    null != o && o[e.id] && (o[e.id].height += t)
                }
        }, L.isCacheable = function(e) {
            return e.buildingRequest.postProcessed
        }, L.canWork = function() {
            return P.canWork.call(this) ? this.workOnMove ? !0 : this.map._renderer && !this.map._renderer.isMoving() : !1
        }, L.getBuildingHeightAt = function(e) {
            var t = p.generateKey(p.sphericalMercatorToTile(e.lon, e.lat, this.zoomForHeights)),
                i = this.pickingBounds[t];
            if (i) {
                for (var n = this.map.conf.get("pins.minBuildingHeight"), o = p.generateKey(p.sphericalMercatorToTile(e.lon, e.lat, this.zoom)), a = s.keys(i), l = null, h = 0; h < a.length; ++h)
                    if ("nbr" != a[h]) {
                        var u = i[a[h]],
                            d = u.bounds;
                        if (!r(e, d)) {
                            if (u.building3d.model && u.building3d.model.mesh) {
                                var c = new v;
                                c.origin.set(e.lon, e.lat, 1e5), c.direction.set(0, 0, -1);
                                var f = c.intersectAllChildren(u.building3d.model.mesh);
                                if (f.length) {
                                    var m = f[0].point.z;
                                    return m < u.height && (m += .3 * (u.height - m)), n + m
                                }
                                continue
                            }
                            null == l ? l = u : u.building3d.parentBuildingId === l.building3d.parentBuildingId ? u.height > l.height && (l = u) : u.area < l.area && (l = u)
                        }
                    }
                if (l) {
                    var g = this._blocks[o],
                        _ = g ? g._scaleZ : 1;
                    return n += l.height * _
                }
            }
            return null
        }, L.resetCreationDuration = function() {
            this.buildingCreationDurationMs = 0
        }, L.getCreationDurationMs = function() {
            return this.buildingCreationDurationMs
        }, L._getNameGetter = function() {
            return s.isFunction(this.name) ? this.name : this.displayLoadErrorInText ? a : o
        }, L._applyNameGetter = function() {
            var e = this._nameGetter;
            this.name && (this._nameGetter = this._getNameGetter()), e != this._nameGetter ? this.reloadAll() : s.each(this._blocks, function(e) {
                e.applyBuildingNameVisibility()
            })
        }, L._getBuildingName = function(e, t) {
            return this._nameGetter(e, t)
        }, L.setBuildingsNames = function(e) {
            this.set("name", e)
        }, L.buildingsnames_changed = function() {
            this.set("name", this.buildingsNames)
        }, L.name_changed = function() {
            this._applyNameGetter()
        }, L.onSpecialBuildingLoaded = function(e) {
            this.emit("modelBuildingLoaded", e)
        }, L.onSpecialBuildingUnloaded = function(e) {
            var t = this._currentSpecialBuildings.indexOf(e.specialBuildingId); - 1 != t && this._currentSpecialBuildings.splice(t, 1), this.emit("modelBuildingUnloaded", e)
        }, L.setSpecialBuildingLoaded = function(e) {
            this._currentSpecialBuildings.push(e)
        }, L.specialBuildingIsLoaded = function(e) {
            var t = this._currentSpecialBuildings.indexOf(e);
            return -1 != t
        }, L.getSpecialBuildingsForBlock = function(e) {
            var t = this._blockSpecialBuildings[e];
            return t
        }, L._handleSpecialBuildingsChanged = function() {
            this._blockSpecialBuildings = {}, this._exclusionZones = [], this._excludedBuildings = [], this._includedBuildings = [], this._handleSpecialBuildingsData()
        }, L.isReplacedBySpecialBuilding = function(e, t, i, n, r) {
            if (this._includedBuildings.indexOf(t) > -1) return !1;
            var o = this.specialBuildings[t];
            if (null == o && r && (o = this.specialBuildings[r]), null == o && this.useModelFootprints) {
                var a = this._blockSpecialBuildings[e];
                if (null != a) {
                    var l = new g(-i.x, -i.y, 0),
                        h = w.parseShape(n, l, !1),
                        u = h.bounds,
                        d = h.rings;
                    u.left += i.x, u.right += i.x, u.bottom += i.y, u.top += i.y, o = s.find(a, function(e) {
                        if (null == e.vectorFootprint) return !1;
                        var t = u.left > e.boundingBox.maxX || u.right < e.boundingBox.minX || u.bottom > e.boundingBox.maxY || u.top < e.boundingBox.minY;
                        if (!t) {
                            t = !0;
                            var i, n, r, o, a;
                            for (i = 0; i < e.vectorFootprint.length && t; i++)
                                for (o = e.vectorFootprint[i], a = o.shapePts, n = 0; n < d.length && t; n++) r = d[n], t = !y.isPolygonIntersectingRing(a, r);
                            for (i = 0; i < d.length && t; i++)
                                for (r = d[i], a = r.shapePts, n = 0; n < e.vectorFootprint.length && t; n++) o = e.vectorFootprint[n], t = !y.isPolygonIntersectingRing(a, o)
                        }
                        return !t
                    })
                }
            }
            return null != o ? (this._excludedBuildings.push(t), r && this._excludedBuildings.push(r), !0) : !1
        }, L.shouldExtrudeSpecialBuildingId = function(e) {
            return this.alwaysExtrudeOSMBuildings ? !0 : -1 == this._excludedBuildings.indexOf(e)
        }, L._handleSpecialBuildingsData = function() {
            var e = this.zoom;
            this._exclusionZones = [], s.each(this.specialBuildings, function(t, i) {
                t.id = i;
                var n = t.boundingBox;
                if (n) {
                    var r = p.generateKey(p.sphericalMercatorToTile(n.minX, n.minY, e)),
                        o = p.generateKey(p.sphericalMercatorToTile(n.maxX, n.minY, e)),
                        a = p.generateKey(p.sphericalMercatorToTile(n.minX, n.maxY, e)),
                        l = p.generateKey(p.sphericalMercatorToTile(n.maxX, n.maxY, e)),
                        h = this._blockSpecialBuildings[r];
                    null == h && (h = this._blockSpecialBuildings[r] = {}), h[i] = t;
                    var u = this._blockSpecialBuildings[o];
                    null == u && (u = this._blockSpecialBuildings[o] = {}), u[i] = t;
                    var d = this._blockSpecialBuildings[a];
                    null == d && (d = this._blockSpecialBuildings[a] = {}), d[i] = t;
                    var c = this._blockSpecialBuildings[l];
                    null == c && (c = this._blockSpecialBuildings[l] = {}), c[i] = t
                }
                if (t.footprint && t.footprint.length > 0) {
                    for (var f = [], m = 0; m < t.footprint.length; m++) {
                        var _ = t.footprint[m],
                            v = _.shapePts,
                            y = _.shapeHolePts,
                            b = {
                                shapePts: [],
                                shapeHolePts: []
                            };
                        f.push(b);
                        var x, w;
                        for (x = 0; x < v.length; x++) w = v[x], b.shapePts.push(new g(w[0] + t.lon, w[1] + t.lat, 0));
                        for (var M = 0; M < y.length; M++) {
                            var T = y[M],
                                S = [];
                            for (b.shapeHolePts.push(S), x = 0; x < T.length; x++) w = T[x], S.push(new g(w[0] + t.lon, w[1] + t.lat, 0))
                        }
                    }
                    t.vectorFootprint = f
                }
                if (this._includedBuildings = s.union(this._includedBuildings, t.includeIds), null != t.boundingBox && null != t.vectorFootprint) {
                    var C = {
                        id: i,
                        boundingBox: t.boundingBox,
                        footprint: t.vectorFootprint
                    };
                    this._exclusionZones.push(C)
                }
            }, this), this.map && this.map.setExclusionZones("BuildingLayer", this._exclusionZones)
        }
    }, {
        "../graphic/buildings/Block": 316,
        "../graphic/buildings/BlockHelper": 317,
        "../graphic/buildings/building-generator": 320,
        "../utils/Ajax": 397,
        "../utils/TileHelper": 411,
        "../utils/WorkProcessor": 416,
        "./MVCObject": 236,
        "./layers/GridLayer": 262,
        engine: 10,
        jquery: 111,
        underscore: 207,
        url: 208,
        util: 212,
        wellknown: 213
    }],
    224: [function(e, t, i) {
        "use strict";

        function n(e) {
            a.call(this), this.id = r.uniqueId("circle_"), this.strokeOpacity = 1, this.strokeColor = "#000000", this.strokeWeight = 2, this.clickable = !0, this.radius = 1, this.simplify = !1, this.setOptions(e)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Overlay"),
            s = e("./LatLng");
        t.exports = n, o.inherits(n, a);
        var l = n.prototype;
        a.createProperty(l, "strokeOpacity", Number), a.createProperty(l, "strokeColor", String), a.createProperty(l, "strokeWeight", Number), a.createProperty(l, "zIndex", Number), a.createProperty(l, "radius", Number), a.createProperty(l, "center", s), a.createProperty(l, "simplify", Boolean), l.getType = function() {
            return "Circle"
        }, l.setOptions = function(e) {
            var t = this.map;
            r.each(e, function(e, i) {
                switch (i) {
                    case "map":
                        t = e;
                        break;
                    default:
                        this.set(i, e)
                }
            }, this), this.setMap(t)
        }, l._isDisplayable = function() {
            return null != this.center
        }
    }, {
        "./LatLng": 233,
        "./Overlay": 244,
        underscore: 207,
        util: 212
    }],
    225: [function(e, t, i) {
        "use strict";
        var n = {
            TOP_LEFT: 1,
            TOP_CENTER: 2,
            TOP: 2,
            TOP_RIGHT: 3,
            LEFT_CENTER: 4,
            LEFT_TOP: 5,
            LEFT: 5,
            LEFT_BOTTOM: 6,
            RIGHT_TOP: 7,
            RIGHT: 7,
            RIGHT_CENTER: 8,
            RIGHT_BOTTOM: 9,
            BOTTOM_LEFT: 10,
            BOTTOM_CENTER: 11,
            BOTTOM: 11,
            BOTTOM_RIGHT: 12,
            CENTER: 13
        };
        t.exports = n
    }, {}],
    226: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.setOptions(e), this.features = [], this.setStyle(e.style), this._onPropertyChange = s.bind(this.onPropertyChange, this), this._onHover = s.bind(this.onMouseevent, this, "mouseover"), this._onMouseout = s.bind(this.onMouseevent, this, "mouseout")
        }

        function r(e) {
            this.setOptions(e), this.properties || (this.properties = {}), this.geometry.geom.on("mouseover", s.bind(this.onMouseEvent, this, "mouseover")), this.geometry.geom.on("mouseout", s.bind(this.onMouseEvent, this, "mouseout"))
        }

        function o(e, t) {
            var i = u(e, t);
            if (null == i) return [];
            s.isArray(i) || (i = [i]);
            var r = [];
            return s.each(i, function(e) {
                var t = new n.Feature({
                    geometry: new a(e),
                    properties: e.get("geojsonProperties")
                });
                r.push(t)
            }), r
        }

        function a(e) {
            this.geom = e
        }
        var s = e("underscore"),
            l = e("util"),
            h = e("./MVCObject"),
            u = e("../GeoJSON"),
            d = e("./LatLngBounds");
        t.exports = n, l.inherits(n, h);
        var c = n.prototype;
        n.Feature = r, c.addGeoJson = function(e, t) {
            var i = o(e, t);
            return s.each(i, function(e) {
                this.add(e)
            }, this), i
        }, c.getBounds = function() {
            var e = new d;
            return s.each(this.features, function(t) {
                e.union(t.geometry.getBounds())
            }), e
        }, c.removeAllFeatures = function() {
            s.each(this.features, s.bind(this.remove, this))
        }, c.setMap = function(e) {
            this.map = e, s.each(this.features, function(t) {
                t.geometry.setMap(e)
            })
        }, c.add = function(e) {
            e.on("setproperty", this._onPropertyChange), e.on("removeproperty", this._onPropertyChange), this.features.push(e), this.revertStyle(e), e.geometry.setMap(this.map), e.on("mouseover", this._onHover), e.on("mouseout", this._onMouseout)
        }, c.onPropertyChange = function(e) {
            e.styleOverridden || e.geometry.setStyle(this.style(e))
        }, c.onMouseevent = function(e, t) {
            this.emit(e, t)
        }, c.remove = function(e) {
            e.removeListener("setproperty", this._onPropertyChange), e.removeListener("removeproperty", this._onPropertyChange), e.removeListener("mouseover", this._onHover), e.removeListener("mouseout", this._onMouseout), this.features = s.without(this.features, e), e.geometry.setMap(null)
        }, c.setStyle = function(e) {
            if (!s.isFunction(e) && s.isObject(e)) {
                var t = s.clone(e);
                e = function() {
                    return t
                }
            }
            s.isFunction(e) ? this.style = e : this.style = function() {
                return {}
            }
        }, c.overrideStyle = function(e, t) {
            e.geometry.setStyle(t), e.styleOverridden = !0
        }, c.revertStyle = function(e) {
            e.styleOverridden = !1, e.geometry.setStyle(this.style(e))
        }, l.inherits(r, h), r.prototype.onMouseEvent = function(e, t) {
            this.emit(e, s.extend(t, {
                feature: this
            }))
        }, r.prototype.setProperty = function(e, t) {
            null == t ? this.removeProperty(e) : (this.properties[e] = t, this.emit("setproperty", this))
        }, r.prototype.removeProperty = function(e) {
            delete this.properties[e], this.emit("removeproperty", this)
        }, r.prototype.getProperty = function(e) {
            return this.properties[e]
        }, a.prototype.getType = function() {
            return this.geom.getType()
        }, a.prototype.getBounds = function() {
            var e = new d,
                t = this.geom;
            if ("Marker" == t.getType()) e.extend(t.getPosition());
            else if ("Polygon" == t.getType()) {
                var i = t.getPaths();
                i.forEach(function(t) {
                    t.forEach(function(t) {
                        e.extend(t)
                    })
                })
            } else if ("Polyline" == t.getType()) {
                var n = t.getPath();
                n.forEach(function(t) {
                    e.extend(t)
                })
            } else "Circle" == t.getType() ? e.extend(t.getCenter()) : "Rectangle" == t.getType() && e.union(t.getBounds());
            return e
        }, a.prototype.setMap = function(e) {
            this.geom.setMap(e)
        }, a.prototype.setStyle = function(e) {
            this.geom.setOptions(e)
        }
    }, {
        "../GeoJSON": 217,
        "./LatLngBounds": 234,
        "./MVCObject": 236,
        underscore: 207,
        util: 212
    }],
    227: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._type = "details", e = e || {}, o.defaults(e, {
                refreshPeriod: 200,
                zoom: 16,
                maxDistance: 7500,
                queryMaxAgeInS: 43200,
                spawnAnimDurationMS: 1e3,
                easing: a.easing.easeOutExpo,
                useExclusionZones: !1,
                ignoreStartDate: !1
            }), this._enter2dCbk = o.bind(this.disable, this), this._enter3dCbk = o.bind(this.enable, this), this._reloadCbk = o.bind(this._reload, this), this._onTileElevationsUpdatedCbk = o.bind(this._onTileElevationsUpdated, this), this._onPreRenderCbk = o.bind(this._onPreRender, this), this._handleItemVisibilityOnCameraChangedCbk = o.bind(this.handleItemVisibilityOnCameraChanged, this), this._mapEvents = new x, this._windLayerEvents = new x, this._tilesMapping = {}, this._tilesInfo = {}, this._detailsCreationDurationMs = 0, this._pendingTileElevationsUpdates = {}, this._elevationHelper = new c, this.on("tile", o.bind(this.handleTile, this)), this.on("details_changed", o.bind(this._reload, this)), this._animationOptions = {
                duration: e.spawnAnimDurationMS,
                easing: e.easing
            }, s.call(this, e), o.each(y, function(e, t) {
                this.on(t.toLowerCase() + "_changed", o.bind(this._updateConfigAndReload, this))
            }, this), this.individualDetailCount = 0, this._maxDistancesForCategories = {}, o.each(y, function(e, t) {
                e.maxDistance && (this._maxDistancesForCategories[t] = e.maxDistance)
            }, this), this._handleVisibilityCallback = o.bind(this.handleItemVisibility, this), this._maxDistancesForCategories.fence = this._maxDistancesForCategories.barrier
        }
        var r = e("util"),
            o = e("underscore"),
            a = e("jquery"),
            s = e("./layers/GridLayer"),
            l = e("../graphic/details/DetailsHelper"),
            h = e("../graphic/details/DetailsCategories"),
            u = e("../graphic/details/DetailsFilters"),
            d = e("../graphic/details/DetailsGenerator"),
            c = e("../graphic/details/DetailsElevationHelper"),
            f = e("engine").Vector3,
            p = e("engine").ShapeUtils,
            m = e("../utils/TileHelper"),
            g = e("wellknown"),
            _ = e("../graphic/GeojsonHelper"),
            v = e("./MVCObject"),
            y = e("../graphic/details/DefaultDetailsConfiguration"),
            b = e("./weather/WindLayer"),
            x = e("../utils/EventPack");
        t.exports = n, r.inherits(n, s), n.DefaultDetailsConfiguration = y;
        var w = n.prototype;
        v.createProperty(w, "details"), o.each(y, function(e, t) {
            v.createProperty(w, t)
        });
        var M = s.prototype;
        w.handleItemVisibilityOnCameraChanged = function() {
            o.each(this._tilesMapping, function(e) {
                o.each(e, function(e) {
                    this.handleItemVisibility(e)
                }, this)
            }, this)
        }, w.setTarget = function(e, t) {
            e || null == this._backupWorkOnMove ? e && (this._backupWorkOnMove = this.workOnMove, this.setWorkOnMove(t)) : (this.setWorkOnMove(this._backupWorkOnMove), delete this._backupWorkOnMove), M.setTarget.call(this, e), this.forceUpdateTiles()
        }, w.setWorkOnMove = function(e) {
            if (this.map) {
                var t = this.map.conf.get("downloads.details.priority"),
                    i = this.map._renderer._featuresRequestManager.priorityRequests.getPriorityRequest(t);
                i.workOnMove = e, this.workOnMove = e, this._detailsHelper && this._detailsHelper.detailsPackProcessor.setWorkOnMove(e)
            }
        }, w._getCameraTileDistance = function(e) {
            var t = this.map._renderer,
                i = this._tilesInfo[e];
            if (!i) return console.warn("unknown tilesInfo for ", e), 0;
            var n = t.getPosCamera(),
                r = i.tilePosition,
                o = r.clone().subSelf(n).normalize().multiplyScalar(i.tileRadius),
                a = r.clone().subSelf(o),
                s = a.clone().subSelf(n);
            return s.length()
        }, w._getDefaultDetails = function(e) {
            return o.filter(o.values(h), function(t) {
                return null == e || !1 !== e.conf.get("details." + t)
            }, this)
        }, w._getDetailsConfiguration = function() {
            var e = this,
                t = {};
            return o.each(y, function(i, n) {
                    n in e && (i = o.isObject(i) ? o.defaults(e[n], i) : e[n]), t[n] = i
                }), t.workOnMove = this.map._renderer.conf.get("downloads.details.workOnMove") || this.workOnMove, t.useExclusionZones = this.options.useExclusionZones,
                t
        }, w.onDivRemoved = function() {
            this._detailsHelper && this._detailsHelper.release()
        }, w.handleUnsetMap = function() {
            this._detailsHelperInitialized = !1, s.prototype.handleUnsetMap.call(this);
            var e = this.map && this.map.conf.get("enableWebGL");
            e && (this.workOnMove = !1, this.bindListeners("removeListener")), this.options && delete this.options.map, this.setEnabled(!1), this._mapEvents.removeAllListeners(), this._removeWindLayer()
        }, w._buildExclusionZones = function() {
            var e = this.map.getExclusionZones(),
                t = this.options.zoom;
            this._tileExclusionZones = {}, o.each(e, function(e) {
                for (var i = 0; i < e.length; i++) {
                    var n = e[i],
                        r = n.id,
                        o = n.boundingBox,
                        a = m.generateKey(m.sphericalMercatorToTile(o.minX, o.minY, t)),
                        s = m.generateKey(m.sphericalMercatorToTile(o.maxX, o.minY, t)),
                        l = m.generateKey(m.sphericalMercatorToTile(o.minX, o.maxY, t)),
                        h = m.generateKey(m.sphericalMercatorToTile(o.maxX, o.maxY, t)),
                        u = this._tileExclusionZones[a];
                    null == u && (u = this._tileExclusionZones[a] = {}), u[r] = n;
                    var d = this._tileExclusionZones[s];
                    null == d && (d = this._tileExclusionZones[s] = {}), d[r] = n;
                    var c = this._tileExclusionZones[l];
                    null == c && (c = this._tileExclusionZones[l] = {}), c[r] = n;
                    var f = this._tileExclusionZones[h];
                    null == f && (f = this._tileExclusionZones[h] = {}), f[r] = n
                }
            }, this)
        }, w._expandExclusionData = function(e, t) {
            for (var i = [], n = {
                    minX: 9999999,
                    maxX: -9999999,
                    minY: 9999999,
                    maxY: -9999999
                }, r = e.footprint, o = 0; o < r.length; o++) {
                var a = r[o],
                    s = p.expandRing(a, t);
                i.push(s);
                for (var l = s.shapePts, h = 0; h < l.length; h++) {
                    var u = l[h];
                    n.minX = Math.min(n.minX, u.x), n.maxX = Math.max(n.maxX, u.x), n.minY = Math.min(n.minY, u.y), n.maxY = Math.max(n.maxY, u.y)
                }
            }
            var d = {
                footprint: i,
                boundingBox: n
            };
            return d
        }, w._initDetailsHelpers = function() {
            var e = this.map._renderer;
            this._detailsHelper && this._detailsHelper.release(), this._detailsConfiguration = this._getDetailsConfiguration(), this._detailsGenerator = new d(o.extend({
                ignoreStartDate: this.ignoreStartDate
            }, this._detailsConfiguration), this._tileExclusionZones), this._detailsHelper = new l(e, this._detailsConfiguration), this._detailsHelperInitialized = !0
        }, w.setOptions = function(e) {
            null != e.workOnMove && this.setWorkOnMove(e.workOnMove), M.setOptions.call(this, e)
        }, w.handleSetMap = function() {
            !this.map || "details" in this || this.setDetails(this._getDefaultDetails(this.map)), s.prototype.handleSetMap.call(this);
            var e = this.map && this.map.conf.get("enableWebGL");
            this.setEnabled(e), e && (this.setWorkOnMove(this.options.workOnMove || this.map.conf.get("downloads.details.workOnMove")), this._distanceFilteringEnabled = this.map.conf.get("details.distanceFilteringEnabled"), this.buildRequestOptions(), this.bindListeners("on"), this._mapEvents.on(this.map, "layeradd", o.bind(this._onLayerAdd, this)), this._mapEvents.on(this.map, "layerremove", o.bind(this._onLayerRemove, this)), this.map._renderer.isIn3d() ? this.enable() : this.disable()), this._findWindLayer()
        }, w.bindListeners = function(e) {
            var t = this.map && this.map._renderer;
            t && (t[e]("enter2d", this._enter2dCbk), t[e]("enter3d", this._enter3dCbk), t[e]("cameraChanged", this._handleItemVisibilityOnCameraChangedCbk), this.map[e]("elevation_changed", this._reloadCbk), t[e]("preRender", this._onPreRenderCbk), this.map[e]("exclusionZones_changed", this._reloadCbk))
        }, w.buildRequestOptions = function() {
            function e(e, t) {
                -1 != r.indexOf(e) && (t[e] = u[e])
            }
            this._requestsOptions = [];
            var t = {},
                i = {},
                n = {},
                r = this.details;
            e(h.FOUNTAIN, t), e(h.SCRUB, n), e(h.TREE, n), e(h.ROCK, t), e(h.VINEYARD, n), e(h.SCULPTURE, t), e(h.STREET_LAMP, t), e(h.FLAG, t), e(h.BARRIER, i), e(h.FENCE, i), e(h.WIND_GENERATOR, t), e(h.PETROLEUM_WELL, t), e(h.CRANE, n), e(h.POWER_LINE, t), e(h.POWER_POLE, t), e(h.POWER_TOWER, t), e(h.AERIAl_PYLON, t), e(h.AERIAl_LINE, t), e(h.LIGHTHOUSE, t), e(h.CEMETERY, n), e(h.BOAT, t), e(h.SUBMARINE, t), e(h.CAR, t), e(h.BUS, t), o.isEmpty(t) || this._requestsOptions.push({
                union: t,
                uncut: !1
            }), o.isEmpty(i) || this._requestsOptions.push({
                union: i,
                uncut: !0
            }), o.isEmpty(n) || this._requestsOptions.push({
                union: n,
                uncut: !1,
                removeInnerStuff: !0
            })
        }, w._updateConfigAndReload = function() {
            this.map && this._detailsHelperInitialized && this._reload()
        }, w._reload = function() {
            this.map && (this.releaseAllTiles(), this._buildExclusionZones(), this._initDetailsHelpers(), this.buildRequestOptions(), this.forceUpdateTiles(), this._applyWind())
        }, w._onPreRender = function() {
            this._updateElevations()
        }, w._onTileElevationsUpdated = function(e, t) {
            o.each(this._tiles, function(i) {
                var n = i.id,
                    r = this._tilesMapping[n];
                if (r) {
                    var o = i.bounds.xMin > t.xMax || i.bounds.xMax < t.xMin || i.bounds.yMax < t.yMin || i.bounds.yMin > t.yMax;
                    o || (this.isElevationDirty = !0, this._pendingTileElevationsUpdates[n] || (this._pendingTileElevationsUpdates[n] = {
                        tile: i,
                        elevationsTiles: {}
                    }), this._pendingTileElevationsUpdates[n].elevationsTiles[e] = t)
                }
            }, this)
        }, w.disable = function() {
            var e = this.map._renderer.getScene();
            e.remove(e.detailsParent), this.map._renderer.forceUpdateShadow()
        }, w.enable = function() {
            if (this.map) {
                var e = this.map._renderer.getScene();
                e.add(e.detailsParent)
            }
        }, w.getRequest = function(e, t) {
            var i = {
                params: {
                    maxage: this.queryMaxAgeInS,
                    queries: t,
                    type: ["point", "line", "polygon"]
                },
                serverName: "geo",
                fullQueryString: "queries/details",
                processData: o.bind(this.processData, this),
                postProcessData: o.bind(this.postProcessData, this),
                groupPostProcess: !0,
                priority: this.map.conf.get("downloads.details.priority"),
                bounds: e.bounds,
                center: e.center,
                tileKey: e.id
            };
            return this.map._renderer._featuresRequestManager.askTileToServer(e.coord, i)
        }, w.handleTile = function(e) {
            if (this._detailsHelperInitialized || this._initDetailsHelpers(), !this._tilesMapping[e.id]) {
                this._tilesMapping[e.id] = {};
                var t = m.getTileCoordFromTileKey(e.id),
                    i = m.getTileBounds(t),
                    n = .707 * Math.max(i.xMax - i.xMin, Math.max(i.yMax - i.yMin)),
                    r = m.getTileCenter(t),
                    a = new f(r.x, r.y, 0);
                this._tilesInfo[e.id] = {
                    tileRadius: n,
                    tilePosition: a
                };
                var s = this.getRequest(e, this._requestsOptions);
                e.detailsRequest = s, e.on("released", o.bind(function() {
                    s.abort(), o.each(this._tilesMapping[e.id], function(e) {
                        this._detailsHelper.unloadItem(e)
                    }, this), delete this._tilesMapping[e.id], delete this._tilesInfo[e.id]
                }, this))
            }
        }, w.isCacheable = function(e) {
            return e.detailsRequest.received
        }, w.processData = function(e, t) {
            var i = Date.now();
            this.individualDetailCount++;
            var n = t.tileKey,
                r = m.getTileCoordFromTileKey(n),
                o = m.getTileBounds(r),
                a = .707 * Math.max(o.xMax - o.xMin, Math.max(o.yMax - o.yMin)),
                s = m.getTileCenter(r),
                l = new f(s.x, s.y, 0),
                h = e.queryName,
                u = e.osm_id;
            if ("fence" != e.queryName && "barrier" != e.queryName || !this.detailExistsInAnotherTile(u, h, n)) {
                var d = null;
                e.geojsonGeometry = g(e.way);
                var c = !1;
                if (e.geojsonGeometry && (e.bounds = _.getGeometryBounds(e.geojsonGeometry), e.pos = {
                        x: (e.bounds.left + e.bounds.right) / 2,
                        y: (e.bounds.bottom + e.bounds.top) / 2
                    }, d = this._tilesMapping[n][h], !this.detailExistsAlready(e.pos, d))) {
                    var p = this._getCameraTileDistance(n),
                        v = this._maxDistancesForCategories[h];
                    v && this._distanceFilteringEnabled || (v = 1e5), d || (d = {
                        id: n + "||" + h,
                        detailCategory: h,
                        generators: [],
                        osmIds: [],
                        bounds: e.bounds,
                        tilePosition: l,
                        tileBounds: o,
                        tileRadius: a,
                        tileKey: n,
                        isItemVisibleWithinDistance: v > p,
                        maxVisibleDistance: 1.2 * v,
                        handleVisibilityCallback: this._handleVisibilityCallback
                    }, this._tilesMapping[n][h] = d, c = !0), d.osmIds.push(u), this._detailsGenerator.addItemGenerators(this.map._renderer, e, h, d.generators, n), this.enlargeTileBounds(n, e.bounds)
                }
                var y = Date.now();
                return this._detailsCreationDurationMs += y - i, c ? d : null
            }
        }, w.detailExistsInAnotherTile = function(e, t, i) {
            var n = o.find(this._tilesMapping, function(n, r) {
                    if (r != i && n[t]) {
                        var a = o.find(n[t].osmIds, function(t) {
                            return e == t
                        });
                        return void 0 != a
                    }
                    return !1
                }),
                r = void 0 != n;
            return r
        }, w.detailExistsAlready = function(e, t) {
            if (null != t && t.generators.length > 0)
                for (var i = 0; i < t.generators.length; i++) {
                    var n = t.generators[i];
                    if (n.position.x == e.x && n.position.y == e.y) return !0
                }
            return !1
        }, w.handleItemVisibility = function(e) {
            var t = this._getCameraTileDistance(e.tileKey);
            e.isItemVisibleWithinDistance = t < e.maxVisibleDistance, this._detailsHelper.updateMeshsItemVisibility(e)
        }, w.postProcessData = function(e, t) {
            function i() {
                if (s.map) {
                    var i = Date.now();
                    o.each(e, function(e) {
                        var i = e.detailCategory;
                        i == h.POWER_TOWER || i == h.AERIAl_PYLON ? o.each(e.generators, function(e) {
                            e.rotation = r.getPointOrientation(e.position, i, t.tileKey)
                        }) : i == h.TREE && a.updateItemWithLodVisibility(e), e.animationOptions = n, a.loadItem(e)
                    }), r.onTileGenerated(t.tileKey);
                    var l = Date.now();
                    s._detailsCreationDurationMs += l - i
                }
            }
            var n = this._animationOptions,
                r = this._detailsGenerator,
                a = this._detailsHelper,
                s = this;
            a.onReady(i)
        }, w.canWork = function() {
            return s.prototype.canWork.call(this) ? this.workOnMove ? !0 : !this.map._renderer.isMoving() && this.map._renderer.isIn3d() : !1
        }, w.createSmokeMesh = function(e, t, i) {
            return this._detailsHelper ? this._detailsHelper.createSmokeMesh(e, t, i) : void console.warn("missing detailsLayer for buildings")
        }, w.resetCreationDuration = function() {
            this._detailsCreationDurationMs = 0
        }, w.getCreationDurationMs = function() {
            return this._detailsCreationDurationMs
        }, w.resetDetailCount = function() {
            this.individualDetailCount = 0
        }, w._updateElevations = function() {
            if (this.map.elevation && this.isElevationDirty && this.canWork()) {
                var e = [];
                o.each(this._pendingTileElevationsUpdates, function(t, i) {
                    var n = this._tilesMapping[i];
                    n ? (e.push(i), o.each(n, function(e, t) {
                        this._elevationHelper.updateElevations(t, e, this.map._renderer)
                    }, this)) : e.push(i)
                }, this), o.each(e, function(e) {
                    delete this._pendingTileElevationsUpdates[e]
                }, this), this.isElevationDirty = o.size(this._pendingTileElevationsUpdates) > 0
            }
        }, w.getDetailsUsageByTile = function() {
            var e = {},
                t = {};
            e.tiles = t;
            var i = 0,
                n = 0,
                r = 0,
                a = 0,
                s = 0,
                l = 0,
                u = {};
            return o.each(this._tilesMapping, function(e, d) {
                var c = {},
                    f = {};
                c.meshes = f, o.each(h, function(t) {
                    var h = 0,
                        d = 0,
                        c = 0,
                        p = 0,
                        m = 0,
                        g = 0,
                        _ = e[t];
                    if (_) {
                        _.meshs && (h = _.meshs.length, i += h, o.each(_.meshs, function(e) {
                            e.visible && (p++, a++)
                        })), _.lodMeshs && (d = _.lodMeshs.length, n += d, o.each(_.lodMeshs, function(e) {
                            e.visible && (m++, s++)
                        })), _.animatedMeshs && (c = _.animatedMeshs.length, r += c, o.each(_.animatedMeshs, function(e) {
                            e.visible && (g++, l++)
                        }));
                        var v = h + d + c,
                            y = p + m + g;
                        if (v > 0) {
                            var b = u[t];
                            b ? (b.allMeshCount += v, b.allVisibleMeshCount += y, u[t] = b) : u[t] = {
                                allMeshCount: v,
                                allVisibleMeshCount: y
                            }
                        }
                    }
                    f[t] = {
                        meshCount: h,
                        lodMeshCount: d,
                        animMeshCount: c,
                        visibleMeshCount: p,
                        visibleLodMeshCount: m,
                        visibleAnimMeshCount: g
                    }
                }, this), t[d] = c
            }), e.totals = {
                numberOfTiles: o.size(this._tilesMapping),
                numberOfCategoryTypes: u.length,
                categoriesUsage: u,
                totalMeshCount: i,
                totalLodMeshCount: n,
                totalAnimMeshCount: r,
                totalVisibleMeshCount: a,
                totalVisibleLodMeshCount: s,
                totalVisibleAnimMeshCount: l,
                allCategories: o.values(h)
            }, e
        }, w.printDebugUsage = function() {
            if (this.map) {
                var e = o.size(this._tilesMapping),
                    t = 0,
                    i = 0,
                    n = 0,
                    r = 0,
                    a = [],
                    s = [];
                o.each(this._tilesMapping, function(e, l) {
                    console.log("Tile " + l + ":"), t += o.size(e);
                    var h = 0,
                        u = 0,
                        d = 0;
                    o.each(e, function(e, t) {
                        o.contains(s, t) || s.push(t), e.meshs && (h = e.meshs.length, i += h, o.each(e.meshs, function(e) {
                            e.geometry && !o.contains(a, e.geometry.id) && a.push(e.geometry.id)
                        })), e.lodMeshs && (u = e.lodMeshs.length, n += u, o.each(e.lodMeshs, function(e) {
                            e.geometry && !o.contains(a, e.geometry.id) && a.push(e.geometry.id)
                        })), e.animatedMeshs && (d = e.animatedMeshs.length, r += d, o.each(e.animatedMeshs, function(e) {
                            e.geometry && !o.contains(a, e.geometry.id) && a.push(e.geometry.id)
                        })), console.log("	Category " + t + ": mesh = " + h + ", lod mesh = " + u + ", anim mesh = " + d)
                    })
                }), console.log("Details Layer:"), console.log("Number of individual details = " + this.individualDetailCount), console.log("Number of tiles = " + e + ", with number of category groups = " + t), console.log("Total number of categories = " + s.length), console.log("Number of meshes = " + i + ", LOD meshes = " + n + ", animated meshes = " + r);
                var l = this.map._renderer.getScene().detailsParent.children,
                    h = 0;
                o.each(l, function(e) {
                    e.visible && h++
                }), console.log("Total Meshes in scene = " + l.length + ", visible = " + h), console.log("Total geometries = " + a.length)
            }
        }, w.setWindDir = function(e) {
            this._detailsHelper && this._detailsHelper.setWindDir(e)
        }, w._findWindLayer = function() {
            var e = this;
            this.map.eachLayer(function(t) {
                e._onLayerAdd(t)
            })
        }, w._onLayerAdd = function(e) {
            e instanceof b && this._setWindLayer(e)
        }, w._onLayerRemove = function(e) {
            this._windLayer == e && this._removeWindLayer()
        }, w._setWindLayer = function(e) {
            this._windLayer = e, this._windLayerEvents.on(e, "speed_changed", o.bind(this._applyWind, this)), this._windLayerEvents.on(e, "heading_changed", o.bind(this._applyWind, this)), this._applyWind()
        }, w._removeWindLayer = function() {
            this._windLayerEvents.removeAllListeners(), delete this._windLayer, this._applyWind()
        }, w._applyWind = function() {
            if (this._windLayer) {
                var e = this._windLayer.getSpeed(),
                    t = Math.PI * this._windLayer.getHeading() / 180,
                    i = {
                        x: Math.sin(t) * e,
                        y: Math.cos(t) * e
                    };
                this.setWindDir(i)
            } else this.setWindDir({
                x: 0,
                y: 0
            })
        }
    }, {
        "../graphic/GeojsonHelper": 310,
        "../graphic/details/DefaultDetailsConfiguration": 333,
        "../graphic/details/DetailsCategories": 334,
        "../graphic/details/DetailsElevationHelper": 335,
        "../graphic/details/DetailsFilters": 336,
        "../graphic/details/DetailsGenerator": 337,
        "../graphic/details/DetailsHelper": 338,
        "../utils/EventPack": 403,
        "../utils/TileHelper": 411,
        "./MVCObject": 236,
        "./layers/GridLayer": 262,
        "./weather/WindLayer": 305,
        engine: 10,
        jquery: 111,
        underscore: 207,
        util: 212,
        wellknown: 213
    }],
    228: [function(e, t, i) {
        "use strict";

        function n() {}
        var r = e("./GeocoderStatus");
        t.exports = n, n.prototype.geocode = function(e, t) {
            t([], r.UNKNOWN_ERROR)
        }
    }, {
        "./GeocoderStatus": 229
    }],
    229: [function(e, t, i) {
        "use strict";
        t.exports = {
            ERROR: 1,
            INVALID_REQUEST: 2,
            OK: 3,
            OVER_QUERY_LIMIT: 4,
            REQUEST_DENIED: 5,
            UNKNOWN_ERROR: 6,
            ZERO_RESULTS: 7
        }
    }, {}],
    230: [function(e, t, i) {
        "use strict";

        function n(e) {
            a.call(this), this.id = r.uniqueId("infowindow_"), this.content = "", this.position = null, this.setOptions(e)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Overlay"),
            s = e("./LatLng"),
            l = e("./Size");
        t.exports = n, o.inherits(n, a);
        var h = n.prototype;
        a.createProperty(h, "minWidth", Number), a.createProperty(h, "maxWidth", Number), a.createProperty(h, "maxHeight", Number), a.createProperty(h, "content"), a.createProperty(h, "position", s), a.createProperty(h, "zIndex", Number), a.createProperty(h, "pixelOffset", l), h.getType = function() {
            return "InfoWindow"
        }, h.open = function(e, t) {
            this.anchor = t, this.setMap(e)
        }, h.close = function() {
            this.setMap(null), this.anchor = null
        }
    }, {
        "./LatLng": 233,
        "./Overlay": 244,
        "./Size": 250,
        underscore: 207,
        util: 212
    }],
    231: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.clickable = !0, this.preserveViewport = !1, this.screenOverlays = !0, this.suppressInfoWindows = !1, "clickable" in e && this.setClickable(e.clickable), "preserveViewport" in e && this.setPreserveViewport(e.preserveViewport), "screenOverlays" in e && this.setScreenOverlays(e.screenOverlays), "suppressInfoWindows" in e && this.setSuppressInfoWindows(e.suppressInfoWindows), "url" in e && this.setUrl(e.url), "map" in e && this.setMap(e.map)
        }

        function r(e, t) {
            h.each(e, function(e) {
                e.setMap(t)
            })
        }

        function o(e) {
            var t = "",
                i = e.geojsonProperties || {};
            i.name && (t += "<h4>" + i.name + "</h4>"), i.description && (t += i.description);
            var n = h.omit(i, ["name", "description", "styleUrl", "styleHash"]);
            return h.size(n) > 0 && (t && (t += "<br>"), t += JSON.stringify(n)), t
        }
        var a = e("util"),
            s = e("./MVCObject"),
            l = e("togeojson"),
            h = e("underscore"),
            u = e("../GeoJSON"),
            d = e("url"),
            c = e("./LatLngBounds"),
            f = e("./Point"),
            p = e("./Size"),
            m = e("./InfoWindow"),
            g = e("../utils/Ajax");
        t.exports = n, a.inherits(n, s);
        var _ = d.resolve(window.location.href, "/"),
            v = n.prototype;
        s.createProperties(v, ["clickable", "map", "preserveViewport", "screenOverlays", "suppressInfoWindows", "url", "zIndex"]), v.setMap = function(e) {
            this.map && r(this._overlays, null), this.map = e, this.map && this.initialize(this.map)
        }, v.initialize = function(e) {
            this.map == e && this.url && e && this.loadKml(this.url)
        }, v.convertKmlToGeoJson = function(e) {
            function t(e, t, i) {
                var n;
                void 0 === t[i] && (t[i] = {
                    width: 4,
                    fill: !0,
                    outline: !0
                });
                var r = e.getElementsByTagName("IconStyle");
                if (r && r.length > 0) {
                    n = r[0];
                    var s = n.getElementsByTagName("hotSpot")[0],
                        l = o(n.getElementsByTagName("scale")[0]),
                        h = 16,
                        u = 32;
                    null !== s && void 0 !== s && (h = parseInt(s.getAttribute("x"), 10), u = parseInt(s.getAttribute("y"), 10)), l && (l = parseFloat(l)), isNaN(l) && (l = 1), t[i] = {
                        href: T.toCrossDomainFriendlyUrl(o(n.getElementsByTagName("href")[0])),
                        size: {
                            width: 32,
                            height: 32
                        },
                        scale: l,
                        anchor: {
                            x: h,
                            y: u
                        }
                    }
                }
                return r = e.getElementsByTagName("LineStyle"), r && r.length > 0 && (n = r[0], t[i].color = o(n.getElementsByTagName("color")[0]), t[i].width = o(n.getElementsByTagName("width")[0])), r = e.getElementsByTagName("PolyStyle"), r && r.length > 0 && (n = r[0], t[i].color = o(n.getElementsByTagName("color")[0]), t[i].fill = a(n.getElementsByTagName("fill")[0]), t[i].outline = a(n.getElementsByTagName("outline")[0])), t[i]
            }

            function i(e) {
                e && void 0 !== e.href && "" !== e.href && (e.icon = {
                    url: e.href,
                    size: new p(e.size.width, e.size.height),
                    anchor: new f(e.anchor.x, e.anchor.y),
                    scale: e.scale
                })
            }

            function n(e) {
                var t;
                for (t in e) e.hasOwnProperty(t) && i(e[t]);
                return e
            }

            function o(e) {
                return void 0 === e || null === e ? "" : (e.innerText || e.text || e.textContent).trim()
            }

            function a(e) {
                var t = o(e);
                switch (t.toLowerCase()) {
                    case "true":
                    case "yes":
                    case "1":
                        return !0;
                    case "false":
                    case "no":
                    case "0":
                    case null:
                        return !1;
                    default:
                        return !0
                }
            }

            function s() {
                return "#" + Math.round(16777215 * Math.random()).toString(16)
            }

            function d(e) {
                var t = {};
                if (e) {
                    var i = e.substr(0, 2),
                        n = e.substr(2, 2),
                        r = e.substr(4, 2),
                        o = e.substr(6, 2);
                    t.color = "#" + o + r + n, t.opacity = parseFloat(parseInt(i, 16) / 256).toFixed(1)
                }
                return isNaN(t.opacity) && (t.color = s(), t.opacity = 1), t
            }

            function m(e) {
                var t = {
                        width: 4,
                        fill: !0,
                        outline: !0
                    },
                    i = e.get("geojsonProperties");
                return i && i.styleUrl && (t = L[i.styleUrl]), t
            }

            function g(e) {
                var t = e.get("geojsonProperties");
                if (t) {
                    t.name && e.setTitle(t.name), e.setZIndex(P++);
                    var i = m(e);
                    i.icon && e.setIcon(i.icon)
                }
            }

            function _(e) {
                var t = e.get("geojsonProperties");
                if (t) {
                    var i = m(e),
                        n = d(i.color);
                    e.setStrokeWeight(+i.width), e.setStrokeColor(n.color), e.setStrokeOpacity(+n.opacity), e.setZIndex(P++)
                }
            }

            function v(e) {
                var t = e.get("geojsonProperties");
                if (t) {
                    var i = m(e),
                        n = d(i.color);
                    e.setStrokeWeight(+i.width), e.setStrokeColor(n.color), e.setStrokeOpacity(+n.opacity), e.setFillColor(n.color), e.setFillOpacity(+n.opacity), e.setZIndex(P++)
                }
            }

            function y(e) {
                if (e.error) return console.log("error parsing KML"), [];
                var t = [];
                return h.isArray(e) ? h.each(e, function(e) {
                    t = t.concat(y(e))
                }) : t.push(e), t
            }

            function b(e) {
                h.each(e, function(e) {
                    if (D)
                        if ("Marker" == e.getType()) g(e), D.extend(e.getPosition());
                        else if ("Polygon" == e.getType()) {
                        v(e);
                        var t = e.getPaths();
                        t.forEach(function(e) {
                            e.forEach(function(e) {
                                D.extend(e)
                            })
                        })
                    } else if ("Polyline" == e.getType()) {
                        _(e);
                        var i = e.getPath();
                        i.forEach(function(e) {
                            D.extend(e)
                        })
                    } else "Circle" == e.getType() ? (v(e), D.extend(e.getCenter())) : "Rectangle" == e.getType() && (v(e), D.union(e.getBounds()))
                })
            }
            for (var x, w, M, T = this, S = e.getElementsByTagName("Style"), C = S.length, E = {}, k = 0; C > k; k++) w = S[k], M = w.getAttribute("id"), null !== M && (x = "#" + M, t(w, E, x));
            var L = n(E),
                P = 0,
                A = this.getPreserveViewport(),
                R = new u(l.kml(e, {}), {});
            if (this._overlays = y(R), this.setOverlayHandler(this._overlays), h.each(R, function(e) {
                    var t = e.get("geojsonProperties");
                    if (t && t.name) {
                        var i;
                        try {
                            i = decodeURIComponent(escape(t.name))
                        } catch (n) {
                            i = t.name
                        }
                        t.name = i
                    }
                }), this.map) {
                var D = new c;
                b(this._overlays), r(this._overlays, this.map), A || this.map.fitBounds(D)
            }
        }, v.setOverlayHandler = function(e) {
            var t = this;
            h.each(e, function(e) {
                var i = o(e);
                e.setClickable(!!i), i && e.on("click", function(n) {
                    t.lastInfoWindow && t.lastInfoWindow.close(), t.lastInfoWindow = new m({
                        content: i
                    }), "Marker" == e.getType() ? t.lastInfoWindow.open(t.map, e) : (t.lastInfoWindow.setPosition(n.latLng), t.lastInfoWindow.open(t.map))
                })
            })
        }, v.toCrossDomainFriendlyUrl = function(e) {
            return this.isLocal(e) ? e : e
        }, v.isLocal = function(e) {
            var t = d.resolve(window.location.href, e);
            return t.indexOf(_) >= 0 ? !0 : /^data:/.test(e)
        }, v.loadKml = function(e) {
            function t(t, i, n) {
                console.error("Could not load %s: %s", e, n)
            }
            if (this.map) {
                var i; - 1 == e.toLowerCase().indexOf(".kmz") && this.isLocal(e) || (i = {
                    uri: e
                }, e = "/kml");
                var n = /^data:.*base64,(.*)$/.exec(e);
                if (n) {
                    var r;
                    try {
                        r = atob(n[1])
                    } catch (o) {
                        console.error("Could not parse base64 %s", e, o)
                    }
                    if (r) {
                        var a = new DOMParser,
                            s = a.parseFromString(r, "application/xml");
                        this.convertKmlToGeoJson(s)
                    }
                } else g.download("download", {
                    url: e,
                    dataType: "xml",
                    data: i,
                    success: h.bind(this.convertKmlToGeoJson, this),
                    errorMessage: "Error loading kml " + e,
                    error: t
                })
            }
        }
    }, {
        "../GeoJSON": 217,
        "../utils/Ajax": 397,
        "./InfoWindow": 230,
        "./LatLngBounds": 234,
        "./MVCObject": 236,
        "./Point": 246,
        "./Size": 250,
        togeojson: 203,
        underscore: 207,
        url: 208,
        util: 212
    }],
    232: [function(e, t, i) {
        "use strict";
        t.exports = {
            DOCUMENT_NOT_FOUND: 1,
            DOCUMENT_TOO_LARGE: 2,
            FETCH_ERROR: 3,
            INVALID_DOCUMENT: 4,
            INVALID_REQUEST: 5,
            LIMITS_EXCEEDED: 6,
            OK: 7,
            TIMED_OUT: 8,
            UNKNOWN: 9
        }
    }, {}],
    233: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            return e > i ? i : t > e ? t : e
        }

        function r(e, t, i) {
            var n = i - t,
                r = e % n;
            return t > r ? r += n : r > i && (r -= n), r
        }

        function o(e, t, i) {
            this._lat = +e, this._lng = +t, i || (this._lat = n(this._lat, -90, 90), this._lng = r(this._lng, -180, 180))
        }

        function a(e, t) {
            return s.numberFormat(e, t, ".", "")
        }
        var s = e("underscore"),
            l = e("mercatorProjection");
        t.exports = o, o.from900913 = function(e, t, i) {
            var n = l.convertLon900913To4326(t),
                r = l.convertLat900913To4326(e);
            return new o(r, n, i)
        }, o.convert = function(e) {
            if (e instanceof o) return e;
            if (s.isObject(e) && s.isNumber(e.lat) && s.isNumber(e.lng)) return new o(e.lat, e.lng);
            if (s.isObject(e) && s.isNumber(e.lat) && s.isNumber(e.lon)) return new o(e.lat, e.lon);
            if (s.isArray(e) && 2 == e.length) return new o(e[0], e[1]);
            throw new Error("invalid LatLng or LatLngLiteral object")
        }, o.prototype.to900913 = function() {
            return console.warn("LatLng#to900913 is a private function and will be removed"), console.trace(), this._to900913()
        }, o.prototype._to900913 = function() {
            return {
                lon: l.convertLon4326To900913(this._lng),
                lat: l.convertLat4326To900913(this._lat)
            }
        }, o.prototype.equals = function(e) {
            return e = o.convert(e), this._lat == e._lat && this._lng == e._lng
        }, o.prototype.lat = function() {
            return this._lat
        }, o.prototype.lng = function() {
            return this._lng
        }, o.prototype.toString = function() {
            return "(" + this._lat + ", " + this._lng + ")"
        }, o.prototype.toGeoJSON = function() {
            return {
                type: "Point",
                coordinates: [this._lng, this._lat]
            }
        }, o.prototype.toUrlValue = function(e) {
            return null == e && (e = 6), a(this._lat, e) + "," + a(this._lng, e)
        }
    }, {
        mercatorProjection: 147,
        underscore: 207
    }],
    234: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.sw = null == e ? null : o.convert(e), this.ne = null == t ? null : o.convert(t)
        }

        function r(e, t) {
            return null == e || null == t ? e == t : e.equals(t)
        }
        var o = e("./LatLng"),
            a = e("../utils/Types");
        t.exports = n;
        var s = n.prototype;
        s.contains = function(e) {
            return e = o.convert(e), this.isEmpty() ? !1 : e.lng() >= this.sw.lng() && e.lng() <= this.ne.lng() && e.lat() >= this.sw.lat() && e.lat() <= this.ne.lat()
        }, s.equals = function(e) {
            return null == e ? !1 : (a.check(n, e), r(this.sw, e.sw) && r(this.ne, e.ne))
        }, s.extend = function(e) {
            if (e = o.convert(e), this.isEmpty()) this.ne = this.sw = e;
            else {
                var t = Math.min(this.sw.lat(), e.lat()),
                    i = Math.min(this.sw.lng(), e.lng()),
                    n = Math.max(this.ne.lat(), e.lat()),
                    r = Math.max(this.ne.lng(), e.lng());
                this.sw = new o(t, i), this.ne = new o(n, r)
            }
            return this
        }, s.getCenter = function() {
            return this.isEmpty() ? null : new o((this.sw.lat() + this.ne.lat()) / 2, (this.sw.lng() + this.ne.lng()) / 2)
        }, s.getNorthEast = function() {
            return this.ne
        }, s.getSouthWest = function() {
            return this.sw
        }, s.intersects = function(e) {
            return a.check(n, e), this.isEmpty() || e.isEmpty() ? !1 : this.sw.lng() <= e.ne.lng() && e.sw.lng() <= this.ne.lng() && this.sw.lat() <= e.ne.lat() && e.sw.lat() <= this.ne.lat()
        }, s.isEmpty = function() {
            return null == this.sw && null == this.ne
        }, s.toSpan = function() {
            var e = 0,
                t = 0;
            return this.isEmpty() || (e = this.ne.lat() - this.sw.lat(), t = this.ne.lng() - this.sw.lng()), new o(e, t)
        }, s.distanceTo = function(e) {
            function t(e) {
                function t(e, t) {
                    return e.x1 - t.x1
                }
                for (var i, n, r = e.length - 1, o = new Array(r), a = 0; r > a; ++a) i = e[a], n = e[a + 1], i.lon < n.lon ? o[a] = {
                    x1: i.lon,
                    y1: i.lat,
                    x2: n.lon,
                    y2: n.lat
                } : o[a] = {
                    x1: n.lon,
                    y1: n.lat,
                    x2: i.lon,
                    y2: i.lat
                };
                return o.sort(t)
            }

            function i(e, t) {
                var i, n, r = e.lon,
                    o = e.lat,
                    a = t.x1,
                    s = t.y1,
                    l = t.x2,
                    h = t.y2,
                    u = l - a,
                    d = h - s,
                    c = (u * (r - a) + d * (o - s)) / (Math.pow(u, 2) + Math.pow(d, 2));
                return 0 >= c ? (i = a, n = s) : c >= 1 ? (i = l, n = h) : (i = a + c * u, n = s + c * d), {
                    distance: Math.sqrt(Math.pow(i - r, 2) + Math.pow(n - o, 2)),
                    x: i,
                    y: n
                }
            }

            function n(e, n) {
                for (var r, o, a = {}, s = Number.POSITIVE_INFINITY, l = t(e), h = n.lon, u = n.lat, d = 0, c = l.length; c > d; ++d)
                    if (o = l[d], r = i(n, o), r.distance < s) {
                        if (s = r.distance, a = r, 0 === s) break
                    } else if (o.x2 > h && (u > o.y1 && u < o.y2 || u < o.y1 && u > o.y2)) break;
                return a = a.distance
            }
            e = o.convert(e);
            var r = e._to900913(),
                a = this.getNorthEast()._to900913(),
                s = this.getSouthWest()._to900913(),
                l = {
                    lon: s.lon,
                    lat: s.lat
                },
                h = {
                    lon: s.lon,
                    lat: a.lat
                },
                u = {
                    lon: a.lon,
                    lat: a.lat
                },
                d = {
                    lon: a.lon,
                    lat: s.lat
                },
                c = [l, h, u, d, l];
            return n(c, r)
        }, s.toString = function() {
            return "(" + this.sw.toString() + "," + this.ne.toString() + ")"
        }, s.toUrlValue = function(e) {
            return null != e && a.check(Number, e), this.sw.toUrlValue(e) + "," + this.ne.toUrlValue(e)
        }, s.union = function(e) {
            return a.check(n, e), e.isEmpty() || (this.extend(e.getNorthEast()), this.extend(e.getSouthWest())), this
        }
    }, {
        "../utils/Types": 412,
        "./LatLng": 233
    }],
    235: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._array = e || [], this._updateLength()
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./MVCObject");
        t.exports = n, o.inherits(n, a);
        var s = n.prototype;
        s._updateLength = function() {
            this.length = this._array.length
        }, s.clear = function() {
            var e = this._array;
            this._array = [], r.each(e, function(e, t) {
                this.emit("remove_at", t, e)
            }, this), this._updateLength()
        }, s.forEach = function(e) {
            r.each(this._array, e)
        }, s.getArray = function() {
            return this._array
        }, s.getAt = function(e) {
            return this._array[e]
        }, s.getLength = function() {
            return this._array.length
        }, s.insertAt = function(e, t) {
            this._array.splice(e, 0, t), this._updateLength(), this.isDirty = !0, this.emit("insert_at", e), this.isDirty = !1
        }, s.pop = function() {
            var e = this._array.pop();
            this._updateLength();
            var t = this._array.length;
            return this.isDirty = !0, this.emit("remove_at", t, e), this.isDirty = !1, e
        }, s.push = function(e) {
            var t = this._array.push(e);
            return this._updateLength(), this.isDirty = !0, this.emit("insert_at", t - 1), this.isDirty = !1, t
        }, s.removeAt = function(e) {
            var t = this._array[e];
            return this._array.splice(e, 1), this._updateLength(), this.isDirty = !0, this.emit("remove_at", e, t), this.isDirty = !1, t
        }, s.setAt = function(e, t) {
            var i = this._array[e];
            this._array[e] = t, this.isDirty = !0, this.emit("set_at", e, i), this.isDirty = !1
        }
    }, {
        "./MVCObject": 236,
        underscore: 207,
        util: 212
    }],
    236: [function(e, t, i) {
        "use strict";

        function n() {}

        function r(e, t) {
            u.each(t, function(t) {
                o(e, t)
            })
        }

        function o(e, t, i) {
            var n = u.str.capitalize(t),
                r = "set" + n,
                o = "get" + n;
            if (i && i.convert) e[r] = function(e) {
                null != e && (e = i.convert(e)), this.set(t, e)
            };
            else if (i) {
                var a = c.getCheckFunction(i);
                e[r] = function(e) {
                    a(e), this.set(t, e)
                }
            } else e[r] = function(e) {
                this.set(t, e)
            };
            e[o] = function() {
                return this.get(t)
            }
        }

        function a(e, t) {
            return e === t || null != e && null != t && u.isFunction(e.equals) && e.equals(t)
        }

        function s(e) {
            return e.toLowerCase() + "_changed"
        }
        var l = e("util"),
            h = e("events").EventEmitter,
            u = e("underscore");
        u.str = e("underscore.string");
        var d = e("./event"),
            c = e("../utils/Types");
        t.exports = n, l.inherits(n, h);
        var f = n.prototype;
        f.type = "MVCObject", n.createProperty = o, n.createProperties = r, f.addListener = function(e, t) {
            return d.addListener(this, e, t)
        }, f._oneWayBindTo = function(e, t, i, n) {
            var r = this._bindings = this._bindings || {};
            r[e] && this.unbind(e);
            var o = u.bind(function() {
                    var r = t.get(i);
                    n ? this[e] = this : this.set(e, r)
                }, this),
                a = t.addListener(s(i), o);
            r[e] = {
                listener: a,
                target: t,
                targetKey: i
            }, o()
        }, f.bindTo = function(e, t, i, n) {
            null == i && (i = e), this._oneWayBindTo(e, t, i, n), t._oneWayBindTo(i, this, e, n)
        }, f.changed = function(e) {}, f.get = function(e) {
            return this[e]
        }, f.notify = function(e) {
            this.changed(e);
            var t = e + "_changed",
                i = s(e),
                n = this[t];
            if (n) n.call(this);
            else {
                var r = this[i];
                r && r.call(this)
            }
            this.emit(i)
        }, f.set = function(e, t) {
            var i = this[e];
            this[e] = t, a(i, t) || this.notify(e)
        }, f.setValues = function(e) {
            null != e && u.each(e, function(e, t) {
                this.set(t, e)
            }, this)
        }, f.setOptions = f.setValues, f._oneWayUnbind = function(e) {
            var t = this._bindings = this._bindings || {},
                i = t[e];
            i && (delete t[e], this[i.key] = i.target.get(i.targetKey), d.removeListener(i.listener))
        }, f.unbind = function(e) {
            var t = this._bindings = this._bindings || {},
                i = t[e];
            i && (this._oneWayUnbind(e), i.target._oneWayUnbind(i.targetKey))
        }, f.unbindAll = function() {
            var e = u.keys(this._bindings || {});
            u.each(e, u.bind(this.unbind, this))
        }, n.keyEventName = s
    }, {
        "../utils/Types": 412,
        "./event": 256,
        events: 99,
        underscore: 207,
        "underscore.string": 206,
        util: 212
    }],
    237: [function(e, t, i) {
        "use strict";

        function n(t, i) {
            this._infoWindowsById = {}, this._markersById = {}, this._polylinesById = {}, this._polygonsById = {}, this._rectanglesById = {}, this._circlesById = {}, this._layersByType = {}, this._allLayers = [], this.setMaxListeners(0), i = s.defaults(i || {}, {
                elevation: !1,
                shadow: !0,
                ssao: !0,
                ssaoWhenMoving: !1,
                waterRipple: !0,
                waterReflection: !1,
                qualityOnlyNearGround: !1,
                useDevicePixelRatio: !1,
                minZoomLayer2D: 15,
                debugExtraKeys: !1,
                skipWorkIn3d: !1,
                enableWebGLBenchmarkTest: !1,
                depthMap: !1,
                sideBySide: !1,
                topToBottom: !1,
                enabled: !0,
                touchDragDialogEnabled: !0,
                sun: {
                    azimuth: 150,
                    altitude: 45
                }
            }), i.center && (i.center = f.convert(i.center));
            var n = this._$node = a(t);
            n.empty();
            var r = n.css("position");
            if (r && "static" != r || n.css("position", "relative"), n.css({
                    overflow: "hidden"
                }), !this._$node || !this._$node.length) throw new Error("Undefined Dom element", t);
            this.mapTypeId = g.ROADMAP, this.mapTypes = new v;
            var o = this.controls = [];
            s.each(_, function(e) {
                o[e] = new d
            }), this.overlayMapTypes = new d, this.conf = c.convertOptions(i), this.conf.textureCacheSize = i.textureCacheSize, this.zoom = +this.conf.zoom, this.tilt = this.conf.camera.theta, this.heading = this.conf.camera.phi, this.center = new f(this.conf.lat, this.conf.lon), this.data = new m({
                map: this
            }), this.elevation = i.elevation, this.enabled = i.enabled, this.renderEnabled = !0, this.debugExtraZoom = i.debugExtraZoom, this.debugExtraKeys = i.debugExtraKeys, this._renderer = null, this.minZoomLayer2D = i.minZoomLayer2D;
            var l = "undefined" != typeof leafletF4,
                u = e("../utils/WebGlContextAttributes");
            if (h.supportWebGL(u) && !window.forceLeafletForDebug) {
                var p = e("../MapWebGLRenderer");
                new p(this.conf, i, this._$node, this)
            } else {
                if (!l) throw new Error("Cannot start without Leaflet loaded");
                this.conf.setDefaultAndCurrentValue("enableWebGL", !1);
                var y = e("../MapLeafRenderer");
                new y(this.conf, this._$node, this)
            }
            this._idleHandler = s.bind(this._handleIdle, this), this._enter3dHandler = s.bind(this._handleEnter3d, this), this._enter2dHandler = s.bind(this._handleEnter2d, this), this.layers = this._createLayers(), this._renderer.on("cameraStabilized", this._idleHandler), this._renderer.on("enter3d", this._enter3dHandler), this._renderer.on("enter2d", this._enter2dHandler), "scaleControl" in i || (i.scaleControl = !0);
            var b = this.conf.getUrlConfig();
            this._skipWorkIn3dHandler = s.bind(this._renderer.updateMinDtWork, this._renderer), this.on("skipworkin3d_changed", this._skipWorkIn3dHandler), this.on("usedevicepixelratio_changed", s.bind(this._renderer.setUseDevicePixelRatio, this._renderer)), this.setOptions(i, b), "mapTypeId" in i || this.setMapTypeId(this._renderer.getDefaultMapTypeIdAtZoom(this.zoom)), this._onResizeHandler = s.bind(this._resize, this, this._renderer.makeIdleEvent(!1)), a(window).resize(this._onResizeHandler), this.on("resize", this._onResizeHandler), this._onDivRemovedHandler = s.bind(this._onDivRemoved, this), a("body").on("DOMNodeRemoved", this._onDivRemovedHandler), this._exclusionZones = {}, this._initBuildingLayer(i), this.conf.get("enableWebGL") && (this.buildingLayer && this.buildingLayer.setMap(this), "detailsLayer" in i ? this.detailsLayer = i.detailsLayer : this.detailsLayer = new T, this.detailsLayer && this.detailsLayer.setMap(this))
        }

        function r(e, t, i) {
            var n = e.toLowerCase() + "_changed";
            u.createProperty(k, e, i), k[n] = function() {
                this._renderer && !this._renderer.disableApiEvent && this._renderer[t](this.get(e), this.skipUpdateCamera)
            }
        }

        function o(e, t) {
            for (var i = t; i && i.length && !i.is(e);) i = i.parent();
            return Boolean(i && i.length)
        }
        var a = e("jquery"),
            s = e("underscore"),
            l = e("util"),
            h = e("browser-detect"),
            u = e("./MVCObject"),
            d = e("./MVCArray"),
            c = e("./Options"),
            f = e("./LatLng"),
            p = e("./LatLngBounds"),
            m = e("./Data"),
            g = e("./MapTypeId"),
            _ = e("./ControlPosition"),
            v = e("./MapTypeRegistry"),
            y = e("engine"),
            b = y.Vector3,
            x = e("../interface/InfoWindowImplementation"),
            w = e("../graphic/pins/Pin"),
            M = e("./BuildingLayer"),
            T = e("./DetailsLayer"),
            S = e("../ServerConfig"),
            C = e("../utils/Types"),
            E = e("./Point");
        t.exports = n, l.inherits(n, u);
        var k = n.prototype,
            L = {
                keyboardShortcuts: {
                    rendererSetter: "setKeyboardShortcuts",
                    type: Boolean
                },
                maxZoom: {
                    rendererSetter: "setMaxZoom",
                    type: Number
                },
                draggable: {
                    rendererSetter: "setDraggable",
                    type: Boolean
                },
                draggableTouch: {
                    rendererSetter: "setDraggableTouch",
                    type: Boolean
                },
                scrollwheel: {
                    rendererSetter: "setScrollwheel",
                    type: Boolean
                },
                disableDoubleClickZoom: {
                    rendererSetter: "setdisableDoubleClickZoom",
                    type: Boolean
                },
                tilt: {
                    rendererSetter: "setTiltFromApi",
                    type: Number
                },
                heading: {
                    rendererSetter: "setHeadingFromApi",
                    type: Number
                },
                zoom: {
                    rendererSetter: "setZoomFromApi",
                    type: Number
                },
                center: {
                    rendererSetter: "setCenterFromApi",
                    type: f
                },
                date: {
                    rendererSetter: "setDate",
                    type: C.OrNull(Date)
                },
                timeRatio: {
                    rendererSetter: "setTimeRatio",
                    type: Number
                },
                "3d": {
                    rendererSetter: "set3dFromApi",
                    type: Boolean
                },
                elevation: {
                    rendererSetter: "setElevationFromApi",
                    type: Boolean
                },
                minZoomLayer2D: {
                    rendererSetter: "setMinZoomLayer2dFromApi",
                    type: Number
                },
                sunPosition: {
                    rendererSetter: "setSunPosition"
                }
            };
        s.each(L, function(e, t) {
            r(t, e.rendererSetter, e.type)
        }), u.createProperty(k, "attribution", String), u.createProperty(k, "scaleControl", Boolean), u.createProperty(k, "shadow", Boolean), u.createProperty(k, "hideShadows", Boolean), u.createProperty(k, "ssao", Boolean), u.createProperty(k, "ssaoWhenMoving", Boolean), u.createProperty(k, "useDevicePixelRatio", Boolean), u.createProperty(k, "waterReflection", Boolean), u.createProperty(k, "skipWorkIn3d", Boolean), u.createProperty(k, "enabled", Boolean), u.createProperty(k, "useCsm", Boolean), u.createProperty(k, "usePcf", Boolean), u.createProperty(k, "useLerp", Boolean), u.createProperty(k, "renderEnabled", Boolean), u.createProperty(k, "minMouseMoveBeforeDragInPixels", Number), u.createProperty(k, "mapTypeId", g), u.createProperty(k, "mapTypeControlOptions"), u.createProperty(k, "depthMap"), u.createProperty(k, "sideBySide"), u.createProperty(k, "topToBottom"), u.createProperty(k, "touchDragDialogEnabled"), k.setHoverEnabled = function(e) {
            var t = this;
            t._renderer && t._renderer.disableHover(!e)
        }, k.attribution_changed = function() {
            var e = a(".f4map-footer-text");
            e.empty().append(a(this.attribution))
        }, k.resize = function() {
            return console.warn('Map#resize is an internal method, please emit the "resize" event instead'), console.trace(), this._resize.apply(this, arguments)
        }, k._resize = function(e, t) {
            var i = this;
            i._renderer && i._renderer.resize(e, t)
        }, k.renderNextFrame = function(e, t) {
            var i = this;
            i._renderer && i._renderer.renderNextFrame(e, t)
        }, k.isIn3d = function() {
            return this._renderer ? this._renderer.isIn3d() : !1
        }, k.openInfoWindowHtml = function() {}, k.getDiv = function() {
            return this._$node.get(0)
        }, k.setOptions = function(e, t) {
            var i = s.clone(e);
            this.skipUpdateCamera = !0;
            var n = !1;
            n |= this.setOptionValue("elevation", i, t, ["elevation"]), n |= this.setOptionValue("zoom", i, t, ["zoom"]), n |= this.setOptionValue("center", i, t, ["lon", "lat"]), n |= this.setOptionValue("minZoomLayer2D", i, t, ["minZoomLayer2D"]), n |= this.setOptionValue("3d", i, t, ["3d"]), n |= this.setOptionValue("heading", i, t, ["camera.phi"]), n |= this.setOptionValue("tilt", i, t, ["camera.theta"]), this.setOptionValue("scaleControl", i, t, ["scaleControl"]);
            var r = i.onGeolocClickedCallback;
            void 0 != r && (this.onGeolocClickedCallback = r, delete i.onGeolocClickedCallback), s.each(i, function(e, t) {
                this._canOverrideOptions(t) && this.set(t, e)
            }, this), r = i.limit, void 0 != r && (this._renderer.setMaxBounds(i.limit), delete i.limit), n && this._renderer && this._renderer.onSetOptionsFromApi(), this.skipUpdateCamera = !1, n && this._renderer && this._renderer.onCameraChangedFromApi()
        }, k._canOverrideOptions = function(e, t) {
            return !t || void 0 == t[e]
        }, k.setOptionValue = function(e, t, i, n) {
            var r = !1,
                o = t[e];
            if (void 0 != o) {
                if (s.every(n, function(e) {
                        return this._canOverrideOptions(e, i)
                    }, this)) {
                    r = !0;
                    var a = e.charAt(0).toUpperCase() + e.substr(1, e.length - 1);
                    this["set" + a](o)
                }
                delete t[e]
            }
            return r
        }, k.update2dTo3d = function() {
            this._renderer && this._renderer.update2dTo3d()
        }, k._handleEnter3d = function() {
            this.emit("on3dchange", !0)
        }, k._handleEnter2d = function() {
            this.emit("on3dchange", !1)
        }, k._handleIdle = function(e) {
            this.emit("idle", e), this.emit("tilesloaded")
        }, k.handleOnFeaturesLoadingStarted = function() {
            this.emit("mapFeaturesLoadingStarted")
        }, k.handleOnFeaturesLoadingTerminated = function() {
            this.emit("mapFeaturesLoadingTerminated")
        }, k.addControl = function() {}, k.addOverlay = function(e) {
            if (this._renderer) {
                var t = null;
                if (e.getType && (t = e.getType()), "Overlay" != t && t) {
                    var i = this["add" + t];
                    i ? i.call(this, e) : console.error("unknown type " + t, e)
                } else console.error("type not found ", e)
            }
        }, k.updateOverlay = function(e) {
            if (this._renderer) {
                var t = null;
                e.getType && (t = e.getType());
                var i = this["update" + t];
                i ? i.call(this, e) : (this["remove" + t](e), this["add" + t](e))
            }
        }, k.removeOverlay = function(e) {
            if (this._renderer) {
                var t = null;
                if (e.getType && (t = e.getType()), t) {
                    var i = this["remove" + t];
                    i.call(this, e)
                }
            }
        }, k.isReady = function() {
            return Boolean(this._renderer)
        }, k.onMapReady = function(e) {
            console.log("Deprecated, onMapReady not needed anymore"), console.trace(), e.call(this)
        }, k.onMapFeaturesLoadingStart = function(e) {
            this.once("mapFeaturesLoadingStarted", s.bind(e, this))
        }, k.onMapFeaturesLoadingEnd = function(e) {
            this.once("mapFeaturesLoadingTerminated", s.bind(e, this))
        }, k.mapTypeId_changed = function() {
            this._renderer && this._renderer.setMapTypeId(this.mapTypeId, this.skipUpdateCamera)
        }, k.fitBounds = function(e, t) {
            C.check(p, e), !e.isEmpty() && this._renderer && this._renderer.fitBoundsFromApi(e, t)
        }, k.panToBounds = function(e) {
            C.check(p, e), !e.isEmpty() && this._renderer && this._renderer.panToBoundsFromApi(e)
        }, k.getBounds = function() {
            return this._renderer ? this._renderer.getMapBounds() : null
        }, k.getBoundsZoom = function(e) {
            return this._renderer ? this._renderer.getZoomFromBoundsFromApi(e) : null
        }, k.setCenter = function(e, t) {
            e = f.convert(e), this._renderer && (void 0 !== t && this.setZoom(t), this.set("center", e))
        }, k.panTo = function(e, t) {
            e = f.convert(e), this._renderer && this._renderer.panToFromApi(e, t)
        }, k.setView = function(e, t) {
            e = f.convert(e), this._renderer && this._renderer.setView(e, t)
        }, k.panBy = function(e, t) {
            if ((e || t) && this._renderer) {
                var i = this.getCenter()._to900913(),
                    n = new b(i.lon, i.lat, 0),
                    r = this._renderer.computeScreenPosInPixels(n);
                r.x += e, r.y += t;
                var o = this._renderer.computeLonLatFromPixel(r, 0);
                this.panTo(f.from900913(o.lat, o.lon))
            }
        }, k.setStreetView = function() {}, k.addPolygon = function(e) {
            this._renderer && (this._polygonsById[e.id] = this._renderer.newArea(e))
        }, k.updatePolygon = function(e) {
            if (this._renderer) {
                var t = this._polygonsById[e.id];
                t ? t.setOptions(e) : this.addPolygon(e)
            }
        }, k.removePolygon = function(e) {
            if (this._renderer) {
                var t = this._polygonsById[e.id];
                delete this._polygonsById[e.id], t && t.unload()
            }
        }, k.addRectangle = function(e) {
            this._renderer && (this._rectanglesById[e.id] = this._renderer.newArea(e))
        }, k.updateRectangle = function(e) {
            if (this._renderer) {
                var t = this._rectanglesById[e.id];
                t ? t.setOptions(e) : this.addRectangle(e)
            }
        }, k.removeRectangle = function(e) {
            if (this._renderer) {
                var t = this._rectanglesById[e.id];
                delete this._rectanglesById[e.id], t && t.unload()
            }
        }, k.addPolyline = function(e) {
            this._renderer && (this._polylinesById[e.id] = this._renderer.newArea(e))
        }, k.removePolyline = function(e) {
            if (this._renderer) {
                var t = this._polylinesById[e.id];
                delete this._polylinesById[e.id], t && t.unload()
            }
        }, k.updatePolyline = function(e) {
            if (this._renderer) {
                var t = this._polylinesById[e.id];
                t ? t.setOptions(e) : this.addPolygon(e)
            }
        }, k.addMarker = function(e) {
            null == this._markersById[e.id] && this._renderer && (this._markersById[e.id] = new w(e, this._renderer))
        }, k.removeMarker = function(e) {
            if (this._renderer) {
                var t = e.id,
                    i = this._markersById[t];
                delete this._markersById[t], i && i.unload()
            }
        }, k.updateMarker = function(e) {
            if (this._renderer) {
                var t = this._markersById[e.id];
                t ? t.setMarker(e, !0) : this.addMarker(e)
            }
        }, k._getPinFromMarker = function(e) {
            return this._markersById[e.id]
        }, k.getMarkerSize2D = function(e) {
            if (this._renderer) {
                var t = this._markersById[e.id];
                if (t) return t.getSize2D()
            }
        }, k.addCircle = function(e) {
            this._renderer && (this._circlesById[e.id] = this._renderer.newArea(e))
        }, k.addInfoWindow = function(e) {
            if (this._renderer) {
                var t = e.id,
                    i = new x(this);
                i.open(e), this._infoWindowsById[t] = i
            }
        }, k.removeInfoWindow = function(e) {
            if (this._renderer) {
                var t = e.id,
                    i = this._infoWindowsById[t];
                delete this._infoWindowsById[t], i && i.hide()
            }
        }, k.removeCircle = function(e) {
            if (this._renderer) {
                var t = e.id,
                    i = this._circlesById[t];
                delete this._circlesById[t], i && i.unload()
            }
        }, k.updateCircle = function(e) {
            if (this._renderer) {
                var t = this._circlesById[e.id];
                t ? ("center" in e || (e.center = t.center), t.setOptions(e)) : this.addCircle(e)
            }
        }, k.forEachTile = function(e) {
            this.treeLayer && this.treeLayer.forEach(e)
        }, k.setUrlTemplate2d = function(e) {
            this.layers.tiles2d.setUrl(e)
        }, k.setUrlTemplate3d = function(e) {
            this.layers.tiles3d.setUrl(e)
        }, k.removeColorFilter = function() {
            this._renderer && this._renderer.removeColorFilter()
        }, k.setColorFilter = function(e) {
            this._renderer && this._renderer.setColorFilter(e)
        }, k.setColorsMapping = function(e) {
            this._renderer && this._renderer.setColorsMapping(e)
        }, k.canUseDevicePixelRatio = function() {
            return this._renderer ? this._renderer.canUseDevicePixelRatio() : !1
        }, k.getExclusionZones = function() {
            return this._exclusionZones
        }, k.setExclusionZones = function(e, t) {
            this._exclusionZones[e] = t, this.emit("exclusionZones_changed")
        }, k._addClass = function(e) {
            this._renderer && this._renderer.$parentNode.addClass(e)
        }, k._removeClass = function(e) {
            this._renderer && this._renderer.$parentNode.removeClass(e)
        }, k._toggleClass = function(e, t) {
            this._renderer && this._renderer.$parentNode.toggleClass(e, t)
        }, k._onDivRemoved = function(e) {
            var t = a(e.target),
                i = this._renderer;
            if (o(t, i.$parentNode)) {
                this.setEnabled(!1), this.emit("divRemoved"), this.removeListener("resize", this._onResizeHandler), a(window).off("resize", this._onResizeHandler), this.removeAllListeners("mapReady");
                var n = s.clone(this._polygonsById);
                s.each(n, function(e) {
                    this.removePolygon(e)
                }, this), this._polygonsById = {}, this.removeListener("skipWorkIn3d_changed", this._skipWorkIn3dHandler), i.removeListener("cameraStabilized", this._idleHandler), i.removeListener("enter3d", this._enter3dHandler), i.removeListener("enter2d", this._enter2dHandler), i.onDivRemoved(), delete this._idleHandler, delete this._enter3dHandler, delete this._enter2dHandler, delete this._skipWorkIn3dHandler, delete this._renderer, a("body").off("DOMNodeRemoved", this._onDivRemovedHandler), delete this._onDivRemovedHandler
            }
        }, k._fromLatLngAndHeightToContainerPixel = function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
                i = e._to900913(),
                n = new b(i.lon, i.lat, t),
                r = this._renderer.computeScreenPosInPixels(n);
            return new E(r.x, r.y)
        }, k._fromContainerPixelAndHeightToLatLng = function(e) {
            var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,
                i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : !1,
                n = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null,
                r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : !1,
                o = this._renderer.computeLonLatFromPixel(e, t, n);
            return r ? o : f.from900913(o.lat, o.lon, i)
        }, k.updateLayers = function() {
            s.each(this._layersByType, function(e) {
                s.each(e, function(e) {
                    e.rebuildMaterial ? e.rebuildMaterial() : e._updateConfigAndReload && e._updateConfigAndReload()
                })
            })
        }, k.addLayer = function(e) {
            this._allLayers.push(e), this.emit("layeradd", e)
        }, k.removeLayer = function(e) {
            var t = this._allLayers.indexOf(e);
            t >= 0 && (this._allLayers.splice(t, 1), this.emit("layerremove", e))
        }, k.eachLayer = function(e) {
            s.each(this._allLayers, e)
        }, k._createLayers = function() {
            var e = this;
            return {
                tiles2d: {
                    setUrl: function(t) {
                        e._renderer.setUrlTemplate2d(t)
                    }
                },
                tiles3d: {
                    setUrl: function(t) {
                        e._renderer.setUrlTemplate3d(t)
                    }
                }
            }
        }, k._initBuildingLayer = function(e) {
            if ("buildingLayer" in e) this.buildingLayer = e.buildingLayer;
            else {
                var t = this.buildingLayer = new M;
                S.onServerHostReady("models", function(e) {
                    a.ajax({
                        url: e + "/mapping",
                        dataType: "json",
                        callback: function(e, i) {
                            e ? console.error(e.message) : t.setSpecialBuildings(i)
                        }
                    })
                })
            }
        }
    }, {
        "../MapLeafRenderer": 218,
        "../MapWebGLRenderer": 220,
        "../ServerConfig": 221,
        "../graphic/pins/Pin": 348,
        "../interface/InfoWindowImplementation": 391,
        "../utils/Types": 412,
        "../utils/WebGlContextAttributes": 415,
        "./BuildingLayer": 223,
        "./ControlPosition": 225,
        "./Data": 226,
        "./DetailsLayer": 227,
        "./LatLng": 233,
        "./LatLngBounds": 234,
        "./MVCArray": 235,
        "./MVCObject": 236,
        "./MapTypeId": 239,
        "./MapTypeRegistry": 240,
        "./Options": 243,
        "./Point": 246,
        "browser-detect": 4,
        engine: 10,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    238: [function(e, t, i) {
        "use strict";

        function n() {
            this.minZoom = 0, this.maxZoom = 22
        }
        t.exports = n
    }, {}],
    239: [function(e, t, i) {
        "use strict";
        t.exports = {
            ROADMAP: "ROADMAP",
            SATELLITE: "SATELLITE",
            HYBRID: "HYBRID",
            FLAT_TERRAIN: "FLAT_TERRAIN",
            TERRAIN: "TERRAIN"
        }
    }, {}],
    240: [function(e, t, i) {
        "use strict";

        function n() {
            var e = this;
            o.each(l, function(t) {
                e[t] = new s
            })
        }
        var r = e("util"),
            o = e("underscore"),
            a = e("./MVCObject"),
            s = e("./MapType"),
            l = e("./MapTypeId");
        t.exports = n, r.inherits(n, a), n.prototype.set = function(e, t) {
            this[e] = t
        }
    }, {
        "./MVCObject": 236,
        "./MapType": 238,
        "./MapTypeId": 239,
        underscore: 207,
        util: 212
    }],
    241: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.textLineHeight = 12, this.textFont = "12px Arial", this.textFillStyle = "#000000", this.visible = !0, this.zIndex = 0, this.clickable = !0, this.draggable = !1, this.alwaysInFront = !1, this.disableLine = !1, this.disableHeight = !1, a.call(this), this.id = r.uniqueId("marker_"), this.initialiseOptions(e), this.setMap(this.map)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Overlay"),
            s = e("./LatLng"),
            l = e("./Animation"),
            h = e("../utils/Types");
        t.exports = n, o.inherits(n, a);
        var u = n.prototype;
        a.createProperty(u, "position", s), a.createProperty(u, "icon"), a.createProperty(u, "title", h.OrNull(String)), a.createProperty(u, "animation", h.OrNull(l)), a.createProperty(u, "draggable", Boolean), a.createProperty(u, "clickable", Boolean), a.createProperty(u, "zIndex", Number), a.createProperty(u, "height", Number), a.createProperty(u, "textFont", String), a.createProperty(u, "textFillStyle", String), a.createProperty(u, "textLineHeight", Number), a.createProperty(u, "alwaysInFront", Boolean), a.createProperty(u, "visible", Boolean), a.createProperty(u, "disableLine", Boolean), a.createProperty(u, "disableHeight", Boolean), a.createProperty(u, "touchScaling", Number), u.getType = function() {
            return "Marker"
        }, u.initialiseOptions = function(e) {
            r.each(e, function(e, t) {
                switch (t) {
                    case "location":
                        this.position = e;
                        break;
                    case "icon":
                        r.isString(e) && (e = {
                            url: e
                        }), this.icon = e;
                        break;
                    default:
                        this[t] = e
                }
            }, this), e.location && (this.position = e.location), this.position && (this.position = s.convert(this.position))
        }, u.setOptions = function(e) {
            var t = this.map;
            r.each(e, function(e, i) {
                switch (i) {
                    case "location":
                        this.setPosition(e);
                        break;
                    case "icon":
                        r.isString(e) && (e = {
                            url: e
                        }), this.setIcon(e);
                        break;
                    case "map":
                        t = e;
                        break;
                    default:
                        this.set(i, e)
                }
            }, this), this.setMap(t)
        }, u.icon_changed = function() {
            var e = this.icon;
            r.isString(e) && (e = {
                url: e
            }), this.icon = e, this._refresh()
        }, u._isDisplayable = function() {
            return null != this.position
        }, u.setMap = function(e) {
            var t = this.visible && this._isDisplayable();
            null != e && this.map == e && t ? this.map.updateMarker(this) : this.map !== e && (this.map && this.map.removeMarker(this), this.map = e, e && t && e.addMarker(this), this.emit("map_changed"))
        }
    }, {
        "../utils/Types": 412,
        "./Animation": 222,
        "./LatLng": 233,
        "./Overlay": 244,
        underscore: 207,
        util: 212
    }],
    242: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, r) {
            this.url = e, this.size = t, this.origin = i, this.anchor = n, this.scaledSize = r
        }
        t.exports = n
    }, {}],
    243: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = new a(e.updateHRef === !1);
            r(t);
            var i = t.getUrlConfig(),
                n = o.omit(e || {}, ["center", "width", "height", "elevation", "ssao", "ssaoWhenMoving", "waterReflection", "shadow", "useDevicePixelRatio"]);
            return e.center && void 0 == i.lon && void 0 == i.lat && o.extend(n, {
                lon: e.center.lng(),
                lat: e.center.lat()
            }), t.setInitialValues(n), t
        }

        function r(e) {
            var t = e.getUrlConfig();
            if (null != t.lon && null != t.lat && (Math.abs(t.lon) > 180 || Math.abs(t.lat) > 90)) {
                var i = s.convert900913to4326({
                    lon: t.lon,
                    lat: t.lat
                });
                e.set("lon", i.lon), e.set("lat", i.lat), e._forceUpdateHref()
            }
        }
        var o = e("underscore"),
            a = e("../../data/configuration"),
            s = e("../utils/LocationHelper");
        t.exports = {
            convertOptions: n
        }
    }, {
        "../../data/configuration": 215,
        "../utils/LocationHelper": 407,
        underscore: 207
    }],
    244: [function(e, t, i) {
        "use strict";

        function n() {
            this.map = null, this.visible = !0
        }
        var r = e("util"),
            o = e("./MVCObject");
        t.exports = n, r.inherits(n, o);
        var a = n.prototype;
        n.createProperty = function(e, t, i) {
            o.createProperty(e, t, i);
            var n = o.keyEventName(t);
            e[n] || (e[n] = e._refresh)
        }, a._isDisplayable = function() {
            return !0
        }, a.getType = function() {
            return "Overlay"
        }, a.setMap = function(e) {
            if (!e || e._renderer) {
                var t = this.visible && this._isDisplayable();
                null != e && this.map == e && t ? this.map.updateOverlay(this) : this.map !== e && (this.map && (this.map.removeOverlay(this), this.map._renderer && this.map._renderer.forceRender()), this.map = e, e && t && (e.addOverlay(this), e._renderer.forceRender()), this.emit("map_changed"))
            }
        }, a._refresh = function() {
            this.setMap(this.map)
        }, a.getMap = function() {
            return this.map
        }, a.setVisible = function(e) {
            this.set("visible", e)
        }, a.getVisible = function() {
            return this.visible
        }, a.visible_changed = function() {
            this.map && this.map.updateOverlay(this)
        }
    }, {
        "./MVCObject": 236,
        util: 212
    }],
    245: [function(e, t, i) {
        "use strict";

        function n() {}

        function r(e) {
            function t(t, i) {
                return t = h.convert(t), e._fromLatLngAndHeightToContainerPixel(t, i)
            }

            function i(t, i, n, r, o) {
                return e._fromContainerPixelAndHeightToLatLng(t, i, n, r, o)
            }

            function n(e) {
                return e = h.convert(e), t(e, 0)
            }

            function r(e, t, n, r) {
                return i(e, 0, t, n, r)
            }
            return {
                fromContainerPixelToLatLng: r,
                fromDivPixelToLatLng: r,
                fromLatLngToContainerPixel: n,
                fromLatLngToDivPixel: n,
                fromContainerPixelAndHeightToLatLng: i,
                fromDivPixelAndHeightToLatLng: i,
                fromLatLngAndHeightToContainerPixel: t,
                fromLatLngAndHeightToDivPixel: t
            }
        }
        var o = e("jquery"),
            a = e("underscore"),
            s = e("util"),
            l = e("./MVCObject"),
            h = e("./LatLng");
        t.exports = n, s.inherits(n, l);
        var u = n.prototype;
        u.getMap = function() {
            return this._map
        }, u.getPanes = function() {
            var e = this._$overlayViewDiv.get(0);
            return {
                floatPane: e,
                floatShadow: e,
                mapPane: e,
                overlayImage: e,
                overlayLayer: e,
                overlayMouseTarget: e,
                overlayShadow: e
            }
        }, u.getProjection = function() {
            return r(this._map)
        }, u.setMap = function(e) {
            this._map != e && (this._map && this._remove(this._map), this._map = e, e && this._create(e), this.emit("map_changed"))
        }, u._create = function(e) {
            this._$overlayViewDiv = o("<div>").css({
                position: "absolute",
                width: "100%",
                top: 0,
                left: 0
            }).appendTo(e.getDiv()), this.onAdd && this.onAdd(), this.draw && (this._boundsChangedHandler = a.bind(this.draw, this), e.on("bounds_changed", this._boundsChangedHandler), this.draw())
        }, u._remove = function() {
            this._map && this._boundsChangedHandler && (this._map.removeListener("bounds_changed", this._boundsChangedHandler), delete this._boundsChangedHandler), this._$overlayViewDiv && (this._$overlayViewDiv.detach(), this._$overlayViewDiv = null), this.onRemove && this.onRemove()
        }
    }, {
        "./LatLng": 233,
        "./MVCObject": 236,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    246: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.x = e, this.y = t
        }
        t.exports = n;
        var r = n.prototype;
        r.equals = function(e) {
            return this.x == e.x && this.y == e.y
        }, r.toString = function() {
            return "(" + this.x + ", " + this.y + ")"
        }
    }, {}],
    247: [function(e, t, i) {
        "use strict";

        function n(e) {
            a.call(this), this.id = r.uniqueId("polygon_"), this._pathChanged = r.bind(this._refresh, this), this._insert_at = r.bind(function(e) {
                var t = this.paths.getAt(e);
                this._watchPath(t), this._refresh()
            }, this), this._remove_at = r.bind(function(e, t) {
                this._unwatchPath(t), this._refresh()
            }, this), this._set_at = r.bind(function(e, t) {
                this._unwatchPath(t);
                var i = this.paths.getAt(e);
                this._watchPath(i), this._refresh()
            }, this), this.setPaths(new s([new s])), this.fillColor = this.strokeColor = "black", this.fillOpacity = .25, this.strokeOpacity = 1, this.strokeWeight = 3, this.editable = !1, this.clickable = !0, this.editableMarkers = [], this.simplify = !1, this.on("editable_changed", r.bind(this.updateEditableMarkers, this)), this.setOptions(e)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Overlay"),
            s = e("./MVCArray"),
            l = e("./LatLng"),
            h = e("./Marker"),
            u = e("./StrokePosition");
        t.exports = n, o.inherits(n, a);
        var d = n.prototype;
        a.createProperty(d, "zIndex", Number), a.createProperty(d, "editable", Boolean), a.createProperty(d, "clickable", Boolean), a.createProperty(d, "strokeOpacity", Number), a.createProperty(d, "strokeColor", String), a.createProperty(d, "strokeWeight", Number), a.createProperty(d, "fillOpacity", Number), a.createProperty(d, "fillColor", String), a.createProperty(d, "strokePosition", u), a.createProperty(d, "disableZBuffer", Boolean), a.createProperty(d, "simplify", Boolean), d.getType = function() {
            return "Polygon"
        }, d.setOptions = function(e) {
            var t = this.map;
            r.each(e, function(e, i) {
                switch (i) {
                    case "map":
                        t = e;
                        break;
                    case "paths":
                        this.setPaths(e);
                        break;
                    case "path":
                        this.setPath(e);
                        break;
                    default:
                        this.set(i, e)
                }
            }, this), this.setMap(t)
        }, d.updateEditableMarkers = function() {
            this.deleteEditableMarkers();
            var e = this.getEditable();
            e && this.createEditableMarkers()
        }, d.createEditableMarkers = function() {
            var e = this.editableMarkers = [],
                t = this.map,
                i = this;
            if (t) {
                var n = this.getPath();
                n.forEach(function(r, o) {
                    var a = {
                            position: r,
                            map: t,
                            draggable: !0,
                            clickable: i.clickable
                        },
                        s = new h(a);
                    s.on("position_changed", function() {
                        n.setAt(o, s.getPosition())
                    }), e.push(s)
                })
            }
        }, d.deleteEditableMarkers = function() {
            r.each(this.editableMarkers, function(e) {
                e.setMap(null)
            }), this.editableMarkers = []
        }, d.setMap = function(e) {
            null == e ? this.deleteEditableMarkers() : this.map != e && this.updateEditableMarkers(), a.prototype.setMap.call(this, e)
        }, d.setPath = function(e) {
            r.isArray(e) && (e = new s(e)), this.paths.setAt(0, e)
        }, d.setPaths = function(e) {
            r.isArray(e) && (e = new s(e)), r.each(e.getArray(), function(t, i) {
                r.isArray(t) && (t = new s(t)), t instanceof s ? r.each(t.getArray(), function(e, i) {
                    t.setAt(i, l.convert(e))
                }) : t = l.convert(t), e.setAt(i, t)
            }), e.getAt(0) instanceof l ? this.setPath(e) : (this._unwatchPaths(this.paths), this.paths = e, this._watchPaths(e)), this.updateEditableMarkers()
        }, d._watchPaths = function(e) {
            e && (e.forEach(r.bind(function(e) {
                this._watchPath(e)
            }, this)), e.addListener("insert_at", this._insert_at), e.addListener("remove_at", this._remove_at), e.addListener("set_at", this._set_at))
        }, d._watchPath = function(e) {
            e && (e.addListener("insert_at", this._pathChanged), e.addListener("remove_at", this._pathChanged), e.addListener("set_at", this._pathChanged))
        }, d._unwatchPaths = function(e) {
            e && (e.forEach(r.bind(function(e) {
                this._unwatchPath(e)
            }, this)), e.removeListener("insert_at", this._insert_at), e.removeListener("remove_at", this._remove_at), e.removeListener("set_at", this._set_at))
        }, d._unwatchPath = function(e) {
            e && (e.removeListener("insert_at", this._pathChanged), e.removeListener("remove_at", this._pathChanged), e.removeListener("set_at", this._pathChanged))
        }, d.getPaths = function() {
            return this.paths
        }, d.getPath = function() {
            return this.paths.getAt(0)
        }, d.toGeoJSON = function() {
            function e(e) {
                for (var t = e.length, i = 0, n = 0, r = t - 1; t > n; r = n++) i += e[r].lng() * e[n].lat() - e[r].lat() * e[n].lng();
                return 0 == i ? 0 : i > 0 ? 1 : -1
            }

            function t(e, t, i) {
                return e.bbox[0] <= t && e.bbox[1] <= i && e.bbox[2] >= t && e.bbox[3] >= i
            }

            function i(e, i) {
                return t(e, i.bbox[0], i.bbox[1]) && t(e, i.bbox[0], i.bbox[3]) && t(e, i.bbox[2], i.bbox[1]) && t(e, i.bbox[2], i.bbox[3])
            }

            function n(e, t, o) {
                return r.some(t, function(t) {
                    return i(t, e) && !n(t, o, [])
                })
            }

            function o(e, t) {
                r.each(e, function(o) {
                    if (!n(o, t, e)) {
                        var a = [o.coordinates];
                        r.each(t, function(e) {
                            i(o, e) && a.push(e.coordinates)
                        });
                        var s = {
                            type: "Polygon",
                            bbox: o.bbox,
                            coordinates: a
                        };
                        l.push(s)
                    }
                })
            }
            var a = [],
                s = [];
            r.each(this.paths.getArray(), function(t) {
                var i = e(t.getArray()),
                    n = [+(1 / 0), +(1 / 0), -(1 / 0), -(1 / 0)],
                    o = r.map(t.getArray(), function(e) {
                        return n[0] = Math.min(n[0], e.lng()), n[1] = Math.min(n[1], e.lat()), n[2] = Math.max(n[2], e.lng()), n[3] = Math.max(n[3], e.lat()), e.toGeoJSON().coordinates
                    });
                if (o.length > 1) {
                    var l = o[0],
                        h = o[o.length - 1];
                    (l[0] != h[0] || l[1] != h[1]) && o.push([l[0], l[1]])
                }
                var u = i > 0,
                    d = {
                        type: "LinearRing",
                        bbox: n,
                        coordinates: o
                    };
                u ? a.push(d) : s.push(d)
            });
            var l = [];
            return o(a, s), o(s, a), l.length ? 1 == l.length ? l[0] : {
                type: "GeometryCollection",
                geometries: l
            } : null
        }
    }, {
        "./LatLng": 233,
        "./MVCArray": 235,
        "./Marker": 241,
        "./Overlay": 244,
        "./StrokePosition": 251,
        underscore: 207,
        util: 212
    }],
    248: [function(e, t, i) {
        "use strict";

        function n(e) {
            s.call(this), this._pathEvents = new d, this.id = o.uniqueId("polyline_"), this.strokeOpacity = 1, this.strokeColor = "#000000", this.strokeWeight = 2, this.clickable = !0, this.isLine = !0, this.simplify = !1, this.setPath(new l), this.on("editable_changed", o.bind(this._updateEditableMarkers, this)), this.setOptions(e)
        }

        function r(e) {
            var t = document.createElement("canvas");
            t.width = c, t.height = c;
            var i = t.getContext("2d");
            return i.beginPath(), i.fillStyle = "#fff", i.strokeStyle = e, i.arc(f, f, f - .5, 0, 2 * Math.PI), i.fill(), i.stroke(), t.toDataURL()
        }
        var o = e("underscore"),
            a = e("util"),
            s = e("./Overlay"),
            l = e("./MVCArray"),
            h = e("./Marker"),
            u = e("./Point"),
            d = e("../utils/EventPack");
        t.exports = n, a.inherits(n, s);
        var c = 11,
            f = c / 2,
            p = n.prototype;
        s.createProperty(p, "strokeOpacity", Number), s.createProperty(p, "strokeColor", String), s.createProperty(p, "strokeWeight", Number), s.createProperty(p, "zIndex", Number), s.createProperty(p, "clickable", Boolean), s.createProperty(p, "editable", Boolean), s.createProperty(p, "simplify", Boolean), p.getType = function() {
            return "Polyline"
        }, p.setOptions = function(e) {
            var t = this.map;
            o.each(e, function(e, i) {
                switch (i) {
                    case "map":
                        t = e;
                        break;
                    case "path":
                        this.setPath(e);
                        break;
                    case "fillOpacity":
                    case "fillColor":
                        break;
                    default:
                        this.set(i, e)
                }
            }, this), this.setMap(t)
        }, p._updateEditableMarkers = function() {
            this._deleteEditableMarkers();
            var e = this.getEditable();
            e && this._createEditableMarkers()
        }, p.getMarkerAtPosition = function(e) {
            var t = null;
            return o.each(this._editableMarkers, function(i) {
                var n = i.getPosition();
                n.equals(e) && (t = i)
            }), t
        }, p._createEditableMarkers = function() {
            var e = this;
            if (this.map) {
                var t = this.getPath();
                t.forEach(function(t, i) {
                    e._editableMarkers[i] = e._createEditableMarker(i)
                })
            }
        }, p.strokecolor_changed = function() {
            delete this._markerIconUrl
        }, p._createEditableMarker = function(e) {
            var t = this.getPath(),
                i = t.getAt(e);
            this._markerIconUrl || (this._markerIconUrl = r(this.strokeColor));
            var n = {
                    position: i,
                    map: this.map,
                    draggable: !0,
                    clickable: !1,
                    alwaysInFront: !0,
                    icon: {
                        url: this._markerIconUrl,
                        anchor: new u(f - .5, f - .5)
                    }
                },
                o = new h(n);
            return o.index = e, o.on("position_changed", function() {
                t.setAt(o.index, o.getPosition())
            }), o
        }, p._deleteEditableMarkers = function() {
            o.each(this._editableMarkers, function(e) {
                e.setMap(null)
            }), this._editableMarkers = []
        }, p._handleInsertPoint = function(e) {
            if (this.editable) {
                var t = this._createEditableMarker(e),
                    i = this._editableMarkers;
                i.splice(e, 0, t);
                for (var n = i.length, r = e + 1; n > r; ++r) i[r].index = r
            }
            this._refresh()
        }, p._handleRemovePoint = function(e) {
            if (this.editable) {
                var t = this._editableMarkers;
                t[e].setMap(null), t.splice(e, 1);
                for (var i = t.length, n = e; i > n; ++n) t[n].index = n
            }
            this._refresh()
        }, p._handleSetPoint = function(e) {
            if (this.editable) {
                var t = this._editableMarkers[e];
                t ? t.setPosition(this.getPath().getAt(e)) : this._handleInsertPoint(e)
            }
            this._refresh()
        }, p.setMap = function(e) {
            var t = this.map;
            s.prototype.setMap.call(this, e), t != e && this._updateEditableMarkers()
        }, p.setPath = function(e) {
            e || (e = []), o.isArray(e) && (e = new l(e)), e.getAt(0) instanceof l ? e = e.getAt(0) : o.isArray(e.getAt(0)) && (e = new l(e.getAt(0))), this._pathEvents.removeAllListeners(), this.path = e, this._pathEvents.on(e, "insert_at", o.bind(this._handleInsertPoint, this)), this._pathEvents.on(e, "remove_at", o.bind(this._handleRemovePoint, this)), this._pathEvents.on(e, "set_at", o.bind(this._handleSetPoint, this)), this._updateEditableMarkers()
        }, p.getPath = function() {
            if (0 == this.path.length && this.geoJSON) throw new Error("getPath cannot convert geoJSON, please convert beforehand.");
            return this.path
        }, p.toGeoJSON = function() {
            var e;
            if (this.path) {
                var t = o.map(this.path.getArray(), function(e) {
                    return e.toGeoJSON().coordinates
                });
                e = {
                    type: "LineString",
                    coordinates: t
                }
            }
            return e
        }
    }, {
        "../utils/EventPack": 403,
        "./MVCArray": 235,
        "./Marker": 241,
        "./Overlay": 244,
        "./Point": 246,
        underscore: 207,
        util: 212
    }],
    249: [function(e, t, i) {
        "use strict";

        function n(e) {
            a.call(this), this.id = r.uniqueId("rectangle_"), this._bounds = new s, this.fillColor = this.strokeColor = "black", this.fillOpacity = .25, this.strokeOpacity = 1, this.strokeWeight = 3, this.clickable = !1, this.setOptions(e)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Overlay"),
            s = e("./LatLngBounds");
        t.exports = n, o.inherits(n, a), n.prototype.getType = function() {
            return "Rectangle"
        }, n.prototype.setOptions = function(e) {
            var t = this.map;
            r.each(e, function(e, i) {
                switch (i) {
                    case "map":
                        t = e;
                        break;
                    case "bounds":
                        this.setBounds(e);
                        break;
                    case "fillColor":
                        this.fillColor = e;
                        break;
                    case "fillOpacity":
                        this.fillOpacity = e;
                        break;
                    case "strokeColor":
                        this.strokeColor = e;
                        break;
                    case "strokeOpacity":
                        this.strokeOpacity = e;
                        break;
                    case "strokeWeight":
                        this.strokeWeight = e;
                        break;
                    case "clickable":
                        this.clickable = e;
                        break;
                    case "visible":
                        this.setVisible(e)
                }
            }, this), this.setMap(t)
        }, n.prototype._isDisplayable = function() {
            return !this._bounds.isEmpty()
        }, n.prototype.setBounds = function(e) {
            this._bounds = e, this._refresh()
        }, n.prototype.getBounds = function() {
            return this._bounds
        }
    }, {
        "./LatLngBounds": 234,
        "./Overlay": 244,
        underscore: 207,
        util: 212
    }],
    250: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            this.width = e, this.height = t, this.widthUnit = i || "px", this.heightUnit = n || "px"
        }
        t.exports = n;
        var r = n.prototype;
        r.equals = function(e) {
            return this.width == e.width && this.height == e.height
        }, r.toString = function() {
            return "(" + this.width + ", " + this.height + ")"
        }
    }, {}],
    251: [function(e, t, i) {
        "use strict";
        t.exports = {
            CENTER: 1,
            INSIDE: 2,
            OUTSIDE: 3
        }
    }, {}],
    252: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = function(e) {
                this._cachedStuff = {}, this._cacheDuration = e.cacheDuration, this._canReleaseCallback = e.canReleaseCallback, setInterval(n.bind(this.checkExpired, this), this._cacheDuration / 2)
            };
        r.prototype.clear = function() {
            n.each(this._cachedStuff, function(e) {
                e.emit("released")
            }, this), this._cachedStuff = {}
        }, r.prototype.get = function(e, t) {
            void 0 == t && (t = !1);
            var i = this._cachedStuff[e];
            return i ? (t || (delete i._cacheDate, delete this._cachedStuff[e]), i) : null
        }, r.prototype.set = function(e) {
            e._cacheDate = Date.now(), this._cachedStuff[e.id] = e
        }, r.prototype.unset = function(e) {
            delete this._cachedStuff[e.id]
        }, r.prototype.checkExpired = function() {
            var e = Date.now(),
                t = [];
            n.each(this._cachedStuff, function(i) {
                e - i._cacheDate >= this._cacheDuration && (!this._canReleaseCallback || this._canReleaseCallback(i)) && (i.emit("released"), t.push(i.id))
            }, this), n.each(t, function(e) {
                delete this._cachedStuff[e]
            }, this)
        }, t.exports = r
    }, {
        underscore: 207
    }],
    253: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._$overlay = null, this.drawingControl = !0, this._onMouseMoveHandler = r.bind(this._onMouseMove, this), this._onClickHandler = r.bind(this._onClick, this), this._onDragStartHandler = r.bind(this._onDragStart, this), this._onDragMoveHandler = r.bind(this._onDragMove, this), this._onDragEndHandler = r.bind(this._onDragEnd, this), this.drawingControlOptions = {
                drawingModes: [f.MARKER, f.POLYLINE, f.RECTANGLE, f.CIRCLE, f.POLYGON],
                position: p.TOP_LEFT
            }, "minMouseMoveBeforeDragInPixels" in e && this.setMinMouseMoveBeforeDragInPixels(e.minMouseMoveBeforeDragInPixels), "map" in e && this.setMap(e.map), "circleOptions" in e && this.setCircleOptions(e.circleOptions), "markerOptions" in e && this.setMarkerOptions(e.markerOptions), "polygonOptions" in e && this.setPolygonOptions(e.polygonOptions), "polylineOptions" in e && this.setPolylineOptions(e.polylineOptions), "rectangleOptions" in e && this.setRectangleOptions(e.rectangleOptions), "drawingMode" in e && this.setDrawingMode(e.drawingMode), "drawingControlOptions" in e && this.setDrawingControlOptions(e.drawingControlOptions), "drawingControl" in e && this.setDrawingControl(e.drawingControl)
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("util"),
            s = e("../MVCObject"),
            l = e("../MVCArray"),
            h = e("../../../templates/draw.jade"),
            u = e("../Polygon"),
            d = e("../Polyline"),
            c = e("../LatLng"),
            f = e("./OverlayType"),
            p = e("../ControlPosition"),
            m = e("../../translation"),
            g = e("../geometry/spherical"),
            _ = {
                clickable: !1,
                disableZBuffer: !0,
                zIndex: 15,
                strokeOpacity: 1,
                strokeColor: "#000000",
                strokeWeight: 2
            };
        t.exports = n, a.inherits(n, s);
        var v = n.prototype;
        s.createProperties(v, ["drawingControl", "drawingControlOptions", "drawingMode", "map", "minMouseMoveBeforeDragInPixels", "circleOptions", "markerOptions", "polygonOptions", "polylineOptions", "rectangleOptions"]), v._setDrawingModeOnClick = function(e, t) {
            t.stopPropagation(), t.preventDefault(), this.setDrawingMode(e)
        }, v._startDrawing = function(e) {
            this._endDrawing();
            var t = this.getDrawingMode();
            (t == f.POLYGON || t == f.POLYLINE) && (this._drawnLine = this._createPolyline({
                path: null,
                isTempPolyline: !1,
                isHandDrawing: e
            }), this._drawnLine.overlayType = t, this.emit("drawingstarted"))
        }, v._endDrawing = function() {
            if (this._clearMouseOverlay(), this._drawnLine) {
                var e = this._drawnLine.overlayType,
                    t = new l(r.clone(this._drawnLine.getPath().getArray())),
                    i = null;
                e == f.POLYGON ? i = new u(this.getPolygonOptions()) : e == f.POLYLINE && (i = new d(this.getPolylineOptions())), i.setPath(t);
                var n = this.map;
                i.setMap(n), this._drawnLine && (this._drawnLine.setMap(null), this._drawnLine = null), n && n._removeClass("hover-clickable"), e == f.POLYGON ? this.emit("polygoncomplete", i) : e == f.POLYLINE && this.emit("polylinecomplete", i), this.emit("overlaycomplete", {
                    overlay: i,
                    type: this.getDrawingMode()
                })
            }
        }, v._getCurrentDrawingOptions = function() {
            var e, t = this.drawingMode;
            return t == f.POLYGON ? e = this.getPolygonOptions() : t == f.POLYLINE && (e = this.getPolylineOptions()), e || {}
        }, v._onDragStart = function(e) {
            if ("touchmove" == e.type || "touchstart" == e.type || "pointerdown" == e.type || "pointermove" == e.type) {
                this._touchDrawing = !0;
                var t = this._drawnLine;
                null == t && this._startDrawing(!0),
                    this._addTouchPoint(e), this.map.setDraggable(!1)
            }
        }, v._onDragMove = function(e) {
            ("touchmove" == e.type || "pointermove" == e.type) && (this._touchDrawing = !0, this.map.setDraggable(!1), this._addTouchPoint(e))
        }, v._onDragEnd = function(e) {
            if (this._touchDrawing && ("touchend" == e.type || "pointerup" == e.type)) {
                this._touchDrawing = !1, this._addTouchPoint(e), this.map.setDraggable(!0);
                var t = this._drawnLine;
                t && this._endDrawing(!0)
            }
        }, v._addTouchPoint = function(e) {
            if (this._drawnLine) {
                var t = this._drawnLine.getPath();
                this._hasOtherPointNear(t, e) || t.push(e.latLng)
            }
        }, v._hasOtherPointNear = function(e, t) {
            for (var i = e.getLength(), n = 0; i > n; ++n)
                if (g.computeDistanceBetween(e.getAt(n), t.latLng) < .5) return !0;
            return !1
        }, v._onClick = function(e) {
            if ("touchend" == e.type) this._onDragEnd(e);
            else {
                var t = this._drawnLine;
                if (null == t && this._startDrawing(), this._drawnLine) {
                    var i = this._drawnLine.getPath(),
                        n = i.getAt(0),
                        r = i.getAt(i.getLength() - 1);
                    if (this._areNearPoints(n, e.latLng)) this.drawingMode == f.POLYLINE && i.setAt(i.getLength(), n), this._endDrawing();
                    else if (this._areNearPoints(r, e.latLng)) this._endDrawing();
                    else {
                        var o = new c(e.latLng.lat(), e.latLng.lng());
                        i.push(o), this._clearMouseOverlay()
                    }
                }
            }
        }, v._clearMouseOverlay = function() {
            this._mouseLine && (this._mouseLine.setMap(null), this._mouseLine = null)
        }, v._onMouseMove = function(e) {
            if (this._drawnLine && "touchmove" != e.type) {
                var t = this._drawnLine.getPath();
                if (t.getLength()) {
                    var i = t.getAt(0),
                        n = t.getAt(t.getLength() - 1);
                    this._areNearPoints(i, e.latLng) ? (this._mouseLine && this._mouseLine.getPath().setAt(1, i), this.map._addClass("hover-clickable")) : this._areNearPoints(n, e.latLng) ? (this._mouseLine && this._mouseLine.getPath().setAt(1, n), this.map._addClass("hover-clickable")) : (this._mouseLine ? this._mouseLine.getPath().setAt(1, e.latLng) : this._mouseLine = this._createPolyline({
                        path: [t.getAt(t.getLength() - 1), e.latLng],
                        isTempPolyline: !0,
                        isHandDrawing: !1
                    }), this._mouseLine.getPath().setAt(1, e.latLng), this.map._removeClass("hover-clickable"))
                }
            }
        }, v._createPolyline = function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {},
                t = e.path,
                i = e.isTempPolyline,
                n = e.isHandDrawing,
                o = this._getCurrentDrawingOptions(),
                a = r.extend({
                    map: this.map,
                    path: t
                }, r.pick(o, ["strokeColor", "strokeWeight", "strokeOpacity", "editable"]));
            return r.defaults(a, _), i ? r.extend(a, {
                strokeOpacity: a.strokeOpacity *= .5,
                editable: !1
            }) : n && r.extend(a, {
                editable: !1
            }), new d(a)
        }, v._areNearPoints = function(e, t) {
            var i = 25 / Math.pow(2, this.map.zoom);
            return e && t && Math.abs(e.lng() - t.lng()) < i && Math.abs(e.lat() - t.lat()) < i
        }, v._enableDrawing = function() {
            if (!this._drawingEnabled) {
                this._drawingEnabled = !0;
                var e = this.map;
                e.setMinMouseMoveBeforeDragInPixels(this.getMinMouseMoveBeforeDragInPixels() || 0), e.on("mousemove", this._onMouseMoveHandler), e.on("click", this._onClickHandler), e.on("dragstart", this._onDragStartHandler), e.on("drag", this._onDragMoveHandler), e.on("dragend", this._onDragEndHandler), e._addClass("drawing"), e._renderer.toggleInteractiveMapOverlays(!1)
            }
        }, v._disableDrawing = function() {
            if (this._drawingEnabled) {
                this._drawingEnabled = !1;
                var e = this.map;
                e.removeListener("dragstart", this._onDragStartHandler), e.removeListener("drag", this._onDragMoveHandler), e.removeListener("dragend", this._onDragEndHandler), e._removeClass("drawing"), e.removeListener("mousemove", this._onMouseMoveHandler), e.removeListener("click", this._onClickHandler), e.setMinMouseMoveBeforeDragInPixels(0), e._renderer.toggleInteractiveMapOverlays(!0)
            }
        }, v.setMap = function(e) {
            var t = this;
            if (this.map != e) {
                if (null != this.map) {
                    if (this._onTranslationLoad.cancel(), this._$overlay) {
                        var i = this._$overlay;
                        this._eachButton(function(e, t) {
                            t.off("mousedown")
                        }), i.remove(), this._$overlay = null
                    }
                    this._disableDrawing(this.map)
                }
                this.map = e, e && (null != this.drawingMode && this._enableDrawing(), this._onTranslationLoad = m.onceLoad(function(i) {
                    var n = t._$overlay = o(h({
                        t: i
                    }));
                    e._$node.append(n), t._eachButton(function(e, i) {
                        i.on("mousedown", r.bind(t._setDrawingModeOnClick, t, e))
                    }), t._applyEnabledDrawingModes(), t._setSelectedDrawingControl(t.drawingMode), n.toggle(t.drawingControl)
                }))
            }
        }, v.cancelCurrentDrawing = function() {
            this._drawnLine && (this._drawnLine.setMap(null), this._drawnLine = null), this._mouseLine && (this._mouseLine.setMap(null), this._mouseLine = null)
        }, v._applyEnabledDrawingModes = function() {
            var e = this,
                t = this._$overlay;
            t && (this._eachButton(function(t, i) {
                var n = null == t || e._isDrawingModeAllowed(t);
                i.toggleClass("f4map-enabled", n), i.removeClass("f4map-first")
            }), t.find(".f4map-enabled").first().addClass("f4map-first"), this._isDrawingModeAllowed(this.drawingMode) || this.setDrawingMode(null))
        }, v._isDrawingModeAllowed = function(e) {
            return r.contains(this.drawingControlOptions.drawingModes, e)
        }, v.drawingmode_changed = function() {
            this._isDrawingModeAllowed(this.drawingMode) || (this.drawingMode = null), this._endDrawing(), this.map && (null != this.drawingMode ? this._enableDrawing() : this._disableDrawing(), this._setSelectedDrawingControl(this.drawingMode))
        }, v._setSelectedDrawingControl = function(e) {
            this._$overlay && this._eachButton(function(t, i) {
                i.toggleClass("f4map-selected", null != t && t == e)
            })
        }, v.drawingcontroloptions_changed = function() {
            this._$overlay && this._applyEnabledDrawingModes()
        }, v.drawingcontrol_changed = function() {
            this._$overlay && this._$overlay.toggle(this.drawingControl)
        }, v._eachButton = function(e) {
            var t = this._$overlay;
            r.each(f, function(i, n) {
                var r = t.find(".f4map-draw-" + n.toLowerCase());
                e(i, r)
            });
            var i = t.find(".f4map-draw-hand");
            e(null, i)
        }
    }, {
        "../../../templates/draw.jade": 430,
        "../../translation": 396,
        "../ControlPosition": 225,
        "../LatLng": 233,
        "../MVCArray": 235,
        "../MVCObject": 236,
        "../Polygon": 247,
        "../Polyline": 248,
        "../geometry/spherical": 259,
        "./OverlayType": 254,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    254: [function(e, t, i) {
        "use strict";
        t.exports = {
            CIRCLE: 0,
            MARKER: 1,
            POLYGON: 2,
            POLYLINE: 3,
            RECTANGLE: 4
        }
    }, {}],
    255: [function(e, t, i) {
        "use strict";
        t.exports = {
            DrawingManager: e("./DrawingManager"),
            OverlayType: e("./OverlayType")
        }
    }, {
        "./DrawingManager": 253,
        "./OverlayType": 254
    }],
    256: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            u(e).on(t, i)
        }

        function r(e, t, i) {
            return e && e.on ? (e.on(t, i), {
                instance: e,
                event: t,
                listener: i
            }) : null
        }

        function o(e) {
            e && e.instance.removeListener(e.event, e.listener)
        }

        function a(e, t, i) {
            e && e.once && e.once(t, i)
        }

        function s(e, t) {
            e && e.emit && e.emit(t)
        }

        function l(e) {
            e && e.removeAllListeners && e.removeAllListeners()
        }

        function h(e, t) {
            e && e.removeAllListeners && e.removeAllListeners(t)
        }
        var u = e("jquery");
        t.exports = {
            addDomListener: n,
            addListener: r,
            addListenerOnce: a,
            clearInstanceListeners: l,
            clearListeners: h,
            removeListener: o,
            trigger: s
        }
    }, {
        jquery: 111
    }],
    257: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = a.decode(e);
            return o.map(t, function(e) {
                return new s(e[0], e[1])
            })
        }

        function r(e) {
            return e && e.getArray && (e = e.getArray()), a.encode(o.map(e, function(e) {
                return [e.lat(), e.lng()]
            }))
        }
        var o = e("underscore"),
            a = e("polyline"),
            s = e("../LatLng");
        t.exports = {
            decodePath: n,
            encodePath: r
        }
    }, {
        "../LatLng": 233,
        polyline: 179,
        underscore: 207
    }],
    258: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i = t.getPath();
            if (i) {
                var n = s(a.map(i.getArray(), o), o(e));
                return -1 == n || 0 == n
            }
            return !1
        }

        function r() {
            return !0
        }

        function o(e) {
            return [e.lat(), e.lng()]
        }
        var a = e("underscore"),
            s = e("robust-point-in-polygon");
        t.exports = {
            containsLocation: n,
            isLocationOnEdge: r
        }
    }, {
        "robust-point-in-polygon": 194,
        underscore: 207
    }],
    259: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            return e = h.convert(e), t = h.convert(t), s.distance([e.lng(), e.lat()], [t.lng(), t.lat()], i)
        }

        function r(e, t) {
            e instanceof l && (e = e.getArray());
            for (var i = e[0], r = 0, o = 1; o < e.length; ++o) {
                var a = e[o];
                r += n(i, a, t), i = a
            }
            return r
        }

        function o(e, t, i) {
            return e = h.convert(e), t = h.convert(t), new h(e.lat() + (t.lat() - e.lat()) * i, e.lng() + (t.lng() - e.lng()) * i)
        }

        function a(e, t, i, n) {
            e = h.convert(e);
            var r = s.radial([e.lng(), e.lat()], -i, t, n);
            return new h(r[1], r[0])
        }
        var s = e("spherical"),
            l = e("../MVCArray"),
            h = e("../LatLng");
        t.exports = {
            computeDistanceBetween: n,
            computeLength: r,
            computeOffset: a,
            interpolate: o
        }
    }, {
        "../LatLng": 233,
        "../MVCArray": 235,
        spherical: 200
    }],
    260: [function(e, t, i) {
        "use strict";

        function n() {}
        var r = e("./Map"),
            o = e("./LatLng"),
            a = e("./LatLngBounds"),
            s = e("./Point"),
            l = e("./Size"),
            h = e("./Polygon"),
            u = e("./Rectangle"),
            d = e("./Polyline"),
            c = e("./Circle"),
            f = e("./StrokePosition"),
            p = e("./Marker"),
            m = e("./MarkerImage"),
            g = e("./MVCArray"),
            _ = e("./MVCObject"),
            v = e("./event"),
            y = e("./MapType"),
            b = e("./MapTypeId"),
            x = e("./ControlPosition"),
            w = e("./Geocoder"),
            M = e("./Data"),
            T = e("./GeocoderStatus"),
            S = e("./InfoWindow"),
            C = e("./Animation"),
            E = e("./OverlayView"),
            k = e("./geometry/encoding"),
            L = e("./geometry/poly"),
            P = e("./geometry/spherical"),
            A = e("./KmlLayer"),
            R = e("./KmlLayerStatus"),
            D = e("./layers/TreeLayer"),
            I = e("./layers/GridLayer"),
            O = e("./layers/Layer"),
            N = e("./drawing"),
            B = e("./visualization/HeatmapLayer"),
            F = e("./visualization/WeightedLocation"),
            z = {
                OK: 0,
                UNKNOWN_ERROR: 1,
                ZERO_RESULTS: 2
            },
            H = {
                INVALID_REQUEST: 0,
                MAX_WAYPOINTS_EXCEEDED: 1,
                NOT_FOUND: 2,
                OK: 3,
                OVER_QUERY_LIMIT: 4,
                REQUEST_DENIED: 5,
                UNKNOWN_ERROR: 6,
                ZERO_RESULTS: 7
            };
        t.exports = {
            MVCObject: _,
            MVCArray: g,
            LatLng: o,
            LatLngBounds: a,
            Map: r,
            OverlayView: E,
            Marker: p,
            MarkerImage: m,
            Size: l,
            Point: s,
            Polygon: h,
            Rectangle: u,
            Polyline: d,
            Circle: c,
            StrokePosition: f,
            ImageMapType: n,
            InfoWindow: S,
            GeocoderStatus: T,
            Geocoder: w,
            StyledMapType: n,
            FusionTablesLayer: n,
            KmlLayer: A,
            KmlLayerStatus: R,
            StreetViewService: n,
            StreetViewPanorama: n,
            StreetViewStatus: z,
            DirectionsService: n,
            DirectionsRenderer: n,
            DirectionsStatus: H,
            GroundOverlay: n,
            Data: M,
            drawing: N,
            event: v,
            MapType: y,
            MapTypeId: b,
            MapTypeControlStyle: {
                DEFAULT: 0,
                DROPDOWN_MENU: 1,
                HORIZONTAL_BAR: 2
            },
            ControlPosition: x,
            ZoomControlStyle: {
                DEFAULT: 0,
                LARGE: 1,
                SMALL: 2
            },
            SymbolPath: {
                BACKWARD_CLOSED_ARROW: 0,
                BACKWARD_OPEN_ARROW: 1,
                CIRCLE: 2,
                FORWARD_CLOSED_ARROW: 3,
                FORWARD_OPEN_ARROW: 4
            },
            Animation: C,
            places: {
                PlacesService: n,
                Autocomplete: n
            },
            visualization: {
                MapsEngineLayer: n,
                HeatmapLayer: B,
                WeightedLocation: F
            },
            TravelMode: {
                BICYCLING: 0,
                DRIVING: 1,
                TRANSIT: 2,
                WALKING: 3
            },
            geometry: {
                encoding: k,
                poly: L,
                spherical: P
            },
            engine: {
                Object3D: e("engine").Object3D,
                Geometry: e("engine").Geometry,
                Vector3: e("engine").Vector3,
                Color: e("engine").Color,
                WebGLPerformanceCalculator: e("engine").WebGLPerformanceCalculator,
                Model: e("engine").Model,
                OBJImporter: e("engine").OBJImporter,
                TriangulationUtils: e("engine/tools").TriangulationUtils,
                ShapeUtils: e("engine/tools").ShapeUtils,
                Constants: e("engine").Constants
            },
            utils: {
                PathResolver: e("../utils/StaticFileResolver"),
                LocationHelper: e("../utils/LocationHelper"),
                CameraHelper: e("../graphic/camera/CameraHelper"),
                CameraAnimator: e("../graphic/camera/CameraAnimator")
            },
            BuildingLayer: e("./BuildingLayer"),
            DetailsLayer: e("./DetailsLayer"),
            TreeLayer: D,
            GridLayer: I,
            Layer: O,
            DelayCache: e("./cache/DelayCache"),
            NotImplemented: n,
            weather: {
                CloudLayer: e("./weather/CloudLayer"),
                PrecipitationType: e("./weather/PrecipitationType"),
                PrecipitationLayer: e("./weather/PrecipitationLayer"),
                FogType: e("./weather/FogType"),
                FogLayer: e("./weather/FogLayer"),
                WindLayer: e("./weather/WindLayer")
            }
        }, n.prototype.setMap = n, n.prototype.getMap = n, n.prototype.setOptions = n, n.prototype.setPanel = n, n.prototype.open = n, n.prototype.setVisible = n, n.prototype.bindTo = n, n.prototype.getPanoramaByLocation = function(e, t, i) {
            i(null, z.UNKNOWN_ERROR)
        }, n.prototype.route = function(e, t) {
            t(null, H.UNKNOWN_ERROR)
        }
    }, {
        "../graphic/camera/CameraAnimator": 328,
        "../graphic/camera/CameraHelper": 330,
        "../utils/LocationHelper": 407,
        "../utils/StaticFileResolver": 410,
        "./Animation": 222,
        "./BuildingLayer": 223,
        "./Circle": 224,
        "./ControlPosition": 225,
        "./Data": 226,
        "./DetailsLayer": 227,
        "./Geocoder": 228,
        "./GeocoderStatus": 229,
        "./InfoWindow": 230,
        "./KmlLayer": 231,
        "./KmlLayerStatus": 232,
        "./LatLng": 233,
        "./LatLngBounds": 234,
        "./MVCArray": 235,
        "./MVCObject": 236,
        "./Map": 237,
        "./MapType": 238,
        "./MapTypeId": 239,
        "./Marker": 241,
        "./MarkerImage": 242,
        "./OverlayView": 245,
        "./Point": 246,
        "./Polygon": 247,
        "./Polyline": 248,
        "./Rectangle": 249,
        "./Size": 250,
        "./StrokePosition": 251,
        "./cache/DelayCache": 252,
        "./drawing": 255,
        "./event": 256,
        "./geometry/encoding": 257,
        "./geometry/poly": 258,
        "./geometry/spherical": 259,
        "./layers/GridLayer": 262,
        "./layers/Layer": 263,
        "./layers/TreeLayer": 265,
        "./visualization/HeatmapLayer": 298,
        "./visualization/WeightedLocation": 299,
        "./weather/CloudLayer": 300,
        "./weather/FogLayer": 301,
        "./weather/FogType": 302,
        "./weather/PrecipitationLayer": 303,
        "./weather/PrecipitationType": 304,
        "./weather/WindLayer": 305,
        engine: 10,
        "engine/tools": 97
    }],
    261: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = e.authorizations;
            t.authorized || (o && "NO_API_KEY" == t.code ? console.warn("Missing F4map API key, please contact the support at support@f4map.com to obtain a key, then add it as the api_key parameter.\nAPI uses without valid API key will be disabled soon.\n") : console.error("Invalid F4map API key, please fix it or contact the support at support@f4map.com to allow your domain. Code: %s.", t.code))
        }

        function r(e, t) {
            var i = e.authorizations;
            i.authorized || o && "NO_API_KEY" == i.code || t.html('<div class="f4map-error"><div class="f4map-forbidden"></div>Oops! Unauthorized F4map API usage. If you are this website administrator, please contact the support at support@f4map.com.</div>')
        }
        t.exports = {
            logOnAuthorizationsResult: n,
            checkAllowedApiUsage: r
        };
        var o = !0
    }, {}],
    262: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.options = r.clone(e), o.call(this, e), this.minZoom = this.minZoom || this.zoom, this._tiles = {}
        }
        var r = e("underscore"),
            o = e("./Layer"),
            a = e("util"),
            s = e("../../utils/TileHelper"),
            l = e("./Tile"),
            h = e("../../graphic/camera/CameraHelper");
        a.inherits(n, o), n.prototype.handleUnsetMap = function() {
            this.releaseAllTiles(), o.prototype.handleUnsetMap.apply(this, arguments)
        }, n.prototype.forceUpdateTiles = function() {
            if (this.canWork()) {
                this._setTargetAnimation(), this.dirty = !1;
                var e = this.map._renderer.getZoom();
                if (e < this.minZoom) return r.each(this._tiles, function(e) {
                    e.released = !0, this.releaseTile(e)
                }, this), this._tiles = {}, void this._unsetTargetAnimation();
                var t = this.map._renderer.isIn3d() ? this.maxDistance : null,
                    i = s.computeFrustum(this.map._renderer, t),
                    n = [],
                    o = this._tiles,
                    a = this.zoom;
                this.target || r.each(o, function(e) {
                    (s.isOutsideFrustum(e, i) || e.zoom != a) && n.push(e)
                }, this);
                var h, u, d = s.sphericalMercatorToTile(i.xMin, i.yMin, a),
                    c = s.sphericalMercatorToTile(i.xMax, i.yMax, a),
                    f = [];
                for (u = c.y; u <= d.y; u += 1)
                    for (h = d.x; h <= c.x; h += 1) {
                        var p = {
                                x: h,
                                y: u,
                                z: a
                            },
                            m = s.generateKey(p);
                        if (!(m in o)) {
                            var g = s.getTileBounds(p),
                                _ = new l(null, l.CELL, p, g);
                            if (!s.isOutsideFrustum(_, i)) {
                                var v = this.getTile(m);
                                v ? o[m] = v : f.push(_)
                            }
                        }
                    }
                this._unsetTargetAnimation(), r.each(f, function(e) {
                    o[e.id] = e, e.visible = !0, e.active = !0, this.emit("tile", e)
                }, this), r.each(n, function(e) {
                    e.released = !0, this.releaseTile(e), delete o[e.id]
                }, this)
            }
        }, n.prototype.setTarget = function(e) {
            this.target = e
        }, n.prototype._setTargetAnimation = function() {
            if (this.map && this.target) {
                var e = this.map._renderer;
                this._backupCamera = e.backupCamera(), this._backupZoom = e.conf.zoom, e._cameraManager.setTargetAndPosition(this.target.camTarget, this.target.camPos), e.conf.zoom = h.computeRoundZoomFromDistance(e.conf, e._cameraManager.getDistance())
            }
        }, n.prototype._unsetTargetAnimation = function() {
            if (this.map && this.target) {
                var e = this.map._renderer;
                this._backupCamera && (e.restoreCamera(this._backupCamera), this._backupCamera = null), null != this._backupZoom && (e.conf.zoom = this._backupZoom, this._backupZoom = null)
            }
        }, n.prototype.forEach = function(e, t) {
            r.each(this._tiles, e, t)
        }, n.prototype.releaseAllTiles = function() {
            o.prototype.releaseAllTiles.call(this), r.each(this._tiles, function(e) {
                e.released = !0, e.emit("released")
            }), this._tiles = {}
        }, n.prototype.enlargeTileBounds = function(e, t) {
            var i = this._tiles[e];
            !i && this.cache && (i = this.cache.get(e, !0)), i && i.enlargeYourBounds(t)
        }, t.exports = n
    }, {
        "../../graphic/camera/CameraHelper": 330,
        "../../utils/TileHelper": 411,
        "./Layer": 263,
        "./Tile": 264,
        underscore: 207,
        util: 212
    }],
    263: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.call(this), this.map = null, this.refreshPeriod = 0, this.isEnabled = !0, this.dirty = !0, this._setDirtyCallback = a.bind(this.setDirty, this), this._updateTilesCallback = a.bind(this.updateTiles, this);
            var t = this;
            this._forceUpdateTilesCallback = function() {
                a.defer(function() {
                    t.map && t.forceUpdateTiles()
                })
            }, this._refreshInterval = null, this.setOptions(e)
        }
        var r = e("../MVCObject"),
            o = e("util"),
            a = e("underscore");
        t.exports = n, o.inherits(n, r);
        var s = n.prototype;
        s.setOptions = function(e) {
            this.setValues(e)
        }, s.setValues = function(e) {
            if (e) {
                var t = !1;
                "map" in e && e.map !== this.map && (this.map && (this.handleUnsetMap(), this.map = null), t = !0), a.each(e, function(e, t) {
                    switch (t) {
                        case "map":
                            break;
                        case "refreshPeriod":
                            this.setRefreshPeriod(e);
                            break;
                        default:
                            this.set(t, e)
                    }
                    "map" != t && this.set(t, e)
                }, this), t && this.setMap(e.map)
            }
        }, s.handleSetMap = function() {
            this._startRefreshPeriod()
        }, s.handleUnsetMap = function() {
            this.map && (this._type && this._unregisterInMapLayers(this._type), this.map.removeListener("bounds_changed", this._setDirtyCallback), this.map.removeListener("idle", this._forceUpdateTilesCallback), this._clearRefreshPeriod(), this.setDirty(), this.cache && this.cache.clear())
        }, s.setMap = function(e) {
            if (e = e || null, e !== this.map && (this.map && this.handleUnsetMap(), this.set("map", e), e)) {
                if (e !== this.map) return;
                this.handleSetMap(), e.addListener("bounds_changed", this._setDirtyCallback), e.addListener("idle", this._forceUpdateTilesCallback), this.setDirty(), this._type && this._registerInMapLayers(this._type)
            }
        }, s._registerInMapLayers = function(e) {
            var t = this.map._layersByType[e] = this.map._layersByType[e] || [];
            t.push(this)
        }, s._unregisterInMapLayers = function(e) {
            var t = this.map._layersByType[e] = this.map._layersByType[e] || [],
                i = t.indexOf(this);
            i > -1 && t.splice(i, 1)
        }, s.setRefreshPeriod = function(e) {
            e = e || 0, e !== this.refreshPeriod && (this.set("refreshPeriod", e), this.map && this._startRefreshPeriod())
        }, s._clearRefreshPeriod = function() {
            this._refreshInterval && clearInterval(this._refreshInterval)
        }, s._startRefreshPeriod = function() {
            this._clearRefreshPeriod(), this.refreshPeriod > 0 ? this._refreshInterval = setInterval(this._updateTilesCallback, this.refreshPeriod) : this._refreshInterval = null
        }, s.setEnabled = function(e) {
            this.isEnabled = e, this.setDirty()
        }, s.setDirty = function() {
            this.dirty = this.isEnabled
        }, s.updateTiles = function() {
            this.dirty && this.forceUpdateTiles()
        }, s.forceUpdateTiles = function() {
            this.dirty = !1
        }, s.getTile = function(e) {
            return this.cache ? this.cache.get(e) : null
        }, s.releaseTile = function(e) {
            this.cache && this.isCacheable(e) ? this.cache.set(e) : e.emit("released")
        }, s.isCacheable = function(e) {
            return !0
        }, s.releaseAllTiles = function() {
            this.cache && this.cache.clear()
        }, s.canWork = function() {
            return Boolean(this.isEnabled && this.map && this.map._renderer)
        }
    }, {
        "../MVCObject": 236,
        underscore: 207,
        util: 212
    }],
    264: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            o.call(this), this.parentTile = e, this.childType = t, this.coord = i, this.key = i, this.id = a.generateKey(i), this.zoom = i.z, this.bounds = n, this.center = {
                x: (n.xMin + n.xMax) / 2,
                y: (n.yMin + n.yMax) / 2
            }, this.width = n.xMax - n.xMin, this.radius = p * this.width, this.childrenTiles = [], this.visible = !1, this.active = !1, this.released = !1
        }
        var r = e("underscore"),
            o = e("events").EventEmitter,
            a = e("../../utils/TileHelper"),
            s = e("util"),
            l = -1,
            h = -2,
            u = 0,
            d = 1,
            c = 2,
            f = 3,
            p = Math.sqrt(2);
        s.inherits(n, o), n.prototype.isOverlapping = function(e) {
            return !(e.bounds.xMin > this.bounds.xMax || e.bounds.xMax < this.bounds.xMin || e.bounds.yMin > this.bounds.yMax || e.bounds.yMax < this.bounds.yMin)
        }, n.prototype.enlargeYourBounds = function(e) {
            this.bounds.xMin = Math.min(e.left, this.bounds.xMin), this.bounds.xMax = Math.max(e.right, this.bounds.xMax), this.bounds.yMin = Math.min(e.bottom, this.bounds.yMin), this.bounds.yMax = Math.max(e.top, this.bounds.yMax), this.width = this.bounds.xMax - this.bounds.xMin, this.radius = p * Math.max(this.width, this.bounds.yMax - this.bounds.yMin)
        }, n.prototype.forEach = function(e) {
            if (this.childrenTiles.length) {
                var t = !1,
                    i = [];
                i.push.apply(i, this.childrenTiles);
                for (var n, r = {
                        abort: function() {
                            t = !0
                        }
                    };
                    (n = i.pop()) && (e(n, r), !t);) n.childrenTiles.length && i.push.apply(i, n.childrenTiles)
            }
        }, n.prototype.hasParentOrChildOverlapping = function(e) {
            return r.find(e, function(e) {
                return this != e ? this.isOverlapping(e) : !1
            }, this)
        }, n.prototype.forEachAncestor = function(e) {
            if (this.parentTile)
                for (var t, i = !1, n = [this.parentTile], r = {
                        abort: function() {
                            i = !0
                        }
                    };
                    (t = n.pop()) && (e(t, r), !i);) t.parentTile && n.push(t.parentTile)
        }, t.exports = n, t.exports.ROOT = l, t.exports.CELL = h, t.exports.TOP_LEFT = u, t.exports.TOP_RIGHT = d, t.exports.BOTTOM_LEFT = c, t.exports.BOTTOM_RIGHT = f
    }, {
        "../../utils/TileHelper": 411,
        events: 99,
        underscore: 207,
        util: 212
    }],
    265: [function(e, t, i) {
        "use strict";

        function n(e) {
            for (var t = [], i = 19; i >= 0; --i) t[i] = e, e *= 2;
            return t
        }

        function r(e) {
            this.options = e, this._tilesToActivate = [], this._tilesToDeactivate = [], this._tilesToShow = [], this._tilesToHide = [], this._tilesToDelete = [], a.call(this, e)
        }
        var o = e("underscore"),
            a = e("./Layer"),
            s = e("util"),
            l = e("./Tile"),
            h = e("./TreeLayerDivider"),
            u = e("../../utils/TileHelper"),
            d = e("../../graphic/camera/CameraHelper");
        s.inherits(r, a);
        var c = a.prototype;
        r.prototype.createRootTile = function() {
            this._rootTile || (this._rootTile = new l(null, l.ROOT, {
                x: 0,
                y: 0,
                z: 0
            }, u.getWorldBounds()), this.emit("tile", this._rootTile))
        }, r.prototype.handleUnsetMap = function() {
            this.releaseAllTiles(), a.prototype.handleUnsetMap.apply(this, arguments)
        }, r.prototype.handleSetMap = function() {
            if (this.map) {
                this.setWorkOnMove(this.options.workOnMove);
                var e = this.qualityTable = {},
                    t = this.map.conf;
                e.near = n(t.get("tiles.nearScreenQuality")), e.middle = n(t.get("tiles.midScreenQuality")), e.far = n(t.get("tiles.farScreenQuality")), e.veryFar = n(t.get("tiles.veryFarScreenQuality"))
            }
        }, r.prototype.forceUpdateTiles = function() {
            return this._setTargetAnimation(), this.canWork() ? (this.map && (this._rootTile || this.createRootTile(), this.forEach(h.create(this))), this.update(), this.dirty = !1, void this._unsetTargetAnimation()) : void this._unsetTargetAnimation()
        }, r.prototype.forEach = function(e) {
            for (var t = !1, i = [this._rootTile], n = {
                    abort: function() {
                        t = !0
                    }
                }, r = i.pop(); r && (e(r, n), !t);) r.childrenTiles.length && i.push.apply(i, r.childrenTiles), r = i.pop()
        }, r.prototype.createChildren = function(e) {
            if (!e.childrenTiles.length) {
                var t = e.bounds,
                    i = e.center,
                    n = e.coord,
                    r = e.zoom + 1,
                    a = [{
                        type: l.TOP_LEFT,
                        coord: {
                            x: 2 * n.x,
                            y: 2 * n.y,
                            z: r
                        },
                        bounds: {
                            xMin: t.xMin,
                            yMax: t.yMax,
                            xMax: i.x,
                            yMin: i.y
                        }
                    }, {
                        type: l.TOP_RIGHT,
                        coord: {
                            x: 2 * n.x + 1,
                            y: 2 * n.y,
                            z: r
                        },
                        bounds: {
                            xMin: i.x,
                            yMax: t.yMax,
                            xMax: t.xMax,
                            yMin: i.y
                        }
                    }, {
                        type: l.BOTTOM_LEFT,
                        coord: {
                            x: 2 * n.x,
                            y: 2 * n.y + 1,
                            z: r
                        },
                        bounds: {
                            xMin: t.xMin,
                            yMax: i.y,
                            xMax: i.x,
                            yMin: t.yMin
                        }
                    }, {
                        type: l.BOTTOM_RIGHT,
                        coord: {
                            x: 2 * n.x + 1,
                            y: 2 * n.y + 1,
                            z: r
                        },
                        bounds: {
                            xMin: i.x,
                            yMax: i.y,
                            xMax: t.xMax,
                            yMin: t.yMin
                        }
                    }];
                o.each(a, function(t) {
                    var i = u.generateKey(t.coord),
                        n = this.getTile(i);
                    n || (n = new l(e, t.type, t.coord, t.bounds), this.emit("tile", n)), e.childrenTiles.push(n)
                }, this)
            }
        }, r.prototype.releaseChildren = function(e) {
            if (e.childrenTiles.length) {
                for (var t = 0; t < e.childrenTiles.length; ++t) {
                    var i = e.childrenTiles[t];
                    this.releaseChildren(i), i.released = !0, this.hideTile(i), this.deactivateTile(i), this.releaseTile(i)
                }
                e.childrenTiles.length = 0
            }
        }, r.prototype.showTile = function(e) {
            e.visible || this._tilesToShow.push(e)
        }, r.prototype.hideTile = function(e) {
            e.visible && this._tilesToHide.push(e)
        }, r.prototype.activateTile = function(e) {
            e.active || this._tilesToActivate.push(e)
        }, r.prototype.releaseTile = function(e) {
            this.cache && this.isCacheable(e) ? this.cache.set(e) : this._tilesToDelete.push(e)
        }, r.prototype.update = function() {
            o.each(this._tilesToShow, function(e) {
                e.visible = !0, e.emit("shown", e)
            }), this._tilesToShow.length = 0, o.each(this._tilesToActivate, function(e) {
                e.active = !0, e.emit("active", e)
            }), this._tilesToActivate.length = 0, this.target || (o.each(this._tilesToHide, function(e) {
                e.visible = !1, e.emit("hidden", e)
            }), this._tilesToHide.length = 0, o.each(this._tilesToDeactivate, function(e) {
                e.active = !1, e.emit("inactive", e)
            }), this._tilesToDeactivate.length = 0, o.each(this._tilesToDelete, function(e) {
                e.emit("released")
            }), this._tilesToDelete.length = 0)
        }, r.prototype.deactivateTile = function(e) {
            e.active && this._tilesToDeactivate.push(e)
        }, r.prototype.releaseAllTiles = function() {
            this._rootTile && (this.releaseChildren(this._rootTile), this._rootTile.released = !0, this.hideTile(this._rootTile), this.deactivateTile(this._rootTile), this.releaseTile(this._rootTile), this._rootTile = null, this.update()), a.prototype.releaseAllTiles.call(this)
        }, r.prototype.setOptions = function(e) {
            null != e.workOnMove && this.setWorkOnMove(e.workOnMove), c.setOptions.call(this, e)
        }, r.prototype.setWorkOnMove = function(e) {
            if (this.map) {
                var t = this.map._renderer._featuresRequestManager.priorityRequests.getPriorityRequest(this.options.featureRequestConf.priority);
                this.workOnMove = t.workOnMove = e
            }
        }, r.prototype.setTarget = function(e, t) {
            e || null == this._backupWorkOnMove ? e && (this._backupWorkOnMove = this.workOnMove, this.setWorkOnMove(t)) : (this.setWorkOnMove(this._backupWorkOnMove), delete this._backupWorkOnMove), this.target = e
        }, r.prototype._setTargetAnimation = function() {
            if (this.map && this.target) {
                var e = this.map._renderer;
                this._backupCamera = e.backupCamera(), this._backupZoom = e.conf.zoom, e._cameraManager.setTargetAndPosition(this.target.camTarget, this.target.camPos), e.conf.zoom = d.computeRoundZoomFromDistance(e.conf, e._cameraManager.getDistance())
            }
        }, r.prototype._unsetTargetAnimation = function() {
            if (this.map && this.target) {
                var e = this.map._renderer;
                this._backupCamera && (e.restoreCamera(this._backupCamera), this._backupCamera = null), null != this._backupZoom && (e.conf.zoom = this._backupZoom, this._backupZoom = null)
            }
        }, t.exports = r
    }, {
        "../../graphic/camera/CameraHelper": 330,
        "../../utils/TileHelper": 411,
        "./Layer": 263,
        "./Tile": 264,
        "./TreeLayerDivider": 266,
        underscore: 207,
        util: 212
    }],
    266: [function(e, t, i) {
        "use strict";
        var n = e("../../utils/TileHelper");
        t.exports.create = function(e) {
            function t(t) {
                var i = t.center,
                    n = t.width,
                    a = t.zoom;
                if (0 == a) return !0;
                if (a >= 20) return !1;
                var s = Math.max(Math.abs(i.x - r.x), Math.abs(i.y - r.y), Math.abs(r.z)),
                    l = e.qualityTable;
                return .5 * o > s ? n + l.near[a] > s : s > 1.2 * o ? n + l.far[a] > s : s > 1.7 * o ? n + l.veryFar[a] > s : n + l.middle[a] > o
            }
            var i = e.map._renderer,
                r = i.getPosCamera(),
                o = i.computeDistanceToCenter(r),
                a = e.map._renderer.isIn3d() ? e.options.maxDistance : null,
                s = n.computeFrustum(i, a);
            return function(i) {
                n.isOutsideFrustum(i, s) ? (e.releaseChildren(i), e.hideTile(i), e.deactivateTile(i), e.releaseTile(i)) : (e.showTile(i), t(i) ? (e.deactivateTile(i), e.createChildren(i)) : (e.activateTile(i), e.releaseChildren(i)))
            }
        }
    }, {
        "../../utils/TileHelper": 411
    }],
    267: [function(e, t, i) {
        "use strict";
        var n = e("./Point"),
            r = t.exports = function(e, t) {
                if (e instanceof r) return this.min = e.min.clone(), void(this.max = e.max.clone());
                for (var i = t ? [e, t] : e, n = 0, o = i.length; o > n; n++) this.extend(i[n])
            };
        r.prototype = {
            extend: function(e) {
                return e = new n(e), this.min || this.max ? (this.min.x = Math.min(e.x, this.min.x), this.max.x = Math.max(e.x, this.max.x), this.min.y = Math.min(e.y, this.min.y), this.max.y = Math.max(e.y, this.max.y)) : (this.min = e.clone(), this.max = e.clone()), this
            },
            getCenter: function(e) {
                return new n((this.min.x + this.max.x) / 2, (this.min.y + this.max.y) / 2, e)
            },
            contains: function(e) {
                var t, i;
                return e = "number" == typeof e[0] || e instanceof n ? n(e) : r(e), e instanceof r ? (t = e.min, i = e.max) : t = i = e, t.x >= this.min.x && i.x <= this.max.x && t.y >= this.min.y && i.y <= this.max.y
            }
        }
    }, {
        "./Point": 286
    }],
    268: [function(e, t, i) {
        "use strict";
        t.exports = {
            mobile: !1
        }
    }, {}],
    269: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Point"),
            o = e("./Projection"),
            a = e("./Transformation"),
            s = t.exports = {
                latLngToPoint: function(e, t) {
                    var i = this.projection.project(e),
                        n = this.scale(t);
                    return this.transformation._transform(i, n)
                },
                pointToLatLng: function(e, t) {
                    var i = this.scale(t),
                        n = this.transformation.untransform(e, i);
                    return this.projection.unproject(n)
                },
                project: function(e) {
                    return this.projection.project(e)
                },
                scale: function(e) {
                    return 256 * Math.pow(2, e)
                },
                getSize: function(e) {
                    var t = this.scale(e);
                    return new r(t, t)
                }
            };
        s.Simple = n.extend({}, s, {
            projection: o.LonLat,
            transformation: new a(1, 0, -1, 0),
            scale: function(e) {
                return Math.pow(2, e)
            }
        }), s.EPSG4326 = n.extend({}, s, {
            code: "EPSG:4326",
            projection: o.LonLat,
            transformation: new a(1 / 360, .5, -1 / 360, .5)
        }), s.EPSG3857 = n.extend({}, s, {
            code: "EPSG:3857",
            projection: o.SphericalMercator,
            transformation: new a(.5 / Math.PI, .5, -.5 / Math.PI, .5),
            project: function(e) {
                var t = this.projection.project(e),
                    i = 6378137;
                return t.multiplyBy(i)
            }
        }), s.EPSG900913 = n.extend({}, s.EPSG3857, {
            code: "EPSG:900913"
        }), s.EPSG3395 = n.extend({}, s, {
            code: "EPSG:3395",
            projection: o.Mercator,
            transformation: function() {
                var e = o.Mercator,
                    t = e.R_MAJOR,
                    i = .5 / (Math.PI * t);
                return new a(i, .5, -i, .5)
            }()
        })
    }, {
        "./Point": 286,
        "./Projection": 290,
        "./Transformation": 293,
        underscore: 207
    }],
    270: [function(e, t, i) {
        "use strict";
        var n = e("./Class"),
            r = e("./Evented"),
            o = e("./LatLng");
        t.exports = n.extend({
            includes: r,
            options: {},
            initialize: function(e, t) {
                this._latlng = o(e), this._mRadius = t
            },
            addTo: function() {
                return this
            },
            getLatLng: function() {
                return this._latlng
            },
            getRadius: function() {
                return this._mRadius
            }
        })
    }, {
        "./Class": 271,
        "./Evented": 275,
        "./LatLng": 281
    }],
    271: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = t.exports = function() {};
        r.extend = function(e) {
            var t = function() {
                    this.initialize && this.initialize.apply(this, arguments), this._initHooks && this.callInitHooks()
                },
                i = function() {};
            i.prototype = this.prototype;
            var r = new i;
            r.constructor = t, t.prototype = r;
            for (var o in this) this.hasOwnProperty(o) && "prototype" !== o && (t[o] = this[o]);
            e.statics && (n.extend(t, e.statics), delete e.statics), e.includes && (n.extend.apply(null, [r].concat(e.includes)), delete e.includes), e.options && r.options && (e.options = n.extend({}, r.options, e.options)), n.extend(r, e), r._initHooks = [];
            var a = this;
            return t.__super__ = a.prototype, r.callInitHooks = function() {
                if (!this._initHooksCalled) {
                    a.prototype.callInitHooks && a.prototype.callInitHooks.call(this), this._initHooksCalled = !0;
                    for (var e = 0, t = r._initHooks.length; t > e; e++) r._initHooks[e].call(this)
                }
            }, t
        }, r.include = function(e) {
            n.extend(this.prototype, e)
        }, r.mergeOptions = function(e) {
            n.extend(this.prototype.options, e)
        }, r.addInitHook = function(e) {
            var t = Array.prototype.slice.call(arguments, 1),
                i = "function" == typeof e ? e : function() {
                    this[e].apply(this, t)
                };
            this.prototype._initHooks = this.prototype._initHooks || [], this.prototype._initHooks.push(i)
        }
    }, {
        underscore: 207
    }],
    272: [function(e, t, i) {
        "use strict";
        var n = e("./Class");
        t.exports = n.extend({
            initialize: function() {},
            addTo: function() {
                return void 0
            }
        })
    }, {
        "./Class": 271
    }],
    273: [function(e, t, i) {
        "use strict";
        var n = e("./Icon"),
            r = e("jquery"),
            o = e("underscore");
        t.exports = n.extend({
            options: {
                iconSize: [12, 12],
                className: "leaflet-div-icon",
                html: !1
            },
            createIcon: function() {
                var e = {},
                    t = this.options.iconSize;
                return t && o.extend(e, {
                    width: t.x + "px",
                    height: t.y + "px"
                }), r("<div>").addClass(this.options.className).css(e).append(this.options.html).get(0)
            }
        })
    }, {
        "./Icon": 279,
        jquery: 111,
        underscore: 207
    }],
    274: [function(e, t, i) {
        "use strict";
        var n = e("jquery");
        t.exports = {
            TRANSITION: "transition",
            TRANSITION_END: "transitionend",
            create: function(e, t, i) {
                var r = n("<" + e + ">");
                return r.addClass(t), i && r.appendTo(n(i)), r.get(0)
            }
        }
    }, {
        jquery: 111
    }],
    275: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var r = this;
            if (h.isObject(e)) return i || (i = t), h.each(e, function(e, t) {
                e && n.call(r, t, e, i)
            }), this;
            var o, a, s, l, c, f, p, m = this[d] = this[d] || {},
                g = i && i !== this && u.stamp(i);
            for (e = u.splitWords(e), o = 0, a = e.length; a > o; o++) s = {
                action: t,
                context: i || this
            }, l = e[o], g ? (c = l + "_idx", f = c + "_len", p = m[c] = m[c] || {}, p[g] || (p[g] = [], m[f] = (m[f] || 0) + 1), p[g].push(s)) : (m[l] = m[l] || [], m[l].push(s));
            return this
        }

        function r(e) {
            var t = this[d];
            return !!t && (e in t && t[e].length > 0 || e + "_idx" in t && t[e + "_idx_len"] > 0)
        }

        function o(e, t, i) {
            var n = this;
            if (!this[d]) return this;
            if (!e) return a();
            if (h.isObject(e)) return i || (i = t), h.each(e, function(e, t) {
                e && o.call(n, t, e, i)
            }), this;
            var r, s, l, c, f, p, m, g, _, v = this[d],
                y = i && i !== this && u.stamp(i);
            for (e = u.splitWords(e), r = 0, s = e.length; s > r; r++)
                if (l = e[r], p = l + "_idx", m = p + "_len", g = v[p], t) {
                    if (c = y && g ? g[y] : v[l]) {
                        for (f = c.length - 1; f >= 0; f--) c[f].action !== t || i && c[f].context !== i || (_ = c.splice(f, 1), _[0].action = u.falseFn);
                        i && g && 0 === c.length && (delete g[y], v[m]--)
                    }
                } else delete v[l], delete v[p], delete v[m];
            return this
        }

        function a() {
            return delete this[d], this
        }

        function s(e, t) {
            if (!r.call(this, e)) return this;
            var i, n, o, a, s, l = h.extend({}, t, {
                    type: e,
                    target: this
                }),
                u = this[d];
            if (u[e])
                for (i = u[e].slice(), n = 0, o = i.length; o > n; n++) i[n].action.call(i[n].context, l);
            a = u[e + "_idx"];
            for (s in a)
                if (i = a[s].slice())
                    for (n = 0, o = i.length; o > n; n++) i[n].action.call(i[n].context, l);
            return this
        }

        function l(e, t, i) {
            var n = this;
            if (h.isObject(e)) return i || (i = t), h.each(e, function(e, t) {
                e && l.call(n, t, e, i)
            }), this;
            var r = h.bind(function() {
                this.removeEventListener(e, t, i).removeEventListener(e, r, i)
            }, this);
            return this.addEventListener(e, t, i).addEventListener(e, r, i)
        }
        var h = e("underscore"),
            u = e("./Util"),
            d = "_leaflet_events";
        t.exports = {
            addEventListener: n,
            removeEventListener: o,
            addOneTimeEventListener: l,
            on: n,
            once: l,
            off: o,
            fireEvent: s,
            fire: s
        }
    }, {
        "./Util": 294,
        underscore: 207
    }],
    276: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Evented"),
            o = e("./LayerGroup"),
            a = t.exports = o.extend({
                includes: r,
                statics: {
                    EVENTS: "click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"
                },
                addLayer: function(e) {
                    return this.hasLayer(e) ? this : ("on" in e && e.on(a.EVENTS, this._propagateEvent, this), o.prototype.addLayer.call(this, e), this)
                },
                removeLayer: function(e) {
                    return this.hasLayer(e) ? ("off" in e && e.off(a.EVENTS, this._propagateEvent, this), o.prototype.removeLayer.call(this, e), this) : this
                },
                _propagateEvent: function(e) {
                    e = n.extend({
                        layer: e.target,
                        target: this
                    }, e), this.fire(e.type, e)
                }
            })
    }, {
        "./Evented": 275,
        "./LayerGroup": 283,
        underscore: 207
    }],
    277: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            var r, a, l, h, f = "Feature" === e.type ? e.geometry : e,
                p = f.coordinates,
                m = [];
            switch (i = i || this.coordsToLatLng, f.type) {
                case "Point":
                    return r = i(p), t ? t(e, r) : new u(r);
                case "MultiPoint":
                    for (l = 0, h = p.length; h > l; l++) r = i(p[l]), m.push(t ? t(e, r) : new u(r));
                    return new s(m);
                case "LineString":
                    return a = o(p, 0, i), new d(a, n);
                case "Polygon":
                    if (2 === p.length && !p[1].length) throw new Error("Invalid GeoJSON object.");
                    return a = o(p, 1, i), new c(a, n);
                case "MultiLineString":
                    return a = o(p, 1, i), new d(a[0], n);
                case "MultiPolygon":
                    return a = o(p, 2, i), new c(a[0], n);
                case "GeometryCollection":
                    for (l = 0, h = f.geometries.length; h > l; l++) m.push(this.geometryToLayer({
                        geometry: f.geometries[l],
                        type: "Feature",
                        properties: e.properties
                    }, t, i, n));
                    return new s(m);
                default:
                    throw new Error("Invalid GeoJSON object.")
            }
        }

        function r(e) {
            return new h(e[1], e[0], e[2])
        }

        function o(e, t, i) {
            var n, r, a, s = [];
            for (r = 0, a = e.length; a > r; r++) n = t ? o(e[r], t - 1, i) : (i || i)(e[r]), s.push(n);
            return s
        }
        var a = e("underscore"),
            s = e("./FeatureGroup"),
            l = e("./Util"),
            h = e("./LatLng"),
            u = e("./Marker"),
            d = e("./Polyline"),
            c = e("./Polygon"),
            f = t.exports = s.extend({
                initialize: function(e, t) {
                    l.setOptions(this, t)
                }
            });
        a.extend(f, {
            geometryToLayer: n,
            coordsToLatLng: r
        })
    }, {
        "./FeatureGroup": 276,
        "./LatLng": 281,
        "./Marker": 285,
        "./Polygon": 287,
        "./Polyline": 288,
        "./Util": 294,
        underscore: 207
    }],
    278: [function(e, t, i) {
        "use strict";
        var n = e("./Class");
        t.exports = n.extend({
            initialize: function(e) {
                this._map = e
            },
            enable: function() {
                this._enabled || (this._enabled = !0, this.addHooks())
            },
            disable: function() {
                this._enabled && (this._enabled = !1, this.removeHooks())
            },
            enabled: function() {
                return !!this._enabled
            }
        })
    }, {
        "./Class": 271
    }],
    279: [function(e, t, i) {
        "use strict";
        var n = e("jquery"),
            r = e("underscore"),
            o = e("./Class"),
            a = e("./Util"),
            s = e("../../utils/StaticFileResolver"),
            l = t.exports = o.extend({
                options: {},
                initialize: function(e) {
                    a.setOptions(this, e)
                },
                createIcon: function() {
                    var e = {},
                        t = this.options.iconSize;
                    t && r.extend(e, {
                        width: t.x + "px",
                        height: t.y + "px"
                    });
                    var i = n("<img>");
                    return i.attr({
                        src: this.options.iconUrl || s("images/marker-icon.png")
                    }), this.options.className && i.addClass(this.options.className), i.css(e), i.get(0)
                }
            });
        l.Default = l.extend({})
    }, {
        "../../utils/StaticFileResolver": 410,
        "./Class": 271,
        "./Util": 294,
        jquery: 111,
        underscore: 207
    }],
    280: [function(e, t, i) {
        "use strict";
        var n = e("./Class"),
            r = e("./Evented");
        t.exports = n.extend({
            includes: r,
            style: {},
            initialize: function() {},
            addTo: function() {
                return this
            }
        })
    }, {
        "./Class": 271,
        "./Evented": 275
    }],
    281: [function(e, t, i) {
        "use strict";
        var n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
            },
            r = e("underscore"),
            o = e("../geometry/spherical"),
            a = t.exports = function(e, t) {
                return e instanceof a ? this instanceof a ? (this.lat = e.lat, void(this.lng = e.lng)) : e : r.isArray(e) ? "number" == typeof e[0] || "string" == typeof e[0] ? new a(e[0], e[1], e[2]) : null : void 0 === e || null === e ? e : "object" === ("undefined" == typeof e ? "undefined" : n(e)) && "lat" in e ? new a(e.lat, "lng" in e ? e.lng : e.lon) : void 0 === t ? null : (this.lat = e, void(this.lng = t))
            };
        r.extend(a, {
            DEG_TO_RAD: Math.PI / 180,
            RAD_TO_DEG: 180 / Math.PI,
            MAX_MARGIN: 1e-9
        }), a.prototype = {
            wrap: function(e, t) {
                var i = this.lng;
                return e = e || -180, t = t || 180, i = (i + t) % (t - e) + (e > i || i === t ? t : e), new a(this.lat, i)
            },
            distanceTo: function(e) {
                return o.computeDistanceBetween(this, e)
            }
        }, a._fromF4LatLng = function(e) {
            return new a(e.lat(), e.lng())
        }
    }, {
        "../geometry/spherical": 259,
        underscore: 207
    }],
    282: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Class"),
            o = e("../LatLngBounds"),
            a = e("./LatLng"),
            s = t.exports = r.extend({
                initialize: function(e, t) {
                    var i = this;
                    e ? e instanceof s ? this._bounds = e._bounds : n.isArray(e) && !t ? (this._bounds = new o, n.each(e, function(e) {
                        return i._bounds.extend(e)
                    })) : this._bounds = new o(e, t) : this._bounds = new o, this._syncPrivateProperties()
                },
                getNorth: function() {
                    return this._bounds.ne.lat()
                },
                getSouth: function() {
                    return this._bounds.sw.lat()
                },
                getEast: function() {
                    return this._bounds.ne.lng()
                },
                getWest: function() {
                    return this._bounds.sw.lng()
                },
                getSouthWest: function() {
                    return a._fromF4LatLng(this._bounds.sw)
                },
                getNorthEast: function() {
                    return a._fromF4LatLng(this._bounds.ne)
                },
                getCenter: function() {
                    var e = this._bounds.getCenter();
                    return e ? a._fromF4LatLng(e) : null
                },
                extend: function(e) {
                    return e instanceof s ? (this._bounds.extend(e._bounds.ne), this._bounds.extend(e._bounds.sw)) : this._bounds.extend(e), this._syncPrivateProperties(), this
                },
                contains: function(e) {
                    return e instanceof s ? this._bounds.contains(e.getSouthWest()) && this._bounds.contains(e.getNorthEast()) : this._bounds.contains(e)
                },
                intersects: function(e) {
                    return this._bounds.intersects(e._bounds)
                },
                pad: function() {
                    return new s(this._bounds.sw, this._bounds.ne)
                },
                _syncPrivateProperties: function() {
                    this._bounds.ne && (this._northEast = a._fromF4LatLng(this._bounds.ne)), this._bounds.sw && (this._southWest = a._fromF4LatLng(this._bounds.sw))
                }
            })
    }, {
        "../LatLngBounds": 234,
        "./Class": 271,
        "./LatLng": 281,
        underscore: 207
    }],
    283: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Class"),
            o = e("./helpers/layerCollection");
        t.exports = r.extend({
            initialize: function(e) {
                this._layers = o(), n.each(e, this.addLayer, this)
            },
            clearLayers: function() {
                var e = this;
                this._layers.eachLayer(function(t) {
                    return e.removeLayer(t)
                })
            },
            eachLayer: function(e) {
                this._layers.eachLayer(e)
            },
            addLayer: function(e) {
                return this._layers.addLayer(e), this._map && this._map.addLayer(e), this
            },
            removeLayer: function(e) {
                var t = this._layers.removeLayer(e);
                return this._map && t && this._map.removeLayer(t), this
            },
            hasLayer: function(e) {
                return this._layers.hasLayer(e)
            },
            addTo: function(e) {
                return e.addLayer(this), this
            },
            onAdd: function(e) {
                this._map = e, this._layers.eachLayer(function(t) {
                    return e.addLayer(t)
                })
            },
            onRemove: function(e) {
                this._layers.eachLayer(function(t) {
                    return e.removeLayer(t)
                })
            }
        })
    }, {
        "./Class": 271,
        "./helpers/layerCollection": 296,
        underscore: 207
    }],
    284: [function(e, t, i) {
        "use strict";
        var n = e("jquery"),
            r = e("underscore"),
            o = e("./Class"),
            a = e("./Evented"),
            s = e("./CRS"),
            l = e("./LatLng"),
            h = e("./LatLngBounds"),
            u = e("../Map"),
            d = e("./Bounds"),
            c = e("./Point"),
            f = e("../OverlayView"),
            p = e("../LatLng"),
            m = e("./helpers/layerCollection"),
            g = e("./Popup");
        t.exports = o.extend({
            includes: a,
            initialize: function(e, t) {
                var i = this;
                this._layers = m();
                var n;
                n = r.isString(e) ? "#" + e : e, t = r.defaults(t, {
                    shadow: !0,
                    ssao: !0,
                    ssaoWhenMoving: !0,
                    waterRipple: !0,
                    waterReflection: !0
                }), this._map = new u(n, t), this._container = this._map.getDiv(), this._overlayView = new f, this._overlayView.setMap(this._map), this._map.on("idle", function() {
                    i.fire("movestart", {
                        type: "movestart"
                    }), i.fire("moveend", {
                        type: "moveend"
                    })
                }), this._zoom = this._map.getZoom(), this._map.on("zoom_changed", function() {
                    i._zoom = i._map.getZoom(), i.fire("zoomstart", {
                        type: "zoomstart"
                    }), i.fire("zoomend", {
                        type: "zoomend"
                    })
                }), this._mapPane = {
                    className: ""
                }
            },
            options: {
                crs: s.EPSG4326
            },
            setMaxBounds: function(e) {
                var t = new p(e.getSouth(), e.getWest()).to900913(),
                    i = new p(e.getNorth(), e.getEast()).to900913();
                this._map.setOptions({
                    limit: {
                        xMin: t.lon,
                        xMax: i.lon,
                        yMin: t.lat,
                        yMax: i.lat
                    }
                })
            },
            hasLayer: function(e) {
                return this._layers.hasLayer(e)
            },
            addLayer: function(e) {
                return this._layers.addLayer(e), e.onAdd(this), this
            },
            removeLayer: function(e) {
                var t = this._layers.removeLayer(e);
                return t && t.onRemove(this), this
            },
            closePopup: function() {
                g._closePopup()
            },
            locate: function() {
                var e = this;
                return r.defer(function() {
                    return e.fire("locationerror", {})
                }), this
            },
            getCenter: function() {
                var e = this._map.getCenter();
                return new l(e.lat(), e.lng())
            },
            getZoom: function() {
                return this._map.getZoom()
            },
            getMaxZoom: function() {
                return this._map.getMaxZoom() || 19
            },
            getBounds: function() {
                var e = this._map.getBounds();
                return new h(e.sw, e.ne)
            },
            setView: function(e, t) {
                return this._map.setView(e, t), this
            },
            fitBounds: function(e) {
                this._map.fitBounds(new h(e)._bounds)
            },
            setZoom: function(e) {
                return null != e && this._map.setZoom(e), this
            },
            _getNodeSize: function() {
                var e = n(this._map.getDiv());
                return e.length ? {
                    w: e.width(),
                    h: e.height()
                } : null
            },
            getPixelBounds: function() {
                var e = this._map.getBounds(),
                    t = e.getNorthEast(),
                    i = e.getSouthWest(),
                    n = this.options.crs.latLngToPoint(new l(t.lat(), t.lng()), this._zoom),
                    r = this.options.crs.latLngToPoint(new l(i.lat(), i.lng()), this._zoom);
                return new d(n.round(), r.round())
            },
            project: function(e, t) {
                return t = void 0 === t ? this.getZoom() : t, this.options.crs.latLngToPoint(l(e), t)
            },
            unproject: function(e, t) {
                return t = void 0 === t ? this.getZoom() : t, this.options.crs.pointToLatLng(c(e), t)
            },
            getSize: function() {
                var e = n(this._map.getDiv());
                return new c(e.width(), e.height())
            },
            latLngToLayerPoint: function(e) {
                var t = this._map._fromLatLngAndHeightToContainerPixel(p.convert(e));
                return new c(t.x, t.y)
            },
            layerPointToLatLng: function(e) {
                return l._fromF4LatLng(this._map._fromContainerPixelAndHeightToLatLng(e))
            },
            setTileUrlTemplate: function(e) {
                this._map.layers.tiles2d.setUrl(e), this._map.layers.tiles3d.setUrl(e)
            },
            getBoundsZoom: function(e) {
                return e = new h(e), this._map.getBoundsZoom(e._bounds)
            },
            panTo: function(e) {
                return this._map.panTo(e), this
            }
        })
    }, {
        "../LatLng": 233,
        "../Map": 237,
        "../OverlayView": 245,
        "./Bounds": 267,
        "./CRS": 269,
        "./Class": 271,
        "./Evented": 275,
        "./LatLng": 281,
        "./LatLngBounds": 282,
        "./Point": 286,
        "./Popup": 289,
        "./helpers/layerCollection": 296,
        jquery: 111,
        underscore: 207
    }],
    285: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Class"),
            o = e("./Util"),
            a = e("./Evented"),
            s = e("./LatLng"),
            l = e("../Marker"),
            h = e("../Point"),
            u = e("./helpers/DivIconLayer");
        t.exports = r.extend({
            includes: a,
            options: {
                opacity: 1
            },
            initialize: function(e) {
                var t = this,
                    i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                o.setOptions(this, i), i = this.options;
                var r = n.pick(i, ["title", "clickable", "draggable"]);
                n.extend(r, {
                    position: e
                }), this._latlng = s(e), "zIndexOffset" in i && (r.zIndex = i.zIndexOffset);
                var a = this._marker = new l(r);
                n.each(["click", "mouseover", "mouseout", "mousemove"], function(e) {
                    a.on(e, function(i) {
                        t.fire(e, {
                            type: e,
                            latlng: new s(i.latLng.lat(), i.latLng.lng()),
                            target: t
                        })
                    })
                }), "opacity" in i && this.setOpacity(i.opacity), this.setIcon(i.icon)
            },
            onAdd: function(e) {
                if (this._marker.setMap(e._map), this._divIconLayer && this._divIconLayer.setMap(e._map), this._initIcon(), this._posToSet) {
                    var t = this._posToSet;
                    delete this._posToSet, this._setPos(t)
                }
            },
            onRemove: function() {
                this._marker.setMap(null), this._divIconLayer && this._divIconLayer.setMap(null)
            },
            addTo: function(e) {
                return e.addLayer(this), this
            },
            getLatLng: function() {
                var e = this._marker.getPosition();
                return new s(e.lat(), e.lng())
            },
            setOpacity: function(e) {
                this.options.opacity = e, this._marker.getMap() && this._initIcon()
            },
            setZIndexOffset: function() {},
            _initIcon: function() {
                var e, t = this.options.icon;
                if (this._divIconLayer && (this._divIconLayer.setMap(null), delete this._divIconLayer), t) {
                    this._divIconLayer = new u, e = {
                        url: "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
                    }, this._divIconLayer.showDivIcon(this, t);
                    var i = this._marker.getMap();
                    i && this._divIconLayer.setMap(i), this._marker.setIcon(e), this._marker.setVisible(0 != this.options.opacity)
                } else this._marker.setVisible(!1)
            },
            setIcon: function(e) {
                this._icon = e, this.options.icon = e, this._marker.getMap() && this._initIcon()
            },
            setLatLng: function(e) {
                delete this._posToSet, this._marker.setPosition(e)
            },
            _setPos: function(e) {
                var t = this._marker.getMap();
                if (t) {
                    var i = t._fromContainerPixelAndHeightToLatLng(new h(e.x, e.y));
                    this._marker.setPosition(i)
                } else this._posToSet = e
            },
            bindPopup: function(e) {
                return this.popup = e, this
            },
            openPopup: function() {
                this.popup._open(this._marker.map, this._marker)
            }
        })
    }, {
        "../Marker": 241,
        "../Point": 246,
        "./Class": 271,
        "./Evented": 275,
        "./LatLng": 281,
        "./Util": 294,
        "./helpers/DivIconLayer": 295,
        underscore: 207
    }],
    286: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = t.exports = function(e, t, i) {
                return e instanceof r ? this instanceof r ? (this.x = e.x, void(this.y = e.y)) : e : n.isArray(e) ? this instanceof r ? (this.x = e[0], void(this.y = e[1])) : new r(e[0], e[1]) : (this.x = i ? Math.round(e) : e, void(this.y = i ? Math.round(t) : t))
            };
        r.prototype = {
            clone: function() {
                return new r(this.x, this.y)
            },
            add: function(e) {
                return this.clone()._add(r(e))
            },
            _add: function(e) {
                return this.x += e.x, this.y += e.y, this
            },
            subtract: function(e) {
                return this.clone()._subtract(r(e))
            },
            _subtract: function(e) {
                return this.x -= e.x, this.y -= e.y, this
            },
            divideBy: function(e) {
                return this.clone()._divideBy(e)
            },
            _divideBy: function(e) {
                return this.x /= e, this.y /= e, this
            },
            multiplyBy: function(e) {
                return this.clone()._multiplyBy(e)
            },
            _multiplyBy: function(e) {
                return this.x *= e, this.y *= e, this
            },
            round: function() {
                return this.clone()._round()
            },
            _round: function() {
                return this.x = Math.round(this.x), this.y = Math.round(this.y), this
            },
            floor: function() {
                return this.clone()._floor()
            },
            _floor: function() {
                return this.x = Math.floor(this.x), this.y = Math.floor(this.y), this
            },
            distanceTo: function(e) {
                e = r(e);
                var t = e.x - this.x,
                    i = e.y - this.y;
                return Math.sqrt(t * t + i * i)
            }
        }
    }, {
        underscore: 207
    }],
    287: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = [];
            return r.each(e, function(e) {
                var i = [];
                r.each(e, function(e) {
                    i.push(new s(e.lat, e.lng))
                }), t.push(i)
            }), t
        }
        var r = e("underscore"),
            o = e("./Polyline"),
            a = e("../Polygon"),
            s = e("../LatLng"),
            l = e("./LatLng"),
            h = e("./LatLngBounds");
        t.exports = o.extend({
            options: {},
            initialize: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                r.extend(this.options, t);
                var i = r.pick(this.options, ["visible", "clickable", "fillColor", "fillOpacity"]);
                this.paths = n(e), r.extend(i, {
                    strokeColor: this.options.color,
                    strokeOpacity: this.options.opacity,
                    strokeWeight: this.options.weight,
                    paths: this.paths
                }), this._geometry = new a(i)
            },
            setStyle: function(e) {
                o.prototype.setStyle.call(this, e), e.fillColor && this._geometry.setFillColor(e.fillColor), e.fillOpacity && this._geometry.setFillOpacity(e.fillOpacity)
            },
            getBounds: function() {
                var e = new h;
                return r.each(this.paths, function(t) {
                    r.each(t, function(t) {
                        return e.extend(l._fromF4LatLng(t))
                    })
                }), e
            }
        })
    }, {
        "../LatLng": 233,
        "../Polygon": 247,
        "./LatLng": 281,
        "./LatLngBounds": 282,
        "./Polyline": 288,
        underscore: 207
    }],
    288: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = [];
            return r.each(e, function(e) {
                t.push(new h(e.lat, e.lon))
            }), t
        }
        var r = e("underscore"),
            o = e("./Class"),
            a = e("./Evented"),
            s = e("./LatLngBounds"),
            l = e("../Polyline"),
            h = e("../LatLng"),
            u = e("./LatLng");
        t.exports = o.extend({
            includes: a,
            options: {},
            initialize: function(e) {
                var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};
                r.extend(this.options, t);
                var i = r.pick(this.options, ["visible", "clickable"]);
                this.path = n(e), r.extend(i, {
                    strokeColor: this.options.color,
                    strokeOpacity: this.options.opacity,
                    strokeWeight: this.options.weight,
                    path: this.path
                }), this._geometry = new l(i)
            },
            setStyle: function(e) {
                e.color && this._geometry.setStrokeColor(e.color), e.opacity && this._geometry.setStrokeOpacity(e.opacity), e.weight && this._geometry.setStrokeWeight(e.weight)
            },
            bindPopup: function() {},
            onAdd: function(e) {
                this._geometry.setMap(e._map)
            },
            onRemove: function() {
                this._geometry.setMap(null)
            },
            addTo: function(e) {
                return e.addLayer(this), this
            },
            getBounds: function() {
                var e = new s;
                return r.each(this.path, function(t) {
                    return e.extend(u._fromF4LatLng(t))
                }), e
            }
        })
    }, {
        "../LatLng": 233,
        "../Polyline": 248,
        "./Class": 271,
        "./Evented": 275,
        "./LatLng": 281,
        "./LatLngBounds": 282,
        underscore: 207
    }],
    289: [function(e, t, i) {
        "use strict";

        function n() {
            r && (r._popup.close(), r = null)
        }
        var r, o = e("./Class"),
            a = e("../InfoWindow"),
            s = t.exports = o.extend({
                initialize: function() {
                    var e, t = this,
                        i = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                    i.offset && (e = {
                        width: i.offset[0],
                        height: i.offset[1]
                    }), this._popup = new a({
                        pixelOffset: e,
                        maxWidth: i.maxWidth,
                        minWidth: i.minWidth,
                        maxHeight: i.maxHeight,
                        closeButton: i.closeButton
                    }), this._popup.on("closeclick", function() {
                        r == t && (r = null)
                    })
                },
                setLatLng: function(e) {
                    return this._popup.setPosition(e), this
                },
                getLatLng: function() {
                    return this._popup.getPosition()
                },
                setContent: function(e) {
                    return this._popup.setContent(e), this
                },
                openOn: function(e) {
                    return this._open(e._map), this
                },
                _open: function(e, t) {
                    n(), r = this, this._popup.open(e, t)
                },
                update: function() {
                    this._popup._refresh()
                }
            });
        s._closePopup = n
    }, {
        "../InfoWindow": 230,
        "./Class": 271
    }],
    290: [function(e, t, i) {
        "use strict";
        var n = e("./LatLng"),
            r = e("./Point"),
            o = {
                MAX_LATITUDE: 85.0511287798,
                project: function(e) {
                    var t = n.DEG_TO_RAD,
                        i = this.MAX_LATITUDE,
                        o = Math.max(Math.min(i, e.lat), -i),
                        a = e.lng * t,
                        s = o * t;
                    return s = Math.log(Math.tan(Math.PI / 4 + s / 2)), new r(a, s)
                },
                unproject: function(e) {
                    var t = n.RAD_TO_DEG,
                        i = e.x * t,
                        r = (2 * Math.atan(Math.exp(e.y)) - Math.PI / 2) * t;
                    return new n(r, i)
                }
            },
            a = {
                MAX_LATITUDE: 85.0840591556,
                R_MINOR: 6356752.314245179,
                R_MAJOR: 6378137,
                project: function(e) {
                    var t = n.DEG_TO_RAD,
                        i = this.MAX_LATITUDE,
                        o = Math.max(Math.min(i, e.lat), -i),
                        a = this.R_MAJOR,
                        s = this.R_MINOR,
                        l = e.lng * t * a,
                        h = o * t,
                        u = s / a,
                        d = Math.sqrt(1 - u * u),
                        c = d * Math.sin(h);
                    c = Math.pow((1 - c) / (1 + c), .5 * d);
                    var f = Math.tan(.5 * (.5 * Math.PI - h)) / c;
                    return h = -a * Math.log(f), new r(l, h)
                },
                unproject: function(e) {
                    for (var t, i = n.RAD_TO_DEG, r = this.R_MAJOR, o = this.R_MINOR, a = e.x * i / r, s = o / r, l = Math.sqrt(1 - s * s), h = Math.exp(-e.y / r), u = Math.PI / 2 - 2 * Math.atan(h), d = 15, c = 1e-7, f = d, p = .1; Math.abs(p) > c && --f > 0;) t = l * Math.sin(u), p = Math.PI / 2 - 2 * Math.atan(h * Math.pow((1 - t) / (1 + t), .5 * l)) - u, u += p;
                    return new n(u * i, a)
                }
            },
            s = {
                project: function(e) {
                    return new r(e.lng, e.lat)
                },
                unproject: function(e) {
                    return new n(e.y, e.x)
                }
            };
        t.exports = {
            SphericalMercator: o,
            Mercator: a,
            LonLat: s
        }
    }, {
        "./LatLng": 281,
        "./Point": 286
    }],
    291: [function(e, t, i) {
        "use strict";
        var n = e("./Class");
        t.exports = n.extend({
            initialize: function() {}
        })
    }, {
        "./Class": 271
    }],
    292: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("./Class");
        t.exports = r.extend({
            initialize: function(e, t) {
                var i = this;
                this.urlTemplate = e, n.each(t, function(e, t) {
                    i.urlTemplate = i.urlTemplate.replace(new RegExp("{" + t + "}", "g"), e)
                })
            },
            onAdd: function(e) {
                this.map = e, e.setTileUrlTemplate(this.urlTemplate)
            },
            onRemove: function() {},
            bringToBack: function() {},
            bringToFront: function() {
                this.map.setTileUrlTemplate(this.urlTemplate)
            },
            setOpacity: function() {}
        })
    }, {
        "./Class": 271,
        underscore: 207
    }],
    293: [function(e, t, i) {
        "use strict";
        var n = e("./Point"),
            r = t.exports = function(e, t, i, n) {
                this._a = e, this._b = t, this._c = i, this._d = n
            };
        r.prototype.transform = function(e, t) {
            return this._transform(e.clone(), t)
        }, r.prototype._transform = function(e, t) {
            return t = t || 1, e.x = t * (this._a * e.x + this._b), e.y = t * (this._c * e.y + this._d), e
        }, r.prototype.untransform = function(e, t) {
            return t = t || 1, new n((e.x / t - this._b) / this._a, (e.y / t - this._d) / this._c)
        }
    }, {
        "./Point": 286
    }],
    294: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = 0,
            o = "_leaflet_id",
            a = t.exports = {
                bind: n.bind,
                extend: n.extend,
                stamp: function(e) {
                    return n.isObject(e) ? (e[o] = e[o] || ++r, e[o]) : void 0
                },
                setOptions: function(e, t) {
                    return e.options = n.extend({}, e.options, t), e.options
                },
                limitExecByInterval: function(e, t, i) {
                    return n.throttle(n.bind(e, i), e, t)
                },
                falseFn: function() {
                    return !1
                },
                getParamString: function(e, t, i) {
                    var n = [];
                    for (var r in e) n.push(encodeURIComponent(i ? r.toUpperCase() : r) + "=" + encodeURIComponent(e[r]));
                    return (t && -1 !== t.indexOf("?") ? "&" : "?") + n.join("&")
                },
                trim: function(e) {
                    return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "")
                },
                splitWords: function(e) {
                    return a.trim(e).split(/\s+/)
                }
            }
    }, {
        underscore: 207
    }],
    295: [function(e, t, i) {
        "use strict";

        function n() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
            "map" in e && this.setMap(e.map), this.marker = null
        }
        var r = e("util"),
            o = e("jquery"),
            a = e("underscore"),
            s = e("../../OverlayView"),
            l = e("../../Size"),
            h = e("../../Point");
        t.exports = n, r.inherits(n, s);
        var u = n.prototype;
        u.showDivIcon = function(e, t) {
            this._divIcon = t;
            var i = this.$node = o(t.createIcon());
            this.popupPos = null, i.css({
                "pointer-events": "auto",
                cursor: "pointer",
                position: "absolute"
            }), this.marker = e, this.$container && this._showNode(i), i.on("click", function() {
                e.fire("click", {
                    type: "click",
                    latlng: e.getLatLng(),
                    target: e
                })
            })
        }, u.hideDivIcon = function() {
            this.$container && (delete this._divIcon, this.$container.empty(), this.popupPos = null, this.marker && (this.marker._marker.removeListener("position_changed", this._movePopupBinding), delete this._movePopupBinding, delete this.marker), this.getMap() && this.getMap().setHoverEnabled(!0))
        }, u.draw = function() {
            this._moveDivIcon()
        }, u.onAdd = function() {
            this.onRemove();
            var e = o("<div>").addClass("div-icon-container");
            e.appendTo(this.getPanes().floatPane), this.$container = e, this._stopEventBinding = a.bind(this._stopEvent, this), this._mouseEnterBinding = a.bind(this._mouseEnter, this), this._mouseLeaveBinding = a.bind(this._mouseLeave, this), this.$container.on("mousewheel mousedown mouseup dblclick touchstart pointerdown pointermove pointerup", this._stopEventBinding), this.$container.on("mouseenter", this._mouseEnterBinding), this.$container.on("mouseleave", this._mouseLeaveBinding), this.$container.on("contextmenu", this._stopEventBinding), this.$node && this._showNode()
        }, u.onRemove = function() {
            this.$container && (this.$container.off("contextmenu", this._stopEventBinding), this.$container.off("mouseleave", this._mouseLeaveBinding), this.$container.off("mouseenter", this._mouseEnterBinding), this.$container.off("mousewheel mousedown mouseup dblclick touchstart pointerdown pointermove pointerup", this._stopEventBinding), delete this._stopEventBinding, delete this._mouseEnterBinding, delete this._mouseLeaveBinding, this.hideDivIcon(), delete this.$container)
        }, u._mouseEnter = function() {
            this.getMap() && this.getMap().setHoverEnabled(!1)
        }, u._mouseLeave = function() {
            this.getMap() && this.getMap().setHoverEnabled(!0)
        }, u._moveDivIcon = function() {
            if (this.$container && this.$node && this.marker) {
                var e = this._getMarkerPositionInScreen(),
                    t = this.$node,
                    i = e.x,
                    n = e.y,
                    r = this._divIcon.options.iconAnchor;
                r && (i -= r.x, n -= r.y), t.css({
                    left: i,
                    top: n
                }), null == this.popupPos && this._applyBoundTolerance()
            }
        }, u._getMarkerSize = function() {
            if (this.marker && this.getMap() && this.getMap()._renderer) {
                var e = this.getMap()._markersById[this.marker._marker.id];
                if (e) {
                    var t = this.getMap()._renderer._pinsManager.getPinSize(e);
                    return new l(t.width, t.height)
                }
            }
            if (this.marker && this.marker._marker.icon) {
                if (this.marker._marker.icon.scaledSize) return this.marker._marker.icon.scaledSize;
                if (this.marker._marker.icon.size) return this.marker._marker.icon.size
            }
            return new l(0, 0)
        }, u._getMarkerAnchor = function() {
            if (this.marker && this.getMap() && this.getMap()._renderer) {
                var e = this.getMap()._markersById[this.marker._marker.id];
                if (e) {
                    var t = this.getMap()._renderer._pinsManager.getPinAnchor(e);
                    return new h(t.x, t.y)
                }
            }
            return this.marker && this.marker._marker.anchor ? this.marker._marker.anchor : new h(0, 0)
        }, u._applyBoundTolerance = function() {
            function e() {
                var e = n("left"),
                    t = n("top");
                return [{
                    top: -u.height - p.y,
                    left: e
                }, {
                    top: t,
                    left: m.width - p.x
                }, {
                    top: m.height - p.y,
                    left: e
                }, {
                    left: -u.width - p.x,
                    top: t
                }, {
                    left: e,
                    top: t
                }]
            }

            function t(e) {
                var t = f.y + e.top,
                    i = f.x + e.left,
                    n = i + u.width,
                    r = t + u.height;
                return i >= 0 && n <= c.width && t >= 0 && r <= c.width
            }

            function i(e) {
                g.popupPos = e, h.css({
                    top: e.top,
                    right: "auto",
                    bottom: "auto",
                    left: e.left
                })
            }

            function n(e) {
                var t, i, n;
                return "top" == e ? (t = f.y, i = c.height, n = u.height) : (t = f.x, i = c.width, n = u.width), i > n ? n + 2 * l > i && (l = .5 * (i - n)) : l = 0, t - .5 * n >= l ? i - l >= t + .5 * n ? .5 * -n : i - l - t - n : -t + l
            }
            var r = this.$node,
                s = this.getMap();
            if (r && s && s.isReady()) {
                var l = 10,
                    h = o(r.children()[0]),
                    u = {
                        width: h.outerWidth(),
                        height: h.outerHeight()
                    },
                    d = o(s.getDiv()),
                    c = {
                        width: d.width(),
                        height: d.height()
                    },
                    f = this._getMarkerPositionInScreen(),
                    p = this._getMarkerAnchor(),
                    m = this._getMarkerSize(),
                    g = this,
                    _ = e(),
                    v = a.find(_, function(e) {
                        return t(e)
                    });
                v || (v = a.find(_, function(e) {
                    return t(e)
                })), v || (v = {
                    left: .5 * -u.width,
                    top: -u.height - m.height
                }), i(v)
            }
        }, u._showNode = function() {
            var e = this.$node;
            this.$container.empty().append(e), this.marker && (this._movePopupBinding = a.bind(this._moveDivIcon, this), this.marker._marker.on("position_changed", this._movePopupBinding)), this._moveDivIcon()
        }, u._stopEvent = function(e) {
            e.stopPropagation()
        }, u._getMarkerPositionInScreen = function() {
            var e = this.marker._marker,
                t = this.getProjection();
            return t.fromLatLngAndHeightToContainerPixel(e.getPosition(), e.getHeight())
        }
    }, {
        "../../OverlayView": 245,
        "../../Point": 246,
        "../../Size": 250,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    296: [function(e, t, i) {
        "use strict";

        function n(e) {
            return r.stamp(e)
        }
        var r = e("../Util"),
            o = e("underscore");
        t.exports = function() {
            var e = {};
            return {
                addLayer: function(t) {
                    var i = n(t);
                    e[i] = t
                },
                removeLayer: function(t) {
                    var i = t in e ? t : n(t),
                        r = e[i];
                    return delete e[i], r
                },
                hasLayer: function(t) {
                    return t ? t in e || n(t) in e : !1
                },
                eachLayer: function(t, i) {
                    o.each(e, t, i)
                }
            }
        }
    }, {
        "../Util": 294,
        underscore: 207
    }],
    297: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            return new f(e, t)
        }
        var r = e("./Util"),
            o = e("./Evented"),
            a = e("./Map"),
            s = e("./TileLayer"),
            l = e("./LayerGroup"),
            h = e("./Popup"),
            u = e("./Control"),
            d = e("./FeatureGroup"),
            c = e("./LatLng"),
            f = e("./LatLngBounds"),
            p = e("./Icon"),
            m = e("./Bounds"),
            g = e("./Point"),
            _ = e("./Polygon"),
            v = e("./Marker"),
            y = e("./DivIcon"),
            b = e("./Circle"),
            x = t.exports = {
                Util: r,
                Browser: e("./Browser"),
                Class: e("./Class"),
                CRS: e("./CRS"),
                TileLayer: s,
                Map: a,
                Handler: e("./Handler"),
                Control: u,
                Evented: o,
                FeatureGroup: d,
                Icon: p,
                Bounds: m,
                Circle: b,
                Transformation: e("./Transformation"),
                Point: g,
                Polyline: e("./Polyline"),
                Polygon: _,
                Rectangle: e("./Rectangle"),
                DivIcon: y,
                GeoJSON: e("./GeoJSON"),
                LatLng: c,
                LatLngBounds: f,
                LayerGroup: l,
                Popup: h,
                DomUtil: e("./DomUtil"),
                Marker: v,
                Projection: e("./Projection"),
                ImageOverlay: e("./ImageOverlay"),
                Mixin: {
                    Events: o
                },
                Path: {},
                extend: r.extend,
                bind: r.bind,
                stamp: r.stamp,
                setOptions: r.setOptions,
                latLngBounds: n,
                layerGroup: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(l, [null].concat(t)))
                },
                popup: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(h, [null].concat(t)))
                },
                control: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(u, [null].concat(t)))
                },
                featureGroup: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(d, [null].concat(t)))
                },
                tileLayer: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(s, [null].concat(t)))
                },
                map: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(a, [null].concat(t)))
                },
                latLng: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(c, [null].concat(t)))
                },
                icon: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(p, [null].concat(t)))
                },
                marker: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(v, [null].concat(t)))
                },
                bounds: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(m, [null].concat(t)))
                },
                point: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(g, [null].concat(t)))
                },
                polygon: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(_, [null].concat(t)))
                },
                divIcon: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(y, [null].concat(t)))
                },
                circle: function() {
                    for (var e = arguments.length, t = Array(e), i = 0; e > i; i++) t[i] = arguments[i];
                    return new(Function.prototype.bind.apply(b, [null].concat(t)))
                }
            };
        x.control.scale = function() {
            return {
                addTo: function() {}
            }
        }
    }, {
        "./Bounds": 267,
        "./Browser": 268,
        "./CRS": 269,
        "./Circle": 270,
        "./Class": 271,
        "./Control": 272,
        "./DivIcon": 273,
        "./DomUtil": 274,
        "./Evented": 275,
        "./FeatureGroup": 276,
        "./GeoJSON": 277,
        "./Handler": 278,
        "./Icon": 279,
        "./ImageOverlay": 280,
        "./LatLng": 281,
        "./LatLngBounds": 282,
        "./LayerGroup": 283,
        "./Map": 284,
        "./Marker": 285,
        "./Point": 286,
        "./Polygon": 287,
        "./Polyline": 288,
        "./Popup": 289,
        "./Projection": 290,
        "./Rectangle": 291,
        "./TileLayer": 292,
        "./Transformation": 293,
        "./Util": 294
    }],
    298: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._heatmapLayerRenderer = null, this._refreshListener = a.bind(this.onDataChanged, this), this.setOptions(e), this.on("data_changed", this._refreshListener), this.on("gradient_changed", a.bind(this.onGradientChanged, this)), this.on("dissipating_changed", a.bind(this.onDissipatingChanged, this)), this.on("maxIntensity_changed", a.bind(this.onMaxIntensityChanged, this)), this.on("opacity_changed", a.bind(this.onOpacityChanged, this)), this.on("radius_changed", a.bind(this.onRadiusChanged, this))
        }
        var r = e("util"),
            o = e("./../MVCObject"),
            a = e("underscore"),
            s = e("./../MVCArray");
        t.exports = n, r.inherits(n, o);
        var l = {
            radius: 20,
            dissipating: !0,
            opacity: .6,
            gradient: ["rgba(255, 0, 0, 1)", "rgba(255, 255, 255, 1)"]
        };
        o.createProperties(n.prototype, ["map", "gradient", "data", "dissipating", "maxIntensity", "opacity", "radius"]), n.prototype.setOptions = function(e) {
            this._options = a.defaults(e, l);
            var t = this.map;
            a.each(e, function(e, i) {
                switch (i) {
                    case "map":
                        t = e;
                        break;
                    case "data":
                        this.setData(e);
                        break;
                    default:
                        this.set(i, e)
                }
            }, this), this.setMap(t)
        }, n.prototype.setData = function(e) {
            a.isArray(e) && (e = new s(e)), e.getAt(0) instanceof s ? e = e.getAt(0) : a.isArray(e.getAt(0)) && (e = new s(e.getAt(0)));
            var t = this.data;
            t && this.map && this.unbindRefreshListener(t), this.set("data", e), this.map && this.bindRefreshListener(e)
        }, n.prototype.onRadiusChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setRadius(this.radius)
        }, n.prototype.onGradientChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setGradient(this.gradient)
        }, n.prototype.onOpacityChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setOpacity(this.opacity)
        }, n.prototype.onMaxIntensityChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setMaxIntensity(this.maxIntensity)
        }, n.prototype.onDissipatingChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setDissipating(this.dissipating)
        }, n.prototype.onDataChanged = function() {
            this._heatmapLayerRenderer && this._heatmapLayerRenderer.setData(this.data)
        }, n.prototype.setMap = function(e) {
            e != this.map && (this.map && (this.unbindRefreshListener(this.data), this.reset(this.map, this._heatmapLayerRenderer)), this.map = e, e && (this.bindRefreshListener(this.data), this.initialize(e)))
        }, n.prototype.initialize = function(e) {
            this.map == e && (this._heatmapLayerRenderer = e._renderer.addHeatmapLayer(this.getData(), this._options))
        }, n.prototype.reset = function(e, t) {
            e._renderer.removeHeatmapLayer(t), t.destroy(), this._heatmapLayerRenderer == t && (this._heatmapLayerRenderer = null)
        }, n.prototype.bindRefreshListener = function(e) {
            e && (e.on("insert_at", this._refreshListener), e.on("remove_at", this._refreshListener), e.on("set_at", this._refreshListener))
        }, n.prototype.unbindRefreshListener = function(e) {
            e && (e.removeListener("insert_at", this._refreshListener), e.removeListener("remove_at", this._refreshListener), e.removeListener("set_at", this._refreshListener))
        }
    }, {
        "./../MVCArray": 235,
        "./../MVCObject": 236,
        underscore: 207,
        util: 212
    }],
    299: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.location = e, this.weight = t
        }
        t.exports = n
    }, {}],
    300: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapEvents = new h, this._windLayerEvents = new h, this._updateEnvCbk = o.bind(this._updateEnv, this), this.cover = 0, this.opacity = 0, this.setValues(e)
        }

        function r(e, t, i) {
            return e > i ? i : t > e ? t : e
        }
        var o = e("underscore"),
            a = e("util"),
            s = e("../MVCObject"),
            l = e("./WindLayer"),
            h = e("../../utils/EventPack"),
            u = e("../Map"),
            d = e("../../utils/Types");
        t.exports = n, a.inherits(n, s);
        var c = 25e-5,
            f = n.prototype;
        s.createProperty(f, "map", d.OrNull(u)), s.createProperty(f, "cover", Number), s.createProperty(f, "opacity", Number), f.map_changed = function() {
            this._activeMap && this._unregisterFromMap(), this._activeMap = this.map, this._activeMap && this._registerInMap()
        }, f.cover_changed = function() {
            this.cover = r(this.cover, 0, 1), this._updateEnvironment()
        }, f.opacity_changed = function() {
            this.opacity = r(this.opacity, 0, 1), this._updateEnvironment()
        }, f._registerInMap = function() {
            var e = this._activeMap;
            if (e.conf.get("enableWebGL")) {
                var t = e._renderer;
                this._environmentHelper = t.registerEnvironmentPlugins({
                    envModifiers: [this._updateEnvCbk]
                }), this._mapEvents.on(e, "layeradd", o.bind(this._onLayerAdd, this)), this._mapEvents.on(e, "layerremove", o.bind(this._onLayerRemove, this)), this._findWindLayer(), this._updateEnvironment(e)
            }
        }, f._unregisterFromMap = function() {
            var e = this._activeMap;
            if (e.conf.get("enableWebGL")) {
                var t = e._renderer;
                this._mapEvents.removeAllListeners(), this._removeWindLayer(), this._clearEnvironment(), t.unregisterEnvironmentPlugins({
                    envModifiers: [this._updateEnvCbk]
                }), delete this._environmentHelper
            }
        }, f._getWindDirection = function() {
            var e = this._windLayer;
            if (e) {
                var t = e.getSpeed(),
                    i = Math.PI * e.getHeading() / 180;
                return {
                    x: -Math.sin(i) * t * c,
                    y: -Math.cos(i) * t * c
                }
            }
            return {
                x: 0,
                y: 0
            }
        }, f._updateEnvironment = function() {
            if (this._environmentHelper) {
                var e = this.cover,
                    t = 65793 * (255 - Math.round(255 * this.opacity)),
                    i = this._getWindDirection();
                this._environmentHelper.skyModifier(o.bind(function(n) {
                    var r = n.material.uniforms;
                    r.cloudsInfo.value.set(i.x, i.y, e), r.cloudColor.value.setHex(t)
                }, this)), this._activeMap._renderer.updateEnvironmentLighting()
            }
        }, f._clearEnvironment = function() {
            this._environmentHelper.skyModifier(o.bind(function(e) {
                var t = e.material.uniforms;
                t.cloudsInfo.value.set(0, 0, 0), t.cloudColor.value.setHex(16777215)
            }, this)), this._activeMap._renderer.updateEnvironmentLighting()
        }, f._updateEnv = function(e) {
            var t = this.opacity * this.cover;
            e && t && e.globalColor.mix(new e.Color(0), .5 * t)
        }, f._findWindLayer = function() {
            var e = this;
            this._activeMap.eachLayer(function(t) {
                e._onLayerAdd(t)
            })
        }, f._onLayerAdd = function(e) {
            e instanceof l && this._setWindLayer(e)
        }, f._onLayerRemove = function(e) {
            this._windLayer == e && this._removeWindLayer()
        }, f._setWindLayer = function(e) {
            this._windLayer = e, this._windLayerEvents.on(e, "speed_changed", o.bind(this._updateEnvironment, this)), this._windLayerEvents.on(e, "heading_changed", o.bind(this._updateEnvironment, this)), this._updateEnvironment()
        }, f._removeWindLayer = function() {
            this._windLayerEvents.removeAllListeners(), delete this._windLayer, this._updateEnvironment()
        }
    }, {
        "../../utils/EventPack": 403,
        "../../utils/Types": 412,
        "../MVCObject": 236,
        "../Map": 237,
        "./WindLayer": 305,
        underscore: 207,
        util: 212
    }],
    301: [function(e, t, i) {
        "use strict";

        function n() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
            this.currentType = e.type || l, this._mapEvents = new s, this.setMap(e.map)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("../MVCObject"),
            s = e("../../utils/EventPack");
        t.exports = n;
        var l = {},
            h = 500,
            u = a;
        o.inherits(n, u);
        var d = n.prototype;
        d.setMap = function(e) {
            this._map != e && (this._map && this._map.conf.get("enableWebGL") && (this._unregister(), this._removeMesh()), this._map = e, this._map && this._map.conf.get("enableWebGL") && (this._register(), this._initMesh(), this._updateCamera()))
        }, d._register = function() {
            var e = this._map,
                t = e._renderer;
            this._mapEvents.on(t, "enter2d", r.bind(this._enter2d, this)), this._mapEvents.on(t, "enter3d", r.bind(this._enter3d, this))
        }, d._unregister = function() {
            this._mapEvents.removeAllListeners()
        }, d.setType = function() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : l;
            this.currentType = e, this._map && this._map.conf.get("enableWebGL") && (this._removeMesh(), this._initMesh(), this._updateCamera())
        }, d._removeMesh = function() {
            if (this._fogMesh) {
                var e = this._map._renderer,
                    t = e.getRenderEngine();
                t.getScene().remove(this._fogMesh), this._fogMesh = null
            }
        }, d._initMesh = function() {
            var t = this._map._renderer,
                i = t.getEngineHelpers(),
                n = t.getRenderEngine(),
                r = n.getShaderLibrary();
            r.programs.vertex.dynamicFog = e("./dynamicFog.vshader"), r.effects.dynamicFog = {
                commonUniformKeys: ["cameraPos", "time"],
                uniforms: {
                    fAlpha: {
                        type: "f",
                        value: this.currentType.density
                    },
                    boxSize: {
                        type: "f",
                        value: h
                    },
                    camAt: {
                        type: "v3",
                        value: new i.Vector3
                    },
                    near: {
                        type: "f",
                        value: this.currentType.near
                    }
                },
                vertexDefines: ["#define USE_TIMER"].join("\n"),
                vertexProgramName: "dynamicFog",
                fragmentProgramName: "blobWithoutTexture"
            };
            var o = new i.Geometry;
            o._positionArray = [], o._uvArray = [];
            var a = h / 2,
                s = h / 2,
                l = h / 2;
            o._positionArray.push(a, s, l, a, s, l, a, s, l, a, s, l, a, s, l, a, s, l), o._uvArray.push(0, 0, 0, 1, 1, 1, 0, 0, 1, 1, 1, 0), o.clearOnWebglLoad = !0;
            var u = n.createMaterial("dynamicFog");
            u.transparent = i.Constants.Gradual, u.depthWrite = !1, this._fogMesh = n.createMesh(o, u), this._fogMesh.doubleSided = !0, this._fogMesh.visible = t.isIn3d(), n.getScene().add(this._fogMesh)
        }, d._cameraUpdated = function(e) {
            var t = this._map._renderer;
            if (t.isIn3d()) {
                var i = t._cameraManager.getTargetToCamera(!0);
                this._fogMesh.material.uniforms.camAt.value.set(i.x, i.y, i.z), this._fogMesh.position.copy(e.position), this._fogMesh.updateMatrix()
            }
        }, d._updateCamera = function() {
            this._map && this._cameraUpdated(this._map._renderer.getRenderEngine().getCamera())
        }, d._enter2d = function() {
            this._fogMesh.visible = !1
        }, d._enter3d = function() {
            this._fogMesh.visible = !0
        }
    }, {
        "../../utils/EventPack": 403,
        "../MVCObject": 236,
        "./dynamicFog.vshader": 306,
        underscore: 207,
        util: 212
    }],
    302: [function(e, t, i) {
        "use strict";
        t.exports = {
            FOG: {
                density: .9,
                color: 14607084,
                near: 50
            },
            HAZE: {
                density: .8,
                color: 14607084,
                near: 750
            },
            MIST: {
                density: .7,
                color: 14607084,
                near: 1500
            },
            DRIZZLE: {
                density: .3,
                color: 14607084,
                near: 50
            }
        }
    }, {}],
    303: [function(e, t, i) {
        "use strict";

        function n() {
            var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
            this._applyEnvConfCbk = r.bind(this._applyEnvConf, this), this._mapEvents = new s, this._windLayerEvents = new s, this._rampedValues = {}, this.setMap(e.map), this.setType(e.type)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("../MVCObject"),
            s = e("../../utils/EventPack"),
            l = e("./WindLayer"),
            h = e("./PrecipitationType");
        t.exports = n;
        var u = 500,
            d = 300,
            c = 5e4,
            f = a;
        o.inherits(n, f);
        var p = n.prototype;
        p.setMap = function(e) {
            this._map != e && (this._map && this._map.conf.get("enableWebGL") && (e || (this._lastType = null), this._unregister(), this._removeMesh(), this._removeWindLayer()), this._map = e, this._map && this._map.conf.get("enableWebGL") && (this._register(), this._initMesh(), this._applyEnvConf(), this._updateCamera(), this._findWindLayer()))
        }, p._findWindLayer = function() {
            var e = this;
            this._map.eachLayer(function(t) {
                e._onLayerAdd(t)
            })
        }, p._onLayerAdd = function(e) {
            e instanceof l && this._setWindLayer(e)
        }, p._onLayerRemove = function(e) {
            this._windLayer == e && this._removeWindLayer()
        }, p._setWindLayer = function(e) {
            this._windLayer = e, this._windLayerEvents.on(e, "speed_changed", r.bind(this._applyWind, this)), this._windLayerEvents.on(e, "heading_changed", r.bind(this._applyWind, this)), this._applyWind()
        }, p._removeWindLayer = function() {
            this._windLayerEvents.removeAllListeners(), delete this._windLayer, this._applyWind()
        }, p._register = function() {
            var e = this._map,
                t = e._renderer;
            this._mapEvents.on(t, "cameraChanged", r.bind(this._cameraUpdated, this)), this._mapEvents.on(t, "enter2d", r.bind(this._enter2d, this)), this._mapEvents.on(t, "enter3d", r.bind(this._enter3d, this)), this._mapEvents.on(t, "compute", r.bind(this._computeRampedValues, this)), this._mapEvents.on(e, "layeradd", r.bind(this._onLayerAdd, this)), this._mapEvents.on(e, "layerremove", r.bind(this._onLayerRemove, this))
        }, p._unregister = function() {
            this._mapEvents.removeAllListeners()
        }, p.setType = function(e) {
            e = e || h.NONE, this.currentType = e, this._map && this._map.conf.get("enableWebGL") && (this._initMesh(), this._applyEnvConf(), this._updateCamera())
        }, p._removeMesh = function() {
            if (this._weatherMesh) {
                var e = this._map._renderer,
                    t = e.getRenderEngine();
                t.getScene().remove(this._weatherMesh), e.unregisterEnvironmentPlugins({
                    envModifiers: [this._applyEnvConfCbk]
                }), this._weatherMesh = null
            }
        }, p._initMesh = function() {
            var t = this._map._renderer,
                i = t.getEngineHelpers(),
                n = t.getRenderEngine(),
                o = n.getShaderLibrary();
            o.effects.dynamicWeather || (o.programs.vertex.dynamicWeather = e("./dynamicWeather.vshader"), o.effects.dynamicWeather = {
                commonUniformKeys: ["cameraPos", "time"],
                uniforms: {
                    particleCount: {
                        type: "f",
                        value: 0
                    },
                    particleWidth: {
                        type: "f",
                        value: this.currentType.particleWidth
                    },
                    particleHeight: {
                        type: "f",
                        value: this.currentType.particleHeight
                    },
                    fAlpha: {
                        type: "f",
                        value: this.currentType.particleAlpha
                    },
                    particleSpeed: {
                        type: "v3",
                        value: new i.Vector3
                    },
                    boxSize: {
                        type: "f",
                        value: u
                    },
                    camRight: {
                        type: "v3",
                        value: new i.Vector3
                    },
                    camAt: {
                        type: "v3",
                        value: new i.Vector3
                    }
                },
                vertexDefines: ["#define USE_TIMER"].join("\n"),
                vertexProgramName: "dynamicWeather",
                fragmentProgramName: "blobWithoutTexture"
            });
            var a;
            if (!this._weatherMesh) {
                a = new i.Geometry, a._positionArray = [], a._uvArray = [];
                var s = 0;
                r.times(c, function() {
                    var e = Math.random() * u,
                        t = Math.random() * u,
                        i = Math.random() * u;
                    a._positionArray.push(e, t, i, e, t, i, e, t, i, e, t, i, e, t, i, e, t, i), a._uvArray.push(s, 0, s, 1, s + .5, 1, s, 0, s + .5, 1, s + .5, 0), s++
                }), a.clearOnWebglLoad = !0;
                var l = n.createMaterial("dynamicWeather");
                l.transparent = i.Constants.Gradual, l.depthWrite = !1, this._weatherMesh = n.createMesh(a, l), this._weatherMesh.doubleSided = !0, this._weatherMesh.visible = t.isIn3d(), n.getScene().add(this._weatherMesh), t.registerEnvironmentPlugins({
                    envModifiers: [this._applyEnvConfCbk]
                })
            }
            this._applyWind()
        }, p._applyWind = function() {
            this._windLayer ? this.setWind(this._windLayer.getSpeed(), this._windLayer.getHeading()) : this.setWind(0, 0)
        }, p.setWind = function(e, t) {
            if (this._weatherMesh) {
                var i = Math.PI * t / 180,
                    n = {
                        x: -Math.sin(i) * e,
                        y: -Math.cos(i) * e
                    },
                    r = this._weatherMesh.material.uniforms,
                    o = null != this.currentType.windFactor ? this.currentType.windFactor : 1;
                r.particleSpeed.value.x = n.x * o, r.particleSpeed.value.y = n.y * o
            }
        }, p._applyEnvConf = function() {
            if (this._lastType != this.currentType) {
                var e = this._map._renderer;
                if (e.isIn3d()) {
                    var t = this._weatherMesh.material.uniforms;
                    this._setRampedValue("particleCount", t.particleCount, this.currentType.particleCount), t.particleWidth.value = this.currentType.particleWidth, t.particleHeight.value = this.currentType.particleHeight, 0 != this.currentType.particleWidth && 0 != this.currentType.particleHeight && (this._weatherMesh.visible = !0), this._setRampedValue("alpha", t.fAlpha, this.currentType.particleAlpha), t.particleSpeed.value.z = this.currentType.speed, this._lastType = this.currentType
                }
            }
        }, p._setRampedValue = function(e, t, i, n, r) {
            var o = this._rampedValues[e];
            null == o && (o = this._rampedValues[e] = {
                count: 0,
                lastCount: 0
            }), o.uniform = t, o.offsetValue = r, o.lastCount = o.count, o.wantedCount = i, o.onFinishedCallback = n, o.startDate = (new Date).valueOf(), o.wantedCount == o.lastCount && this._updateRampedValue(o.startDate + d, o)
        }, p._computeRampedValues = function() {
            var e = this;
            if (this._map && this._weatherMesh && this._weatherMesh.visible) {
                var t = !1,
                    i = (new Date).valueOf();
                r.each(this._rampedValues, function(n) {
                    n.count != n.wantedCount && (t = !0, e._updateRampedValue(i, n))
                }), t && this._map._renderer.forceRender()
            }
        }, p._updateRampedValue = function(e, t) {
            var i, n = e - t.startDate;
            n >= d && (n = d, i = t.onFinishedCallback);
            var r = n / d,
                o = t.wantedCount - t.lastCount;
            t.count = Math.floor(1e3 * (o * r + t.lastCount)) / 1e3, t.offsetValue ? t.uniform.value[t.offsetValue] = t.count : t.uniform.value = t.count, i && i(t.count)
        }, p._cameraUpdated = function(e) {
            var t = this._map._renderer;
            if (t.isIn3d()) {
                var i = t._cameraManager.getTargetToCamera(!0);
                this._weatherMesh.material.uniforms.camRight.value.set(e.matrix.n11, e.matrix.n21, e.matrix.n31), this._weatherMesh.material.uniforms.camAt.value.set(i.x, i.y, i.z), this._weatherMesh.position.copy(e.position), this._weatherMesh.updateMatrix()
            }
        }, p._updateCamera = function() {
            this._map && this._cameraUpdated(this._map._renderer.getRenderEngine().getCamera())
        }, p._enter2d = function() {
            this._weatherMesh.visible = !1
        }, p._enter3d = function() {
            this._weatherMesh.visible = !0
        }
    }, {
        "../../utils/EventPack": 403,
        "../MVCObject": 236,
        "./PrecipitationType": 304,
        "./WindLayer": 305,
        "./dynamicWeather.vshader": 307,
        underscore: 207,
        util: 212
    }],
    304: [function(e, t, i) {
        "use strict";
        var n = 5,
            r = 2.5,
            o = 2;
        t.exports = {
            NONE: {
                speed: 0,
                particleWidth: 0,
                particleHeight: 0,
                particleAlpha: 1,
                particleCount: 0
            },
            LIGHT_RAIN: {
                speed: 120,
                particleWidth: .1,
                particleHeight: 8,
                particleAlpha: .5,
                particleCount: 5e3,
                windFactor: n
            },
            MODERATE_RAIN: {
                speed: 130,
                particleWidth: .2,
                particleHeight: 9,
                particleAlpha: .55,
                particleCount: 5e3,
                windFactor: n
            },
            HEAVY_RAIN: {
                speed: 140,
                particleWidth: .3,
                particleHeight: 10,
                particleAlpha: .6,
                particleCount: 25e3,
                windFactor: n
            },
            TORRENTIAL_RAIN: {
                speed: 150,
                particleWidth: .4,
                particleHeight: 11,
                particleAlpha: .65,
                particleCount: 5e4,
                windFactor: n
            },
            LIGHT_SNOW: {
                speed: 10,
                particleWidth: .5,
                particleHeight: .5,
                particleAlpha: .9,
                particleCount: 5e3,
                windFactor: r
            },
            MODERATE_SNOW: {
                speed: 10,
                particleWidth: 1.1,
                particleHeight: 1.1,
                particleAlpha: .9,
                particleCount: 25e3,
                windFactor: r
            },
            HEAVY_SNOW: {
                speed: 15,
                particleWidth: 1.1,
                particleHeight: 1.1,
                particleAlpha: .9,
                particleCount: 5e4,
                windFactor: r
            },
            LIGHT_HAIL: {
                speed: 375,
                particleWidth: 1,
                particleHeight: 4,
                particleAlpha: .2,
                particleCount: 1e3,
                windFactor: o
            },
            HEAVY_HAIL: {
                speed: 500,
                particleWidth: 1.2,
                particleHeight: 5,
                particleAlpha: .2,
                particleCount: 1e4,
                windFactor: o
            },
            MODERATE_SLEET: {
                speed: 170,
                particleWidth: .2,
                particleHeight: .2,
                particleAlpha: .8,
                particleCount: 5e3,
                windFactor: o
            }
        }
    }, {}],
    305: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.speed = 0, this.heading = 0, this.setValues(e)
        }
        var r = e("util"),
            o = e("../MVCObject");
        t.exports = n;
        var a = o;
        r.inherits(n, a);
        var s = n.prototype;
        o.createProperty(s, "map"), o.createProperty(s, "speed", Number), o.createProperty(s, "heading", Number), s.map_changed = function() {
            var e = this._activeMap;
            e && e.removeLayer(this), this._activeMap = this.map, this._activeMap && this._activeMap.addLayer(this)
        }
    }, {
        "../MVCObject": 236,
        util: 212
    }],
    306: [function(e, t, i) {
        t.exports = "uniform vec3 cameraPosition;\nuniform float boxSize;\nuniform float fAlpha;\nuniform vec3 camAt;\n//uniform vec4 color;\nuniform float near;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main()\n{\n    vUv = uv;\n    vec3 pos = position - cameraPosition;\n//    pos = mod( pos, boxSize ) - ( boxSize * 0.5 ) ;\n    pos += camAt * boxSize;\n    pos += boxSize * uv.x;\n    pos += boxSize * uv.y;\n//    vColor = vec4( color.x, color.y, color.z, 1.0/*fAlpha*/ );\n    vColor = vec4( 1.0, 1.0, 1.0, fAlpha );\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n}\n"
    }, {}],
    307: [function(e, t, i) {
        t.exports = "uniform vec3 cameraPosition;\nuniform vec3 cameraTarget;\nuniform float boxSize;\nuniform float particleWidth;\nuniform float particleHeight;\nuniform vec3 camRight;\nuniform vec3 camAt;\nuniform float fAlpha;\nuniform vec3 particleSpeed;\nuniform float particleCount;\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main()\n{\n    // To prevent re-upload particle buffer when particleCount change\n    // particles index are stored in uv.x and uv.x is stored in fract part ( => 0.5 or 0 )\n    float particleIdx = uv.x;\n    if( particleIdx < particleCount ) {\n        vec2 decodedUv =vec2(fract(uv.x) * 2.0, uv.y);\n        vUv = decodedUv;\n        vec3 pos = position - mod(cameraPosition, 100000.0); // precision fixing\n        vec3 particleSpeedInDt = currentTime * particleSpeed;\n        pos -= particleSpeedInDt;\n        pos = mod( pos, boxSize ) - ( boxSize * 0.5 ) ;\n        float distBox = 1.0;\n        if( cameraPosition.z < 150.0 )\n            distBox = 0.7;\n        pos += camAt * boxSize * distBox;\n        pos.z += cameraTarget.z;\n        if ( decodedUv.y > 0.0 && particleHeight > 2.0 )\n            pos -= normalize(particleSpeedInDt) * particleHeight;\n        else\n            pos.z -= decodedUv.y * particleHeight;\n        pos += particleWidth * decodedUv.x * camRight;\n        vColor = vec4( 1.0, 1.0, 1.0, fAlpha );\n        gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n    }else {\n        gl_Position = vec4( 0.0, 0.0, 0.0, 1.0 );\n    }\n}\n"
    }, {}],
    308: [function(e, t, i) {
        "use strict";
        var n = e("underscore");
        n.str = e("underscore.string"), n.mixin(n.str.exports()), window.$ = window.jQuery = e("jquery");
        var r = e("./utils/Ajax");
        r.wrapJQueryAjax(), e("../lib/jquery.hotkeys"), e("../lib/jquery.cookie"), e("../lib/jquery.easing.1.3"), e("jquery-visible"), e("./lib/jquery_binaryTransport"), $.easing.linear = function(e, t, i, n) {
            return i + n * e
        }, $.browser && $.browser.msie && e("../lib/f4.jquery.xdomainrequest"), null == Date.now && (Date.now = function() {
            return (new Date).getTime()
        }), $.noConflict(!0)
    }, {
        "../lib/f4.jquery.xdomainrequest": 424,
        "../lib/jquery.cookie": 425,
        "../lib/jquery.easing.1.3": 426,
        "../lib/jquery.hotkeys": 427,
        "./lib/jquery_binaryTransport": 395,
        "./utils/Ajax": 397,
        jquery: 111,
        "jquery-visible": 110,
        underscore: 207,
        "underscore.string": 206
    }],
    309: [function(e, t, i) {
        "use strict";

        function n() {
            if ("undefined" == typeof window.leafletF4) {
                if (!D) {
                    var e = document.createElement("script");
                    e.type = "application/javascript", e.src = I, u(e), D = !0
                }
                g.delay(n, 20)
            } else h()
        }

        function r() {
            return a("google-compatibility", !1)
        }

        function o() {
            return a("leaflet-compatibility", !1)
        }

        function a(e, t) {
            var i = M[e];
            return s(i, t)
        }

        function s(e, t) {
            if (!g.isString(e)) return g.isBoolean(e) ? e : t;
            var i = e.toLowerCase();
            return g.contains(["true", "yes"], i) ? !0 : g.contains(["false", "no"], i) ? !1 : void 0
        }

        function l() {
            return M.callback && window[M.callback] ? window[M.callback] : window.onF4MapApiLoaded ? window.onF4MapApiLoaded : void 0
        }

        function h() {
            C && C()
        }

        function u(e) {
            var t = document.getElementsByTagName("head")[0];
            t.appendChild(e)
        }

        function d(e) {
            this.url = e
        }

        function c() {
            if (E) return null;
            var e = m("script");
            return e.eq(e.length - 1)
        }
        var f = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
            },
            p = e("../utils/polyfills");
        p.install();
        var m = e("jquery"),
            g = e("underscore");
        g.str = e("underscore.string"), g.mixin(g.str.exports());
        var _ = e("browser-detect"),
            v = e("url"),
            y = e("querystring"),
            b = e("../utils/apiUrl"),
            x = b.init(),
            w = v.parse(x),
            M = y.parse(w.query),
            T = e("../utils/StaticFileResolver"),
            S = e("../api"),
            C = l(),
            E = "object" == ("undefined" == typeof Ejecta ? "undefined" : f(Ejecta));
        if (!E) {
            var k = m("head"),
                L = T("css/f4-map-api.css");
            m('link[href="' + L + '"]').length || m('<link rel="stylesheet" type="text/css"/>').attr("href", L).prependTo(k)
        }
        var P = c(),
            A = P && P.attr("data-expose") || null;
        A ? window[A] = {
            map: S
        } : g.extend(window, {
            f4: {
                map: S,
                ConfigurationHref: e("../utils/ConfigurationHref")
            }
        }), r() && g.extend(window, {
            GBrowserIsCompatible: function() {
                return !0
            },
            GMap2: S.Map,
            GUnload: S.NotImplemented,
            GGeoXml: d,
            GLargeMapControl: S.NotImplemented,
            GMapTypeControl: S.NotImplemented,
            GLatLng: S.LatLng,
            google: {
                maps: S
            }
        });
        var R = e("../utils/WebGlContextAttributes");
        if (_.supportWebGL(R) && !window.forceLeafletForDebug) h();
        else {
            var D = "undefined" != typeof window.leafletF4,
                I = T("leafletF4.js");
            if (D) console.log("Leaflet already loaded ");
            else try {
                var O = '<script src="' + I + '" type="text/javascript" class=leafLet></script>';
                document.write(O)
            } catch (N) {
                C || (console.log("leafLet inject failed" + N), console.log('please use callback="callbackName" in api Url '))
            }
            m(".leafLet").length ? h() : n()
        }
        o() && (window.L = e("../api/leafletCompatibility/index.js")), d.prototype.setOptions = function(e) {
            e.kml = this.url
        }
    }, {
        "../api": 260,
        "../api/leafletCompatibility/index.js": 297,
        "../utils/ConfigurationHref": 401,
        "../utils/StaticFileResolver": 410,
        "../utils/WebGlContextAttributes": 415,
        "../utils/apiUrl": 417,
        "../utils/polyfills": 421,
        "browser-detect": 4,
        jquery: 111,
        querystring: 185,
        underscore: 207,
        "underscore.string": 206,
        url: 208
    }],
    310: [function(e, t, i) {
        "use strict";

        function n(e) {
            function t(e) {
                return l.isEmpty(e) ? e : l.isArray(e[0]) ? l.map(e, t) : [u.convertLon4326To900913(e[0]), u.convertLat4326To900913(e[1])]
            }

            function i(e) {
                return [u.convertLon4326To900913(e[0]), u.convertLat4326To900913(e[1]), u.convertLon4326To900913(e[2]), u.convertLat4326To900913(e[3])]
            }
            return e = l.clone(e), "GeometryCollection" == e.type ? e.geometries = l.map(e.geometries, function(e) {
                return n(e)
            }) : (e.bbox && (e.bbox = i(e.bbox)), e.coordinates = t(e.coordinates)), e
        }

        function r(e, t) {
            function i(e) {
                return e.length && e[0].length ? l.isArray(e[0][0]) ? l.map(e, i) : e.length >= 2 ? h(e, t) : e : e
            }
            return e = l.clone(e), "GeometryCollection" == e.type ? e.geometries = l.map(e.geometries, function(e) {
                return r(e, t)
            }) : e.coordinates = i(e.coordinates), e
        }

        function o(e) {
            function t(e) {
                e.length && e[0].length && (l.isArray(e[0][0]) ? l.each(e, t) : i += e.length)
            }
            var i = 0;
            return "GeometryCollection" == e.type ? l.each(e.geometries, function(e) {
                i += o(e)
            }) : t(e.coordinates), i
        }

        function a(e, t) {
            if (t.length) {
                var i = t[0],
                    n = t[1];
                if ("number" == typeof i && "number" == typeof n) e.left = Math.min(e.left, i), e.bottom = Math.min(e.bottom, n), e.right = Math.max(e.right, i), e.top = Math.max(e.top, n);
                else
                    for (var r = 0; r < t.length; ++r) a(e, t[r])
            }
        }

        function s(e) {
            if (!e.bbox) {
                for (var t = [e], i = {
                        left: +(1 / 0),
                        bottom: +(1 / 0),
                        right: -(1 / 0),
                        top: -(1 / 0)
                    }; t.length;) e = t.pop(), "GeometryCollection" == e.type ? t.push.apply(t, e.geometries) : a(i, e.coordinates);
                e.bbox = [i.left, i.bottom, i.right, i.top]
            }
            var n = (e.bbox.length || 0) / 2;
            return {
                left: e.bbox[0],
                bottom: e.bbox[1],
                right: e.bbox[n],
                top: e.bbox[n + 1]
            }
        }
        var l = e("underscore"),
            h = e("simplify-geojson-js"),
            u = e("mercatorProjection");
        t.exports = {
            simplifyGeometry: r,
            countVertices: o,
            getGeometryBounds: s,
            convertTo900913: n
        }
    }, {
        mercatorProjection: 147,
        "simplify-geojson-js": 198,
        underscore: 207
    }],
    311: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            var r = Math.PI * (1 / i - .5);
            n && (r += n / 180 * Math.PI);
            for (var o, a, s, l = [], h = e[0], u = e[1], d = 0; i > d; ++d) o = r + 2 * d * Math.PI / i, a = h + t * Math.cos(o), s = u + t * Math.sin(o), l.push([a, s]);
            var c = l[0];
            return c && l.push([c[0], c[1]]), {
                type: "Polygon",
                coordinates: [l]
            }
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("events").EventEmitter,
            s = e("../../utils/LocationHelper"),
            l = e("../../api/StrokePosition"),
            h = e("../GeojsonHelper"),
            u = function() {
                throw new Error("abstract function")
            },
            d = {
                strokeColor: "#000000",
                strokeOpacity: .3,
                strokeWeight: 1.5,
                fillColor: "#ff7f50",
                fillOpacity: .2,
                strokePosition: l.CENTER
            },
            c = function(e) {
                this.setMaxListeners(0), this.strokeMeshs = [], this.fillMeshs = [], this.rings = null, this.eventIndex = null, e = r.defaults(e, {
                    visible: !0,
                    zIndex: 0,
                    fillColor: "white",
                    id: r.uniqueId("area_"),
                    clickable: !1
                }), this.setOptions(e)
            };
        o.inherits(c, a), c.prototype.updateGeometryPosition = u, c.prototype.updateGeometry = u, c.prototype.updateFill = u, c.prototype.updateStroke = u, c.prototype.parseGeometry = u, c.prototype.deleteGraphics = u, c.prototype.setCenter = u, c.prototype.setOptions = function(e) {
            (null == this.overlay || this.overlay.id != e.id) && (this.overlay = e), "radius" in e && this.radius != e.radius && (this.radius = e.radius, delete this.geometry);
            var t = this._getGeometry(e);
            if ("id" in e && (this.id = e.id), "simplify" in e && this.setSimplify(e.simplify), "clickable" in e && this.setClickable(e.clickable), this.setCursor(e.cursor), "strokeColor" in e && this.setStrokeColor(e.strokeColor), "zIndex" in e && this.setZIndex(e.zIndex), "strokeOpacity" in e && this.setStrokeOpacity(e.strokeOpacity), this.setStrokePosition(e.strokePosition), "strokeWeight" in e && this.setStrokeWeight(e.strokeWeight), "fillColor" in e && !e.isLine && this.setFillColor(e.fillColor), "fillOpacity" in e && !e.isLine && this.setFillOpacity(e.fillOpacity), "outsideStroke" in e && this.setOutsideStroke(e.outsideStroke), t && this.setGeometry(t), "center" in e) {
                var i = s.convertGoogleLatLngTo900913(e.center);
                this.setCenter({
                    x: i.lon,
                    y: i.lat,
                    z: 0
                })
            }
            "visible" in e && this.setVisible(e.visible), "map" in e && this.setMap(e.map)
        }, c.prototype._getGeometry = function(e) {
            if (e.geoJSON) return e.geoJSON == this.originalGeometry ? this.geometry : (this.originalGeometry = e.geoJSON, h.convertTo900913(e.geoJSON));
            var t, i = e.getType();
            return "Polyline" == i ? t = this._getPolylineGeometry(e) : "Polygon" == i ? t = this._getPolygonGeometry(e) : "Circle" == i ? t = this._getCircleGeometry(e) : "Rectangle" == i && (t = this._getRectangleGeometry(e)), t
        }, c.prototype._getPolylineGeometry = function(e) {
            return e.path == this.originalGeometry && e.path && !e.path.isDirty ? this.geometry : (this.originalGeometry = e.path, e.path ? h.convertTo900913(e.toGeoJSON()) : void 0)
        }, c.prototype._getPolygonGeometry = function(e) {
            if (e.paths == this.originalGeometry && e.paths && !e.paths.isDirty) return this.geometry;
            this.originalGeometry = e.paths;
            var t;
            return e.paths && (t = h.convertTo900913(e.toGeoJSON())), t
        }, c.prototype._getCircleGeometry = function(e) {
            var t = this.geometry;
            if (t) return t;
            if (e.center) {
                var i = s.convertGoogleLatLngTo900913(e.center),
                    r = s.getScaleFromLatitude(i.lat);
                e.radius && (null == this.center || i.lon != this.center.x || i.lat != this.center.y || this.radius != e.radius) && (t = n([0, 0], e.radius * r, 200, 0))
            }
            return t
        }, c.prototype._getRectangleGeometry = function(e) {
            var t = e.getBounds();
            if (t == this.originalGeometry) return this.geometry;
            this.originalGeometry = t;
            var i = s.convertGoogleLatLngTo900913(t.getNorthEast()),
                n = s.convertGoogleLatLngTo900913(t.getSouthWest()),
                o = r.map([{
                    lon: i.lon,
                    lat: i.lat
                }, {
                    lon: n.lon,
                    lat: i.lat
                }, {
                    lon: n.lon,
                    lat: n.lat
                }, {
                    lon: i.lon,
                    lat: n.lat
                }], function(e) {
                    return [e.lon, e.lat]
                });
            return o.push(o[0]), {
                type: "Polygon",
                coordinates: [o]
            }
        }, c.prototype.setZIndex = function(e) {
            this.zIndex != e && (this.zIndex = e, this.updateGeometry())
        }, c.prototype.setFillColor = function(e) {
            null == e && (e = d.fillColor), e = e.trim(), this.fillColor != e && (this.fillColor = e, this.updateFill())
        }, c.prototype.setOutsideStroke = function(e) {
            this.outsideStroke != e && (this.outsideStroke = e, this.updateStroke())
        }, c.prototype.setFillOpacity = function(e) {
            null == e && (e = d.fillOpacity), this.fillOpacity != e && (this.fillOpacity = e, this.updateFill())
        }, c.prototype.setStrokeWeight = function(e) {
            null == e && (e = d.strokeWeight), this.strokeWeight != e && (this.strokeWeight = e, this.updateStroke())
        }, c.prototype.registerOnZoomChanged = function() {
            this.strokeOpacity && null == this._onZoomChangedCallback && this.map && (this._onZoomChangedCallback = r.bind(this.onEventZoomChanged, this), this._onIdleChangedCallback = r.bind(this.onEventIdleChanged, this), this.map._renderer.areaEventManager.addArea(this))
        }, c.prototype.unregisterOnZoomChanged = function() {
            this.strokeOpacity && null != this._onZoomChangedCallback && this.map && (this.map._renderer.areaEventManager.removeArea(this), this.strokeOpacity = null, this._onZoomChangedCallback = null, this._onIdleChangedCallback = null)
        }, c.prototype.setStrokeOpacity = function(e) {
            null == e && (e = d.strokeOpacity), this.strokeOpacity != e && (this.strokeOpacity = e, e ? this.registerOnZoomChanged() : this.unregisterOnZoomChanged(), this.updateStroke())
        }, c.prototype.setStrokePosition = function(e) {
            null == e && (e = d.strokePosition), this.strokePosition != e && (this.strokePosition = e, this.updateGeometry())
        }, c.prototype.setStrokeColor = function(e) {
            null == e && (e = d.strokeColor), e = e.trim(), this.strokeColor != e && (this.strokeColor = e, this.updateStroke())
        }, c.prototype.setMap = function(e) {
            this.map != e && (this.unregisterOnZoomChanged(), e || this.onMouseOut(), this.map = e, this.map && this.registerOnZoomChanged(), this.updateGeometry())
        }, c.prototype.onEventIdleChanged = function() {
            this.map && this.visible && this.updateGeometryPosition()
        }, c.prototype.onEventZoomChanged = function() {
            this.map && this.visible && (this.simplify && this.simplifyStrokeGeometry(), this.updateGeometryPosition())
        }, c.prototype.unload = function() {
            this.unregisterOnZoomChanged(), this.deleteGraphics(), this.geometry = null, this.setMap(null)
        }, c.prototype.setSimplify = function(e) {
            this.simplify = e
        }, c.prototype.setClickable = function(e) {
            this.clickable = null != e ? e : !0
        }, c.prototype.setCursor = function(e) {
            null != e ? this.cursor = e : this.clickable && (this.cursor = "hover-clickable")
        }, c.prototype.setGeometry = function(e) {
            this.geometry != e && (this.geometry = e, this.parseGeometry(), this.updateGeometry())
        }, c.prototype.setVisible = function(e) {
            this.visible != e && (this.visible = e, this.updateGeometry())
        }, c.prototype.onMouseOver = function() {
            null != this.cursor && this.map && this.map._addClass(this.cursor)
        }, c.prototype.onMouseOut = function() {
            null != this.cursor && this.map && this.map._removeClass(this.cursor)
        }, t.exports = c
    }, {
        "../../api/StrokePosition": 251,
        "../../utils/LocationHelper": 407,
        "../GeojsonHelper": 310,
        events: 99,
        underscore: 207,
        util: 212
    }],
    312: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.map = e, this._onIdleHandler = r.bind(this.onIdle, this), this._onZoomChangedHandler = r.bind(this.onZoomChanged, this), this.map.on("idle", this._onIdleHandler), this.map.on("zoom_changed", this._onZoomChangedHandler), this.areas = []
        }
        var r = e("underscore");
        n.prototype.onDivRemoved = function() {
            this.map && (this.map.removeListener("idle", this._onIdleHandler), this.map.removeListener("zoom_changed", this._onZoomChangedHandler), delete this.map)
        }, n.prototype.onIdle = function() {
            var e, t, i = this.areas.length;
            for (e = 0; i > e; ++e) t = this.areas[e], t._onIdleChangedCallback && t._onIdleChangedCallback()
        }, n.prototype.getPixelSizeIn1Meter = function() {
            return null == this._pixelSizeIn1Meter && (this._pixelSizeIn1Meter = this.map._renderer.getPixelSizeInMeter(1)), this._pixelSizeIn1Meter
        }, n.prototype.onZoomChanged = function() {
            this._pixelSizeIn1Meter = null;
            var e, t, i = this.areas.length;
            for (e = 0; i > e; ++e) t = this.areas[e], t._onZoomChangedCallback && t._onZoomChangedCallback()
        }, n.prototype.addArea = function(e) {
            null === e.eventIndex && (e.eventIndex = this.areas.length, this.areas[this.areas.length] = e)
        }, n.prototype.removeArea = function(e) {
            if (null !== e.eventIndex) {
                var t = this.areas[this.areas.length - 1];
                t !== e && (this.areas[e.eventIndex] = t, t.eventIndex = e.eventIndex), this.areas.length = this.areas.length - 1, e.eventIndex = null
            }
        }, t.exports = n
    }, {
        underscore: 207
    }],
    313: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.features2d = null, a.call(this, e)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Area"),
            s = e("onecolor"),
            l = e("../../utils/LocationHelper");
        t.exports = n, o.inherits(n, a);
        var h = n.prototype;
        h.updateFill = function() {
            if (this.map && null != this.fillColor) {
                var e = s(this.fillColor);
                0 != e && (e = e.hex(), r.each(this.features2d, function(t) {
                    t.setStyle({
                        fillColor: e
                    }), this.visible && this.map._renderer.setShapeVisibility(t, !0)
                }, this))
            }
        }, h.simplifyStrokeGeometry = function() {}, h.updateStroke = function() {
            if (this.map) {
                var e = s(this.strokeColor);
                0 != e && (e = e.hex(), r.each(this.features2d, function(t) {
                    t.setStyle({
                        color: e
                    }), this.visible && this.map._renderer.setShapeVisibility(t, !0)
                }, this))
            }
        }, h.onEventZoomChanged = function() {}, h.onEventIdleChanged = function() {}, h.onEventBoundsChanged = function() {}, h.updateGeometryPosition = function() {
            this.updateGeometry()
        }, h.updateGeometry = function() {
            this.map && (this.deleteGraphics(), this.generateGeometry())
        }, h.deleteGraphics = function() {
            this.map && null != this.features2d && (r.each(this.features2d, function(e) {
                this.map._renderer.removeShape(e)
            }, this), delete this.features2d)
        }, h.parseGeometry = function() {}, h.setCenter = function(e) {
            this.center = e, this.updateGeometry()
        }, h.transformGeoJsonCoord = function(e) {
            var t = {
                lon: e[0],
                lat: e[1]
            };
            this.center && (t.lon += this.center.x, t.lat += this.center.y);
            var i = l.convert900913to4326(t);
            return [i.lat, i.lon]
        }, h.generateGeometry = function() {
            if (this.map && this.visible && null == this.features2d) {
                this.features2d = [];
                var e = .5,
                    t = {
                        fill: this.fillOpacity && this.fillColor,
                        stroke: this.strokeOpacity && this.strokeColor,
                        fillOpacity: this.fillOpacity,
                        smoothFactor: e,
                        noClip: !0,
                        coordsToLatLng: r.bind(this.transformGeoJsonCoord, this),
                        opacity: this.strokeOpacity,
                        weight: this.strokeWeight,
                        clickable: Boolean(this.clickable),
                        onEachFeature: function(e, t) {
                            t.on({
                                click: function() {
                                    t.hasBeenClicked = !0
                                }
                            })
                        },
                        area: this
                    };
                if (this.strokeColor) {
                    var i = s(this.strokeColor);
                    0 != i && (i = i.hex(), t.color = i)
                }
                if (this.fillColor) {
                    var n = s(this.fillColor);
                    n && (n = n.hex(), t.fillColor = n)
                }
                var o = this.map._renderer.addShapeFeature(this.geometry, t);
                this.features2d.push(o), this.map._renderer.setShapeVisibility(o, !0)
            }
        }
    }, {
        "../../utils/LocationHelper": 407,
        "./Area": 311,
        onecolor: 150,
        underscore: 207,
        util: 212
    }],
    314: [function(e, t, i) {
        "use strict";

        function n(e) {
            r.isString(e) && (e = e.trim());
            var t = s(e);
            return t ? t.threejs() : (console.error("failed parsing color ", e), s("black").threejs())
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("./Area"),
            s = e("onecolor"),
            l = e("../buildings/building-generator"),
            h = e("../GeojsonHelper"),
            u = e("engine"),
            d = u.Color,
            c = u.Constants,
            f = u.Geometry,
            p = e("../../utils/AreaHelper"),
            m = e("./AreaWorkerManager"),
            g = function(e) {
                this.strokeMeshs = [], this.fillMeshs = [], this.rings = null, this.disableZBuffer = !0, "disableZBuffer" in e && (this.disableZBuffer = e.disableZBuffer), e && e.useWorker === !1 ? this.useWorker = !1 : this.useWorker = !0, this._elevationModeChangedCbk = r.bind(this._elevationModeChanged, this), this._onTileElevationsUpdatedCbk = r.bind(this._onTileElevationsUpdated, this), this._deferredGeometryUpdateCbk = r.bind(this._deferredGeometryUpdate, this), this._elevationsEnabled = !1, this._elevationsDirty = !1, a.call(this, e)
            };
        o.inherits(g, a), g.prototype.setZIndex = function(e) {
            a.prototype.setZIndex.call(this, e)
        }, g.prototype.setMap = function(e) {
            e ? (this._elevationsEnabled = e.elevation && e.conf.get("area.elevationsEnabled"), this._bindEvents(e)) : (this._unbindEvents(this.map), m.removePendingWorkForArea(this)), a.prototype.setMap.call(this, e)
        }, g.prototype._bindEvents = function(e) {
            if (e) {
                var t = e.conf.get("area.elevationsEnabled") && e.elevation;
                t && (e.on("elevation_changed", this._elevationModeChangedCbk), e._renderer.on("enter2d", this._elevationModeChangedCbk), e._renderer.on("enter3d", this._elevationModeChangedCbk), e._renderer.on("tile_elevations_updated", this._onTileElevationsUpdatedCbk))
            }
        }, g.prototype._unbindEvents = function(e) {
            if (e) {
                var t = e.conf.get("area.elevationsEnabled") && e.elevation;
                t && (e.removeListener("elevation_changed", this._elevationModeChangedCbk), e._renderer.removeListener("enter2d", this._elevationModeChangedCbk), e._renderer.removeListener("enter3d", this._elevationModeChangedCbk), e._renderer.removeListener("tile_elevations_updated", this._onTileElevationsUpdatedCbk))
            }
        }, g.prototype.updateFill = function() {
            if (this.map && null != this.fillColor) {
                this.map._renderer.forceRender();
                var e = new d(n(this.fillColor));
                e.a = this.fillOpacity;
                for (var t = 0; t < this.fillMeshs.length; ++t) {
                    var i = this.fillMeshs[t];
                    i.geometry.fixedColor.copy(e), i.geometry.__isColorDirty = !0;
                    var r = !this.disableZBuffer;
                    i.material.depthTest != r && (this.releaseFillMaterial(i.material), i.material = this.getFillMaterial(this.disableZBuffer))
                }
            }
        }, g.prototype.updateStroke = function() {
            if (this.map) {
                this.map._renderer.forceRender();
                var e = new d(n(this.strokeColor));
                e.a = this.strokeOpacity;
                for (var t = 0; t < this.strokeMeshs.length; ++t) {
                    var i = this.strokeMeshs[t];
                    i.geometry.fixedColor.copy(e), i.geometry.__isColorDirty = !0, i.material._strokeWeight != this.strokeWeight && (this.releaseStrokeMaterial(i.material), i.material = this.getStrokeMaterial(this.strokeWeight))
                }
            }
        }, g.prototype.updateGeometry = function() {
            if (this.map && this.map._renderer && this.visible) {
                var e = this.map._renderer.workersEnabled && this.useWorker;
                this.generateGeometryWebGL(e), this.map._renderer.forceRender()
            }
        }, g.prototype.simplifyStrokeGeometry = function() {
            if (this.map && this.visible && this.rings) {
                var e = this.map._renderer.workersEnabled && this.useWorker;
                e ? this.generateGeometryInWorker(!0, !1) : this.map._renderer.isMoving() || (this.unloadMeshs(this.strokeMeshs), this.triangulateStrokeShape(), this.updateMeshsToScene(this.strokeMeshs, this.visible))
            }
            this.updateGeometryPosition()
        }, g.initAreasMaterial = function(e) {
            e && (e.areasFillMaterials || (e.areasFillMaterials = {}), e.areasStrokeMaterials || (e.areasStrokeMaterials = {}))
        }, g.prototype.getFillMaterial = function(e) {
            var t = !e,
                i = this.map._renderer.areasFillMaterials[t];
            return i || (i = this.map._renderer.getRenderEngine().createMaterial("nolight"), i.transparent = c.Opaque, i.blending = c.NormalBlending, i.depthTest = t, i.pickingMaterial = this.map._renderer.getRenderEngine().createMaterial("picking", c.NoBlending), i.pickingMaterial.transparent = c.Opaque, i.pickingMaterial.depthTest = t, i.pickingMaterial.depthWrite = !1, this.map._renderer.areasFillMaterials[t] = i), i._areaRef++, i
        }, g.prototype.releaseFillMaterial = function(e) {
            e._areaRef--, e._areaRef <= 0 && (delete this.map._renderer.areasFillMaterials[e.depthTest], this.map._renderer.getRenderEngine().releaseMaterial(e.pickingMaterial), this.map._renderer.getRenderEngine().releaseMaterial(e))
        }, g.prototype.getStrokeMaterial = function(e) {
            var t = this.map._renderer.areasStrokeMaterials[e];
            return t || (t = this.map._renderer.getRenderEngine().createMaterial("lineRender"), t.transparent = c.Opaque, t.depthTest = !this.disableZBuffer, t.depthWrite = !1, t._areaRef = 0, t._strokeWeight = e, t.uniforms.strokeWeight.value = this.strokeWeight, t.pickingMaterial = this.map._renderer.getRenderEngine().createMaterial("lineRenderPicking", c.NoBlending), t.pickingMaterial.transparent = c.Opaque, t.pickingMaterial.depthTest = !this.disableZBuffer, t.pickingMaterial.depthWrite = !1, t.pickingMaterial.uniforms.strokeWeight = t.uniforms.strokeWeight, this.map._renderer.areasStrokeMaterials[e] = t), t._areaRef++, t
        }, g.prototype.releaseStrokeMaterial = function(e) {
            e._areaRef--, e._areaRef <= 0 && (delete this.map._renderer.areasStrokeMaterials[e._strokeWeight], this.map._renderer.getRenderEngine().releaseMaterial(e.pickingMaterial), this.map._renderer.getRenderEngine().releaseMaterial(e))
        }, g.prototype.getFarDistance = function() {
            var e = this.map._renderer.getFrustum();
            return Math.max(200, this.map._renderer.getPosCamera().distanceTo(e[0]))
        }, g.prototype.unloadMeshs = function(e) {
            r.each(e, function(e) {
                delete e.owner, this.releaseStrokeMaterial(e.material), this.map._renderer.getRenderEngine().releaseObject(e)
            }, this), e.length = 0
        }, g.prototype.deleteGraphics = function() {
            this.unloadMeshs(this.strokeMeshs), this.unloadMeshs(this.fillMeshs)
        }, g.prototype.parseGeometry = function() {
            if (this.map) {
                if (this.rings = [], this.geometry) {
                    var e = h.simplifyGeometry(this.geometry, 1e-5),
                        t = h.countVertices(e);
                    if (t > 0) try {
                        var i = l.parseShape(e, null, !0);
                        this.rings = i.rings, this.position = i.position
                    } catch (n) {}
                }
                this._elevationsEnabled && this._updateRingElevations()
            }
        }, g.prototype._elevationModeChanged = function() {
            this.map && (this._elevationsEnabled = this.map.elevation && this.map._renderer.isIn3d(), this._recalculateGeometry())
        }, g.prototype._onTileElevationsUpdated = function(e, t) {
            if (this.rings) {
                for (var i = !1, n = this.center ? this.center.x : 0, o = this.center ? this.center.y : 0, a = 0; a < this.rings.length && !i; a++) {
                    var s = this.rings[a],
                        l = s.bounds,
                        h = l.left + n > t.xMax || l.right + n < t.xMin || l.top + o < t.yMin || l.bottom + o > t.yMax;
                    i = !h
                }
                i && (this._elevationsDirty = !0, r.defer(this._deferredGeometryUpdateCbk))
            }
        }, g.prototype._deferredGeometryUpdate = function() {
            this._elevationsDirty && (this._recalculateGeometry(), this._elevationsDirty = !1)
        }, g.prototype._recalculateGeometry = function() {
            null == this.rings ? this.parseGeometry() : this._updateRingElevations(), this.flattenedRingData = null, this.updateGeometry()
        }, g.prototype._updateRingElevations = function() {
            this.map && p.updateRingElevations(this.rings, this.position, this.center, this.map._renderer, this._elevationsEnabled)
        }, g.prototype.updateMeshsToScene = function(e, t) {
            if (this.map)
                for (var i = 0; i < e.length; ++i) {
                    var n = e[i],
                        r = this.map._renderer.getScene().linesAndAreaParent;
                    t && n.parent != r ? r.add(n) : t || n.parent != r || r.remove(n), n.visible = t
                }
        }, g.prototype.updateGeometryPosition = function() {
            var e = this.getFarDistance();
            this.computeMeshsPosition(this.strokeMeshs, 1.1 * e), this.computeMeshsPosition(this.fillMeshs, e)
        }, g.prototype.generateGeometryWebGL = function(e) {
            null == this.rings && this.parseGeometry(), this.visible && (e ? this.generateGeometryInWorker(!0, !0) : (this.deleteGraphics(), this.triangulateFillShape(), this.triangulateStrokeShape(), this.map && this.updateGeometryPosition(), this.updateMeshsToScene(this.strokeMeshs, this.visible), this.updateMeshsToScene(this.fillMeshs, this.visible)))
        }, g.prototype.generateGeometryInWorker = function(e, t) {
            this.strokeWeight && this.strokeOpacity || (e = !1), this.fillOpacity || (t = !1), (null == this.flattenedRingData || this.rings != this.ringsUsedForFlattenedGeometry) && (this.flattenedRingData = p.flattenRingData(this.rings), this.ringsUsedForFlattenedGeometry = this.rings);
            var i = this.simplify ? this.map._renderer.areaEventManager.getPixelSizeIn1Meter() : 0,
                n = this.map.conf.get("area.useIndexedGeometries"),
                o = {
                    area: this,
                    doTriangulateStrokeShape: e,
                    doTriangulateFillShape: t,
                    flattenedRingData: this.flattenedRingData,
                    position: this.position,
                    strokeSimplifyPrecision: i,
                    fillSimplifyPrecision: 0,
                    useIndexedGeometry: n,
                    successHandler: r.bind(this._handleWorkerSuccess, this),
                    errorsHandler: r.bind(this._handleWorkerErrors, this),
                    exceptionHandler: r.bind(this._handleWorkerException, this)
                };
            m.triangulateStrokeAndFillShapes(o)
        }, g.prototype.triangulateStrokeShape = function() {
            var e = this.map.conf.get("area.useIndexedGeometries");
            if (this.strokeOpacity && this.map && this.strokeWeight)
                for (var t = this.simplify ? this.map._renderer.areaEventManager.getPixelSizeIn1Meter() : 0, i = p.triangulateStrokeShape(this.rings, e, t, {
                        strokeWeight: this.strokeWeight,
                        strokePosition: this.strokePosition
                    }), n = 0; n < i.positionArrays.length; n++) {
                    var r = this.newStrokeMesh(),
                        o = r.geometry;
                    o._positionArray = i.positionArrays[n], o._normalArray = i.normalArrays[n], o._indexArray = i.indexArrays[n], o.boundingRadius = i.boundingRadius
                }
        }, g.prototype.newFillMesh = function() {
            var e = new f;
            e.fixedColor = new d(n(this.fillColor)), e.fixedColor.a = this.fillOpacity;
            var t = this.map._renderer.getRenderEngine().createMesh(e, this.getStrokeMaterial(this.disableZBuffer));
            return t.renderPriority = this.zIndex / this.map._renderer._maxZIndex + 1, null != this.position && (t.owner = this, this.fillMeshs.push(t)), t
        }, g.prototype.newStrokeMesh = function() {
            var e = new f;
            e.fixedColor = new d(n(this.strokeColor)), e.fixedColor.a = this.strokeOpacity;
            var t = this.map._renderer.getRenderEngine().createMesh(e, this.getStrokeMaterial(this.strokeWeight));
            return t.renderPriority = this.zIndex / this.map._renderer._maxZIndex + 1, null != this.position && (t.owner = this, this.strokeMeshs.push(t)), t
        }, g.prototype.triangulateFillShape = function() {
            var e = this.map.conf.get("area.useIndexedGeometries");
            if (this.fillOpacity && this.map)
                for (var t = p.triangulateFillShape(this.rings, e), i = 0; i < t.positionArrays.length; i++) {
                    var n = this.newFillMesh(),
                        r = n.geometry;
                    r._positionArray = t.positionArrays[i], r._indexArray = t.indexArrays[i], r.boundingRadius = t.boundingRadius
                }
        }, g.prototype.setCenter = function(e) {
            r.isEqual(this.center, e) || (this.center = r.clone(e), this._elevationsEnabled && this._recalculateGeometry(), this.visible && this.updateGeometryPosition())
        }, g.prototype.computeMeshsPosition = function(e, t) {
            this.position && r.each(e, function(e) {
                if (e.position.copy(this.position.clone()), this.center && e.position.addSelf(this.center), this.map) {
                    if (!this.disableZBuffer) {
                        var i = t * t,
                            n = Math.pow(2, this.map._renderer.getRenderEngine().getDepthBits()) - 1,
                            r = 2 * (i / (n * this.map.conf.get("camera.near")));
                        e.position.z += r + this.zIndex * r + .1
                    }
                    e.material.depthTest = !this.disableZBuffer, e.matrix.setPosition(e.position), e.updateMatrix()
                }
            }, this)
        }, g.prototype._handleWorkerSuccess = function(e, t, i) {
            if (this.map) {
                var n;
                if (e)
                    for (this.unloadMeshs(this.strokeMeshs), n = 0; n < e.positionArrays.length; n++) {
                        var r = this.newStrokeMesh(),
                            o = r.geometry;
                        o._positionArray = e.positionArrays[n], o._normalArray = e.normalArrays[n], o._indexArray = e.indexArrays[n], o.boundingRadius = e.boundingRadius
                    }
                if (t)
                    for (this.unloadMeshs(this.fillMeshs), n = 0; n < t.positionArrays.length; n++) {
                        var a = this.newFillMesh(),
                            s = a.geometry;
                        s._positionArray = t.positionArrays[n], s._indexArray = t.indexArrays[n], s.boundingRadius = t.boundingRadius
                    }
                this.position = i, this.updateGeometryPosition(), this.updateMeshsToScene(this.strokeMeshs, this.visible), this.updateMeshsToScene(this.fillMeshs, this.visible), this.map._renderer.forceRender()
            }
        }, g.prototype._handleWorkerErrors = function(e) {
            e.length > 0 && (console.warn("Triangulation of " + this.id + " produced errors :"), r.each(e, function(e) {
                console.log(e)
            }))
        }, g.prototype._handleWorkerException = function(e) {
            this.deleteGraphics(), console.error("Area worker failed : " + e)
        }, t.exports = g
    }, {
        "../../utils/AreaHelper": 398,
        "../GeojsonHelper": 310,
        "../buildings/building-generator": 320,
        "./Area": 311,
        "./AreaWorkerManager": 315,
        engine: 10,
        onecolor: 150,
        underscore: 207,
        util: 212
    }],
    315: [function(e, t, i) {
        "use strict";

        function n() {
            this._requestQueue = [], this._pendingAreaWork = {}, this._activeAreaWork = {}, this.workerRequestCallback = r.bind(this.performWork, this), this.workerBatchSize = 128, this.needsWorkerCallback = r.bind(function() {
                return this._requestQueue.length > 0
            }, this), o.registerWorkerConsumer({
                name: "AreaWorkerManager",
                consumer: this,
                workerCallback: this.workerRequestCallback,
                needsWorker: this.needsWorkerCallback,
                maxWorkers: 1,
                currentConsumption: 0
            })
        }
        var r = e("underscore"),
            o = e("../../utils/worker/WorkerManager"),
            a = 0,
            s = 0,
            l = 0,
            h = null,
            u = 0,
            d = 0,
            c = window.performance ? window.performance : Date;
        n.prototype.triangulateStrokeAndFillShapes = function(e) {
            if (e.startTime = null, e.flattenedRingData.ringsShapePoints.length > 0 && (e.doTriangulateStrokeShape || e.doTriangulateFillShape)) {
                if (this._pendingAreaWork[e.area.id]) {
                    for (var t = -1, i = 0; i < this._requestQueue.length; i++)
                        if (this._requestQueue[i].area.id == e.area.id) {
                            t = i;
                            break
                        }
                    if (t > -1) {
                        var n = this._requestQueue[t];
                        e.doTriangulateStrokeShape |= n.doTriangulateStrokeShape, e.doTriangulateFillShape |= n.doTriangulateFillShape, this._requestQueue.splice(t, 1)
                    }
                    delete this._pendingAreaWork[e.area.id]
                }
                this._requestQueue.push(e), this._pendingAreaWork[e.area.id] = e, o.requestWorker(this)
            }
        }, n.prototype.removePendingWorkForArea = function(e) {
            if (this._pendingAreaWork[e.id]) {
                for (var t = this._pendingAreaWork[e.id], i = -1, n = 0; n < this._requestQueue.length; n++)
                    if (this._requestQueue[n].area.id == t.area.id) {
                        i = n;
                        break
                    }
                i > -1 && this._requestQueue.splice(i, 1), delete this._pendingAreaWork[e.id]
            }
        }, n.prototype.performWork = function(e) {
            if (0 == this._requestQueue.length) o.releaseWorker(e);
            else {
                for (var t = this._requestQueue[0], i = r.bind(function(e, i) {
                        this.onWorkerError(e, t, i)
                    }, this), n = r.bind(function(e, i) {
                        this.onWorkerSuccess(e, t, i)
                    }, this), s = 0, l = {
                        areaData: [],
                        sendDate: c.now()
                    }, u = []; s < this.workerBatchSize && this._requestQueue.length > 0;) {
                    var d = this._requestQueue.shift();
                    delete this._pendingAreaWork[d.area.id], this._activeAreaWork[d.area.id] = d;
                    var f = c.now();
                    d.startTime = f, null == h && (h = f);
                    var p = {
                        areaId: d.area.id,
                        doTriangulateStrokeShape: d.doTriangulateStrokeShape,
                        doTriangulateFillShape: d.doTriangulateFillShape,
                        fillSimplifyPrecision: d.fillSimplifyPrecision,
                        strokeSimplifyPrecision: d.strokeSimplifyPrecision,
                        strokeWeight: d.area.strokeWeight,
                        strokePosition: d.area.strokePosition,
                        flattenedRingData: d.flattenedRingData,
                        useIndexedGeometry: d.useIndexedGeometry,
                        sendDate: c.now()
                    };
                    l.areaData.push(p);
                    var m = [d.flattenedRingData.ringsShapePoints.buffer, d.flattenedRingData.ringsShapeHolePoints.buffer, d.flattenedRingData.ringShapeEndIndices.buffer, d.flattenedRingData.ringShapeHolesEndIndices.buffer, d.flattenedRingData.ringShapeHolesRingIndices.buffer, d.flattenedRingData.ringRadiuses.buffer];
                    Array.prototype.push.apply(u, m), s++
                }
                var g = c.now();
                e.triangulateStrokeAndFillShapes({
                    data: l,
                    success: n,
                    error: i,
                    transfers: u
                });
                var _ = c.now();
                a += _ - g
            }
        }, n.prototype.onWorkerSuccess = function(e, t, i) {
            for (var n = i.allAreaTriangulationData, r = 0; r < n.length; r++) {
                var a = n[r],
                    h = a.areaId;
                if (this._activeAreaWork[h]) {
                    var f = this._activeAreaWork[h],
                        p = f.area;
                    delete this._activeAreaWork[p.id];
                    var m = a.strokeTriangulationData,
                        g = a.fillTriangulationData,
                        _ = a.errors,
                        v = a.doTriangulateStrokeShape,
                        y = a.doTriangulateFillShape;
                    v || (m = null), y || (g = null), _.length > 0 && f.errorsHandler(_), f.successHandler(m, g, f.position)
                }
            }
            var b = c.now(),
                x = b - i.sendDate,
                w = i.transferToWorkerMs,
                M = c.now();
            d++, u += M - t.startTime, s += w, l += x, o.releaseWorker(e)
        }, n.prototype.onWorkerError = function(e, t, i) {
            t.exceptionHandler(i), o.releaseWorker(e)
        }, n.prototype.onDivRemoved = function() {
            this._requestQueue = [], this._activeAreaWork = [], this._pendingAreaWork = []
        }, n.prototype.onAreaRemovedFromMap = function(e) {
            var t = this._pendingAreaWork[e.id];
            t && delete this._pendingAreaWork[e.id], this._requestQueue = r.reject(this._requestQueue, function(t) {
                return t.area == e
            }), t = this._activeAreaWork[e.id], t && delete this._activeAreaWork[e.id]
        }, t.exports = new n
    }, {
        "../../utils/worker/WorkerManager": 422,
        underscore: 207
    }],
    316: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.buildingLayer = e.buildingLayer, this.renderer = e.buildingLayer.map._renderer, this.position = e.position, this.sceneParent = e.sceneParent, this.radius = e.radius, this._maxBuildingZ = 0, this.tileKey = e.tileKey, this._neighborBlockTileKeys = b.getNeighborsTileKeys(this.tileKey), this.buildings = {}, this.renderPassToHandle = e.renderPassToHandle, this.material = e.material, this.meshes = [], this._scaleZ = 0, this.createNextMesh(), this._updateDebugColorCbk = r.bind(this.updateDebugColor, this), this.renderer.conf.on("change:debug.blockRandomColor", this._updateDebugColorCbk), this.bounds = e.bounds, this._applyBuildingNameVisibilityCallback = r.bind(this.applyBuildingNameVisibility, this), this.renderer.on("enter2d", this._applyBuildingNameVisibilityCallback), this.renderer.on("enter3d", this._applyBuildingNameVisibilityCallback), this._isHandledByWorker = !1, this._buildingsDataForWorker = [], this._buildingsOsmData = {}, this._extraBuildingsOsmData = {}, this._buildingsByWorkerId = {}, this._loadOnlyID = 0, this._workerBuildingCounter = 0, this._minimised = !1, this._blockRect = {}, this._minimisedRectData = [], this._minimisedPathData8 = [], this._minimisedPathData16 = [], this._defaultBuildingData = {}, this._defaultWayData = {}, this._defaultSkeletonData = {}
        }
        var r = e("underscore"),
            o = e("../../utils/StaticFileResolver"),
            a = e("./building-generator"),
            s = e("engine"),
            l = s.Model,
            h = s.Geometry,
            u = s.Color,
            d = s.Vector3,
            c = e("wellknown"),
            f = e("../../api/Marker"),
            p = e("../../translation"),
            m = e("../../api/LatLng"),
            g = e("./BlockWorkerManager"),
            _ = e("./BlockHelper"),
            v = e("./building-generator/src/ColorReader"),
            y = e("../../utils/LocationHelper"),
            b = e("../../utils/TileHelper");
        t.exports = n;
        var x = 100;
        n.prototype.destruct = function() {
            function e() {
                l.renderer.map && r.each(s, function(e) {
                    o.unregisterBoundingBox(e), e.model && (o.onSpecialBuildingUnloaded(e), e.model.abortLoading(), e.model.unload(), delete e.model), e.additionalMesh && (a.freeMesh(e.additionalMesh), delete e.additionalMesh), null != e.marker && (e.marker.setMap(null), e.marker = null)
                })
            }
            this.renderer.removeListener("enter2d", this._applyBuildingNameVisibilityCallback), this.renderer.removeListener("enter3d", this._applyBuildingNameVisibilityCallback);
            var t, i = this.meshes.length;
            for (t = 0; i > t; ++t) {
                var n = this.meshes[t];
                this.renderer.getRenderEngine().releaseObject(n)
            }
            delete this.mesh, delete this.position, this.meshes.length = 0;
            var o = this.buildingLayer,
                a = this.renderer.getRenderEngine(),
                s = this.buildings,
                l = this;
            this.renderer.isDestroyed ? e() : r.defer(function() {
                l.renderer.map && (l.renderer.isMoving() ? r.defer(e) : e())
            }), delete this.buildings, g.onBlockDestructed(this), this._updateSpawnAnimCb && this._stopScaleZAnim(), this.renderer.forceUpdateShadow(), this.renderer.conf.removeListener("change:debug.blockRandomColor", this._updateDebugColorCbk)
        }, n.prototype.createNextMesh = function() {
            this.mesh = this.renderer.getRenderEngine().createMesh(new h, this.material), this.meshes.push(this.mesh), this.mesh.geometry.boundingRadius = this.radius, this.mesh.geometry._positionArray = [], this.mesh.geometry._colorArray = [], this.mesh.geometry._normalArray = [], this.renderer.conf.get("buildings.useIndexedGeometries") && (this.mesh.geometry._indexArray = []), this.mesh.position.copy(this.position), this.mesh.updateMatrix(), this.updateDebugColor();
            for (var e = 0; e < this.renderPassToHandle.length; ++e) this.mesh.handleRenderPass[this.renderPassToHandle[e]] = !0
        }, n.prototype.updateDebugColor = function() {
            var e, t = this.meshes.length,
                i = this.renderer.conf.get("debug.blockRandomColor");
            for (e = 0; t > e; ++e) {
                var n = this.meshes[e];
                i ? (n.geometry.fixedColor = new u, n.geometry.fixedColor.random()) : n.geometry.fixedColor = null, n.geometry.__isColorDirty = !0
            }
        }, n.prototype._getMinScaleZ = function() {
            return this.buildingLayer.map.elevation ? this._minBuildingZ / this._maxBuildingZ : 0
        }, n.prototype.onLoaded = function() {
            function e(e) {
                e.geometry && t.getRenderEngine().updateObject(e)
            }
            var t = this.renderer;
            this.isLoaded = !0, this._scaleZ = this._getMinScaleZ(), this.animateHeightScale(this.buildingLayer.heightScale, this.buildingLayer.spawnAnimDurationMS, this.buildingLayer.easing);
            var i, n = this.meshes.length,
                o = !this.renderer.conf.get("buildings.keepSoftwareGeometries");
            for (i = 0; n > i; ++i) {
                var a = this.meshes[i];
                this.sceneParent.add(a), a.geometry.clearOnWebglLoad = o, a.scale.z = this._scaleZ, a.updateMatrix(), r.defer(e, a)
            }
            this.renderer.forceUpdateShadow(), this.renderer.forceRender()
        }, n.prototype.animateHeightScale = function(e, t, i) {
            var n = this._getMinScaleZ(),
                o = 1 - n,
                a = n + o * e;
            this._scaleZ != a && (i && 0 != t ? (this._updateSpawnAnimCb && this._stopScaleZAnim(), this._animation = {
                easing: i,
                initialScaleZ: this._scaleZ,
                targetScaleZ: a,
                duration: t,
                elapsed: 0
            }, this._startDateScale = Date.now(), this._updateSpawnAnimCb = r.bind(this._updateScaleZ, this), this.renderer.on("preRender", this._updateSpawnAnimCb), this.renderer.forceRender()) : this._scaleZ = a)
        }, n.prototype._stopScaleZAnim = function(e) {
            if (e) {
                var t = this.bounds;
                this.buildingLayer.map._renderer._pinsManager.updatePinsHeightInBounds({
                    left: t.xMin,
                    right: t.xMax,
                    top: t.yMax,
                    bottom: t.yMin
                })
            }
            this.renderer.removeListener("preRender", this._updateSpawnAnimCb), delete this._startDateScale, delete this._animation, delete this._updateSpawnAnimCb
        }, n.prototype._updateScaleZ = function(e) {
            if (this.renderer.isIn3d()) {
                var t = this._animation;
                t.elapsed += e.dt;
                var i = t.elapsed,
                    n = t.duration,
                    r = i / n,
                    o = t.initialScaleZ,
                    a = t.targetScaleZ - o;
                this._scaleZ = t.easing(r, i, o, a, n), i >= n && (this._scaleZ = t.targetScaleZ, this._stopScaleZAnim(!0));
                var s, l = this.meshes.length;
                for (s = 0; l > s; ++s) {
                    var h = this.meshes[s];
                    h.scale.z = this._scaleZ, h.updateMatrix()
                }
                this.renderer.forceUpdateShadow(), this.renderer.forceRender()
            }
        }, n.prototype._updateMaxBuildingZ = function(e) {
            this._maxBuildingZ = Math.max(this._maxBuildingZ, e)
        }, n.prototype._updateRadius = function(e, t) {
            var i, n = this.meshes.length;
            for (i = 0; n > i; ++i) {
                var r = this.meshes[i];
                r.geometry.boundingRadius = Math.max(r.geometry.boundingRadius, e)
            }
            t && this.buildingLayer.enlargeTileBounds(this.tileKey, t)
        }, n.prototype.loadSpecialBuildings = function() {
            var e = this.buildingLayer.getSpecialBuildingsForBlock(this.tileKey);
            e && r.each(e, function(e, t) {
                if (!this.buildingLayer.specialBuildingIsLoaded(t)) {
                    var i = this.buildings[t] = {
                        id: t,
                        position: new d(e.lon, e.lat, 0),
                        modelPosition: new d(e.lon, e.lat, 0)
                    };
                    this.buildingLayer.setSpecialBuildingLoaded(t), this.readBuildingElevation(i), this.loadSpecialBuilding(i, e)
                }
            }, this)
        }, n.prototype.loadSpecialBuilding = function(e, t) {
            e.model = new l(this.renderer.getRenderEngine());
            var i;
            if (t.texturePath) {
                var n = t.texturePath.split(".").pop();
                "png" != n && "jpg" != n && "zip" != n ? (n = t.useEnvmap || t.transparent ? ".png" : ".jpg", i = o(t.texturePath + n)) : i = o(t.texturePath)
            }
            var a = r.bind(function() {
                    if (e.model && e.model.mesh) {
                        for (var i = 0; i < this.renderPassToHandle.length; ++i) e.model.mesh.handleRenderPass[this.renderPassToHandle[i]] = !0;
                        var n = e.model.xyRadius,
                            r = {
                                left: e.modelPosition.x - n,
                                right: e.modelPosition.x + n,
                                bottom: e.modelPosition.y - n,
                                top: e.modelPosition.y + n
                            };
                        if (this.buildingLayer.registerBoundingBox(e, r, e.model.meshHeight), this._updateRadius(Math.max(n, e.model.meshHeight), r), this._updateMaxBuildingZ(e.model.meshHeight), void 0 === t.scaled && (t.scaled = !0), !t.scaled) {
                            var o = y.getScaleFromLatitude(e.modelPosition.y);
                            e.model.mesh.scale.set(o, o, o)
                        }(t.useEnvmap || t.transparent) && (e.model.mesh.preRenderFunc = function(e, t, i, n) {
                            "shadowDepth" == n && (t.oldDoubleSided = t.doubleSided, t.doubleSided = !0)
                        }, e.model.mesh.postRenderFunc = function(e, t, i, n) {
                            "shadowDepth" == n && (t.doubleSided = t.oldDoubleSided, delete t.oldDoubleSided)
                        }), t.footprint && (e.modelFootprint = t.footprint, e.modelBoundingBox = t.boundingBox), this.buildingLayer.onSpecialBuildingLoaded(e)
                    }
                }, this),
                s = {
                    pos: e.modelPosition,
                    sceneParent: this.sceneParent,
                    texturePath: i,
                    useEnvmap: t.useEnvmap,
                    useSpecularLighting: t.useEnvmap || t.useSpecularLighting,
                    doubleSided: t.doubleSided,
                    clearOnWebglLoad: !1,
                    transparent: t.transparent,
                    useAlphaStep: t.transparent
                };
            e.specialBuildingId = t.id, e.modelPath = t.modelPath, e.model.load(o(t.modelPath), s, a)
        }, n.prototype.readBuildingElevation = function(e) {
            if (e.parentBuildingId) {
                var t = this.buildings[e.parentBuildingId];
                if (t) return void(e.position.z = t.position.z)
            }
            if (this.buildingLayer.map.elevation) {
                var i = this.buildingLayer.map._renderer.findHeight(e.position);
                void 0 != this._minBuildingZ ? this._minBuildingZ = Math.min(this._minBuildingZ, i) : this._minBuildingZ = i, null == i ? e.position.z = 0 : e.position.z = i, null != e.modelPosition && (e.modelPosition.z = e.position.z)
            }
        }, n.prototype.applyBuildingNameVisibility = function() {
            this.setBuildingsTextVisible(this.renderer.isIn3d() && 0 != this.buildingLayer.name)
        }, n.prototype.setBuildingsTextVisible = function(e) {
            r.each(this.buildings, function(t) {
                t.marker && t.marker.setVisible(e)
            })
        }, n.prototype.createBuildingText = function(e, t) {
            var i = this.buildingLayer._getBuildingName(e, t);
            i && (null == e.marker ? e.marker = new f({
                icon: {
                    url: "data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
                },
                position: m.from900913(e.position.y, e.position.x),
                title: i,
                clickable: !1,
                visible: this.renderer.isIn3d() && 0 != this.buildingLayer.name,
                map: this.buildingLayer.map,
                id: e.id,
                zIndex: 0
            }) : e.marker.setTitle(i))
        }, n.prototype.handleAdditionalMesh = function(e, t, i) {
            var n = this.renderer.map._layersByType.details,
                r = n && n[0] || null;
            if (r) {
                var o;
                "ventilation" == i["chimney:type"] || "ruins" == i.historic ? o = null : "cooling_tower" == i.man_made || "cooling" == i["tower:type"] || "cooling_tower" == i.building ? o = "large" : ("chimney" == i.man_made || "chimney" == i["tower:type"] || "chimney" == i.building) && (o = "small"), o && (e.additionalMesh = r.createSmokeMesh(e.position, t, o), this.renderer.isIn3d() && e.additionalMesh && this.sceneParent.add(e.additionalMesh))
            }
        }, n.prototype.adaptHeights = function() {
            if (delete this._minBuildingZ, r.each(this.buildings, function(e) {
                    var t = e.position.z;
                    this.readBuildingElevation(e);
                    var i = e.position.z - t;
                    if (i) {
                        if (this.hasBeenAdapted = !0, e.mesh) {
                            for (var n = e.startOffset + 2; n < e.endOffset; n += 3) e.positionArray[n] += i;
                            e.mesh.geometry._positionArray = e.positionArray, e.mesh.geometry.__isPositionDirty = !0
                        } else e.model && (e.model.mesh ? (e.model.mesh.position.copy(e.modelPosition), e.model.mesh.updateMatrix()) : console.warn("no mesh for building block model", e));
                        e.additionalMesh && (e.additionalMesh.position.z += i, e.additionalMesh.updateMatrix()), this.buildingLayer.updateBoundingBoxHeight(e, i)
                    }
                }, this), this._updateSpawnAnimCb && this._startDateScale) {
                var e = this.buildingLayer.spawnAnimDurationMS - (Date.now() - this._startDateScale);
                this.animateHeightScale(this.buildingLayer.heightScale, e, this.buildingLayer.easing)
            }
        }, n.prototype.setMinimisedBlockData = function(e) {
            this._minimisedRectData = e.miniRectData, this._minimisedPathData8 = e.miniPathData8, this._minimisedPathData16 = e.miniPathData16, this._blockRect = e.blockRect, this._defaultBuildingData = e.defaultBuildingData, this._defaultWayData = e.defaultWayData, this._defaultSkeletonData = e.defaultSkeletonData
        }, n.prototype.loadBuilding = function(e, t) {
            if (this.isLoaded && !this._isHandledByWorker) return this.mesh.geometry.fixedColor = new u(16711680), void console.warn("Block", this.tileKey, "is already loaded, building ignored");
            r.defaults(t, this._defaultBuildingData);
            var i = this.buildings[e],
                n = null == i;
            i ? i.modelPosition && (n = this.buildingLayer.shouldExtrudeSpecialBuildingId(i.id)) : i = this.buildings[e] = {
                id: e,
                position: new d
            }, t.parentBuildingOsmId && (i.parentBuildingId = t.parentBuildingOsmId);
            var o = p.translateOsmName(this.renderer.conf, t);
            o && (i.name = o), n && this._prepareDataAndExtrude(e, i, t)
        }, n.prototype._getGeoJsonGeometry = function(e) {
            var t = r.isString(e.way) ? c(e.way) : e.way;
            if (t) return r.defaults(t, this._defaultWayData), t
        }, n.prototype._prepareDataAndExtrude = function(e, t, i) {
            var n = this._getGeoJsonGeometry(i);
            if (n) {
                i.skeleton && r.defaults(i.skeleton, this._defaultSkeletonData), this._minimised && (_.decodeGeometryRect(i, this._blockRect, this._minimisedRectData), _.decodeGeometryData(n, i.rect, this._minimisedPathData8, this._minimisedPathData16), i.skeleton && _.decodeGeometryData(i.skeleton, i.rect, this._minimisedPathData8, this._minimisedPathData16)), _.handleBuildingPosition(t, n, i), this._minimised && (t.position.x += this._blockRect.ox, t.position.y += this._blockRect.oy), this.readBuildingElevation(t);
                var o = {
                        x: this._minimised ? this._blockRect.ox + i.rect.ox : 0,
                        y: this._minimised ? this._blockRect.oy + i.rect.oy : 0
                    },
                    a = this.buildingLayer.isReplacedBySpecialBuilding(this.tileKey, t.id, o, n, t.parentBuildingId),
                    s = !0;
                a ? (this.createBuildingText(t, i), s = this.buildingLayer.shouldExtrudeSpecialBuildingId(t.id)) : t.parentBuildingId && (s = this.buildingLayer.shouldExtrudeSpecialBuildingId(t.parentBuildingId)), s = s && null == i["building:parts"] && "no" != i["building:part"], s && this._proceedToExtrude(e, t, i, n)
            }
        }, n.prototype._proceedToExtrude = function(e, t, i, n) {
            var o = this.position.clone(),
                s = this.position.clone();
            o.z = t.position.z, t.originOffset = new d, this._minimised && (o.x -= i.rect.ox, o.y -= i.rect.oy, o.x -= this._blockRect.ox, o.y -= this._blockRect.oy, t.originOffset.x = this._blockRect.ox, t.originOffset.y = this._blockRect.oy);
            var l = r.extend({
                geojson: n,
                origin: o,
                worldPosition: s,
                seed: e,
                osm: i,
                extendWallHeight: this.buildingLayer.map.elevation ? x : 0,
                positionArray: this.mesh.geometry._positionArray,
                normalArray: this.mesh.geometry._normalArray,
                colorArray: this.mesh.geometry._colorArray,
                indexArray: this.mesh.geometry._indexArray,
                debugInterface: this.renderer,
                debugBuildingColors: this.renderer.conf.get("debug.debugBuildingColors"),
                wallGradientColorEnabled: this.buildingLayer.wallGradientColorEnabled
            }, r.pick(this.buildingLayer, ["defaultWallColor", "defaultWallGradientColor", "defaultRoofColor", "wallColor", "roofColor"]));
            t.mesh = this.mesh, t.positionArray = this.mesh.geometry._positionArray, t.startOffset = this.mesh.geometry._positionArray.length;
            var u = null;
            try {
                u = a.extrudeBuilding(l)
            } catch (c) {
                t.error = "Building triangulation error:" + i.osm_id, console.warn("Building triangulation error:", i, "lon/lat", t.position.x, t.position.y, c)
            }
            t.endOffset = this.mesh.geometry._positionArray.length, this.handleExtrusionResult(t, i, u);
            var f = this.mesh.geometry._positionArray.length > h.maxFloatCount / 2;
            this.mesh.geometry._indexArray && (f = this.mesh.geometry._positionArray.length / 3 > h.maxIndexCount / 2), f && this.createNextMesh()
        }, n.prototype.processRawDataForWorker = function(e, t) {
            var i = [];
            e.buildingGeometries ? (Array.prototype.push.apply(i, e.buildingGeometries), Array.prototype.push.apply(i, e.parts), Array.prototype.push.apply(i, e.chimneys), this._extraBuildingsOsmData = e.buildingData) : this._minimised ? (i = e.buildings, this._extraBuildingsOsmData = {}) : (i = e, this._extraBuildingsOsmData = {});
            for (var n = [], r = [], o = 0; o < i.length; o++) {
                var a = i[o],
                    s = !0;
                s && n.push(a)
            }
            this._dataForWorker = n, this._loadOnlyID = t;
            var l = JSON.stringify(r);
            return this.buildingLayer.addBlockForPreProcessing(this), l
        }, n.prototype.handleWorkerPreProcessing = function() {
            null != this._dataForWorker && (this._loadBuildingsWithWorker(), 0 == this._dataForWorker.length && (this._dataForWorker = null, this.buildingLayer.removeBlockForPreProcessing(this)))
        }, n.prototype.handleWorkerPostProcessing = function() {
            null != this._dataFromWorker && (this._processesBlockWorkerResults(), 0 == this._dataFromWorker.bufferGeometries.length && 0 == this._dataFromWorker.buildingResults.length && (this._dataFromWorker = null, this.buildingLayer._handleBlockLoaded(this, this.bounds), this.buildingLayer.removeBlockForPostProcessing(this)))
        }, n.prototype._loadBuildingsWithWorker = function() {
            var e, t = Date.now(),
                i = 0,
                n = this.renderer.conf.get("workProcessor.blockWorkerProcessorDuration");
            for (this.renderer.isMoving() && (n = this.renderer.conf.get("workProcessor.blockWorkerProcessorDurationMoving")); this._dataForWorker && this._dataForWorker.length > 0 && n > i;) this._processOneWorkerTask(), e = Date.now(), i = e - t;
            if (0 == this._dataForWorker.length) {
                var o = [this.position.x, this.position.y, this.position.z],
                    a = r.extend({
                        worldPosition: o,
                        extendWallHeight: this.buildingLayer.map.elevation ? x : 0,
                        wallGradientColorEnabled: this.buildingLayer.wallGradientColorEnabled,
                        useIndexedData: this.renderer.conf.get("buildings.useIndexedGeometries")
                    }, r.pick(this.buildingLayer, ["defaultWallColor", "defaultWallGradientColor", "defaultRoofColor", "wallColor", "roofColor"]));
                this._minimised && (a.minimisedPathData8 = this._minimisedPathData8, a.minimisedPathData16 = this._minimisedPathData16), g.extrudeBlock({
                    block: this,
                    buildingsData: this._buildingsDataForWorker,
                    commonData: a,
                    tileBounds: this.bounds,
                    successHandler: r.bind(this._handleWorkerSuccess, this),
                    errorsHandler: r.bind(this._handleWorkerErrors, this),
                    exceptionHandler: r.bind(this._handleWorkerException, this)
                })
            }
        }, n.prototype._shouldExtrude = function(e, t) {
            var i = !0;
            return 0 != this._loadOnlyID && t.parentBuildingOsmId != this._loadOnlyID && e != this._loadOnlyID && (i = !1), i && !t.not_exceeding_tile && (i = !this.buildingLayer.isBuildingAlreadyLoaded(e, this._neighborBlockTileKeys)), i
        }, n.prototype._computeBuildingName = function(e, t) {
            var i = p.translateOsmName(this.renderer.conf, e);
            return i ? i : this._extraBuildingsOsmData[t] && (i = p.translateOsmName(this.renderer.conf, this._extraBuildingsOsmData[t])) ? i : void 0
        }, n.prototype._processOneWorkerTask = function() {
            var e = this._dataForWorker.shift(),
                t = e.osm_id,
                i = this._workerBuildingCounter++,
                n = this._shouldExtrude(t, e);
            if (n) {
                var o = this.buildings[t];
                o || (o = this.buildings[t] = {
                    id: t,
                    position: new d
                }), e.parentBuildingOsmId && (o.parentBuildingId = e.parentBuildingOsmId), this._buildingsByWorkerId[i] = o;
                var a = this._computeBuildingName(e, t);
                a && (o.name = a);
                var s = r.isString(e.way) ? c(e.way) : e.way;
                if (!s) return;
                r.defaults(s, this._defaultWayData), e.skeleton && r.defaults(e.skeleton, this._defaultSkeletonData);
                var l = r.clone(s);
                this._minimised && (_.decodeGeometryRect(e, this._blockRect, this._minimisedRectData), _.decodeGeometryData(l, e.rect, this._minimisedPathData8, this._minimisedPathData16)), _.handleBuildingPosition(o, s, e), this._minimised && (o.position.x += this._blockRect.ox, o.position.y += this._blockRect.oy), this.readBuildingElevation(o);
                var h = {
                        x: this._minimised ? this._blockRect.ox + e.rect.ox : 0,
                        y: this._minimised ? this._blockRect.oy + e.rect.oy : 0
                    },
                    u = this.buildingLayer.isReplacedBySpecialBuilding(this.tileKey, t, h, l, o.parentBuildingId);
                u ? (this.createBuildingText(o, e), n = this.buildingLayer.shouldExtrudeSpecialBuildingId(t)) : o.parentBuildingId && (n = this.buildingLayer.shouldExtrudeSpecialBuildingId(o.parentBuildingId)),
                    n = n && null == e["building:parts"] && "no" != e["building:part"], n && this._prepareDataForWorkerExtrude(o, e, i, t, s)
            }
        }, n.prototype._prepareDataForWorkerExtrude = function(e, t, i, n, o) {
            var a = this.position.clone();
            a.z = e.position.z, e.originOffset = new d, this._minimised && (a.x -= t.rect.ox, a.y -= t.rect.oy, a.x -= this._blockRect.ox, a.y -= this._blockRect.oy, e.originOffset.x += this._blockRect.ox, e.originOffset.y += this._blockRect.oy);
            var s = [a.x, a.y, a.z],
                l = {
                    id: i,
                    geojson: o,
                    seed: n,
                    osm: t,
                    origin: s
                };
            this.buildingLayer.wallColor && (l.wallColor = v.getWallColor(t, this.buildingLayer)), this.buildingLayer.roofColor && (l.roofColor = v.getRoofColor(t, this.buildingLayer)), this._buildingsDataForWorker.push(l), this._extraBuildingsOsmData[n] ? (r.extend(this._extraBuildingsOsmData[n], t), this._buildingsOsmData[i] = this._extraBuildingsOsmData[n]) : this._buildingsOsmData[i] = t
        }, n.prototype.isHandledByWorker = function() {
            return this._isHandledByWorker
        }, n.prototype.handleExtrusionResult = function(e, t, i) {
            if (i) {
                e.originOffset && (i.bounds.left += e.originOffset.x, i.bounds.right += e.originOffset.x, i.bounds.bottom += e.originOffset.y, i.bounds.top += e.originOffset.y), t.rect && (i.bounds.left += t.rect.ox, i.bounds.right += t.rect.ox, i.bounds.bottom += t.rect.oy, i.bounds.top += t.rect.oy);
                var n = i.boundingRadius;
                if (n > 1e4) return void console.error("Building " + e.id + " too big radius : " + n);
                var r = {
                        left: e.position.x - n,
                        right: e.position.x + n,
                        bottom: e.position.y - n,
                        top: e.position.y + n
                    },
                    o = this.position.distanceTo(e.position),
                    a = Math.max(o + i.boundingRadius, i.maxHeightAboveSeaLevel);
                this._updateRadius(a, r), this._updateMaxBuildingZ(i.maxHeightAboveSeaLevel), this.buildingLayer.registerBoundingBox(e, i.bounds, i.maxHeightAboveSeaLevel), this.handleAdditionalMesh(e, i.maxHeightAboveSeaLevel, t)
            }
            this.createBuildingText(e, t)
        }, n.prototype._handleWorkerSuccess = function(e, t) {
            this._dataFromWorker = {
                bufferGeometries: e,
                buildingResults: t
            }, this.buildingLayer.addBlockForPostProcessing(this)
        }, n.prototype._processesBlockWorkerResults = function() {
            var e, t = Date.now(),
                i = 0,
                n = this.renderer.conf.get("workProcessor.blockWorkerProcessorDuration");
            if (this.renderer.isMoving() && (n = this.renderer.conf.get("workProcessor.blockWorkerProcessorDurationMoving")), !this.mesh) return console.warn("Block mesh is deleted while worker is still working !!!"), this._dataFromWorker && this._dataFromWorker.buildingResults && (this._dataFromWorker.buildingResults.length = 0), void(this._dataFromWorker && this._dataFromWorker.bufferGeometries && (this._dataFromWorker.bufferGeometries.length = 0));
            if (this._dataFromWorker && this._dataFromWorker.bufferGeometries)
                for (var o = this.mesh, a = []; this._dataFromWorker.bufferGeometries.length > 0 && n > i;) {
                    var s = this._dataFromWorker.bufferGeometries.shift();
                    a.push(o);
                    var l = s.position32Array,
                        h = s.normal32Array,
                        u = s.color32Array,
                        d = s.index16Array;
                    o.geometry._positionArray = l, o.geometry._normalArray = h, o.geometry._colorArray = u, o.geometry._indexArray = d, this._dataFromWorker.bufferGeometries.length > 0 && (this.createNextMesh(), o = this.mesh), e = Date.now(), i = e - t
                }
            if (this._dataFromWorker && this._dataFromWorker.buildingResults)
                for (; this._dataFromWorker.buildingResults.length > 0 && n > i;) {
                    var c = this._dataFromWorker.buildingResults.shift(),
                        f = this._buildingsByWorkerId[c.id];
                    f.mesh = this.meshes[c.geometryIndex], f.positionArray = f.mesh.geometry._positionArray, f.startOffset = c.positionStartOffset, f.endOffset = c.positionEndOffset;
                    var p = this.getBuildingOsmData(c.id);
                    r.defaults(p, this._defaultBuildingData), f.startOffset == f.endOffset ? this.handleExtrusionResult(f, p, null) : this.handleExtrusionResult(f, p, c.extrusionResult), e = Date.now(), i = e - t
                }
        }, n.prototype._handleWorkerErrors = function(e) {
            r.each(e, function(e) {
                var t = this._buildingsByWorkerId[e.id],
                    i = this.getBuildingOsmData(e.id);
                t.error = "Building triangulation error:" + i.osm_id, console.warn("Building triangulation error:", i, "lon/lat", t.position.x, t.position.y, e.error), this.handleExtrusionResult(t, i, null)
            }, this)
        }, n.prototype._handleWorkerException = function(e) {
            console.error("Block worker failed : " + e), this._buildingsDataForWorker = [], this._buildingsOsmData = {}
        }, n.prototype.getBuildingOsmData = function(e) {
            return this._buildingsOsmData[e]
        }
    }, {
        "../../api/LatLng": 233,
        "../../api/Marker": 241,
        "../../translation": 396,
        "../../utils/LocationHelper": 407,
        "../../utils/StaticFileResolver": 410,
        "../../utils/TileHelper": 411,
        "./BlockHelper": 317,
        "./BlockWorkerManager": 318,
        "./building-generator": 320,
        "./building-generator/src/ColorReader": 324,
        engine: 10,
        underscore: 207,
        wellknown: 213
    }],
    317: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = e.rectIndex,
                r = t.sx,
                o = t.sy,
                a = 65535;
            e.rect = {
                ox: i[n + 0] / a * r,
                oy: i[n + 1] / a * o,
                sx: i[n + 2] / a * r,
                sy: i[n + 3] / a * o
            }, (0 != i[n + 4] || 0 != i[n + 5]) && (e.rect.cx = i[n + 4] / a * r, e.rect.cy = i[n + 5] / a * o)
        }

        function r(e, t, i, n) {
            function r(e, t) {
                if (u.isArray(e[0])) u.each(e, function(e) {
                    var i = [];
                    t.push(i), r(e, i)
                });
                else
                    for (var i = 0; i < e.length; i += 2) {
                        var n = e[i],
                            a = e[i + 1],
                            l = [];
                        t.push(l);
                        for (var c = n; n + a > c; c += 2) {
                            var f = o[c],
                                p = o[c + 1],
                                m = h * f / s,
                                g = d * p / s;
                            l.push([m, g])
                        }
                    }
            }
            if ("Point" === e.type && null == e.coordinates) return void(e.coordinates = [t.ox, t.oy]);
            var o, a = null,
                s = 0;
            e.x1 ? (a = "x1", s = 15, o = i) : e.x2 ? (a = "x2", s = 255, o = i) : e.x3 ? (a = "x3", s = 4095, o = n) : e.x4 && (a = "x4", s = 65535, o = n);
            var l = e[a];
            if (l) {
                e.coordinates = [];
                var h = t.sx,
                    d = t.sy;
                r(l, e.coordinates)
            }
        }

        function o(e, t, i) {
            if (i.centroid) {
                var n = u.isString(i.centroid) ? i.centroid : i.centroid;
                e.position.set(n.coordinates[0], n.coordinates[1], n.coordinates[2] || 0)
            } else if (i.rect) {
                var r = i.rect;
                r.cx && r.cy ? e.position.set(r.cx, r.cy, 0) : e.position.set(r.ox + .5 * r.sx, r.oy + .5 * r.sy, 0)
            } else {
                var o = d.getGeometryBounds(t);
                e.position.set((o.left + o.right) / 2, (o.bottom + o.top) / 2, 0)
            }
        }

        function a(e) {
            var t = e,
                i = {
                    value: 0
                },
                n = s(t, i);
            if ("f4-b-v0" === n) {
                var r = l(t, i),
                    o = h(t, i),
                    a = h(t, i),
                    d = JSON.parse(s(t, i));
                return u.extend(d, {
                    miniRectData: a,
                    miniPathData8: r,
                    miniPathData16: o
                })
            }
            return console.error("unknown binary building data format " + n), null
        }

        function s(e, t) {
            for (var i = c(e, t), n = 32768, r = 0, o = ""; i > r;) {
                var a = Math.min(i - r, n),
                    s = new Uint8Array(e, t.value + r, a / Uint8Array.BYTES_PER_ELEMENT);
                o += String.fromCharCode.apply(null, s), r += a
            }
            return t.value += i, decodeURI(o)
        }

        function l(e, t) {
            var i = c(e, t),
                n = new Uint8Array(e, t.value, i / Uint8Array.BYTES_PER_ELEMENT);
            return t.value += i, n
        }

        function h(e, t) {
            var i = c(e, t),
                n = new Uint16Array(e, t.value, i / Uint16Array.BYTES_PER_ELEMENT);
            return t.value += i, n
        }
        var u = e("underscore"),
            d = e("../GeojsonHelper");
        t.exports = {
            decodeGeometryRect: n,
            decodeGeometryData: r,
            handleBuildingPosition: o,
            decodeBinaryBuildingData: a
        };
        var c = function(e, t) {
            var i = t.value % Uint32Array.BYTES_PER_ELEMENT;
            0 != i && (t.value += Uint32Array.BYTES_PER_ELEMENT - i);
            var n = new Uint32Array(e, t.value, 1);
            return t.value += Uint32Array.BYTES_PER_ELEMENT, n[0]
        }
    }, {
        "../GeojsonHelper": 310,
        underscore: 207
    }],
    318: [function(e, t, i) {
        "use strict";

        function n() {
            this._requestQueue = [], this._blockWork = {}, this.workerRequestCallback = r.bind(this.performWork, this), this.needsWorkerCallback = r.bind(function() {
                return this._requestQueue.length > 0
            }, this), a.registerWorkerConsumer({
                name: "BlockWorkerManager",
                consumer: this,
                workerCallback: this.workerRequestCallback,
                needsWorker: this.needsWorkerCallback,
                maxWorkers: 1,
                currentConsumption: 0
            })
        }
        var r = e("underscore"),
            o = e("./BlockWorkerResultsHelper"),
            a = e("../../utils/worker/WorkerManager"),
            s = 0,
            l = 0,
            h = 0,
            u = null,
            d = 0,
            c = 0,
            f = window.performance && window.performance.now ? window.performance : Date;
        n.prototype.extrudeBlock = function(e) {
            e.isWorking = !1, e.blockDestructed = !1, e.startTime = null, e.buildingsData.length > 0 ? (this._requestQueue.push(e), this._blockWork[e.block.tileKey] = e, a.requestWorker(this)) : null != e.buildingLayerCallback && e.buildingLayerCallback(e.block, e.tileBounds)
        }, n.prototype.performWork = function(e) {
            if (0 == this._requestQueue.length) a.releaseWorker(e);
            else {
                var t = this._requestQueue.shift(),
                    i = f.now();
                t.startTime = i, null == u && (u = i);
                var n = r.bind(function(e, i) {
                        this.onWorkerError(e, t, i)
                    }, this),
                    o = r.bind(function(e, i) {
                        this.onWorkerSuccess(e, t, i)
                    }, this),
                    l = t.buildingsData,
                    h = t.commonData,
                    d = {
                        commonData: h,
                        buildingsData: l,
                        sendDate: f.now()
                    },
                    c = JSON.stringify(d);
                t.isWorking = !0;
                var p = f.now();
                e.extrudeBlock({
                    data: c,
                    success: o,
                    error: n
                });
                var m = f.now();
                s += m - p
            }
        }, n.prototype.onWorkerSuccess = function(e, t, i) {
            t.isWorking = !1;
            var n = t.block;
            if (delete this._blockWork[n.tileKey], !t.blockDestructed) {
                var r = i.bufferGeometries,
                    s = JSON.parse(i.stringifiedBuildingErrors),
                    u = i.buildingResultsBufferArrays,
                    p = o.fromBufferArrays(u),
                    m = f.now(),
                    g = m - i.sendDate,
                    _ = i.transferToWorkerMs;
                s.length > 0 && t.errorsHandler(s), t.successHandler(r, p);
                var v = f.now();
                c++, d += v - t.startTime, l += _, h += g
            }
            a.releaseWorker(e)
        }, n.prototype.onWorkerError = function(e, t, i) {
            t.exceptionHandler(i), a.releaseWorker(e)
        }, n.prototype.onBlockDestructed = function(e) {
            var t = this._blockWork[e.tileKey];
            t && (t.isWorking ? t.blockDestructed = !0 : delete this._blockWork[e.tileKey]), this._requestQueue = r.reject(this._requestQueue, function(t) {
                return t.block == e
            })
        }, t.exports = new n
    }, {
        "../../utils/worker/WorkerManager": 422,
        "./BlockWorkerResultsHelper": 319,
        underscore: 207
    }],
    319: [function(e, t, i) {
        "use strict";

        function n(e) {
            for (var t = [], i = [], n = 0; n < e.length; n++) {
                var r = e[n];
                i.push(r.id), i.push(r.geometryIndex), i.push(r.positionStartOffset), i.push(r.positionEndOffset), t.push(r.extrusionResult.boundingRadius), t.push(r.extrusionResult.maxHeightAboveSeaLevel), t.push(r.extrusionResult.bounds.top), t.push(r.extrusionResult.bounds.bottom), t.push(r.extrusionResult.bounds.left), t.push(r.extrusionResult.bounds.right)
            }
            return {
                float32Array: new Float32Array(t),
                int32Array: new Int32Array(i)
            }
        }

        function r(e) {
            for (var t, i = e.float32Array, n = e.int32Array, r = [], s = 0; s < n.length; s += o) t = {
                id: n[s + 0],
                geometryIndex: n[s + 1],
                positionStartOffset: n[s + 2],
                positionEndOffset: n[s + 3]
            }, r.push(t);
            for (var l = 0; l < r.length; l++) {
                var h = l * a;
                t = r[l], t.extrusionResult = {
                    boundingRadius: i[h + 0],
                    maxHeightAboveSeaLevel: i[h + 1],
                    bounds: {
                        top: i[h + 2],
                        bottom: i[h + 3],
                        left: i[h + 4],
                        right: i[h + 5]
                    }
                }
            }
            return r
        }
        var o = 4,
            a = 6;
        t.exports = {
            toBufferArrays: n,
            fromBufferArrays: r
        }
    }, {}],
    320: [function(e, t, i) {
        "use strict";
        var n = e("./src/BuildingGenerator"),
            r = e("./src/ColorReader"),
            o = e("./src/ShapeParser");
        t.exports = {
            extrudeBuilding: n.extrudeBuilding,
            extendColorMapping: r.extendColorMapping,
            parseShape: o.parseShape,
            parseWKT: o.parseWKT
        }
    }, {
        "./src/BuildingGenerator": 321,
        "./src/ColorReader": 324,
        "./src/ShapeParser": 326
    }],
    321: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            var i = .01;
            return e > 20 && (i = .1), !t.roof.useSkeleton && e > 2e4 && (i = .25), i
        }

        function r(e, t, i) {
            for (var n, r, o = 0; o < e.rings.length;) {
                n = e.rings[o];
                var a = p(n.shapePts, i);
                if (v.checkStartEnd(a), a.length < 3) e.rings.splice(o, 1);
                else {
                    for (e.rings[o].shapePts = a, r = 0; r < n.shapeHolePts.length;) {
                        var s = n.shapeHolePts[r],
                            l = p(s, t);
                        v.checkStartEnd(l), l.length < 3 ? n.shapeHolePts.splice(r, 1) : (n.shapeHolePts[r] = l, r++)
                    }
                    o++
                }
            }
        }

        function o(e) {
            return {
                x: +(e.origin && e.origin.x || 0),
                y: +(e.origin && e.origin.y || 0),
                z: +(e.origin && e.origin.z || 0)
            }
        }

        function a(e, t) {
            return {
                x: +(e.worldPosition && e.worldPosition.x || t.x),
                y: +(e.worldPosition && e.worldPosition.y || t.y),
                z: +(e.worldPosition && e.worldPosition.z || t.z)
            }
        }

        function s(e) {
            g.isString(e) && (e = {
                wkt: e
            });
            var t = o(e),
                i = a(e, t),
                s = e.osm || {},
                d = e.geojson || c.parseWKT(e.wkt),
                p = c.parseShape(d, t, !0),
                _ = p.genInfo = m.readBuildingGenInfo(e.seed, s, i, e),
                v = p.bounds,
                y = (v.top - v.bottom) * (v.right - v.left),
                b = .01,
                x = n(y, _);
            if (r(p, b, x), 0 == p.rings.length) return null;
            f.updateRingsForRoof(p.rings, t, s, _, e.debugInterface);
            var w, M = {
                    position: p.position,
                    bounds: p.bounds,
                    boundingRadius: 0,
                    maxHeightAboveSeaLevel: _.maxHeightAboveSeaLevel,
                    roof: {
                        color: _.roof.color,
                        _positionArray: e.positionArray,
                        _colorArray: e.colorArray,
                        _normalArray: e.normalArray,
                        _indexArray: e.indexArray
                    },
                    wall: {
                        color: _.wall.color,
                        _positionArray: e.positionArray,
                        _colorArray: e.colorArray,
                        _normalArray: e.normalArray,
                        _indexArray: e.indexArray
                    }
                },
                T = p.rings.length;
            for (w = 0; T > w; ++w) {
                var S = p.rings[w],
                    C = !1;
                if (_.wall.extrude ? (h(_, M, S), C = 0 != _.wall.minHeight && !_.wall.minHeightForced) : _.splits || (C = !0), l(_, M, S, e, {
                        origin: t,
                        needsFloorTriangulation: C
                    }), e.debugBuildingColors)
                    for (var E = M.roof._colorArray.length / 12, k = 0; E > k; ++k)
                        for (var L = .8, P = L + (1 - L) * Math.random(), A = L + (1 - L) * Math.random(), R = L + (1 - L) * Math.random(), D = 0; 3 > D; D++) M.roof._colorArray[12 * k + 4 * D] *= P, M.roof._colorArray[12 * k + 4 * D + 1] *= A, M.roof._colorArray[12 * k + 4 * D + 2] *= R;
                C && u(_, M, S), M.boundingRadius = Math.max(M.boundingRadius, S.radius)
            }
            return M.boundingRadius = Math.max(M.boundingRadius, _.maxHeightAboveSeaLevel), M
        }

        function l(e, t, i, n, r) {
            var o = r.origin,
                a = r.needsFloorTriangulation;
            if (e.splits || null != e.splitsGenerator) {
                if (null != e.splitsGenerator) {
                    var s = 2 * d(i, e.roof);
                    e.splitsGenerator(s), delete e.splitsGenerator
                }
                var l = v.getMinimalOBox(i.shapePts);
                _.triangulateShapeFromSplits(t.roof, i.shapePts, e.splits, l, e.roof.smooth)
            } else n.debugInterface && n.debugBuildingColors && (n.debugInterface.debugRenderPointsAsLine(i.shapePts, o, !0, 16711935), i.innerPoints && n.debugInterface.debugRenderPointsAsLine(i.innerPoints, o, !1, 255)), _.triangulateRing(t.roof, i, {
                height: e.roof.minHeight,
                color: e.roof.color,
                flipSided: !1,
                copyArrays: a,
                slowerButMoreAcurate: !1,
                normalSmoothing: e.roof.smooth
            })
        }

        function h(e, t, i) {
            var n, r = {
                minHeight: e.wall.minHeight,
                height: 0,
                color: e.wall.color,
                closed: !0,
                repeatUv: !1,
                normalSmoothing: e.wall.smooth
            };
            for (_.extrudeWall(t.wall, i.shapePts, r), n = 0; n < i.shapeHolePts.length; ++n) _.extrudeWall(t.wall, i.shapeHolePts[n], r)
        }

        function u(e, t, i) {
            e.wall.extrude || _.triangulateRing(t.roof, i, {
                height: e.roof.minHeight,
                color: e.roof.color,
                flipSided: !0,
                copyArrays: !1,
                slowerButMoreAcurate: !1,
                normalSmoothing: e.roof.smooth
            }), v.setRingHeight(i, e.wall.minHeight), delete i.innerPoints;
            var n = e.wall.color;
            g.isArray(n) && (n = n[0]), _.triangulateRing(t.wall, i, {
                height: e.wall.minHeight,
                color: n,
                flipSided: !0,
                copyArrays: !1,
                slowerButMoreAcurate: !1,
                normalSmoothing: e.roof.smooth
            })
        }

        function d(e, t) {
            var i = v.getMinimalOBox(e.shapePts),
                n = i.center.clone(),
                r = t.minHeight,
                o = t.height;
            n.z = r + o;
            for (var a = -(1 / 0), s = 0; s < e.shapePts.length; ++s) {
                var l = e.shapePts[s];
                a = Math.max(a, l.distanceTo(n))
            }
            return a
        }
        var c = e("./ShapeParser"),
            f = e("./RoofGenerator"),
            p = e("simplify-js"),
            m = e("./BuildingInfoReader"),
            g = e("underscore"),
            _ = e("engine/tools").TriangulationUtils,
            v = e("engine/tools").ShapeUtils;
        t.exports = {
            extrudeBuilding: s
        }
    }, {
        "./BuildingInfoReader": 322,
        "./RoofGenerator": 325,
        "./ShapeParser": 326,
        "engine/tools": 97,
        "simplify-js": 199,
        underscore: 207
    }],
    322: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = 20037508.34;
            return B.cosh(Math.PI * e / t)
        }

        function r(e, t) {
            return "roof" == e.building || "roof" == e["building:part"] ? !1 : ("no" != e.wall || z.isGreenHouse(e)) && !O.contains(K, t)
        }

        function o(e) {
            return O.contains(X, e)
        }

        function a(e) {
            return e["building:shape"] && O.contains($, e["building:shape"]) ? !0 : e.building && O.contains($, e.building) ? !0 : e["building:part"] && O.contains($, e["building:part"])
        }

        function s(e) {
            var t = e["roof:direction"] || e["roof:slope:direction"];
            if (t) {
                var i = B.angleFromNorthInDegree(t);
                t = isNaN(i) ? null : i
            }
            return t
        }

        function l(e) {
            return e["building:roof:orientation"] || e["roof:orientation"] || null
        }

        function h(e) {
            return "storage_tank" == e.building || "storage_tank" == e.man_made || "gasometer" == e.man_made
        }

        function u(e) {
            return O.contains(W, e.building) || O.contains(["chimney"], e.man_made) || "tower" == e.man_made && "communication" != e["tower:type"]
        }

        function d(e) {
            return O.contains(G, e.building) || "no" == e.wall
        }

        function c(e) {
            return null != e.ruins || "ruins" == e.historic
        }

        function f(e) {
            return O.contains(j, e.building) || O.contains(["antenna", "mast", "communications_tower"], e.man_made) || "tower" == e.man_made && "communication" == e["tower:type"]
        }

        function p(e, t) {
            var i = 7,
                n = 10;
            return c(e) ? (i = 3, n = 4) : u(e) ? (i = 50, n = 75) : f(e) ? (i = 10, n = 20) : d(e) && (i = 3, n = 4), v(t, i, n)
        }

        function m(e) {
            return null != e.final_area ? parseFloat(e.final_area) : null != e.way_area ? parseFloat(e.way_area) : -1
        }

        function g(e) {
            if (null == e) return !1;
            var t = _(e);
            return !O.isNaN(t) && null != t
        }

        function _(e) {
            return parseFloat(e)
        }

        function v(e, t, i) {
            return t + Math.abs(e) % (i - t)
        }

        function y(e, t, i, n) {
            if ("hyperboloid_small" == e.roof.shape) {
                var r = function(t) {
                    e.splits = [{
                        z: e.roof.minHeight,
                        xy: 0,
                        color: n
                    }, {
                        z: .6 * t + e.roof.minHeight,
                        xy: .4,
                        color: n
                    }, {
                        z: t + e.roof.minHeight,
                        xy: .4,
                        color: n
                    }, {
                        z: t + e.roof.minHeight,
                        xy: .41,
                        color: e.roof.color
                    }, {
                        z: e.roof.minHeight,
                        xy: .41,
                        color: n
                    }]
                };
                0 != e.roof.height ? r(e.roof.height) : e.splitsGenerator = r
            } else if ("hyperboloid_big" == e.roof.shape) {
                var o = function(t) {
                    e.splits = [{
                        z: e.roof.minHeight,
                        xy: 0,
                        color: n
                    }, {
                        z: .2 * t + e.roof.minHeight,
                        xy: .2,
                        color: n
                    }, {
                        z: .5 * t + e.roof.minHeight,
                        xy: .35,
                        color: n
                    }, {
                        z: .8 * t + e.roof.minHeight,
                        xy: .4,
                        color: n
                    }, {
                        z: t + e.roof.minHeight,
                        xy: .4,
                        color: n
                    }, {
                        z: t + e.roof.minHeight,
                        xy: .41,
                        color: e.roof.color
                    }, {
                        z: e.roof.minHeight,
                        xy: .41,
                        color: n
                    }]
                };
                0 != e.roof.height ? o(e.roof.height) : e.splitsGenerator = o
            } else if ("onion" == e.roof.shape) {
                var a = function(t) {
                    e.splits = [{
                        z: e.roof.minHeight,
                        xy: 0,
                        color: e.roof.color
                    }, {
                        z: .1 * t + e.roof.minHeight,
                        xy: -.3,
                        color: e.roof.color
                    }, {
                        z: .25 * t + e.roof.minHeight,
                        xy: -.4,
                        color: e.roof.color
                    }, {
                        z: .4 * t + e.roof.minHeight,
                        xy: -.3,
                        color: e.roof.color
                    }, {
                        z: .5 * t + e.roof.minHeight,
                        xy: -.1,
                        color: e.roof.color
                    }, {
                        z: .6 * t + e.roof.minHeight,
                        xy: .5,
                        color: e.roof.color
                    }, {
                        z: .7 * t + e.roof.minHeight,
                        xy: .8,
                        color: e.roof.color
                    }, {
                        z: .8 * t + e.roof.minHeight,
                        xy: .9,
                        color: e.roof.color
                    }, {
                        z: t + e.roof.minHeight,
                        xy: 1,
                        color: e.roof.color
                    }]
                };
                0 != e.roof.height ? a(e.roof.height) : e.splitsGenerator = a
            } else if ("steps" == t["building:part"] || "steps" == t.building) {
                var s = t["step:height"] ? parseFloat(t["step:height"]) : .16;
                e.roof.stepHeight = s * i, e.roof.stepCount = t.step_count ? parseFloat(t.step_count) : 0
            }
        }

        function b(e, t, i) {
            i.autoRoof = !1, "flat" == t ? (i.roof && i.roof > 0 && console.log("flat roof with height is unsupported"), i.roof = 0) : 0 === i.roof && (e["building:shape"] && O.contains(q, e["building:shape"]) ? i.roof = i.total : (i.roof = Q[t] || 0, 0 == i.roof && 0 == i.total && 0 != i.wall ? i.autoRoof = !0 : 0 != i.roof && 0 != i.total && i.roof > i.total && (i.roof = i.total / 3)))
        }

        function x(e) {
            var t;
            return g(e.height) ? t = _(e.height) : g(e["building:height"]) && (t = _(e["building:height"])), t
        }

        function w(e, t) {
            if (null == e.floor && (e.floor = 0, t.isDefaultWallMinHeight = !0), e.floor && e.total && e.total < e.floor) {
                var i = e.total - e.roof;
                e.total = e.floor + e.roof, e.floor = i
            }
            e.wall < 0 && (e.wall = -e.wall, e.floor -= e.wall), 0 == e.total && e.wall > 0 && (e.total = e.wall + e.roof, t.isHeightComputed = !0)
        }

        function M(e, t, i, n, r) {
            0 == e.total && (t.fullRoofBuilding ? e.roof || (e.roof = p(i, n || 0)) : e.wall = p(i, n || 0), e.total = e.wall + e.roof, t.isHeightGenerated = !0, t.isHeightComputed = !0, O.contains(K, r) && (e.roof = e.total))
        }

        function T(e, t) {
            e.floor > 0 && ("cooling" === t["tower:type"] || "chimney" === t.man_made) && (e.roof -= e.floor)
        }

        function S(e, t) {
            e.floor < 0 && !t.isHeightComputed && (e.total += -e.floor)
        }

        function C(e, t, i) {
            e.fullRoofBuilding || e.isHeightComputed && 0 != t.wall || (O.contains(K, i) ? t.wall = 0 : t.wall = t.total - Math.max(t.floor, 0))
        }

        function E(e, t) {
            e.wall + e.floor != 0 || t.fullRoofBuilding || (e.wall -= 1)
        }

        function k(e, t, i) {
            "flat" == e || t.isHeightComputed || (i.wall -= i.roof, i.wall = Math.max(0, i.wall))
        }

        function L(e, t) {
            var i = D(e),
                n = i.wallHeight,
                r = i.fullRoofBuilding,
                o = {
                    total: x(e) || 0,
                    wall: n,
                    roof: R(e) || 0,
                    floor: I(e)
                },
                a = {
                    isHeightGenerated: !1,
                    isHeightComputed: !1,
                    fullRoofBuilding: r,
                    isDefaultWallMinHeight: !1
                },
                s = e.f4roof;
            s || (h(e) ? (o.roof = o.roof || 1.5, s = "dome") : "cooling" === e["tower:type"] ? (o.roof = o.total || o.wall, o.wall = 0, a.fullRoofBuilding = !0, s = "hyperboloid_big") : "chimney" === e.man_made ? (o.roof = o.total || o.wall, o.wall = 0, a.fullRoofBuilding = !0, s = "hyperboloid_small") : s = o.roof ? "hipped" : "flat"), O.contains(q, s) || (O.contains(V, s) || console.log("roof shape not handled", s, e), s = "flat"), b(e, s, o), w(o, a), M(o, a, e, t, s), T(o, e), S(o, a), C(a, o, s), E(o, a), k(s, a, o);
            var l = +e.layer;
            return a.isDefaultWallMinHeight && a.isHeightGenerated && 0 > l && "yes" == e.tunnel && (o.floor = U * l - o.total), {
                wallHeight: o.wall,
                roofHeight: o.roof,
                roofShape: s,
                autoRoofHeight: o.autoRoof,
                wallMinHeight: o.floor
            }
        }

        function P(e, t, i, h) {
            var u = L(t, e),
                d = u.wallHeight,
                c = u.roofHeight,
                f = u.roofShape,
                p = u.autoRoofHeight,
                g = u.wallMinHeight,
                _ = n(i.y),
                v = o(f),
                b = F.getWallColor(t, h),
                x = F.getRoofColor(t, h),
                w = void 0 !== t["building:part"],
                M = h.wallGradientColorEnabled && !w ? h.defaultWallGradientColor || H : "#ffffff",
                T = F.colorFromString(M),
                S = {
                    r: b.r * T.r,
                    g: b.g * T.g,
                    b: b.b * T.b,
                    a: b.a * T.a
                },
                C = g + d;
            c > 0 && (C += c);
            var E = {
                maxHeightAboveSeaLevel: Math.max(0, C) * _ + i.z,
                area: m(t),
                wall: {
                    extrude: r(t, f),
                    color: [S, b],
                    height: d * _,
                    minHeight: g * _ + i.z,
                    smooth: v || a(t),
                    minHeightForced: !1
                },
                roof: {
                    shape: f,
                    color: x,
                    minHeight: (g + d) * _ + i.z,
                    height: p ? -1 : c * _,
                    smooth: v,
                    dirInDegree: s(t),
                    orientation: l(t),
                    extendsRidge: O.contains(Z, f),
                    noExtendedCentralPoint: O.contains(Y, f)
                }
            };
            return y(E, t, _, b), h.extendWallHeight && E.wall.minHeight == i.z && E.wall.extrude && (E.wall.minHeightForced = !0, E.wall.height += h.extendWallHeight, E.wall.minHeight -= h.extendWallHeight), E
        }

        function A(e) {
            return null != e && !O.isNaN(+e)
        }

        function R(e) {
            var t;
            return e["roof:height"] || e["building:roof:height"] ? t = _(e["roof:height"] || e["building:roof:height"]) : A(e["roof:levels"]) || A(e["building:roof:levels"]) ? t = (+e["roof:levels"] || +e["building:roof:levels"]) * U : e["3dr:height1"] && (t = _(e["3dr:height1"])), t
        }

        function D(e) {
            var t = 0,
                i = !1;
            return A(e["building:levels"]) ? (t = +e["building:levels"] * U, A(e["building:min_level"]) && (t -= +e["building:min_level"] * U), A(e["building:levels:underground"]) && (t += +e["building:levels:underground"] * U), 0 != t || e.height || (i = !0)) : A(e.levels) ? (t = +e.levels * U, A(e["building:min_level"]) && (t -= +e["building:min_level"] * U)) : A(e.max_level) && A(e.min_level) ? t = (+e.max_level - +e.min_level + 1) * U : A(e.level) ? t = U : A(e["building:levels:underground"]) && (t = +e["building:levels:underground"] * U), {
                wallHeight: t,
                fullRoofBuilding: i
            }
        }

        function I(e) {
            var t = 0;
            if (g(e.min_height)) t = _(e.min_height);
            else if (g(e["building:min_height"])) t = _(e["building:min_height"]);
            else if (A(e["building:min_level"])) t = +e["building:min_level"] * U;
            else if (A(e.level)) t = +e.level * U;
            else if (A(e["building:levels:underground"])) t = +e["building:levels:underground"] * -U;
            else {
                if (!A(e.min_level)) return null;
                t = +e.min_level * U
            }
            return t
        }
        var O = e("underscore"),
            N = e("engine/tools"),
            B = N.MathHelper,
            F = e("./ColorReader"),
            z = e("./BuildingTypes");
        t.exports = {
            readBuildingGenInfo: P
        };
        var H = "#CCCCCC",
            U = 3,
            W = ["tower", "skyscraper"],
            G = ["roof", "canopy", "cabin", "shed", "hut", "garage", "garages"],
            j = ["apartments", "dormitory", "hospital", "hotel", "commercial", "industrial", "warehouse", "church", "cathedral", "civic", "public", "barn", "hangar"],
            q = ["flat", "skillion", "gabled", "half_hipped", "hipped", "hyperboloid_small", "hyperboloid_big", "pyramidal", "gambrel", "mansard", "dome", "onion", "round", "sawtooth", "gabled_row", "saltbox", "double_saltbox", "triple_saltbox", "quadruple_saltbox"],
            V = ["cylinder"],
            Z = ["gabled", "gambrel", "round", "half_hipped", "saltbox", "double_saltbox"],
            Y = ["half_hipped"],
            K = ["hyperboloid_small", "hyperboloid_big"],
            X = ["hyperboloid_small", "hyperboloid_big", "dome", "round"],
            $ = ["cylinder", "column"],
            Q = {
                skillion: 2,
                gabled: 3,
                half_hipped: 4,
                hipped: 3,
                pyramidal: 4,
                sawtooth: 4,
                saltbox: 4,
                double_saltbox: 4,
                triple_saltbox: 4,
                quadruple_saltbox: 4
            }
    }, {
        "./BuildingTypes": 323,
        "./ColorReader": 324,
        "engine/tools": 97,
        underscore: 207
    }],
    323: [function(e, t, i) {
        "use strict";

        function n(e) {
            return "greenhouse" == e.building || "greenhouse_horticulture" == e.landuse
        }
        t.exports = {
            isGreenHouse: n
        }
    }, {}],
    324: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n;
            if (i)
                if (u.isFunction(i)) try {
                    n = i(e, t)
                } catch (r) {
                    console.warn("Exception in color function", r)
                } else n = i;
            return n || (n = t), n && u.isString(n) && (n = a(n)), n
        }

        function r(e) {
            var t, i = e["building:facade:colour"] || e["building:facade:color"] || e["building:colour"] || e["building:color"],
                n = null;
            i && (n = a(i));
            var r = e["building:facade:material"] || e["building:material"] || e.material;
            return !r && p.isGreenHouse(e) && (r = "glass"), null == n && r && (n = a(r), null == n && console.warn('No color for material "%s"', r, e)), null != n && (t = n), t && (t.a = v[r] || 1), t
        }

        function o(e) {
            var t, i = null,
                n = e["roof:colour"] || e["roof:color"] || e["building:roof:colour"] || e["building:roof:color"];
            n && (i = a(n));
            var r = e["roof:material"] || e["building:roof:material"];
            return !r && p.isGreenHouse(e) && (r = "glass"), null == i && r && (i = a(r), null == i && console.warn('No color for material "%s"', r, e)), null != i && (t = i), t && (t.a = v[r] || 1), t
        }

        function a(e) {
            e = d.trim(e.toLowerCase()).replace(/[_ ]/g, "");
            var t = e.split(";")[0],
                i = t.replace(/s$/, "").split(";")[0],
                n = _[i];
            return f.fromString(n || t)
        }

        function s(e) {
            u.each(e, function(e, t) {
                t = d.trim(t.toLowerCase()).replace(/[_ ]/g, "").replace(/([^s])s$/, "$1"), _[t] = e
            })
        }

        function l(e, t) {
            var i = n(e, r(e), t.wallColor);
            return null == i && (i = a(t.defaultWallColor || m)), i
        }

        function h(e, t) {
            var i = n(e, o(e), t.roofColor);
            return null == i && (i = a(t.defaultRoofColor || g)), i
        }
        var u = e("underscore"),
            d = e("underscore.string"),
            c = e("engine/tools"),
            f = c.Color,
            p = e("./BuildingTypes"),
            m = "#DDDDDD",
            g = "#FFFFFF";
        t.exports = {
            getWallColor: l,
            getRoofColor: h,
            colorFromString: a,
            extendColorMapping: s
        };
        var _ = {
                plaster: "#f2f2f2",
                brick: "#B5653A",
                wood: "#e1b681",
                concrete: "#BCBABB",
                glass: "#CCEBE8",
                stone: "#E8E8E8",
                metal: "#C9D4D3",
                mdf: "#b0a1a4",
                timberframing: "#e1b681",
                asphalt: "#969696",
                rooftile: "#845B3D",
                copper: "#799680",
                slate: "#333E4F",
                tarpaper: "#707175",
                grass: "#A2C25C",
                gravel: "#64635f",
                eternit: "#a9aba6",
                thatch: "#7c6e61",
                plant: "#A2C25C",
                tin: "#7c7c7a",
                cementblock: "#cecbd4",
                marble: "#d5d7e6",
                sandstone: "#c5ad91",
                acsheet: "#d5dad6",
                asbesto: "#d5dfe9",
                zink: "#759796",
                gold: "#FFE205",
                silver: "#C0C0C0",
                bronze: "#CD7F32",
                hdf: "#9a662c",
                roofingfelt: "#323136",
                mirror: "#ffffff",
                plate: "#e89b71",
                steel: "#898989",
                stainlesssteel: "#B0B0B0",
                tile: "#D39F70"
            },
            v = {
                glass: .7,
                gold: .8,
                silver: .8,
                mirror: .01,
                stainless_steel: .8
            }
    }, {
        "./BuildingTypes": 323,
        "engine/tools": 97,
        underscore: 207,
        "underscore.string": 206
    }],
    325: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, o) {
            w = o, M = t;
            var s = n.roof;
            if (r(e, n), i.skeleton && !s.orientation) x.readAndMapToRings(e, t, i.skeleton, n, o);
            else
                for (var d = 0; d < e.length; ++d) {
                    var f = e[d];
                    "skillion" == s.shape ? s.stepHeight ? l(f, s) : h(f, s) : "gabled_row" == s.shape ? a(f, s) : "sawtooth" == s.shape ? a(f, s) : "dome" == s.shape ? c(f, s, 7) : "pyramidal" == s.shape ? (s.smooth |= f.shapePts.length > 10, n.wall.smooth |= s.smooth, u(f, s)) : "onion" == s.shape ? (s.smooth |= f.shapePts.length > 10, n.wall.smooth |= s.smooth, b.setRingHeight(f, s.minHeight)) : "flat" != s.shape ? p(f, s) : s.minHeight && b.setRingHeight(f, s.minHeight)
                }
        }

        function r(e, t) {
            if (t.roof.height <= 0 && "flat" != t.roof.shape) {
                var i, n, r;
                if ("dome" == t.roof.shape) {
                    var o = -(1 / 0);
                    for (i = 0; i < e.length; ++i) n = e[i], o = Math.max(o, d(n, t.roof));
                    r = o, -1 != t.roof.height && (t.wall.height = Math.max(t.wall.height - r, 0)), t.roof.height = r, t.roof.minHeight = t.wall.height + t.wall.minHeight, t.maxHeightAboveSeaLevel = Math.max(0, t.roof.minHeight + t.roof.height)
                } else {
                    for (r = 0, i = 0; i < e.length; ++i) {
                        n = e[i];
                        var a = b.getMinimalOBox(n.shapePts);
                        r = "across" == t.roof.orientation ? Math.max(r, .5 * a.longEdge.length()) : Math.max(r, .5 * a.smallEdge.length())
                    }
                    t.roof.height = r, t.roof.minHeight = t.wall.height + t.wall.minHeight, t.maxHeightAboveSeaLevel = Math.max(0, t.roof.minHeight + t.roof.height)
                }
            }
        }

        function o(e, t) {
            var i = new v(0, -1);
            if (null != t.dirInDegree) {
                var n = _.degToRad(t.dirInDegree);
                i.x = -Math.sin(n), i.y = -Math.cos(n)
            } else {
                var r = b.getMinimalOBox(e.shapePts);
                i.copy("across" == t.orientation ? r.longEdge : r.smallEdge)
            }
            return i.normalize(), i
        }

        function a(e, t) {
            function i(e) {
                return f.distanceToSquared(e.point)
            }

            function n(t, i) {
                e.innerPoints.push(new y(t, i, g))
            }

            function r(e, t) {
                var i = x[e.x + "_" + e.y];
                i || (i = x[e.x + "_" + e.y] = {
                    list: []
                }), i.list.push(t)
            }

            function o(e) {
                function i(e) {
                    return o.distanceToSquared(e)
                }
                for (var n = [], r = 0; r < e.length; ++r) {
                    var o = e[r];
                    o.z = t.minHeight;
                    var a = x[o.x + "_" + o.y];
                    if (n.push(o), a) {
                        a.list = m.sortBy(a.list, i);
                        for (var s = 0; s < a.list.length; ++s) n.push(a.list[s])
                    }
                }
                return n
            }
            var a = b.getMinimalOBox(e.shapePts),
                s = new v(0, -1),
                l = 2 * e.radius;
            if (null != t.dirInDegree) {
                var h = _.degToRad(t.dirInDegree);
                s.x = -Math.sin(h), s.y = -Math.cos(h), s.normalize()
            } else {
                var u = a.longEdge.clone().normalize();
                if ("gabled_row" == t.shape) s.copy(u), l = a.longEdge.length();
                else {
                    var d = a.smallEdge.clone().normalize();
                    s.copy(Math.abs(u.y) > Math.abs(d.y) ? u : d), l = Math.abs(u.y) > Math.abs(d.y) ? a.longEdge.length() : a.smallEdge.length()
                }
            }
            var c = new v(-s.y, s.x);
            c.setLength(e.radius);
            var f = a.center.clone();
            f.addSelf(c), f.x -= .5 * s.x * l, f.y -= .5 * s.y * l;
            var p = a.center.clone();
            p.subSelf(c), p.x -= .5 * s.x * l, p.y -= .5 * s.y * l, e.innerPoints = [];
            var g = t.minHeight,
                x = {},
                w = Math.round(l / t.height);
            w += w % 2 == 1 ? 1 : 0, w *= 2;
            for (var M = 1.999 * l / w, T = 0; w > T; ++T) {
                var S = T % 2 == 0,
                    C = M;
                "sawtooth" == t.shape && (C = S ? .4 * M : 1.6 * M), f.x += s.x * C, f.y += s.y * C, p.x += s.x * C, p.y += s.y * C;
                var E = b.intersectRingWithSegment(e, f, p);
                E = m.sortBy(E, i), g = t.minHeight + S * t.height;
                for (var k = 0; k < E.length - 1; ++k) {
                    var L = E[k],
                        P = L.edge,
                        A = L.point,
                        R = E[k + 1],
                        D = R.point,
                        I = R.edge;
                    A.z = g, r(P[0], A), D.z = g, r(I[0], D);
                    var O = Math.min(P[0].distanceTo(P[1]), I[0].distanceTo(I[1]), A.distanceTo(D) / 8),
                        N = {
                            x: 0,
                            y: 0,
                            sampling: O,
                            addEndPoints: !1
                        };
                    b.sampleLine([A, D], N, n)
                }
            }
            e.shapePts = o(e.shapePts);
            for (var B = [], F = 0; F < e.shapeHolePts; ++F) B.push(o(e.shapeHolePts[F]));
            e.shapeHolePts = B
        }

        function s(e, t, i) {
            return (e.x >= t.x && e.x <= i.x || e.x <= t.x && e.x >= i.x) && (e.y >= t.y && e.y <= i.y || e.y <= t.y && e.y >= i.y)
        }

        function l(e, t) {
            function i(e) {
                return E.distanceToSquared(e.point)
            }

            function n(e) {
                var i = Math.round(e / M);
                return Math.min(t.minHeight + t.height, M * i)
            }

            function r(e) {
                function t(e) {
                    return r.distanceToSquared(e.point)
                }
                for (var i = [], n = 0; n < e.length; ++n) {
                    var r = e[n],
                        o = n == e.length - 1 ? e[0] : e[n + 1];
                    P.sub(o, r), P.setLength(.05), i.push(r);
                    var a = C[r.x + "_" + r.y];
                    if (a) {
                        a.list = m.sortBy(a.list, t);
                        for (var l = 0; l < a.list.length; ++l) {
                            var h = a.list[l];
                            L.copy(h.point), s(L, r, o) && (P.z < 0 && (L.z += M), i.push(L.clone())), L.copy(h.point), L.addSelf(P), s(L, r, o) && (P.z > 0 && (L.z += M), i.push(L.clone()))
                        }
                    }
                }
                return i
            }
            var a, l, h, u, d, c = o(e, t);
            for (a = 0; a < e.shapePts.length; ++a) l = e.shapePts[a], l.dotValue = c.dot(l);
            var f = m.sortBy(e.shapePts, function(e) {
                    return e.dotValue
                }),
                p = f[0].dotValue,
                g = f[f.length - 1].dotValue,
                _ = g - p,
                x = t.stepCount || Math.round(t.height / t.stepHeight),
                w = _ / x,
                M = t.height / x;
            for (a = 0; a < e.shapePts.length; ++a) l = e.shapePts[a], d = (l.dotValue - p) / _, delete l.dotValue, l.z = n(t.minHeight + t.height * d);
            for (h = 0; h < e.shapeHolePts.length; ++h)
                for (u = e.shapeHolePts[h], a = 0; a < u.length; ++a) l = u[a], d = (c.dot(l) - p) / _, l.z = n(t.minHeight + t.height * d);
            var T = new v(-c.y, c.x);
            T.setLength(2 * e.radius);
            var S = f[1],
                C = {},
                E = new v,
                k = new v;
            e.innerPoints = [];
            for (var L = new y, P = new y, A = 0; x >= A; ++A) {
                c.setLength((A + .01) * w);
                var R = t.minHeight + M * A;
                E.add(S, T), k.sub(S, T), E.addSelf(c), k.addSelf(c);
                var D = b.intersectRingWithSegment(e, E, k);
                for (D = m.sortBy(D, i), a = 0; a < D.length; ++a) {
                    var I = D[a];
                    if (l = I.edge[0], I.edge[0].z != I.edge[1].z) {
                        var O = C[l.x + "_" + l.y];
                        if (O || (O = C[l.x + "_" + l.y] = {
                                p: l,
                                list: []
                            }), I.point.z = R, O.list.push(I), a % 2 == 0 && D[a + 1]) {
                            D[a + 1].point.z = R, P.sub(D[a + 1].point, I.point), c.setLength(.05);
                            for (var N = 1 + P.length() / w, B = 1; N > B; ++B) L.copy(I.point), L.x += P.x * B / N, L.y += P.y * B / N, L.z = R, e.innerPoints.push(L.clone()), L.addSelf(c), L.z = R + M, e.innerPoints.push(L.clone())
                        }
                    }
                }
            }
            e.shapePts = r(e.shapePts);
            var F = [];
            for (h = 0; h < e.shapeHolePts.length; ++h) F.push(r(e.shapeHolePts[h]));
            e.shapeHolePts = F
        }

        function h(e, t) {
            var i, n, r, a = o(e, t),
                s = 1 / 0,
                l = -(1 / 0);
            for (i = 0; i < e.shapePts.length; ++i) n = e.shapePts[i], n.dotValue = a.dot(n), s = Math.min(s, n.dotValue), l = Math.max(l, n.dotValue);
            var h = l - s;
            for (i = 0; i < e.shapePts.length; ++i) n = e.shapePts[i], r = (n.dotValue - s) / h, delete n.dotValue, n.z = t.minHeight + t.height * r;
            for (var u = 0; u < e.shapeHolePts.length; ++u) {
                var d = e.shapeHolePts[u];
                for (i = 0; i < d.length; ++i) n = d[i], r = (a.dot(n) - s) / h, n.z = t.minHeight + t.height * r
            }
        }

        function u(e, t) {
            var i, n, r = b.getMinimalOBox(e.shapePts),
                o = r.center.clone();
            o.z = t.minHeight + t.height;
            var a = -(1 / 0);
            for (i = 0; i < e.shapePts.length; ++i) n = e.shapePts[i], a = Math.max(a, n.distanceTo(o)), n.z = t.minHeight;
            for (var s = 0; s < e.shapeHolePts.length; ++s) {
                var l = e.shapeHolePts[s];
                for (i = 0; i < l.length; ++i) {
                    n = l[i];
                    var h = n.distanceTo(o);
                    n.z = t.minHeight + t.height * (h / a)
                }
            }
            b.isPointInsideShape(o, e.shapeHolePts) || (e.innerPoints = [o])
        }

        function d(e, t) {
            var i = b.getMinimalOBox(e.shapePts),
                n = i.center.clone(),
                r = t.minHeight,
                o = t.height;
            n.z = r + o;
            for (var a = -(1 / 0), s = 0; s < e.shapePts.length; ++s) {
                var l = e.shapePts[s];
                l.z = r, a = Math.max(a, l.distanceTo(n))
            }
            return a
        }

        function c(e, t, i) {
            var n, r, o = b.getMinimalOBox(e.shapePts),
                a = o.center.clone(),
                s = t.minHeight,
                l = t.height;
            a.z = s + l;
            var h = d(e, t);
            0 == l && (l = h, s = Math.max(0, s - l), a.z = s + l);
            for (var u = 0; u < e.shapeHolePts.length; ++u) {
                var c = e.shapeHolePts[u];
                for (n = 0; n < c.length; ++n) {
                    r = c[n];
                    var f = Math.acos(a.distanceTo(r) / h);
                    r.z = s + l * Math.sin(f)
                }
            }
            e.innerPoints = [];
            for (var p = 1 / i, m = new y, g = new y, _ = 1; i > _; ++_) {
                var v = .5 * Math.PI * _ * p,
                    x = Math.sin(v),
                    w = 1 - Math.cos(v);
                for (n = 0; n < e.shapePts.length; ++n) r = e.shapePts[n], m.sub(a, r), g.copy(r), g.x += m.x * w, g.y += m.y * w, g.z += m.z * x, b.isPointInsideShape(g, e.shapeHolePts) || e.innerPoints.push(g.clone())
            }
            b.isPointInsideShape(a, e.shapeHolePts) || e.innerPoints.push(a)
        }

        function f(e, t) {
            var i = [],
                n = "across" == t.orientation ? e.smallEdge.clone() : e.longEdge.clone(),
                r = "across" == t.orientation ? e.longEdge.clone() : e.smallEdge.clone(),
                o = n.clone().multiplyScalar(.5),
                a = r.clone().multiplyScalar(.5),
                s = e.center.clone();
            s.z = t.minHeight + t.height;
            var l = e.center.clone();
            l.z = t.minHeight + t.height;
            var h = o;
            t.extendsRidge || (h = n.clone().multiplyScalar(.3)), s.addSelf(h), l.subSelf(h);
            var u = e.center.clone().addSelf(o);
            u.addSelf(a), u.z = t.minHeight;
            var d = e.center.clone().subSelf(o);
            d.addSelf(a), d.z = t.minHeight;
            var c, f = b.buildBendedEdge(u, s, t.shape),
                p = b.buildBendedEdge(d, l, t.shape);
            for (c = 0; c < f.length; ++c) i.push([f[c], p[c]]);
            for (u.add(e.center, o), u.subSelf(a), d.sub(e.center, o), d.subSelf(a), f = b.buildBendedEdge(u, s, t.shape), p = b.buildBendedEdge(d, l, t.shape), c = 0; c < f.length; ++c) i.push([f[c], p[c]]);
            if (t.noExtendedCentralPoint && (h = n.clone().multiplyScalar(.1), s.subSelf(h), l.addSelf(h)), i.push([s, l]), T)
                for (var m = 0; m < i.length; ++m) w.debugRenderLine(i[m], M.x, M.y, 0, 16711680);
            return i
        }

        function p(e, t) {
            function i(i) {
                for (var r = 0; r < i.length;) {
                    var o = 0 != r ? i[r - 1] : null,
                        a = i[r],
                        s = o ? o.point.distanceTo(a.point) : 1;
                    if (.1 > s) i.splice(r, 1);
                    else {
                        if (a.point.z = A.z, t.extendsRidge && a.edge) {
                            var l = a.edge[0];
                            l.pointToPush ? l.pointToPush.push(a.point) : l.pointToPush = [a.point]
                        } else a.useAsInner && e.innerPoints.push(a.point);
                        if (r % 2 == 1) {
                            var h = Math.min(5, s / 3),
                                u = {
                                    x: 0,
                                    y: 0,
                                    sampling: h,
                                    addEndPoints: !1
                                };
                            b.sampleLine([o.point, a.point], u, n), T && w.debugRenderLine([o.point, a.point], M.x, M.y, 0, 65535)
                        }++r
                    }
                }
            }

            function n(t, i) {
                e.innerPoints.push(new y(t, i, A.z))
            }

            function r(e) {
                for (var t = 0; t < x.length && x[t].pos01 < e;) ++t;
                if (0 == t) return x[0].z;
                if (t == x.length) return x[x.length - 1].z;
                var i = x[t - 1],
                    n = x[t];
                return i.z + (n.z - i.z) * (e - i.pos01) / (n.pos01 - i.pos01)
            }

            function o(e) {
                for (var t = 0; t < e.length; ++t) {
                    var i = e[t];
                    p.sub(u.center, i);
                    var n = Math.abs(p.dot(E)),
                        o = 1 - n / C;
                    i.z = r(o)
                }
            }

            function a(e) {
                for (var t = 0; t < e.length; ++t) {
                    var i = e[t];
                    if (i.pointToPush) {
                        var n = t == e.length - 1 ? e[0] : e[t + 1],
                            r = m.partial(l, i);
                        i.pointToPush.sort(r), T && w.debugRenderLine(i.pointToPush, M.x, M.y, -.25, 16776960);
                        for (var o = i.pointToPush.pop(); o;) s(o, i, n) && e.splice(++t, 0, o), o = i.pointToPush.pop()
                    }
                }
            }

            function l(e, t, i) {
                return i.distanceToSquared(e) - t.distanceToSquared(e)
            }

            function h(e, t, i) {
                return t.point.distanceToSquared(e) - i.point.distanceToSquared(e)
            }
            var u = b.getMinimalOBox(e.shapePts),
                d = f(u, t),
                c = "across" == t.orientation ? u.longEdge.clone() : u.smallEdge.clone();
            c.multiplyScalar(.5);
            var p = new v,
                g = u.center.clone();
            g.subSelf(c), g.z = t.minHeight;
            var _ = u.center.clone();
            _.z = t.minHeight + t.height;
            var x = b.buildBendedEdge(g, _, t.shape);
            g.pos01 = 0, _.pos01 = 1, x.unshift(g), x.push(_);
            var S, C = c.length(),
                E = c.clone().normalize();
            for (t.extendsRidge ? o(e.shapePts) : b.setPtsListHeight(e.shapePts, t.minHeight), S = 0; S < e.shapeHolePts.length; ++S) o(e.shapeHolePts[S]);
            e.innerPoints = [], T && w.debugRenderLine(e.shapePts, M.x, M.y, -.1, 255);
            for (var k = [e.shapePts], L = 0; L < d.length; ++L) {
                var P = d[L],
                    A = P[0],
                    R = P[1],
                    D = b.intersectRingWithSegment(e, A, R);
                if (!t.extendsRidge || t.noExtendedCentralPoint) {
                    var I = b.isPointInsideShape(k, A),
                        O = b.isPointInsideShape(k, A);
                    (I || O) && D.push({
                        point: A,
                        useAsInner: I
                    }, {
                        point: R,
                        useAsInner: O
                    })
                }
                var N = m.partial(h, A);
                D.sort(N), i(D)
            }
            for (a(e.shapePts), S = 0; S < e.shapeHolePts.length; ++S) a(e.shapeHolePts[S]);
            T && w.debugRenderLine(e.shapePts, M.x, M.y, 0, 16711935)
        }
        var m = e("underscore"),
            g = e("engine/tools"),
            _ = g.MathHelper,
            v = g.Vector2,
            y = g.Vector3,
            b = g.ShapeUtils,
            x = e("./StraightSkeleton"),
            w = null,
            M = null,
            T = !1;
        t.exports = {
            updateRingsForRoof: n
        }
    }, {
        "./StraightSkeleton": 327,
        "engine/tools": 97,
        underscore: 207
    }],
    326: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (t.length) {
                var i = t[0],
                    r = t[1];
                if ("number" == typeof i && "number" == typeof r) e.left = Math.min(e.left, i), e.bottom = Math.min(e.bottom, r), e.right = Math.max(e.right, i), e.top = Math.max(e.top, r);
                else
                    for (var o = 0; o < t.length; ++o) n(e, t[o])
            }
        }

        function r(e) {
            var t = {
                left: +(1 / 0),
                bottom: +(1 / 0),
                right: -(1 / 0),
                top: -(1 / 0)
            };
            return n(t, e), t
        }

        function o(e) {
            if (!e._bounds) {
                for (var t = [e], i = {
                        left: +(1 / 0),
                        bottom: +(1 / 0),
                        right: -(1 / 0),
                        top: -(1 / 0)
                    }; t.length;) e = t.pop(), "GeometryCollection" == e.type ? t.push.apply(t, e.geometries) : n(i, e.coordinates);
                e._bounds = i
            }
            return e._bounds
        }

        function a(e) {
            var t = e.right - e.left,
                i = e.top - e.bottom;
            return .5 * Math.sqrt(Math.pow(t, 2) + Math.pow(i, 2))
        }

        function s(e, t, i, n) {
            if (i.length) {
                var r, o, s, l, h, u, d = t.x,
                    c = t.y,
                    p = {
                        left: +(1 / 0),
                        bottom: +(1 / 0),
                        right: -(1 / 0),
                        top: -(1 / 0)
                    },
                    m = [],
                    g = [];
                for (s = i[0], o = s.length, r = 0; o > r; ++r) l = s[r], h = l[0], u = l[1], p.left = Math.min(p.left, h), p.right = Math.max(p.right, h), p.bottom = Math.min(p.bottom, u), p.top = Math.max(p.top, u), m[m.length] = new f(h - d, u - c, 0);
                if (n)
                    for (var _ = 1; _ < i.length; ++_) {
                        s = i[_];
                        var v = [];
                        for (o = s.length, r = 0; o > r; ++r) l = s[r], h = l[0], u = l[1], p.left = Math.min(p.left, h), p.right = Math.max(p.right, h), p.bottom = Math.min(p.bottom, u), p.top = Math.max(p.top, u), v[v.length] = new f(h - d, u - c, 0);
                        g.push(v)
                    }
                e.push({
                    bounds: p,
                    radius: a(p),
                    shapePts: m,
                    shapeHolePts: g
                })
            }
        }

        function l(e, t, i) {
            var n = t.x,
                o = t.y,
                s = r(i),
                l = {
                    bounds: s,
                    radius: a(s),
                    shapePts: d.map(i, function(e) {
                        return new f(e[0] - n, e[1] - o, 0)
                    }),
                    shapeHolePts: []
                };
            e.push(l)
        }

        function h(e, t, i, n) {
            if ("Polygon" == i.type) s(e, t, i.coordinates, n);
            else if ("MultiPolygon" == i.type)
                for (var r = 0; r < i.coordinates.length; ++r) s(e, t, i.coordinates[r], n);
            else if ("LineString" == i.type) l(e, t, i.coordinates);
            else if ("MultiLineString" == i.type)
                for (var o = 0; o < i.coordinates.length; ++o) l(e, t, i.coordinates[o]);
            else if ("GeometryCollection" == i.type)
                for (var a = 0; a < i.geometries.length; ++a) h(e, t, i.geometries[a], n)
        }

        function u(e, t, i) {
            var n = {
                rings: []
            };
            if (e) {
                var r;
                if (t || (n.bounds = r = o(e), n.position = t = new f(.5 * (r.left + r.right), .5 * (r.bottom + r.top), 0)), h(n.rings, t, e, i), !n.bounds) {
                    n.bounds = r = {
                        left: +(1 / 0),
                        bottom: +(1 / 0),
                        right: -(1 / 0),
                        top: -(1 / 0)
                    };
                    var a, s = n.rings.length;
                    for (a = 0; s > a; ++a) {
                        var l = n.rings[a];
                        r.left = Math.min(r.left, l.bounds.left), r.bottom = Math.min(r.bottom, l.bounds.bottom), r.right = Math.max(r.right, l.bounds.right), r.top = Math.max(r.top, l.bounds.top)
                    }
                }
                n.position || (n.position = new f(.5 * (r.left + r.right), .5 * (r.bottom + r.top), 0))
            } else n.position = new f;
            return n
        }
        var d = e("underscore"),
            c = e("engine/tools"),
            f = c.Vector3,
            p = e("wellknown");
        t.exports = {
            getGeometryBounds: o,
            parseWKT: p,
            parseShape: u
        }
    }, {
        "engine/tools": 97,
        underscore: 207,
        wellknown: 213
    }],
    327: [function(e, t, i) {
        "use strict";

        function n(e) {
            return e.x + "_" + e.y
        }

        function r(e, t, i, n, r) {
            if (T = new M, w && r) {
                for (var o = [], s = 0; s < i.coordinates.length; s++) {
                    var l = i.coordinates[s],
                        u = new y(l[0][0] - t.x, l[0][1] - t.y, 0),
                        d = new y(l[1][0] - t.x, l[1][1] - t.y, 0);
                    o.push([u, d])
                }
                for (s = 0; s < o.length; s++) r.debugRenderLine(o[s], t.x, t.y, 0, 16711680)
            }
            for (var c = 0; c < e.length; ++c) b.setRingHeight(e[c], n.roof.minHeight);
            p(e, t, i, n), n.roof.extendsRidge && a(n), h(e, n), T = null
        }

        function o(e, t, i) {
            return (e.x - t.x) * (i.y - t.y) - (i.x - t.x) * (e.y - t.y)
        }

        function a(e) {
            for (var t = [], i = 0; i < T.allPoints.length; ++i) {
                var n = T.allPoints[i];
                n.outlineStruct || 1 != n.innerEdges.length || 2 != n.outerEdges.length || (n.isExtrem = !0, t.push(n))
            }
            t = g.sortBy(t, function(e) {
                for (var t = 1 / 0, i = 0; i < e.outerEdges.length; ++i) {
                    var n = e.outerEdges[i];
                    n && (t = Math.min(t, n[0].outlineStruct.idx))
                }
                return t
            });
            for (var r = new v, a = new v; t.length;) {
                var s = t.pop(),
                    l = s.outerEdges[0][0],
                    h = s.outerEdges[1][0];
                if (l.outlineStruct.ptsList === h.outlineStruct.ptsList) {
                    if (r.sub(s.outerEdges[0][1], l).normalize(), a.sub(s.outerEdges[1][1], h).normalize(), Math.abs(r.dot(a)) < .1) {
                        var u = l.outlineStruct.ptsList,
                            d = l.outlineStruct.idx,
                            c = h.outlineStruct.idx;
                        d > c && (l = h, d = c, h = s.outerEdges[0][0], c = h.outlineStruct.idx);
                        var f = l.clone().addSelf(h).multiplyScalar(.5);
                        f.z = s.z;
                        var p = b.buildBendedEdge(l, f, e.roof.shape);
                        e.roof.noExtendedCentralPoint || p.push(f);
                        var m = b.buildBendedEdge(h, f, e.roof.shape);
                        m.reverse(), p = p.concat(m);
                        var _ = o(l, s, h);
                        if (s.x = f.x, s.y = f.y, 0 > _) {
                            var y = g.rest(u, c);
                            for (u.splice(d + 1); p.length > 0;) u.push(p.shift());
                            for (; y.length > 0;) u.push(y.shift())
                        } else {
                            for (; h.distanceToSquared(u[u.length - 1]) > .1;) u.pop();
                            for (; p.length > 0;) u.push(p.pop())
                        }
                        var x = T.borderEdges.indexOf(s.outerEdges[0]);
                        x > -1 && T.borderEdges.splice(x, 1), x = T.borderEdges.indexOf(s.outerEdges[1]), x > -1 && T.borderEdges.splice(x, 1)
                    }
                } else console.warn("outline struct are differents", l, h)
            }
        }

        function s(e) {
            var t, i, n, r = 0,
                o = null;
            for (t = 0; t < e[0].outerEdges.length; ++t) n = e[0].outerEdges[t], i = n[0].distanceTo(n[1]), i > r && (r = i, o = n);
            for (t = 0; t < e[1].outerEdges.length; ++t) n = e[1].outerEdges[t], i = n[0].distanceTo(n[1]), i > r && (r = i, o = n);
            if (r > 0) {
                var a = new v;
                a.sub(o[0], o[1]);
                var s = new v(e[1].y - e[0].y, e[0].x - e[1].x);
                s.normalize();
                var l = 1.2 * Math.abs(a.dot(s));
                return s.setLength(l), s
            }
            return null
        }

        function l(e, t) {
            for (var i = 0; i < t.length; ++i) {
                var n = t[i];
                if (b.isPointInsideShape([n.shapePts], e)) return n
            }
            return null
        }

        function h(e, t) {
            for (var i = 0; i < T.allPoints.length; ++i) {
                var n = T.allPoints[i];
                if (null == n.outlineStruct) {
                    var r = l(n, e);
                    r && (c(n.outerEdges, r, t), f(n.innerEdges, r, t))
                }
            }
        }

        function u(e, t) {
            e.alreadyPushed || (e.alreadyPushed = !0, t.innerPoints || (t.innerPoints = []), t.innerPoints.push(e))
        }

        function d(e, t) {
            for (var i = 0; i < e.length; ++i) u(e[i], t)
        }

        function c(e, t, i) {
            for (var n = 0; n < e.length; ++n) {
                var r = e[n];
                if (r[1].isExtrem && i.roof.extendsRidge) return;
                var o = b.buildBendedEdge(r[0], r[1], i.roof.shape);
                o.push(r[1]), d(o, t)
            }
        }

        function f(e, t, i) {
            for (var n, r, o = new y, a = new y, l = new v, h = new v, c = "gabled" == i.roof.shape, f = i.roof.height / 2, p = 0; p < e.length; ++p) {
                var m = e[p];
                if (!m.alreadyPushed) {
                    m.alreadyPushed = !0, h.sub(m[1], m[0]);
                    var g = h.length();
                    if (!(g < T.distanceToleranceSq || f > g)) {
                        var _, x = [],
                            w = 7;
                        if (c) w = Math.max(w, Math.floor(g / f));
                        else if (_ = s(m), !_) continue;
                        for (r = 1; w > r; ++r) n = new y, n.x = m[0].x + h.x * r / w, n.y = m[0].y + h.y * r / w, n.z = m[0].z, x.push(n.clone());
                        h.normalize();
                        for (var M = 0; M < x.length; ++M) {
                            var S = x[M];
                            if (c) u(S, t);
                            else {
                                o.sub(S, _), a.add(S, _);
                                var C = b.intersectRingWithSegment(t, o, a);
                                if (C.length > 2) return;
                                for (r = 0; r < C.length; ++r) {
                                    var E = C[r];
                                    l.sub(E.edge[0], E.edge[1]).normalize();
                                    var k = Math.abs(l.dot(h));
                                    if (!(.9 > k)) {
                                        E.point.z = i.roof.minHeight;
                                        var L = b.buildBendedEdge(E.point, S, i.roof.shape);
                                        L.push(S), d(L, t)
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        function p(e, t, i, r) {
            i = g.isString(i) ? x.parseWKT(i) : i;
            var o, a, s, l, h = x.parseShape(i, t, !0),
                u = {};
            for (s = 0; s < e.length; ++s) {
                l = e[s];
                var d = 0;
                for (o = 0; o < l.shapePts.length; ++o) a = l.shapePts[o], u[n(a)] = {
                    ring: l,
                    ptsList: l.shapePts,
                    idx: d++
                };
                for (var c = 0; c < l.shapeHolePts.length; ++c) {
                    var f = l.shapeHolePts[c];
                    for (d = 0, o = 0; o < f.length; ++o) a = f[o], u[n(a)] = {
                        ring: l,
                        ptsList: f,
                        idx: d++
                    }
                }
            }
            h.rings.length > 5 && (T.distanceToleranceSq = 2);
            var p = function(e) {
                    for (var t = new v(e.x, e.y), i = 0; i < T.allPoints.length; ++i) {
                        var o = T.allPoints[i];
                        if (!o.outlineStruct && t.distanceToSquared(o) < T.distanceToleranceSq) return o
                    }
                    var a = new y(e.x, e.y, 0),
                        s = u[n(a)];
                    return s ? (a.outlineStruct = s, a.z = r.roof.minHeight) : a.z = r.roof.minHeight + r.roof.height, a.innerEdges = [], a.outerEdges = [], T.allPoints.push(a), a
                },
                _ = function(e, t) {
                    for (var i = 0; i < e.length; ++i)
                        if (t[0] === e[i][0] && t[1] === e[i][1] || t[1] === e[i][0] && t[0] === e[i][1]) return i;
                    return -1
                };
            for (s = 0; s < h.rings.length; ++s) {
                l = h.rings[s];
                var b = p(l.shapePts[0]),
                    w = p(l.shapePts[1]);
                if (b != w) {
                    var M = [b, w];
                    b.outlineStruct || w.outlineStruct ? (w.outlineStruct && M.reverse(), -1 == _(T.borderEdges, M) && (T.borderEdges.push(M), b.outerEdges.push(M), w.outerEdges.push(M))) : -1 == _(T.innerEdges, M) && (b.innerEdges.push(M), w.innerEdges.push(M), T.innerEdges.push(M))
                }
            }
            h.rings.length > 5 && m()
        }

        function m() {
            for (var e, t, i = new v, n = new v, r = 0; r < T.allPoints.length; ++r)
                if (t = T.allPoints[r], t.innerEdges.length > 1)
                    for (e = 0; e < t.innerEdges.length - 1;) {
                        var o = !1,
                            a = t.innerEdges[e];
                        a[1] === t && a.reverse(), i.sub(a[0], a[1]);
                        var s = i.length();
                        i.normalize();
                        for (var l = e + 1; !o && l < t.innerEdges.length; ++l) {
                            var h = t.innerEdges[l];
                            h[1] === t && h.reverse(), n.sub(h[0], h[1]);
                            var u = n.length();
                            n.normalize(), n.dot(i) > .9 && (s > u ? (t.innerEdges.splice(e, 1), a[0] = h[1], h[1].innerEdges.push(a)) : (t.innerEdges.splice(l, 1), h[0] = a[1], a[1].innerEdges.push(h)), o = !0)
                        }
                        o || ++e
                    }
            for (e = 0; e < T.allPoints.length;)
                if (t = T.allPoints[e], 0 == t.outerEdges.length && 1 == t.innerEdges.length) {
                    var d = t.innerEdges[0],
                        c = d[0] == t ? d[1] : d[0],
                        f = T.innerEdges.indexOf(d);
                    T.innerEdges.splice(f, 1), f = c.innerEdges.indexOf(d), c.innerEdges.splice(f, 1), T.allPoints.splice(e, 1)
                } else ++e;
            for (var p = function(e) {
                    var t = new v,
                        i = new v,
                        n = e[1];
                    t.sub(e[1], e[0]), t.normalize();
                    for (var r = 0; r < n.innerEdges.length; ++r) {
                        var o = n.innerEdges[r];
                        if (o[0] === n && o.reverse(), i.sub(o[1], o[0]).normalize(), t.dot(i) > .9) {
                            var a = n.outerEdges.indexOf(e);
                            return n.outerEdges.splice(a, 1), e[1] = o[0], o[0].outerEdges.push(e), !0
                        }
                    }
                    return !1
                }, m = 0; m < T.borderEdges.length; ++m) {
                var g = T.borderEdges[m];
                e = 0;
                for (var _ = p(g); _ && e++ < 2;) _ = p(g)
            }
        }
        var g = e("underscore"),
            _ = e("engine/tools"),
            v = _.Vector2,
            y = _.Vector3,
            b = _.ShapeUtils,
            x = e("./ShapeParser"),
            w = !1,
            M = function() {
                this.allPoints = [], this.innerEdges = [], this.borderEdges = [], this.distanceToleranceSq = .01
            },
            T = null;
        t.exports = {
            readAndMapToRings: r
        }
    }, {
        "./ShapeParser": 326,
        "engine/tools": 97,
        underscore: 207
    }],
    328: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.renderer = e, this.cameraManager = t, this._loopHandler = o.bind(this.loop, this)
        }

        function r(e) {
            var t = e.camPos.clone().subSelf(e.camTarget),
                i = s.convertVectorToSpherical(t);
            e.r = i.r, e.theta = i.theta, e.phi = i.phi
        }
        var o = e("underscore"),
            a = e("jquery"),
            s = e("./CameraHelper"),
            l = e("engine/src/math/Vector3");
        t.exports = n, n.prototype.pause = function(e) {
            this._isPaused = e
        }, n.prototype.stop = function(e) {
            if (this.renderer.getRenderEngine().removeListener("compute", this._loopHandler), this.renderer.setWorkOnMove(!1), this._preloadTiles = !1, e || this.forceLastPointOnAbort) {
                if (this.renderer.getTileManager().setTarget(), this.setLayersTarget(), this.keys && this.keys.length) {
                    var t = this.keys[this.keys.length - 1];
                    this.cameraManager.setTargetAndPosition(t.camTarget, t.camPos)
                }
                this.cameraManager.cameraUpdated(this.onEndReachIdleEvent), this.renderer.forceRender(), this.forceLastPointOnAbort = null, this.keepKeysOnEnd || (this.keys = null)
            } else this.renderer.getTileManager().setTarget(), this.setLayersTarget();
            var i = this.onStopCbk,
                n = this.onEndReachedCbk;
            this.onAnimationUpdatedCbk = null, this._mustUpdate2d3dOnStop = !1, this.onEndReachedCbk = null, this.onStopCbk = null, this.keepKeysOnEnd || (this.keys = null);
            var r = this.onAbortCbk;
            this.onAbortCbk = null, !e && r ? r() : e && n && n(), i && i(e)
        }, n.prototype.mustUpdate2d3dOnStop = function() {
            return this._mustUpdate2d3dOnStop
        }, n.prototype.hasAnimation = function() {
            return null != this.keys
        }, n.prototype.loadAnimation = function(e) {
            return !e.posAndTargetList || e.posAndTargetList.length < 2 ? void console.warn("Camera animation ignored (less than 2 keys)") : (this.keys = e.posAndTargetList, this.spline = e.spline || !1, this.keepKeysOnEnd = e.keepKeysOnEnd || !1, this.spline && (this.keys = this.generateSplinedKeys(this.keys)), void this.computeAnimKeys(e))
        }, n.prototype.start = function(e) {
            if (this.pause(!1), this.stop(!this.hasAnimation()), !this.keys && (!e.posAndTargetList || e.posAndTargetList.length < 2)) return void console.warn("Camera animation ignored (less than 2 keys)");
            e.posAndTargetList && this.loadAnimation(e), this._mustUpdate2d3dOnStop = e.mustUpdate2d3dOnStop, this._preloadTiles = e.preloadTiles, this._dontPreLoadLayersOnAnimation = !1, null != e.dontPreLoadLayersOnAnimation && (this._dontPreLoadLayersOnAnimation = e.dontPreLoadLayersOnAnimation), this.easing = e.easing, this.forceLastPointOnAbort = e.forceLastPointOnAbort || !1, this.onStopCbk = e.onStopCbk, this.onAbortCbk = e.onAbortCbk, this.onEndReachedCbk = e.onEndReachedCbk, this.onEndReachIdleEvent = e.onEndReachIdleEvent, this.onAnimationUpdatedCbk = e.onAnimationUpdatedCbk, this.currentTime = e.startTime || 0, this.currentKeyIdx = 0, this.repeat = e.repeat || !1, this.renderer.getRenderEngine().on("compute", this._loopHandler), this.renderer.setWorkOnMove(e.enableWorkOnMove), this._preloadTiles && (this.renderer.getTileManager().setTarget(this.keys[this.currentKeyIdx + 1]), this.setLayersTarget(this.keys[this.keys.length - 1]));
            var t = this.keys[0].date;
            t && this.renderer.map.setDate(new Date(t)), this.renderer.forceRender()
        }, n.prototype.setLayersTarget = function(e) {
            var t = this.renderer.map._layersByType.buildings,
                i = !Boolean(this._dontPreLoadLayersOnAnimation);
            o.each(t, function(t) {
                t.setTarget && t.setTarget(e, i)
            }), t = this.renderer.map._layersByType.details, o.each(t, function(t) {
                t.setTarget && t.setTarget(e, i)
            }), t = this.renderer.map._layersByType.pois, o.each(t, function(t) {
                t.setTarget && t.setTarget(e, i)
            })
        }, n.prototype.getCameraAtAnimationPosition = function(e) {
            if (this.keys && this.keys.length) {
                e %= 1;
                for (var t = 0; this.keys[t + 1].timeStamp <= e && t + 1 < this.keys.length;) t++;
                var i = this.keys[t],
                    n = this.keys[t + 1];
                return this._getCameraTargetAndPosForKeys(i, n, e)
            }
            return null
        }, n.prototype.setAnimationPosition = function(e) {
            if (this.keys && this.keys.length) {
                for (this.currentTime = e % 1, this.currentKeyIdx = 0; this.keys[this.currentKeyIdx + 1].timeStamp <= this.currentTime && this.currentKeyIdx + 1 < this.keys.length;) this.currentKeyIdx++;
                this._update()
            }
        }, n.prototype.loop = function(e) {
            this.keys && this.keys.length && !this._isPaused && (this.currentTime += e.dt / this.durationInMS, this._update(), this.onAnimationUpdatedCbk && this.onAnimationUpdatedCbk(this.currentTime))
        }, n.prototype._update = function() {
            if (this.keys && this.keys.length) {
                this.currentKeyIdx == this.keys.length - 1 && this.repeat && (this.currentTime -= this.keys[this.keys.length - 1].timeStamp, this.currentKeyIdx = 0);
                for (var e = this.keys[this.currentKeyIdx], t = this.currentKeyIdx == this.keys.length - 1 ? null : this.keys[this.currentKeyIdx + 1]; t && this.currentTime > t.timeStamp;) this.currentKeyIdx++, t = this.currentKeyIdx == this.keys.length - 1 ? null : this.keys[this.currentKeyIdx + 1], !t && this.repeat && (this.currentTime %= 1, this.currentKeyIdx = -1, t = this.keys[0]);
                if (t) {
                    this._preloadTiles && this.renderer.getTileManager().setTarget(t), e = this.keys[this.currentKeyIdx];
                    var i = this._getDateForKeys(e, t, this.currentTime);
                    i && this.renderer.map.setDate(new Date(i));
                    var n = this._getCameraTargetAndPosForKeys(e, t, this.currentTime),
                        r = n.camPos,
                        o = n.camTarget,
                        a = 1e-4,
                        s = Math.abs(this.cameraManager.getTarget().distanceTo(o)) > a || Math.abs(this.cameraManager.getPosition().distanceTo(r)) > a;
                    this.cameraManager.setTargetAndPosition(o, r), s && this.cameraManager.cameraUpdated(this.onEndReachIdleEvent), this.renderer.forceRender()
                } else this.stop(!0);
                this.renderer.forceRender()
            } else this.stop(!0)
        }, n.prototype._getDateForKeys = function(e, t, i) {
            var n = i - e.timeStamp,
                r = t.timeStamp - e.timeStamp,
                o = n / r,
                s = a.easing[e.easing || this.easing || "linear"],
                l = null,
                h = 1e-13;
            if (t.date && e.date) {
                var u = t.date.valueOf() - e.date.valueOf(),
                    d = u || (0 > u ? -h : h);
                l = s(o, n, e.date.valueOf(), d, r)
            }
            return l
        }, n.prototype._getCameraTargetAndPosForKeys = function(e, t, i) {
            function n() {
                var i = e.camTarget.clone(),
                    n = t.camTarget.x - i.x,
                    a = n || (0 > n ? -h : h),
                    s = t.camTarget.y - i.y,
                    d = s || (0 > s ? -h : h),
                    c = t.camTarget.z - i.z,
                    f = c || (0 > c ? -h : h);
                return i.x = u(l, r, i.x, a, o), i.y = u(l, r, i.y, d, o), i.z = u(l, r, i.z, f, o), i
            }
            var r = i - e.timeStamp,
                o = t.timeStamp - e.timeStamp,
                l = r / o,
                h = 1e-13,
                u = a.easing[e.easing || this.easing || "linear"],
                d = n(),
                c = e.phi;
            Math.abs(e.phi - t.phi) > Math.PI && (e.phi < t.phi ? c += 2 * Math.PI : c -= 2 * Math.PI);
            var f = t.r - e.r,
                p = f || (0 > f ? -h : h),
                m = t.theta - e.theta,
                g = m || (0 > m ? -h : h),
                _ = t.phi - c,
                v = _ || (0 > _ ? -h : h),
                y = {
                    r: u(l, r, e.r, p, o),
                    theta: u(l, r, e.theta, g, o),
                    phi: u(l, r, c, v, o)
                },
                b = d.clone().addSelf(s.convertSphericalToXYZ(y));
            return {
                camPos: b,
                camTarget: d
            }
        }, n.prototype.computeAnimKeys = function(e) {
            var t, i = this.keys[0],
                n = this.keys[this.keys.length - 1],
                o = e.moveSpeed;
            if (!o && e.durationInMS) {
                var a = 0;
                for (t = 1; t < this.keys.length; ++t) i = this.keys[t - 1], n = this.keys[t], a += Math.max(i.camPos.distanceTo(n.camPos), i.camTarget.distanceTo(n.camTarget));
                a = Math.max(1, a), o = a / (e.durationInMS || 1e3)
            }
            i = this.keys[0], i.timeStamp = 0, r(i);
            var s = null;
            for (t = 1; t < this.keys.length; ++t) {
                if (i = this.keys[t - 1], n = this.keys[t], null != i.duration && (s = i.duration), null != i.duration && null != n.duration) n.timeStamp = i.timeStamp + i.duration;
                else {
                    if (s && !n.skip) {
                        for (var l = 0, h = t; h < this.keys.length; ++h) {
                            var u = this.keys[h - 1],
                                d = this.keys[h];
                            if (null != d.duration) break;
                            d.skip = !0, l += Math.max(u.camPos.distanceTo(d.camPos), u.camTarget.distanceTo(d.camTarget))
                        }
                        l = Math.max(1, l), o = l / (s || 1e3)
                    }
                    var c = Math.max(i.camPos.distanceTo(n.camPos), i.camTarget.distanceTo(n.camTarget));
                    0 == c && (c = 1), n.timeStamp = i.timeStamp + c / o
                }
                r(n)
            }
            for (this.durationInMS = this.keys[this.keys.length - 1].timeStamp, t = 1; t < this.keys.length; ++t) this.keys[t].timeStamp /= this.durationInMS
        }, n.prototype.generateSplinedKeys = function(e) {
            if (e.length < 3) return e;
            for (var t, i = this.createControlPoints(e), n = i.allPositionControlPoints, r = i.allTargetControlPoints, o = n.p0, a = n.p1, s = r.p0, h = r.p1, u = [], d = 10, c = 0; c < e.length - 1; c++) {
                var f = e[c].camPos,
                    p = e[c + 1].camPos,
                    m = e[c].date,
                    g = e[c + 1].date,
                    _ = e[c].camTarget,
                    v = e[c + 1].camTarget,
                    y = o[c],
                    b = a[c],
                    x = s[c],
                    w = h[c];
                t = e[c].duration ? e[c].duration / d : null;
                for (var M = 0; d > M; M++) {
                    var T = M / d,
                        S = 1 - T,
                        C = S * S * S,
                        E = 3 * S * S * T,
                        k = 3 * S * T * T,
                        L = T * T * T,
                        P = C * f.x + E * y.x + k * b.x + L * p.x,
                        A = C * f.y + E * y.y + k * b.y + L * p.y,
                        R = C * f.z + E * y.z + k * b.z + L * p.z,
                        D = new l(P, A, R);
                    P = C * _.x + E * x.x + k * w.x + L * v.x, A = C * _.y + E * x.y + k * w.y + L * v.y, R = C * _.z + E * x.z + k * w.z + L * v.z;
                    var I = new l(P, A, R),
                        O = null;
                    m && g && (O = (g.valueOf() - m.valueOf()) * T + m.valueOf());
                    var N = {
                        camPos: D,
                        camTarget: I,
                        duration: t
                    };
                    null != O && (N.date = new Date(O)), u.push(N)
                }
            }
            if (e.length > 0) {
                var B = e[e.length - 1],
                    F = {
                        camPos: B.camPos.clone(),
                        camTarget: B.camTarget.clone(),
                        duration: t
                    };
                null != B.date && (F.date = B.date), u.push(F)
            }
            return u
        }, n.prototype.createControlPoints = function(e) {
            var t = [],
                i = [],
                n = [];
            o.each(e, function(e) {
                t.push(e.camPos), i.push(e.camTarget), n.push(e.date)
            });
            var r = this.computeControlPoints(t),
                a = this.computeControlPoints(i);
            return {
                allPositionControlPoints: r,
                allTargetControlPoints: a
            }
        }, n.prototype.computeControlPoints = function(e) {
            var t = [],
                i = [],
                n = e.length - 1,
                r = [],
                o = [],
                a = [],
                s = [];
            r[0] = {
                x: 0,
                y: 0,
                z: 0
            }, o[0] = {
                x: 2,
                y: 2,
                z: 2
            }, a[0] = {
                x: 1,
                y: 1,
                z: 1
            }, s[0] = {
                x: e[0].x + 2 * e[1].x,
                y: e[0].y + 2 * e[1].y,
                z: e[0].z + 2 * e[1].z
            };
            var h, u;
            for (h = 1; n - 1 > h; h++) r[h] = {
                x: 1,
                y: 1,
                z: 1
            }, o[h] = {
                x: 4,
                y: 4,
                z: 4
            }, a[h] = {
                x: 1,
                y: 1,
                z: 1
            }, s[h] = {
                x: 4 * e[h].x + 2 * e[h + 1].x,
                y: 4 * e[h].y + 2 * e[h + 1].y,
                z: 4 * e[h].z + 2 * e[h + 1].z
            };
            for (r[n - 1] = {
                    x: 2,
                    y: 2,
                    z: 2
                }, o[n - 1] = {
                    x: 7,
                    y: 7,
                    z: 7
                }, a[n - 1] = {
                    x: 0,
                    y: 0,
                    z: 0
                }, s[n - 1] = {
                    x: 8 * e[n - 1].x + e[n].x,
                    y: 8 * e[n - 1].y + e[n].y,
                    z: 8 * e[n - 1].z + e[n].z
                }, h = 1; n > h; h++) u = {
                x: r[h].x / o[h - 1].x,
                y: r[h].y / o[h - 1].y,
                z: r[h].z / o[h - 1].z
            }, o[h].x = o[h].x - u.x * a[h - 1].x, o[h].y = o[h].y - u.y * a[h - 1].y, o[h].z = o[h].z - u.z * a[h - 1].z, s[h].x = s[h].x - u.x * s[h - 1].x, s[h].y = s[h].y - u.y * s[h - 1].y, s[h].z = s[h].z - u.z * s[h - 1].z;
            for (t[n - 1] = new l(s[n - 1].x / o[n - 1].x, s[n - 1].y / o[n - 1].y, s[n - 1].z / o[n - 1].z), h = n - 2; h >= 0; --h) t[h] = new l((s[h].x - a[h].x * t[h + 1].x) / o[h].x, (s[h].y - a[h].y * t[h + 1].y) / o[h].y, (s[h].z - a[h].z * t[h + 1].z) / o[h].z);
            for (h = 0; n - 1 > h; h++) i[h] = new l(2 * e[h + 1].x - t[h + 1].x, 2 * e[h + 1].y - t[h + 1].y, 2 * e[h + 1].z - t[h + 1].z);
            return i[n - 1] = new l(.5 * (e[n].x + t[n - 1].x), .5 * (e[n].y + t[n - 1].y), .5 * (e[n].z + t[n - 1].z)), {
                p0: t,
                p1: i
            }
        }, n.prototype.onDivRemoved = function() {
            this.renderer.getRenderEngine().removeListener("compute", this._loopHandler), delete this._loopHandler, delete this.cameraManager, delete this.renderer
        }
    }, {
        "./CameraHelper": 330,
        "engine/src/math/Vector3": 63,
        jquery: 111,
        underscore: 207
    }],
    329: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.renderer = e, this.cameraManager = t, this.dragDisabled = !1, this.scrollwheel = !0, this.disableDoubleClickZoom = !1, this.initDefaultCommands()
        }
        var r = e("underscore"),
            o = e("../../input/Key");
        t.exports = n, n.prototype.initDefaultCommands = function() {
            this.initDefaultMouseCommands(), this.initDefaultKeyboardCommands()
        }, n.prototype.initDefaultMouseCommands = function() {
            this._onMouseWheelHandler = r.bind(this.onMouseWheel, this), this._onDoubleClickHandler = r.bind(this.onDoubleClick, this), this._rotationDragHandler = r.bind(this._rotationDrag, this), this._onDragStartHandler = r.bind(this.onDragStart, this), this._onDragHandler = r.bind(this.onDrag, this), this._onDragStopHandler = r.bind(this.onDragStop, this);
            var e = this.renderer._mouseManager;
            e.on("wheel", this._onMouseWheelHandler), e.on("dblclick", this._onDoubleClickHandler), e.on("rightDrag", this._rotationDragHandler), this.renderer.on("dragstart", this._onDragStartHandler), this.renderer.on("drag", this._onDragHandler), this.renderer.on("dragend", this._onDragStopHandler)
        }, n.prototype.initDefaultKeyboardCommands = function() {
            var e = this.renderer._keyboardManager;
            if (e.registerCommand(o.numpad.plus, r.bind(this.zoomIn, this)), e.registerCommand(o.numpad.minus, r.bind(this.zoomOut, this)), e.registerCommand(o.up, r.bind(this.handleUpKey, this, !1)), e.registerCommand(o.down, r.bind(this.handleDownKey, this, !1)), e.registerCommand(o.numpad[8], r.bind(this.handleUpKey, this, !1)), e.registerCommand(o.numpad[2], r.bind(this.handleDownKey, this, !1)), e.registerCommand(o.left, r.bind(this.handleLeftKey, this, !1)), e.registerCommand(o.right, r.bind(this.handleRightKey, this, !1)), e.registerCommand(o.numpad[4], r.bind(this.handleLeftKey, this, !1)), e.registerCommand(o.numpad[6], r.bind(this.handleRightKey, this, !1)), e.registerCommand(o.pageup, r.bind(this.turnUpKeyboard, this)), e.registerCommand(o.pagedown, r.bind(this.turnDownKeyboard, this)), e.registerShiftCommand(o.pageup, r.bind(this.moveUp, this)), e.registerShiftCommand(o.pagedown, r.bind(this.moveDown, this)), e.registerCommand(o.numpad[9], r.bind(this.turnUpKeyboard, this)), e.registerCommand(o.numpad[3], r.bind(this.turnDownKeyboard, this)), e.registerCtrlCommand(o.left, r.bind(this.handleLeftKey, this, !0)), e.registerCtrlCommand(o.right, r.bind(this.handleRightKey, this, !0)), e.registerCtrlCommand(o.numpad[4], r.bind(this.handleLeftKey, this, !0)), e.registerCtrlCommand(o.numpad[6], r.bind(this.handleRightKey, this, !0)), e.registerCommand(o.numpad.divide, r.bind(this.moveLeft, this)), e.registerCommand(o.numpad.multiply, r.bind(this.moveRight, this)), e.registerCtrlCommand(o.up, r.bind(this.handleUpKey, this, !0)), e.registerCtrlCommand(o.down, r.bind(this.handleDownKey, this, !0)), e.registerCommand(o.home, r.bind(this.lookAtNorth, this)), e.registerCommand(o.numpad[7], r.bind(this.lookAtNorth, this)), this.cameraManager.renderer.map.debugExtraKeys) {
                e.registerKeyPressCommand(o.o, r.bind(this.handleOrbitTarget, this));
                var t = this;
                e.registerKeyPressCommand(o.t, function() {
                    t.renderer.conf.set("tiles.enableUpdate", !t.renderer.conf.get("tiles.enableUpdate"))
                })
            }
        }, n.prototype.setDraggable = function(e) {
            this.dragDisabled = !e
        }, n.prototype.setScrollwheel = function(e) {
            this.scrollwheel = e
        }, n.prototype.setdisableDoubleClickZoom = function(e) {
            this.disableDoubleClickZoom = e
        }, n.prototype.onDragStart = function() {
            this.dragDisabled || this.cameraManager.stopInertia()
        }, n.prototype.onDragStop = function() {
            this.dragDisabled || this.cameraManager.startInertia(this.renderer.makeIdleEvent(!0))
        }, n.prototype.onDrag = function(e) {
            this.dragDisabled || (e.ctrlKey || e.altKey || e.shiftKey || e.metaKey ? this._rotationDrag(e) : this.cameraManager.onDrag(e))
        }, n.prototype._rotationDrag = function(e) {
            var t = 5 * e.deltaXY.y;
            this.renderer.conf.get("controls.inverseMouseVerticalRotation") && (t = -t), this.cameraManager.rotateOnX(t, !0);
            var i = 5 * e.deltaXY.x;
            this.renderer.conf.get("controls.inverseMouseHorizontalRotation") && (i = -i), this.cameraManager.rotateOnZ(i)
        }, n.prototype.onMouseWheel = function(e) {
            function t() {
                return {
                    x: r.clientX,
                    y: r.clientY
                }
            }
            if (this.scrollwheel) {
                var i = e.delta,
                    n = 1 / this.renderer.conf.camera.stepsBetweenZoomLevels;
                0 > i && (n *= -1);
                var r = e.originalEvent ? e.originalEvent : e;
                this.cameraManager.smoothedZoom(n, t, this.renderer.makeIdleEvent(!0))
            }
        }, n.prototype.onDoubleClick = function(e) {
            function t() {
                return {
                    x: e.clientX,
                    y: e.clientY
                }
            }
            if (!this.disableDoubleClickZoom) {
                var i;
                0 == e.button ? i = 1 / this.renderer.conf.camera.stepsBetweenZoomLevels : 2 == e.button && (i = -1 / this.renderer.conf.camera.stepsBetweenZoomLevels), i && this.cameraManager.smoothedZoom(i, t, this.renderer.makeIdleEvent(!0))
            }
        }, n.prototype.handleLeftKey = function(e, t) {
            if (this.renderer.isIn3d()) {
                var i = !(this.renderer.conf.get("controls.useCtrlToTurn") ^ e);
                i ? this.turnLeftKeyboard(t) : this.moveLeft(t)
            } else this.moveLeft(t)
        }, n.prototype.handleRightKey = function(e, t) {
            if (this.renderer.isIn3d()) {
                var i = !(this.renderer.conf.get("controls.useCtrlToTurn") ^ e);
                i ? this.turnRightKeyboard(t) : this.moveRight(t)
            } else this.moveRight(t)
        }, n.prototype.handleUpKey = function(e, t) {
            if (this.renderer.isIn3d()) {
                var i = Boolean(e);
                i ? this.turnUpKeyboard(t) : this.moveForward(t)
            } else this.moveForward(t)
        }, n.prototype.handleDownKey = function(e, t) {
            if (this.renderer.isIn3d()) {
                var i = Boolean(e);
                i ? this.turnDownKeyboard(t) : this.moveBackward(t)
            } else this.moveBackward(t)
        }, n.prototype.turnLeftKeyboard = function(e) {
            this.renderer.conf.get("controls.inverseKeyboardHorizontalRotation") ? this.turnRight(e) : this.turnLeft(e)
        }, n.prototype.turnRightKeyboard = function(e) {
            this.renderer.conf.get("controls.inverseKeyboardHorizontalRotation") ? this.turnLeft(e) : this.turnRight(e)
        }, n.prototype.turnDownKeyboard = function(e) {
            this.renderer.conf.get("controls.inverseKeyboardVerticalRotation") ? this.turnUp(e) : this.turnDown(e)
        }, n.prototype.turnUpKeyboard = function(e) {
            this.renderer.conf.get("controls.inverseKeyboardVerticalRotation") ? this.turnDown(e) : this.turnUp(e)
        }, n.prototype.zoomIn = function() {
            var e = 1 / this.renderer.conf.camera.stepsBetweenZoomLevels;
            this.cameraManager.smoothedZoom(e, null, this.renderer.makeIdleEvent(!0))
        }, n.prototype.zoomOut = function() {
            var e = -1 / this.renderer.conf.camera.stepsBetweenZoomLevels;
            this.cameraManager.smoothedZoom(e, null, this.renderer.makeIdleEvent(!0))
        }, n.prototype.moveLeft = function(e) {
            this.cameraManager.moveRight(-e)
        }, n.prototype.moveRight = function(e) {
            this.cameraManager.moveRight(e)
        }, n.prototype.moveUp = function(e) {
            this.cameraManager.moveUp(e)
        }, n.prototype.moveDown = function(e) {
            this.cameraManager.moveUp(-e)
        }, n.prototype.moveForward = function(e) {
            this.cameraManager.moveForward(e)
        }, n.prototype.moveBackward = function(e) {
            this.cameraManager.moveForward(-e)
        }, n.prototype.turnDown = function(e) {
            this.cameraManager.rotateOnX(e, !0)
        }, n.prototype.turnUp = function(e) {
            this.cameraManager.rotateOnX(-e, !0)
        }, n.prototype.turnLeft = function(e) {
            this.cameraManager.rotateOnZ(-e)
        }, n.prototype.turnRight = function(e) {
            this.cameraManager.rotateOnZ(e)
        }, n.prototype.lookAtNorth = function() {
            this.cameraManager.lookAtNorth()
        }, n.prototype.handleOrbitTarget = function() {
            this.cameraManager.toggleOrbitTarget()
        }, n.prototype.multitouchMove = function(e, t) {
            this.dragDisabled || this.cameraManager.multitouchMove(e, t)
        }, n.prototype.multitouchStart = function(e) {
            this.dragDisabled || this.cameraManager.multitouchStart(e)
        }, n.prototype.multitouchEnd = function(e) {
            this.dragDisabled || this.cameraManager.multitouchEnd(e)
        }, n.prototype.onDivRemoved = function() {
            var e = this.renderer._mouseManager;
            e.removeListener("wheel", this._onMouseWheelHandler), e.removeListener("dblclick", this._onDoubleClickHandler), e.removeListener("rightDrag", this._rotationDragHandler), this.renderer.removeListener("dragstart", this._onDragStartHandler), this.renderer.removeListener("drag", this._onDragHandler), this.renderer.removeListener("dragend", this._onDragStopHandler), delete this._onMouseWheelHandler, delete this._onDoubleClickHandler, delete this._rotationDragHandler, delete this._onDragStartHandler, delete this._onDragHandler, delete this._onDragStopHandler, delete this.renderer, delete this.cameraManager
        }
    }, {
        "../../input/Key": 386,
        underscore: 207
    }],
    330: [function(e, t, i) {
        "use strict";

        function n(e) {
            return Math.sqrt(e.x * e.x + e.y * e.y + e.z * e.z)
        }

        function r(e) {
            return s != e.get("camera.referenceFov") && (s = e.get("camera.referenceFov"), l = s * Math.PI / 180, h = Math.tan(l / 2)), l
        }

        function o(e) {
            return s != e.get("camera.referenceFov") && r(e), h
        }

        function a(e) {
            return u != e.get("camera.referenceHeight") && (u = e.get("camera.referenceHeight"), d = u * c / f), d
        }
        var s, l, h, u, d, c = 20037508.34,
            f = 256,
            p = Math.log(2),
            m = e("engine"),
            g = m.Vector3,
            _ = m.MathHelper,
            v = e("../../api/LatLng"),
            y = t.exports;
        t.exports.computeFov = function(e, t) {
            var i = e.get("camera.referenceHeight"),
                n = r(e),
                o = 2 * Math.atan(t * Math.tan(n / 2) / i);
            return 180 * o / Math.PI
        }, t.exports.computeDistanceFromZoom = function(e, t) {
            return a(e) / (o(e) * Math.pow(2, t))
        }, t.exports.computeZoomFromDistance = function(e, t) {
            var i = a(e) / (o(e) * t),
                n = Math.log(i) / p;
            return isFinite(n) || (console.log("not finite zoom computed : ", n), console.log("twoPowerZoom : ", i), console.log("getMagicFactor(conf) : ", a(e)), console.log("getTanHalfFov(conf) : ", o(e)), console.log("distance : ", t), console.trace()), n
        }, t.exports.getZoomFromBound = function(e, t, i, n) {
            return y.computeZoomFromDistance(e, y.getHeightFromBound(e, t, i, n))
        }, t.exports.getHeightFromBound = function(e, t, i, n) {
            var o = e.camera.referenceHeight,
                a = e.camera.minDistToZoomOnItem,
                s = r(e),
                l = o / (2 * Math.tan(s / 2)),
                h = t.right - t.left;
            h = Math.max(h, a), h = Math.abs(h * l / (i || 1));
            var u = t.top - t.bottom;
            return u = Math.max(u, a), u = Math.abs(u * l / (n || 1)), Math.max(h, u)
        }, t.exports.computeCeilZoomFromDistance = function(e, t) {
            return y.zoomCeil(e, y.computeZoomFromDistance(e, t))
        }, t.exports.computeFloorZoomFromDistance = function(e, t) {
            return y.zoomFloor(e, y.computeZoomFromDistance(e, t))
        }, t.exports.computeRoundZoomFromDistance = function(e, t) {
            return y.zoomRound(e, y.computeZoomFromDistance(e, t))
        }, t.exports.zoomRound = function(e, t) {
            return Math.round(t * e.get("camera.stepsBetweenZoomLevels")) / e.get("camera.stepsBetweenZoomLevels")
        }, t.exports.zoomFloor = function(e, t) {
            return Math.floor(t * e.get("camera.stepsBetweenZoomLevels")) / e.get("camera.stepsBetweenZoomLevels")
        }, t.exports.zoomCeil = function(e, t) {
            return Math.ceil(t * e.get("camera.stepsBetweenZoomLevels")) / e.get("camera.stepsBetweenZoomLevels")
        }, t.exports.convertVectorToSpherical = function(e) {
            var t, i = e.length ? e.length() : n(e),
                r = Math.acos(e.z / i);
            if (0 == e.x) t = e.y <= 0 ? 0 : Math.PI;
            else {
                var o = e.y / e.x;
                t = e.x > 0 ? Math.atan(o) + Math.PI / 2 : Math.atan(o) - Math.PI / 2;
                var a = 180 * t / Math.PI;
                Math.abs(a) > 180 && (a %= 180, t = a * Math.PI * 2 / 360)
            }
            return {
                r: i,
                theta: r,
                phi: t
            }
        }, t.exports.convertSphericalToXYZ = function(e) {
            return {
                x: e.r * Math.sin(e.theta) * Math.sin(e.phi),
                y: -e.r * Math.sin(e.theta) * Math.cos(e.phi),
                z: e.r * Math.cos(e.theta)
            }
        }, t.exports.convertTargetAndCameraPosToCameraConfig = function(e, t, i) {
            var n = e.camPos.clone().subSelf(e.camTarget);
            if (i) {
                var r = n.clone().normalize();
                n.addSelf(r.multiplyScalar(i))
            }
            var o = y.convertVectorToSpherical(n);
            return {
                lat: e.camTarget.y,
                lon: e.camTarget.x,
                camera: {
                    theta: _.radToDeg(o.theta),
                    phi: _.radToDeg(o.phi)
                },
                zoom: y.computeZoomFromDistance(t, o.r),
                "3d": !0
            }
        }, t.exports.convertCameraConfigToTargetAndCameraPos = function(e, t) {
            var i, n = e.zoom,
                r = y.computeDistanceFromZoom(t, n),
                o = new v(e.lat, e.lon)._to900913(),
                a = new g(o.lon, o.lat, 0),
                s = e.camera || {
                    theta: e.theta ? e.theta : 0,
                    phi: e.phi ? e.phi : 0
                },
                l = {
                    r: r,
                    theta: _.degToRad(s.theta),
                    phi: _.degToRad(s.phi)
                };
            return i = (new g).add(y.convertSphericalToXYZ(l), a), {
                posCamera: i,
                posTarget: a
            }
        }
    }, {
        "../../api/LatLng": 233,
        engine: 10
    }],
    331: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.cameraManager = t, this.conf = e, this.minX = this.minY = -s, this.maxX = this.maxY = +s, this.updateLimits(), this.cameraZoomMin = this.conf.get("camera.defaultZoomMin"), this.rebuildLimits(), this._rebuildLimitsHandler = r.bind(this.rebuildLimits, this), this.cameraManager.renderer.map.on("elevation", this._rebuildLimitsHandler), this.conf.on("change:camera.zoomMax", this._rebuildLimitsHandler), this._extraZoom = !1, this._extraZoomAllowed = !1, this._rotationUnderGroundAllowed = !1, this.cameraManager.renderer.map.debugExtraZoom && this.conf.get("camera.extraZoomMax") && this.conf.get("camera.extraZoomMax") > this.conf.get("camera.zoomMax") && (this._onBlurHandler = r.bind(this.onBlur, this), this._onKeysHandler = r.bind(this.onKeys, this), o(window).on("blur", this._onBlurHandler), o(document).bind("keyup keydown", this._onKeysHandler))
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("./CameraHelper"),
            s = 20037508.34,
            l = Math.PI / 180,
            h = .01 * Math.PI / 2;
        n.prototype.onBlur = function() {
            this._extraZoomAllowed = !1, this._rotationUnderGroundAllowed = !1
        }, n.prototype.onKeys = function(e) {
            var t = Boolean(e.shiftKey);
            this._extraZoomAllowed = t, this._rotationUnderGroundAllowed = t
        }, n.prototype.updateLimits = function() {
            var e = this.conf,
                t = e.get("limit");
            t && t.mockup && (this.minX = e.limit.mockup.xMin, this.minY = e.limit.mockup.yMin, this.maxX = e.limit.mockup.xMax, this.maxY = e.limit.mockup.yMax)
        }, n.prototype.rebuildLimits = function() {
            this.maxThetaPerZoom = {
                13: 50 * l,
                14: 50 * l
            };
            var e, t = this.cameraManager.renderer.getMinZoomLayer2D();
            for (e = 1; t >= e; ++e) this.maxThetaPerZoom[e] = h;
            var i, n = Math.max(this.conf.get("camera.zoomMax"), this.conf.get("camera.extraZoomMax")),
                o = this.conf.get("camera.defaultMaxTheta"),
                a = 0,
                s = function(t, n) {
                    n > a && e >= n && (a = n, i = t)
                };
            if (r.isObject(o))
                for (e = t + 1; n >= e; ++e) a = 0, r.each(o, s), i *= l, this.maxThetaPerZoom[e] = i;
            else
                for (o *= l, e = t + 1; n >= e; ++e) this.maxThetaPerZoom[e] = o;
            for (this.maxAbsPhiPerZoom = {}, e = 1; t >= e; ++e) this.maxAbsPhiPerZoom[e] = 0;
            for (e = t + 1; n >= e; ++e) this.maxAbsPhiPerZoom[e] = 190 * l
        }, n.prototype.getMaxThetaForZoom = function(e) {
            return this.maxThetaPerZoom[e]
        }, n.prototype.onStabilized = function() {
            this.conf.get("zoom") <= this.conf.get("camera.zoomMax") && (this._extraZoom = !1)
        }, n.prototype.setBounds = function(e) {
            var t = this.conf.get("limit.margin");
            e.left -= t, e.bottom -= t, e.top += t, e.right += t, this.minX = e.left, this.maxX = e.right, this.minY = e.bottom, this.maxY = e.top;
            var i = Math.max(Math.abs(e.right - e.left), Math.abs(e.top - e.bottom));
            this.cameraZoomMin = a.computeZoomFromDistance(this.conf, i), this.cameraZoomMin = Math.max(Math.floor(this.cameraZoomMin - 1), this.conf.get("camera.defaultZoomMin"))
        }, n.prototype.clampX = function(e) {
            if (this.conf.camera.clipToScreen) {
                var t = this.cameraManager.renderer.getPixelSizeInMeter(.5 * this.cameraManager.renderer.width);
                return Math.min(Math.max(e, this.minX + t), this.maxX - t)
            }
            return Math.min(Math.max(e, this.minX), this.maxX)
        }, n.prototype.clampY = function(e) {
            if (this.conf.camera.clipToScreen) {
                var t = this.cameraManager.renderer.getPixelSizeInMeter(.5 * this.cameraManager.renderer.height);
                return Math.min(Math.max(e, this.minY + t), this.maxY - t)
            }
            return Math.min(Math.max(e, this.minY), this.maxY)
        }, n.prototype.clampZ = function(e) {
            return Math.min(Math.max(e, this.conf.get("camera.minZ")), this.conf.get("camera.maxZ"))
        }, n.prototype.clampSphericalTargetToCameraOnX = function(e, t) {
            var i = 80 * l;
            if (!t) {
                var n = a.computeRoundZoomFromDistance(this.conf, e.r);
                i = this.getMaxThetaForZoom(n)
            }
            e.theta = Math.max(e.theta, h), e.theta = Math.min(e.theta, i)
        }, n.prototype.clampSphericalTargetToCameraOnXAndY = function(e) {
            e.theta = 0, e.phi = Math.PI
        }, n.prototype.clampSphericalTargetToCamera = function(e) {
            var t = a.computeRoundZoomFromDistance(this.conf, e.r);
            e.theta = Math.max(e.theta, h);
            var i = Math.floor(t);
            this._rotationUnderGroundAllowed || (e.theta = Math.min(e.theta, this.maxThetaPerZoom[i] || h));
            var n = i in this.maxAbsPhiPerZoom ? this.maxAbsPhiPerZoom[i] : Math.PI,
                r = Math.abs(e.phi > Math.PI ? e.phi - 2 * Math.PI : e.phi);
            r > n && (e.phi = n * (e.phi > 0 ? 1 : -1))
        }, n.prototype.clampZoom = function(e) {
            if (e = Math.max(this.cameraZoomMin, e), this._extraZoomAllowed || this._extraZoom) e = Math.min(this.conf.get("camera.extraZoomMax"), e), e > this.conf.get("camera.zoomMax") && (this._extraZoom = !0);
            else {
                var t = this.conf.get("camera.zoomMax"),
                    i = this.conf.get("camera.2d"),
                    n = this.conf.get("3d");
                n || (t = i.zoomMax), e = Math.min(t, e)
            }
            return e
        }, n.prototype.clampCameraMove = function(e, t) {
            var i = this.cameraManager.getPosition(),
                n = this.clampZ(i.z + e.z),
                r = n - i.z;
            if (t && 0 != e.z) {
                var o = r / e.z;
                e.x *= o, e.y *= o
            }
            return e.z = r, this.clampTargetDistance(e), e.lengthSq() > .01
        }, n.prototype.clampTargetMove = function(e) {
            var t = this.cameraManager.getTarget(),
                i = this.clampX(t.x + e.x);
            e.x = i - t.x;
            var n = this.clampY(t.y + e.y);
            return e.y = n - t.y, e.lengthSq() > 0
        }, n.prototype.clampTargetAndCameraMove = function(e, t) {
            var i = this.cameraManager.getTarget(),
                n = this.clampX(i.x + e.x),
                r = n - i.x;
            t.x += r - e.x, e.x = r;
            var o = this.clampY(i.y + e.y),
                a = o - i.y;
            return t.y += a - e.y, e.y = a, 0 != t.z && this.clampTargetDistance(t), t.lengthSq() > 0 || e.lengthSq() > 0
        }, n.prototype.clampTargetDistance = function(e) {
            if (!this.conf.get("limit.canEscape")) {
                var t = this.cameraManager.getPosition(),
                    i = this.cameraManager.getTarget(),
                    n = t.clone().addSelf(e),
                    r = i.clone().subSelf(n),
                    o = r.length(),
                    s = a.computeDistanceFromZoom(this.conf, this.conf.get("camera.zoomMax")),
                    l = a.computeDistanceFromZoom(this.conf, this.cameraZoomMin);
                o = Math.min(Math.max(o, s), l), n.sub(i, r.setLength(o)), e.x = n.x - t.x, e.y = n.y - t.y, e.z = n.z - t.z
            }
        }, n.prototype.onDivRemoved = function() {
            this.cameraManager.renderer.map.removeListener("elevation", this._rebuildLimitsHandler), this.conf.removeListener("change:camera.zoomMax", this._rebuildLimitsHandler), this._onBlurHandler && o(window).off("blur", this._onBlurHandler), this._onKeysHandler && o(document).off("keyup keydown", this._onKeysHandler)
        }, t.exports = n, t.exports.ROTATE_ON_X_MIN_ANGLE = h
    }, {
        "./CameraHelper": 330,
        jquery: 111,
        underscore: 207
    }],
    332: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            l.call(this), this.setMaxListeners(0), this.renderer = e, this._width = t, this._height = i, this.limits = new v(this.renderer.conf, this), this.controller = new y(this.renderer, this), this._cameraAnimator = new b(this.renderer, this), this.engine = h, this.camera = new u(this.computeFov(), this._width / this._height, this.renderer.conf.get("camera.near"), this.renderer.conf.get("camera.far")), this.cameraTarget = new d;
            var n = this.getCameraConfigFromConfiguration(),
                r = this.getWantedTargetAndCameraPos(n);
            this.setTargetAndPosition(r.posTarget, r.posCamera), this.projMatrix = new p, this.ray = new m, this.stabilizedTimeoutID = null, this.visibleBoundingBox = [], this._isCameraMoving = !1, this._isCameraUpdated = !1, this._isCameraOrbiting = !1, this.cameraElevation = !1, this.oldZoom = this.renderer.conf.get("zoom"), this.nextAllowedSmoothedZoomDate = 0, this.wantedPositionHeight = 0, this.currentPositionHeight = 0, this.wantedTargetHeight = 0, this.currentTargetHeight = 0, this.changeModeOnRotate = 0, this._onConfigChangeHandler = o.bind(this.onConfigChange, this), this._updateMinFarHandler = o.bind(this.updateMinFar, this), this._update2dTo3dHandler = o.bind(this.update2dTo3d, this), this.renderer.conf.on("historyChange", this._onConfigChangeHandler), this.renderer.map.on("elevation", this._updateMinFarHandler), this.renderer.conf.on("change:3d", this._update2dTo3dHandler), this.updateMinFar()
        }

        function r(e) {
            return Math.round(1e3 * e) / 1e3
        }
        var o = e("underscore"),
            a = e("jquery"),
            s = e("util"),
            l = e("events").EventEmitter,
            h = e("engine"),
            u = h.PerspectiveCamera,
            d = h.Vector3,
            c = h.Vector2,
            f = h.MathHelper,
            p = h.Matrix4,
            m = h.Ray,
            g = e("../../utils/LocationHelper"),
            _ = e("./CameraHelper"),
            v = e("./CameraLimits"),
            y = e("./CameraController"),
            b = e("./CameraAnimator"),
            x = Math.PI / 180,
            w = .2 * Math.PI / 2,
            M = .2 * Math.PI / 2,
            T = .1 * x,
            S = 45 * x;
        t.exports = n, s.inherits(n, l);
        var C = n.prototype;
        C.getCameraHelper = function() {
            return _
        }, C.update2dTo3dWithoutAnim = function(e) {
            e = e || this.renderer.makeIdleEvent(!1);
            var t = this.renderer.isIn3d();
            t ? this.enter3d(e, !0) : this.enter2d(null, null, e, !0)
        }, C.update2dTo3d = function(e, t) {
            if (e = e || this.renderer.makeIdleEvent(!1), !this.isTouching || this._cameraAnimator.hasAnimation() || !this._cameraAnimator.mustUpdate2d3dOnStop()) {
                var i = this.renderer.isIn3d();
                i ? this.enter3d(e, t) : this.enter2d(null, null, e, t)
            }
        }, C.updateMinFar = function() {
            this.renderer.map.elevation ? this.minFar = this.renderer.conf.get("camera.farWithElevations") : this.minFar = this.renderer.conf.get("camera.far")
        }, C.getCameraConfigFromConfiguration = function() {
            var e = this.renderer.conf.getLonLat90013();
            return {
                lon: e.lon,
                zoom: this.renderer.conf.get("zoom"),
                lat: e.lat,
                camera: {
                    theta: this.renderer.conf.get("camera.theta"),
                    phi: this.renderer.conf.get("camera.phi")
                }
            }
        }, C.setCameraConfig = function(e, t) {
            if (!(null == e["3d"] || null == e.lon || null == e.lat || isNaN(e.lon) || isNaN(e.lat) || null == e.zoom || isNaN(e.zoom))) {
                var i = this.getWantedTargetAndCameraPos(e);
                this.setTargetAndPosition(i.posTarget, i.posCamera), e["3d"] != this.renderer.conf.get("3d") && (this.renderer.conf.setNoEvent("3d", e["3d"]), this.renderer.isIn3d() ? this.renderer.show3dWebGLMap() : this.renderer.show2dWebGLMap()), this.cameraUpdated(t)
            }
        }, C.enter2d = function(e, t, i, n) {
            this.renderer.updateMinDtWork();
            var r, o = this.getTargetToCamera().length();
            r = 1 == e ? this.limits.clampZoom(_.computeFloorZoomFromDistance(this.renderer.conf, o)) : 0 == e ? this.limits.clampZoom(_.computeCeilZoomFromDistance(this.renderer.conf, o)) : this.limits.clampZoom(_.computeRoundZoomFromDistance(this.renderer.conf, o)), o = _.computeDistanceFromZoom(this.renderer.conf, r);
            var a = this.getTarget(),
                s = {
                    r: o,
                    theta: T,
                    phi: 0
                },
                l = a.clone().addSelf(_.convertSphericalToXYZ(s)),
                h = a.clone();
            if (n) this.setTargetAndPosition(h, l), this.cameraUpdated(i);
            else {
                var u = [{
                        camPos: this.getPosition().clone(),
                        camTarget: a.clone()
                    }, {
                        camPos: l,
                        camTarget: h
                    }],
                    d = {
                        posAndTargetList: u,
                        durationInMS: 300,
                        onEndReachedCbk: t,
                        forceLastPointOnAbort: !t,
                        easing: "easeInOutCubic",
                        onEndReachIdleEvent: i
                    };
                this.startAnimation(d)
            }
        }, C.enter3d = function(e, t) {
            this.renderer.updateMinDtWork();
            var i = this.limits.clampZoom(this.renderer.conf.get("zoom")),
                n = _.convertVectorToSpherical(this.getCameraToTarget()),
                r = {
                    r: _.computeDistanceFromZoom(this.renderer.conf, i),
                    theta: S,
                    phi: n.phi
                },
                o = this.getTarget(),
                a = o.clone().addSelf(_.convertSphericalToXYZ(r)),
                s = o.clone();
            if (t) this.setTargetAndPosition(s, a), this.cameraUpdated(e);
            else {
                var l = [{
                        camPos: this.getPosition().clone(),
                        camTarget: o.clone()
                    }, {
                        camPos: a,
                        camTarget: s
                    }],
                    h = {
                        posAndTargetList: l,
                        durationInMS: 500,
                        easing: "easeInOutCubic",
                        forceLastPointOnAbort: !1,
                        onEndReachIdleEvent: e
                    };
                this.startAnimation(h)
            }
        }, C.lookAtNorth = function() {
            var e = this.getDistance(),
                t = this.getPosition().z,
                i = Math.asin(t / e),
                n = e * Math.cos(i),
                r = this.getTarget(),
                o = [{
                    camPos: this.getPosition().clone(),
                    camTarget: r.clone()
                }, {
                    camPos: new d(r.x, r.y - n, t),
                    camTarget: r.clone()
                }],
                a = {
                    posAndTargetList: o,
                    durationInMS: 1e3,
                    easing: "easeInOutCubic",
                    onEndReachIdleEvent: this.renderer.makeIdleEvent(!0),
                    preloadTiles: !0
                };
            this.startAnimation(a)
        }, C.smoothedZoom = function(e, t, i) {
            var n = Date.now();
            if (!(n < this.nextAllowedSmoothedZoomDate)) {
                var r = this.getTarget().clone(),
                    o = this.getPosition().clone(),
                    a = _.computeZoomFromDistance(this.renderer.conf, this.getDistance()),
                    s = this.limits.clampZoom(_.zoomRound(this.renderer.conf, a + e));
                if (!(Math.abs(a - s) < .001)) {
                    var l = _.convertVectorToSpherical(this.getCameraToTarget());
                    l.r = _.computeDistanceFromZoom(this.renderer.conf, s);
                    var h = s <= this.renderer.getMinZoomLayer2D();
                    h && (l.phi = 0), this.computeThetaPhi(a, s, l);
                    var u = r.clone(),
                        d = u.clone().addSelf(_.convertSphericalToXYZ(l));
                    if (t) {
                        var c = t(),
                            f = this.normalizeScreenPos(this.renderer.clientXYToRelativeMapPosition(c.x, c.y)),
                            p = this.computeIntersectAtZ(f, 0),
                            m = d.clone().subSelf(u);
                        this.setTargetAndTargetToCamera(p, m);
                        var g = this.computeIntersectAtZ(f, 0),
                            v = g.clone().subSelf(p);
                        u.sub(p, v), u.x = this.limits.clampX(u.x), u.y = this.limits.clampY(u.y), u.z = 0, d.add(u, m), this.setTargetAndPosition(r, o)
                    }
                    var y = [{
                            camPos: o.clone(),
                            camTarget: r.clone()
                        }, {
                            camPos: d,
                            camTarget: u
                        }],
                        b = {
                            forceLastPointOnAbort: !0,
                            posAndTargetList: y,
                            durationInMS: 250 * Math.abs(s - a),
                            easing: "linear",
                            onEndReachIdleEvent: i,
                            preloadTiles: !1
                        };
                    this.nextAllowedSmoothedZoomDate = n + b.durationInMS, this.startAnimation(b)
                }
            }
        }, C.onDrag = function(e) {
            this.stopAnimation();
            var t = this.getPosition(),
                i = this.getTargetToCamera(),
                n = this.renderer.clientXYToRelativeMapPosition(e.clientX, e.clientY),
                r = this.normalizeScreenPos(n.clone().subSelf(e.deltaXY)),
                o = this.computeIntersectAtZ(r, 0),
                a = o.clone().subSelf(t),
                s = a.dot(i);
            if (!(0 > s)) {
                var l = .8 * this.camera.far;
                a.length() > l && o.add(t, a.setLength(l));
                var h = this.normalizeScreenPos(n),
                    u = this.computeIntersectAtZ(h, 0);
                a = u.clone().subSelf(t);
                var d = a.dot(i);
                if (!(0 > d)) {
                    a.length() > l && u.add(t, a.setLength(l));
                    var c = u.clone().subSelf(o);
                    c.z = 0, this.limits.clampTargetMove(c) && (this.addTargetAndPosition(c, c), this.cameraUpdated(this.renderer.makeIdleEvent(!0)), this.setInertiaInitialSpeed(c))
                }
            }
        }, C.moveRight = function(e) {
            this.stopAnimation();
            var t = this.getRight(e * this.getMoveFactor());
            this.limits.clampTargetMove(t) && (this.addTargetAndPosition(t, t), this.cameraUpdated(this.renderer.makeIdleEvent(!0)))
        }, C.moveUp = function(e) {
            this.stopAnimation();
            var t = new d(0, 0, e * this.getMoveFactor());
            if (this.limits.clampCameraMove(t)) {
                var i = this.cameraTarget.clone();
                i.subSelf(this.camera.position);
                var n = -(this.camera.position.z + t.z) / i.z,
                    r = this.camera.position.x + n * i.x,
                    o = this.camera.position.y + n * i.y,
                    a = new d(r - this.cameraTarget.x, o - this.cameraTarget.y, 0);
                this.addTargetAndPosition(a, t), this.cameraUpdated(this.renderer.makeIdleEvent(!0))
            }
        }, C.moveForward = function(e) {
            var t = this.getTargetToCamera();
            t.z = 0, t.setLength(e * this.getMoveFactor()), this.limits.clampTargetMove(t) && (this.addTargetAndPosition(t, t), this.cameraUpdated(this.renderer.makeIdleEvent(!0)))
        }, C.getZoom = function() {
            var e = this.getDistance();
            return _.computeZoomFromDistance(this.renderer.conf, e)
        }, C.setZoom = function(e, t, i) {
            var n = this.getCameraToTarget(),
                r = _.convertVectorToSpherical(n),
                o = _.computeDistanceFromZoom(this.renderer.conf, e),
                a = r.r,
                s = _.computeZoomFromDistance(this.renderer.conf, a);
            r.r = o;
            var l = this.renderer.conf["3d"] && e > this.renderer.getMinZoomLayer2D();
            t ? l ? (r.theta = v.ROTATE_ON_X_MIN_ANGLE, r.phi = 0) : (r.theta = T, r.phi = 0) : (this.computeThetaPhi(s, e, r), l && this.limits.clampSphericalTargetToCamera(r));
            var h = (new d).copy(_.convertSphericalToXYZ(r));
            this.setTargetToCamera(h), this.cameraUpdated(i)
        }, C.computeThetaPhi = function(e, t, i) {
            if (!this.isTouching || this._cameraAnimator.hasAnimation() || !this._cameraAnimator.mustUpdate2d3dOnStop())
                if (this.renderer.conf.get("3d")) {
                    var n = this.renderer.getMinZoomLayer2D();
                    n >= e && t > n ? i.theta = S : e > n && n >= t ? (i.theta = T, i.phi = 0) : !this.isTouching && this.limits.getMaxThetaForZoom(t) < i.theta && (i.theta = this.limits.getMaxThetaForZoom(t))
                } else i.theta = T, i.phi = 0
        }, C.zoomOnPosAndZoom = function(e) {
            var t = new c(e.lon, e.lat),
                i = e.zoom,
                n = e.onArrivalCallback,
                r = e.idleEvent,
                a = g.convertLonLatOrXYToLonLat(t),
                s = this.getTarget(),
                l = this.getPosition(),
                h = new d(a.lon, a.lat, 0),
                u = [{
                    camPos: l.clone(),
                    camTarget: s.clone()
                }],
                f = this.getDistance(),
                p = _.computeZoomFromDistance(this.renderer.conf, f),
                m = _.convertVectorToSpherical(this.getCameraToTarget());
            m.r = _.computeDistanceFromZoom(this.renderer.conf, i), this.computeThetaPhi(p, i, m);
            var v = this.renderer.conf.get("camera.distForTransitionPoint"),
                y = s.clone();
            y.z = 0;
            var b = h.clone();
            b.z = 0;
            var x = y.distanceTo(b),
                w = 2 * x;
            if (x > v && w > f && m.r < w) {
                var M = s.clone().lerpSelf(h, .75),
                    T = {
                        phi: m.phi,
                        theta: m.theta,
                        r: x
                    },
                    S = _.computeZoomFromDistance(this.renderer.conf, x);
                this.computeThetaPhi(p, S, T);
                var C = M.clone().addSelf(_.convertSphericalToXYZ(T));
                u.push({
                    camPos: C,
                    camTarget: M
                }), 0 == T.phi && (m.phi = 0)
            }
            var E = h.clone().addSelf(_.convertSphericalToXYZ(m));
            u.push({
                camPos: E,
                camTarget: h.clone()
            });
            var k = o.defaults(e, {
                posAndTargetList: u,
                durationInMS: 1500,
                easing: "easeInOutCubic",
                onEndReachedCbk: n,
                onEndReachIdleEvent: r,
                preloadTiles: !0
            });
            this.startAnimation(k)
        }, C.getZoomFromBounds = function(e) {
            var t = _.getHeightFromBound(this.renderer.conf, e, this._width, this._height);
            return _.computeFloorZoomFromDistance(this.renderer.conf, Math.abs(t))
        }, C.fitBounds = function(e, t, i) {
            var n = _.getHeightFromBound(this.renderer.conf, e, this._width, this._height),
                r = new d(.5 * (e.left + e.right), .5 * (e.bottom + e.top), 0),
                o = _.computeFloorZoomFromDistance(this.renderer.conf, Math.abs(n)),
                a = this.limits.clampX(r.x),
                s = this.limits.clampY(r.y);
            this.stopAnimation(), this.moveToLonLat({
                lon: a,
                lat: s,
                smoothMovement: !1,
                idleEvent: i
            }), this.setZoom(o, t, i)
        }, C.panToBounds = function(e, t) {
            var i = _.getHeightFromBound(this.renderer.conf, e, this._width, this._height),
                n = new d(.5 * (e.left + e.right), .5 * (e.bottom + e.top), 0),
                r = _.computeFloorZoomFromDistance(this.renderer.conf, Math.abs(i)),
                o = this.limits.clampX(n.x),
                a = this.limits.clampY(n.y);
            this.zoomOnPosAndZoom({
                lon: o,
                lat: a,
                zoom: r,
                idleEvent: t,
                preloadTiles: !1
            })
        }, C.moveToLonLat = function(e) {
            var t = e.lon,
                i = e.lat,
                n = e.smoothMovement,
                r = e.onArrivalCallback,
                a = e.idleEvent,
                s = this.getTargetToCamera(),
                l = this.limits.clampX(t) - s.x,
                h = this.limits.clampY(i) - s.y;
            t = l + s.x, i = h + s.y;
            var u = new d(t, i, 0),
                c = new d(u.x, u.y, u.z),
                f = c.clone();
            if (f.subSelf(this.getTargetToCamera()), n) {
                var p = _.computeZoomFromDistance(this.renderer.conf, this.getDistance());
                this.zoomOnPosAndZoom(o.extend({
                    lon: u.x,
                    lat: u.y,
                    zoom: p,
                    onArrivalCallback: r,
                    idleEvent: a
                }, e))
            } else this.setTargetAndPosition(c, f), this.cameraUpdated(a), r && r()
        }, C.rotateOnX = function(e, t) {
            this.stopAnimation();
            var i = this.renderer.getMinZoomLayer2D();
            if (!this.renderer.isIn3d()) return this.changeModeOnRotate = Math.max(0, this.changeModeOnRotate + this.renderer.conf.get("camera.rotateSpeed") * e), void(this.changeModeOnRotate > w && this.renderer.conf.get("zoom") > i && (this.changeModeOnRotate = 0, this.renderer.enter3dMode()));
            var n = this.renderer.conf.get("camera.rotateSpeed") * e,
                r = _.convertVectorToSpherical(this.getCameraToTarget());
            if (r.theta + n <= .9999 * v.ROTATE_ON_X_MIN_ANGLE && t) {
                if (!(n > 0)) return this.changeModeOnRotate += -n, void(this.changeModeOnRotate > M && this.renderer.conf.get("zoom") > i && (this.changeModeOnRotate = 0, this.renderer.enter2dMode()));
                this.changeModeOnRotate = 0
            }
            r.theta += n, this.limits.clampSphericalTargetToCamera(r);
            var o = (new d).copy(_.convertSphericalToXYZ(r));
            this.setTargetToCamera(o), this.cameraUpdated(this.renderer.makeIdleEvent(!0))
        }, C.rotateOnZ = function(e) {
            if (this.renderer.isIn3d()) {
                this.stopAnimation();
                var t = this.renderer.conf.get("camera.rotateSpeed") * e,
                    i = _.convertVectorToSpherical(this.getCameraToTarget());
                i.phi += t, this.limits.clampSphericalTargetToCamera(i);
                var n = (new d).copy(_.convertSphericalToXYZ(i));
                this.setTargetToCamera(n), this.cameraUpdated(this.renderer.makeIdleEvent(!0))
            }
        }, C.getWantedTargetAndCameraPos = function(e) {
            var t, i = e.zoom,
                n = _.computeDistanceFromZoom(this.renderer.conf, i),
                r = new d(e.lon, e.lat, 0),
                o = e.camera || {
                    theta: 0,
                    phi: 0
                },
                a = {
                    r: n,
                    theta: f.degToRad(o.theta),
                    phi: f.degToRad(o.phi)
                };
            return this.isTouching || this.limits.clampSphericalTargetToCamera(a), t = (new d).add(_.convertSphericalToXYZ(a), r), {
                posCamera: t,
                posTarget: r
            }
        }, C.setCanvasSize = function(e, t) {
            e.w > 0 && e.h > 0 && (this._oldWidth = this._width, this._oldHeight = this._height, this._width = e.w, this._height = e.h, (this.renderer.map.getDepthMap() && a("body").hasClass("isDepthMap") || this.renderer.map.getSideBySide() || this.renderer.map.getTopToBottom()) && (this._height = 2 * this._height), this.camera.aspect = this._width / this._height, this.updateCamera(t))
        }, C.updateCamera = function(e) {
            this.camera.fov = this.computeFov(), this.camera.updateMatrix(), this.cameraUpdated(e)
        }, C.computeFov = function() {
            return _.computeFov(this.renderer.conf, this._height)
        }, C.checkCameraInfNan = function(e, t) {
            if (isNaN(t.x) || isNaN(t.y) || isNaN(t.z)) throw new Error(e + " is Nan :" + JSON.stringify(t));
            if (!isFinite(t.x) || !isFinite(t.y) || !isFinite(t.z)) throw new Error(e + " is Infinity :" + JSON.stringify(t))
        }, C.updateCameraMatrix = function() {
            var e = this.getTarget(),
                t = this.getPosition();
            this.checkCameraInfNan("position", t), this.checkCameraInfNan("target", e);
            var i = new c(e.x, e.y).subSelf(t);
            this.camera.up.set(i.x, i.y, 0).normalize(), 0 == this.camera.up.lengthSq() ? this.camera.up.set(0, 1, 0) : (this.camera.up.multiplyScalar(Math.abs(e.z - t.z)), this.camera.up.z = i.length(), this.camera.up.normalize()), this.camera.lookAt(e), this.camera.updateMatrix()
        }, C.zoomUpdated = function() {
            var e = _.computeRoundZoomFromDistance(this.renderer.conf, this.getDistance());
            if (this.oldZoom != e) {
                var t = this.renderer.getMinZoomLayer2D();
                this.renderer.conf.set("zoom", e), this.oldZoom <= t && e > t ? this.renderer.conf.get("3d") ? this.renderer.show3dWebGLMap() : this.renderer.show2dWebGLMap() : this.oldZoom > t && t >= e && this.renderer.show2dWebGLMap({}), this.emit("zoom_changed", this.oldZoom, e), this.oldZoom = e
            }
        }, C.cameraUpdated = function(e) {
            var t = this.getDistance();
            this.camera.far = Math.max(this.minFar, 3 * t), this.camera.updateMatrix(), this.zoomUpdated(), this._isCameraMoving = !0, this.renderer.setCameraChanged(), this.idleEvent = e, this.renderer.conf.get("enableWebGL") && null == this.stabilizedTimeoutID && (this.stabilizedTimeoutID = window.setTimeout(o.bind(this.checkStabilized, this), this.renderer.conf.get("camera.stabilizationDelayInMs"))), this._isCameraUpdated = !0;
            var i = this.getVisibleGroundBoundingBox();
            this._frustum = {
                xMin: o.min(o.pluck(i, "x")),
                xMax: o.max(o.pluck(i, "x")),
                yMin: o.min(o.pluck(i, "y")),
                yMax: o.max(o.pluck(i, "y"))
            }, this.renderer.forceRender()
        }, C.checkStabilized = function() {
            if (this._isCameraUpdated) this._isCameraUpdated = !1, this.stabilizedTimeoutID = window.setTimeout(o.bind(this.checkStabilized, this), this.renderer.conf.get("camera.stabilizationDelayInMs"));
            else {
                this.updateConfig(this.getCurrentCameraConfiguration());
                var e = this.idleEvent;
                this.idleEvent = null, this.sendStabilized(e)
            }
        }, C.stopStabilizedTimer = function() {
            null != this.stabilizedTimeoutID && (window.clearInterval(this.stabilizedTimeoutID), this.stabilizedTimeoutID = null)
        }, C.sendStabilized = function(e) {
            this.stopStabilizedTimer(), this.limits.onStabilized(), this._isCameraMoving = !1, this.renderer.cameraStabilized(e)
        }, C.getPosFromTargetAndZoom = function(e, t, i) {
            var n = new d(e.lon, e.lat, 0),
                r = _.computeDistanceFromZoom(this.renderer.conf, t),
                o = this.getCameraToTarget();
            i && (o.x = 0, o.y = 0, o.z = r);
            var a = _.convertVectorToSpherical(o);
            return a.r = r, this.limits.clampSphericalTargetToCamera(a), (new d).copy(_.convertSphericalToXYZ(a)).addSelf(n)
        }, C.getDistance = function() {
            var e = this.getTarget().distanceTo(this.getPosition());
            return 0 == e && (console.log("this.getTarget()", this.getTarget()), console.log("this.getPosition()", this.getPosition())), e
        }, C.getTargetToCamera = function(e) {
            var t = this.getTarget().clone().subSelf(this.getPosition());
            return null != e && e && t.normalize(), 0 === t.lengthSq() && (console.log("this.getTarget().clone()", this.getTarget().clone()), console.log("this.getPosition()", this.getPosition())), t
        }, C.getCameraToTarget = function(e) {
            return this.getTargetToCamera(e).negate()
        }, C.getMoveFactor = function() {
            return .25 + this.getDistance() * this.renderer.conf.get("camera.moveSpeed")
        }, C.normalizeScreenPos = function(e, t) {
            var i = t ? t.width : this._width,
                n = t ? t.height : this._height;
            return this.renderer.map.getDepthMap() || this.renderer.map.getSideBySide() ? (e.x > .5 * i && (e.x -= .5 * i), i *= .5) : this.renderer.map.getTopToBottom() && (e.y > .5 * n && (e.y -= .5 * n), n *= .5), this.renderer.map.getSideBySide() && (n *= .5), (void 0 == i || null == i) && console.error("width is undefined for normalizeScreenPos", this._width), (void 0 == n || null == n) && console.error("height is undefined for normalizeScreenPos", this._height), e.x = e.x / (.5 * i) - 1, e.y = (n - e.y) / (.5 * n) - 1, e
        }, C.setInertiaInitialSpeed = function(e) {
            this.resetInertiaInitialSpeed(), this._inertiaInitialSpeed = e, this._inertiaInitialSpeedResetTimeout = setTimeout(o.bind(this.resetInertiaInitialSpeed, this), this.renderer.conf.get("camera.inertiaDelay"))
        }, C.resetInertiaInitialSpeed = function() {
            this._inertiaInitialSpeed = null, this._inertiaInitialSpeedResetTimeout && (clearTimeout(this._inertiaInitialSpeedResetTimeout), this._inertiaInitialSpeedResetTimeout = null)
        }, C.startInertia = function(e) {
            this.changeModeOnRotate = 0, this.stopInertia(), this._inertiaInitialSpeed && (this._inertiaSpeed = this._inertiaInitialSpeed, this._inertiaInitialTimeout = setTimeout(o.bind(this.inertiaStep, this, e), this.renderer.conf.get("camera.inertiaDelay")))
        }, C.inertiaStep = function(e) {
            var t = this._inertiaSpeed;
            t && t.length() > this.renderer.conf.get("camera.inertiaMinSpeed") && this.limits.clampTargetMove(t) ? (this.addTargetAndPosition(t, t), this.cameraUpdated(e), this._inertiaSpeed.multiplyScalar(this.renderer.conf.get("camera.inertiaFriction")), this._inertiaInitialTimeout = setTimeout(o.bind(this.inertiaStep, this, e), this.renderer.conf.get("camera.inertiaDelay"))) : this.stopInertia()
        }, C.stopInertia = function() {
            this._inertiaInitialTimeout && (this._inertiaSpeed = null, clearTimeout(this._inertiaInitialTimeout), this._inertiaInitialTimeout = null)
        }, C.getBounds = function(e) {
            var t = this.getVisibleGroundBoundingBox(e);
            return {
                xMin: o.min(o.pluck(t, "x")),
                xMax: o.max(o.pluck(t, "x")),
                yMin: o.min(o.pluck(t, "y")),
                yMax: o.max(o.pluck(t, "y"))
            }
        }, C.isMousePosInTheSky = function(e, t) {
            var i = this.renderer.clientXYToRelativeMapPosition(e, t);
            i = this.normalizeScreenPos(i);
            var n = this.computeIntersectAtZ(i, 0),
                r = this.getBounds();
            return n.x > r.xMax || n.x < r.xMin || n.y > r.yMax || n.y < r.yMin
        }, C.getRight = function(e) {
            var t = new d(this.camera.matrix.n11, this.camera.matrix.n21, this.camera.matrix.n31);
            return e && t.multiplyScalar(e), t
        }, C.storeStartMultiTouchPos = function(e) {
            null == this.startPos2D1 && e.length > 0 && (this.startPos2D1 = this.renderer.clientXYToRelativeMapPosition(e[0].clientX, e[0].clientY)), null == this.startPos2D2 && e.length > 1 && (this.startPos2D2 = this.renderer.clientXYToRelativeMapPosition(e[1].clientX, e[1].clientY))
        }, C.multitouchStart = function(e) {
            this.isTouching || (this.stopAnimation(), this.wasIn3dAtStartTouch = this.renderer.isIn3d(), this.isTouching = !0, this.startTouchZoom = this.renderer.conf.get("zoom"), this.currentDeltaInertia = new d(0, 0, 0), this.stopInertia(), this.storeStartMultiTouchPos(e), this.oldPos3D1 = null, this.oldPos3D2 = null, this.oldPos2D1 = null, this.oldPos2D2 = null, this.hasTouched = !1)
        }, C.multitouchMove = function(e, t) {
            this.storeStartMultiTouchPos(t);
            var i, n, r, o;
            if (e && t && this.isTouching && e.length > 0 && t.length > 0) {
                var a = this.getPosition().clone(),
                    s = this.getTarget().clone(),
                    l = this.renderer.clientXYToRelativeMapPosition(e[0].clientX, e[0].clientY);
                this.oldPos2D1 = l.clone();
                var h = this.computeLocationFromPixel(l);
                this.oldPos3D1 = h;
                var u = this.renderer.clientXYToRelativeMapPosition(t[0].clientX, t[0].clientY);
                this.newPos2D1 = u.clone();
                var c = this.computeLocationFromPixel(u);
                if (this.newPos3D1 = c.clone(), e.length > 1 && t.length > 1) {
                    var f = this.renderer.clientXYToRelativeMapPosition(e[1].clientX, e[1].clientY),
                        p = this.computeLocationFromPixel(f);
                    this.oldPos2D2 = f.clone(), this.oldPos3D2 = p;
                    var m = p.clone().subSelf(h),
                        g = this.renderer.clientXYToRelativeMapPosition(t[1].clientX, t[1].clientY),
                        v = this.computeLocationFromPixel(g);
                    if (this.newPos2D2 = g.clone(), this.newPos3D2 = v.clone(), null == this.currentMode) {
                        var y = this._selectCurrentTouchMode(l, f, u, g);
                        if (!y) return
                    }
                    if ("TransRotation" == this.currentMode) {
                        var b = this.renderer.isIn3d(),
                            x = v.clone().subSelf(c);
                        i = this.getCameraToTarget().clone();
                        var w = Math.atan2(x.y, x.x) - Math.atan2(m.y, m.x);
                        r = _.convertVectorToSpherical(i.clone()), r.phi -= w, this.wasIn3dAtStartTouch ? this.limits.clampSphericalTargetToCameraOnX(r, !0) : b ? this.limits.clampSphericalTargetToCamera(r) : this.limits.clampSphericalTargetToCameraOnXAndY(r), i = (new d).copy(_.convertSphericalToXYZ(r)), this.setTargetToCamera(i), c = this.computeLocationFromPixel(u), v = this.computeLocationFromPixel(g), n = c.clone().subSelf(h), this.subTargetAndPosition(n, n);
                        var M = v.clone().subSelf(c),
                            T = M.length();
                        if (0 != T) {
                            var S = this.computeLocationFromPixel(u);
                            i = this.getCameraToTarget();
                            var C = p.clone().subSelf(h),
                                E = C.length();
                            this.setTargetAndTargetToCamera(c, i);
                            var k = E / T;
                            o = i.length(), i.normalize(), i.multiplyScalar(o * k), this.setTargetToCamera(i);
                            var L = this.computeLocationFromPixel(u);
                            S.subSelf(L), this.addTargetAndPosition(S, S)
                        }
                    } else if ("RotationX" == this.currentMode) {
                        var P = u.clone().subSelf(l),
                            A = this.renderer.conf.get("multiTouch.rotationSpeedFactor"),
                            R = Math.abs(P.y) * A;
                        P.y > 0 && (R = -R), this.rotateOnX(R, !0);
                        var D = Math.abs(P.x) * A;
                        P.x > 0 && (D = -D), this.rotateOnZ(D)
                    }
                } else n = c.clone().subSelf(h), this.subTargetAndPosition(n, n);
                this._clampAndUpdateTouchCamera(s, a)
            }
        }, C._selectCurrentTouchMode = function(e, t, i, n) {
            var r = this.renderer.conf.get("multiTouch.rotationThreshold");
            if (this.startPos2D1.distanceTo(i) <= r && this.startPos2D2.distanceTo(n) <= r) return !1;
            var o = i.y - this.startPos2D1.y,
                a = n.y - this.startPos2D2.y,
                s = i.x - this.startPos2D1.x,
                l = n.x - this.startPos2D2.x;
            if (0 != o && 0 != a) {
                var h = 2;
                (this.renderer.isIn3d() || this.getZoom() > this.renderer.getMinZoomLayer2D()) && Math.abs(this.startPos2D2.y - this.startPos2D1.y) < 100 && (-h > o && -h > a || o > h && a > h || -h > s && -h > l || s > h && l > h) ? this.currentMode = "RotationX" : (i.clone().subSelf(e).length() > 0 || n.clone().subSelf(t).length() > 0) && (this.currentMode = "TransRotation")
            }
            return !0
        }, C._clampAndUpdateTouchCamera = function(e, t) {
            var i = this.getTarget().clone().subSelf(e),
                n = this.getPosition().clone().subSelf(t);
            this.setTargetAndPosition(e, t), this.limits.clampTargetAndCameraMove(i, n) && this.addTargetAndPosition(i, n);
            var r = this.getCameraToTarget(),
                o = _.convertVectorToSpherical(r.clone());
            this.wasIn3dAtStartTouch ? this.limits.clampSphericalTargetToCameraOnX(o, !0) : this.limits.clampSphericalTargetToCamera(o), r = (new d).copy(_.convertSphericalToXYZ(o)), this.setTargetToCamera(r), this.cameraUpdated(this.renderer.makeIdleEvent(!0)), i = this.getTarget().clone().subSelf(e), this.hasTouched = !0, this.currentDeltaInertia = i
        }, C.multitouchEnd = function() {
            function e() {
                t.renderer.isIn3d() && t.enter3d()
            }
            this.isTouching = !1, this.startPos2D1 = null, this.startPos2D2 = null, this.oldPos3D1 = null, this.oldPos3D2 = null, this.oldPos2D1 = null, this.oldPos2D2 = null, this.currentMode = null;
            var t = this;
            if (this.hasTouched) {
                var i = this.renderer.isIn3d(),
                    n = _.computeZoomFromDistance(this.renderer.conf, this.getDistance()),
                    r = n - this.startTouchZoom,
                    o = Math.abs(r) > .1,
                    a = o ? this.startTouchZoom > n : null;
                !i && o ? this.enter2d(a, e, this.renderer.makeIdleEvent(!0)) : !this.wasIn3dAtStartTouch && i ? this.enter3d(this.renderer.makeIdleEvent(!0)) : this.renderer.conf.get("zoom") == this.startTouchZoom && (this.setInertiaInitialSpeed(this.currentDeltaInertia), this.startInertia(this.renderer.makeIdleEvent(!0)))
            }
        }, C.getTarget = function() {
            return this.cameraTarget
        }, C.getPosition = function() {
            return this.camera.position
        }, C.setTarget = function(e) {
            this.cameraTarget.copy(e)
        }, C.setTargetAndTargetToCamera = function(e, t) {
            this.cameraTarget.copy(e), this.setTargetToCamera(t)
        }, C.subTargetAndPosition = function(e, t) {
            this.cameraTarget.subSelf(e), this.camera.position.subSelf(t), this.updateCameraMatrix()
        }, C.addTargetAndPosition = function(e, t) {
            this.cameraTarget.addSelf(e), this.camera.position.addSelf(t), this.updateCameraMatrix()
        }, C.setTargetAndPosition = function(e, t) {
            this.cameraTarget.copy(e), this.camera.position.copy(t), this.updateCameraMatrix(), this.renderer.forceRender()
        }, C.setTargetToCamera = function(e) {
            this.camera.position.add(this.getTarget(), e), this.updateCameraMatrix()
        }, C.computeRayForMap = function(e) {
            var t = new c(e.x / this._width * 2 - 1, 2 * -(e.y / this._height) + 1);
            this.computePickingRay(t)
        }, C.computePickingRay = function(e) {
            return this.camera.projectionMatrixInverse.getInverse(this.camera.projectionMatrix), this.projMatrix.multiply(this.camera.matrixWorld, this.camera.projectionMatrixInverse), this.ray.origin.set(e.x, e.y, -1), this.ray.direction.set(e.x, e.y, 1), this.projMatrix.multiplyVector3(this.ray.origin), this.projMatrix.multiplyVector3(this.ray.direction),
                this.ray.direction.subSelf(this.ray.origin).normalize(), this.ray
        }, C.getProjectionScreenMatrix = function() {
            var e = !1;
            this.renderer.map.elevation && (e = this.renderer.enableElevationMatrix());
            var t = this.camera.projScreenMatrix.clone();
            return t.width = this._width, t.height = this._height, this.renderer.map.elevation && !e && this.renderer.disableElevationMatrix(), t
        }, C.computeScreenPosInPixels = function(e) {
            var t = this.renderer.enableElevationMatrix(),
                i = e.clone();
            this.camera.projScreenMatrix.multiplyVector3(i), t || this.renderer.disableElevationMatrix();
            var n = (i.x + 1) * this._width / 2,
                r = (-i.y + 1) * this._height / 2;
            return new c(n, r)
        }, C.computeLocationFromPixel = function(e, t) {
            var i = {
                x: 2 * e.x / Math.max(this._width, 1) - 1,
                y: 1 - 2 * e.y / Math.max(this._height, 1)
            };
            return this.computeIntersectAtZ(i, t || 0)
        }, C.computeLocationFromPixelInTheSky = function(e, t, i) {
            var n = this.normalizeScreenPos(e, i),
                r = this.computeIntersectAtZ(n, t || 0),
                o = this.getVisibleGroundBoundingBox(i),
                a = o[0];
            n.x > 0 && (a = o[1]);
            var s = this.camera.far,
                l = r.clone().subSelf(a),
                h = l.length(),
                u = this.getTargetToCamera().normalize(),
                d = l.dot(u),
                c = h > s,
                f = -.1 > d;
            return (c || f) && (c && l.setLength(s), r = f ? a.subSelf(l) : a.addSelf(l)), r
        }, C.updateCameraHeight = function() {
            var e = this.getPosition(),
                t = this.getTarget(),
                i = this.renderer.findHeight(t),
                n = this.renderer.findHeight(e);
            null != i && (this.wantedPositionHeight = this.wantedTargetHeight = i), this.currentPositionHeight = this.currentTargetHeight = f.lerp(this.currentTargetHeight, this.wantedTargetHeight, .3);
            var r = 0;
            null != n && (r = n);
            var o = r + this.renderer.conf.get("camera.minZ");
            this.camera.position.z + this.currentPositionHeight < o && (this.currentTargetHeight = this.currentPositionHeight = o - this.camera.position.z)
        }, C.setCameraElevations = function() {
            0 == this.cameraElevation && this.renderer.isIn3d() && this.renderer.map.elevation && (this.cameraElevation = !0, this.renderer.conf.get("camera.elevationCameraHeight") && (this.camera.position.z += this.currentPositionHeight, this.cameraTarget.z += this.currentTargetHeight, this.updateCameraMatrix()))
        }, C.unsetCameraElevations = function() {
            1 == this.cameraElevation && this.renderer.isIn3d() && this.renderer.map.elevation && (this.cameraElevation = !1, this.renderer.conf.get("camera.elevationCameraHeight") && (this.camera.position.z -= this.currentPositionHeight, this.cameraTarget.z -= this.currentTargetHeight, this.updateCameraMatrix()))
        }, C.computeIntersectAtZ = function(e, t) {
            var i = this.computePickingRay(e),
                n = i.direction,
                r = i.origin.clone(),
                o = (t - i.origin.z) / n.z,
                a = n.multiplyScalar(o);
            return r.addSelf(a)
        }, C.getVisibleWidthAtTarget = function() {
            var e = this.computeIntersectAtZ(new c(-1, 0), 0),
                t = this.computeIntersectAtZ(new c(1, 0), 0);
            return t.subSelf(e).length()
        }, C.getVisibleGroundBoundingBox = function(e) {
            return this.renderer.map.elevation && this.renderer.isIn3d() ? this.computeVisibleGroundBoundingBoxElevation(e) : this.computeVisibleBoundingBoxAtHeight(e, 0), this.visibleBoundingBox
        }, C.computeVisibleGroundBoundingBoxElevation = function(e) {
            var t = this.cameraElevation;
            0 == t && this.setCameraElevations();
            var i = Math.min(this.currentTargetHeight, this.currentPositionHeight);
            this.computeVisibleBoundingBoxAtHeight(e, i), !t && this.cameraElevation && this.unsetCameraElevations()
        }, C.computeVisibleBoundingBoxAtHeight = function(e, t) {
            var i = [new c(-1, -1), new c(1, -1)],
                n = [new c(-1, 1), new c(1, 1)];
            this.visibleBoundingBox.length = 0;
            var r, o;
            for (o = 0; o < i.length; ++o) r = this.computeIntersectAtZ(i[o], t), this.visibleBoundingBox.push(r);
            var a = this.camera.far;
            null != e && (a = Math.min(a, e));
            var s = this.getTargetToCamera();
            for (o = 0; o < n.length; ++o) {
                var l = this.computeIntersectAtZ(n[o], 0);
                r = this.visibleBoundingBox[o].clone();
                var h = l.clone().subSelf(r),
                    u = h.length(),
                    d = h.dot(s);
                (u > a || 0 > d) && (h.setLength(a), l = 0 > d ? r.subSelf(h) : r.addSelf(h)), this.visibleBoundingBox.push(l)
            }
            var f = this.visibleBoundingBox[2];
            this.visibleBoundingBox[2] = this.visibleBoundingBox[3], this.visibleBoundingBox[3] = f
        }, C.getCameraConfiguration = function(e, t, i) {
            var n = e.clone().subSelf(t),
                o = _.convertVectorToSpherical(n);
            0 == o.r && (console.log("targetToCamera", n), console.log("position.clone()", e.clone()), console.log("target", t));
            var a = {
                lon: Math.round(t.x),
                lat: Math.round(t.y),
                zoom: _.computeRoundZoomFromDistance(this.renderer.conf, o.r),
                "3d": this.renderer.conf.get("3d")
            };
            return (this.renderer.isIn3d() || i) && (i && this.limits.clampSphericalTargetToCamera(o), a.camera = {
                theta: r(f.radToDeg(o.theta)),
                phi: r(f.radToDeg(o.phi))
            }), a
        }, C.onConfigChange = function() {
            this.setCameraConfig(this.getCameraConfigFromConfiguration())
        }, C.getCurrentCameraConfiguration = function() {
            return this.getCameraConfiguration(this.getPosition(), this.getTarget(), !0)
        }, C.updateConfig = function(e) {
            var t = e.lon,
                i = e.lat;
            delete e.lon, delete e.lat, this.renderer.conf.setLonLat90013({
                lon: t,
                lat: i
            }), this.renderer.conf.setCurrentValues(e)
        }, C.stopAnimation = function() {
            var e = this._cameraAnimator.hasAnimation();
            e && (this._cameraAnimator.mustUpdate2d3dOnStop() && this.update2dTo3dWithoutAnim(), this._cameraAnimator.stop()), this._isCameraOrbiting = !1
        }, C.startAnimation = function(e) {
            this.stopAnimation(), this._cameraAnimator.start(e)
        }, C.pauseAnimation = function(e) {
            this._cameraAnimator.pause(e)
        }, C.toggleOrbitTarget = function(e) {
            this._isCameraOrbiting ? this.stopAnimation() : this.orbitTarget(e)
        }, C.orbitTarget = function(e) {
            if (this.renderer.isIn3d()) {
                e = o.defaults(e || {}, {
                    durationInMS: 1e4,
                    direction: 1,
                    steps: 128
                });
                for (var t = this.cameraTarget, i = this.camera.position, n = t.x - i.x, r = t.y - i.y, a = Math.sqrt(n * n + r * r), s = Math.atan2(-r, -n), l = [], u = 0; u <= e.steps; u++) {
                    var d = s + e.direction * u * 2 * Math.PI / e.steps,
                        c = t.x + a * Math.cos(d),
                        f = t.y + a * Math.sin(d);
                    l.push({
                        camPos: new h.Vector3(c, f, i.z),
                        camTarget: new h.Vector3(t.x, t.y, t.z)
                    })
                }
                this.startAnimation(o.defaults(o.extend({
                    posAndTargetList: l
                }, e), {
                    durationInMS: e.durationInMS,
                    forceLastPointOnAbort: !1,
                    easing: "linear",
                    repeat: !0
                })), this._isCameraOrbiting = !0
            }
        }, C.followLine = function(e, t) {
            t = t || {};
            var i = this.renderer.getEngineHelpers();
            this.renderer.map.setOptions({
                "3d": !0
            });
            var n, r = t.distance || 2e3,
                a = t.cameraZ || 580,
                s = e.getArray(),
                l = o.map(s, function(e) {
                    var t = e._to900913(),
                        l = t.lon,
                        h = t.lat,
                        u = {
                            x: 0,
                            y: 0
                        };
                    if (n) u.x = n.x - l, u.y = n.y - h;
                    else {
                        var d = o.clone(s[1])._to900913();
                        u.x = l - d.lon, u.y = h - d.lat
                    }
                    var c = Math.abs(u.x) + Math.abs(u.y);
                    1 > c && (c = 1), u.x = u.x * r / c, u.y = u.y * r / c;
                    var f = {
                        camPos: new i.Vector3(l + u.x, h + u.y, a),
                        camTarget: new i.Vector3(l, h, 0)
                    };
                    return n = {
                        x: l,
                        y: h
                    }, f
                });
            this.startAnimation(o.defaults(o.extend({
                posAndTargetList: l
            }, t), {
                moveSpeed: .5,
                forceLastPointOnAbort: !1,
                easing: "linear",
                enableWorkOnMove: !0
            }))
        }, C.elevationChanged = function(e) {
            this.rebuildLimits(), e ? this.updateCameraHeight() : this.currentPositionHeight = 0
        }, C.rebuildLimits = function() {
            this.limits.rebuildLimits()
        }, C.onDivRemoved = function() {
            this.stopStabilizedTimer(), this.renderer.conf.removeListener("historyChange", this._onConfigChangeHandler), this.renderer.map.removeListener("elevation", this._updateMinFarHandler), this.renderer.conf.removeListener("change:3d", this._update2dTo3dHandler), this._cameraAnimator.onDivRemoved(), this.limits.onDivRemoved(), this.controller.onDivRemoved(), this.stopInertia(), delete this._onConfigChangeHandler, delete this._updateMinFarHandler, delete this._update2dTo3dHandler, delete this.controller, delete this.renderer, delete this.limits, delete this._cameraAnimator
        }
    }, {
        "../../utils/LocationHelper": 407,
        "./CameraAnimator": 328,
        "./CameraController": 329,
        "./CameraHelper": 330,
        "./CameraLimits": 331,
        engine: 10,
        events: 99,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    333: [function(e, t, i) {
        "use strict";

        function n() {
            var e = {
                modelHeight: 11,
                maxDistance: d
            };
            return o.isChristmasTime() ? r.extend(e, {
                model: a("data/models/Lib_Object/LibOut_Snowman.bis"),
                texture: a("data/textures/LibOut_Snowman.jpg"),
                doubleSided: !0
            }) : r.extend(e, {
                model: a("data/models/Lib_Object/Venus.bis"),
                texture: a("data/textures/LibOut_PackedTexture.png")
            }), e
        }
        var r = e("underscore"),
            o = e("../../utils/Christmas"),
            a = e("../../utils/StaticFileResolver"),
            s = ["#75824a", "#7aa768", "#5d8a4c", "#7c7b47"],
            l = 4e3,
            h = 3e3,
            u = 2e3,
            d = 1e3,
            c = 14540253,
            f = {
                model: a("data/models/Lib_Object/LibOut_CherryTree.bis"),
                modelHeight: 5,
                minRandomHeight: 6,
                maxRandomHeight: 15
            };
        t.exports = {
            commonVehicleColor: c,
            tree: {
                deciduous: {
                    model: a("data/models/Lib_Object/LibOut_Deciduous_00.bis"),
                    texture: a("data/textures/LibOut_Deciduous_00.png"),
                    lodModel: a("data/models/Lib_Object/LibOut_Deciduous_LOD.bis")
                },
                palm: {
                    model: a("data/models/Lib_Object/LibOut_Palm_00.bis"),
                    texture: a("data/textures/LibOut_Palm_00.png"),
                    lodModel: a("data/models/Lib_Object/LibOut_Palm_LOD.bis")
                },
                coniferous: {
                    model: a("data/models/Lib_Object/LibOut_Conifer_00.bis"),
                    texture: a("data/textures/LibOut_Conifer_00.png"),
                    lodModel: a("data/models/Lib_Object/LibOut_Conifer_LOD.bis")
                },
                xmas: {
                    model: a("data/models/Lib_Object/LibOut_Conifer_Xmas.bis"),
                    texture: a("data/textures/LibOut_Conifer_Xmas.png"),
                    lodModel: a("data/models/Lib_Object/LibOut_Conifer_Xmas_LOD.bis"),
                    lodTexture: a("data/textures/LibOut_Conifer_Xmas_LOD.png"),
                    colors: ["#fff"]
                },
                xmasWithSnow: {
                    model: a("data/models/Lib_Object/LibOut_Conifer_Xmas_Snow.bis"),
                    texture: a("data/textures/LibOut_Conifer_Xmas_Snow.png"),
                    lodModel: a("data/models/Lib_Object/LibOut_Conifer_Xmas_Snow_LOD.bis"),
                    lodTexture: a("data/textures/LibOut_Conifer_Xmas_LOD.png"),
                    colors: ["#fff"]
                },
                cherry: r.defaults({
                    texture: a("data/textures/LibOut_CherryTree_Leaves.png"),
                    colors: ["#fff"].concat(s)
                }, f),
                "pink-cherry": r.defaults({
                    texture: a("data/textures/LibOut_CherryTree_Flowers.png"),
                    colors: ["#fff"]
                }, f),
                "white-cherry": r.defaults({
                    texture: a("data/textures/LibOut_CherryTree_WhiteFlowers.png"),
                    colors: ["#fff"]
                }, f),
                lodTexture: a("data/textures/LibOut_Tree_LOD.png"),
                colors: s,
                modelHeight: 10,
                minRandomHeight: 10,
                maxRandomHeight: 12
            },
            scrub: {
                model: a("data/models/Lib_Object/LibOut_Bush_00.bis"),
                texture: a("data/textures/LibOut_PackedTexture.png"),
                colors: s,
                maxDistance: h
            },
            wind_generator: {
                modelHeight: 50,
                model: a("data/models/Lib_Object/WindGenerator.bis"),
                color: 14540253,
                maxDistance: l
            },
            petroleum_well: {
                modelHeight: 20,
                model: a("data/models/Lib_Object/LibOut_PetroleumWell.bis"),
                color: 8947848,
                maxDistance: l
            },
            boat: {
                model: a("data/models/Lib_Object/LibOut_Boat.bis"),
                color: c,
                speedInMPerMs: 3 / 360,
                width: 20,
                minLength: 250,
                spacing: 1e3,
                maxDistance: l
            },
            submarine: {
                model: a("data/models/Lib_Object/LibOut_SubMarine.bis"),
                color: c,
                speedInMPerMs: 3 / 360,
                width: 20,
                alwaysOneWay: !0,
                baseAnimAdvancement: 0,
                count: function(e) {
                    var t = e[0].distanceTo(e[e.length - 1]);
                    return t > 500 && Math.random() > .99 ? 1 : 0
                },
                z: function(e, t, i) {
                    return 0 == t || t == i.length - 1 ? -5 : 0
                },
                handleRenderPass: {
                    reflect: !1
                },
                maxDistance: l
            },
            car: {
                model: a("data/models/Lib_Object/LibOut_Car_A.bis"),
                color: c,
                speedInMPerMs: 50 / 3600,
                width: 5,
                minLength: 20,
                spacing: 20,
                rightLaneSpeedRatio: .8,
                perOsmTag: {
                    highway: {
                        primary: {
                            spacing: 30
                        },
                        secondary: {
                            spacing: 50
                        },
                        tertiary: {
                            spacing: 70
                        },
                        motorway_link: {
                            spacing: 40,
                            speedInMPerMs: .025
                        },
                        motorway: {
                            spacing: 25,
                            speedInMPerMs: 130 / 3600
                        },
                        trunk_link: {
                            spacing: 60,
                            speedInMPerMs: .025
                        },
                        trunk: {
                            spacing: 40,
                            speedInMPerMs: 110 / 3600
                        },
                        residential: {
                            spacing: 300
                        },
                        unclassified: {
                            minLength: 300,
                            spacing: 400
                        },
                        raceway: {
                            minLength: 300,
                            spacing: 500,
                            speedInMPerMs: 350 / 3600
                        }
                    }
                },
                maxDistance: h
            },
            bus: {
                model: a("data/models/Lib_Object/LibOut_Bus_A.bis"),
                color: c,
                speedInMPerMs: 50 / 3600,
                width: 5,
                minLength: 100,
                spacing: 2e3,
                maxDistance: h
            },
            plane: {
                model: a("data/models/Lib_Object/LibOut_Plane.bis"),
                color: c,
                speedInMPerMs: 50 / 3600,
                width: 5,
                minLength: 100,
                spacing: 2e3,
                maxDistance: l
            },
            crane: {
                model: a("data/models/Lib_Object/LibOut_Grue.bis"),
                texture: a("data/textures/LibOut_Grue.png"),
                maxDistance: l
            },
            sculpture: n(),
            rock: {
                model: a("data/models/Lib_Object/LibOut_Rock.bis"),
                texture: a("data/textures/LibOut_Rock.jpg"),
                modelHeight: 5,
                maxDistance: d
            },
            street_lamp: {
                modelHeight: 5.5,
                color: 2236962,
                model: a("data/models/Lib_Object/LibOut_StreetLamp_00.bis")
            },
            flag: {
                allowTexture: !1,
                model: a("data/models/Lib_Object/LibOut_Flag.bis"),
                texture: a("data/textures/LibOut_Flag.jpg"),
                modelHeight: 20,
                maxDistance: d
            },
            fountain: {
                large: {
                    height: 60,
                    particleMaxLife: 6,
                    spreadingFactor: 10,
                    particleSize: 12500,
                    particleCount: 4e3,
                    maxDistance: l
                },
                small: {
                    height: 8,
                    particleMaxLife: 2.75,
                    spreadingFactor: 3,
                    particleSize: 2500,
                    particleCount: 400,
                    maxDistance: d
                },
                verySmall: {
                    height: 1,
                    particleMaxLife: .8,
                    spreadingFactor: .7,
                    particleSize: 1e3,
                    particleCount: 400,
                    maxDistance: d
                }
            },
            smoke: {
                particleCount: 300,
                small: {
                    heightScale: 1,
                    particleMaxLife: 20,
                    particleSizes: [16e3, 4e4],
                    spreadingfactor: 40,
                    direction: [5, 5, 25],
                    emiterScale: 3
                },
                large: {
                    heightScale: .9,
                    particleMaxLife: 30,
                    particleSizes: [8e4, 16e4],
                    spreadingfactor: 75,
                    direction: [10, 10, 50],
                    emiterScale: 75
                },
                maxDistance: d
            },
            barrier: {
                wallColor: null,
                defaultWallColor: 14540253,
                hedgeColor: 4940580,
                fenceTexture: a("data/textures/Fence.png"),
                maxDistance: u
            },
            vineyard: {
                color: 7701066
            },
            power_line: {
                color: 5592405,
                height: 50,
                width: 35,
                minorLineHeight: 15
            },
            power_pole: {
                model: a("data/models/Lib_Object/LibOut_PowerPole.bis"),
                color: 9731688
            },
            power_tower: {
                model: a("data/models/Lib_Object/LibOut_PowerTower.bis"),
                texture: a("data/textures/LibOut_PowerTower.png")
            },
            aerial_line: {
                lineColor: 5592405,
                lineHeight: 18,
                lineWidth: 10,
                cableCar: {
                    model: a("data/models/Lib_Object/LibOut_SkiTelepherique.bis"),
                    texture: a("data/textures/LibOut_SkiTelepherique.jpg"),
                    speedInMPerMs: 5 / 360,
                    fixedCount: 1
                },
                chairLift: {
                    model: a("data/models/Lib_Object/LibOut_SkiTelesiege.bis"),
                    texture: a("data/textures/LibOut_SkiTelesiege.jpg"),
                    speedInMPerMs: 2 / 360,
                    spacing: 30
                },
                gondola: {
                    model: a("data/models/Lib_Object/LibOut_SkiOeuf.bis"),
                    texture: a("data/textures/LibOut_SkiOeuf.jpg"),
                    speedInMPerMs: 3 / 360,
                    spacing: 60
                },
                maxDistance: l
            },
            aerial_pylon: {
                model: a("data/models/Lib_Object/LibOut_SkiPylon.bis"),
                texture: a("data/textures/LibOut_PackedTexture.png")
            },
            lighthouse: {
                modelHeight: 24,
                model: a("data/models/Lib_Object/Lighthouse.bis"),
                texture: a("data/textures/LibOut_PackedTexture.png")
            },
            cemetery: {
                model: a("data/models/Lib_Object/LibOut_Grave.bis"),
                colors: [8947848, 8879984, 8292224, 11250603, 11579044, 6513507],
                maxDistance: l
            }
        }
    }, {
        "../../utils/Christmas": 399,
        "../../utils/StaticFileResolver": 410,
        underscore: 207
    }],
    334: [function(e, t, i) {
        "use strict";
        t.exports = {
            FOUNTAIN: "fountain",
            SCULPTURE: "sculpture",
            ROCK: "rock",
            STREET_LAMP: "street_lamp",
            BARRIER: "barrier",
            FENCE: "fence",
            WIND_GENERATOR: "wind_generator",
            PETROLEUM_WELL: "petroleum_well",
            POWER_LINE: "power_line",
            POWER_POLE: "power_pole",
            POWER_TOWER: "power_tower",
            LIGHTHOUSE: "lighthouse",
            BOAT: "boat",
            SUBMARINE: "submarine",
            CAR: "car",
            BUS: "bus",
            FLAG: "flag",
            AERIAl_LINE: "aerial_line",
            AERIAl_PYLON: "aerial_pylon",
            CRANE: "crane",
            SCRUB: "scrub",
            CEMETERY: "cemetery",
            TREE: "tree",
            VINEYARD: "vineyard"
        }
    }, {}],
    335: [function(e, t, i) {
        "use strict";

        function n() {}
        var r = e("./DetailsCategories");
        t.exports = n, n.prototype.updateElevations = function(e, t, i) {
            e == r.CRANE ? this._updateAnimatedDetail(t, i) : e == r.FLAG ? this._updateAnimatedDetail(t, i) : e == r.WIND_GENERATOR ? this._updateAnimatedDetail(t, i) : e == r.PETROLEUM_WELL ? this._updateAnimatedDetail(t, i) : e == r.CEMETERY ? this._updateMultiPointSkinnedDetail(t, i) : e == r.ROCK ? this._updateMultiPointSkinnedDetail(t, i) : e == r.STREET_LAMP && this._updateMultiPointSkinnedDetail(t, i)
        }, n.prototype._updateAnimatedDetail = function(e, t) {
            var i = t.conf.get("details.animPacking");
            if (i && e.meshs)
                for (var n = 0; n < e.meshs.length; n++)
                    for (var r = e.meshs[n], o = r.position, a = r.skeleton, s = a.animations[0], l = s.numberOfMatrices / s.animationData.length, h = 0; h < a.bones.length; h++) {
                        var u = a.bones[h],
                            d = Math.floor(h / l),
                            c = h % l;
                        if (-1 == u.parentIndex)
                            for (var f = s.animationData[d].animation, p = u.matrix.getPosition(), m = {
                                    x: p.x + o.x,
                                    y: p.y + o.y
                                }, g = t.findHeight(m), _ = 0; _ < f.keys.length; _++) {
                                var v = f.keys[_],
                                    y = v.matrixList[c];
                                p.z = g, y.setPosition(p)
                            }
                    }
        }, n.prototype._updateMultiPointSkinnedDetail = function(e, t) {
            if (e.meshs)
                for (var i = 0; i < e.meshs.length; i++) {
                    for (var n = e.meshs[i], r = n.position, o = n.miniSkinQuat, a = 0; a < o.length; a++) {
                        var s = o[a],
                            l = {
                                x: s.x + r.x,
                                y: s.y + r.y
                            },
                            h = t.findHeight(l);
                        s.z = h
                    }
                    n.updateSkeleton()
                }
        }
    }, {
        "./DetailsCategories": 334
    }],
    336: [function(e, t, i) {
        "use strict";
        var n = e("./DetailsCategories"),
            r = t.exports = {};
        r[n.FOUNTAIN] = {
            $or: {
                amenity: "fountain",
                natural: "geyser"
            }
        }, r[n.SCRUB] = {
            $or: {
                natural: ["heath", "scrub"],
                landuse: "plant_nursery"
            }
        }, r[n.TREE] = {
            $or: {
                landuse: ["forest", "orchard"],
                natural: ["tree", "wood", "tree_row"],
                "xmas:feature": "tree"
            }
        }, r[n.ROCK] = {
            $or: {
                megalith_type: !0,
                natural: "stone"
            }
        }, r[n.VINEYARD] = {
            landuse: "vineyard"
        }, r[n.SCULPTURE] = {
            $or: {
                monument: "statue",
                artwork_type: ["sculpture", "statue"],
                "artwork:type": ["sculpture", "statue"]
            }
        }, r[n.STREET_LAMP] = {
            highway: "street_lamp"
        }, r[n.FLAG] = {
            $or: {
                golf: ["pin", "hole"],
                man_made: "flagpole"
            }
        }, r[n.BARRIER] = {
            $and: {
                building: !1,
                barrier: ["hedge", "wall", "city_wall", "retaining_wall"]
            }
        }, r[n.FENCE] = {
            $and: {
                building: !1,
                barrier: ["fence", "gate"]
            }
        }, r[n.WIND_GENERATOR] = {
            $and: {
                power: "generator",
                "generator:source": "wind"
            }
        }, r[n.PETROLEUM_WELL] = {
            man_made: "petroleum_well"
        }, r[n.CRANE] = {
            $or: {
                landuse: ["construction", "brownfield"],
                man_made: "crane"
            }
        }, r[n.POWER_LINE] = {
            $and: {
                power: ["line", "minor_line"],
                tunnel: !1,
                location: !1
            }
        }, r[n.POWER_POLE] = {
            power: "pole"
        }, r[n.POWER_TOWER] = {
            power: "tower"
        }, r[n.AERIAl_PYLON] = {
            aerialway: "pylon"
        }, r[n.AERIAl_LINE] = {
            aerialway: ["cable_car", "j-bar", "t-bar", "platter", "drag_lift", "gondola", "chair_lift", "mixed_lift"]
        }, r[n.LIGHTHOUSE] = {
            man_made: "lighthouse"
        }, r[n.CEMETERY] = {
            $or: {
                landuse: "cemetery",
                amenity: "grave_yard"
            }
        }, r[n.BOAT] = {
            $or: {
                $and: {
                    waterway: ["river", "canal"],
                    boat: ["yes", "designated", "permissive"],
                    tunnel: !1
                },
                route: ["ferry", "boat"]
            }
        }, r[n.SUBMARINE] = {
            $or: {
                $and: {
                    waterway: ["river", "canal"],
                    boat: ["yes", "designated", "permissive"],
                    tunnel: !1
                },
                route: "ferry"
            }
        }, r[n.CAR] = {
            highway: ["primary", "secondary", "tertiary", "motorway_link", "motorway", "trunk_link", "trunk", "residential", "raceway", "unclassified"],
            tunnel: !1
        }, r[n.BUS] = {
            route: "bus",
            tunnel: !1
        }
    }, {
        "./DetailsCategories": 334
    }],
    337: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            return t in e ? Object.defineProperty(e, t, {
                value: i,
                enumerable: !0,
                configurable: !0,
                writable: !0
            }) : e[t] = i, e
        }

        function r(e, t) {
            var i, r = this;
            this.options = e, t = t || {}, this.tileExclusionZones = this.options.useExclusionZones ? t : {}, this._combinedExclusionZones = {
                _allTiles: []
            }, this._itemGenerators = (i = {}, n(i, U.FOUNTAIN, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateFountain(t, i, n)
            }), n(i, U.SCULPTURE, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._commonGeneratePoint(t, i, {
                    allowRotation: !0,
                    modelHeight: r.options.sculpture.modelHeight,
                    userData: null,
                    tileKey: n
                })
            }), n(i, U.WIND_GENERATOR, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._commonGeneratePoint(t, i, {
                    allowRotation: !1,
                    modelHeight: r.options.wind_generator.modelHeight,
                    userData: null,
                    tileKey: n
                })
            }), n(i, U.STREET_LAMP, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._commonGeneratePoint(t, i, {
                    allowRotation: !1,
                    modelHeight: r.options.street_lamp.modelHeight,
                    userData: null,
                    tileKey: n
                })
            }), n(i, U.PETROLEUM_WELL, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._commonGeneratePoint(t, i, {
                    allowRotation: !0,
                    modelHeight: r.options.petroleum_well.modelHeight,
                    userData: null,
                    tileKey: n
                })
            }), n(i, U.VINEYARD, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators;
                r._generateVineyard(t, i, n)
            }), n(i, U.FLAG, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateFlag(t, i, n)
            }), n(i, U.BARRIER, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators,
                    o = e.tileKey;
                r._generateBarrier(t, i, n, o)
            }), n(i, U.FENCE, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators,
                    o = e.tileKey;
                r._generateFence(t, i, n, o)
            }), n(i, U.POWER_LINE, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators,
                    o = e.tileKey;
                r._generatePowerLine(t, i, n, o)
            }), n(i, U.POWER_POLE, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generatePointNoZ(t, i, n)
            }), n(i, U.POWER_TOWER, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generatePointNoZ(t, i, n)
            }), n(i, U.AERIAl_LINE, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators,
                    o = e.tileKey;
                r._generateAerialLine(t, i, n, o)
            }), n(i, U.AERIAl_PYLON, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generatePointNoZ(t, i, n)
            }), n(i, U.LIGHTHOUSE, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators,
                    o = e.tileKey;
                r._generateLightHouse(t, i, n, o)
            }), n(i, U.BOAT, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators;
                L(t, i, n, r.options.boat)
            }), n(i, U.SUBMARINE, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators;
                L(t, i, n, r.options.submarine)
            }), n(i, U.CAR, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators;
                L(t, i, n, r.options.car)
            }), n(i, U.BUS, function(e) {
                var t = e.renderer,
                    i = e.osmData,
                    n = e.generators;
                L(t, i, n, r.options.bus)
            }), n(i, U.ROCK, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateRock(t, i, n)
            }), n(i, U.TREE, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateForest(t, i, n)
            }), n(i, U.SCRUB, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateScrub(t, i, n)
            }), n(i, U.CRANE, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateCrane(t, i, n)
            }), n(i, U.CEMETERY, function(e) {
                var t = e.osmData,
                    i = e.generators,
                    n = e.tileKey;
                r._generateCemetery(t, i, n)
            }), i)
        }

        function o(e) {
            if (e.crown_type) {
                if ("I" == e.crown_type) return "palm";
                if ("A" == e.crown_type || "B" == e.crown_type) return "deciduous";
                if ("H" == e.crown_type) return "coniferous"
            }
            return null
        }

        function a(e) {
            return "tree" == e["xmas:feature"] ? "xmas" : null
        }

        function s(e) {
            var t = h(e);
            return /prunus (japonica|serrulata|prostrata)/i.test(t) ? l(e) ? "pink-cherry" : "cherry" : /prunus (cerasus|avium|padus|serotina|mahaleb|virginiana)/i.test(t) ? l(e) ? "white-cherry" : "cherry" : null
        }

        function l(e) {
            var t = e.pos.y,
                i = void 0;
            if (t > 7361866) return !1;
            if (t > 3503549) {
                var n = 6446275,
                    r = 3503549;
                i = 4 * (t - r) / (n - r)
            } else {
                if (t > -2273030) return !0;
                if (!(-6446275 > t)) return !1;
                var o = -2273030,
                    a = -6446275;
                i = -6 * t + (5 + 6 * o) / (o - a)
            }
            i = Math.ceil(i);
            var s = (new Date).getMonth();
            return Math.abs(s - i) <= 1
        }

        function h(e) {
            return P.compact([e.species, e.taxon, e.genus]).join(" ")
        }

        function u(e) {
            if (e.type) {
                if ("broad_leaved" == e.type || "deciduous" == e.type) return "deciduous";
                if ("conifer" == e.type || "coniferous" == e.type) return "coniferous";
                if ("palm" == e.type) return "palm"
            }
            return null
        }

        function d(e) {
            return !e.wood || "deciduous" != e.wood && "coniferous" != e.wood && "palm" != e.wood ? "coniferous" == e.trees ? "coniferous" : e.trees && -1 != e.trees.indexOf("palm") ? "palm" : e.species && -1 != e.species.indexOf("palm") ? "palm" : /Arecaceae/i.test(h(e)) ? "palm" : null : e.wood
        }

        function c(e) {
            if (e.leaf_type) {
                if ("needleleaved" == e.leaf_type) return "coniferous";
                if ("broadleaved" == e.leaf_type) return "deciduous"
            }
            return null
        }

        function f(e) {
            return a(e) || s(e) || o(e) || u(e) || d(e) || c(e)
        }

        function p(e) {
            var t = Math.abs(e);
            return 2632018.6372200437 > t ? Math.random() > .7 ? "palm" : "deciduous" : Math.random() > .6 ? "coniferous" : "deciduous"
        }

        function m(e, t, i) {
            return W.parseShape(e.geojsonGeometry, i, !0)
        }

        function g(e, t, i) {
            return e.map.elevation ? e.findHeight({
                x: t,
                y: i
            }) : 0
        }

        function _(e, t, i, n) {
            for (var r = 0; r < t.length; ++r) {
                var o = t[r];
                o.z = o.z || 0, o.z += n + g(e, i.x + o.x, i.y + o.y)
            }
        }

        function v(e, t, i, n, r) {
            var o = i.shapePosition,
                a = i.shapePts,
                s = n.width,
                l = n.minHeight,
                h = n.height,
                u = a[0].equals(a[a.length - 1]),
                d = z.offsetPointsList(a, s, u);
            z.setPtsListHeight(d.rightPts, l + h), z.setPtsListHeight(d.leftPts, l + h), e.map.elevation && (_(e, d.rightPts, o, 0), _(e, d.leftPts, o, 0)), H.triangulateOffsetPointsList(t, d.rightPts, d.leftPts, r, u), d.leftPts.reverse(), u || (d.leftPts.push(d.rightPts[0]), d.rightPts.push(d.leftPts[0]));
            var c = {
                minHeight: l,
                height: h,
                color: r,
                closed: u,
                repeatUv: !1,
                normalSmoothing: !1
            };
            H.extrudeWall(t, d.leftPts, c), H.extrudeWall(t, d.rightPts, c)
        }

        function y(e, t, i, n) {
            var r = m(e, !0);
            if (r && 0 != r.rings.length) {
                var o = e.bounds,
                    a = .5 * (o.right - o.left),
                    s = .5 * (o.top - o.bottom),
                    l = -s,
                    h = -a - 1,
                    u = {
                        startX: h,
                        startY: l,
                        endY: s,
                        xSamplingMin: t.x.min,
                        xSamplingMax: t.x.max,
                        ySamplingMin: t.y.min,
                        ySamplingMax: t.y.max
                    };
                z.sampleShape(r.rings, r.position, u, i, n)
            }
        }

        function b(e, t, i, n, r) {
            var o = m(e, !0);
            if (o && 0 != o.rings.length) {
                var a = e.bounds,
                    s = a.right - a.left,
                    l = a.top - a.bottom;
                s *= .5, l *= .5;
                for (var h = 0, u = 0; u < o.rings.length; ++u)
                    for (var d = o.rings[u], c = -l + t; l > c;) {
                        for (var f = new D(-s - 1, c), p = z.intersectShapeAlong("x", d, f); p.length > 1;) {
                            var g = p.pop(),
                                _ = p.pop(),
                                v = g.x - _.x;
                            if (v > i) {
                                var y = _.clone();
                                if (y.x += .5 * v, n(y.x + o.position.x, y.y + o.position.y), h++, r) return 1
                            }
                        }
                        c += t
                    }
                return h
            }
        }

        function x(e, t, i, n) {
            var r = {};
            return r.position = e, null != t && (r.rotation = t), null != i && (r.scale = i), null != n && (r.userData = n), r
        }

        function w(e, t, i, n) {
            var r = e.length > 0 ? e[0] : null;
            if (r) {
                var o = new I;
                t.subSelf(r.position), o.setPosition(t), r.geometry.append(i, o), n && (r.anims = r.anims ? r.anims.concat(n) : n)
            } else r = {
                position: t,
                geometry: i
            }, n && (r.anims = n), e.push(r)
        }

        function M(e, t) {
            var i = new N;
            return i._positionArray = [], i._normalArray = [], i.fixedColor = new O(16777215), i._uvArray = [], i._indexArray = t.conf.get("details.useIndexedGeometries") ? [] : null, {
                position: e.position,
                geometry: i
            }
        }

        function T(e, t, i) {
            var n = 0;
            return e && (n = parseFloat(e) * i), n || (n = t * i), n
        }

        function S(e, t, i) {
            var n = V[t];
            n || (n = V[t] = {});
            var r = n[i];
            r || (r = n[i] = []);
            for (var o = 0; o < e.rings.length; ++o)
                for (var a = e.rings[o], s = a.shapePts, l = s.length, h = new D, u = 0; l - 1 > u; ++u) {
                    var d = s[u],
                        c = s[u + 1];
                    h.sub(c, d), h.normalize();
                    var f = d.clone();
                    f.addSelf(e.position);
                    var p = h.y > 0 ? 1 : -1;
                    f.angleZ = Math.acos(h.x) * p - Math.PI / 2, r.push(f)
                }
        }

        function C(e, t, i, n) {
            function r(t) {
                return e.map.elevation ? g(e, a.position.x + t.x, a.position.y + t.y) : 0
            }

            function o(e) {
                var t, i, n;
                if (d) {
                    var o = u._positionArray.length / 3;
                    for (t = 0; t < e.length; ++t) i = e[t], u._positionArray.push(i.x, i.y, r(i));
                    for (t = 0; t < e.length - 1; ++t) u._indexArray.push(t + o, t + 1 + o)
                } else
                    for (t = 0; t < e.length - 1; ++t) i = e[t], n = e[t + 1], u._positionArray.push(i.x, i.y, r(i), n.x, n.y, r(n))
            }
            var a = i.shape,
                s = i.widths,
                l = i.height,
                h = i.colorHex,
                u = new N(B.LINES);
            u._positionArray = [];
            var d = e.conf.get("details.useIndexedGeometries");
            u._indexArray = d ? [] : null, u.fixedColor = new O(h);
            for (var c = n ? [] : null, f = 0; f < a.rings.length; ++f)
                for (var p = a.rings[f], m = 0; m < s.length; ++m) {
                    var v = s[m];
                    if (0 == v) o(p.shapePts);
                    else {
                        var y = z.offsetPointsList(p.shapePts, v);
                        o(y.rightPts), o(y.leftPts), n && (_(e, y.rightPts, a.position, l), y.rightPts.pivot = a.position.clone(), c.push(y.rightPts), _(e, y.leftPts.reverse(), a.position, l), y.leftPts.pivot = a.position.clone(), c.push(y.leftPts))
                    }
                }
            a.position.z = l, w(t, a.position, u, c)
        }

        function E(e) {
            return -1 != ["yes", "1", "-1", "true"].indexOf(e.oneway) || "raceway" == e.highway
        }

        function k(e, t) {
            var i = P.pick(e, ["spacing", "width", "minLength", "speedInMPerMs", "rightLaneSpeedRatio"]);
            return e.perOsmTag && P.each(e.perOsmTag, function(e, n) {
                null != t[n] && e[t[n]] && P.extend(i, e[t[n]])
            }), i
        }

        function L(e, t, i, n) {
            function r(e) {
                var t = e[0].distanceTo(e[e.length - 1]);
                if (t <= u.minLength) return 0;
                var i = u.spacing;
                return Math.max(1, Math.floor(t / i))
            }

            function o(t, r, o) {
                l && l(t), _(e, t, h.position, 0), i.push({
                    position: h.position,
                    vehicleCount: r,
                    speedInMPerMs: o,
                    animPoints: t,
                    baseAnimAdvancement: n.baseAnimAdvancement
                })
            }

            function a(e) {
                P.each(e, function(e) {
                    e.z = c
                })
            }

            function s(e) {
                P.each(e, function(i, n) {
                    i.z = c(i, n, e, t) || 0
                })
            }
            var l, h = m(t, !1),
                u = k(n, t),
                d = u.speedInMPerMs,
                c = n.z,
                f = n.count || r;
            P.isNumber(c) ? l = a : P.isFunction(c) && (l = s), t.maxspeed && (d = +t.maxspeed / 3600);
            for (var p = 0; p < h.rings.length; ++p) {
                var g = h.rings[p],
                    v = g.shapePts,
                    y = f(v, t);
                if (y > 0)
                    if (n.alwaysOneWay || E(t)) {
                        var b = 0 | t.lanes || 1;
                        if (b > 1) {
                            var x = z.offsetPointsList(v, u.width, !1);
                            o(x.rightPts, y, d);
                            var w = u.rightLaneSpeedRatio || 1;
                            o(x.leftPts, y, d * w)
                        } else o(v, y, d)
                    } else {
                        var M = z.offsetPointsList(v, u.width, !1);
                        o(M.rightPts.reverse(), y, d), o(M.leftPts, y, d)
                    }
            }
        }
        var P = e("underscore"),
            A = e("engine"),
            R = A.Vector3,
            D = A.Vector2,
            I = A.Matrix4,
            O = A.Color,
            N = A.Geometry,
            B = A.Constants,
            F = A.MathHelper,
            z = A.ShapeUtils,
            H = A.TriangulationUtils,
            U = e("./DetailsCategories"),
            W = e("../buildings/building-generator"),
            G = e("../../utils/TileHelper"),
            j = e("../../utils/DateRange"),
            q = e("../../utils/LocationHelper"),
            V = {},
            Z = 3,
            Y = 3.5;
        t.exports = r;
        var K = r.prototype;
        K._commonGeneratePoint = function(e, t, i) {
            var n = i.allowRotation,
                r = i.modelHeight,
                o = i.userData,
                a = i.tileKey,
                s = e.pos;
            if (!this._pointIsExcluded(s, a)) {
                var l = q.getScaleFromLatitude(s.y),
                    h = e.min_height && parseFloat(e.min_height) || 0,
                    u = new R(s.x, s.y, h * l),
                    d = l;
                if (r && e.height) {
                    var c = parseFloat(e.height);
                    d *= c > h ? (c - h) / r : c / r
                }
                var f = 0;
                if (n) {
                    var p = e.direction;
                    p && (p = F.angleFromNorthInDegree(p)), f = isNaN(p) ? s.x * s.y % 360 : F.degToRad(-1 * p)
                }
                e.colour && (e.color = e.colour), e.color && (o || (o = {}), o.color = e.color);
                var m = x(u, f, d, o);
                return t.push(m), m
            }
        }, K._generateRock = function(e, t, i) {
            function n(e, n, r) {
                if (!a._pointIsExcluded({
                        x: e,
                        y: n
                    }, i)) {
                    var s = q.getScaleFromLatitude(n);
                    r ? s *= r / a.options.rock.modelHeight : s += .5 * Math.random() - .3;
                    var l = x({
                        x: e,
                        y: n,
                        z: o
                    }, null, s);
                    t.push(l)
                }
            }
            var r, o = 0,
                a = this;
            "point" == e.queryType ? (r = m(e, !1), n(r.position.x, r.position.y, parseFloat(e.height))) : "line" == e.queryType && (r = m(e, !1), z.sampleRings(r.rings, r.position.x, r.position.y, 9, n))
        }, K._generateFence = function(e, t, i, n) {
            var r = i.length > 0 ? i[0] : null,
                o = m(t, !0, r && r.position);
            if (0 != o.rings.length) {
                r || (r = M(o, e), i.push(r));
                var a = q.getScaleFromLatitude(t.pos.y),
                    s = Z;
                "gate" == t.barrier && (s = Y);
                var l = T(t.height, s, a),
                    h = T(t.min_height, 0, a);
                l > h && (l -= h);
                var u, d, c, f, p = o.rings;
                if (this.options.useExclusionZones) {
                    var g = [];
                    for (u = 0; u < o.rings.length; ++u) {
                        c = o.rings[u];
                        var v = c.shapePts;
                        for (this._splitRingPoints(v, g, o.position, n), d = 0; d < c.shapeHolePts.length; ++d) f = c.shapeHolePts[d], this._splitRingPoints(f, g, o.position, n)
                    }
                    p = g
                }
                var y = {
                    minHeight: h,
                    height: l,
                    color: null,
                    closed: !1,
                    repeatUv: .1,
                    normalSmoothing: !1
                };
                for (u = 0; u < p.length; ++u)
                    for (c = p[u], z.setRingHeight(c, h + l), e.map.elevation && _(e, c.shapePts, r.position, 0), H.extrudeWall(r.geometry, c.shapePts, y), d = 0; d < c.shapeHolePts.length; ++d) f = c.shapeHolePts[d], e.map.elevation && _(e, f, r.position, 0), H.extrudeWall(r.geometry, f, y)
            }
        }, K._splitRingPoints = function(e, t, i, n) {
            for (var r = null, o = 0; o < e.length; o++) {
                var a = e[o],
                    s = {
                        x: i.x + a.x,
                        y: i.y + a.y
                    };
                this._pointIsExcluded(s, n, !0) ? r = null : (null == r && (r = {
                    shapePts: [],
                    shapeHolePts: []
                }, t.push(r)), r.shapePts.push(a))
            }
        }, K._findBarrierHeightWidthAndColor = function(e, t) {
            var i = 3,
                n = .9,
                r = this.options.barrier.defaultWallColor;
            "hedge" == e.barrier ? (i = 2.5, n = .7, r = this.options.barrier.hedgeColor) : "city_wall" == e.barrier ? (i = 10, n = 1.5) : ("fountain" == e.amenity || "water" == e.natural || "basin" == e.landuse) && (i = 1, n = .7);
            var o = T(e.height, i, t),
                a = T(e.width, n, t),
                s = T(e.min_height, 0, t);
            o > s && (o -= s);
            var l = null;
            return null != this.options.barrier.wallColor ? l = new O(this.options.barrier.wallColor) : (e.colour ? ("hedge" != e.barrier || "green" != e.colour) && (l = O.fromString(e.colour)) : e.material && (l = O.fromString(e.material)), null == l && (l = new O(r))), {
                color: l,
                height: o,
                minHeight: s,
                width: a
            }
        }, K._generateBarrier = function(e, t, i, n) {
            var r = m(t, !0);
            if (0 != r.rings.length) {
                var o = q.getScaleFromLatitude(r.position.y),
                    a = this._findBarrierHeightWidthAndColor(t, o),
                    s = a.color,
                    l = a.height,
                    h = a.minHeight,
                    u = a.width,
                    d = new N;
                d._positionArray = [], d._colorArray = [], d._normalArray = [], d._indexArray = e.conf.get("details.useIndexedGeometries") ? [] : null;
                var c, f, p, _, y = r.rings;
                if (this.options.useExclusionZones) {
                    var b = [];
                    for (c = 0; c < r.rings.length; ++c) {
                        f = r.rings[c];
                        var x = f.shapePts;
                        for (this._splitRingPoints(x, b, r.position, n), p = 0; p < f.shapeHolePts.length; ++p) _ = f.shapeHolePts[p], this._splitRingPoints(_, b, r.position, n)
                    }
                    y = b
                }
                if ("yes" != t.area || t.surface || t.highway || t.landuse || t.amenity)
                    for (c = 0; c < y.length; ++c)
                        for (f = y[c], v(e, d, {
                                shapePosition: r.position,
                                shapePts: f.shapePts
                            }, {
                                width: u,
                                minHeight: h,
                                height: l
                            }, s), p = 0; p < f.shapeHolePts.length; ++p) _ = f.shapeHolePts[p], v(e, d, {
                            shapePosition: r.position,
                            shapePts: _
                        }, {
                            width: u,
                            minHeight: h,
                            height: l
                        }, s);
                else {
                    e.map.elevation && (r.position.z = g(e, r.position.x, r.position.y));
                    try {
                        for (c = 0; c < y.length; ++c) {
                            f = y[c], z.checkStartEnd(f.shapePts), z.setRingHeight(f, h + l);
                            var M = {
                                minHeight: h,
                                height: l,
                                color: s,
                                closed: !0,
                                repeatUv: !1,
                                normalSmoothing: !1
                            };
                            for (H.extrudeWall(d, f.shapePts, M), p = 0; p < f.shapeHolePts.length; ++p) _ = f.shapeHolePts[p], H.extrudeWall(d, _, M);
                            H.triangulateRing(d, f, {
                                height: h + l,
                                color: s
                            })
                        }
                    } catch (T) {
                        console.warn("Barrier triangulation failed:", t.osm_id, t)
                    }
                }
                w(i, r.position, d)
            }
        }, K._generateForest = function(e, t, i) {
            function n(e, n) {
                r._pointIsExcluded({
                    x: e,
                    y: n
                }, i) || t.push(x({
                    x: e,
                    y: n,
                    z: o
                }, null, d || c * (1 + Math.random()), s || p(n)))
            }
            var r = this,
                o = e.min_height ? parseFloat(e.min_height) : 0,
                a = void 0;
            e.height ? a = parseFloat(e.height) : e["xmas:tree:height"] && (a = parseFloat(e["xmas:tree:height"])), null != o && null != a && a > o && (a -= o);
            var s = f(e) || "deciduous",
                l = this.options.tree,
                h = l[s],
                u = {
                    modelHeight: h.modelHeight || l.modelHeight,
                    minRandomHeight: h.minRandomHeight || l.minRandomHeight,
                    maxRandomHeight: h.maxRandomHeight || l.maxRandomHeight
                },
                d = void 0;
            d = a ? a : u.minRandomHeight + (u.maxRandomHeight - u.minRandomHeight) * Math.random(), d /= u.modelHeight;
            var c = q.getScaleFromLatitude(e.pos.y);
            if (o *= c, d *= c, "tree_row" == e.natural) {
                var g = m(e, !1);
                z.sampleRings(g.rings, g.position.x, g.position.y, 10 * c, n)
            } else "point" == e.queryType ? n(e.pos.x, e.pos.y) : "orchard" === e.landuse ? (d = .75 * c, s = "deciduous", y(e, {
                x: {
                    min: 10 * c,
                    max: 10 * c
                },
                y: {
                    min: 10 * c,
                    max: 10 * c
                }
            }, n, !0)) : y(e, {
                x: {
                    min: 10 * c,
                    max: 20 * c
                },
                y: {
                    min: 5 * c,
                    max: 10 * c
                }
            }, n)
        }, K._generateScrub = function(e, t, i) {
            var n = this,
                r = function(e, r) {
                    if (!n._pointIsExcluded({
                            x: e,
                            y: r
                        }, i)) {
                        var o = new R(e, r, 0),
                            a = (1 + .5 * Math.random()) * q.getScaleFromLatitude(o.y),
                            s = x(o, o.x + o.y, a);
                        t.push(s)
                    }
                };
            "plant_nursery" === e.landuse ? y(e, {
                x: {
                    min: 7,
                    max: 7
                },
                y: {
                    min: 7,
                    max: 7
                }
            }, r, !0) : y(e, {
                x: {
                    min: 5,
                    max: 10
                },
                y: {
                    min: 2,
                    max: 5
                }
            }, r)
        }, K._generateCrane = function(e, t, i) {
            var n = this,
                r = function(e, r) {
                    var o = new R(e, r, 0);
                    if (!n._pointIsExcluded(o, i)) {
                        var a = x(o, o.x + o.y);
                        t.push(a)
                    }
                };
            if ("polygon" == e.queryType)
                for (var o = 150, a = 100, s = !1, l = 0; 3 > l && 0 == b(e, o, a, r, s);) s = !0, o *= .5, a *= .5, l++;
            else "point" == e.queryType && e.pos && r(e.pos.x, e.pos.y)
        }, K.onTileGenerated = function(e) {
            delete V[e]
        }, K.getPointOrientation = function(e, t, i) {
            var n = V[i],
                r = n && n[t];
            if (!r) return 0;
            for (var o = 0; o < r.length; ++o) {
                var a = r[o];
                if (a.distanceTo(e) < 2) return a.angleZ
            }
            return 0
        }, K._generateAerialLine = function(e, t, i, n) {
            var r = m(t, !1),
                o = this.options.aerial_line.lineHeight,
                a = [this.options.aerial_line.lineWidth];
            S(r, n, U.AERIAl_PYLON);
            var s = null;
            "gondola" == t.aerialway ? s = "gondola" : "chair_lift" == t.aerialway ? s = "chairLift" : "cable_car" == t.aerialway && (s = "cableCar"), C(e, i, {
                shape: r,
                widths: a,
                height: o,
                colorHex: this.options.aerial_line.lineColor
            }, null != s), s && (i[0].cabinType = s)
        }, K._generatePowerLine = function(e, t, i, n) {
            var r = m(t, !1);
            S(r, n, U.POWER_TOWER);
            var o = this.options.power_line.height,
                a = 3,
                s = "minor_line" == t.power;
            s ? (o = this.options.power_line.minorLineHeight, a = 1) : t.cables && (a = parseFloat(t.cables));
            var l = [];
            a % 2 != 0 && (l.push(0), a--);
            for (var h = this.options.power_line.width / a, u = 2; a >= u;) l.push(h * u), u += 2;
            C(e, i, {
                shape: r,
                widths: l,
                height: o,
                colorHex: this.options.power_line.color
            })
        }, K._generatePointNoZ = function(e, t, i) {
            var n = e.pos;
            this._pointIsExcluded(n, i) || (n.z = 0, t.push(x(n)))
        }, K._generateFountain = function(e, t, i) {
            var n = e.pos;
            if (!this._pointIsExcluded(n, i)) {
                var r = "small";
                e.height && (r = e.height < 2 ? "verySmall" : e.height < 50 ? "small" : "large");
                var o = null == e.barrier ? this.options.fountain[r].height : null,
                    a = this._commonGeneratePoint(e, t, {
                        allowRotation: !1,
                        modelHeight: o,
                        userData: null,
                        tileKey: i
                    });
                a.subCategory = r
            }
        }, K._generateLightHouse = function(e, t, i, n) {
            var r = t.pos;
            if (!this._pointIsExcluded(r, n)) {
                r.z = 0;
                var o = t["seamark:light_minor:height"] || Math.max(0, t["seamark:light:1:height"] || 0, t["seamark:light:2:height"] || 0, t["seamark:light:3:height"] || 0),
                    a = 1;
                0 != o ? a = o / this.options.lighthouse.modelHeight : "light_minor" == t["seamark:type"] && (a = .3), a = Math.max(.3, a), a *= q.getScaleFromLatitude(r.y), i.push(x(r, r.x + r.y, a))
            }
        }, K._generateCemetery = function(e, t, i) {
            var n = this,
                r = function(e, r) {
                    var o = new R(e, r, 0);
                    if (!n._pointIsExcluded(o, i)) {
                        var a = x(o, null, .8 + .4 * Math.random());
                        t.push(a)
                    }
                };
            y(e, {
                x: {
                    min: 3,
                    max: 7
                },
                y: {
                    min: 4,
                    max: 7
                }
            }, r)
        }, K._generateVineyard = function(e, t, i) {
            var n = m(t, !1);
            if (n && 0 != n.rings.length) {
                var r = t.bounds,
                    o = r.right - r.left,
                    a = r.top - r.bottom;
                o *= .5, a *= .5;
                var s = 2,
                    l = 1.5,
                    h = 6.5,
                    u = new N;
                u._positionArray = [], u.fixedColor = new O(this.options.vineyard.color), u._normalArray = [], u._indexArray = e.conf.get("details.useIndexedGeometries") ? [] : null;
                for (var d = !0, c = 0; c < n.rings.length; ++c) {
                    var f = n.rings[c],
                        p = d ? "x" : "y",
                        g = d ? "y" : "x";
                    d = !d;
                    var _ = "x" == p ? a : o,
                        y = new D(-o - 1, -a + h);
                    for ("y" == p && y.set(-o + h, -a - 1); y[g] < _;) {
                        for (var b = z.intersectShapeAlong(p, f, y); b.length > 1;) {
                            var x = [b.shift(), b.shift()];
                            v(e, u, {
                                shapePosition: n.position,
                                shapePts: x
                            }, {
                                width: l,
                                minHeight: 0,
                                height: s
                            }, null)
                        }
                        y[g] += h
                    }
                }
                n.position.z = 0, w(i, n.position, u)
            }
        }, K._generateFlag = function(e, t, i) {
            var n, r;
            if ("point" == e.queryType) n = e.pos, n = new R(n.x, n.y, 0);
            else if ("line" == e.queryType) {
                r = m(e, !1);
                var o = r.rings[0].shapePts;
                n = new R(r.position.x, r.position.y, 0), n.addSelf(o[o.length - 1])
            } else "polygon" == e.queryType && (r = m(e, !1), n = new R(r.position.x, r.position.y, 0));
            if (!this._pointIsExcluded(n, i)) {
                var a = 1,
                    s = q.getScaleFromLatitude(n.y),
                    l = e.min_height && parseFloat(e.min_height) * s || 0;
                n.z = l;
                var h = e.height && parseFloat(e.height) * s;
                h ? a = h > l ? (h - l) / this.options.flag.modelHeight : h / this.options.flag.modelHeight : e.golf && (a = .5 * s), t.push(x(n, n.x / 100, a))
            }
        }, K._pointIsExcluded = function(e, t, i) {
            var n;
            n = i ? this._getExclusionZonesWithNeighbours(t) : this.tileExclusionZones[t] || {};
            var r = !1;
            if (null != n)
                for (var o = P.keys(n), a = 0; a < o.length && !r; a++) {
                    var s = n[o[a]],
                        l = s.boundingBox,
                        h = s.footprint;
                    if (r = e.x < l.maxX && e.x > l.minX && e.y < l.maxY && e.y > l.minY) {
                        r = !1;
                        for (var u = 0; u < h.length && !r; u++) {
                            var d = h[u];
                            r = z.isPointInRing(e, d)
                        }
                    }
                }
            return r
        }, K._getExclusionZonesWithNeighbours = function(e) {
            var t = this._combinedExclusionZones[e];
            if (null != t) {
                var i = this._combinedExclusionZones._allTiles.indexOf(e);
                i != this._combinedExclusionZones._allTiles.length - 1 && (this._combinedExclusionZones._allTiles.splice(i, 1), this._combinedExclusionZones._allTiles.push(e))
            } else {
                t = this.tileExclusionZones[e] || {};
                for (var n = G.getNeighborsTileKeys(e), r = 0; r < n.length; r++) {
                    var o = this.tileExclusionZones[n[r]];
                    null != o && (t = P.extend(t, o))
                }
                if (this._combinedExclusionZones[e] = t, this._combinedExclusionZones._allTiles.push(e), this._combinedExclusionZones._allTiles.length > 100) {
                    var a = this._combinedExclusionZones._allTiles.shift();
                    delete this._combinedExclusionZones[a]
                }
            }
            return t
        }, K.addItemGenerators = function(e, t, i, n, r) {
            var o = j.getRangeFromOsmTags(t, {
                ignoreStartDate: this.options.ignoreStartDate
            });
            if (o.isInRange(new Date)) {
                var a = this._itemGenerators[i];
                a ? a({
                    renderer: e,
                    osmData: t,
                    detailCategory: i,
                    generators: n,
                    tileKey: r
                }) : console.log("Unhandled detailCategory: " + i)
            } else console.log("Discarded %s: not in date range", i, t)
        }
    }, {
        "../../utils/DateRange": 402,
        "../../utils/LocationHelper": 407,
        "../../utils/TileHelper": 411,
        "../buildings/building-generator": 320,
        "./DetailsCategories": 334,
        engine: 10,
        underscore: 207
    }],
    338: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.renderer = e, this.options = t, this._isReleased = !1, this._detailsShadows = this.renderer.conf.get("shadows.useCsm") && this.renderer.conf.get("shadows.csm.detailsShadows");
            var i = this.renderer.getRenderEngine();
            this._renderEngine = i, this._modelCache = this.renderer.getModelCache(), this._animations = [], this._animUpdater = r.bind(this.updateAnimations, this), this.renderer.on("preRender", this._animUpdater), this._extraPacking = this.renderer.conf.get("details.extraPacking"), this._vehiclePacking = this.renderer.conf.get("details.vehiclePacking"), this._animPacking = this.renderer.conf.get("details.animPacking"), this._categoryMeshGrouping = this.renderer.conf.get("details.categoryMeshGrouping"), this._groupedBlockMeshes = {}, this._atlasableItems = [m.SCULPTURE, m.LIGHTHOUSE, m.AERIAl_PYLON], this.waitingModelsCount = 0, this.detailsConfig = {};
            var n = i.getShadowExtensionName(),
                o = i.createMaterial("nolight", l.NoBlending),
                a = i.createMaterial("dirlight" + n, l.NoBlending),
                s = i.createMaterial("dirlight_skinning" + n, l.NoBlending),
                u = i.createMaterial("dirlight_miniSkinning" + n, l.NoBlending),
                d = r.bind(this.loadMultiPoint, this),
                c = r.bind(this.loadMultiPointSkinned, this),
                f = r.bind(this.loadMultiGeometries, this),
                p = r.bind(this.loadPacked, this),
                _ = i._shaderHandler.miniSkinMaxBonesCount,
                v = {
                    loadCallback: d,
                    hasSubCategories: !0
                };
            this.detailsConfig[m.FOUNTAIN] = v, r.each(this.options.fountain, function(e, t) {
                v[t] = {}, v[t].material = i.createMaterial("fountain"), v[t].geometry = new h(l.POINTS), v[t].material.transparent = l.Gradual, v[t].material.depthWrite = !1, v[t].material.uniforms.height.value = e.height, v[t].material.uniforms.particleMaxLife.value = e.particleMaxLife, v[t].material.uniforms.spreadingFactor.value = e.spreadingFactor, v[t].material.uniforms.particleSize.value = e.particleSize, v[t].material.uniforms.direction.value.x = 0, v[t].material.uniforms.direction.value.y = 0, v[t].geometry._positionArray = [], v[t].geometry.clearOnWebglLoad = !0;
                for (var n = 0; n < e.particleCount; ++n) {
                    var r = Math.random(),
                        o = 2 * Math.random() * Math.PI,
                        a = r * Math.cos(o),
                        s = r * Math.sin(o);
                    v[t].geometry._positionArray.push(a, s, Math.random())
                }
            }), this.initFenceWallAndVineyard(f, n, a), this.initFlags(d, s, n), this.initWind(d, s), this.initPetrol(d, s), this.initCrane(d, n), this.initLightHouse(p, d, n), this.initPowerLine(f, o, a, p, d, n), this.initPowerTower(p, d, n), this.initAerialWays(o, n), this.initAerialPylon(p, d, n), this.detailsConfig[m.BOAT] = this.loadVehicle(s, this.options.boat), this.detailsConfig[m.SUBMARINE] = this.loadVehicle(s, this.options.submarine), this.detailsConfig[m.CAR] = this.loadVehicle(s, this.options.car), this.detailsConfig[m.BUS] = this.loadVehicle(s, this.options.bus), this.initScrub(p, n), this.initSculpture(p, d, n), this.initRocks(c, _, n), this.initLamp(c, u, _), this.initCemetery(c, u, _), this.detailsConfig[m.TREE] = {
                loadCallback: p,
                keepGenerators: !0,
                hasSubCategories: !0,
                hasLod: !0
            }, this._treeLodMaterials = {};
            var y = Math.min(_, 100);
            this.buildTree("deciduous", y), this.buildTree("coniferous", y), this.buildTree("palm", y), this.buildTree("xmas", y), this.buildTree("cherry", y), this.buildTree("white-cherry", y), this.buildTree("pink-cherry", y), this.smokeGeometry = this._createSmokeGeometry(), this.smokeMaterials = {
                small: this.buildSmokeMat(this.options.smoke.small),
                large: this.buildSmokeMat(this.options.smoke.large)
            }, this._itemsToPack = [], this.itemsWithLod = {}, this._onCameraUpdatedCbk = r.bind(this.onCameraUpdated, this), this.renderer.on("cameraChanged", this._onCameraUpdatedCbk), this._packBlockStartDate = null;
            var b = t.workOnMove;
            this.detailsPackProcessor = new g(this.renderer, {
                intervalIdle: this.renderer.conf.get("workProcessor.detailsPackInterval"),
                maxDurationIdle: this.renderer.conf.get("workProcessor.detailsPackDuration"),
                workWhenCameraMove: b,
                intervalMoving: this.renderer.conf.get("workProcessor.detailsPackIntervalMoving"),
                maxDurationMoving: this.renderer.conf.get("workProcessor.detailsPackDurationMoving"),
                name: "detailsPackProcessor"
            }), this.detailsPackProcessor.registerWorker(r.bind(this.packBlockWorker, this), "DetailsManager:packBlockWorker"), this._startWorkerHandler = r.bind(this._startWorker, this), this.renderer.onShadersReady(this._startWorkerHandler)
        }
        var r = e("underscore"),
            o = e("util"),
            a = e("events").EventEmitter,
            s = e("engine"),
            l = s.Constants,
            h = s.Geometry,
            u = s.SkeletonUtils,
            d = s.Color,
            c = s.Vector3,
            f = s.Quaternion,
            p = s.Matrix4,
            m = e("./DetailsCategories"),
            g = e("../../utils/WorkProcessor");
        o.inherits(n, a), t.exports = n;
        var _ = 10,
            v = new c,
            y = new p,
            b = n.prototype;
        b._startWorker = function() {
            this.detailsPackProcessor && this.detailsPackProcessor.start()
        }, b.releaseCallback = function(e) {
            if (e.meshs) {
                for (var t = 0; t < e.meshs.length; ++t) this._renderEngine.releaseObject(e.meshs[t]);
                delete e.meshs
            }
        }, b.initFenceWallAndVineyard = function(e, t, i) {
            var n = {
                loadCallback: e,
                preDeleteCallback: r.bind(this.releaseCallback, this),
                doubleSided: !0,
                material: this._renderEngine.createMaterial("dirlight_texture" + t)
            };
            this.detailsConfig[m.FENCE] = n, n.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.barrier.fenceTexture), n.material.transparent = l.Mask, this.detailsConfig[m.BARRIER] = {
                loadCallback: e,
                preDeleteCallback: r.bind(this.releaseCallback, this),
                renderPassToHandle: ["shadowDepth", "reflected"],
                material: i
            }, this.detailsConfig[m.VINEYARD] = this.detailsConfig[m.BARRIER]
        }, b.initFlags = function(e, t, i) {
            function n(e, t) {
                e.clearOnWebglLoad = !0, o.geometry = e, o.skeleton = t, a._animPacking ? a.packModel(a.options.flag.model, o, r.bind(a.binaryReceived, a)) : a.binaryReceived()
            }
            var o = {
                loadCallback: this._animPacking ? r.bind(this.loadAnimPacked, this) : e,
                keepGenerators: this._animPacking ? !0 : !1,
                renderPassToHandle: ["shadowDepth", "reflected"],
                animMinSpeed: .5,
                material: t
            };
            this.detailsConfig[m.FLAG] = o, this.options.flag.allowTexture && (o.material = this._renderEngine.createMaterial("dirlight_texture_skinning" + i), o.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.flag.texture));
            var a = this;
            this.loadBinary(this.options.flag.model, n)
        }, b.initWind = function(e, t) {
            function i(e, t) {
                e.clearOnWebglLoad = !0, o._modelCache.setModelColor(o.options.wind_generator.model, o.options.wind_generator.color), n.geometry = e, n.skeleton = t, o._animPacking ? o.packModel(o.options.wind_generator.model, n, r.bind(o.binaryReceived, o)) : o.binaryReceived()
            }
            var n = {
                loadCallback: this._animPacking ? r.bind(this.loadAnimPacked, this) : e,
                keepGenerators: this._animPacking ? !0 : !1,
                material: t,
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                animMinSpeed: .2
            };
            this.detailsConfig[m.WIND_GENERATOR] = n;
            var o = this;
            this.loadBinary(this.options.wind_generator.model, i)
        }, b.initPetrol = function(e, t) {
            function i(e, t) {
                e.clearOnWebglLoad = !0, o._modelCache.setModelColor(o.options.petroleum_well.model, o.options.petroleum_well.color), n.geometry = e, n.skeleton = t, o._animPacking ? o.packModel(o.options.petroleum_well.model, n, r.bind(o.binaryReceived, o)) : o.binaryReceived()
            }
            var n = {
                loadCallback: this._animPacking ? r.bind(this.loadAnimPacked, this) : e,
                keepGenerators: this._animPacking ? !0 : !1,
                material: t,
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth"],
                doubleSided: !0
            };
            this.detailsConfig[m.PETROLEUM_WELL] = n;
            var o = this;
            this.loadBinary(this.options.petroleum_well.model, i)
        }, b.initCrane = function(e, t) {
            function i(e, t) {
                e.clearOnWebglLoad = !0, n.geometry = e, n.skeleton = t, o._animPacking ? o.packModel(o.options.crane.model, n, r.bind(o.binaryReceived, o)) : o.binaryReceived()
            }
            var n = {
                loadCallback: this._animPacking ? r.bind(this.loadAnimPacked, this) : e,
                keepGenerators: this._animPacking ? !0 : !1,
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                doubleSided: !0,
                material: this._renderEngine.createMaterial("dirlight_texture_skinning" + t, l.NoBlending)
            };
            this.detailsConfig[m.CRANE] = n, n.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.crane.texture), n.material.transparent = !0;
            var o = this;
            this.loadBinary(this.options.crane.model, i)
        }, b.initLightHouse = function(e, t, i) {
            function n(e) {
                e.clearOnWebglLoad = !0, o.geometry = e, a.binaryReceived()
            }
            var o = {
                loadCallback: this._extraPacking ? e : t,
                keepGenerators: this._extraPacking ? !0 : !1,
                material: this._renderEngine.createMaterial("dirlight_texture" + i, l.NoBlending),
                preDeleteCallback: this._extraPacking ? r.bind(this.releaseCallback, this) : null
            };
            this.detailsConfig[m.LIGHTHOUSE] = o, o.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.lighthouse.texture), o.renderPassToHandle = ["colorBeforeProcess", "depth", "shadowDepth", "reflected"];
            var a = this;
            this.loadBinary(this.options.lighthouse.model, r.bind(n, this))
        }, b.initPowerLine = function(e, t, i, n, o) {
            function a(e) {
                e.clearOnWebglLoad = !0, l._modelCache.setModelColor(l.options.power_pole.model, l.options.power_pole.color), s.geometry = e, l.binaryReceived()
            }
            this.detailsConfig[m.POWER_LINE] = {
                loadCallback: e,
                preDeleteCallback: r.bind(this.releaseCallback, this),
                material: t
            };
            var s = {
                loadCallback: this._extraPacking ? n : o,
                keepGenerators: this._extraPacking ? !0 : !1,
                material: i,
                preDeleteCallback: this._extraPacking ? r.bind(this.releaseCallback, this) : null
            };
            this.detailsConfig[m.POWER_POLE] = s;
            var l = this;
            this.loadBinary(this.options.power_pole.model, a)
        }, b.initPowerTower = function(e, t, i) {
            function n(e) {
                e.clearOnWebglLoad = !0, o.geometry = e, a.binaryReceived()
            }
            var o = {
                loadCallback: this._extraPacking ? e : t,
                keepGenerators: this._extraPacking ? !0 : !1,
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                doubleSided: !0,
                material: this._renderEngine.createMaterial("dirlight_texture" + i),
                preDeleteCallback: this._extraPacking ? r.bind(this.releaseCallback, this) : null
            };
            this.detailsConfig[m.POWER_TOWER] = o, o.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.power_tower.texture), o.material.transparent = l.Mask;
            var a = this;
            this.loadBinary(this.options.power_tower.model, n)
        }, b.initAerialWays = function(e, t) {
            function i(e) {
                e.clearOnWebglLoad = !0, e.setRigidSkin(0), a.cableCar.geometry = e, a.cableCar.skeleton = u.createSkeleton(1), s._vehiclePacking ? s.packModel(s.options.aerial_line.cableCar.model, a.cableCar, r.bind(s.binaryReceived, s)) : s.binaryReceived()
            }

            function n(e) {
                e.clearOnWebglLoad = !0, e.setRigidSkin(0), a.chairLift.geometry = e, a.chairLift.skeleton = u.createSkeleton(1), s._vehiclePacking ? s.packModel(s.options.aerial_line.chairLift.model, a.chairLift, r.bind(s.binaryReceived, s)) : s.binaryReceived()
            }

            function o(e) {
                e.clearOnWebglLoad = !0, e.setRigidSkin(0), a.gondola.geometry = e, a.gondola.skeleton = u.createSkeleton(1), s._vehiclePacking ? s.packModel(s.options.aerial_line.gondola.model, a.gondola, r.bind(s.binaryReceived, s)) : s.binaryReceived()
            }
            var a = {
                loadCallback: this._vehiclePacking ? r.bind(this.loadAerialWaysPacked, this) : r.bind(this.loadAerialWays, this),
                keepGenerators: this._vehiclePacking ? !0 : !1,
                preDeleteCallback: r.bind(this.releaseCallback, this),
                material: e,
                cableCar: {
                    material: this._renderEngine.createMaterial("dirlight_texture_skinning" + t),
                    doubleSided: !0
                },
                chairLift: {
                    material: this._renderEngine.createMaterial("dirlight_texture_skinning" + t),
                    doubleSided: !0
                },
                gondola: {
                    material: this._renderEngine.createMaterial("dirlight_texture_skinning" + t, l.NoBlending)
                }
            };
            this.detailsConfig[m.AERIAl_LINE] = a;
            var s = this;
            this.loadBinary(this.options.aerial_line.cableCar.model, i), a.cableCar.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.aerial_line.cableCar.texture), a.cableCar.material.transparent = l.Mask, this.loadBinary(this.options.aerial_line.chairLift.model, n), a.chairLift.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.aerial_line.chairLift.texture), a.chairLift.material.transparent = l.Mask, this.loadBinary(this.options.aerial_line.gondola.model, o), a.gondola.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.aerial_line.gondola.texture)
        }, b.initAerialPylon = function(e, t, i) {
            function n(e) {
                e.clearOnWebglLoad = !0, o.geometry = e, a.binaryReceived()
            }
            var o = {
                loadCallback: this._extraPacking ? e : t,
                keepGenerators: this._extraPacking ? !0 : !1,
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                doubleSided: !0,
                material: this._renderEngine.createMaterial("dirlight_texture" + i),
                preDeleteCallback: this._extraPacking ? r.bind(this.releaseCallback, this) : null
            };
            this.detailsConfig[m.AERIAl_PYLON] = o, o.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.aerial_pylon.texture), o.material.transparent = l.Mask;
            var a = this;
            this.loadBinary(this.options.aerial_pylon.model, n)
        }, b.initScrub = function(e, t) {
            function i(e) {
                n.geometry = e, o.binaryReceived()
            }
            var n = {
                renderPassToHandle: this._detailsShadows ? ["shadowDepth"] : [],
                loadCallback: e,
                keepGenerators: !0,
                colors: this.options.scrub.colors,
                doubleSided: !0,
                material: this._renderEngine.createMaterial("dirlight_texture" + t)
            };
            this.detailsConfig[m.SCRUB] = n;
            var r = this._renderEngine.loadTexture(this.options.scrub.texture);
            r.generateMipmaps = !1, r.magFilter = r.minFilter = l.LinearFilter, n.material.uniforms.tex0.texture = r, n.material.transparent = l.Mask;
            var o = this;
            this.loadBinary(this.options.scrub.model, i)
        }, b.initSculpture = function(e, t, i) {
            function n(e) {
                a.geometry = e, s.binaryReceived()
            }
            var o = this.options.sculpture,
                a = {
                    loadCallback: this._extraPacking ? e : t,
                    keepGenerators: this._extraPacking ? !0 : !1,
                    renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                    material: this._renderEngine.createMaterial("dirlight_texture" + i, l.NoBlending),
                    doubleSided: o.doubleSided,
                    preDeleteCallback: this._extraPacking ? r.bind(this.releaseCallback, this) : null
                };
            this.detailsConfig[m.SCULPTURE] = a, a.material.uniforms.tex0.texture = this._renderEngine.loadTexture(o.texture);
            var s = this;
            this.loadBinary(o.model, n)
        }, b.initRocks = function(e, t, i) {
            function n() {
                a.buildSkinnedGeometry(a.options.rock.model, o.maxCountPerMesh, null, !0, r.bind(function(e) {
                    o.geometry = e, a.binaryReceived()
                }, a))
            }
            var o = {
                loadCallback: e,
                meshs: [],
                renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth"],
                maxCountPerMesh: Math.min(t, 32),
                material: this._renderEngine.createMaterial("dirlight_texture_miniSkinning" + i, l.NoBlending)
            };
            this.detailsConfig[m.ROCK] = o, o.material.uniforms.tex0.texture = this._renderEngine.loadTexture(this.options.rock.texture);
            var a = this;
            this.loadBinary(this.options.rock.model, r.bind(n, this))
        }, b.initLamp = function(e, t, i) {
            function n() {
                a.buildSkinnedGeometry(a.options.street_lamp.model, o.maxCountPerMesh, null, !1, r.bind(function(e) {
                    o.geometry = e, o.geometry.fixedColor = new d(a.options.street_lamp.color), a.binaryReceived()
                }, a))
            }
            var o = {
                renderPassToHandle: this._detailsShadows ? ["shadowDepth"] : [],
                loadCallback: e,
                meshs: [],
                doubleSided: !0,
                material: t,
                maxCountPerMesh: Math.min(i, 100)
            };
            this.detailsConfig[m.STREET_LAMP] = o;
            var a = this;
            this.loadBinary(this.options.street_lamp.model, n)
        }, b.initCemetery = function(e, t, i) {
            function n() {
                a.buildSkinnedGeometry(a.options.cemetery.model, o.maxCountPerMesh, o.colors, !1, r.bind(function(e) {
                    o.geometry = e, a.binaryReceived()
                }, a))
            }
            var o = {
                renderPassToHandle: this._detailsShadows ? ["shadowDepth"] : [],
                loadCallback: e,
                meshs: [],
                material: t,
                colors: this.options.cemetery.colors,
                maxCountPerMesh: Math.min(i, 100)
            };
            this.detailsConfig[m.CEMETERY] = o;
            var a = this;
            this.loadBinary(this.options.cemetery.model, n)
        }, b.release = function() {
            this.renderer.removeListener("cameraChanged", this._onCameraUpdatedCbk), this.renderer.removeListener("preRender", this._animUpdater), this.detailsPackProcessor.release(), delete this.detailsPackProcessor, this._isReleased = !0
        }, b._createSmokeGeometry = function() {
            var e = new h(l.POINTS);
            e._positionArray = [], e.clearOnWebglLoad = !0;
            for (var t = 0; t < this.options.smoke.particleCount; ++t) e._positionArray.push(.5 * (1 - 2 * Math.random()), .5 * (1 - 2 * Math.random()), Math.random());
            return e
        }, b.buildSkinnedGeometry = function(e, t, i, n, o) {
            this._modelCache.buildSkinnedGeometry(e, t, i, n, o, r.bind(function(e) {
                this._isReleased || o(e)
            }, this))
        }, b.buildSmokeMat = function(e) {
            var t = this.renderer.getRenderEngine().createMaterial("smoke");
            return t.transparent = l.Gradual, t.depthWrite = !1, t.uniforms.particleMaxLife.value = e.particleMaxLife, t.uniforms.particleSizes.value.set(e.particleSizes[0], e.particleSizes[1]), t.uniforms.spreadingfactor.value = e.spreadingfactor, t.uniforms.direction.value.set(e.direction[0], e.direction[1], e.direction[2]), t.uniforms.emiterScale.value = e.emiterScale, t
        }, b.buildTree = function(e, t) {
            function i(e) {
                s.lodGeometry = e, this.binaryReceived()
            }

            function n() {
                this.buildSkinnedGeometry(f, s.maxCountPerMesh, s.colors, !0, r.bind(function(e) {
                    s.geometry = e, this.binaryReceived()
                }, this))
            }
            var o = this.options.tree,
                a = o[e],
                s = {
                    renderPassToHandle: ["colorBeforeProcess", "depth", "shadowDepth", "reflected"],
                    lodRenderPassToHandle: ["shadowDepth"],
                    doubleSided: !0,
                    meshs: [],
                    colors: a.colors || o.colors,
                    maxCountPerMesh: t
                };
            this.detailsConfig[m.TREE][e] = s;
            var h = this.renderer.getRenderEngine(),
                u = h.loadTexture(a.texture);
            u.generateMipmaps = !1, u.magFilter = u.minFilter = l.LinearFilter;
            var d = h.getShadowExtensionName();
            s.material = h.createMaterial("dirlight_texture_miniSkinning" + d), s.material.uniforms.tex0.texture = u, s.material.transparent = l.Mask;
            var c = a.lodTexture || o.lodTexture;
            s.lodMaterial = this._getTreeLodMaterial(c), a.lodModel || (a.lodModel = a.model, a.lodTexture = a.lodTexture || a.texture), this.loadBinary(a.lodModel, r.bind(i, this));
            var f = a.model;
            this.loadBinary(f, r.bind(n, this))
        }, b.packModel = function(e, t, i) {
            this._modelCache.packModel(e, r.bind(function(e, n, r, o) {
                this._isReleased || (t.packedGeometry = e, t.packedGeometryBoneCount = n, t.packedNumber = r, t.skeleton || (t.skeleton = o), i())
            }, this))
        }, b.loadBinary = function(e, t) {
            var i = this;
            this.waitingModelsCount++, this._modelCache.loadModel(e, function(e, n, r) {
                e || i._isReleased || t(n, r)
            })
        }, b.binaryReceived = function() {
            this.waitingModelsCount--, 0 == this.waitingModelsCount && this.renderer.map && this.emit("ready")
        }, b.onReady = function(e) {
            0 == this.waitingModelsCount ? e.call() : this.once("ready", r.bind(e, this))
        }, b.setWindDir = function(e) {
            var t = this.options.smoke.small;
            this.smokeMaterials.small.uniforms.direction.value.x = e.x * t.direction[0], this.smokeMaterials.small.uniforms.direction.value.y = e.y * t.direction[1];
            var i = this.options.smoke.large;
            this.smokeMaterials.large.uniforms.direction.value.x = e.x * i.direction[0], this.smokeMaterials.large.uniforms.direction.value.y = e.y * i.direction[1];
            var n = this.detailsConfig[m.FOUNTAIN].large;
            n.material.uniforms.direction.value.x = e.x * _, n.material.uniforms.direction.value.y = e.y * _
        }, b.createSmokeMesh = function(e, t, i) {
            var n = this.renderer.getRenderEngine().createMesh(this.smokeGeometry, this.smokeMaterials[i]);
            return n.position.copy(e), n.position.z = t * this.options.smoke[i].heightScale, n.updateMatrix(), n
        }, b.addToScene = function(e, t) {
            if (this.renderer.getScene().detailsParent.add(e), t && t.duration > 0) {
                var i = {
                    mesh: e,
                    duration: t.duration,
                    initialScaleZ: 0,
                    targetScaleZ: e.scale.z,
                    scaleZ: 0,
                    elapsed: 0,
                    easing: t.easing,
                    terminated: !1
                };
                e.detailsCreationAnimation = i, this._animations.push(i)
            }
        }, b.updateAnimations = function(e) {
            for (var t = [], i = 0; i < this._animations.length; i++) {
                var n = this._animations[i];
                n.elapsed += e.dt;
                var r = n.elapsed,
                    o = n.duration,
                    a = r / o,
                    s = n.initialScaleZ,
                    l = n.targetScaleZ - s;
                o > r ? n.scaleZ = n.easing(a, r, s, l, o) : (n.scaleZ = n.targetScaleZ, n.terminated = !0), n.mesh.scale.z = n.scaleZ, n.mesh.updateMatrix(), n.terminated || t.push(n)
            }
            this._animations = t
        }, b.loadPoint = function(e, t) {
            var i = this.detailsConfig[e.detailCategory];
            e.generator.subCategory && i.hasSubCategories && (i = i[e.generator.subCategory] ? i[e.generator.subCategory] : i);
            var n = this.renderer.getRenderEngine().createMesh(i.geometry, i.material);
            null != i.doubleSided && (n.doubleSided = i.doubleSided), this.setElevation(e.generator.position), n.position.copy(e.generator.position);
            var o = e.generator.scale || 1;
            if (n.scale.set(o, o, o), n.rotation.z = e.generator.rotation || 0, n.updateMatrix(), i.renderPassToHandle)
                for (var a = 0; a < i.renderPassToHandle.length; ++a) n.handleRenderPass[i.renderPassToHandle[a]] = !0;
            if (i.skeleton) {
                var s = i.skeleton.clone();
                s.playAnimation(0), s.computeAnim(5e3 * Math.random()), n.setSkeleton(s), i.animMinSpeed && (n.animSpeed = i.animMinSpeed + Math.random() * (1 - i.animMinSpeed))
            }
            return this.addToScene(n, e.animationOptions), r.isArray(e.meshs) ? e.meshs.push(n) : console.log("should not happen !"), t && t(e), n
        }, b.loadMultiPoint = function(e) {
            e.meshs = [];
            for (var t = this.detailsConfig[e.detailCategory], i = 0; i < e.generators.length; ++i) e.generator = e.generators[i], this.loadPoint(e, null);
            t.keepGenerators || delete e.generators, e.handleVisibilityCallback(e)
        }, b.loadPointSkinned = function(e, t, i, n) {
            var o = this.findMeshAndBoneIdx(e, t, i, n),
                a = o.mesh.miniSkinQuat[o.miniSkinQuatIndex];
            v.set(e.generator.position.x, e.generator.position.y, e.generator.position.z), this.setElevation(v), v.subSelf(o.mesh.position);
            var s = e.generator.scale || 1;
            return a.set(v.x, v.y, v.z, s), o.mesh.updateSkeleton(), o.mesh.itemToBoneMapping[o.miniSkinQuatIndex] = e, r.isArray(e.meshs) ? -1 == e.meshs.indexOf(o.mesh) && e.meshs.push(o.mesh) : e.meshs = o.mesh, o.color
        }, b.loadMultiPointSkinned = function(e) {
            e.meshs = [], e.isMultiPointSkinned = !0, this._itemsToPack.push(e)
        }, b.loadGeometry = function(e, t) {
            if (e.generator) {
                var i = this.detailsConfig[e.detailCategory],
                    n = this.renderer.getRenderEngine().createMesh(e.generator.geometry, i.material);
                if (null != i.doubleSided && (n.doubleSided = i.doubleSided), n.position.copy(e.generator.position), n.updateMatrix(), i.renderPassToHandle)
                    for (var r = 0; r < i.renderPassToHandle.length; ++r) n.handleRenderPass[i.renderPassToHandle[r]] = !0;
                e.meshs.push(n), this.addToScene(n, e.animationOptions), t && t(e)
            }
        }, b.loadMultiGeometries = function(e) {
            e.meshs = [];
            for (var t = this.detailsConfig[e.detailCategory], i = 0; i < e.generators.length; ++i) e.generator = e.generators[i], this.loadGeometry(e, null);
            t.keepGenerators || delete e.generators, e.handleVisibilityCallback(e)
        }, b.loadPacked = function(e) {
            if (e.meshs = [], e.blockMeshs = {}, this.detailsConfig[e.detailCategory].hasLod && (this.itemsWithLod[e.id] = e, e.lodMeshs = []), this._itemsToPack.push(e), this._categoryMeshGrouping && r.contains(this._atlasableItems, e.detailCategory) && e.generators.length > 0) {
                var t = this._groupedBlockMeshes[e.tileKey];
                t || (t = this._createGroupedBlockMeshData(), this._groupedBlockMeshes[e.tileKey] = t), t.items.push(e), e.maxVisibleDistance = Math.max(e.maxVisibleDistance, t.maxVisibleDistance), t.maxVisibleDistance = e.maxVisibleDistance
            }
        }, b.loadVehiclePacked = function(e, t) {
            t.animatedMeshs = [], t.blockMeshs = {}, t.vehicleConfig = e, this._itemsToPack.push(t)
        }, b.loadAerialWaysPacked = function(e) {
            e.meshs = [], e.animatedMeshs = [], e.blockMeshs = {};
            for (var t = 0; t < e.generators.length; ++t) e.generator = e.generators[t], this.loadGeometry(e);
            e.handleVisibilityCallback(e), this._itemsToPack.push(e)
        }, b.loadAnimPacked = function(e) {
            e.meshs = [], e.blockMeshs = {}, this._itemsToPack.push(e)
        }, b.updateItemWithLodVisibility = function(e) {
            if (!e.isDeleted) {
                e.isLodVisible = !1;
                var t = this.renderer.getFrustumFull(),
                    i = e.tileBounds;
                if (t.xMin > i.xMax || t.xMax < i.xMin || t.yMin > i.yMax || t.yMax < i.yMin) this.hideItem(e);
                else {
                    if (this.detailsConfig[e.detailCategory].hasLod) {
                        var n = this.renderer.getPosCamera(),
                            r = e.tilePosition,
                            o = this.renderer.getTargetCamera().subSelf(n).normalize(),
                            a = r.clone().subSelf(n).normalize().multiplyScalar(e.tileRadius),
                            s = r.clone().subSelf(a),
                            l = s.clone().subSelf(n);
                        if (o.dot(l) <= 0) e.isLodVisible = !1;
                        else {
                            var h = this.renderer.getPosCamera().distanceTo(s);
                            h > this.renderer.conf.get("details.lodDistance") && (e.isLodVisible = !0)
                        }
                    }
                    this.updateMeshsItemVisibility(e)
                }
                this.renderer.forceRender()
            }
        }, b.hideItem = function(e) {
            function t(e) {
                for (var t = 0; t < e.length; ++t) {
                    var n = e[t];
                    0 != n.visible && (n.visible = !1, i = !0)
                }
            }
            var i = !1;
            e.lodMeshs && t(e.lodMeshs), e.meshs && t(e.meshs), i && this.renderer.forceUpdateShadow()
        }, b.updateMeshsItemVisibility = function(e) {
            function t(e, t) {
                for (var n = 0; n < e.length; ++n) {
                    var r = e[n];
                    r.visible != t && (r.visible = t, i = !0)
                }
            }
            var i = !1;
            e.lodMeshs && t(e.lodMeshs, e.isLodVisible && e.isItemVisibleWithinDistance), e.meshs && t(e.meshs, !e.isLodVisible && e.isItemVisibleWithinDistance), e.animatedMeshs && t(e.animatedMeshs, e.isItemVisibleWithinDistance), i && this.renderer.forceUpdateShadow()
        }, b.onCameraUpdated = function() {
            r.each(this.itemsWithLod, function(e) {
                this.updateItemWithLodVisibility(e)
            }, this)
        }, b.clearPackBlockWorker = function() {
            this._itemsToPack = []
        }, b.packBlockWorker = function(e) {
            if (this._packBlockStartDate != e) {
                for (; this._itemsToPack.length && this._itemsToPack[0].isDeleted;) this._itemsToPack.shift();
                this._itemsToPack = r.sortBy(this._itemsToPack, function(e) {
                    return this.renderer.computeDistanceToCenter(e.tilePosition)
                }, this), this._packBlockStartDate = e
            }
            if (this._itemsToPack.length > 0) {
                var t = this._itemsToPack[0];
                if (t.isDeleted) this._itemsToPack.shift();
                else {
                    if (t.generators.length) return t.isMultiPointSkinned ? r.bind(function() {
                        var e = t.generators.shift();
                        t.generator = e, this.loadPointSkinned(t, e.userData, !1, !0)
                    }, this) : r.bind(function() {
                        this.packMeshInBlock(t)
                    }, this);
                    t.isMultiPointSkinned || this.onItemPackDone(t), this._itemsToPack.shift(), t.handleVisibilityCallback(t)
                }
            }
            return null
        }, b._pickDetailsConf = function(e, t, i) {
            return e.hasSubCategories ? e = e[t] : i.detailCategory == m.AERIAl_LINE && t && (e = this.detailsConfig[i.detailCategory][t]), e
        }, b._findType = function(e, t) {
            var i;
            return i = e.detailCategory == m.AERIAl_LINE ? t.cabinType : t.userData
        }, b.packMeshInBlock = function(e) {
            function t() {
                if (!s) {
                    s = new p, s.setRotation(v.set(0, 0, i.rotation || 0));
                    var t = i.scale || 1;
                    s.scale(v.set(t, t, t));
                    var n = v.set(i.position.x, i.position.y, i.position.z);
                    o.setElevation(n), n.x -= e.tilePosition.x, n.y -= e.tilePosition.y, s.setPosition(n)
                }
                return s
            }
            var i = e.generators.shift(),
                n = this._findType(e, i),
                r = this.detailsConfig[e.detailCategory],
                o = this;
            if (r) {
                r = this._pickDetailsConf(r, n, e);
                var a = e.blockMeshs[n],
                    s = null,
                    l = null;
                if (r.colors && (l = new d(r.colors[Math.floor(Math.random() * r.colors.length)])), e.vehicleConfig) this._packVehicleInBlock(a, e, n, r, i);
                else if (e.detailCategory == m.AERIAl_LINE) n && i.anims && this._packAerialWayInBlock(a, e, n, i);
                else if (r.skeleton) this._packSkeletonAnimationInBlock(a, e, n, r, i);
                else if (r.material.useMiniSkinning()) e.generator = i, null == e.skinnedMeshs && (e.skinnedMeshs = {}), null == e.skinnedMeshs[n] && (e.skinnedMeshs[n] = []), l = this.loadPointSkinned(e, n, !0, !1);
                else {
                    null == a ? a = this._createBlockMesh(e, n) : this._verifyBlockMeshCapacity(a, r.geometry);
                    var h = a.currentGeometryIndex;
                    a.geometries[h].append(r.geometry, t(), l), !l && r.geometry.fixedColor && (a.geometries[h].fixedColor = r.geometry.fixedColor.clone())
                }
                if (r.lodMaterial) {
                    null == a ? a = this._createBlockMesh(e, n) : this._verifyBlockLodMeshCapacity(a, r.lodGeometry);
                    var u = a.currentLodGeometryIndex;
                    a.lodGeometries[u].append(r.lodGeometry, t(), l), !l && r.geometry.fixedColor && (a.lodGeometries[u].fixedColor = r.geometry.fixedColor.clone())
                }
            } else console.log("unknown lod ModelGeometry " + n)
        }, b._packVehicleInBlock = function(e, t, i, n, r) {
            null == e && (e = this._createBlockMesh(t, i), e.geometries[0] = n.packedGeometry), r.baseAnimAdvancement || (r.baseAnimAdvancement = Math.random());
            for (var o = 0; o < r.vehicleCount; ++o) {
                e.boneCounts[e.currentGeometryIndex] >= n.packedGeometryBoneCount && (e.geometries.push(n.packedGeometry), e.boneCounts.push(0), e.currentGeometryIndex++);
                var a = r.baseAnimAdvancement,
                    s = a + o / r.vehicleCount,
                    l = t.vehicleConfig,
                    h = r.speedInMPerMs || l.speedInMPerMs;
                this._createVehicleAnimation(t, e, r, h, s), e.boneCounts[e.currentGeometryIndex] += 1
            }
        }, b._packAerialWayInBlock = function(e, t, i, n) {
            var r = this.detailsConfig[t.detailCategory][i],
                o = this.options.aerial_line[i];
            null == e && (e = this._createBlockMesh(t, i), e.geometries[0] = r.packedGeometry);
            for (var a = 0; a < n.anims.length; ++a) {
                var s = n.anims[a],
                    l = o.fixedCount;
                if (!l) {
                    var h = s[0].distanceTo(s[s.length - 1]);
                    l = Math.max(1, Math.floor(h / o.spacing))
                }
                for (var u = 0; l > u; ++u) {
                    e.boneCounts[e.currentGeometryIndex] >= r.packedGeometryBoneCount && (e.geometries.push(r.packedGeometry), e.boneCounts.push(0), e.currentGeometryIndex++);
                    var d = u / l;
                    this._createAerialWayAnimation(t, e, s, o.speedInMPerMs, d), e.boneCounts[e.currentGeometryIndex] += 1
                }
            }
        }, b._packSkeletonAnimationInBlock = function(e, t, i, n, r) {
            null == e && (e = this._createBlockMesh(t, i), e.geometries[0] = n.packedGeometry, e.isPackedSkeletonAnimation = !0), e.boneCounts[e.currentGeometryIndex] >= n.packedGeometryBoneCount && (e.geometries.push(n.packedGeometry), e.boneCounts.push(0), e.currentGeometryIndex++);
            var o = r.rotation || 0,
                a = r.scale || 1,
                s = 5e3 * Math.random(),
                l = 1;
            n.animMinSpeed && (l = n.animMinSpeed + Math.random() * (1 - n.animMinSpeed)), this._createPackedModelAnimation(e, n.skeleton, {
                position: r.position,
                rotation: o,
                scale: a,
                timeOffset: s,
                speed: l
            }), e.boneCounts[e.currentGeometryIndex] += n.skeleton.bones.length
        }, b._createBlockMesh = function(e, t) {
            var i = null;
            if (this._categoryMeshGrouping) {
                var n = this._groupedBlockMeshes[e.tileKey],
                    o = this.detailsConfig[e.detailCategory];
                r.contains(this._atlasableItems, e.detailCategory) && (i = n.blockMesh, this._verifyBlockMeshCapacity(i, o.geometry))
            }
            return null == i && (i = this._createBlockMeshData()), e.blockMeshs[t] = i, i
        }, b._createBlockMeshData = function() {
            var e = {
                currentGeometryIndex: 0,
                currentLodGeometryIndex: 0,
                boneCounts: [0],
                geometries: [new h],
                lodGeometries: [new h],
                multiAnimations: [],
                animMeshPosition: [],
                isGrouped: !1
            };
            return e.geometries[0].clearOnWebglLoad = !0, e.lodGeometries[0].clearOnWebglLoad = !0, e.visible = !1, e
        }, b._createGroupedBlockMeshData = function() {
            var e = {
                items: [],
                blockMesh: this._createBlockMeshData(),
                maxVisibleDistance: 0
            };
            return e.blockMesh.isGrouped = !0, e
        }, b._verifyBlockMeshCapacity = function(e, t) {
            var i = this.renderer.getRenderEngine(),
                n = e.geometries[e.currentGeometryIndex];
            e.boneCounts[e.currentGeometryIndex] < i._shaderHandler.maxBonesCount && n.verifyAppend(t) || (e.geometries.push(new h), e.boneCounts.push(0), e.currentGeometryIndex++, e.geometries[e.currentGeometryIndex].clearOnWebglLoad = !0)
        }, b._verifyBlockLodMeshCapacity = function(e, t) {
            var i = e.lodGeometries[e.currentLodGeometryIndex];
            i.verifyAppend(t) || (e.lodGeometries.push(new h), e.currentLodGeometryIndex++, e.lodGeometries[e.currentLodGeometryIndex].clearOnWebglLoad = !0)
        }, b._createVehicleAnimation = function(e, t, i, n, r) {
            this._handleMultiAnimationInit(t, i.position), v.sub(i.position, t.animMeshPosition[t.currentGeometryIndex]);
            var o = this._createAnimation(i.animPoints, v, n),
                a = r * o.durationMs;
            t.multiAnimations[t.currentGeometryIndex].addAnimation(o, a)
        }, b._createAerialWayAnimation = function(e, t, i, n, r) {
            this._handleMultiAnimationInit(t, i.pivot), v.sub(i.pivot, t.animMeshPosition[t.currentGeometryIndex]);
            var o = this._createAnimation(i, v, n),
                a = r * o.durationMs;
            t.multiAnimations[t.currentGeometryIndex].addAnimation(o, a)
        }, b._createPackedModelAnimation = function(e, t, i) {
            var n = i.position,
                r = i.rotation,
                o = i.scale,
                a = i.timeOffset,
                s = i.speed;
            this._handleMultiAnimationInit(e, n), y.identity(), v.sub(n, e.animMeshPosition[e.currentGeometryIndex]), y.setPosition(v), v.set(0, 0, r), y.setRotation(v), v.set(o, o, o), y.scale(v);
            var l = t.deepClone();
            u.transformSkeletonAnimation(l, 0, 0, l.bones.length, y), e.multiAnimations[e.currentGeometryIndex].addAnimation(l.animations[0], a, s)
        }, b._createAnimation = function(e, t, i) {
            for (var n = [], r = 0; r < e.length; r++) {
                var o = e[r].clone();
                o.x += t.x, o.y += t.y, n[r] = o
            }
            return u.pivotAnimationFromPointsListAndSpeed(n, i, !0)
        }, b._handleMultiAnimationInit = function(e, t) {
            e.multiAnimations[e.currentGeometryIndex] || (e.multiAnimations[e.currentGeometryIndex] = u.createMultiAnimation()), e.animMeshPosition[e.currentGeometryIndex] || (e.animMeshPosition[e.currentGeometryIndex] = t.clone())
        }, b.onItemPackDone = function(e) {
            r.each(e.blockMeshs, r.bind(this._onItemPackDoneHandleMesh, this, e)), e.blockMeshs = null, this.updateItemWithLodVisibility(e)
        }, b._onItemPackDoneHandleMesh = function(e, t, i) {
            var n = this.detailsConfig[e.detailCategory];
            n.hasSubCategories ? n = n[i] : e.detailCategory == m.AERIAl_LINE && (n = this.detailsConfig[e.detailCategory][i]);
            var r, o, a = n.material,
                s = this.renderer.getRenderEngine(),
                l = this._groupedBlockMeshes[e.tileKey],
                h = !0;
            if (t.isGrouped && l) {
                var u = l.items.indexOf(e);
                u > -1 && (l.items.splice(u, 1), h = 0 == l.items.length), h && 0 == l.items.length && delete this._groupedBlockMeshes[e.tileKey]
            }
            if (h) {
                if (e.vehicleConfig) this._createAnimatedVehicleMeshes(e, n, t);
                else if (e.detailCategory == m.AERIAl_LINE) this._createAerialLineVehiclesMeshes(e, n, t);
                else if (t.isPackedSkeletonAnimation) this._createPackedAnimMeshes(e, n, t);
                else if (!a.useMiniSkinning())
                    for (r = 0; r < t.geometries.length; r++) o = s.createMesh(t.geometries[r], a), this._initMesh(e, o, n.renderPassToHandle), e.meshs.push(o);
                var d = n.lodMaterial;
                if (null != d)
                    for (r = 0; r < t.lodGeometries.length; r++) {
                        var c = s.createMesh(t.lodGeometries[r], d);
                        this._initMesh(e, c, n.lodRenderPassToHandle), c.doubleSided = !0, e.lodMeshs.push(c)
                    }
            }
        }, b._initMesh = function(e, t, i) {
            var n = this.detailsConfig[e.detailCategory];
            if (null != n.doubleSided && (t.doubleSided = n.doubleSided), t.position.copy(e.tilePosition), t.updateMatrix(), i)
                for (var r = 0; r < i.length; ++r) t.handleRenderPass[i[r]] = !0;
            t.geometry.clearOnWebglLoad = !0, this.addToScene(t, e.animationOptions)
        }, b._createPackedAnimMeshes = function(e, t, i) {
            var n, r = t.material;
            for (n = 0; n < i.geometries.length; n++) {
                var o = t.packedGeometryBoneCount,
                    a = this._createPackedAnimMesh(i, r, n, o, t);
                if (a.doubleSided = t.doubleSided, t.renderPassToHandle)
                    for (var s = 0; s < t.renderPassToHandle.length; ++s) a.handleRenderPass[t.renderPassToHandle[s]] = !0;
                this.addToScene(a, e.animationOptions), e.meshs.push(a)
            }
        }, b._createAnimatedVehicleMeshes = function(e, t, i) {
            var n, o = e.vehicleConfig,
                a = t.material;
            for (n = 0; n < i.geometries.length; n++) {
                var s = this._createAnimatedVehicleMesh(i, a, n, t),
                    l = s.handleRenderPass;
                l.colorBeforeProcess = !0, l.depth = !0, l.shadowDepth = !0, l.reflected = !0, o.handleRenderPass && r.extend(l, o.handleRenderPass), this.addToScene(s, e.animationOptions), e.animatedMeshs.push(s)
            }
        }, b._createAerialLineVehiclesMeshes = function(e, t, i) {
            var n, r = t.material;
            if (i.multiAnimations.length > 0)
                for (n = 0; n < i.geometries.length; n++) {
                    var o = this._createAnimatedVehicleMesh(i, r, n, t);
                    o.handleRenderPass.colorBeforeProcess = !0, o.handleRenderPass.shadowDepth = !0, o.doubleSided = t.doubleSided, this.addToScene(o, e.animationOptions), e.animatedMeshs.push(o)
                }
        }, b._createAnimatedVehicleMesh = function(e, t, i, n) {
            var r = this.renderer.getRenderEngine(),
                o = n.packedGeometryBoneCount,
                a = r.createMesh(e.geometries[i], t),
                s = e.multiAnimations[i],
                l = u.createSkeletonForMultiAnimation(s);
            a.setSkeleton(l);
            var h = !1,
                d = e.boneCounts[i];
            return d != o && (h = !0), h && (n.geometry.getIndexCount() > 0 ? a.useIndexedVertexSubArray(0, d * n.geometry.getIndexCount()) : a.useVertexSubArray(0, d * n.geometry.getPointsCount())), a.position.copy(e.animMeshPosition[i]), a.updateMatrix(), a
        }, b._createPackedAnimMesh = function(e, t, i, n, r) {
            var o = this.renderer.getRenderEngine(),
                a = r.skeleton,
                s = o.createMesh(e.geometries[i], t),
                l = e.multiAnimations[i],
                h = a.bones.length,
                d = !1,
                c = e.boneCounts[i];
            c != n && (d = !0);
            var f = c / h,
                p = u.createSkeletonForPackedAnimatedMesh(a, f);
            return p.setAnimations([l]), p.playAnimation(0), p.computeAnim(0), s.setSkeleton(p), d && (r.geometry.getIndexCount() > 0 ? s.useIndexedVertexSubArray(0, f * r.geometry.getIndexCount()) : s.useVertexSubArray(0, f * r.geometry.getPointsCount())), this.setElevation(e.animMeshPosition[i]), s.position.copy(e.animMeshPosition[i]), s.updateMatrix(), s
        }, b.findMeshAndBoneIdx = function(e, t, i, n) {
            var r, o, a = this.detailsConfig[e.detailCategory];
            a.hasSubCategories && t ? (o = a[t], r = e.skinnedMeshs ? e.skinnedMeshs[t] : o.meshs) : (o = a, r = o.meshs);
            var s, l = null,
                h = -1;
            if (!r) throw new Error("No meshes found for detail of category " + e.detailCategory + (a.hasSubCategories && t ? " (sub-category " + t + ")" : ""));
            for (s = 0; null == l && s < r.length; ++s)
                for (var u = r[s], d = 0; null == l && d < o.maxCountPerMesh; ++d) null == u.itemToBoneMapping[d] && (h = d, l = u);
            if (null == l || -1 == h) {
                if (l = this.renderer.getRenderEngine().createMesh(o.geometry, o.material), l.visible = n, null != o.doubleSided && (l.doubleSided = o.doubleSided), o.renderPassToHandle)
                    for (s = 0; s < o.renderPassToHandle.length; ++s) l.handleRenderPass[o.renderPassToHandle[s]] = !0;
                l.itemToBoneMapping = [], l.miniSkinQuat = [];
                var c = new f;
                for (l.position.copy(e.tilePosition), l.updateMatrix(), c.set(-e.tilePosition.x, -e.tilePosition.y, -e.tilePosition.z, 1), s = 0; s < o.maxCountPerMesh; ++s) l.miniSkinQuat.push(c.clone()), l.itemToBoneMapping.push(null);
                this.addToScene(l, e.animationOptions), l.baseList = r, r.unshift(l), h = 0
            }
            var p = null;
            return i && (p = l.geometry.colorsMapping[h]), {
                mesh: l,
                miniSkinQuatIndex: h,
                color: p
            }
        }, b.updateMesh = function(e, t) {
            var i = r.all(t.itemToBoneMapping, function(e) {
                return null == e
            });
            if (i) {
                var n = t.baseList.indexOf(t);
                t.baseList.splice(n, 1), delete t.baseList, delete t.itemToBoneMapping, e.forceUpdateShadow(), e.getRenderEngine().freeMesh(t)
            } else t.updateSkeleton()
        }, b.loadAerialWays = function(e) {
            e.meshs = [], e.animatedMeshs = [];
            for (var t = 0; t < e.generators.length; ++t) {
                var i = e.generators[t],
                    n = i.cabinType;
                if (n && i.anims)
                    for (var r = this.detailsConfig[e.detailCategory][n], o = this.options.aerial_line[n], a = 0; a < i.anims.length; ++a) {
                        var s = i.anims[a],
                            l = o.fixedCount;
                        if (!l) {
                            var h = s[0].distanceTo(s[s.length - 1]);
                            l = Math.max(1, Math.floor(h / o.spacing))
                        }
                        for (var d = u.pivotAnimationFromPointsListAndSpeed(s, o.speedInMPerMs, !0), c = 0; l > c; ++c) {
                            var f = this.renderer.getRenderEngine().createMesh(r.geometry, r.material);
                            f.handleRenderPass.colorBeforeProcess = !0, f.handleRenderPass.shadowDepth = !0, r.doubleSided && (f.doubleSided = !0);
                            var p = r.skeleton.clone();
                            p.setAnimations([d]), p.playAnimation(0), p.computeAnim(c / l * d.durationMs), f.setSkeleton(p), f.position.copy(s.pivot), f.updateMatrix(), this.addToScene(f, e.animationOptions), e.animatedMeshs.push(f)
                        }
                    }
                e.generator = i, this.loadGeometry(e)
            }
            e.handleVisibilityCallback(e)
        }, b.loadVehicle = function(e, t) {
            function i(e) {
                e.animatedMeshs = [];
                for (var i = this.detailsConfig[e.detailCategory], n = 0; n < e.generators.length; ++n)
                    for (var o = e.generators[n], a = o.speedInMPerMs || t.speedInMPerMs, s = u.pivotAnimationFromPointsListAndSpeed(o.animPoints, a, !0), l = null == o.baseAnimAdvancement ? Math.random() : o.baseAnimAdvancement, h = this.renderer.getRenderEngine(), d = 0; d < o.vehicleCount; ++d) {
                        var c = h.createMesh(i.geometry, i.material),
                            f = c.handleRenderPass;
                        f.colorBeforeProcess = !0, f.depth = !0, f.shadowDepth = !0, f.reflected = !0, t.handleRenderPass && r.extend(f, t.handleRenderPass);
                        var p = i.skeleton.clone();
                        p.setAnimations([s]), p.playAnimation(0), p.computeAnim((l + d / o.vehicleCount) * s.durationMs), c.setSkeleton(p), c.position.copy(o.position), c.updateMatrix(), this.addToScene(c, e.animationOptions), e.animatedMeshs.push(c)
                    }
                e.handleVisibilityCallback(e)
            }

            function n(e) {
                e.clearOnWebglLoad = !0, this._modelCache.setModelColor(t.model, t.color), e.setRigidSkin(0), o.geometry = e, o.skeleton = u.createSkeleton(1), this._vehiclePacking ? this.packModel(t.model, o, r.bind(function() {
                    this.binaryReceived()
                }, this)) : this.binaryReceived()
            }
            var o = {
                loadCallback: this._vehiclePacking ? r.bind(this.loadVehiclePacked, this, t) : r.bind(i, this),
                keepGenerators: this._vehiclePacking ? !0 : !1,
                material: e,
                color: t.color
            };
            return this.loadBinary(t.model, r.bind(n, this)), o
        }, b.setElevation = function(e) {
            if (this.renderer.map.elevation) {
                var t = this.renderer.findHeight(e);
                null != t && (e.z += t)
            }
        }, b.loadItem = function(e) {
            var t = this.detailsConfig[e.detailCategory];
            t && (t.loadCallback && t.loadCallback(e), t.keepGenerators || e.isMultiPointSkinned || delete e.generators)
        }, b.unloadItem = function(e) {
            if (e.isDeleted) return void console.error("Item already deleted", e);
            var t = this.detailsConfig[e.detailCategory];
            if (t) {
                t.preDeleteCallback && t.preDeleteCallback(e);
                var i = this.renderer.getRenderEngine();
                this._unloadItemMeshs(t, i, e), this._unloadItemAnimatedMeshs(t, i, e), this._unloadItemLodMeshs(t, i, e)
            }
            e.isDeleted = !0, this.renderer.forceUpdateShadow()
        }, b._unloadItemMeshs = function(e, t, i) {
            var n, r;
            if (i.meshs) {
                if (e.hasSubCategories || e.material.useMiniSkinning()) {
                    for (n = 0; n < i.meshs.length; ++n) {
                        var o = i.meshs[n];
                        if (o.itemToBoneMapping) {
                            var a = o.position.clone().negate();
                            for (r = 0; r < o.itemToBoneMapping.length; ++r) o.itemToBoneMapping[r] == i && (o.miniSkinQuat && o.miniSkinQuat[r].set(a.x, a.y, a.z, 1), o.itemToBoneMapping[r] = null);
                            this.updateMesh(this.renderer, o)
                        }
                    }
                    delete i.skinnedMeshs
                } else
                    for (n = 0; n < i.meshs.length; ++n) t.freeMesh(i.meshs[n]);
                delete i.meshs
            }
        }, b._unloadItemAnimatedMeshs = function(e, t, i) {
            var n;
            if (i.animatedMeshs) {
                for (n = 0; n < i.animatedMeshs.length; ++n) t.freeMesh(i.animatedMeshs[n]);
                delete i.animatedMeshs
            }
        }, b._unloadItemLodMeshs = function(e, t, i) {
            var n;
            if (e.hasLod) {
                if (i.lodMeshs) {
                    for (n = 0; n < i.lodMeshs.length; ++n) t.releaseObject(i.lodMeshs[n]);
                    delete i.lodMeshs
                }
                delete this.itemsWithLod[i.id]
            }
        }, b._getTreeLodMaterial = function(e) {
            var t = this._treeLodMaterials[e];
            return t || (t = this._createTreeLodMaterial(e), this._treeLodMaterials[e] = t), t
        }, b._createTreeLodMaterial = function(e) {
            var t = this.renderer.getRenderEngine(),
                i = t.getShadowExtensionName(),
                n = t.createMaterial("dirlight_texture" + i),
                r = t.loadTexture(e);
            return r.generateMipmaps = !1, r.magFilter = r.minFilter = l.LinearFilter, n.uniforms.tex0.texture = r, n.transparent = l.Mask, n
        }
    }, {
        "../../utils/WorkProcessor": 416,
        "./DetailsCategories": 334,
        engine: 10,
        events: 99,
        underscore: 207,
        util: 212
    }],
    339: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapRenderer = e, this._mode = r, this._redChannelMixer = [1, 0, 0], this._greenChannelMixer = [0, 1, 0], this._blueChannelMixer = [0, 0, 1], this._isSepia = !1, this._isBlackAndWhite = !1
        }
        var r = 0,
            o = 1,
            a = 2;
        t.exports = n, n.prototype.setMode = function(e) {
            this._mode = e
        }, n.prototype.getMode = function() {
            return this._mode
        }, n.prototype.setRedChannelMixer = function(e) {
            this._redChannelMixer = e, this._isSepia = !1, this._isBlackAndWhite = !1, this._setColorFilterValues()
        }, n.prototype.getRedChannelMixer = function() {
            return this._redChannelMixer
        }, n.prototype.setGreenChannelMixer = function(e) {
            this._greenChannelMixer = e, this._isSepia = !1, this._isBlackAndWhite = !1, this._setColorFilterValues()
        }, n.prototype.getGreenChannelMixer = function() {
            return this._greenChannelMixer
        }, n.prototype.setBlueChannelMixer = function(e) {
            this._blueChannelMixer = e, this._isSepia = !1, this._isBlackAndWhite = !1, this._setColorFilterValues()
        }, n.prototype.getBlueChannelMixer = function() {
            return this._blueChannelMixer
        }, n.prototype.setSepiaEnabled = function(e) {
            this._isSepia = e, this._isBlackAndWhite = !1, e ? (this._mode = o, this._redChannelMixer = [.3588, .7044, .1368], this._greenChannelMixer = [.299, .587, .114], this._blueChannelMixer = [.2392, .4696, .0912]) : this._mode = r, this._setColorFilterValues()
        }, n.prototype.setBlackAndWhiteEnabled = function(e) {
            this._isSepia = e, this._isBlackAndWhite = !1, e ? this._mode = a : this._mode = r, this._setColorFilterValues()
        }, n.prototype.reset = function() {
            this._mode = r, this._redChannelMixer = [1, 0, 0], this._greenChannelMixer = [0, 1, 0], this._blueChannelMixer = [0, 0, 1], this._isSepia = !1, this._isBlackAndWhite = !1, this._setColorFilterValues()
        }, n.prototype._setColorFilterValues = function() {
            if (this._mapRenderer.conf.get("renderer.colorFilterEnabled")) {
                var e = this._mapRenderer.getRenderEngine().getShaderLibrary().uniforms;
                e.colorFilter.colorChannelMixer && e.colorFilter.colorChannelMixer.value.set(this._redChannelMixer[0], this._greenChannelMixer[0], this._blueChannelMixer[0], 0, this._redChannelMixer[1], this._greenChannelMixer[1], this._blueChannelMixer[1], 0, this._redChannelMixer[2], this._greenChannelMixer[2], this._blueChannelMixer[2], 0, 0, 0, 0, 1), e.colorFilter.colorFilterMode && (e.colorFilter.colorFilterMode.value = this._mode)
            }
            this._mapRenderer._tileManager.setTilesDirty()
        }
    }, {}],
    340: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.renderer = e;
            var t = this.renderer.getRenderEngine();
            this.shaderLibrary = t._shaderLibrary;
            var i = t.loadTexture(o("data/textures/WaterBumpAndReflection.png"));
            i.generateMipmaps = !1, i.minFilter = s.LinearFilter, this.shaderLibrary.uniforms.water.waterBumpAndReflection.texture = i, this.shaderLibrary.uniforms.envMap.envTexture.texture = t.loadTexture(this.renderer.conf.get("environment.envmapPath"), s.MirroredRepeatWrapping);
            var n = t.createMaterial("sky", s.NoBlending);
            n.depthWrite = !1;
            var a = t.loadTexture(o("data/textures/LightNoise.jpg"));
            a.generateMipmaps = !1, a.minFilter = a.magFilter = s.LinearFilter, n.uniforms.cloudsTexture.texture = a;
            var u = o("data/textures/GradientSky.png");
            n.uniforms.gradientTexture.texture = t.loadTexture(u, {
                repeat: s.ClampToEdgeWrapping
            }), this.shaderLibrary.uniforms.fog.skyTexture.texture = n.uniforms.gradientTexture.texture, this.shaderLibrary.uniforms.fog.sunDirection = n.uniforms.sunDirection, this._skyMesh = t.createMesh(null, n), this._skyMesh.doubleSided = !0, this._skyMesh.handleRenderPass.colorBeforeProcess = !0;
            var f = r.bind(function(e, i) {
                e || (i.clearOnWebglLoad = !0, this._skyMesh.construct(i, n), t.getScene().add(this._skyMesh)), delete this._skyLoader
            }, this);
            this._skyLoader = new d(o("data/models/Lib_Object/LibOut_Sky.bis"), f), this.lensFlareConf = {
                texture: o("data/textures/LensFlare.png"),
                particles: [{
                    scale: 1200,
                    pos: -.25,
                    uvIdx: 1,
                    color: 16777215,
                    alpha: .7
                }, {
                    scale: 500,
                    pos: 0,
                    uvIdx: 1,
                    color: 16776928,
                    alpha: .45
                }, {
                    scale: 100,
                    pos: .2,
                    uvIdx: 3,
                    color: 16777215,
                    alpha: .25
                }, {
                    scale: 80,
                    pos: .23,
                    uvIdx: 3,
                    color: 16771785,
                    alpha: .52
                }, {
                    scale: 80,
                    pos: .4,
                    uvIdx: 2,
                    color: 14745592,
                    alpha: .31
                }, {
                    scale: 50,
                    pos: .6,
                    uvIdx: 2,
                    color: 16777215,
                    alpha: .4
                }, {
                    scale: 120,
                    pos: .8,
                    uvIdx: 3,
                    color: 16777215,
                    alpha: .3
                }, {
                    scale: 90,
                    pos: .8,
                    uvIdx: 3,
                    color: 16575743,
                    alpha: .41
                }, {
                    scale: 50,
                    pos: .85,
                    uvIdx: 2,
                    color: 14742783,
                    alpha: .7
                }, {
                    scale: 35,
                    pos: 1.1,
                    uvIdx: 3,
                    color: 16777215,
                    alpha: .31
                }, {
                    scale: 25,
                    pos: 1.25,
                    uvIdx: 3,
                    color: 16777215,
                    alpha: .25
                }]
            };
            var p = new l(s.POINTS);
            p.clearOnWebglLoad = !0, p._positionArray = [], p._colorArray = [];
            for (var m = this.lensFlareConf.particles, g = new h, _ = 0; _ < m.length; ++_) {
                var v = m[_];
                p._positionArray.push(v.pos, v.uvIdx, v.scale), g.setHex(v.color), p._colorArray.push(g.r, g.g, g.b, v.alpha)
            }
            var y = t.createMaterial("lensFlare");
            y.depthWrite = !1, y.transparent = s.Gradual, y.uniforms.tex0.texture = t.loadTexture(this.lensFlareConf.texture), this._lensFlareMesh = t.createMesh(p, y), this._lensFlareMesh.visible = !1, t.getScene().add(this._lensFlareMesh), this.envModifiers = [], this.helper = new c({
                renderer: this.renderer,
                shaderLibrary: this.shaderLibrary,
                sunDir: this._skyMesh.material.uniforms.sunDirection.value
            }), this._cameraUpdatedHandler = r.bind(this.cameraUpdated, this), this._enter3dHandler = r.bind(this.show, this), this._enter2dHandler = r.bind(this.hide, this), e.on("cameraChanged", this._cameraUpdatedHandler), e.on("enter3d", this._enter3dHandler), e.on("enter2d", this._enter2dHandler)
        }
        var r = e("underscore"),
            o = e("../../utils/StaticFileResolver"),
            a = e("engine"),
            s = a.Constants,
            l = a.Geometry,
            h = a.Color,
            u = a.MathHelper,
            d = a.BinaryLoader,
            c = e("./EnvironmentHelper");
        n.prototype.hide = function() {
            this._skyMesh.visible = !1, this.updateLensFlare()
        }, n.prototype.show = function() {
            this._skyMesh.visible = !0, this.updateLensFlare()
        }, n.prototype.updateCamera = function() {
            var e = this.renderer._cameraManager;
            this.cameraUpdated(e.camera, e.cameraTarget)
        }, n.prototype.cameraUpdated = function(e) {
            if (this._skyMesh.visible) {
                var t = e.far;
                this.shaderLibrary.uniforms.fog.fogNearFar.value.set(.55 * t, .8 * t), this._skyMesh.position.copy(e.position), this._skyMesh.position.z = 0, this._skyMesh.scale.set(t, t, t), this._skyMesh.updateMatrix(), this.updateLensFlare()
            }
        }, n.prototype.fadeLensFlareIn = function() {
            var e = this._lensFlareMesh.material.uniforms.fAlpha;
            e.value = Math.min(e.value + .05, 1), e.value < 1 && (this.fadeTimeout = window.setTimeout(r.bind(this.fadeLensFlareIn, this), 25))
        }, n.prototype.fadeLensFlareOut = function() {
            var e = this._lensFlareMesh.material.uniforms.fAlpha;
            e.value = Math.max(e.value - .05, 0), e.value > 0 ? this.fadeTimeout = window.setTimeout(r.bind(this.fadeLensFlareOut, this), 25) : this._lensFlareMesh.visible = !1
        }, n.prototype.updateLensFlare = function() {
            if (this.helper.useLensFlare && this._skyMesh.visible) {
                var e = this.renderer._cameraManager.camera,
                    t = this._skyMesh.material.uniforms.sunDirection.value.clone(),
                    i = this.renderer._cameraManager.getTargetToCamera(!0),
                    n = t.dot(i) < 0;
                if (!n) {
                    var r = this._skyMesh.position.clone();
                    t.setLength(this._skyMesh.scale.x), r.addSelf(t);
                    var o = this.renderer._cameraManager,
                        a = !o.cameraElevation && o.setCameraElevations;
                    a && o.setCameraElevations(), e.projScreenMatrix.multiplyVector3(r), a && o.unsetCameraElevations(), n = Math.abs(r.x) > 1 || Math.abs(r.y) > 1, n || this._lensFlareMesh.material.uniforms.sunPosScreenSpace.value.copy(r)
                }
                this._lensFlareMesh.visible && n ? this.fadeLensFlareOut() : this._lensFlareMesh.visible || n || (this._lensFlareMesh.visible = !0, this.fadeLensFlareIn())
            } else this._lensFlareMesh.visible = !1, this._lensFlareMesh.material.uniforms.fAlpha.value = 0
        }, n.prototype.registerPlugins = function(e) {
            return e.envModifiers && (this.envModifiers = r.union(this.envModifiers, e.envModifiers)), {
                skyModifier: r.bind(function(e) {
                    e(this._skyMesh, {
                        MathHelper: u
                    })
                }, this)
            }
        }, n.prototype.unregisterPlugins = function(e) {
            e.envModifiers && (this.envModifiers = r.difference(this.envModifiers, e.envModifiers))
        }, n.prototype.applyEnvModifier = function() {
            var e = {
                shadowColor: this.shaderLibrary.uniforms.shadow.shadowColor.value,
                globalColor: this.shaderLibrary.uniforms.globalLight.vGlobalColor.value,
                Color: h
            };
            r.each(this.envModifiers, function(t) {
                t(e)
            }, this)
        }, n.prototype.updateLightFromSunAndMoon = function(e, t) {
            this._skyMesh.visible && (this.helper.updateLightFromSunAndMoon(e, t), this.applyEnvModifier(), this.updateLensFlare())
        }, n.prototype.onDivRemoved = function() {
            this._skyLoader && this._skyLoader.abort(), this.renderer.removeListener("cameraChanged", this._cameraUpdatedHandler), this.renderer.removeListener("enter3d", this._enter3dHandler), this.renderer.removeListener("enter2d", this._enter2dHandler);
            var e = this.renderer.getRenderEngine();
            e.unloadTexture(this.shaderLibrary.uniforms.envMap.envTexture.texture), e.unloadTexture(this.shaderLibrary.uniforms.water.waterBumpAndReflection.texture), e.unloadTexture(this.shaderLibrary.uniforms.fog.skyTexture.texture), delete this.shaderLibrary.uniforms.envMap.envTexture.texture, delete this.shaderLibrary.uniforms.water.waterBumpAndReflection.texture, delete this.shaderLibrary.uniforms.fog.skyTexture.texture, this.renderer.getScene().remove(this._skyMesh), this.renderer.getScene().remove(this._lensFlareMesh), e.freeMesh(this._skyMesh), e.freeMesh(this._lensFlareMesh), delete this._skyMesh, delete this._lensFlareMesh, delete this.shaderLibrary, delete this.renderer
        }, t.exports = n
    }, {
        "../../utils/StaticFileResolver": 410,
        "./EnvironmentHelper": 341,
        engine: 10,
        underscore: 207
    }],
    341: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.renderer = e.renderer, this.shaderLibrary = e.shaderLibrary, this.defaultAltitude = .7, this.defaultAzimuth = .9, this.nightLerp = .02, this.nightStart = .08, this.twilightLerp = .1, this.twilightStart = .3, this.useLensFlare = !0, this.configs = {
                day: {
                    name: "day",
                    useLensFlare: !0,
                    globalColor: new o(16777215),
                    lightColor: new o(16776434),
                    lightBackColor: new o(8029585),
                    lightAmbientColor: new o(2499361),
                    lightSpecularColor: new o(16777215),
                    shadowColor: new o(9015459),
                    waterSpecularFactor: .75,
                    waterSpecularPower: 64
                },
                twilight: {
                    name: "twilight",
                    useLensFlare: !0,
                    globalColor: new o(13422043),
                    lightColor: new o(16709356),
                    lightBackColor: new o(8224128),
                    lightAmbientColor: new o(2038553),
                    lightSpecularColor: new o(16777215),
                    shadowColor: new o(13882603),
                    waterSpecularFactor: .9,
                    waterSpecularPower: 128
                },
                nightNewMoon: {
                    name: "nightNewMoon",
                    useLensFlare: !1,
                    globalColor: new o(11514052),
                    lightColor: new o(13487060),
                    lightBackColor: new o(8551808),
                    lightAmbientColor: new o(2961459),
                    lightSpecularColor: new o(0),
                    shadowColor: new o(16777215),
                    waterSpecularFactor: .3,
                    waterSpecularPower: 1024
                },
                nightFullMoon: {
                    name: "nightFullMoon",
                    useLensFlare: !1,
                    globalColor: new o(13619688),
                    lightColor: new o(15724274),
                    lightBackColor: new o(9538447),
                    lightAmbientColor: new o(2961459),
                    lightSpecularColor: new o(0),
                    shadowColor: new o(14343154),
                    waterSpecularFactor: .9,
                    waterSpecularPower: 512
                }
            }, this.sunDir = e.sunDir, this.lightDir = this.shaderLibrary.uniforms.light.vLightDir.value, this.setDirFromAltitudeAndAzimuth(this.sunDir, this.defaultAltitude, this.defaultAzimuth), this.lightDir.copy(this.sunDir)
        }
        var r = e("engine"),
            o = r.Color,
            a = r.MathHelper;
        t.exports = n, n.prototype.setDirFromAltitudeAndAzimuth = function(e, t, i) {
            var n = -Math.cos(t);
            e.x = n * Math.sin(i), e.y = n * Math.cos(i), e.z = Math.sin(t), e.normalize()
        }, n.prototype.updateLightFromSunAndMoon = function(e, t) {
            var i = this.configs.day,
                n = this.configs.day,
                r = 0;
            if (this.setDirFromAltitudeAndAzimuth(this.sunDir, e.altitude, e.azimuth), this.lightDir.copy(this.sunDir), e.altitude <= this.nightStart) {
                var o = (t && t.altitude) > 0 ? t.fraction : 0;
                i = this.createConfig(this.configs.nightNewMoon, this.configs.nightFullMoon, o), n = this.configs.twilight, r = a.linearStep(this.nightLerp, this.nightStart, e.altitude), e.altitude < this.nightLerp && ((t && t.altitude) > 0 ? this.setDirFromAltitudeAndAzimuth(this.lightDir, t.altitude, t.azimuth) : this.setDirFromAltitudeAndAzimuth(this.lightDir, this.defaultAltitude, this.defaultAzimuth))
            } else e.altitude <= this.twilightStart && (i = this.configs.twilight, n = this.configs.day, r = a.linearStep(this.twilightLerp, this.twilightStart, e.altitude));
            this.lerpConfigurations(i, n, r), this.renderer.forceUpdateShadow()
        }, n.prototype.createConfig = function(e, t, i) {
            return 0 == i ? e : 1 == i ? t : {
                name: "generated from " + e.name + " and " + t.name,
                useLensFlare: .5 > i ? e.useLensFlare : e.useLensFlare,
                globalColor: e.globalColor.clone().mix(t.globalColor, i),
                lightColor: e.lightColor.clone().mix(t.lightColor, i),
                lightBackColor: e.lightBackColor.clone().mix(t.lightBackColor, i),
                lightAmbientColor: e.lightAmbientColor.clone().mix(t.lightAmbientColor, i),
                lightSpecularColor: e.lightSpecularColor.clone().mix(t.lightSpecularColor, i),
                shadowColor: e.shadowColor.clone().mix(t.shadowColor, i),
                waterSpecularFactor: a.lerp(e.waterSpecularFactor, t.waterSpecularFactor, i),
                waterSpecularPower: a.lerp(e.waterSpecularPower, t.waterSpecularPower, i)
            }
        }, n.prototype.lerpConfigurations = function(e, t, i) {
            this.useLensFlare = .5 > i ? e.useLensFlare : e.useLensFlare;
            var n = this.shaderLibrary.uniforms;
            n.light.vLightFrontColor.value.copy(e.lightColor), n.light.vLightFrontColor.value.mix(t.lightColor, i), n.light.vLightBackColor.value.copy(e.lightBackColor), n.light.vLightBackColor.value.mix(t.lightBackColor, i), n.light.vLightAmbientColor.value.copy(e.lightAmbientColor), n.light.vLightAmbientColor.value.mix(t.lightAmbientColor, i), n.light.vLightSpecularColor.value.copy(e.lightSpecularColor), n.light.vLightSpecularColor.value.mix(t.lightSpecularColor, i), n.water.waterSpecular.value.set(a.lerp(e.waterSpecularFactor, t.waterSpecularFactor, i), a.lerp(e.waterSpecularPower, t.waterSpecularPower, i)), n.shadow.shadowColor.value.copy(e.shadowColor), n.shadow.shadowColor.value.mix(t.shadowColor, i), n.csmShadows.shadowColor.value.copy(e.shadowColor), n.csmShadows.shadowColor.value.mix(t.shadowColor, i), n.globalLight.vGlobalColor.value.copy(e.globalColor), n.globalLight.vGlobalColor.value.mix(t.globalColor, i)
        }
    }, {
        engine: 10
    }],
    342: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._layers = [], this._mapRenderer = e, this._renderTarget = null, this._tileDataLayerRequests = [], this._mustSortDataLayerRequests = !1, this._dataLayerProcessor = new o(this._mapRenderer, {
                intervalIdle: this._mapRenderer.conf.get("workProcessor.dataLayerInterval"),
                maxDurationIdle: this._mapRenderer.conf.get("workProcessor.dataLayerDuration"),
                workWhenCameraMove: !0,
                intervalMoving: this._mapRenderer.conf.get("workProcessor.dataLayerIntervalMoving"),
                maxDurationMoving: this._mapRenderer.conf.get("workProcessor.dataLayerDurationMoving"),
                name: "dataLayerProcessor"
            }), this._dataLayerProcessor.registerWorker(r.bind(this._getWork, this), "dataLayerProcessor:getWork"), this._dataLayerProcessor.start(), this._onLayerChangedCbk = r.bind(this.onLayerChanged, this)
        }
        var r = e("underscore"),
            o = e("../../utils/WorkProcessor");
        t.exports = n, n.prototype.getGradientTexture = function() {
            return this._layers.length ? this._layers[0].getGradientTexture() : null
        }, n.prototype.addLayer = function(e) {
            r.contains(this._layers, e) || (e.on("data_changed", this._onLayerChangedCbk), this._layers.push(e), this.onLayerChanged())
        }, n.prototype.onLayerChanged = function() {
            this._mapRenderer.getTileManager().onDataLayerChanged()
        }, n.prototype.removeLayer = function(e) {
            if (r.contains(this._layers, e)) {
                e.removeListener("data_changed", this._onLayerChangedCbk);
                var t = this._layers.indexOf(e);
                t > -1 && this._layers.splice(t, 1), this.onLayerChanged()
            }
        }, n.prototype.cancelDataLayerTextureRequest = function(e) {
            if (r.contains(this._tileDataLayerRequests, e)) {
                var t = this._tileDataLayerRequests.indexOf(e);
                t > -1 && this._tileDataLayerRequests.splice(t, 1)
            }
            r.each(this._layers, function(t) {
                t.cancelTextureGenerationRequest(e)
            })
        }, n.prototype.addDataLayerTextureRequest = function(e) {
            if (this._layers.length > 0 && !r.findWhere(this._tileDataLayerRequests, {
                    tileKey: e.tileKey
                })) {
                this._tileDataLayerRequests.push(e), this._mustSortDataLayerRequests = !0;
                for (var t; t = this._getWork();) t()
            }
        }, n.prototype._getWork = function() {
            return this._tileDataLayerRequests.length > 0 ? (this._mustSortDataLayerRequests && (this._tileDataLayerRequests = r.sortBy(this._tileDataLayerRequests, function(e) {
                return null != e.bounds ? this._mapRenderer.computeDistanceToCenter(e.bounds.center) : 1e6
            }, this), this._mustSortDataLayerRequests = !1), r.bind(this._handleNextDataLayerRequest, this)) : null
        }, n.prototype._handleNextDataLayerRequest = function() {
            if (this._tileDataLayerRequests.length > 0) {
                var e = this._tileDataLayerRequests.shift();
                if (this._layers.length > 0) {
                    var t = r.bind(this._onSingleLayerTextureGenerationTerminated, this);
                    this._layers[0].addTextureGenerationRequest(e, t)
                } else e.setDataLayerTexture(null)
            }
        }, n.prototype._onSingleLayerTextureGenerationTerminated = function(e, t, i) {
            this._layers.length > 1 ? null == this._renderTarget : e.setDataLayerTexture(t, i)
        }, n.prototype.onDivRemoved = function() {
            this._dataLayerProcessor.release()
        }
    }, {
        "../../utils/WorkProcessor": 416,
        underscore: 207
    }],
    343: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            r.call(this), this._mapRenderer = e, this._options = i, t && (this._latLngs = this.convertData(t)), this._heat = this._mapRenderer.addHeatMap(this._latLngs, this.convertOptions(this._options))
        }
        var r = e("events").EventEmitter,
            o = e("util");
        t.exports = n, o.inherits(n, r), n.prototype.destroy = function() {
            this._mapRenderer.removeHeatMap(this._heat)
        }, n.prototype.setData = function(e) {
            this._latLngs = this.convertData(e), this._mapRenderer.isMoving() || this._heat.setLatLngs(this._latLngs)
        }, n.prototype.convertOptions = function(e) {
            var t = null != e.opacity ? 1 / e.opacity : null,
                i = null != e.maxIntensity ? e.maxIntensity : t;
            return {
                minOpacity: 0,
                max: i,
                blur: 8,
                radius: this._getHeatPointsRadius(e),
                gradient: this._convertGradient(e.gradient),
                maxZoom: 0
            }
        }, n.prototype.setRadius = function(e) {
            this._options.radius = e, this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype.setOpacity = function(e) {
            this._options.opacity = e, this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype.setMaxIntensity = function(e) {
            this._options.maxIntensity = e, this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype.setDissipating = function(e) {
            this._options.dissipating = e, this._options.dissipating || this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype.setGradient = function(e) {
            this._options.gradient = e, this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype._convertGradient = function(e) {
            for (var t = {}, i = e.length, n = 0, r = 0; i > r; ++r) t[n] = e[r], n += 1 / i;
            return t
        }, n.prototype._getHeatPointsRadius = function(e) {
            return e.dissipating ? e.radius : e.radius * Math.pow(2, this._mapRenderer.getZoom())
        }, n.prototype.updateZoom = function() {
            this._options.dissipating || this._heat.setOptions(this.convertOptions(this._options))
        }, n.prototype.convertData = function(e) {
            var t = [];
            return e.forEach(function(e) {
                var i = e.location ? e.location : e;
                t.push([i.lat(), i.lng(), String(null != e.weight ? e.weight : 1)])
            }), t
        }
    }, {
        events: 99,
        util: 212
    }],
    344: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            o.call(this), this._options = i, this._mapRenderer = e, this._renderTextureSize = this._mapRenderer.conf.get("heatmapLayer.renderTextureSize"), this._colorizedRenderTextureSize = this._mapRenderer.conf.get("heatmapLayer.colorizedRenderTextureSize"), this._constructHeatmapMesh(), p && this._constructHeatmapColorizerMesh(), this._constructRenderTargets(), this.setGradient(i.gradient), this.setData(t), this.setMaxIntensity(i.maxIntensity), this._pendingRequests = [], this._requestInProgress = null, this._heatmapLayerProcessor = new s(this._mapRenderer, {
                intervalIdle: this._mapRenderer.conf.get("workProcessor.heatmapInterval"),
                maxDurationIdle: this._mapRenderer.conf.get("workProcessor.heatmapDuration"),
                workWhenCameraMove: !1,
                intervalMoving: this._mapRenderer.conf.get("workProcessor.heatmapIntervalMoving"),
                maxDurationMoving: this._mapRenderer.conf.get("workProcessor.heatmapDurationMoving"),
                name: "heatmapLayerProcessor"
            }), this._heatmapLayerProcessor.registerWorker(r.bind(this._getWork, this), "heatmapLayerProcessor:getWork"), this._heatmapLayerProcessor.start()
        }
        var r = e("underscore"),
            o = e("events").EventEmitter,
            a = e("util"),
            s = e("../../utils/WorkProcessor"),
            l = e("engine"),
            h = e("../../utils/LocationHelper"),
            u = l.Constants,
            d = l.RenderTarget,
            c = l.Color,
            f = l.Geometry;
        t.exports = n;
        var p = !1;
        a.inherits(n, o), n.prototype.setGradient = function(e) {
            this._generateGradientTexture(this._convertGradient(e)), this.emit("data_changed")
        }, n.prototype.setRadius = function(e) {
            this._options.radius = e, this.emit("data_changed")
        }, n.prototype.setOpacity = function(e) {
            this._options.opacity = e, this.emit("data_changed")
        }, n.prototype.setMaxIntensity = function(e) {
            this._intensity = null == e ? 1 : e, this.emit("data_changed")
        }, n.prototype.setDissipating = function(e) {
            this._options.dissipating = e, this.emit("data_changed")
        }, n.prototype.destroy = function() {
            this._pendingRequests = [], this._requestInProgress = null, this._destroyRenderTargets(), this._mapRenderer.getRenderEngine().releaseGeometry(this._heatmapMesh.geometry), p && this._mapRenderer.getRenderEngine().releaseGeometry(this._heatmapColorizerMesh.geometry)
        }, n.prototype.setData = function(e) {
            this._data = [];
            var t = this;
            e.forEach(function(e) {
                t._data.push({
                    lonLat: h.convertGoogleLatLngTo900913(e.location ? e.location : e),
                    weight: null != e.weight ? e.weight : 1
                })
            }), this._initGeometry(), this._createGeometryData(this._data), this.emit("data_changed")
        }, n.prototype.addTextureGenerationRequest = function(e, t) {
            if (!r.findWhere(this._pendingRequests, {
                    tileKey: e.tileKey
                })) {
                var i = {
                    tileKey: e.tileKey,
                    tile: e,
                    onTextureReadyCallback: t,
                    texture: null,
                    textureGenerationSuccess: null,
                    textureGenerationError: null
                };
                i.textureGenerationSuccess = r.bind(this._onTextureGenerationSuccess, this, i), i.textureGenerationError = r.bind(this._onTextureGenerationError, this, i), this._pendingRequests.push(i)
            }
        }, n.prototype.cancelTextureGenerationRequest = function(e) {
            var t = r.findWhere(this._pendingRequests, {
                tile: e
            });
            t && this._removePendingRequest(t), null != this._requestInProgress && this._requestInProgress.tile === e && (this._requestInProgress = null)
        }, n.prototype._getWork = function() {
            return this._pendingRequests.length > 0 && null == this._requestInProgress ? r.bind(this._handleNextTextureGenerationRequest, this) : null
        }, n.prototype._handleNextTextureGenerationRequest = function() {
            if (this._pendingRequests.length > 0 && null == this._requestInProgress) {
                var e = this._pendingRequests.shift();
                this._requestInProgress = e, this._generateTexture()
            }
        }, n.prototype._generateTexture = function() {
            if (null != this._requestInProgress) {
                var e = this._requestInProgress;
                this._requestInProgress = null;
                var t = !0;
                if (null != e.tile.bounds) {
                    var i = this._getTileHasData(e.tile);
                    i ? (this._renderDataToTexture(e.tile), p ? e.texture = this._heatmapColorizerRenderTarget.grabTexture() : e.texture = this._heatmapGeneratorRenderTarget.grabTexture()) : e.texture = null
                } else t = !1;
                t ? this._onTextureGenerationSuccess(e) : this._onTextureGenerationError(e)
            }
        }, n.prototype._onTextureGenerationSuccess = function(e) {
            this._requestInProgress = null;
            var t = e.onTextureReadyCallback,
                i = e.tile,
                n = e.texture;
            i._isAborted ? e.texture && this._mapRenderer.getRenderEngine()._webGL.deallocateTexture(e.texture) : t(i, n, this._options.opacity)
        }, n.prototype._onTextureGenerationError = function(e) {
            console.error("Got texture error for tile " + e.tile.tileKey), this._requestInProgress = null
        }, n.prototype._removePendingRequest = function(e) {
            var t = r.indexOf(this._pendingRequests, e);
            t > -1 && this._pendingRequests.splice(t, 1)
        }, n.prototype._constructRenderTargets = function() {
            var e = {
                depthBuffer: !1,
                format: u.RGBAFormat
            };
            this._heatmapGeneratorRenderTarget = new d(this._renderTextureSize, this._renderTextureSize, e), this._heatmapGeneratorRenderTarget.generateMipmaps = !1, p && (this._heatmapColorizerRenderTarget = new d(this._colorizedRenderTextureSize, this._colorizedRenderTextureSize, e)), this._clearColor = new c, this._clearColor.setRGBA(0, 0, 0, 0)
        }, n.prototype._destroyRenderTargets = function() {
            null != this._heatmapGeneratorRenderTarget && (this._mapRenderer.getRenderEngine().releaseRenderTarget(this._heatmapGeneratorRenderTarget), delete this._heatmapGeneratorRenderTarget), p && null != this._heatmapColorizerRenderTarget && (this._mapRenderer.getRenderEngine().releaseRenderTarget(this._heatmapColorizerRenderTarget), delete this._heatmapColorizerRenderTarget)
        }, n.prototype._constructHeatmapMesh = function() {
            var e = this._mapRenderer.getRenderEngine().createMaterial("heatmap_render");
            e.depthTest = !1, e.depthWrite = !1, e.blending = u.AdditiveAllBlending;
            var t = new f(u.TRIANGLES);
            this._heatmapMesh = this._mapRenderer.getRenderEngine().createMesh(t, e)
        }, n.prototype._constructHeatmapColorizerMesh = function() {
            var e = this._mapRenderer.getRenderEngine().createMaterial("heatmap_colorizer_render");
            e.depthTest = !1, e.depthWrite = !1, e.blending = u.AdditiveAlphaBlending;
            var t = new f(u.TRIANGLES);
            t._positionArray = [], t._uvArray = [], t._positionArray.push(-1, -1, 0), t._positionArray.push(1, -1, 0), t._positionArray.push(-1, 1, 0), t._positionArray.push(-1, 1, 0), t._positionArray.push(1, -1, 0), t._positionArray.push(1, 1, 0), t._uvArray.push(0, 1), t._uvArray.push(1, 1), t._uvArray.push(0, 0), t._uvArray.push(0, 0), t._uvArray.push(1, 1), t._uvArray.push(1, 0), this._heatmapColorizerMesh = this._mapRenderer.getRenderEngine().createMesh(t, e), this._heatmapColorizerMesh.__isPositionDirty = !0, this._heatmapColorizerMesh.__isUvDirty = !0, this._mapRenderer.getRenderEngine()._webGL.updateObject(this._heatmapColorizerMesh)
        }, n.prototype._initGeometry = function() {
            var e = this._heatmapMesh.geometry;
            e.__isDirty = !0, e.clear(), e._positionArray = [], e._userDataArray = []
        }, n.prototype._createGeometryData = function(e) {
            var t, i = this._heatmapMesh.geometry,
                n = 1;
            for (t = 0; t < e.length; t++) {
                var r = e[t],
                    o = r.lonLat.lon,
                    a = r.lonLat.lat;
                this._addVertex(o, a, -n, -n, r.weight), this._addVertex(o, a, +n, -n, r.weight), this._addVertex(o, a, -n, +n, r.weight), this._addVertex(o, a, -n, +n, r.weight), this._addVertex(o, a, +n, -n, r.weight), this._addVertex(o, a, +n, +n, r.weight)
            }
            i.__isPositionDirty = !0, i.__isUserDataDirty = !0, this._mapRenderer.getRenderEngine()._webGL.updateObject(this._heatmapMesh)
        }, n.prototype._addVertex = function(e, t, i, n, r) {
            var o = this._heatmapMesh.geometry;
            o._positionArray.push(e, t, 0), o._userDataArray.push(i, n, r, 0)
        }, n.prototype._renderDataToTexture = function(e) {
            var t = this._intensity,
                i = e.bounds,
                n = i.xMax - i.xMin,
                r = i.yMax - i.yMin;
            this._heatmapMesh.material.uniforms.intensity.value = t, this._heatmapMesh.material.uniforms.viewRect.value.set(i.xMin, i.yMin, n, r), this._heatmapMesh.material.uniforms.radiusFactor.value = this._getHeatPointsRadius(i);
            var o = this._mapRenderer.getRenderEngine()._webGL;
            o.setAndClearRenderTarget(this._heatmapGeneratorRenderTarget, this._clearColor), o.setMaterial(null), o.renderObject(this._heatmapMesh), p && (o.setAndClearRenderTarget(this._heatmapColorizerRenderTarget, this._clearColor), this._heatmapColorizerMesh.material.uniforms.heatmapIntensityTexture.texture = this._heatmapGeneratorRenderTarget, this._heatmapColorizerMesh.material.uniforms.heatmapGradientTexture.texture = this._gradientTexture, this._heatmapColorizerMesh.material.uniforms.heatmapOpacity.value = this._options.opacity, o.renderObject(this._heatmapColorizerMesh)), o.setRenderTarget(null)
        }, n.prototype._getHeatPointsRadius = function() {
            return this._options.dissipating ? this._options.radius : this._mapRenderer.getPixelSizeInMeter(this._options.radius)
        }, n.prototype._convertGradient = function(e) {
            for (var t = {}, i = e.length, n = 0, r = 0; i > r; ++r) t[n] = e[r], n += 1 / i;
            return t
        }, n.prototype._generateGradientTexture = function(e) {
            null == this._canvas && (this._canvas = document.createElement("canvas"), this._canvas.width = 256, this._canvas.height = 1);
            var t = this._canvas.getContext("2d"),
                i = t.createLinearGradient(0, 0, 256, 0);
            for (var n in e) i.addColorStop(n, e[n]);
            t.fillStyle = i, t.fillRect(0, 0, 256, 1);
            var r = this._mapRenderer.getRenderEngine().createTexture();
            r.image = this._canvas, r.format = u.RGBAFormat, r.needsUpdate = !0, r.generateMipmaps = !1, r.minFilter = u.LinearFilter, r.wrap = u.ClampToEdgeWrapping, this._gradientTextureReady = !0, this._gradientTexture = r
        }, n.prototype.getGradientTexture = function() {
            return this._gradientTexture
        }, n.prototype._getTileHasData = function(e) {
            var t = e.bounds,
                i = this._getHeatPointsRadius(t),
                n = r.find(this._data, function(e) {
                    var n = e.lonLat.lon - i,
                        r = e.lonLat.lat - i,
                        o = e.lonLat.lon + i,
                        a = e.lonLat.lat + i;
                    return t.xMin < o && t.xMax > n && t.yMin < a && t.yMax > r ? !0 : !1
                }, this);
            return void 0 != n
        }
    }, {
        "../../utils/LocationHelper": 407,
        "../../utils/WorkProcessor": 416,
        engine: 10,
        events: 99,
        underscore: 207,
        util: 212
    }],
    345: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.renderer = e, this._loadedTiles = {}, this._markers = {}, this.renderer.on("cameraChanged", r.bind(this.cameraUpdated, this))
        }
        var r = e("underscore"),
            o = e("../../utils/IconHelper"),
            a = e("../../utils/LocationHelper"),
            s = e("../../api/LatLng");
        t.exports = n;
        var l = ["", "-moz-", "-ms-", "-o-", "-webkit-"],
            h = n.prototype;
        h.cameraUpdated = function() {
            r.each(this._markers, function(e) {
                var t = e.pin;
                t.textOverlay && t.textOverlay.refreshPosition()
            }, this)
        }, h.getSceneIndex = function() {
            return 0
        }, h.clearOnServerHostReadyHandler = function(e) {
            e.onServerHostReadyHandler && (e.onServerHostReadyHandler.abort(), delete e.onServerHostReadyHandler)
        }, h.getPinSize = function(e) {
            var t = {
                width: 0,
                height: 0
            };
            if (e.scaledSize) t.width = e.scaledSize.width, t.height = e.scaledSize.height;
            else {
                var i = e.getId(),
                    n = this._markers[i];
                n && n._icon && n._icon.naturalWidth && n._icon.naturalHeight && (t.width = n._icon.naturalWidth, t.height = n._icon.naturalHeight)
            }
            return t
        }, h.getPinAnchor = function(e) {
            var t = this.getPinSize(e);
            return e.icon.anchor2d || e.icon.anchor || {
                x: .5 * t.width,
                y: t.height
            }
        }, h.insertPin = function(e) {
            var t = e.getPosition(),
                i = e.getId(),
                n = this,
                r = n.renderer.addMarker(t, {
                    zIndexOffset: e.zIndex,
                    draggable: e.draggable
                });
            r.pin = e, r.on("dragstart", function() {
                e.overlay.emit("dragstart")
            }), r.on("drag", function() {
                var t = r.getLatLng();
                e._setLatLng(new s(t.lat, t.lng)), e.overlay.emit("drag")
            }), r.on("dragend", function() {
                e.overlay.emit("dragend")
            }), n._markers[i] = r
        }, h.updatePin = function(e) {
            var t = this._markers[e.getId()];
            if (null != t) {
                var i = e.getPosition();
                t.setLatLng(a.convert900913to4326(i)), t.setZIndexOffset(e.zIndex), e.draggable ? t.dragging.enable() : t.dragging.disable();
                var n, s = this,
                    h = o.getIconUrl(e.icon);
                if (e.icon.size) {
                    var u = "background-repeat:no-repeat;background-image: url('" + h + "');",
                        d = e.icon.origin;
                    d && (u += "background-position:-" + d.x + "px -" + d.y + "px;");
                    var c = e.icon.scaledSize || e.icon.size,
                        f = e.icon.size,
                        p = c.width / f.width,
                        m = c.height / f.height;
                    r.each(l, function(e) {
                        u += e + "transform-origin:0 0;"
                    }), u += "transform:scale(" + p + "," + m + ");", u += "width:" + f.width + "px;height:" + f.height + "px;", n = leafletF4.divIcon({
                        className: "f4map-leaflet-divicon",
                        html: '<div style="' + u + '"></div>'
                    })
                } else n = leafletF4.icon({
                    iconUrl: h
                });
                t.setIcon(n), s._updateLeafletIcon(e), e.onTextureReceived(), t._icon && (t._icon.onload = function() {
                    t._icon && (t._icon.onload = null, s._updateLeafletIcon(e), e.onTextureReceived())
                })
            }
        }, h._updateLeafletIcon = function(e) {
            var t = this._markers[e.getId()];
            if (t && t._icon) {
                var i, n, r = t.options.icon,
                    o = e.icon.scaledSize || e.icon.size;
                o ? (i = o.width, n = o.height) : (i = t._icon.naturalWidth, n = t._icon.naturalHeight), r.options.iconSize = [i, n];
                var a, s, l = e.icon.anchor;
                l ? (a = l.x, s = l.y) : (a = i / 2, s = n), r.options.iconAnchor = [a, s], t.setIcon(r)
            }
        }, h.removePin = function(e) {
            var t = e.getId(),
                i = this._markers[t];
            null != i && (delete this._markers[t], this.renderer.removeMarker(i), i.pin = null, this.clearOnServerHostReadyHandler(e))
        }, h.updatePinPosition = function(e) {
            var t = this._markers[e.getId()];
            if (t) {
                var i = e.getPosition();
                t.setLatLng(a.convert900913to4326(i))
            }
        }, h.unloadItem = function(e) {
            this.removePin(e)
        }, h.onDivRemoved = function() {}
    }, {
        "../../api/LatLng": 233,
        "../../utils/IconHelper": 406,
        "../../utils/LocationHelper": 407,
        underscore: 207
    }],
    346: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n) {
            for (var r = t * n, o = i * n, a = 0; n > a; ++a) e[o++] = e[r++]
        }

        function r(e) {
            this.renderer = e, this._onCameraChangedHandler = o.bind(this.onCameraChanged, this), this._onCamera2d3dHandler = o.bind(this.onCamera2d3d, this), this.renderer.on("cameraChanged", this._onCameraChangedHandler), this.renderer.on("enter2d", this._onCamera2d3dHandler), this.renderer.on("enter3d", this._onCamera2d3dHandler), this._lineMat = this.renderer.getRenderEngine().createMaterial("nolight_clipping", s.NoBlending), this._meshesInfo = []
        }
        var o = e("underscore"),
            a = e("engine"),
            s = a.Constants,
            l = a.Geometry,
            h = a.Color,
            u = a.Vector2,
            d = 16384;
        t.exports = r;
        var c = r.prototype;
        c._createMeshInfo = function() {
            var e = new l(s.LINES);
            e.fixedColor = new h(this.renderer.conf.get("pins.lineColor")), e._positionArray = [], e.__isDirty = !0;
            var t = this.renderer.getRenderEngine().createMesh(e, this._lineMat);
            return this.renderer.getScene().add(t), e.setPointsCount(0), {
                mesh: t,
                position: (new u).copy(t.position),
                capacity: 1,
                nextIndex: 0,
                markers: []
            }
        }, c.computeClipping = function() {
            this.renderer.computeClipping(this._lineMat.uniforms.clippingWorld)
        }, c.updateMarkerPosition = function(e) {
            if (null != e._lineIndexInMesh) {
                var t = e.getPosition(),
                    i = e.getHeight(),
                    n = e._lineMeshInfo.mesh,
                    r = t.lon - n.position.x,
                    o = t.lat - n.position.y,
                    a = n.geometry,
                    s = 6 * e._lineIndexInMesh,
                    l = a._positionArray;
                l[s++] = r, l[s++] = o, l[s++] = i, l[s++] = r, l[s++] = o, l[s++] = 0, a.__isPositionDirty = !0
            }
        }, c._getNotFullMeshInfo = function() {
            var e = o.find(this._meshesInfo, function(e) {
                return e.nextIndex < d
            });
            return e || (e = this._createMeshInfo(), this._meshesInfo.push(e)), e
        }, c.addMarker = function(e) {
            if (null == e._lineIndexInMesh) {
                var t = this._getNotFullMeshInfo(),
                    i = t.markers,
                    n = t.mesh,
                    r = t.capacity,
                    o = t.nextIndex,
                    a = o + 1;
                e._lineMeshInfo = t, e._lineIndexInMesh = o, i[o] = e;
                var s = n.geometry;
                o >= r && (r *= 2, t.capacity = r, s._positionArray.length = 6 * r, i.length = r), s.setPointsCount(2 * a), s.__isPositionDirty = !0, s.__isColorDirty = !0, t.nextIndex = a
            }
            this.updateMarkerPosition(e)
        }, c.removeMarker = function(e) {
            if (null != e._lineIndexInMesh) {
                var t = e._lineMeshInfo,
                    i = t.mesh,
                    r = t.markers,
                    o = t.capacity,
                    a = i.geometry,
                    s = t.nextIndex,
                    l = s - 1,
                    h = e._lineIndexInMesh;
                t.nextIndex = l;
                var u = e._lineIndexInMesh == l;
                if (!u) {
                    var d = r[l];
                    d._lineIndexInMesh = h, r[h] = d, n(a._positionArray, l, h, 6)
                }
                a.setPointsCount(2 * l), 0 >= l ? this._releaseMeshInfo(t) : .5 * o >= s && (o *= .5, t.capacity = o, a._positionArray.length = 6 * o, r.length = o), a.__isPositionDirty = !0, a.__isColorDirty = !0, e._lineIndexInMesh = null, e._lineMeshInfo = null
            }
        }, c._releaseMeshInfo = function(e) {
            var t = e.mesh,
                i = this.renderer.getRenderEngine();
            i.releaseGeometry(t.geometry), i.freeMesh(t);
            var n = o.findIndex(this._meshesInfo, function(t) {
                return t == e
            });
            n >= 0 ? this._meshesInfo.splice(n, 1) : console.warn("mesh info not found, this is a BUG")
        }, c.onCamera2d3d = function() {
            var e = this.renderer.isIn3d();
            o.each(this._meshesInfo, function(t) {
                t.mesh.visible = e
            })
        }, c.onCameraChanged = function() {
            var e = this,
                t = this.renderer.getCenterXYZ();
            o.each(this._meshesInfo, function(i) {
                if (i.position.distanceTo(t) > e.renderer.conf.get("pins.meshRecenterDistance")) {
                    i.position.subSelf(t);
                    var n = i.position.x,
                        r = i.position.y,
                        o = i.position.copy(t),
                        a = i.mesh;
                    a.position.set(o.x, o.y, 0), a.updateMatrix();
                    for (var s = a.geometry, l = 0, h = s._positionArray, u = h.length; u > l;) h[l++] += n, h[l++] += r, ++l;
                    s.__isPositionDirty = !0
                }
            })
        }, c.onDivRemoved = function() {
            this.renderer.removeListener("cameraChanged", this._onCameraChangedHandler), this.renderer.removeListener("enter2d", this._onCamera2d3dHandler), this.renderer.removeListener("enter3d", this._onCamera2d3dHandler), this.renderer.getScene().remove(this._lineMesh), this.renderer.getRenderEngine().freeMesh(this._lineMesh), delete this._onCameraChangedHandler, delete this._onCamera2d3dHandler, delete this._meshesInfo, delete this.renderer
        }
    }, {
        engine: 10,
        underscore: 207
    }],
    347: [function(e, t, i) {
        "use strict";

        function n(e) {
            return e.icon.origin || p
        }

        function r(e, t, i, n) {
            for (var r = t * n, o = i * n, a = 0; n > a; ++a) e[o++] = e[r++]
        }

        function o(e) {
            this.renderer = e, this._onCameraChangedHandler = a.bind(this.onCameraChanged, this), this._onCamera2d3dHandler = a.bind(this.onCamera2d3d, this), this.renderer.on("cameraChanged", this._onCameraChangedHandler), this.renderer.on("enter2d", this._onCamera2d3dHandler), this.renderer.on("enter3d", this._onCamera2d3dHandler), this._markerLineWebGLRenderer = new c(this.renderer), this.iconsParent = new u, this.renderer.getScene().add(this.iconsParent), this._meshes = [], this._meshesInfoByUrl = {}, this._meshesPosition = new d
        }
        var a = e("underscore"),
            s = e("engine"),
            l = s.Constants,
            h = s.Geometry,
            u = s.Object3D,
            d = s.Vector2,
            c = e("./MarkerLineWebGLRenderer"),
            f = e("../../utils/IconHelper");
        t.exports = o;
        var p = {
                x: 0,
                y: 0
            },
            m = 4,
            g = 65536,
            _ = g / m,
            v = 1,
            y = o.prototype;
        y.updatePinPosition = function(e) {
            var t = e._currentMeshInfo;
            if (null != t) {
                var i = t.mesh;
                e.computeHeight(), e._disableLine || this._markerLineWebGLRenderer.updateMarkerPosition(e);
                for (var n = e._indexInMesh, r = i.geometry, o = e.getPosition(), a = e.getHeightWithModel() || 0, s = o.lon - i.position.x, l = o.lat - i.position.y, h = a - i.position.z, u = 3 * m, d = n * u, c = r._positionArray, f = 0; m > f; ++f) c[d++] = s, c[d++] = l, c[d++] = h;
                r.__isPositionDirty = !0
            }
        }, y.getPinSize = function(e) {
            if (e._size) return e._size;
            var t = e.scaledSize,
                i = t || this._getIconSizeWithoutScale(e);
            return e._size = i, i
        }, y._getIconSizeWithoutScale = function(e) {
            var t = {
                width: 0,
                height: 0
            };
            if (e.icon && e.icon.size) t.width = e.icon.size.width, t.height = e.icon.size.height;
            else {
                var i = e._currentMeshInfo;
                if (i) {
                    var n = i.mesh,
                        r = n.geometry,
                        o = e._indexInMesh,
                        a = 4 * m,
                        s = o * a,
                        l = r._userDataArray,
                        h = l[s + 2],
                        u = l[s + 3];
                    if (0 != h && null != h || 0 != u && null != u) t.width = h, t.height = u;
                    else {
                        var d = n.material.uniforms;
                        t.width = d.size.value.x, t.height = d.size.value.y
                    }
                }
            }
            return t
        }, y._isMarkerScaled = function(e) {
            var t = this._getIconSizeWithoutScale(e),
                i = this.getPinSize(e);
            return t.width != i.width || t.height != i.height
        }, y.getPinAnchor = function(e) {
            return this.renderer.isIn3d() ? this._getAnchor3d(e) : this._getAnchor2d(e)
        }, y._getAnchor2d = function(e) {
            var t = this.getPinSize(e);
            return e.icon.anchor2d || e.icon.anchor || {
                x: .5 * t.width,
                y: t.height
            }
        }, y._getAnchor3d = function(e) {
            var t = this.getPinSize(e);
            return e.icon.anchor3d || e.icon.anchor || {
                x: .5 * t.width,
                y: t.height
            }
        }, y.getSceneIndex = function(e) {
            var t = this.renderer.getRenderEngine().getScene();
            return t.getIdxInScene(e._currentMeshInfo.mesh)
        }, y.updateIconOptions = function(e) {
            var t = e._currentMeshInfo;
            if (null != t) {
                var i = t.mesh,
                    r = e._indexInMesh,
                    o = i.geometry,
                    a = n(e),
                    s = a.x,
                    l = a.y,
                    h = this._getIconSizeWithoutScale(e),
                    u = h.width,
                    d = h.height,
                    c = 1,
                    f = 1,
                    p = e.scaledSize;
                p && (c = p.width / u, f = p.height / d);
                var g = this._getAnchor2d(e),
                    _ = this._getAnchor3d(e),
                    v = g.x / c,
                    y = g.y / f,
                    b = _.x / c,
                    x = _.y / f,
                    w = this.renderer._maxZIndex - e.zIndex;
                w = Math.min(Math.max(w, 1), 15);
                var M = -w / 16;
                e.alwaysInFront && (M = -M);
                for (var T = r * m * 4, S = o._userDataArray, C = 0; m > C; ++C) S[T++] = s, S[T++] = l, S[T++] = u, S[T++] = d;
                T = r * m * 4;
                for (var E = o._colorArray, k = 0; m > k; ++k) E[T++] = v, E[T++] = y, E[T++] = b, E[T++] = x;
                T = r * m * 3;
                for (var L = o._normalArray, P = 0; m > P; ++P) L[T++] = c, L[T++] = f, L[T++] = M;
                o.__isUserDataDirty = !0, o.__isColorDirty = !0, o.__isNormalDirty = !0
            }
        }, y._addIconToMeshInfo = function(e, t) {
            var i = e._currentMeshInfo;
            if (i !== t) {
                null != e._indexInMesh && null != t && this._removeIconFromMesh(e);
                var n = t.capacity,
                    r = t.nextIndex,
                    o = r + 1;
                e._indexInMesh = r;
                var a = t.mesh;
                e._currentMeshInfo = t;
                var s = a._markers,
                    l = a.geometry;
                if (r >= n) {
                    n *= 2, t.capacity = n;
                    var h = n * m;
                    l._positionArray.length = 3 * h, l._colorArray.length = 4 * h, l._userDataArray.length = 4 * h, l._normalArray.length = 3 * h, l._uvArray.length = 2 * h, l._indexArray.length = 6 * n, s.length = n
                }
                s[r] = e;
                var u = r * m * 2;
                l._uvArray[u] = 0, l._uvArray[u + 1] = 0, l._uvArray[u + 2] = 0, l._uvArray[u + 3] = 1, l._uvArray[u + 4] = 1, l._uvArray[u + 5] = 0, l._uvArray[u + 6] = 1, l._uvArray[u + 7] = 1;
                var d = 6 * r,
                    c = 4 * r;
                l._indexArray[d + 0] = c + 0, l._indexArray[d + 1] = c + 1, l._indexArray[d + 2] = c + 2, l._indexArray[d + 3] = c + 1, l._indexArray[d + 4] = c + 3, l._indexArray[d + 5] = c + 2, this.updatePinPosition(e), this.updateIconOptions(e), t.nextIndex = o, l.setPointsCount(o * m), l.setIndexCount(6 * o), l.__isDirty = !0
            }
        }, y._removeIconFromMesh = function(e) {
            var t = e._currentMeshInfo || {},
                i = t.mesh;
            if (null != e._indexInMesh && null != i) {
                var n = i.geometry,
                    o = i._markers,
                    a = e._currentMeshInfo,
                    s = a.nextIndex,
                    l = s - 1,
                    h = a.capacity,
                    u = e._indexInMesh,
                    d = u == l;
                if (!d) {
                    var c = o[l];
                    c._indexInMesh = u, o[u] = c, r(n._positionArray, l, u, 3 * m), r(n._colorArray, l, u, 4 * m), r(n._userDataArray, l, u, 4 * m), r(n._normalArray, l, u, 3 * m), r(n._uvArray, l, u, 2 * m)
                }
                a.nextIndex = l, n.setPointsCount(l * m), n.setIndexCount(6 * l), 0 >= l ? this._releaseMeshInfo(a) : .5 * h >= s && (h *= .5, a.capacity = h, n._positionArray.length = h * m * 3, n._colorArray.length = h * m * 4, n._userDataArray.length = h * m * 4, n._normalArray.length = h * m * 3, n._uvArray.length = h * m * 2, n._indexArray.length = 6 * h, o.length = h), n.__isDirty = !0
            }
            e._indexInMesh = null, e._currentMeshInfo = null
        }, y._getMeshInfo = function(e) {
            var t = this,
                i = f.getIconUrl(e.icon);
            if (i) {
                var n = this._meshesInfoByUrl[i];
                n || (this._meshesInfoByUrl[i] = []);
                var r, o = a.find(n, function(e) {
                    return e.nextIndex < _
                });
                if (o) r = o;
                else {
                    var s;
                    ! function() {
                        r = t._createMeshInfo(i), t._meshesInfoByUrl[i].push(r);
                        var n = r,
                            o = n.mesh,
                            l = n.texture,
                            h = t.renderer.getRenderEngine();
                        e.icon.url ? (l.onSuccess = a.bind(t._handleTextureReceived, t, o), h.askTextureToServer(l)) : e.icon.image ? (l.image = e.icon.image, e.icon.image.complete ? (h.handlePreloadedTextureNow(l), t._handleTextureReceived(o, l)) : (s = t, e.icon.image.onload = function() {
                            h.handlePreloadedTextureNow(l), s._handleTextureReceived(o, l)
                        })) : e.icon.canvas ? (l.image = e.icon.canvas, h.handlePreloadedTextureNow(l), t._handleTextureReceived(o, l)) : console.error("Invalid marker.icon", e.icon), t.computeClipping()
                    }()
                }
                return r
            }
        }, y._createMeshInfo = function(e) {
            var t = this.renderer.getRenderEngine(),
                i = t.createMaterial("markerIcon_clipping");
            i.transparent = l.SuperGradual;
            var n = this.renderer.isIn3d();
            i.uniforms.in3d.value = n ? 1 : 0;
            var r = new h(l.TRIANGLES);
            r._positionArray = [], r._userDataArray = [], r._colorArray = [], r._normalArray = [], r._uvArray = [], r._indexArray = [], r.setPointsCount(0), r.setIndexCount(0);
            var o = t.createMesh(r, i);
            o._index = this._meshes.length, this._meshes.push(o), o.visible = !1, o._url = e, o._markers = [], o.position.set(this._meshesPosition.x, this._meshesPosition.y, 0), o.updateMatrix();
            var a = t.getTexture(e, l.ClampToEdgeWrapping);
            return a.magFilter = l.NearestFilter, a.minFilter = l.NearestFilter, a.generateMipmaps = !1, i.uniforms.texture.texture = a, {
                mesh: o,
                texture: a,
                capacity: v,
                nextIndex: 0
            }
        }, y.computeClipping = function() {
            a.each(this._meshes, function(e) {
                this.renderer.computeClipping(e.material.uniforms.clippingWorld)
            }, this), this._markerLineWebGLRenderer && this._markerLineWebGLRenderer.computeClipping()
        }, y._handleTextureReceived = function(e, t) {
            var i = this,
                n = e.material;
            if (!n || !n.uniforms.texture || n.uniforms.texture.texture != t) return void this.renderer.getRenderEngine().releaseTexture(t);
            var r = t.image.width,
                o = t.image.height;
            n.uniforms.size.value.set(r, o), e.visible = !0, this.iconsParent.add(e), a.each(e._markers, function(e) {
                e && (e._size = null, e.onTextureReceived(), i.updateIconOptions(e))
            })
        }, y._releaseMeshInfo = function(e) {
            var t = e.mesh;
            this.iconsParent.remove(t);
            var i = t.material.uniforms.texture.texture,
                n = this.renderer.getRenderEngine();
            t.visible ? n.releaseTexture(i) : n.abortLoadingTexture(i), t.material.uniforms.texture.texture = null, n.releaseMaterial(t.material), n.releaseGeometry(t.geometry), n.freeMesh(t);
            var r = this._meshes[this._meshes.length - 1];
            this._meshes[t._index] = r, this._meshes.length -= 1, r._index = t._index, t._index = null, delete t._markers;
            var o = t._url,
                s = this._meshesInfoByUrl[o],
                l = a.findIndex(s, function(t) {
                    return t == e
                });
            l >= 0 ? this._meshesInfoByUrl[o].splice(l, 1) : console.warn("mesh info not found, this is a BUG"), delete t._url
        }, y.insertPin = function(e) {
            this.create(e)
        }, y.updatePin = function(e) {
            this.update(e)
        }, y.removePin = function(e) {
            this._removeIconFromMesh(e), e._disableLine || this._markerLineWebGLRenderer.removeMarker(e)
        }, y.removeMarker = function(e) {
            this._removeIconFromMesh(e), e._disableLine || this._markerLineWebGLRenderer.removeMarker(e)
        }, y.create = function(e) {
            e.computeHeight(), e._disableLine || this._markerLineWebGLRenderer.addMarker(e);
            var t = this._getMeshInfo(e);
            this._addIconToMeshInfo(e, t)
        }, y.update = function(e) {
            var t = e._currentMeshInfo;
            if (t) {
                var i = this._getMeshInfo(e);
                i !== t ? (this._removeIconFromMesh(e), this._addIconToMeshInfo(e, i)) : (this.updatePinPosition(e), this.updateIconOptions(e))
            }
        }, y.onCameraChanged = function() {
            var e = this.renderer.getCenterXYZ();
            if (this._meshesPosition.distanceTo(e) > this.renderer.conf.get("pins.meshRecenterDistance")) {
                this._meshesPosition.subSelf(e);
                var t = this._meshesPosition.x,
                    i = this._meshesPosition.y,
                    n = this._meshesPosition.copy(e);
                a.each(this._meshesInfoByUrl, function(e) {
                    a.each(e, function(e) {
                        var r = e.mesh;
                        r.position.set(n.x, n.y, 0), r.updateMatrix();
                        for (var o = r.geometry, a = 0, s = o._positionArray, l = e.nextIndex, h = l * m * 3; h > a;) s[a++] += t, s[a++] += i, ++a;
                        o.__isPositionDirty = !0
                    })
                }, this)
            }
        }, y.onCamera2d3d = function() {
            var e = this.renderer.isIn3d(),
                t = e ? 1 : 0;
            a.each(this._meshes, function(e) {
                e.material.uniforms.in3d.value = t
            })
        }, y.onDivRemoved = function() {
            this.renderer.removeListener("cameraChanged", this._onCameraChangedHandler), this.renderer.removeListener("enter2d", this._onCamera2d3dHandler), this.renderer.removeListener("enter3d", this._onCamera2d3dHandler), this._markerLineWebGLRenderer.onDivRemoved(), delete this._markerLineWebGLRenderer, delete this._onCameraChangedHandler, delete this._onCamera2d3dHandler, delete this.renderer
        }
    }, {
        "../../utils/IconHelper": 406,
        "./MarkerLineWebGLRenderer": 346,
        engine: 10,
        underscore: 207
    }],
    348: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = t, this._webGLEnabled = t.isWebGL(), this._pinsManager = t.getPinsManager(), this._marker = null, this._id = null, this._position = {}, this._defaultPosition = {}, this._height = 0, this._modelHeight = 0, this._heightAnimation = 0, this._model = null, this._model3D = null, this._modelUseEnvMap = !1, this._modelMaterialVisible = !0, this._rotation = null, this._scale = null, this._title = null, this._textOverlay = null, this._cursor = null, this._selectedEffect = null, this._hoveredEffect = null, this._animation = null, this._animationTime = 0, this._animationEasing = null, this._animationDuration = null, this._animationLoopable = null, this._animationHeightInPixels = null, this._initialising = !1, this._pinSize = {
                width: 0,
                height: 0
            }, this._pos2d = new c(0, 0), this._pos3d = new f(0, 0, 0), this._isVisibleOnScreen = !1, this.tileKey = null, this.mustComputeHeight = !1, this.icon = null, this.zIndex = 0, this.alwaysInFront = !1, this.overlay = null, this.clickable = null, this.draggable = null, this.visible = !1, this._disableLine = !1, this._disableHeight = !1, this.idx = null, this.fixedHeight = !1, this.forceHeight = null, this.setMarker(e, !0)
        }

        function r(e, t, i, n, r) {
            return .5 >= e ? v(2 * e, t, i, n, r / 2) : v(1 - 2 * e, r - t, i, n, r / 2)
        }
        var o = e("underscore"),
            a = e("jquery"),
            s = e("util"),
            l = e("events").EventEmitter,
            h = e("../../utils/StaticFileResolver"),
            u = e("../../utils/LocationHelper"),
            d = e("engine"),
            c = d.Vector2,
            f = d.Vector3,
            p = d.Model,
            m = e("../../api/Animation"),
            g = e("../text/TextOverlay");
        t.exports = n, s.inherits(n, l);
        var _ = n.prototype;
        _.getId = function() {
            return this._id
        }, _.getRenderIndex = function() {
            return this._pinsManager.getSceneIndex(this)
        }, _.getPosition = function() {
            return this._position
        }, _.getVisible = function() {
            return this.visible
        }, _.getAnchor = function() {
            return this._pinsManager.getPinAnchor(this)
        }, _.getHeight = function() {
            return this._height + this._heightAnimation
        }, _.getHeightWithModel = function() {
            return this.getHeight() + this._modelHeight
        }, _.getPositionWithHeight = function() {
            return new f(this._position.lon, this._position.lat, this.getHeight())
        }, _.get2DSize = function() {
            return this.hasModel() ? {
                width: 0,
                height: 0
            } : this._pinsManager.getPinSize(this)
        }, _.getPos2d = function() {
            return this._pos2d
        }, _.refreshScreenPosition = function(e) {
            var t = this._mapRenderer.isIn3d();
            this._pinSize = this.get2DSize();
            var i = t ? this.getHeightWithModel() : 0;
            this._pos3d.set(this._position.lon, this._position.lat, i), this._pos2d.copy(this._mapRenderer.computeScreenPosInPixels(this._pos3d));
            var n = this.getAnchor();
            n ? (this._pos2d.x += .5 * this._pinSize.width - n.x, this._pos2d.y += .5 * this._pinSize.height - n.y) : (this._pos2d.x += .5 * this._pinSize.width, this._pos2d.y += .5 * this._pinSize.height);
            var r = this._pos2d.x - .5 * this._pinSize.width,
                o = this._pos2d.y - .5 * this._pinSize.height,
                a = r + this._pinSize.width,
                s = o + this._pinSize.height;
            this._isVisibleOnScreen = a > 0 && r < e.w && s > 0 && o < e.h, this._mapRenderer.forceRender()
        }, _.setMarker = function(e, t) {
            this._marker = e, this.overlay = e, this._initialising = !0, this._id = e.id, e.model && this.setModel(e.model), this.setIcon(e.icon), e.position && this.setPosition(u.convertGoogleLatLngTo900913(e.position), t), this.setZIndex(e.zIndex), this.setAlwaysInFront(e.alwaysInFront), this.setDraggable(e.draggable), this.setClickable(e.clickable), this.setCursor(e.cursor), this.setDisableLine(e.disableLine), this.setDisableHeight(e.disableHeight), this.setTouchScaling(e.touchScaling), e.forceHeight && this.setForceHeight(e.forceHeight), null != e.fixedHeight && (this.fixedHeight = e.fixedHeight), e.height && this.setHeight(e.height), e.hoveredEffect && this.setHoveredEffect(e.hoveredEffect), e.selectedEffect && this.setSelectedEffect(e.selectedEffect), this.setVisible(e.visible), this.setAnimation(e.animation), this.setTitle(e.title), this._initialising = !1, this.update()
        }, _.unload = function() {
            this._pinsManager.removePinFromMap(this), this.deleteTextOverlay(), this.destroyModel()
        }, _.setIcon = function(e) {
            this._size = null, e || (e = {
                url: h("images/marker-icon.png")
            }), e.canvas && this.icon && this.icon.canvas && (console.log("deprecated canvas in icon, please provide canvas.toDataURL() result in icon.url"), e.canvasUrl || (e.canvasUrl = e.canvas.toDataURL()), this.icon.canvasUrl || (this.icon.canvasUrl = this.icon.canvas.toDataURL())), this.scaledSize = e.scaledSize, this._setIcon(e)
        }, _._setIcon = function(e) {
            o.isEqual(this.icon, e) || (this.icon = e, this.hasModel() || (this.update(), this._updateTextOverlay()))
        }, _.setTitle = function(e) {
            this._mapRenderer.conf.get("disableTextManager") || this._title != e && (this._title = e, this._textOverlay ? this._textOverlay.setName(e) : this.createTextOverlay())
        }, _.updateTextOverlay = function() {
            this.visible && null == this._textOverlay && this._title ? this.createTextOverlay() : this.visible || null == this._textOverlay ? this.visible && this._textOverlay && (this._textOverlay.computeClickableZone(), this._textOverlay.setDirty()) : this.deleteTextOverlay()
        }, _.createTextOverlay = function() {
            var e = {
                zIndex: this.zIndex,
                name: this._title,
                id: "text" + this._id,
                pin: this,
                marker: this._marker,
                renderer: this._mapRenderer
            };
            this._textOverlay = new g(e), this._mapRenderer.askForHover()
        }, _.deleteTextOverlay = function() {
            this._textOverlay && (this._textOverlay.unload(), delete this._textOverlay, this._mapRenderer.askForHover())
        }, _.onMouseOver = function() {
            this.clickable && this.setHoveredEffect(!0), null != this._cursor && this._mapRenderer.$parentNode.addClass(this._cursor)
        }, _.onMouseOut = function() {
            null != this._cursor && this._mapRenderer.$parentNode.removeClass(this._cursor), this.clickable && this.setHoveredEffect(!1)
        }, _._setLatLng = function(e, t) {
            this.setPosition(e._to900913(), t)
        }, _.setPosition = function(e, t) {
            if (e && (this._defaultPosition.lon != e.lon || this._defaultPosition.lat != e.lat)) {
                if (this._pinsManager.setPinPosition(this, e), this._defaultPosition.lon = this._position.lon = e.lon, this._defaultPosition.lat = this._position.lat = e.lat, this._updateTextPosition(), this.updateModelPosition(), !t) {
                    var i = u.convert900913toGoogleLatLng(e);
                    this._marker.setPosition(i)
                }
                this.update()
            }
        }, _.setSelectedEffect = function(e) {
            this._selectedEffect != e && (this._selectedEffect = e, this._textOverlay && this._textOverlay.setSelectedEffect(e))
        }, _.setHoveredEffect = function(e) {
            this._hoveredEffect != e && (this._hoveredEffect = e)
        }, _.setZIndex = function(e) {
            this.zIndex != e && (this.zIndex = e, this._textOverlay && this._textOverlay.setZIndex(e), this.update())
        }, _.setAlwaysInFront = function(e) {
            this.alwaysInFront != e && (this.alwaysInFront = e, this.update())
        }, _.setDraggable = function(e) {
            this.draggable != e && (this.draggable = e)
        }, _.setClickable = function(e) {
            this.clickable = null != e ? e : !0
        }, _.setDisableLine = function(e) {
            null != e && this._disableLine != e && (this._disableLine = e, this.update())
        }, _.setDisableHeight = function(e) {
            null != e && this._disableHeight != e && (this._disableHeight = e, this.update())
        }, _.setTouchScaling = function(e) {
            null != e && this._touchScaling != e && (this._touchScaling = e)
        }, _.setCursor = function(e) {
            null != e ? this._cursor = e : (this.clickable || this.draggable) && (this._cursor = "hover-clickable")
        }, _.setHeight = function(e, t) {
            null != e && this._height != e && (this._height = e, this._updateTextPosition(), this.updateModelPosition(), t || (this._marker.height = e, this._marker.emit("position_changed")))
        }, _.setForceHeight = function(e) {
            if (this._forceHeight != e) {
                this._forceHeight = e;
                var t = e;
                if (this._mapRenderer.map.elevation) {
                    var i = this._mapRenderer.findHeight({
                        x: this._position.lon,
                        y: this._position.lat
                    });
                    null != i && (t += i)
                }
                this._height = t, this._updateTextPosition()
            }
        }, _.computeHeight = function() {
            this._pinsManager.updatePinHeight(this)
        }, _.setVisible = function(e) {
            null != e && this.visible != e && (this.visible && !e ? (this.visible = !1, this._pinsManager.removePinFromMap(this),
                this._animation && this._pinsManager.removePinToAnimate(this), this._model3d && this._model3d.mesh && (this._model3d.mesh.visible = !1)) : !this.visible && e && (this.visible = !0, this.hasModel() || (this._pinsManager.insertPinInMap(this), this._animation && this._pinsManager.addPinToAnimate(this)), this._model3d && this._model3d.mesh && (this._model3d.mesh.visible = !0)), this.update())
        }, _.update = function() {
            this._initialising || (this.visible && this._pinsManager.updatePin(this), this.updateTextOverlay(), this._mapRenderer.askForHover(), this._mapRenderer.forceRender())
        }, _.onTextureReceived = function() {
            this._pinsManager.onTextureReceived(this), this._textOverlay && this._textOverlay.onTextureReceived()
        };
        var v = a.easing.easeInQuad;
        _.setAnimation = function(e) {
            this._animation != e && (this._animation = e, this._resetAnimation(), this._animation == m.BOUNCE ? (this._animationEasing = r, this._animationDuration = 700, this._animationLoopable = !0, this._animationHeightInPixels = 20) : this._animation == m.DROP ? (this._animationEasing = a.easing.easeOutBounce, this._animationDuration = 1e3, this._animationLoopable = !1, this._animationHeightInPixels = 50) : (this._animationEasing = null, this._animationDuration = null, this._animationLoopable = null, this._animationHeightInPixels = null), this._animationEasing ? this._pinsManager.addPinToAnimate(this) : this._pinsManager.removePinToAnimate(this))
        }, _._resetAnimation = function() {
            this._animationTime = 0, this._updateYOffset(0)
        }, _.computeAnimation = function(e) {
            this._animationTime += e;
            var t = this._animationDuration,
                i = this._animationTime;
            if (i >= t) {
                if (!this._animationLoopable) return this._updateYOffset(0), !0;
                i = this._animationTime = i % t
            }
            var n = i / t,
                r = -this._animationHeightInPixels,
                o = 0,
                a = this._animationEasing(n, i, r, o - r, t);
            this._updateYOffset(a)
        }, _._updateYOffset = function(e) {
            if (this._position.lon = this._defaultPosition.lon, this._position.lat = this._defaultPosition.lat, this._mapRenderer.isIn3d()) this._heightAnimation = -e;
            else {
                var t = this.getPositionWithHeight(),
                    i = this._mapRenderer.computeScreenPosInPixels(t);
                i.y += e;
                var n = this._mapRenderer.computeLocationFromPixel(i);
                this._webGLEnabled ? (this._position.lon = n.x, this._position.lat = n.y, this._heightAnimation = n.z) : (this._position.lon = n.lon, this._position.lat = n.lat)
            }
            this._pinsManager.updatePinPosition(this), this._updateTextPosition()
        }, _.hasModel = function() {
            return this._webGLEnabled && this._model && (null != this._model.modelPath || null != this._model.modelGeometry)
        }, _.loadModel = function() {
            this._model3d = new p(this._mapRenderer.getRenderEngine());
            var e = {
                pos: this.getPositionWithHeight(),
                sceneParent: this._mapRenderer.getScene().marker3dParent,
                noLight: this._model.noLight,
                texturePath: this._model.texturePath,
                useEnvmap: this._modelUseEnvMap,
                doubleSided: this._model.doubleSided,
                clearOnWebglLoad: !1,
                transparent: this._model.transparent,
                uniformColor: this._model.uniformColor,
                useSpecularLighting: this._model.useSpecularLighting
            };
            this._model.modelData ? (this._model3d.loadWithRawData(this._model.modelData, e), delete this._model.modelData, this.onModelLoaded()) : this._model.modelGeometry ? (this._model3d.loadWithGeometry(this._model.modelGeometry, e), this.onModelLoaded()) : this._model3d.load(this._model.modelPath, e, o.bind(this.onModelLoaded, this))
        }, _.onModelLoaded = function(e) {
            this._mapRenderer && this._mapRenderer.map && this._model3d && this._model3d.mesh && (this._model3d.mesh.owner = this, this._model3d.material.visible = this._modelMaterialVisible, this._modelHeight = this._model3d.meshHeight * this._model.scale, this.updateModelRenderPass(), this._model.onLoadedCallback && this._model.onLoadedCallback(e, this._model3d), this.updateModel())
        }, _.updateModelRenderPass = function() {
            this._model3d && this._model3d.mesh && this._model.handleRenderPass && o.each(this._model.handleRenderPass, function(e, t) {
                this._model3d.mesh.handleRenderPass[t] = e
            }, this)
        }, _.destroyModel = function() {
            this._model3d && (this._model3d.unload(), this._model3d = null)
        }, _.setRotation = function(e) {
            null != e && this._rotation != e && null != this.model.mesh && (this._rotation = e, this.model.mesh.rotation.z = this._rotation * Math.PI / 180)
        }, _.setScale = function(e) {
            null != e && this._scale != e && (this._scale = e, this.model.mesh.scale.set(this._scale, this._scale, this._scale), this._size = null)
        }, _.updateModelScale = function() {
            if (this._model && this._model3d && this._model3d.mesh && null != this._model.scale) {
                var e = this._model.scale;
                this._model3d.mesh.scale.set(e, e, e)
            }
        }, _.updateModelRotation = function() {
            this._model && this._model3d && this._model3d.mesh && null != this._model.rotation && (this._model3d.mesh.rotation.z = this._model.rotation * Math.PI / 180)
        }, _.updateModelDoubleSided = function() {
            this._model && this._model3d && this._model3d.mesh && null != this._model.doubleSided && (this._model3d.mesh.doubleSided = this._model.doubleSided)
        }, _.updateModelTransparent = function() {
            this._model && null != this._model.transparent && this._model3d && this._model3d.material && (this._model3d.material.transparent = this._model.transparent)
        }, _.updateModelAnimation = function() {
            this._model && this._model3d && this._model3d.mesh && null != this._model.animation && this._model3d.playAnimation(this._model.animation)
        }, _.updateModelPosition = function() {
            this._model3d && this._model3d.mesh && (this._model3d.mesh.position.copy(this.getPositionWithHeight()), this._model3d.mesh.updateMatrix())
        }, _.updateModel = function() {
            this.updateModelPosition(), this.updateModelScale(), this.updateModelRotation(), this.updateModelAnimation(), this.updateModelTransparent(), this.updateModelDoubleSided(), this.updateModel3d()
        }, _.updateModel3d = function() {
            this._webGLEnabled && null == this._model3d && this._model && (null != this._model.modelPath || null != this._model.modelGeometry) && this.loadModel()
        }, _.setModel = function(e) {
            function t(t) {
                var r = e[t];
                r && r != i._model[t] && (n = !0, i._model[t] = r)
            }
            var i = this;
            if (null != e) {
                null == this._model && (this._model = {});
                var n = !1;
                e.modelPath && e.modelPath != this._model.modelPath && (n = !0, this._model.modelPath = e.modelPath, e.modelData && (this._model.modelData = e.modelData)), t("modelGeometry"), t("texturePath"), t("noLight"), e.uniformColor && this._model.uniformColor != e.uniformColor && (this._model.uniformColor = e.uniformColor, this._model3d ? this._model3d.setUniformColor(e.uniformColor) : n = !0), null != e.useSpecularLighting && this._model.useSpecularLighting != e.useSpecularLighting && (this._model.useSpecularLighting = e.useSpecularLighting, this._model3d ? this._model3d.setUseSpecularLighting(e.useSpecularLighting) : n = !0), e.onLoadedCallback && (this._model.onLoadedCallback = e.onLoadedCallback), null != e.materialVisible && this._modelMaterialVisible != e.materialVisible && (this._modelMaterialVisible = e.materialVisible, this._model3d ? this._model3d.material.visible = e.materialVisible : n = !0), n && this.destroyModel(), this._updateModel(e), n && this.updateModel3d(), this._updateTextOverlay(), this._mapRenderer.askForHover()
            }
        }, _._updateModel = function(e) {
            null != e.handleRenderPass && this._model.handleRenderPass != e.handleRenderPass && (this._model.handleRenderPass = e.handleRenderPass, this.updateModelRenderPass()), null != e.scale && this._model.scale != e.scale && (this._model.scale = e.scale, this.updateModelScale()), null != e.rotation && this._model.rotation != e.rotation && (this._model.rotation = e.rotation, this.updateModelRotation()), null != e.animation && this._model.animation != e.animation && (this._model.animation = e.animation, this.updateModelAnimation()), null != e.doubleSided && this._model.doubleSided != e.doubleSided && (this._model.doubleSided = e.doubleSided, this.updateModelDoubleSided()), null != e.transparent && this._model.transparent != e.transparent && (this._model.transparent = e.transparent, this.updateModelTransparent())
        }, _._updateTextOverlay = function() {
            this._textOverlay && this._textOverlay.refreshPinSize()
        }, _.isInPinOrTextClickableZone = function(e) {
            return this._textOverlay ? this._textOverlay.isInPinOrTextClickableZone(e) : this.isInPinClickableZone(e)
        }, _.getSize2D = function() {
            return this._pinSize
        }, _.isInPinClickableZone = function(e) {
            if (this._isVisibleOnScreen && this.visible && (this.clickable || this.draggable)) {
                var t, i, n, r, o = this._touchScaling || 1,
                    a = this._pinSize.width * o,
                    s = this._pinSize.height * o;
                if (t = this._pos2d.x - .5 * a, i = t + a, n = this._pos2d.y - .5 * s, r = n + s, e.x >= t && e.x <= i && e.y >= n && e.y <= r) return !0
            }
            return !1
        }, _._updateTextPosition = function() {
            this._textOverlay && this._textOverlay.refreshPosition()
        }
    }, {
        "../../api/Animation": 222,
        "../../utils/LocationHelper": 407,
        "../../utils/StaticFileResolver": 410,
        "../text/TextOverlay": 362,
        engine: 10,
        events: 99,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    349: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapRenderer = e, this._markerRenderer = e.createMarkerRenderer(), this._webGLEnabled = e.isWebGL(), this._sizeForTiles = e.conf.get("pins.sizeForTiles"), this._onDragStartHandler = r.bind(this.onDragStart, this), this._onDragHandler = r.bind(this.onDrag, this), this._onDragStopHandler = r.bind(this.onDragStop, this), this._setPositionsDirtyHandler = r.bind(this.setPositionsDirty, this), this._onTileElevationsUpdatedCbk = r.bind(this.onTileElevationsUpdated, this), this._mapRenderer.on("dragstart", this._onDragStartHandler), this._mapRenderer.on("drag", this._onDragHandler), this._mapRenderer.on("dragend", this._onDragStopHandler), this._mapRenderer.on("cameraChanged", this._setPositionsDirtyHandler), this._mapRenderer.map.elevation && this._mapRenderer.on("tile_elevations_updated", this._onTileElevationsUpdatedCbk), this._pinsToAnimate = {}, this._pinsByTile = {}, this._allPins = [], this._numberOfPins = 0, this._currentDraggedPin = null, this._dragHeight = null, this._dragDelta2D = null, this._allPositionsDirty = !0, this._canUpdatePositions = !1, this._pinsHeightToBeUpdated = [];
            var t = !1;
            this.heightPinsProcessor = new a(this._mapRenderer, {
                intervalIdle: this._mapRenderer.conf.get("workProcessor.heightPinsInterval"),
                maxDurationIdle: this._mapRenderer.conf.get("workProcessor.heightPinsDuration"),
                workWhenCameraMove: t,
                intervalMoving: this._mapRenderer.conf.get("workProcessor.heightPinsIntervalMoving"),
                maxDurationMoving: this._mapRenderer.conf.get("workProcessor.heightPinsDurationMoving"),
                name: "heightPinsProcessor"
            }), this.heightPinsProcessor.registerWorker(r.bind(this._heightPinsWorker, this), "pinsManager:heightPinsWorker"), this.heightPinsProcessor.start()
        }
        var r = e("underscore"),
            o = e("../../utils/LocationHelper"),
            a = e("../../utils/WorkProcessor");
        t.exports = n;
        var s = n.prototype;
        s._heightPinsWorker = function() {
            if (this._pinsHeightToBeUpdated.length > 0) {
                for (var e; this._pinsHeightToBeUpdated.length && (e = this._pinsHeightToBeUpdated.shift(), !e.tileKey););
                return r.bind(function() {
                    this._updateHeight(e)
                }, this)
            }
            return null
        }, s.onDragStart = function(e, t) {
            if (t) {
                this._mapRenderer.disableHover(!0), this._currentDraggedPin = t;
                var i = this._currentDraggedPin.getPositionWithHeight();
                this._webGLEnabled && (this._dragHeight = i.z), this._dragDelta2D = this._mapRenderer.computeScreenPosInPixels(i), this._dragDelta2D.x -= e.xyInMapCanvas.x, this._dragDelta2D.y -= e.xyInMapCanvas.y, this._currentDraggedPin.emit("dragstart", e), this._currentDraggedPin.overlay && this._currentDraggedPin.overlay.emit("dragstart", e)
            }
        }, s.onDrag = function(e) {
            if (this._currentDraggedPin) {
                var t = {
                    x: e.xyInMapCanvas.x,
                    y: e.xyInMapCanvas.y
                };
                t.x += this._dragDelta2D.x, t.y += this._dragDelta2D.y;
                var i = this._mapRenderer.computeLocationFromPixel(t, this.dragHeight),
                    n = o.convertLonLatOrXYToLonLat(i);
                this._currentDraggedPin.setPosition(n);
                var r = this._mapRenderer.getSize();
                this._currentDraggedPin.refreshScreenPosition(r), this._webGLEnabled && this._currentDraggedPin.setHeight(i.z), this._currentDraggedPin.emit("drag", e), this._currentDraggedPin.overlay && this._currentDraggedPin.overlay.emit("drag", e)
            }
        }, s.onDragStop = function(e) {
            if (this._currentDraggedPin) {
                this._mapRenderer.disableHover(!1);
                var t = this._currentDraggedPin;
                this._currentDraggedPin = null, t.update(), t.emit("dragend", e), t.overlay && t.overlay.emit("dragend", e)
            }
        }, s.loadItems = function(e) {
            for (var t = 0; t < e.length; ++t) this.insertPinInMap(e[t])
        }, s.onDivRemoved = function() {
            var e = r.clone(this._allPins);
            r.each(e, function(e) {
                e.overlay && e.overlay.setMap(null)
            }, this), this.heightPinsProcessor.release(), this._mapRenderer.removeListener("dragstart", this._onDragStartHandler), this._mapRenderer.removeListener("drag", this._onDragHandler), this._mapRenderer.removeListener("dragend", this._onDragStopHandler), this._mapRenderer.removeListener("cameraChanged", this._setPositionsDirtyHandler), this._mapRenderer.removeListener("tile_elevation_updated", this._onTileElevationsUpdatedCbk), this._markerRenderer.onDivRemoved(), delete this._onDragStartHandler, delete this._onDragHandler, delete this._onDragStopHandler, delete this._setPositionsDirtyHandler, delete this._markerRenderer, delete this._mapRenderer
        }, s.unloadItems = function(e) {
            r.each(e, function(e) {
                e.setVisible(!1), e && e.popup && e.popup.hide(), this.removePinFromMap(e)
            }, this)
        }, s.computeClipping = function() {
            this._markerRenderer && this._markerRenderer.computeClipping && this._markerRenderer.computeClipping()
        }, s.insertPinInMap = function(e) {
            this._markerRenderer && (this._markerRenderer.insertPin(e), this._allPins[this._allPins.length] = e, this._numberOfPins++, this._mapRenderer.forceRender())
        }, s.removePinFromMap = function(e) {
            if (this._mapRenderer && this._markerRenderer) {
                this._currentDraggedPin == e && this._mapRenderer._onDragStop(), e.popup && e.popup.hide(), delete this._pinsToAnimate[e._id], this._markerRenderer.removePin(e);
                var t = this._allPins.indexOf(e);
                t > -1 && (this._allPins.splice(t, 1), this._numberOfPins--), this.unsetPinPosition(e), this._mapRenderer.forceRender()
            }
        }, s.getSceneIndex = function(e) {
            return this._markerRenderer.getSceneIndex(e)
        }, s.getPinSize = function(e) {
            return this._markerRenderer.getPinSize(e)
        }, s.getPinAnchor = function(e) {
            return this._markerRenderer.getPinAnchor(e)
        }, s.unsetPinPosition = function(e) {
            var t = e.tileKey;
            if (t) {
                var i = this._pinsByTile[t];
                if (i) {
                    var n = i.pins,
                        r = n.indexOf(e);
                    r > -1 && (n.splice(r, 1), 0 == n.length && delete this._pinsByTile[t])
                }
                e.tileKey = null
            }
        }, s.setPinPosition = function(e, t) {
            var i = t.lon,
                n = t.lat;
            if (null != i && null != n) {
                var r = this._sizeForTiles,
                    o = Math.floor(i / r),
                    a = Math.floor(n / r),
                    s = o + "_" + a;
                if (e.tileKey != s) {
                    this.unsetPinPosition(e);
                    var l = this._pinsByTile[s];
                    if (null == l) {
                        var h = o * r,
                            u = h + r,
                            d = a * r,
                            c = d + r;
                        this._pinsByTile[s] = {
                            pins: [e],
                            bounds: {
                                xMin: h,
                                xMax: u,
                                yMin: d,
                                yMax: c
                            }
                        }
                    } else l.pins.push(e);
                    e.tileKey = s
                }
            }
        }, s.onTileElevationsUpdated = function(e, t) {
            r.each(this._pinsByTile, function(e) {
                var i = e.bounds,
                    n = i.xMin > t.xMax || i.xMax < t.xMin || i.yMax < t.yMin || i.yMin > t.yMax;
                if (!n)
                    for (var r = e.pins, o = 0; o < r.length; o++) {
                        var a = r[o];
                        this.updatePinHeight(a), a.update()
                    }
            }, this)
        }, s.updatePinsHeightInBounds = function(e) {
            r.each(this._pinsByTile, function(t) {
                var i = t.bounds.xMin > e.xMax || t.bounds.xMax < e.xMin || t.bounds.yMax < e.yMin || t.bounds.yMin > e.yMax;
                if (!i)
                    for (var n = t.pins, r = 0; r < n.length; r++) {
                        var o = n[r];
                        this.updatePinHeight(o)
                    }
            }, this)
        }, s.updatePinHeight = function(e) {
            !e.mustComputeHeight && this._mapRenderer.isIn3d() && (e.mustComputeHeight = !0, this._pinsHeightToBeUpdated.push(e))
        }, s._updateHeight = function(e) {
            e.mustComputeHeight = !1;
            var t, i = null,
                n = e.getPosition();
            if (e._disableHeight && null == e._forceHeight ? t = 0 : (t = this._mapRenderer.conf.get("pins.minHeight"), e.fixedHeight ? t = e.overlay.getHeight() : null != e._forceHeight ? t = e._forceHeight : this._currentDraggedPin == e ? t = this._dragHeight : i = r.reduce(this._mapRenderer.map._layersByType.buildings, function(e, t) {
                    var i = t.getBuildingHeightAt(n);
                    return null == e ? i : null != i ? Math.max(e, i) : e
                }, null)), null != i) t = Math.max(i, t);
            else if (this._mapRenderer.map.elevation) {
                var o = this._mapRenderer.findHeight({
                    x: n.lon,
                    y: n.lat
                });
                null != o && (t += o)
            }
            e._height != t && (e.setHeight(t), e.update())
        }, s.updatePin = function(e) {
            this._markerRenderer.updatePin(e), this.refreshScreenPosition(e), this._mapRenderer.forceRender()
        }, s.onTextureReceived = function(e) {
            this.refreshScreenPosition(e)
        }, s.refreshScreenPosition = function(e) {
            var t = this._mapRenderer.getSize();
            e.refreshScreenPosition(t)
        }, s.updatePinPosition = function(e) {
            this._markerRenderer.updatePinPosition(e), this._mapRenderer.forceRender()
        }, s.onCompute = function(e) {
            this.computeAnimations(e.dt)
        }, s.onPreRender = function() {
            this._allPositionsDirty && this.refreshAllPositions(), this._mapRenderer.textManager && this._mapRenderer.textManager.render()
        }, s.computeAnimations = function(e) {
            var t = !1;
            if (r.each(this._pinsToAnimate, function(i) {
                    null != i._animation && (t = !0, i.computeAnimation(e) && delete this._pinsToAnimate[i._id], this.refreshScreenPosition(i))
                }, this), t) {
                var i = this._mapRenderer.lastMouseEvent;
                this._mapRenderer.askForHover(), this._mapRenderer.computeHover(i), this._mapRenderer.lastMouseEvent = i
            }
        }, s.addPinToAnimate = function(e) {
            this._pinsToAnimate[e._id] = e
        }, s.removePinToAnimate = function(e) {
            delete this._pinsToAnimate[e._id]
        }, s.getPinsPointed = function(e, t) {
            var i = t.clickable,
                n = t.draggable,
                o = [];
            if (this._allPositionsDirty) return o;
            for (var a = 0; a < this._numberOfPins; a++) {
                var s = this._allPins[a];
                s.isInPinOrTextClickableZone(e) && (i && s.clickable || n && s.draggable) && o.push(s)
            }
            var l = this._mapRenderer._maxZIndex,
                h = [];
            return r.each(o, function(e) {
                var t = Math.min(Math.max(l - e.zIndex, 1), 15);
                h.push({
                    pin: e,
                    zIndex: t
                })
            }), h = r.sortBy(h, function(e) {
                return e.zIndex
            })
        }, s.refreshAllPositions = function() {
            for (var e = this._mapRenderer.getSize(), t = 0; t < this._numberOfPins; t++) this._allPins[t].refreshScreenPosition(e);
            this._allPositionsDirty = !1
        }, s.setPositionsDirty = function() {
            this._allPositionsDirty = !0, this._mapRenderer.forceRender && this._mapRenderer.forceRender()
        }
    }, {
        "../../utils/LocationHelper": 407,
        "../../utils/WorkProcessor": 416,
        underscore: 207
    }],
    350: [function(e, t, i) {
        "use strict";
        var n = e("engine"),
            r = n.Vector2,
            o = n.Vector3,
            a = n.Matrix4,
            s = n.Quaternion;
        t.exports = function(t, i) {
            var n = t.environment.tileWaterColor,
                l = i.uniforms;
            l.fog = {
                fogNearFar: {
                    type: "v2",
                    value: new r
                },
                skyTexture: {
                    type: "t",
                    slot: 6,
                    value: null
                },
                sunDirection: {
                    type: "v3",
                    value: new o
                }
            }, l.water = {
                waterBumpAndReflection: {
                    type: "t",
                    slot: 1,
                    texture: null
                },
                waterSpecular: {
                    type: "v2",
                    value: new r
                },
                tileWaterColor: {
                    type: "v3",
                    value: new o(n.r, n.g, n.b)
                }
            }, l.colorFilter = {
                colorFilterMode: {
                    type: "i",
                    value: 1
                },
                colorChannelMixer: {
                    type: "m4",
                    value: new a
                }
            }, l.remapColors2d = {
                colorsMapping: {
                    type: "v3v",
                    value: new Float32Array(60)
                }
            }, l.remapColors3d = {
                colorsMapping: {
                    type: "v3v",
                    value: new Float32Array(60)
                }
            };
            var h = i.programs.vertex;
            h.ground2D = e("./ground2D.vshader"), h.ground3D = e("./ground3D.vshader"), h.markerIcon = e("./markerIcon.vshader"), h.lineRender = e("./lineRender.vshader"), h.heatmap_render = e("./heatmap_render.vshader"), h.highlightBuilding = e("./highlightBuilding.vshader");
            var u = i.programs.fragment;
            u.ground2D = e("./ground2D.fshader"), u.ground3D = e("./ground3D.fshader"), u.markerIcon = e("./markerIcon.fshader"), u.heatmap_render = e("./heatmap_render.fshader");
            var d = i.effects;
            d.ground2D = {
                uniforms: {
                    tex0: {
                        type: "t",
                        slot: 0,
                        texture: null
                    },
                    parentTexture: {
                        type: "t",
                        slot: 3,
                        texture: null
                    },
                    ratio: {
                        type: "f",
                        value: 0
                    },
                    uvOffset: {
                        type: "v2",
                        value: new r(0, 0)
                    },
                    uvScale: {
                        type: "v2",
                        value: new r(1, 1)
                    }
                },
                vertexProgramName: "ground2D",
                fragmentProgramName: "ground2D"
            }, d.ground3D = {
                commonUniformKeys: ["globalLight", "light", "cameraPos", "water", "fog", "time"],
                uniforms: {
                    tex0: {
                        type: "t",
                        slot: 0,
                        texture: null
                    },
                    parentTexture: {
                        type: "t",
                        slot: 3,
                        texture: null
                    },
                    ratio: {
                        type: "f",
                        value: 0
                    },
                    uvOffset: {
                        type: "v2",
                        value: new r(0, 0)
                    },
                    uvScale: {
                        type: "v2",
                        value: new r(1, 1)
                    }
                },
                vertexDefines: ["#define USE_TIMER"].join("\n"),
                fragmentDefines: ["#define BACK_SHADOWING"].join("\n"),
                vertexProgramName: "ground3D",
                fragmentProgramName: "ground3D"
            }, d.groundForStencil = {
                commonUniformKeys: ["cameraPos", "water", "time"],
                uniforms: {
                    tex0: {
                        type: "t",
                        slot: 0,
                        texture: null
                    }
                },
                vertexDefines: ["#define WATER_ONLY", "#define USE_TIMER"].join("\n"),
                vertexProgramName: "ground3D",
                fragmentDefines: ["#define WATER_ONLY"].join("\n"),
                fragmentProgramName: "ground3D"
            }, d.markerIcon = {
                commonUniformKeys: ["screenSize"],
                uniforms: {
                    texture: {
                        type: "t",
                        slot: 0,
                        texture: null
                    },
                    size: {
                        type: "v2",
                        value: new r(0, 0)
                    },
                    clippingWorld: {
                        type: "v2",
                        value: new r(3200, 2e3)
                    },
                    in3d: {
                        type: "i",
                        value: 0
                    }
                },
                vertexProgramName: "markerIcon",
                fragmentProgramName: "markerIcon"
            }, d.lineRender = {
                commonUniformKeys: ["screenSize"],
                uniforms: {
                    strokeWeight: {
                        type: "f",
                        value: 5
                    }
                },
                vertexProgramName: "lineRender",
                fragmentProgramName: "common3D"
            }, d.lineRenderPicking = {
                commonUniformKeys: ["screenSize", "picking"],
                uniforms: {
                    strokeWeight: {
                        type: "f",
                        value: 5
                    }
                },
                vertexProgramName: "lineRender",
                fragmentProgramName: "picking"
            }, d.heatmap_render = {
                uniforms: {
                    intensity: {
                        type: "f",
                        value: .3
                    },
                    viewRect: {
                        type: "v4",
                        value: new s
                    },
                    radiusFactor: {
                        type: "f",
                        value: 1
                    }
                },
                vertexProgramName: "heatmap_render",
                fragmentProgramName: "heatmap_render",
                vertexDefines: ["#define HEATMAP_GENERATOR"].join("\n"),
                fragmentDefines: ["#define HEATMAP_GENERATOR"].join("\n")
            }, d.heatmap_colorizer_render = {
                uniforms: {
                    heatmapOpacity: {
                        type: "f",
                        value: .6
                    },
                    heatmapIntensityTexture: {
                        type: "t",
                        slot: 0,
                        texture: null
                    },
                    heatmapGradientTexture: {
                        type: "t",
                        slot: 1,
                        texture: null
                    }
                },
                vertexProgramName: "heatmap_render",
                fragmentProgramName: "heatmap_render",
                vertexDefines: ["#define HEATMAP_COLORIZER"].join("\n"),
                fragmentDefines: ["#define HEATMAP_COLORIZER"].join("\n")
            }, d.highlightBuilding = {
                commonUniformKeys: ["time"],
                vertexDefines: ["#define USE_TIMER"].join("\n"),
                vertexProgramName: "highlightBuilding",
                fragmentProgramName: "common3D"
            };
            var c = i.extensions;
            c.dataLayer = {
                uniforms: {
                    dataLayerTexture: {
                        type: "t",
                        slot: 7,
                        texture: null
                    },
                    dataLayerReady: {
                        type: "i",
                        value: 0
                    },
                    dataLayerGradientTexture: {
                        type: "t",
                        slot: 8,
                        texture: null
                    },
                    dataLayerOpacity: {
                        type: "f",
                        value: .6
                    }
                },
                fragmentDefines: ["#define DATALAYER_ENABLED"].join("\n")
            }, c.colorFilter = {
                commonUniformKeys: ["colorFilter"],
                fragmentDefines: ["#define COLOR_FILTER"].join("\n")
            }, c.remapColors2d = {
                commonUniformKeys: ["remapColors2d"],
                fragmentDefines: ["#define REMAP_COLORS_ENABLED"].join("\n")
            }, c.remapColors3d = {
                commonUniformKeys: ["remapColors3d"],
                fragmentDefines: ["#define REMAP_COLORS_ENABLED"].join("\n")
            };
            var f = ["#define ELEVATION_ENABLED"];
            t.get("elevations.useNormalMap") && f.push("#define LEGACY_ELEVATION_NORMALS_MAP"), c.elevation = {
                vertexDefines: f.join("\n"),
                fragmentDefines: f.join("\n"),
                uniforms: {
                    normalsTexture: {
                        type: "t",
                        slot: 4,
                        texture: null
                    },
                    normalsTextureOffset: {
                        type: "v2",
                        value: new r(0, 1)
                    }
                }
            }, c.vertexNormalMap = {
                uniforms: {
                    normalMapTexture: {
                        type: "t",
                        slot: 4,
                        texture: null
                    },
                    normalMapUvOffset: {
                        type: "v2",
                        value: new r(0, 0)
                    },
                    normalMapUvScale: {
                        type: "v2",
                        value: new r(1, 1)
                    }
                },
                vertexDefines: ["#define ELEVATION_ENABLED", "#define VERTEX_NORMALMAP_ENABLED"].join("\n"),
                fragmentDefines: ["#define ELEVATION_ENABLED"].join("\n")
            }, c.fragmentNormalMap = {
                uniforms: {
                    normalMapTexture: {
                        type: "t",
                        slot: 4,
                        texture: null
                    },
                    normalMapUvOffset: {
                        type: "v2",
                        value: new r(0, 0)
                    },
                    normalMapUvScale: {
                        type: "v2",
                        value: new r(1, 1)
                    }
                },
                fragmentDefines: ["#define ELEVATION_ENABLED", "#define FRAGMENT_NORMALMAP_ENABLED"].join("\n")
            }, c.waterRipple = {
                fragmentDefines: "#define WATER_RIPPLE_ENABLED\n"
            }
        }
    }, {
        "./ground2D.fshader": 351,
        "./ground2D.vshader": 352,
        "./ground3D.fshader": 353,
        "./ground3D.vshader": 354,
        "./heatmap_render.fshader": 355,
        "./heatmap_render.vshader": 356,
        "./highlightBuilding.vshader": 357,
        "./lineRender.vshader": 358,
        "./markerIcon.fshader": 359,
        "./markerIcon.vshader": 360,
        engine: 10
    }],
    351: [function(e, t, i) {
        t.exports = "uniform sampler2D tex0;\nuniform sampler2D parentTexture;\nuniform float ratio;\n\n#ifdef DATALAYER_ENABLED\nuniform sampler2D dataLayerTexture;\nuniform sampler2D dataLayerGradientTexture;\nuniform int dataLayerReady;\nuniform float dataLayerOpacity;\n#endif // DATALAYER_ENABLED\n\nvarying vec2 vUv;\nvarying vec2 parentUv;\nvarying vec4 vColor;\n\n#ifdef REMAP_COLORS_ENABLED\n#define MAX_REMAPPABLE_COLORS 10\n#define REMAP_COLORS_EPSILON (5./255.)\nuniform vec3 colorsMapping[MAX_REMAPPABLE_COLORS*2];\n#endif //REMAP_COLORS_ENABLED\n\n#ifdef COLOR_FILTER\nuniform mat4 colorChannelMixer;\nuniform int colorFilterMode;\n\nvec4 applyColorFilter(vec4 color) {\n\n    if (colorFilterMode == 1) {\n        // Channel mixed\n        return color * colorChannelMixer;\n\n    } else if (colorFilterMode == 2) {\n        // Black and white\n        const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n        float luminance = dot(color.rgb, W);\n        return vec4(vec3(luminance), color.a);\n\n    } else  {\n        return color;\n    }\n}\n\n#endif\n\nvoid main()\n{\n#ifdef DEPTH_MAP\n    setDepthColor();\n#else //DEPTH_MAP\n\n    gl_FragColor = vColor * mix( texture2D( tex0, vUv ), texture2D( parentTexture, parentUv ), ratio );\n\n#ifdef REMAP_COLORS_ENABLED\n    for(int i = 0; i < MAX_REMAPPABLE_COLORS; ++i) {\n        if (length(gl_FragColor.rgb - colorsMapping[i*2]) < REMAP_COLORS_EPSILON)\n            gl_FragColor.rgb = gl_FragColor.rgb - colorsMapping[i*2] + colorsMapping[i*2+1];\n    }\n#endif //REMAP_COLORS_ENABLED\n\n#ifdef COLOR_FILTER\n    gl_FragColor = applyColorFilter(gl_FragColor);\n#endif\n\n#ifdef DATALAYER_ENABLED\n\n    if (dataLayerReady > 0) {\n        // Use if using a floating point texture\n//      float intensity = smoothstep(0.0, 1.0, texture2D(dataLayerTexture, vUv).r);\n\n        // Use if using conversion function from vec4 color to float\n        // Invert uv.y because heatmap is rendered with inverted y\n        float intensity = vec4ToFloat(smoothstep(0.0, 1.0, texture2D(dataLayerTexture, vec2(vUv.x , 1.0 - vUv.y))));\n\n        // Convert intensity to color\n        //vec4 dataLayerColor = vec4(texture2D(dataLayerGradientTexture, vec2(intensity, 0.0)).rgb, intensity);\n        vec4 dataLayerColor = texture2D(dataLayerGradientTexture, vec2(intensity, 0.0));\n        dataLayerColor.a *= dataLayerOpacity;\n\n        // Blend with current color\n        gl_FragColor = mix( gl_FragColor, dataLayerColor, dataLayerColor.a );\n\n//        // Use this if heatmap is pre-rendered as colorized texture\n//        vec4 heatmapColor = texture2D(dataLayerTexture, vUv);\n//        gl_FragColor = mix( gl_FragColor, heatmapColor, heatmapColor.a);\n    }\n#endif //DATALAYER_ENABLED\n#endif //DEPTH_MAP\n\n}\n"
    }, {}],
    352: [function(e, t, i) {
        t.exports = "\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\n\nvarying vec2 vUv;\nvarying vec2 parentUv;\nvarying vec4 vColor;\n\nvoid main()\n{\n    vUv = uv;\n    parentUv = uvOffset + uv * uvScale;\n    vColor = color;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n"
    }, {}],
    353: [function(e, t, i) {
        t.exports = "uniform sampler2D skyTexture;\nuniform vec3 sunDirection;\n\nuniform sampler2D waterBumpAndReflection; // rgb = water Bump, a = reflection/noise\nuniform vec2 waterSpecular;\nuniform vec3 tileWaterColor;\n\nuniform sampler2D tex0;\nuniform sampler2D parentTexture;\nuniform float ratio;\n\n#ifdef DATALAYER_ENABLED\nuniform sampler2D dataLayerTexture;\nuniform sampler2D dataLayerGradientTexture;\nuniform int dataLayerReady;\nuniform float dataLayerOpacity;\n#endif // DATALAYER_ENABLED\n\n\nuniform vec4 vLightFrontColor;\nuniform vec4 vLightBackColor;\nuniform vec4 vLightAmbientColor;\n\nvarying vec3 vEyeDir;\nvarying float fogRate;\nvarying vec2 vUv;\nvarying vec2 parentUv;\nvarying vec4 vColor;\nvarying vec2 waterUv0;\nvarying vec2 waterUv1;\n\n#ifdef ELEVATION_ENABLED\n#ifdef FRAGMENT_NORMALMAP_ENABLED\nuniform sampler2D normalMapTexture;\nuniform vec2 normalMapUvOffset;\nuniform vec2 normalMapUvScale;\n#else\nvarying vec3 vNormal;\n#ifdef LEGACY_ELEVATION_NORMALS_MAP\nuniform sampler2D normalsTexture;\nuniform vec2 normalsTextureOffset;\n#endif //LEGACY_ELEVATION_NORMALS_MAP\n#endif //FRAGMENT_NORMALMAP_ENABLED\n#endif //ELEVATION_ENABLED\n\n#ifdef REMAP_COLORS_ENABLED\n#define MAX_REMAPPABLE_COLORS 10\n#define REMAP_COLORS_EPSILON (5./255.)\nuniform vec3 colorsMapping[MAX_REMAPPABLE_COLORS*2];\n#endif //REMAP_COLORS_ENABLED\n\n\nfloat getFresnelRate(vec3 eyeDir, out vec3 bump) {\n    vec3 bump0 = texture2D( waterBumpAndReflection, waterUv0 ).xyz;\n    vec3 bump1 = texture2D( waterBumpAndReflection, waterUv1 ).xyz;\n\n    bump = normalize( bump0 + bump1 + vec3( -1.0, -1.0, 0.0 ) );\n\n    vec2 envUv = bump.xy + eyeDir.xy * min( 0.5, eyeDir.z );\n\n    float fresnelRate = texture2D( waterBumpAndReflection, envUv ).a;\n    fresnelRate *= fresnelRate;\n\n    return fresnelRate;\n}\n\n#ifdef WATER_ONLY // Draw stencil for water rendering\nvoid main() {\n    gl_FragColor = texture2D( tex0, vUv );\n\n    vec3 eyeDir = normalize( vEyeDir );\n\n    if( length(gl_FragColor.rgb - tileWaterColor ) < 0.05 ) {\n#ifdef WATER_RIPPLE_ENABLED\n        vec3 bump;\n        float fresnelRate = getFresnelRate(eyeDir, bump);\n\n        if(fresnelRate < max( 0.4, 0.65 * eyeDir.z ) ) {\n            discard;\n        }\n#endif // WATER_RIPPLE_ENABLED\n\n        gl_FragColor = vec4( 1.0 );\n    } else {\n        discard;\n    }\n#ifdef DEPTH_MAP\n    setDepthColor();\n#endif //DEPTH_MAP\n}\n\n#else // WATER_ONLY // Following is for main ground shader\n\n#ifdef COLOR_FILTER\nuniform mat4 colorChannelMixer;\nuniform int colorFilterMode;\n\nvec4 applyColorFilter(vec4 color) {\n\n    if (colorFilterMode == 1) {\n        // Channel mixed\n        return color * colorChannelMixer;\n\n    } else if (colorFilterMode == 2) {\n        // Black and white\n        const vec3 W = vec3(0.2125, 0.7154, 0.0721);\n        float luminance = dot(color.rgb, W);\n        return vec4(vec3(luminance), color.a);\n\n    } else  {\n        return color;\n    }\n}\n\n#endif\n\nvoid main() {\n    gl_FragColor = mix( texture2D( tex0, vUv ), texture2D( parentTexture, parentUv ), ratio );\n\n#ifdef REMAP_COLORS_ENABLED\n    for(int i = 0; i < MAX_REMAPPABLE_COLORS; ++i) {\n        if (length(gl_FragColor.rgb - colorsMapping[i*2]) < REMAP_COLORS_EPSILON)\n            gl_FragColor.rgb = gl_FragColor.rgb - colorsMapping[i*2] + colorsMapping[i*2+1];\n    }\n#endif //REMAP_COLORS_ENABLED\n\n    // Get normal from varying or from normal map\n    vec3 normal = vec3(0.0, 0.0, 1.0);\n#ifdef ELEVATION_ENABLED\n#ifdef FRAGMENT_NORMALMAP_ENABLED\n    vec2 normalMapUv = normalMapUvOffset + vUv * normalMapUvScale;\n    normal = texture2D(normalMapTexture, normalMapUv).rgb * 2.0 - 1.0;\n#else\n#ifdef LEGACY_ELEVATION_NORMALS_MAP\n    vec2 coord = vUv * normalsTextureOffset.y + vec2(normalsTextureOffset.x);\n    normal = normalize(texture2D( normalsTexture,coord).xyz * 2. - 1.);\n#else\n    normal = vNormal;\n#endif //LEGACY_ELEVATION_NORMALS_MAP\n#endif //FRAGMENT_NORMALMAP_ENABLED\n#endif //ELEVATION_ENABLED\n\n    vec3 shadow = vec3(1.0);\n#ifdef SHADOW_ENABLED\n#ifdef USE_SHADOW\n    shadow = computeShadow();\n#else\n#ifdef USE_CSM\n    shadow = computeCSMShadow(normal);\n#endif //USE_CSM\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n\n    vec4 horizonColor = texture2D(skyTexture, vec2(sunDirection.z + 0.05, 1.0 ) );\n    vec3 eyeDir = normalize( vEyeDir );\n\n#ifdef WATER_RIPPLE_ENABLED\n    if( length(gl_FragColor.rgb - tileWaterColor ) < 0.05 ) {\n        vec3 bump;\n        float fresnelRate = getFresnelRate(eyeDir, bump);\n\n        vec3 lightDir = normalize(reflect(vLightDir, bump));\n        float spec = waterSpecular.x * pow(max(dot(lightDir, -eyeDir), 0.0), waterSpecular.y);\n#ifdef SHADOW_ENABLED\n        spec *= step( 0.98, shadow.r );\n#endif //SHADOW_ENABLED\n\n        vec4 wColor = texture2D(skyTexture, vec2( sunDirection.z + 0.05, 0.05 ) );\n        vec4 wsColor = texture2D(skyTexture, vec2 (sunDirection.z + 0.05, 0.0 ) );\n\n        gl_FragColor = mix( wColor, horizonColor, fresnelRate ) + wsColor * spec;\n    }\n#endif // WATER_RIPPLE_ENABLED\n\n    gl_FragColor *= vColor;\n\n#ifdef ELEVATION_ENABLED\n    float normalDotLight = 1.4 * dot( normal, vLightDir ) - 0.3;\n    gl_FragColor.rgb *= (mix( vLightBackColor, vLightFrontColor, normalDotLight ) + vLightAmbientColor).rgb;\n#endif //ELEVATION_ENABLED\n\n#ifdef SHADOW_ENABLED\n    gl_FragColor.rgb *= shadow;\n#endif //SHADOW_ENABLED\n\n\n#ifdef COLOR_FILTER\n    gl_FragColor = applyColorFilter(gl_FragColor);\n#endif\n\n#ifdef DATALAYER_ENABLED\n    if (dataLayerReady > 0) {\n        // Use if using a floating point texture\n//      float intensity = smoothstep(0.0, 1.0, texture2D(dataLayerTexture, vUv).r);\n\n        // Use if using conversion function from vec4 color to float\n        // Invert uv.y because heatmap is rendered with inverted y\n        float intensity = vec4ToFloat(smoothstep(0.0, 1.0, texture2D(dataLayerTexture, vec2(vUv.x , 1.0 - vUv.y))));\n\n        // Convert intensity to color\n        //vec4 dataLayerColor = vec4(texture2D(dataLayerGradientTexture, vec2(intensity, 0.0)).rgb, intensity);\n        vec4 dataLayerColor = texture2D(dataLayerGradientTexture, vec2(intensity, 0.0));\n        dataLayerColor.a *= dataLayerOpacity;\n\n        // Blend with current color\n        gl_FragColor = mix(gl_FragColor, dataLayerColor, dataLayerColor.a);\n    }\n#endif\n\n    gl_FragColor.rgb = mix( gl_FragColor.rgb, horizonColor.rgb, fogRate );\n#ifdef DEPTH_MAP\n    setDepthColor();\n#endif //DEPTH_MAP\n}\n\n\n#endif // WATER_ONLY\n\n\n";
    }, {}],
    354: [function(e, t, i) {
        t.exports = "uniform vec3 cameraPosition;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nuniform vec2 fogNearFar;\nuniform vec4 vGlobalColor;\nuniform vec2 waterParams;\n\nvarying vec2 vUv;\nvarying vec2 parentUv;\nvarying vec4 vColor;\n\nvarying float fogRate;\nvarying vec3 vEyeDir;\nvarying vec2 waterUv0;\nvarying vec2 waterUv1;\n\n#ifdef ELEVATION_ENABLED\nvarying vec3 vNormal;\n#ifdef VERTEX_NORMALMAP_ENABLED\nuniform sampler2D normalMapTexture;\nuniform vec2 normalMapUvOffset;\nuniform vec2 normalMapUvScale;\n#endif //VERTEX_NORMALMAP_ENABLED\n#endif //ELEVATION_ENABLED\n\nconst float fogDensity = 0.75;\n\nvoid main()\n{\n    vUv = uv;\n    vec3 groundPosition = position;\n\n#ifdef ELEVATION_HEIGHTMAP_ENABLED\n	groundPosition.z = getHeightFromHeightMap(groundPosition);\n#endif\n\n\n#ifndef WATER_ONLY\n    float uvFactor = 1.0;\n#else\n    float uvFactor = -1.0;\n#endif //WATER_ONLY\n    waterUv0 = 3.0 * uv.xy * uvFactor + 0.015 * currentTime;\n    waterUv1 = 2.0 * uv.xy * uvFactor - 0.025 * currentTime;\n\n    parentUv = uvOffset + uv * uvScale;\n    vColor = color * vGlobalColor;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( groundPosition, 1.0 );\n\n    vEyeDir = cameraPosition - (objectMatrix * vec4( groundPosition, 1.0 )).xyz;\n\n#ifdef SHADOW_ENABLED\n#ifdef USE_SHADOW\n    computeShadowCoord();\n#else\n#ifdef USE_CSM\n    computeWorldPos();\n#endif //USE_CSM\n#endif //USE_SHADOW\n#endif //SHADOW_ENABLED\n\n    fogRate = smoothstep( fogNearFar.x, fogNearFar.y, gl_Position.z ) * fogDensity;\n\n#ifdef ELEVATION_ENABLED\n#ifdef VERTEX_NORMALMAP_ENABLED\n    vec2 normalMapUv = normalMapUvOffset + uv * normalMapUvScale;\n    vNormal = texture2D(normalMapTexture, normalMapUv).rgb * 2.0 - 1.0;\n#else\n    vNormal = normal;\n#endif // VERTEX_NORMALMAP_ENABLED\n#endif //ELEVATION_ENABLED\n}\n"
    }, {}],
    355: [function(e, t, i) {
        t.exports = "#ifdef HEATMAP_GENERATOR\n\nvarying vec2 off;\nvarying vec2 dim;\nvarying float vIntensity;\n\nvoid main(){\n\n    float falloff = (1.0 - smoothstep(0.0, 1.0, length(off / dim)));\n\n    // Smooth falloff, avoid linear\n    falloff *= max(falloff, 0.7);\n    falloff *= max(falloff, 0.7);\n    falloff *= max(falloff, 0.7);\n    falloff *= max(falloff, 0.7);\n    falloff *= max(falloff, 0.7);\n\n    float intensity = falloff * vIntensity;\n\n\n//    Use if using floating point texture\n//    gl_FragColor = vec4(intensity);\n\n//  Use if using conversion function from float to vec4 color\n    gl_FragColor = floatToVec4(intensity);\n\n}\n\n#endif // HEATMAP_GENERATOR\n#ifdef HEATMAP_COLORIZER\n\nuniform sampler2D heatmapIntensityTexture;\nuniform sampler2D heatmapGradientTexture;\nuniform float heatmapOpacity;\n\nvarying vec2 vUv;\n\n\nvoid main() {\n\n    // Use if using a floating point texture\n//  float intensity = smoothstep(0.0, 1.0, texture2D(heatmapIntensityTexture, vUv).r);\n\n    // Use if using conversion function from vec4 color to float\n    float intensity = vec4ToFloat(smoothstep(0.0, 1.0, texture2D(heatmapIntensityTexture, vUv)));\n\n    // Convert intensity to color\n    vec4 heatmapColor = texture2D(heatmapGradientTexture, vec2(intensity, 0.0));\n    heatmapColor.a *= heatmapOpacity;\n\n    // Blend with current color\n    gl_FragColor = heatmapColor;\n}\n\n#endif //HEATMAP_COLORIZER\n"
    }, {}],
    356: [function(e, t, i) {
        t.exports = "#ifdef HEATMAP_GENERATOR\n\nattribute vec4 userData;\n\nvarying vec2 off;\nvarying vec2 dim;\nvarying float vIntensity;\n\nuniform vec4 viewRect;\nuniform float intensity;\nuniform float radiusFactor;\n\nvoid main(){\n    // userData.xy holds offset position for each point\n    // position.xy hold position of point\n\n    // scale radius\n    vec2 scaledOffset = userData.xy * vec2(radiusFactor);\n\n    // Calculate position\n    dim = abs(scaledOffset);\n    off = scaledOffset;\n    vec2 pos = position.xy + scaledOffset;\n\n    // Intensity of data\n    vIntensity = intensity * userData.z;\n\n    // Convert position to viewport position\n    vec2 viewSize = viewRect.zw;\n    vec2 viewOrigin = viewRect.xy;\n\n    gl_Position = vec4(((pos - viewOrigin) / viewSize) * 2.0 - 1.0, 0.0, 1.0);\n\n}\n\n#endif // HEATMAP_GENERATOR\n#ifdef HEATMAP_COLORIZER\n\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = vec4(position, 1.0);\n}\n\n\n#endif // HEATMAP_COLORIZER\n"
    }, {}],
    357: [function(e, t, i) {
        t.exports = "varying vec4 vColor;\n\nvoid main()\n{\n    vec3 pos = position;\n    vColor = vec4(0.2, 0.5, 1., 1.);\n    vColor.a = float(pos.z == 0.);\n    pos.z *= 0.1 + abs(sin(currentTime * 2.0));\n    gl_Position = projectionMatrix * modelViewMatrix * vec4( pos, 1.0 );\n}\n\n"
    }, {}],
    358: [function(e, t, i) {
        t.exports = "uniform float strokeWeight;\nvarying vec4 vColor;\nuniform vec2 screenSize;\n\nvoid main()\n{\n    vColor = color;\n    mat4 matrix = projectionMatrix * modelViewMatrix;\n    vec4 pos = matrix * vec4(position.xy + normal.xy, position.z, 1.0);\n    vec4 center = matrix * vec4(position, 1.0);\n    vec2 delta = (pos.xy - center.xy);\n    gl_Position = center;\n    if (length(delta) > 0.) {\n        vec3 movedPosition = position;\n        movedPosition.xy += normal.xy * strokeWeight / length(delta) / screenSize * pos.w;\n        gl_Position = matrix * vec4(movedPosition, 1.0);\n    }\n}\n"
    }, {}],
    359: [function(e, t, i) {
        t.exports = "varying vec2 vUv;\n\nuniform sampler2D texture;\nuniform bool in3d;\nuniform vec2 size;\nvarying vec2 vScale;\n\n#ifdef CLIPPING\nvarying vec4 worldPosition;\nuniform vec2 clippingWorld;\n#endif//CLIPPING\n\nvoid main()\n{\n#ifdef CLIPPING\n    if(in3d) {\n        if(worldPosition.x<-clippingWorld.x) discard;\n        if(worldPosition.x>clippingWorld.x) discard;\n        if(worldPosition.y<-clippingWorld.y) discard;\n        if(worldPosition.y>clippingWorld.y) discard;\n    }\n#endif//CLIPPING\n    if(distance(vScale, vec2(1., 1.)) < 1e-6) {\n        // not scaled => no filtering\n        gl_FragColor = texture2D( texture, vUv );\n    } else {\n        // scaled => linear filtering\n        float halfTexelSizeX = .5 / size.x;\n        float haltTexelSizeY = .5 / size.y;\n        gl_FragColor = (texture2D(texture, vUv + vec2(halfTexelSizeX, 0))\n            + texture2D(texture, vUv + vec2(-halfTexelSizeX, 0))\n            + texture2D(texture, vUv + vec2(0, haltTexelSizeY))\n            + texture2D(texture, vUv + vec2(0, -haltTexelSizeY))) * 0.25;\n    }\n\n    if( gl_FragColor.a < 0.2 )\n        discard;\n#ifdef DEPTH_MAP\n    setDepthColor();\n#endif //DEPTH_MAP\n}\n"
    }, {}],
    360: [function(e, t, i) {
        t.exports = 'attribute vec4 userData;\n\nvarying vec2 vUv;\nuniform bool in3d;\nuniform vec2 size;\nuniform vec2 screenSize;\nvarying vec2 vScale;\n\n#ifdef CLIPPING\nvarying vec4 worldPosition;\n#endif //CLIPPING\n\nvoid main()\n{\n    vec4 pos = vec4( position, 1.0 );\n    pos.z *= float(in3d);\n#ifdef CLIPPING\n    worldPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif //CLIPPING\n\n    vec2 computedSize = vec2(\n        float(userData.z == 0.) * size.x + userData.z,\n        float(userData.w == 0.) * size.y + userData.w\n    );\n    vec2 anchor = float(!in3d) * color.xy + float(in3d) * color.zw;\n\n    gl_Position = projectionMatrix * modelViewMatrix * pos;\n    //must use not modified gl_Position.y\n    gl_Position.z = mix( gl_Position.z, (abs(normal.z)-0.9375) * gl_Position.w + gl_Position.y / 32.0, float(!in3d || normal.z >= 0.0));\n\n    //"* 2." because position goes from -1. to 1.\n    computedSize *= uv;\n    gl_Position.xy += ( computedSize - anchor ) * normal.xy * vec2(2.0, -2.0) * gl_Position.w / screenSize;\n    gl_Position.xy = ceil( gl_Position.xy * screenSize + uv) / ( screenSize + ( 1.0 - uv));\n    gl_Position.xy += ((( floor( gl_Position.xy * screenSize + uv ) ) / ( screenSize + uv ) ) - gl_Position.xy) * uv;\n    vUv = ( userData.xy + computedSize ) / size;\n    vScale = normal.xy;\n}\n'
    }, {}],
    361: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.renderer = e, this.readConf(), this._readConfHandler = r.bind(this.readConf, this), this.renderer.conf.on("change:textOverlays", this._readConfHandler), this.container2d = o("<div></div>"), this.container2d.addClass("olScrollable"), this.container2d.css({
                position: "absolute",
                top: 0,
                left: 0,
                "pointer-events": "none",
                "user-select": "none"
            });
            var i = t.find("canvas, .olMapViewport");
            i.length ? i.eq(0).after(this.container2d) : t.append(this.container2d);
            var n = document && document.createElement("canvas");
            n.width = 0, n.height = 0, this._context2d = n.getContext("2d"), this._frustum = {}, this.textOverlaysByZIndex = {}, this.newRenderTextOverlays = [], this.zIndexes = [], this.renderTextOverlays = [], this.isDirty = !0, this.allPositionsDirty = !0, this.renderedPositionsDirty = !0, this._setDirtyHandler = r.bind(this.setDirty, this), this._setPositionHandler = r.bind(this.setPositionsDirty, this), this._elevationChangedHandler = r.bind(this.elevationChanged, this), this.renderer.on("enter2d", this._setDirtyHandler), this.renderer.on("enter3d", this._setDirtyHandler), this.renderer.on("cameraStabilized", this._setDirtyHandler), this.renderer.on("cameraChanged", this._setPositionHandler), this.renderer.map.on("elevation_changed", this._elevationChangedHandler), this.visible = !0, this.tempPosition = new s, this._sortProcessor = new l(this.renderer, {
                intervalIdle: this.renderer.conf.get("workProcessor.textManagerInterval"),
                maxDurationIdle: this.renderer.conf.get("workProcessor.textManagerDuration"),
                workWhenCameraMove: !1,
                name: "textManagerProcessor"
            }), this._sortProcessor.registerWorker(r.bind(this.getWork, this), "TextManager::getWork"), this._sortProcessor.start(), this.transform = this.get3dTransform(), this._paddingLeft = parseInt(this.renderer.$parentNode.css("padding-left")), this._paddingTop = parseInt(this.renderer.$parentNode.css("padding-top"))
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("engine"),
            s = a.Vector3,
            l = e("../../utils/WorkProcessor");
        t.exports = n, n.prototype.get3dTransform = function() {
            var e, t = document.createElement("p"),
                i = {
                    webkitTransform: "-webkit-transform",
                    OTransform: "-o-transform",
                    msTransform: "-ms-transform",
                    MozTransform: "-moz-transform",
                    transform: "transform"
                };
            document.body.insertBefore(t, null);
            var n = null;
            for (var r in i) void 0 !== t.style[r] && (t.style[r] = "translate3d(1px,1px,1px)", e = window.getComputedStyle(t).getPropertyValue(i[r]), e && (n = r));
            return document.body.removeChild(t), void 0 !== e && e.length > 0 && "none" !== e ? n : null
        }, n.prototype.readConf = function() {
            this.textOverlaysConf = this.renderer.conf.get("textOverlays"), this.hSpacing = this.renderer.conf.get("textOverlays.hSpacing"), this.vSpacing = this.renderer.conf.get("textOverlays.vSpacing"), this.maxWidth = this.renderer.conf.get("textOverlays.maxWidth"), this.paddingLeft = this.renderer.conf.get("textOverlays.paddingLeft"), this.paddingRight = this.renderer.conf.get("textOverlays.paddingRight"), this.backgroundTip = this.renderer.conf.get("textOverlays.backgroundTip"), this.paddingBottom = this.renderer.conf.get("textOverlays.paddingBottom"), this.paddingTop = this.renderer.conf.get("textOverlays.paddingTop"), this.pinsPriorityConf = this.renderer.conf.get("pins.priority")
        }, n.prototype.getFrustum = function() {
            var e = this.renderer.getFrustumFull(),
                t = 0;
            return e.xMin -= t, e.xMax += t, e.yMin -= t, e.yMax += t, e
        }, n.prototype.addTextOverlay = function(e) {
            var t = e.zIndex;
            if (null != t) {
                var i = this.textOverlaysByZIndex[t];
                null == i && (i = this.textOverlaysByZIndex[t] = {
                    textOverlays: [],
                    idxWorker: 0
                });
                var n = i.textOverlays;
                e._indexInManager = n.length, n.push(e), this.setDirty()
            }
        }, n.prototype.removeTextOverlay = function(e) {
            var t = e.zIndex;
            if (null != t) {
                var i = this.textOverlaysByZIndex[t];
                if (null != i) {
                    var n = i.textOverlays;
                    if (n.length > 1) {
                        var r = n[n.length - 1];
                        n[e._indexInManager] = r, r._indexInManager = e._indexInManager
                    }
                    n.length -= 1, i.idxWorker = 0, 0 == n.length && delete this.textOverlaysByZIndex[t]
                }
                e.zIndex = null, e._indexInManager = null, this.setDirty()
            }
            e.releaseCanvas()
        }, n.prototype.setDirty = function() {
            this.idxWorker = null, this.newRenderTextOverlays.length = 0, this.renderedPositionsDirty = this.allPositionsDirty, this.isDirty = !0
        }, n.prototype.getWork = function() {
            if (!this.textOverlaysConf.showText || !this.visible) return null;
            if (this.isDirty) {
                var e = null,
                    t = this;
                if (null == this.idxWorker) return e = function() {
                    t.zIndexes = r.keys(t.textOverlaysByZIndex), t.zIndexes.sort(), t.zIndexes.reverse(), t.idxWorker = 0;
                    for (var e = 0; e < t.zIndexes.length; ++e) t.textOverlaysByZIndex[t.zIndexes[e]].idxWorker = 0
                };
                if (this.idxWorker != this.zIndexes.length) return e = function() {
                    var e = t.textOverlaysByZIndex[t.zIndexes[t.idxWorker]],
                        i = e.textOverlays[e.idxWorker++];
                    i.refreshPosition();
                    var n = null == i.pin || i.isPinVisible(),
                        r = t.getFrustum();
                    t.isIn3dTemp = t.renderer.isIn3d();
                    var o = i.isInFrustum(r) || i.isInScreen();
                    if (o) {
                        var a = t.mustRenderTextOverlay(i);
                        a && n ? (t.newRenderTextOverlays.push(i), i.rendered = !0) : i.rendered = !1
                    } else i.rendered = !1;
                    if (i.rendered ? i.createCanvas() : i.releaseCanvas(), e.idxWorker == e.textOverlays.length && (t.idxWorker++, t.idxWorker == t.zIndexes.length)) {
                        var s = t.newRenderTextOverlays;
                        t.newRenderTextOverlays = t.renderTextOverlays, t.renderTextOverlays = s, t.newRenderTextOverlays.length = 0, t.isDirty = !1
                    }
                    t.renderer.forceRender()
                }
            }
            return null
        }, n.prototype.render = function() {
            this.renderedPositionsDirty && this.refreshRenderedPositions();
            for (var e = this.getFrustum(), t = 0; t < this.renderTextOverlays.length; ++t) {
                var i = this.renderTextOverlays[t];
                this.renderTextOverlay(i, i.isInFrustum(e), this._paddingLeft, this._paddingTop)
            }
        }, n.prototype.refreshRenderedPositions = function() {
            for (var e = 0; e < this.renderTextOverlays.length; ++e) this.renderTextOverlays[e].refreshPosition();
            this.renderedPositionsDirty = !1
        }, n.prototype.mustRenderTextOverlay = function(e) {
            if (!this.isIn3dTemp && !e.isPinVisible()) return !1;
            if (e._linesInfo) {
                var t, i, n = this.newRenderTextOverlays.length;
                for (t = 0; n > t; ++t)
                    if (i = this.newRenderTextOverlays[t], e !== i && e.isCrossing(i)) return !1;
                return !0
            }
            return !1
        }, n.prototype.setVisibility = function(e) {
            e != this.visible && (this.visible = e, this.setDirty())
        }, n.prototype.elevationChanged = function() {
            this.setDirty()
        }, n.prototype.renderTextOverlay = function(e, t, i, n) {
            var r = e.canvas;
            if (r) {
                var o = e._linesInfo;
                if (o) {
                    var a = 0,
                        s = e.pos2d;
                    if (e.pin && (a = .5 * e.pinSize.height, s = s.clone()), t) {
                        r.style.display = "block";
                        var l = Math.floor(s.x - r.clientWidth / 2) + i,
                            h = Math.floor(s.y - r.clientHeight - a - this.renderer.textManager.paddingBottom + n);
                        this.transform ? r.style[this.transform] = "translate3d(" + l + "px," + h + "px,0)" : (r.style.left = l + "px", r.style.top = h + "px")
                    } else r.style.display = "none"
                }
            }
        }, n.prototype.onDivRemoved = function() {
            this.renderer.conf.removeListener("change:textOverlays", this._readConfHandler), this.renderer.removeListener("enter2d", this._setDirtyHandler), this.renderer.removeListener("enter3d", this._setDirtyHandler), this.renderer.removeListener("cameraStabilized", this._setDirtyHandler), this.renderer.removeListener("cameraChanged", this._setPositionHandler), this.renderer.map.removeListener("elevation_changed", this._elevationChangedHandler), this._sortProcessor.release(), delete this.renderer
        }, n.prototype.setPositionsDirty = function() {
            this.renderedPositionsDirty = !0, this.allPositionsDirty = !0
        }
    }, {
        "../../utils/WorkProcessor": 416,
        engine: 10,
        jquery: 111,
        underscore: 207
    }],
    362: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.id = e.id, null == this.id && (this.id = r.uniqueId("text_")), this.rendered = !1, this.pos2d = new a(0, 0), this._clickableZone = {}, this.setName(e.name), this.visible = !1, this.position = e.fixedPosition ? e.fixedPosition.clone() : new s, null == e.zIndex && (e.zIndex = 0), this.setZIndex(e.zIndex), this.pin = e.pin, this.marker = e.marker, this.canvas = null, null != this.marker && (this.refreshPinSize(), this.setVisible(!0), this.setStrokeColor(e.color), this.setFillColor(e.fillColor), this.setRenderer(e.renderer))
        }
        var r = e("underscore"),
            o = e("engine"),
            a = o.Vector2,
            s = o.Vector3,
            l = e("onecolor"),
            h = e("../../utils/ColorHelper"),
            u = "...",
            d = 80,
            c = l("black").cssa(),
            f = l("white").cssa(),
            p = {};
        t.exports = n;
        var m = n.prototype;
        m.setRenderer = function(e) {
            this.renderer != e && (this.renderer && this.renderer.textManager && this.renderer.textManager.removeTextOverlay(this), this.renderer = e, this.computeLines(), this.renderer && this.renderer.textManager && this.renderer.textManager.addTextOverlay(this), this.refreshPosition())
        }, m.setZIndex = function(e) {
            this.zIndex != e && (this.renderer && this.renderer.textManager.removeTextOverlay(this), this.zIndex = e, this.renderer && this.renderer.textManager.addTextOverlay(this))
        }, m.setVisible = function(e) {
            this.visible != e && (this.visible = e)
        }, m.refreshPosition = function() {
            if (this.renderer) {
                if (this.pin) {
                    var e = this.renderer.isIn3d(),
                        t = e ? this.pin.getHeightWithModel() : 0;
                    this.position.set(this.pin.getPosition().lon, this.pin.getPosition().lat, t), this.pos2d.copy(this.renderer.computeScreenPosInPixels(this.position));
                    var i = this.pin.getAnchor();
                    this.pos2d.x += .5 * this.pinSize.width - i.x, this.pos2d.y -= .5 * this.pinSize.height - (this.pinSize.height - i.y)
                } else this.pos2d.copy(this.renderer.computeScreenPosInPixels(this.position));
                this.computeBounds()
            }
        }, m.unload = function() {
            this.renderer && this.renderer.textManager && this.renderer.textManager.removeTextOverlay(this), this.setVisible(!1)
        }, m.setName = function(e) {
            if (this.litteralName != e || !this.visible) {
                this.litteralName = e, this.releaseCanvas();
                var t = r.str.stripTags(e),
                    i = r.str.prune(t, d - u.length, "");
                t != i && (t = i ? i + u : r.str.truncate(t, d)), this.name = t, this.computeLines(), this.setDirty()
            }
        }, m.setDirty = function() {
            this.renderer && this.renderer.textManager && this.renderer.textManager.setDirty()
        }, m.computeLines = function() {
            if (delete this._linesInfo, this.renderer && this.name) {
                var e = this.renderer.textManager.maxWidth,
                    t = this.renderer.textManager._context2d;
                t.save(), t.font = this.marker.getTextFont(), t.textBaseline = "top", t.lineJoin = "bevel", t.miterLimit = 1;
                var i = this.name,
                    n = [{
                        character: " ",
                        keepCharacterOnCut: !1
                    }, {
                        character: "-",
                        keepCharacterOnCut: !0
                    }],
                    o = "";
                r.forEach(n, function(e) {
                    o = o + e.character + "|"
                }), o = o.slice(0, -1);
                var a = new RegExp(o),
                    s = i.split(a),
                    l = [];
                r.forEach(s, function(e) {
                    i = i.replace(e, "");
                    var t = i.charAt(0);
                    t && (i = i.replace(t, ""), r.forEach(n, function(e) {
                        e.character == t && (t = e)
                    }));
                    var o = {
                        word: e,
                        nextSplitCharacter: t
                    };
                    l.push(o)
                });
                var h, u, d = l.shift(),
                    c = d.word,
                    f = d.nextSplitCharacter,
                    p = t.measureText(c).width,
                    m = 0,
                    g = [],
                    _ = function() {
                        if (p > e) {
                            var i = r.str.chop(c, Math.ceil(c.length * e / p));
                            c = i.pop(), p = t.measureText(c).width, r.each(i, function(e) {
                                var i = t.measureText(e).width;
                                g.push(e), i > m && (m = i)
                            })
                        }
                    };
                for (_(); l.length;) {
                    u = l.shift();
                    var v = c + f.character + u.word;
                    if (u.nextSplitCharacter && u.nextSplitCharacter.keepCharacterOnCut && (v += u.nextSplitCharacter.character), h = t.measureText(v).width, e > h) c += f.character + u.word, p = h;
                    else {
                        var y = "";
                        f && f.keepCharacterOnCut && (y = f.character), g.push(c + y), p > m && (m = p), c = u.word, p = t.measureText(c).width
                    }
                    _(), f = u.nextSplitCharacter
                }
                g.push(c), p > m && (m = p), this._linesInfo = {
                    lines: g,
                    maxLineWidth: m,
                    maxLineHeight: this.marker.getTextLineHeight() * g.length
                }, t.restore()
            }
            this.computeClickableZone()
        }, m.onPinLoaded = function() {
            this.computeClickableZone()
        }, m.isInScreen = function() {
            return this.visible ? !(this.right < 0 || this.left > this.renderer.width || this.top > this.renderer.height || this.bottom < 0) : !1
        }, m.isInFrustum = function(e) {
            if (!this.visible) return !1;
            var t = this.position,
                i = t.x >= e.xMin && t.x <= e.xMax,
                n = t.y >= e.yMin && t.y <= e.yMax;
            return i && n
        }, m.getPopupScreenPosition = function() {
            if (this.renderer) {
                var e = this.renderer.computeScreenPosInPixels(this.position);
                return this.pin && (e.y -= .5 * this.pinSize.height), e
            }
            return null
        }, m.computeBounds = function() {
            if (this.renderer) {
                this.left = this.x + this.pos2d.x, this.right = this.left + this.width, this.top = this.y + this.pos2d.y, this.bottom = this.top + this.height;
                var e = 0,
                    t = 0;
                this.renderer.textManager && (e = this.renderer.textManager.hSpacing / 2, t = this.renderer.textManager.vSpacing / 2), this.left -= e, this.right += e, this.top -= t, this.bottom += t
            }
        }, m.refreshPinSize = function() {
            this.pin ? this.pinSize = this.pin.get2DSize() : this.pinSize = {
                width: 0,
                height: 0
            }
        }, m.onTextureReceived = function() {
            this.setDirty(), this.computeClickableZone()
        }, m.computeClickableZone = function() {
            if (this.renderer && !this.renderer.isMoving()) {
                this.refreshPinSize();
                var e, t, i, n, r, o;
                this._linesInfo ? (e = this._linesInfo.maxLineWidth, t = this._linesInfo.maxLineHeight, i = this.renderer.textManager.paddingLeft, n = this.renderer.textManager.paddingRight, r = this.renderer.textManager.backgroundTip, o = this.renderer.textManager.paddingBottom) : (e = 0, t = 0, i = 0, n = 0, r = 0, o = 0);
                var a = 0;
                this.renderer.textManager && (a = this.renderer.textManager.paddingTop), this._clickableZone.width = r + i + e + n, this._clickableZone.height = t + a + o, this._clickableZone.x = .5 * -this._clickableZone.width, this._clickableZone.y = .5 * -this.pinSize.height - this._clickableZone.height, this._clickableZone.x = Math.floor(this._clickableZone.x), this._clickableZone.y = Math.floor(this._clickableZone.y), this._clickableZone.width = Math.ceil(this._clickableZone.width), this._clickableZone.height = Math.ceil(this._clickableZone.height), this.x = this._clickableZone.x, this.y = this._clickableZone.y, this.width = this._clickableZone.width, this.height = this._clickableZone.height, this.computeBounds()
            }
        }, m.createCanvas = function() {
            return this.canvas || (this.canvas = document && document.createElement("canvas"), this.canvas.style.position = "absolute", this.renderTextToCanvas(this.canvas), this.canvas.parentNode || (this.canvas.style.display = "none", this.renderer.textManager.container2d.append(this.canvas))), this.canvas
        }, m.releaseCanvas = function() {
            this.canvas && (this.canvas.width = 0, this.canvas.parentNode && this.canvas.parentNode.removeChild(this.canvas), this.canvas = null)
        }, m.renderTextToCanvas = function(e) {
            var t = this._linesInfo,
                i = this.marker.getTextLineHeight(),
                n = this.marker.getTextFont(),
                o = this.marker.getTextFillStyle(),
                a = e.getContext("2d"),
                s = t.maxLineWidth + 2,
                l = t.maxLineHeight + 2,
                h = window.devicePixelRatio || 1,
                u = a.webkitBackingStorePixelRatio || a.mozBackingStorePixelRatio || a.msBackingStorePixelRatio || a.oBackingStorePixelRatio || a.backingStorePixelRatio || 1,
                d = h / u;
            e.style.width = s + "px", e.style.height = l + "px", e.width = s * d, e.height = l * d, a.scale(d, d), a.font = n, a.textBaseline = "top", a.textAlign = "center", a.lineJoin = "bevel", a.miterLimit = 1, a.globalCompositeOperation = "source-over";
            var c = Math.floor(s / 2),
                f = 1;
            r.each(t.lines, function(e) {
                a.fillStyle = "white", a.globalAlpha = .11, a.fillText(e, -2 + c, 0 + f), a.fillText(e, -1 + c, 1 + f), a.fillText(e, 0 + c, 2 + f), a.fillText(e, 1 + c, 1 + f), a.fillText(e, 2 + c, 0 + f), a.fillText(e, 1 + c, -1 + f), a.fillText(e, 0 + c, -2 + f), a.fillText(e, -1 + c, -1 + f), a.globalAlpha = .5, a.fillText(e, -1 + c, -1 + f), a.fillText(e, -1 + c, 0 + f), a.fillText(e, -1 + c, 1 + f), a.fillText(e, 0 + c, -1 + f), a.fillText(e, 0 + c, 1 + f), a.fillText(e, 1 + c, -1 + f), a.fillText(e, 1 + c, 0 + f), a.fillText(e, 1 + c, 1 + f), a.fillStyle = o, a.globalAlpha = 1, a.fillText(e, c, f), f += i
            })
        }, m.isInPinOrTextClickableZone = function(e) {
            if (this._clickableZone) {
                var t, i, n, r;
                if (this.isPinVisible() && this.pin.isInPinClickableZone(e)) return !0;
                if (this.visible && this.rendered && this._linesInfo && this.renderer.conf.pins.enableClickableText && (t = this.pos2d.x + this._clickableZone.x, i = t + this._clickableZone.width, n = this.pos2d.y + this._clickableZone.y, r = n + this._clickableZone.height, e.x >= t && e.x <= i && e.y >= n && e.y <= r)) return !0
            }
            return !1
        }, m.isCrossing = function(e) {
            return this.renderer ? this.left > e.right ? !1 : this.right < e.left ? !1 : this.top > e.bottom ? !1 : this.bottom < e.top ? !1 : !0 : !1
        }, m.setStrokeColor = function(e) {
            this.color != e && (this.color = e, this.updateColors())
        }, m.setFillColor = function(e) {
            this.fillColor != e && (this.fillColor = e, this.updateColors())
        }, m.updateColors = function() {
            this.name && (this.color || this.fillColor ? (this.color ? (this.fgColor = p[this.color], null == this.fgColor && (this.fgColor = p[this.color] = l(this.color).cssa())) : h.isWhiteBetterThenBlackOn(this.bgColor) ? this.fgColor = f : this.bgColor = c, this.fillColor ? (this.bgColor = p[this.fillColor], null == this.bgColor && (this.bgColor = p[this.fillColor] = l(this.fillColor).cssa())) : h.isWhiteBetterThenBlackOn(this.fgColor) ? this.bgColor = f : this.bgColor = c) : (this.bgColor = c, this.bgColor = f))
        }, m.isPinVisible = function() {
            return this.pin ? this.pin && this.pin.getVisible() : !0
        }
    }, {
        "../../utils/ColorHelper": 400,
        engine: 10,
        onecolor: 150,
        underscore: 207
    }],
    363: [function(e, t, i) {
        "use strict";
        t.exports = {
            NEEDS_REQUEST: "needs_request",
            REQUESTED: "requested",
            LOADING: "loading",
            LOADED: "loaded",
            FAILING: "failing",
            FAILED: "failed",
            ABORTED: "aborted"
        }
    }, {}],
    364: [function(e, t, i) {
        "use strict";

        function n(e, t, i, n, o) {
            this.tileKey = e.tileKey, this.zoom = e.zoom, this._tileCoords = e.tileCoords, this._bounds = e.bounds, this._parent = t, this._tileMeshManager = n, this._mapRenderer = o, this._onTileTextureModelChangedHandler = r.bind(this._onTileTextureModelChanged, this), this._onTileElevationsModelChangedHandler = r.bind(this._onTileElevationsModelChanged, this), this.children = [], this._tileTextureModel = null, this._tileElevationsModel = null, this._tileNormalsModel = null, this._tileOverlayModel = null, this._currentShaderName = "", this._currentGeometryDetails = {}, this._tileElevationsActive = !1, this._tileNormalMapsActive = !1, this._isIn3d = this._mapRenderer.isIn3d(), this._shouldBeVisible = e.isVisible, this._hasParentThatShouldBeVisible = this._calculateHasParentThatShouldBeVisible(), this._hasChildThatShouldBeVisible = !1, this._tileMaterialIsDirty = !1, this._tileGeometryIsDirty = !1, this._tileMaterial = null, this._tileGeometry = null, this._mesh = null, this._tileDebugMaterial = null, this._tileDebugElevationsMaterial = null, this._tileDebugGeometry = null, this._debugMesh = null, this._setTileData(i), this._shouldBeVisible && this._ensureBlendingFromParent(!0)
        }
        var r = e("underscore"),
            o = e("./texture/TileTextureModel"),
            a = e("./elevations/TileElevationsModel"),
            s = e("engine"),
            l = s.Constants;
        t.exports = n, n.prototype.isVisible = function() {
            return this._mesh && this._mesh.visible
        }, n.prototype.updateTree = function(e) {
            if (this._shouldBeVisible = e.isVisible, this._hasParentThatShouldBeVisible = this._calculateHasParentThatShouldBeVisible(), this._hasChildThatShouldBeVisible = !1, e.children.length > 0) {
                0 == this.children.length && this._tileMeshManager.createChildTileMeshes(e, this);
                for (var t = 0; 4 > t; t++) this.children[t].updateTree(e.children[t]);
                this._hasChildThatShouldBeVisible = !0
            } else this.children.length > 0 && (this._markChildrenShouldBeVisible(!1), this._showNecessaryChildren(), this._ensureChildrenBlendingToParent(), this._setBestBlendToShowBaseTile());
            this.updateVisibility(0)
        }, n.prototype.updateVisibility = function(e) {
            this._shouldBeVisible && !this.isVisible() ? this._hasValidTileData() ? this._hasChildrenBlendingToParent() || (this.children.length > 0 ? (this._setBestBlendToShowBaseTile(), this._tileMeshManager.removeChildTileMeshes(this), this.show()) : (this._ensureBlendingFromParent(), this.show())) : this._hasValidTileDataInHierarchy() || (this._setBestBlendToShowBaseTile(), this._tileMeshManager.removeChildTileMeshes(this), this.show()) : this._hasParentThatShouldBeVisible && this.isVisible() ? (this._ensureBlendingToParent(), this._verifyParentTextureIsValid(this._parent)) : this._hasParentThatShouldBeVisible || this._shouldBeVisible ? this._shouldBeVisible && this.isVisible() && this._ensureBlendingFromParent(!1) : (this.isVisible() && this.hide(), this._hasChildThatShouldBeVisible || this._tileMeshManager.removeChildTileMeshes(this)), this._updateTextureBlending(e), this._updateTextureFilter();
            for (var t = 0; t < this.children.length; t++) this.children[t].updateVisibility(e)
        }, n.prototype.show = function() {
            this._mesh.visible || (this._tileGeometryIsDirty && this._updateGeometry(), this._tileMaterialIsDirty && this._updateMaterial(), this._mapRenderer.getScene().tilesParent.add(this._mesh), this._mesh.visible = !0, this._mesh.updateMatrix(), this._mapRenderer.conf.get("debug.showTilesShape") && (this._mapRenderer.getScene().tilesParent.add(this._debugMesh), this._debugMesh.visible = !0, this._debugMesh.updateMatrix()), this._mapRenderer.forceRender())
        }, n.prototype.hide = function() {
            this._tileTextureModel.resetBlending(), this._mesh.visible && (this._mapRenderer.getScene().tilesParent.remove(this._mesh), this._mesh.visible = !1, this._mapRenderer.conf.get("debug.showTilesShape") && (this._mapRenderer.getScene().tilesParent.remove(this._debugMesh), this._debugMesh.visible = !1), this._mapRenderer.forceRender())
        }, n.prototype.setIsIn3d = function(e) {
            this._isIn3d = e, this._updateTileElevationsActive(), this._tileMaterialIsDirty = !0, this.isVisible() && this._updateMaterial();
            for (var t = 0; t < this.children.length; t++) this.children[t].setIsIn3d(e)
        }, n.prototype.findHeight = function(e, t) {
            if (this._bounds.xMin > e || this._bounds.xMax < e || this._bounds.yMax < t || this._bounds.yMin > t) return null;
            if (this.isVisible() && this._tileElevationsActive) return this._tileElevationsModel.findHeight(e, t);
            if (this.children.length > 0)
                for (var i = 0; i < this.children.length; ++i) {
                    var n = this.children[i].findHeight(e, t);
                    if (n) return n
                } else if (this._tileElevationsActive) return this._tileElevationsModel.findHeight(e, t);
            return null
        }, n.prototype.reset = function() {
            this._tileTextureModel.removeListener(o.TEXTURE_MODEL_CHANGED_EVENT, this._onTileTextureModelChangedHandler), this._tileElevationsModel && this._tileElevationsModel.removeListener(a.ELEVATIONS_MODEL_CHANGED_EVENT, this._onTileElevationsModelChangedHandler), this._mesh && this._mapRenderer.getRenderEngine().freeMesh(this._mesh), this._tileGeometry && this._mapRenderer.conf.get("debug.showTilesShape") && delete this._mesh.tile, this._tileMaterial && this._mapRenderer.getRenderEngine().releaseMaterial(this._tileMaterial), this._tileDebugElevationsMaterial && this._mapRenderer.getRenderEngine().releaseMaterial(this._tileDebugElevationsMaterial)
        }, n.prototype.applyRecursively = function(e) {
            e(this);
            for (var t = 0; t < this.children.length; t++) this.children[t].applyRecursively(e)
        }, n.prototype.onRefreshMaterial = function() {
            this._tileMaterialIsDirty = !0, this.isVisible() && this._updateMaterial()
        }, n.prototype._ensureChildrenBlendingToParent = function() {
            for (var e = 0; e < this.children.length; e++) {
                var t = this.children[e];
                t.isVisible() && t._ensureBlendingToParent(), t._ensureChildrenBlendingToParent()
            }
        }, n.prototype._showNecessaryChildren = function() {
            for (var e = 0; e < this.children.length; e++) {
                var t = this.children[e];
                t.children.length > 0 ? t._showNecessaryChildren() : t.show()
            }
        }, n.prototype._calculateHasParentThatShouldBeVisible = function() {
            return this._parent ? this._parent._shouldBeVisible ? !0 : this._parent._calculateHasParentThatShouldBeVisible() : !1
        }, n.prototype._verifyParentTextureIsValid = function(e) {
            if (e)
                if (e._shouldBeVisible) {
                    var t = e._tileTextureModel;
                    t.baseTextureIsTile && this._tileTextureModel.parentTileKey != t.tileKey && this._tileTextureModel.updateParentTexture(t.baseTexture, !0, t.tileKey, this._mapRenderer)
                } else this._verifyParentTextureIsValid(e._parent)
        }, n.prototype._hasChildrenBlendingToParent = function() {
            if (this.children.length > 0)
                for (var e = 0; 4 > e; e++) {
                    var t = this.children[e],
                        i = !1;
                    if (i = t._isBlendingToParent() ? !0 : t._hasChildrenBlendingToParent()) return !0
                }
            return !1
        }, n.prototype._hasValidTileDataInHierarchy = function() {
            if (this._hasValidTileData()) return !0;
            if (this.children.length > 0)
                for (var e = 0; 4 > e; e++)
                    if (this.children[e]._hasValidTileDataInHierarchy()) return !0;
            return !1
        }, n.prototype._hasValidTileData = function() {
            var e = this._tileTextureModel.baseTextureIsTile;
            return this._tileElevationsModel && this._tileElevationsActive && this._isIn3d && (e = e && null != this._tileElevationsModel.elevationsTexture), e
        }, n.prototype._markChildrenShouldBeVisible = function(e) {
            for (var t = 0; t < this.children.length; t++) this.children[t]._shouldBeVisible = e, this.children[t]._hasParentThatShouldBeVisible = this.children[t]._calculateHasParentThatShouldBeVisible(), this.children[t]._markChildrenShouldBeVisible(e)
        }, n.prototype._ensureBlendingFromParent = function(e) {
            this._tileTextureModel.ensureBlendingFromParent(e), this._tileTextureModel.isBlending() && this._updateTileTextureMaterialBlendingUniforms()
        }, n.prototype._ensureBlendingToParent = function() {
            this._tileTextureModel.ensureBlendingToParent(), this._tileTextureModel.isBlending() && this._updateTileTextureMaterialBlendingUniforms()
        }, n.prototype._isBlendingToParent = function() {
            return this._tileTextureModel.isBlendingToParent()
        }, n.prototype._setBestBlendToShowBaseTile = function() {
            this._tileTextureModel.setBestBlendToShowBaseTile(), this._updateTileTextureMaterialBlendingUniforms()
        }, n.prototype._updateTextureBlending = function(e) {
            var t = this._mapRenderer.conf.get("tiles.blendingDuration");
            this._tileTextureModel.updateBlending(e, t) && this._updateTileTextureMaterialBlendingUniforms()
        }, n.prototype._setTileData = function(e) {
            this._tileTextureModel = e.tileTextureModel, this._tileTextureModel.addListener(o.TEXTURE_MODEL_CHANGED_EVENT, this._onTileTextureModelChangedHandler), this._tileElevationsModel = e.tileElevationsModel, this._tileElevationsModel && this._tileElevationsModel.addListener(a.ELEVATIONS_MODEL_CHANGED_EVENT, this._onTileElevationsModelChangedHandler),
                this._updateTileElevationsActive(), this._generateMaterial(), this._generateGeometry(), this._generateMesh()
        }, n.prototype._updateTileElevationsActive = function() {
            this._tileElevationsActive = this._isIn3d && null != this._tileElevationsModel && null != this._tileElevationsModel.elevationsTexture && !this._tileElevationsModel.isFlat, this._mesh && (this._tileElevationsActive && this._mapRenderer.getElevationShadowsEnabled() ? this._mesh.handleRenderPass.shadowDepth = !0 : delete this._mesh.handleRenderPass.shadowDepth), this._tileNormalMapsActive = this._isIn3d && this._mapRenderer.conf.get("elevations.useNormalMap") && null != this._tileElevationsModel && null != this._tileElevationsModel.normalMapTexture && !this._tileElevationsModel.isFlat
        }, n.prototype._generateGeometry = function() {
            var e = this._getGroundGeometryDetails();
            return e.debug != this._currentGeometryDetails.debug || e.elevations != this._currentGeometryDetails.elevations ? (this._currentGeometryDetails = e, e.debug ? e.elevations ? (this._tileGeometry = this._tileMeshManager.commonElevationsGeometry, this._tileDebugGeometry = this._tileMeshManager.commonElevationsDebugGeometry) : (this._tileGeometry = this._tileMeshManager.commonGeometry, this._tileDebugGeometry = this._tileMeshManager.commonDebugGeometry) : e.elevations ? this._tileGeometry = this._tileMeshManager.commonElevationsGeometry : this._tileGeometry = this._tileMeshManager.commonGeometry, !0) : !1
        }, n.prototype._generateMaterial = function() {
            var e = this._getGroundShaderName();
            if (e != this._currentShaderName) {
                var t = this._tileMaterial;
                this._tileMaterial = this._mapRenderer.getRenderEngine().createMaterial(e, l.NoBlending), this._currentShaderName = e, t && this._mapRenderer.getRenderEngine().releaseMaterial(t)
            }
            this._mapRenderer.conf.get("debug.showTilesShape") && (this._tileElevationsActive ? (this._tileDebugElevationsMaterial || (this._tileDebugElevationsMaterial = this._mapRenderer.getRenderEngine().createMaterial("nolight_heightMap"), this._tileDebugElevationsMaterial.transparent = l.SuperGradual), this._tileDebugMaterial = this._tileDebugElevationsMaterial) : this._tileDebugMaterial = this._tileMeshManager.commonDebugMaterial), this._updateMaterialUniforms()
        }, n.prototype._generateMesh = function() {
            var e = this._mapRenderer.getRenderEngine();
            this._mesh = e.createMesh(this._tileGeometry, this._tileMaterial), this._updateMesh(this._mesh), this._mapRenderer.conf.get("debug.showTilesShape") && (this._mesh.tile = this, this._debugMesh = e.createMesh(this._tileDebugGeometry, this._tileDebugMaterial), this._updateMesh(this._debugMesh))
        }, n.prototype._updateMaterial = function() {
            this._tileMaterialIsDirty && (this._tileMaterialIsDirty = !1, this._generateMaterial(), this._mesh.material = this._tileMaterial, this._debugMesh && (this._debugMesh.material = this._tileDebugMaterial), this._mapRenderer.forceRender())
        }, n.prototype._updateGeometry = function() {
            if (this._tileGeometryIsDirty) {
                this._tileGeometryIsDirty = !1;
                var e = this._generateGeometry();
                e && (this._mesh.geometry = this._tileGeometry, this._debugMesh && (this._debugMesh.geometry = this._tileDebugGeometry), this._mapRenderer.forceRender())
            }
        }, n.prototype._updateMesh = function(e) {
            var t = this._bounds;
            e.position.set(t.center.x, t.center.y, 0), e.scale.set(t.size, t.size, 1), e.handleRenderPass.reflector = !0, e.handleRenderPass.colorBeforeProcess = !0, e.handleRenderPass.preZ = !0, this._tileElevationsActive && this._mapRenderer.getElevationShadowsEnabled() && (e.handleRenderPass.shadowDepth = !0), e.updateMatrix(), e.visible = !1
        }, n.prototype._getGroundShaderName = function() {
            var e = this._mapRenderer.conf,
                t = e.get("renderer.colorFilterEnabled"),
                i = e.get("renderer.remapColorsEnabled"),
                n = this._mapRenderer.map.waterRipple,
                r = this._mapRenderer.getShadowExtensionName(),
                o = this._isIn3d ? e.get("renderer.ground3dShader") + r : e.get("renderer.ground2dShader");
            return this._tileElevationsActive && (o += this._tileElevationsModel.elevationsTexture.magFilter == l.NearestFilter ? "_heightMapInterpolating" : this._tileElevationsModel.elevationsIndexedData ? "_heightMapIndexed" : "_heightMap"), this._tileNormalMapsActive && (o += this._mapRenderer.conf.get("elevations.vertexNormalMap") ? "_vertexNormalMap" : "_fragmentNormalMap"), t && (o += e.get("renderer.colorFilterShaderSuffix")), i && (o += this._isIn3d ? "_remapColors3d" : "_remapColors2d"), this._isIn3d && n && (o += "_waterRipple"), o
        }, n.prototype._getGroundGeometryDetails = function() {
            var e = {};
            return e.debug = this._mapRenderer.conf.get("debug.showTilesShape"), e.elevations = this._tileElevationsActive, e
        }, n.prototype._onTileTextureModelChanged = function() {
            this._updateTileTextureMaterialUniforms(), this._tileMaterial.program.building || this._mapRenderer.getRenderEngine().updateMaterial(this._mesh)
        }, n.prototype._onTileElevationsModelChanged = function() {
            this._updateTileElevationsActive(), this._tileGeometryIsDirty = !0, this._tileMaterialIsDirty = !0, this.isVisible() && (this._updateGeometry(), this._updateMaterial(), this._tileMaterial.program.building || this._mapRenderer.getRenderEngine().updateObject(this._mesh))
        }, n.prototype._updateTextureFilter = function() {
            if (this.isVisible() && this._tileTextureModel.baseTextureIsTile)
                if (this._isIn3d) this._tileTextureModel.setTextureFilters(!0, !0);
                else {
                    var e = this._tileMeshManager.zoomForLinearFilter;
                    this.zoom == e ? this._tileTextureModel.setTextureFilters(!1, !1) : this._tileTextureModel.setTextureFilters(!0, !1)
                }
        }, n.prototype._updateMaterialUniforms = function() {
            this._updateTileTextureMaterialUniforms(), this._updateTileElevationsMaterialUniforms(), this._updateTileNormalMapMaterialUniforms()
        }, n.prototype._updateTileTextureMaterialUniforms = function() {
            this._tileMaterial.uniforms.tex0.texture = this._tileTextureModel.baseTexture, this._tileMaterial.uniforms.parentTexture.texture = this._tileTextureModel.parentTexture, this._tileMaterial.uniforms.uvOffset.value.set(this._tileTextureModel.parentUVOffset.u, this._tileTextureModel.parentUVOffset.v), this._tileMaterial.uniforms.uvScale.value.set(this._tileTextureModel.parentUVScale.u, this._tileTextureModel.parentUVScale.v), this._updateTileTextureMaterialBlendingUniforms(), this._forceRenderIfVisible()
        }, n.prototype._updateTileElevationsMaterialUniforms = function() {
            if (this._tileElevationsActive) {
                var e = this._tileElevationsModel.elevationsTexture,
                    t = e.array.width,
                    i = this._tileElevationsModel.elevationsIndexedData;
                this._tileMaterial.uniforms.heightMapTexture.texture = e, this._tileMaterial.uniforms.heightMapUvOffset.value.set(this._tileElevationsModel.uvOffset.u, this._tileElevationsModel.uvOffset.v), this._tileMaterial.uniforms.heightMapUvScale.value.set(this._tileElevationsModel.uvScale.u, this._tileElevationsModel.uvScale.v), this._tileMaterial.uniforms.heightMapMin && (this._tileMaterial.uniforms.heightMapMin.value = i.minElevation, this._tileMaterial.uniforms.heightMapRange.value = i.elevationRange), this._tileMaterial.uniforms.heightMapSize && this._tileMaterial.uniforms.heightMapSize.value.set(t, t), this._tileDebugMaterial && this._tileDebugMaterial.uniforms.heightMapTexture && (this._tileDebugMaterial.uniforms.heightMapTexture.texture = this._tileElevationsModel.elevationsTexture, this._tileDebugMaterial.uniforms.heightMapUvOffset.value.set(this._tileElevationsModel.uvOffset.u, this._tileElevationsModel.uvOffset.v), this._tileDebugMaterial.uniforms.heightMapUvScale.value.set(this._tileElevationsModel.uvScale.u, this._tileElevationsModel.uvScale.v), this._tileDebugMaterial.uniforms.heightMapSize && this._tileDebugMaterial.uniforms.heightMapSize.value.set(t, t), this._tileDebugMaterial.uniforms.heightMapMin && (this._tileDebugMaterial.uniforms.heightMapMin.value = i.minElevation, this._tileDebugMaterial.uniforms.heightMapRange.value = i.elevationRange))
            }
        }, n.prototype._updateTileNormalMapMaterialUniforms = function() {
            if (this._tileNormalMapsActive) {
                var e = this._tileElevationsModel.normalMapTexture;
                this._tileMaterial.uniforms.normalMapTexture.texture = e, this._tileMaterial.uniforms.normalMapUvOffset.value.set(this._tileElevationsModel.normalMapUvOffset.u, this._tileElevationsModel.normalMapUvOffset.v), this._tileMaterial.uniforms.normalMapUvScale.value.set(this._tileElevationsModel.normalMapUvScale.u, this._tileElevationsModel.normalMapUvScale.v)
            }
        }, n.prototype._updateTileTextureMaterialBlendingUniforms = function() {
            this._tileMaterial.uniforms.ratio.value != this._tileTextureModel.blendingRatio && (this._tileMaterial.uniforms.ratio.value = this._tileTextureModel.blendingRatio, this._forceRenderIfVisible())
        }, n.prototype._forceRenderIfVisible = function() {
            this.isVisible() && this._mapRenderer.forceRender()
        }, n.prototype.debugPrint = function(e) {
            if (this.zoom == e) console.log(this.tileKey + " " + (this.isVisible() ? "+" : "-") + " (" + this.children.length + ")");
            else if (e > this.zoom && this.children.length > 0)
                for (var t = 0; 4 > t; t++) this.children[t].debugPrint(e)
        }, n.prototype.onClicked = function() {
            console.log("tile clicked: ", this.tileKey)
        }
    }, {
        "./elevations/TileElevationsModel": 377,
        "./texture/TileTextureModel": 383,
        engine: 10,
        underscore: 207
    }],
    365: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapRenderer = e, this._tileMeshes = {}, this._isIn3d = !1, this._loaders = {}, this._generators = {}, this._elevationsEnabled = this._mapRenderer.map.elevation, this._elevationsAvailable = !1, this.commonGeometry = null, this.commonDebugGeometry = null, this.commonElevationsGeometry = null, this.commonElevationsDebugGeometry = null, this.commonDebugMaterial = null, this.randomDebugColor = [], this._target = null, this._tileTree = new s(this._mapRenderer, "TileMeshManagerTree"), this._tilesDirty = !0, this._setTilesDirtyHandler = r.bind(this.setTilesDirty, this), this._updateMeshVisibilityHandler = r.bind(this._updateMeshVisibility, this), this._onTileElevationsLoadedHandler = r.bind(this._onTileElevationsLoaded, this), this._onPrePrenderHandler = r.bind(this._onPreRender, this), this._enter2dHandler = r.bind(this.enter2d, this), this._enter3dHandler = r.bind(this.enter3d, this), this._elevationsEnabledChangedHandler = r.bind(this._elevationsEnabledChanged, this), this._lightingChangedHandler = r.bind(this._lightingChanged, this), this._initialiseCommonGeometry(this._mapRenderer), this._initLoaders(), this._initGenerators(), this._rootMesh = this._createTileMesh(this._tileTree.rootTile, null), this._mapRenderer.on("cameraChanged", this._setTilesDirtyHandler), this._mapRenderer.on("cameraStabilized", this._setTilesDirtyHandler), this._mapRenderer.on("compute", this._updateMeshVisibilityHandler), this._mapRenderer.on("preRender", this._onPrePrenderHandler), this._mapRenderer.on("enter2d", this._enter2dHandler), this._mapRenderer.on("enter3d", this._enter3dHandler), this._mapRenderer.on("lightingChanged", this._lightingChangedHandler), this._mapRenderer.map.on("elevation_changed", this._elevationsEnabledChangedHandler)
        }
        var r = e("underscore"),
            o = e("../../utils/TileHelper"),
            a = e("./TileMesh"),
            s = e("./TileTree"),
            l = e("./texture/TileTextureLoader"),
            h = e("./elevations/TileElevationsLoader"),
            u = e("./texture/TileTextureModelGenerator"),
            d = e("./elevations/TileElevationsModelGenerator"),
            c = e("../camera/CameraHelper"),
            f = e("engine/tools").TriangulationUtils,
            p = e("engine"),
            m = p.Constants,
            g = p.Color;
        t.exports = n, n.prototype.createQualityTable = function() {
            this._tileTree.createQualityTable()
        }, n.prototype.enter2d = function() {
            this._isIn3d && (o.setCurrentTileLayer(this._mapRenderer.conf.get("tiles.layer2d")), this._isIn3d = !1, this._target || (r.each(this._loaders, function(e) {
                e.enter2d()
            }, this), r.each(this._generators, function(e) {
                e.enter2d()
            }, this)), this._rootMesh.setIsIn3d(!1))
        }, n.prototype.enter3d = function() {
            this._isIn3d || (o.setCurrentTileLayer(this._mapRenderer.conf.get("tiles.layer3d")), this._isIn3d = !0, this._target || (r.each(this._loaders, function(e) {
                e.enter3d()
            }, this), r.each(this._generators, function(e) {
                e.enter3d()
            }, this)), this._rootMesh.setIsIn3d(!0))
        }, n.prototype.setTarget = function(e) {
            var t = e != this._target;
            if (this._target = e, t) {
                this._tileTree.setTarget(e);
                var i, n = this._mapRenderer.backupCamera(),
                    o = this._mapRenderer.conf.zoom;
                e ? (this._mapRenderer._cameraManager.setTargetAndPosition(e.camTarget, e.camPos), i = c.computeRoundZoomFromDistance(this._mapRenderer.conf, this._mapRenderer._cameraManager.getDistance()), this._mapRenderer.conf.zoom = i) : i = c.computeRoundZoomFromDistance(this._mapRenderer.conf, this._mapRenderer._cameraManager.getDistance()), this._tileTree.update(this._isIn3d);
                var a = this._mapRenderer.getMinZoomLayer2D();
                this._mapRenderer.conf["3d"] && i > a ? (r.each(this._loaders, function(e) {
                    e.enter3d(!0)
                }, this), e || r.each(this._generators, function(e) {
                    e.enter3d()
                }, this)) : (r.each(this._loaders, function(e) {
                    e.enter2d(!0)
                }, this), e || r.each(this._generators, function(e) {
                    e.enter2d()
                }, this)), r.each(this._loaders, function(t) {
                    t.update(this._tileTree, null != e)
                }, this), e && (this._mapRenderer.restoreCamera(n), this._mapRenderer.conf.zoom = o)
            }
        }, n.prototype.findHeight = function(e) {
            return this._elevationsEnabled && this._elevationsAvailable && this._isIn3d ? this._rootMesh.findHeight(e.x, e.y) : 0
        }, n.prototype.setUrlTemplate2d = function(e) {
            o.setUrlTemplate2d(e), this.reloadTiles()
        }, n.prototype.setUrlTemplate3d = function(e) {
            o.setUrlTemplate3d(e), this.reloadTiles()
        }, n.prototype.setTilesDirty = function() {
            this._tilesDirty = !0
        }, n.prototype.reloadTiles = function() {
            r.each(this._loaders, function(e) {
                e.reload()
            }, this), r.each(this._generators, function(e) {
                e.refreshModels()
            }, this)
        }, n.prototype.onRefreshMaterial = function() {
            this._rootMesh.applyRecursively(function(e) {
                e.onRefreshMaterial()
            })
        }, n.prototype.onDataLayerChanged = function() {}, n.prototype.onDivRemoved = function() {
            this.removeChildTileMeshes(this._rootMesh), this._removeTileMesh(this._rootMesh), delete this._rootMesh, this._deleteCommonGeometry(this._mapRenderer), delete this._tileTree, this._mapRenderer.removeListener("cameraChanged", this._setTilesDirtyHandler), this._mapRenderer.removeListener("cameraStabilized", this._setTilesDirtyHandler), this._mapRenderer.removeListener("compute", this._updateMeshVisibilityHandler), this._mapRenderer.removeListener("preRender", this._onPrePrenderHandler), this._mapRenderer.removeListener("enter2d", this._enter2dHandler), this._mapRenderer.removeListener("enter3d", this._enter3dHandler), this._mapRenderer.removeListener("lightingChanged", this._lightingChangedHandler), this._mapRenderer.map.removeListener("elevation_changed", this._elevationsEnabledChangedHandler), delete this._setTilesDirtyHandler, delete this._updateMeshVisibilityHandler, delete this._onPrePrenderHandler, delete this._enter2dHandler, delete this._enter3dHandler, delete this._elevationsEnabledChangedHandler, this._loaders.tileElevationsLoader && this._loaders.tileElevationsLoader.removeListener(h.TILE_ELEVATIONS_LOADED_EVENT, this._onTileElevationsLoadedHandler), r.each(this._loaders, function(e) {
                e.release()
            }, this), this._loaders = {}, r.each(this._generators, function(e) {
                e.release()
            }, this), this._generators = {}, delete this._mapRenderer
        }, n.prototype.createChildTileMeshes = function(e, t) {
            for (var i = 0; 4 > i; i++) {
                var n = this._createTileMesh(e.children[i], t);
                t.children[i] = n
            }
        }, n.prototype.removeChildTileMeshes = function(e) {
            for (var t = 0; t < e.children.length; t++) {
                var i = e.children[t];
                i.children.length > 0 && this.removeChildTileMeshes(i), this._removeTileMesh(i)
            }
            e.children = []
        }, n.prototype.getLoaders = function() {
            return this._loaders
        }, n.prototype._initLoaders = function() {
            this._initTextureLoader(), this._initElevationsLoader()
        }, n.prototype._initTextureLoader = function() {
            var e = {
                    dataSource: l.RASTER_DATA_SOURCE
                },
                t = new l(this._mapRenderer, e);
            this._loaders.tileTextureLoader = t
        }, n.prototype._initElevationsLoader = function() {
            var e = this._mapRenderer.getRenderEngine()._webGL.glExtensionManager,
                t = this._mapRenderer.getRenderEngine()._webGL.glInfo,
                i = e.enableTextureFloat(!0) > 0,
                n = t.MAX_VERTEX_TEXTURE_IMAGE_UNITS > 0,
                r = t.MAX_COMBINED_TEXTURE_IMAGE_UNITS >= 8;
            if (n && r) {
                var o = this._mapRenderer.conf.get("elevations.dataSource"),
                    a = {
                        dataSource: o,
                        enabled: this._elevationsEnabled,
                        indexed: !i
                    },
                    s = new h(this._mapRenderer, a);
                this._loaders.tileElevationsLoader = s, s.on(h.TILE_ELEVATIONS_LOADED_EVENT, this._onTileElevationsLoadedHandler), this._elevationsAvailable = !0
            } else console.warn("Elevations are not supported : textureFloatAvailable = " + i + ", vertexTextureAvailable = " + n + ", numberOfTextureUnitsAdequate = " + r)
        }, n.prototype._initGenerators = function() {
            var e = new u(this._mapRenderer, this._loaders.tileTextureLoader);
            if (this._generators.tileTextureModelGenerator = e, this._elevationsAvailable) {
                var t = new d(this._mapRenderer, this._loaders.tileElevationsLoader);
                this._generators.tileElevationsModelGenerator = t
            }
        }, n.prototype._onPreRender = function() {
            this._tilesDirty && this._mapRenderer.conf.get("tiles.enableUpdate") && this._updateTiles()
        }, n.prototype._updateTiles = function() {
            this._mapRenderer.conf.get("tiles.enabled") && (this._tileTree.update(this._isIn3d), this._target || r.each(this._loaders, function(e) {
                e.update(this._tileTree, !1)
            }, this), this._computeZoomForLinearTextureFilter(), this._rootMesh.updateTree(this._tileTree.rootTile)), this._tilesDirty = !1
        }, n.prototype._updateMeshVisibility = function(e) {
            this._rootMesh.updateVisibility(e.dt)
        }, n.prototype._createTileMesh = function(e, t) {
            var i = this._generators.tileTextureModelGenerator.getTileTextureModel(e),
                n = null;
            this._elevationsAvailable && (n = this._generators.tileElevationsModelGenerator.getTileElevationsModel(e));
            var r = {
                    tileTextureModel: i,
                    tileElevationsModel: n
                },
                o = new a(e, t, r, this, this._mapRenderer);
            return o
        }, n.prototype._removeTileMesh = function(e) {
            this._generators.tileTextureModelGenerator.releaseTileTextureModel(e.tileKey), this._elevationsAvailable && this._generators.tileElevationsModelGenerator.releaseTileElevationsModel(e.tileKey), e.hide(), e.reset()
        }, n.prototype._computeZoomForLinearTextureFilter = function() {
            var e = this._mapRenderer.getPosCamera(),
                t = this._mapRenderer.computeDistanceToCenter(e),
                i = c.computeZoomFromDistance(this._mapRenderer.conf, t);
            this.zoomForLinearFilter = Math.round(10 * i) / 10
        }, n.prototype._initialiseCommonGeometry = function() {
            if (this.commonGeometry = f.createUnitPlane(new g(16777215)), this.commonDebugGeometry = f.createUnitPlaneLines(new g(0)), this._generateCommonElevationGeometries(), this._mapRenderer.conf.get("debug.showTilesShape")) {
                this.commonDebugMaterial = this._mapRenderer.getRenderEngine().createMaterial("nolight"), this.commonDebugMaterial.transparent = m.SuperGradual;
                var e = .7,
                    t = 1 - e;
                if (!this.randomDebugColor.length)
                    for (var i = 0; 200 > i; ++i) {
                        var n = new g;
                        n.setRGB(e + t * Math.random(), e + t * Math.random(), e + t * Math.random()), this.randomDebugColor.push(n)
                    }
            }
        }, n.prototype._generateCommonElevationGeometries = function() {
            var e = this._mapRenderer.conf.get("elevations.geometryDivisions");
            this.commonElevationsGeometry = f.createUnitPlane(new g(16777215), e, e), this.commonElevationsDebugGeometry = f.createUnitPlaneLines(new g(0), e, e);
            for (var t, i, n, r, o, a = this.commonElevationsGeometry._positionArray, s = this.commonElevationsGeometry._normalArray, l = this.commonElevationsGeometry._uvArray, h = this.commonElevationsGeometry._indexArray, u = 0; 4 > u; u++)
                for (0 == u ? (n = -.5, o = 1) : 1 == u ? (n = .5, o = 0) : 2 == u ? (i = -.5, r = 0) : 3 == u && (i = .5, r = 1), t = 0; e >= t; t++) 0 == u || 1 == u ? (i = -.5 + t / e, r = t / e) : (2 == u || 3 == u) && (n = -.5 + t / e, o = 1 - t / e), a.push(i, n, -1), s.push(0, 0, 1), l.push(r, o);
            var d, c, p, m, _ = (e + 1) * (e + 1),
                v = 0;
            for (t = 0; e > t; t++) d = _ + t, c = d + 1, p = v + t, m = p + 1, h.push(d, c, p, p, c, m);
            for (_ += e + 1, v = (e + 1) * e, t = 0; e > t; t++) d = v + t, c = d + 1, p = _ + t, m = p + 1, h.push(d, c, p, p, c, m);
            for (_ += e + 1, v = 0, t = 0; e > t; t++) d = v + t * (e + 1), c = d + (e + 1), p = _ + t, m = p + 1, h.push(d, c, p, p, c, m);
            for (_ += e + 1, v = e, t = 0; e > t; t++) d = _ + t, c = d + 1, p = v + t * (e + 1), m = p + (e + 1), h.push(d, c, p, p, c, m)
        }, n.prototype._deleteCommonGeometry = function() {
            this._mapRenderer.getRenderEngine().releaseGeometry(this.commonGeometry), this.commonGeometry = null, this._mapRenderer.getRenderEngine().releaseGeometry(this.commonElevationsGeometry), this.commonElevationsGeometry = null, this._mapRenderer.getRenderEngine().releaseGeometry(this.commonDebugGeometry), this.commonDebugGeometry = null, this._mapRenderer.getRenderEngine().releaseGeometry(this.commonElevationsDebugGeometry), this.commonElevationsDebugGeometry = null, this.commonDebugMaterial && (this._mapRenderer.getRenderEngine().releaseMaterial(this.commonDebugMaterial), this.commonDebugMaterial = null)
        }, n.prototype._onTileElevationsLoaded = function(e) {
            if (this._isIn3d) {
                var t = e.tileKey,
                    i = e.bounds;
                this._mapRenderer.onTileElevationsUpdated(t, i)
            }
        }, n.prototype._elevationsEnabledChanged = function() {
            this._mapRenderer.map.elevation != this._elevationsEnabled && (this._elevationsEnabled = this._mapRenderer.map.elevation, this._elevationsAvailable && this._loaders.tileElevationsLoader.setEnabled(this._elevationsEnabled))
        }, n.prototype._lightingChanged = function() {
            this._mapRenderer.getElevationShadowsEnabled() && this.setTilesDirty()
        }
    }, {
        "../../utils/TileHelper": 411,
        "../camera/CameraHelper": 330,
        "./TileMesh": 364,
        "./TileTree": 366,
        "./elevations/TileElevationsLoader": 376,
        "./elevations/TileElevationsModelGenerator": 378,
        "./texture/TileTextureLoader": 382,
        "./texture/TileTextureModelGenerator": 384,
        engine: 10,
        "engine/tools": 97,
        underscore: 207
    }],
    366: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapRenderer = e, this.frustum = {}, this.rootTile = new o(this, a.getWorldBounds(), null), this.allTiles = {}, this.visibleTiles = {}, this.enableMovingSubdivide = e.conf.get("tiles.enableMovingSubdivide"), this.qualityMoving = e.conf.get("tiles.qualityMoving"), this.createQualityTable()
        }
        var r = e("underscore"),
            o = e("./TileTreeNode"),
            a = e("../../utils/TileHelper"),
            s = e("engine"),
            l = s.ShapeUtils;
        t.exports = n, n.prototype.update = function(e) {
            this.startDate = Date.now(), this.isIn3d = e;
            var t = this._mapRenderer.isMoving();
            !this.wasMoving && t && (this.wasMoving = !0, this.startDateMoving = this.startDate), t ? this.durationMoving = this.startDate - this.startDateMoving : (this.wasMoving = !1, this.durationMoving = 0), this._tileMaxZoom = this._mapRenderer.conf.get("tiles.maxZoom"), this._tileMinZoom = this._mapRenderer.conf.get("tiles.minZoom"), this._enableMovingSubdivide = this._mapRenderer.conf.get("tiles.enableMovingSubdivide"), this._movingSubdivideDelay = this._mapRenderer.conf.get("tiles.movingSubdivideDelay"), this._computeFrustum(), this.rootTile.updateForFrustum(this.frustum), this.flatten()
        }, n.prototype.flatten = function() {
            this.allTiles = {}, this.visibleTiles = {}, this.rootTile.flatten(this.allTiles, this.visibleTiles)
        }, n.prototype.getVisibleTilesAtZoom = function(e, t) {
            var i = {};
            return r.each(this.visibleTiles, function(n) {
                for (; n.zoom > t && n.parent;) n = n.parent;
                n.zoom >= e && (i[n.tileKey] || (i[n.tileKey] = n))
            }), i
        }, n.prototype.debugPrint = function() {
            for (var e = this._mapRenderer.conf.get("tiles.maxZoom"), t = 0; e > t; t++) this.rootTile.debugPrint(t)
        }, n.prototype.setTarget = function(e) {
            this._target = e
        }, n.prototype.shouldSubdivideTile = function(e) {
            var t = e.center,
                i = e.bounds.size,
                n = e.zoom;
            if (n >= this._tileMaxZoom) return !1;
            var r = this._tileMinZoom;
            if (null != r && r > n) return !0;
            var o = this._mapRenderer.getCurrentPositionHeight(),
                a = Math.max(Math.abs(t.x - this.cameraPosition.x), Math.abs(t.y - this.cameraPosition.y), this.cameraPosition.z - o);
            if (this._mapRenderer.isMoving() && (this._enableMovingSubdivide || this.durationMoving > this._movingSubdivideDelay) && (!this._mapRenderer.map.elevation || !this.isIn3d) && 0 == e.children.length && !this._target) return i * this.qualityMoving > a;
            if (!this.isIn3d) return i + this._qualityTable.middle[n] > a;
            var s = this.cameraToTargetDistance;
            return .5 * s > a ? i + this._qualityTable.near[n] > a : a > 1.2 * s ? i + this._qualityTable.far[n] > a : a > 1.7 * s ? i + this._qualityTable.veryFar[n] > a : i + this._qualityTable.middle[n] > s
        }, n.prototype._computeFrustum = function() {
            this.cameraPosition = this._mapRenderer.getPosCamera(), this.cameraToTargetDistance = this._mapRenderer.computeDistanceToCenter(this.cameraPosition);
            var e = this._mapRenderer.getVisibleGroundBoundingBox();
            if (this._mapRenderer.map.elevation && this._mapRenderer.isIn3d()) {
                var t, i, n = [];
                if (l.intersectPointsListWithSegment(e, this.cameraPosition, this._mapRenderer.getCenterXYZ(), n), 1 == n.length && (t = n[0], i = e.indexOf(t.edge[0]), e.splice(i + 1, 0, this.cameraPosition)), this._mapRenderer.getElevationShadowsEnabled())
                    for (var o = this._mapRenderer.getRenderEngine(), a = o._shaderLibrary.uniforms.light.vLightDir.value, s = this._mapRenderer.conf.get("shadows.csm.elevation.shadowProjectionNearExtend"), h = a.clone().setLength(s), u = e.length, d = 0; u > d; d++) {
                        var c = e[d].clone().addSelf(h);
                        n = [], l.intersectPointsListWithSegment(e, c, this._mapRenderer.getCenterXYZ(), n), 1 == n.length && (t = n[0], i = e.indexOf(t.edge[0]), e.splice(i + 1, 0, c))
                    }
            }
            this.frustum.xMin = r.min(r.pluck(e, "x")), this.frustum.xMax = r.max(r.pluck(e, "x")), this.frustum.yMin = r.min(r.pluck(e, "y")), this.frustum.yMax = r.max(r.pluck(e, "y")), this.frustum.frustumPoints = e
        }, n.prototype.createQualityTable = function() {
            function e(e) {
                for (var t = [], n = i; n >= 0; --n) t[n] = e, e *= 2;
                return t
            }
            var t = this._qualityTable = {},
                i = this._mapRenderer.conf.get("tiles.maxZoom");
            t.near = e(this._mapRenderer.conf.get("tiles.nearScreenQuality")), t.middle = e(this._mapRenderer.conf.get("tiles.midScreenQuality")), t.far = e(this._mapRenderer.conf.get("tiles.farScreenQuality")), t.veryFar = e(this._mapRenderer.conf.get("tiles.veryFarScreenQuality"))
        }
    }, {
        "../../utils/TileHelper": 411,
        "./TileTreeNode": 367,
        engine: 10,
        underscore: 207
    }],
    367: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this.bounds = t, this.tileTree = e, this.parent = i, this.zoom = t.zoom, this.bounds.size = this.bounds.xMax - this.bounds.xMin, this.radius = .707 * this.bounds.size;
            var n = .5 * (this.bounds.xMin + this.bounds.xMax),
                a = .5 * (this.bounds.yMin + this.bounds.yMax);
            this.bounds.center = this.center = {
                x: n,
                y: a,
                z: 0
            };
            var s = r.sphericalMercatorToTile(this.center.x, this.center.y, this.zoom);
            this.tileCoords = s, this.tileKey = r.generateKey(s);
            var l = 1 << o - this.zoom;
            this.bounds.intXMin = s.x * l, this.bounds.intXMax = (s.x + 1) * l, this.bounds.intYMin = s.y * l, this.bounds.intYMax = (s.y + 1) * l, this.children = [], this.ancestorUVs = this._calculateAncestorUVs(i), this.isVisible = !1
        }
        var r = e("../../utils/TileHelper"),
            o = 26,
            a = {
                topLeft: 0,
                topRight: 1,
                bottomLeft: 2,
                bottomRight: 3
            },
            s = [{
                u: 0,
                v: 0
            }, {
                u: 1,
                v: 1
            }],
            l = [];
        l[a.topLeft] = [{
            u: 0,
            v: 0
        }, {
            u: .5,
            v: .5
        }], l[a.topRight] = [{
            u: .5,
            v: 0
        }, {
            u: 1,
            v: .5
        }], l[a.bottomLeft] = [{
            u: 0,
            v: .5
        }, {
            u: .5,
            v: 1
        }], l[a.bottomRight] = [{
            u: .5,
            v: .5
        }, {
            u: 1,
            v: 1
        }], t.exports = n, t.exports.childUVs = l, n.prototype.updateForFrustum = function(e) {
            if (r.isOutsideFrustum(this, e)) this.isVisible && (this.isVisible = !1), this.children = [];
            else if (this._shouldBeSubdivided()) {
                this.isVisible = !1, 0 == this.children.length && this._subdivide();
                for (var t = 0; 4 > t; t++) this.children[t].updateForFrustum(e)
            } else this.isVisible = !0, this.children.length > 0 && (this.children = [])
        }, n.prototype.flatten = function(e, t) {
            if (e[this.tileKey] = this, this.isVisible && (t[this.tileKey] = this), this.children.length > 0)
                for (var i = 0; 4 > i; i++) this.children[i].flatten(e, t)
        }, n.prototype.debugPrint = function(e) {
            if (this.zoom == e) console.log(this.tileKey + " " + (this.isVisible ? "+" : "-"));
            else if (e > this.zoom && this.children.length > 0)
                for (var t = 0; 4 > t; t++) this.children[t].debugPrint(e)
        }, n.prototype._subdivide = function() {
            var e = this.bounds,
                t = this.center,
                i = this.zoom + 1,
                r = {
                    xMin: e.xMin,
                    yMax: e.yMax,
                    xMax: t.x,
                    yMin: t.y,
                    zoom: i,
                    indexInParent: a.topLeft
                },
                o = {
                    xMin: t.x,
                    yMax: e.yMax,
                    xMax: e.xMax,
                    yMin: t.y,
                    zoom: i,
                    indexInParent: a.topRight
                },
                s = {
                    xMin: e.xMin,
                    yMax: t.y,
                    xMax: t.x,
                    yMin: e.yMin,
                    zoom: i,
                    indexInParent: a.bottomLeft
                },
                l = {
                    xMin: t.x,
                    yMax: t.y,
                    xMax: e.xMax,
                    yMin: e.yMin,
                    zoom: i,
                    indexInParent: a.bottomRight
                };
            this.children[a.topLeft] = new n(this.tileTree, r, this), this.children[a.topRight] = new n(this.tileTree, o, this), this.children[a.bottomLeft] = new n(this.tileTree, s, this), this.children[a.bottomRight] = new n(this.tileTree, l, this)
        }, n.prototype._shouldBeSubdivided = function() {
            return 0 == this.bounds.zoom ? !0 : this.tileTree.shouldSubdivideTile(this)
        }, n.prototype._calculateAncestorUVs = function(e) {
            var t = [];
            if (e)
                for (var i = this.bounds.indexInParent, n = l[i], r = 0; r < e.ancestorUVs.length; r++) {
                    var o = e.ancestorUVs[r].uvData,
                        a = e.ancestorUVs[r].tileKey,
                        h = o[1].u - o[0].u,
                        u = [{
                            u: o[0].u + h * n[0].u,
                            v: o[0].v + h * n[0].v
                        }, {
                            u: o[0].u + h * n[1].u,
                            v: o[0].v + h * n[1].v
                        }];
                    t[r] = {
                        tileKey: a,
                        uvData: u
                    }
                }
            return t.push({
                tileKey: this.tileKey,
                uvData: s
            }), t
        }
    }, {
        "../../utils/TileHelper": 411
    }],
    368: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this.tileElevationsData = e, this.tileKey = e.tileKey, this.tileCoords = e.tileCoords, this.bounds = e.bounds, this.elevationsRequest = null, this.rawElevationsDataArray = null, this.nx = 0, this.ny = 0, this.boundarySize = t ? 1 : 0, this._requestNormalMap = i, this.isBinary = !0, this.isIndexed = !1, this.isLatitudeScaled = !0, this.normalMapData = null, this._onSuccessCallback = null, this._onErrorCallback = null
        }
        var r = e("underscore");
        t.exports = n, t.exports.providesNormalMap = function() {
            return !0
        }, n.prototype.doRequest = function(e, t, i) {
            this.nx = this.ny = e.conf.get("elevations.textureSize");
            var n = this.nx - 1 - 2 * this.boundarySize,
                o = r.bind(this._onElevationsLoadError, this),
                a = r.bind(this._processServerResponse, this);
            this._onSuccessCallback = t, this._onErrorCallback = i;
            var s = {
                subdiv: n,
                maxage: e.conf.get("elevations.queryMaxAgeInS"),
                algorithm: "Cubic",
                source: e.conf.get("elevations.source")
            };
            this.boundarySize > 0 && (s.boundary = !0), this._requestNormalMap && (s.normals = !0);
            var l = {
                params: s,
                serverName: "elevation",
                fullQueryString: "elevations/" + this.tileCoords.z + "/" + this.tileCoords.x + "/" + this.tileCoords.y,
                priority: e.conf.get("downloads.elevations.priority"),
                groupPostProcess: !0,
                processRawData: a,
                tileKey: this.tileKey,
                center: this.bounds.center,
                onError: o,
                binary: !0
            };
            this.elevationsRequest = e._featuresRequestManager.askToServer(l)
        }, n.prototype.abort = function() {
            this.elevationsRequest && (this.elevationsRequest.abort(), this.elevationsRequest = null)
        }, n.prototype._processServerResponse = function(e) {
            var t = this.nx * this.ny * Float32Array.BYTES_PER_ELEMENT,
                i = (this.nx - 2 * this.boundarySize) * (this.nx - 2 * this.boundarySize) * 4,
                n = t;
            this._requestNormalMap && (n += i);
            var r = e.byteLength == n;
            if (r) {
                var o = new Float32Array(e, 0, t / Float32Array.BYTES_PER_ELEMENT);
                this.rawElevationsDataArray = o, this._requestNormalMap && (o = new Uint8Array(e, t, i), this.normalMapData = {
                    normalsUint8Array: o,
                    nx: this.nx - 2 * this.boundarySize,
                    ny: this.ny - 2 * this.boundarySize
                }), null != this._onSuccessCallback && this._onSuccessCallback(this)
            } else console.error("Elevation data returned from the server does not have the requested size"), this.error = new Error("Elevation data returned from the server does not have the requested size"), this._onErrorCallback && this._onErrorCallback(this)
        }, n.prototype._onElevationsLoadError = function() {
            this._onErrorCallback && this._onErrorCallback(this)
        }
    }, {
        underscore: 207
    }],
    369: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, this._tileElevationsRequestCallback = t
        }
        var r = e("../TileDataState");
        t.exports = n, n.prototype.release = function() {}, n.prototype.requestTileElevations = function(e) {
            e.state = r.LOADED, e.isFlat = !0, e.rawData = {
                elevations: [0],
                nx: 1,
                ny: 1,
                boundarySizeX: 0,
                boundarySizeY: 0,
                indexedData: null
            }, this._tileElevationsRequestCallback(null, e, null)
        }, n.prototype.abortAll = function() {}, n.prototype.abort = function() {}, n.prototype.onCameraMoved = function() {}
    }, {
        "../TileDataState": 363
    }],
    370: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this.tileElevationsData = e, this.tileKey = e.tileKey, this.tileCoords = e.tileCoords, this.bounds = e.bounds, this.elevationsRequest = null, this.rawElevationsDataArray = null, this.nx = 0, this.ny = 0, this.boundarySize = t ? 1 : 0, this._requestNormalMap = i, this.isBinary = !0, this.isIndexed = !0, this.isLatitudeScaled = !0, this.normalMapData = null, this._onSuccessCallback = null, this._onErrorCallback = null
        }
        var r = e("underscore");
        t.exports = n, t.exports.providesNormalMap = function() {
            return !0
        }, n.prototype.doRequest = function(e, t, i) {
            this.nx = this.ny = e.conf.get("elevations.textureSize");
            var n = this.nx - 1 - 2 * this.boundarySize,
                o = r.bind(this._onElevationsLoadError, this),
                a = r.bind(this._processServerResponse, this);
            this._onSuccessCallback = t, this._onErrorCallback = i;
            var s = {
                subdiv: n,
                maxage: e.conf.get("elevations.queryMaxAgeInS"),
                format: "indexed",
                algorithm: "Cubic",
                source: e.conf.get("elevations.source")
            };
            this.boundarySize > 0 && (s.boundary = !0), this._requestNormalMap && (s.normals = !0);
            var l = {
                params: s,
                serverName: "elevation",
                fullQueryString: "elevations/" + this.tileCoords.z + "/" + this.tileCoords.x + "/" + this.tileCoords.y,
                priority: e.conf.get("downloads.elevations.priority"),
                groupPostProcess: !0,
                processRawData: a,
                tileKey: this.tileKey,
                center: this.bounds.center,
                onError: o,
                binary: !0
            };
            this.elevationsRequest = e._featuresRequestManager.askToServer(l)
        }, n.prototype.abort = function() {
            this.elevationsRequest && (this.elevationsRequest.abort(), this.elevationsRequest = null)
        }, n.prototype._processServerResponse = function(e) {
            var t = new Float32Array(e, 0, 3),
                i = t[0],
                n = i * Uint16Array.BYTES_PER_ELEMENT,
                r = t[1],
                o = t[2],
                a = i == this.nx * this.ny,
                s = 3 * Float32Array.BYTES_PER_ELEMENT,
                l = (this.nx - 2 * this.boundarySize) * (this.nx - 2 * this.boundarySize) * 4,
                h = n + s;
            if (this._requestNormalMap && (h += l), a = a && e.byteLength == h) {
                var u = new Uint16Array(e, 3 * Float32Array.BYTES_PER_ELEMENT, i);
                this.bufferOffset = s, this.rawElevationsDataArray = u, this.minElevation = r,
                    this.elevationRange = o, this._requestNormalMap && (u = new Uint8Array(e, n + s, l), this.normalMapData = {
                        normalsUint8Array: u,
                        nx: this.nx - 2 * this.boundarySize,
                        ny: this.ny - 2 * this.boundarySize
                    }), null != this._onSuccessCallback && this._onSuccessCallback(this)
            } else console.error("Elevation data returned from the server does not have the requested size"), this.error = new Error("Elevation data returned from the server does not have the requested size"), this._onErrorCallback && this._onErrorCallback(this)
        }, n.prototype._onElevationsLoadError = function() {
            this._onErrorCallback && this._onErrorCallback(this)
        }
    }, {
        underscore: 207
    }],
    371: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.tileElevationsData = e, this.tileKey = e.tileKey, this.tileCoords = e.tileCoords, this.bounds = e.bounds, t = 1, this.elevationsRequest = null, this.rawElevationsDataArray = null, this.nx = 0, this.ny = 0, this.boundarySize = t ? 1 : 0, this.isBinary = !1, this.isIndexed = !1, this.isLatitudeScaled = !1, this.normalMapData = null, this._onSuccessCallback = null, this._onErrorCallback = null
        }
        var r = e("underscore");
        t.exports = n, t.exports.providesNormalMap = function() {
            return !1
        }, n.prototype.doRequest = function(e, t, i) {
            var n = e.conf.get("elevations.textureSize") - 1 - 2 * this.boundarySize,
                o = r.bind(this._onElevationsLoadError, this),
                a = r.bind(this._processServerResponse, this);
            this._onSuccessCallback = t, this._onErrorCallback = i;
            var s = {
                tileKey: this.tileKey,
                subdiv: n,
                maxage: e.conf.get("elevations.queryMaxAgeInS")
            };
            0 == this.boundarySize && (s.boundary = !1);
            var l = {
                params: s,
                serverName: "elevation",
                fullQueryString: "elevations",
                priority: e.conf.get("downloads.elevations.priority"),
                groupPostProcess: !0,
                processRawData: a,
                tileKey: this.tileKey,
                center: this.bounds.center,
                onError: o
            };
            this.elevationsRequest = e._featuresRequestManager.askToServer(l)
        }, n.prototype.abort = function() {
            this.elevationsRequest && (this.elevationsRequest.abort(), this.elevationsRequest = null)
        }, n.prototype._processServerResponse = function(e) {
            for (var t = JSON.parse(e), i = [], n = t.length, r = 0, o = !0, a = 0; n > a; a++) {
                var s = t[a];
                if (0 == a) r = s.length;
                else if (s.length != r) {
                    o = !1;
                    break
                }
                i.push.apply(i, s)
            }
            o ? (this.nx = r, this.ny = n, this.rawElevationsDataArray = i, null != this._onSuccessCallback && this._onSuccessCallback(this)) : (console.error("Irregular elevation data returned from the server"), this.error = new Error("Irregular elevation data returned from the server"), this._onErrorCallback && this._onErrorCallback(this))
        }, n.prototype._onElevationsLoadError = function() {
            this._onErrorCallback && this._onErrorCallback(this)
        }
    }, {
        underscore: 207
    }],
    372: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, t ? this._create = this._createFrom4Points : this._create = this._createFrom8Points
        }

        function r(e) {
            return Math.round(127.5 * e + 127.5)
        }
        var o = e("engine"),
            a = o.Constants;
        t.exports = n, n.prototype.release = function() {
            delete this._mapRenderer
        }, n.prototype.create = function(e, t, i, n) {
            return this._create(e, t, i, n)
        }, n.prototype.createFromIndexedData = function(e, t, i, n, r) {
            return n = 65535 * n / r, this._create(e, t, i, n)
        }, n.prototype._createFrom8Points = function(e, t, i, n) {
            for (var o = new Uint8Array(4 * (t - 2) * (i - 2)), a = 0, s = 1; i - 1 > s; s++)
                for (var l = 1; t - 1 > l; l++) {
                    var h = s * t + l,
                        u = e[h + 1],
                        d = e[h + 1 - t],
                        c = e[h - t],
                        f = e[h - t - 1],
                        p = e[h - 1],
                        m = e[h - 1 + t],
                        g = e[h + t],
                        _ = e[h + t + 1],
                        v = 2 * (p - u) + (f - _) + (m - d),
                        y = 2 * (g - c) + (m - d) + (_ - f),
                        b = 8 * n,
                        x = v * v + y * y + b * b;
                    x > 0 && (x = Math.sqrt(x), v /= x, y /= x, b /= x), o[a++] = r(v), o[a++] = r(y), o[a++] = r(b), o[a++] = 255
                }
            return {
                normalsUint8Array: o,
                nx: t - 2,
                ny: i - 2
            }
        }, n.prototype._createFrom4Points = function(e, t, i, n) {
            for (var o = new Uint8Array(4 * (t - 2) * (i - 2)), a = 0, s = 1; i - 1 > s; s++)
                for (var l = 1; t - 1 > l; l++) {
                    var h = s * t + l,
                        u = e[h + 1],
                        d = e[h - t],
                        c = e[h - 1],
                        f = e[h + t],
                        p = c - u,
                        m = f - d,
                        g = 2 * n,
                        _ = p * p + m * m + g * g;
                    _ > 0 && (_ = Math.sqrt(_), p /= _, m /= _, g /= _), o[a++] = r(p), o[a++] = r(m), o[a++] = r(g), o[a++] = 255
                }
            return {
                normalsUint8Array: o,
                nx: t - 2,
                ny: i - 2
            }
        }, n.prototype.createTexture = function(e, t, i) {
            var n = this._mapRenderer.getRenderEngine(),
                r = n.createTexture();
            return r.addRefCount(), r.magFilter = a.LinearFilter, r.minFilter = a.LinearFilter, r.generateMipmaps = !1, r.array = {
                width: t,
                height: i,
                value: e
            }, r.needsUpdate = !0, r.format = a.RGBAFormat, r.type = a.UnsignedByteType, r.wrap = a.ClampToEdgeWrapping, r
        }
    }, {
        engine: 10
    }],
    373: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this._mapRenderer = e, this._tileElevationsRequestCallback = t, this._requestType = i.requestType ? i.requestType : "binary";
            var n = "nolight_texture";
            this._dummyMaterial = this._mapRenderer.getRenderEngine().createMaterial(n);
            var o = this._mapRenderer.getRenderEngine()._webGL;
            o.initMaterial(this._dummyMaterial), o.endBuildPrograms(), this._dummyGeometry = u.createUnitPlane(), this._dummyMesh = this._mapRenderer.getRenderEngine().createMesh(this._dummyGeometry, this._dummyMaterial), "binary" == this._requestType ? this._ElevationsRequest = s : "indexed" == this._requestType ? this._ElevationsRequest = l : "legacy" == this._requestType && (this._ElevationsRequest = a);
            var c = o.glExtensionManager;
            if (this._textureFloatLinear = 0 != (c.textureFloatState & d.TEXTURE_FLOAT_LINEAR), this._includeTileBoundaryPixel = !this._textureFloatLinear, this._useNormalMap = this._mapRenderer.conf.get("elevations.useNormalMap"), this._requestNormalMap = !1, this._useNormalMap) {
                var f = this._mapRenderer.conf.get("elevations.normalMapRequest");
                f ? (this._requestNormalMap = this._ElevationsRequest.providesNormalMap(), this._includeTileBoundaryPixel = this._includeTileBoundaryPixel || !this._requestNormalMap) : this._includeTileBoundaryPixel = !0;
                var m = this._mapRenderer.conf.get("elevations.fastNormalMapCalc");
                this._normalMapCreator = new h(this._mapRenderer, m)
            }
            this._allElevationsRequests = {}, this._abortedRequestsQueue = [], this._pendingRequestsQueue = [], this._terminatedRequestsQueue = [], this._pendingRequestsQueueNeedsSorting = !0, this._terminatedRequestsQueueNeedsSorting = !0, this._abortedRequestHandler = r.bind(this._handleNextAbortedRequest, this), this._pendingRequestsWorker = r.bind(this._getPendingRequestWork, this), this._pendingRequestHandler = r.bind(this._handleNextPendingRequest, this), this._terminatedRequestsWorker = r.bind(this._getTerminatedRequestWork, this), this._terminatedRequestHandler = r.bind(this._handleNextTerminatedRequest, this), this._onElevationsRequestSuccessHandler = r.bind(this._onElevationsRequestSuccess, this), this._onElevationsRequestErrorHandler = r.bind(this._onElevationsRequestError, this);
            var g = this._elevationProcessor = new p(e, {
                intervalIdle: e.conf.get("workProcessor.elevationInterval"),
                maxDurationIdle: e.conf.get("workProcessor.elevationDuration"),
                workWhenCameraMove: !0,
                intervalMoving: e.conf.get("workProcessor.elevationIntervalMoving"),
                maxDurationMoving: e.conf.get("workProcessor.elevationDurationMoving"),
                name: "testElevationProcessor"
            });
            g.registerWorker(this._pendingRequestsWorker, "ServerTileElevationsSource:pendingRequestsWorker"), g.registerWorker(this._terminatedRequestsWorker, "ServerTileElevationsSource:terminatedRequestsWorker"), g.start()
        }
        var r = e("underscore"),
            o = e("../TileDataState"),
            a = e("./LegacyTileElevationsRequest"),
            s = e("./BinaryTileElevationsRequest"),
            l = e("./IndexedTileElevationsRequest"),
            h = e("./NormalMapCreator"),
            u = e("engine/tools").TriangulationUtils,
            d = e("engine/tools").WebGLExtensionManager,
            c = e("engine"),
            f = c.Constants,
            p = e("../../../utils/WorkProcessor"),
            m = e("../../../utils/LocationHelper");
        t.exports = n, n.prototype.release = function() {
            for (this.abortAll(); this._abortedRequestsQueue.length > 0;) {
                var e = this._abortedRequestsQueue.shift();
                e.abort(this._mapRenderer)
            }
            this._elevationProcessor.release(), delete this._elevationProcessor, delete this._abortedRequestHandler, delete this._pendingRequestsWorker, delete this._pendingRequestHandler, delete this._terminatedRequestsWorker, delete this._terminatedRequestHandler, delete this._onElevationsRequestSuccessHandler, delete this._onElevationsRequestErrorHandler, this._normalMapCreator && (this._normalMapCreator.release(), delete this._normalMapCreator), this._mapRenderer.getRenderEngine().releaseMaterial(this._dummyMaterial), this._mapRenderer.getRenderEngine().releaseGeometry(this._dummyGeometry), this._mapRenderer.getRenderEngine().freeMesh(this._dummyMesh), delete this._dummyMaterial, delete this._dummyGeometry, delete this._dummyMesh, delete this._mapRenderer
        }, n.prototype.requestTileElevations = function(e, t) {
            e.isFlat = !1;
            var i = e.tileKey;
            this._allElevationsRequests[i] && this.abort(e), e.state = o.NEEDS_REQUEST;
            var n = new this._ElevationsRequest(e, this._includeTileBoundaryPixel, this._requestNormalMap);
            this._allElevationsRequests[i] = n, t ? this._performElevationsRequest(n) : (this._pendingRequestsQueue.push(n), this._pendingRequestsQueueNeedsSorting = !0)
        }, n.prototype.abortAll = function() {
            var e = r.keys(this._allElevationsRequests);
            r.each(e, function(e) {
                var t = this._allElevationsRequests[e];
                this.abort(t.tileElevationsData)
            }, this)
        }, n.prototype.abort = function(e) {
            if (this._allElevationsRequests[e.tileKey]) {
                var t = this._allElevationsRequests[e.tileKey];
                if (e.state == o.REQUESTED) t.state = o.ABORTED, this._abortedRequestsQueue.push(t);
                else if (e.state == o.NEEDS_REQUEST) {
                    var i = this._pendingRequestsQueue.indexOf(t);
                    i > -1 && this._pendingRequestsQueue.splice(i, 1)
                } else {
                    var n = this._terminatedRequestsQueue.indexOf(t);
                    n > -1 && this._terminatedRequestsQueue.splice(n, 1)
                }
                e.state = o.ABORTED, delete this._allElevationsRequests[e.tileKey]
            }
        }, n.prototype.onCameraMoved = function() {
            this._pendingRequestsQueueNeedsSorting = !0, this._terminatedRequestsQueueNeedsSorting = !0
        }, n.prototype._getPendingRequestWork = function() {
            return this._abortedRequestsQueue.length > 0 ? this._abortedRequestHandler : 0 == this._pendingRequestsQueue.length ? null : (this._sortElevationsRequestsQueue(), this._pendingRequestHandler)
        }, n.prototype._handleNextAbortedRequest = function() {
            if (0 != this._abortedRequestsQueue.length) {
                var e = this._abortedRequestsQueue.shift();
                e.abort(this._mapRenderer)
            }
        }, n.prototype._sortElevationsRequestsQueue = function() {
            var e = this._mapRenderer.conf.get("tiles.maxZoom");
            this._pendingRequestsQueueNeedsSorting && (this._pendingRequestsQueue = r.sortBy(this._pendingRequestsQueue, function(t) {
                var i = t.tileElevationsData.tileNode,
                    n = i.isVisible ? 0 : 1e4 * (1 + e - i.zoom),
                    r = this._mapRenderer.computeDistanceToCenter(t.tileElevationsData.center);
                return r + n * r
            }, this), this._pendingRequestsQueueNeedsSorting = !1)
        }, n.prototype._sortElevationsResponsesQueue = function() {
            var e = this._mapRenderer.conf.get("tiles.maxZoom");
            this._terminatedRequestsQueueNeedsSorting && (this._terminatedRequestsQueue = r.sortBy(this._terminatedRequestsQueue, function(t) {
                var i = t.tileElevationsData.tileNode,
                    n = i.isVisible ? 0 : 1e4 * (1 + e - i.zoom),
                    r = this._mapRenderer.computeDistanceToCenter(t.tileElevationsData.center);
                return r + n * r
            }, this), this._terminatedRequestsQueueNeedsSorting = !1)
        }, n.prototype._handleNextPendingRequest = function() {
            if (0 != this._pendingRequestsQueue.length) {
                var e = this._pendingRequestsQueue.shift();
                this._performElevationsRequest(e)
            }
        }, n.prototype._performElevationsRequest = function(e) {
            var t = e.tileElevationsData;
            t.state = o.REQUESTED, e.doRequest(this._mapRenderer, this._onElevationsRequestSuccessHandler, this._onElevationsRequestErrorHandler)
        }, n.prototype._getTerminatedRequestWork = function() {
            return this._abortedRequestsQueue.length > 0 ? this._abortedRequestHandler : 0 == this._terminatedRequestsQueue.length ? null : (this._sortElevationsResponsesQueue(), this._terminatedRequestHandler)
        }, n.prototype._handleNextTerminatedRequest = function() {
            if (0 != this._terminatedRequestsQueue.length) {
                var e = this._terminatedRequestsQueue.shift(),
                    t = e.tileElevationsData;
                if (t.state == o.LOADING) {
                    this._convertRequestDataToRawElevationsData(e);
                    var i = this._createElevationsTexture(t),
                        n = this._createNormalMapTexture(t);
                    t.state = o.LOADED, this._tileElevationsRequestCallback(null, t, i, n), delete this._allElevationsRequests[t.tileKey]
                } else t.state == o.FAILING && (t.state = o.FAILED, this._tileElevationsRequestCallback(new Error("Failed to load elevations " + t.tileKey), t, null), delete this._allElevationsRequests[t.tileKey], console.error("Failed to load elevations for tile " + t.tileKey))
            }
        }, n.prototype._onElevationsRequestSuccess = function(e) {
            if (e.state != o.ABORTED) {
                var t = e.tileElevationsData;
                t.state = o.LOADING, this._terminatedRequestsQueue.push(e)
            }
        }, n.prototype._onElevationsRequestError = function(e) {
            if (e.state != o.ABORTED) {
                var t = e.tileElevationsData;
                t.state = o.FAILING, this._terminatedRequestsQueue.push(e)
            }
        }, n.prototype._convertRequestDataToRawElevationsData = function(e) {
            var t, i = e.tileElevationsData,
                n = e.rawElevationsDataArray,
                r = e.nx,
                o = e.ny,
                a = e.boundarySize,
                s = e.isBinary,
                l = e.isIndexed,
                h = e.isLatitudeScaled,
                u = e.normalMapData;
            t = s ? n : new Float32Array(n);
            var d = i.bounds,
                c = d.yMax - d.yMin,
                f = c / (o - 1 - 2 * a);
            if (!h) {
                var p = d.yMax;
                a > 0 && (p += f);
                for (var g = 0; o > g; g++)
                    for (var _ = p - g * f, v = 0; r > v; v++) {
                        var y = t[v + r * g],
                            b = y * m.getScaleFromLatitude(_);
                        t[v + r * g] = b
                    }
            }
            if (i.rawData = {
                    elevations: t,
                    nx: r,
                    ny: o,
                    boundarySizeX: a,
                    boundarySizeY: a,
                    indexedData: null
                }, l && (i.rawData.indexedData = {
                    bufferOffset: e.bufferOffset,
                    minElevation: e.minElevation,
                    elevationRange: e.elevationRange
                }), !u && this._useNormalMap) {
                var x = f;
                u = l ? this._normalMapCreator.createFromIndexedData(t, r, o, x, e.elevationRange) : this._normalMapCreator.create(t, r, o, x)
            }
            u && (i.normalMapData = u)
        }, n.prototype._createElevationsTexture = function(e) {
            var t = this._mapRenderer.getRenderEngine().createTexture();
            t.addRefCount();
            var i = e.rawData,
                n = null != i.indexedData,
                r = this._mapRenderer.getRenderEngine()._webGL;
            if (this._textureFloatLinear || n ? (t.magFilter = f.LinearFilter, t.minFilter = f.LinearFilter) : (t.magFilter = f.NearestFilter, t.minFilter = f.NearestFilter), t.generateMipmaps = !1, n) {
                var o = i.indexedData.bufferOffset,
                    a = i.nx * i.ny,
                    s = new Uint8Array(i.elevations.buffer, o, 2 * a);
                t.array = {
                    width: i.nx,
                    height: i.ny,
                    value: s
                }, t.format = f.LuminanceAlphaFormat, t.type = f.UnsignedByteType, t.wrap = f.ClampToEdgeWrapping
            } else t.array = {
                width: i.nx,
                height: i.ny,
                value: i.elevations
            }, t.format = f.LuminanceFormat, t.type = f.FloatType, t.wrap = f.ClampToEdgeWrapping;
            t.needsUpdate = !0;
            var l = e.tileCoords;
            return t.loadedName = "/elevations/" + l.z + "/" + l.x + "/" + l.y, this._dummyMaterial.uniforms.tex0.texture = t, r.setProgram(this._dummyMaterial, this._dummyMesh), t
        }, n.prototype._createNormalMapTexture = function(e) {
            var t = e.normalMapData,
                i = null;
            if (this._normalMapCreator && t.normalsUint8Array) {
                var n = t.normalsUint8Array,
                    r = t.nx,
                    o = t.ny;
                i = this._normalMapCreator.createTexture(n, r, o);
                var a = e.tileCoords;
                i.loadedName = "/normalMap/" + a.z + "/" + a.x + "/" + a.y, this._dummyMaterial.uniforms.tex0.texture = i;
                var s = this._mapRenderer.getRenderEngine()._webGL;
                s.setProgram(this._dummyMaterial, this._dummyMesh)
            }
            return i
        }
    }, {
        "../../../utils/LocationHelper": 407,
        "../../../utils/WorkProcessor": 416,
        "../TileDataState": 363,
        "./BinaryTileElevationsRequest": 368,
        "./IndexedTileElevationsRequest": 370,
        "./LegacyTileElevationsRequest": 371,
        "./NormalMapCreator": 372,
        engine: 10,
        "engine/tools": 97,
        underscore: 207
    }],
    374: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, this._tileElevationsRequestCallback = t;
            var i = "nolight_texture";
            this._dummyMaterial = this._mapRenderer.getRenderEngine().createMaterial(i);
            var n = this._mapRenderer.getRenderEngine()._webGL;
            n.initMaterial(this._dummyMaterial), n.endBuildPrograms(), this._dummyGeometry = s.createUnitPlane(), this._dummyMesh = this._mapRenderer.getRenderEngine().createMesh(this._dummyGeometry, this._dummyMaterial);
            var o = n.glExtensionManager;
            if (this._textureFloatLinear = 0 != (o.textureFloatState & l.TEXTURE_FLOAT_LINEAR), this._includeTileBoundaryPixel = !this._textureFloatLinear, this._mapRenderer.conf.get("elevations.useNormalMap")) {
                this._includeTileBoundaryPixel = !0;
                var h = this._mapRenderer.conf.get("elevations.fastNormalMapCalc");
                this._normalMapCreator = new a(this._mapRenderer, h)
            }
            this._allPendingRequests = {}, this._pendingRequestsQueue = [], this._pendingRequestsQueueNeedsSorting = !0, this._pendingRequestsWorker = r.bind(this._getPendingRequestWork, this), this._pendingRequestHandler = r.bind(this._handleNextPendingRequest, this);
            var u = this._elevationProcessor = new d(e, {
                intervalIdle: e.conf.get("workProcessor.elevationInterval"),
                maxDurationIdle: e.conf.get("workProcessor.elevationDuration"),
                workWhenCameraMove: !0,
                intervalMoving: e.conf.get("workProcessor.elevationIntervalMoving"),
                maxDurationMoving: e.conf.get("workProcessor.elevationDurationMoving"),
                name: "testElevationProcessor"
            });
            u.registerWorker(this._pendingRequestsWorker, "TestTileElevationsSource:pendingRequestsWorker"), u.start(), this._lastUpdateDate = Date.now() + g
        }
        var r = e("underscore"),
            o = e("../TileDataState"),
            a = e("./NormalMapCreator"),
            s = e("engine/tools").TriangulationUtils,
            l = e("engine/tools").WebGLExtensionManager,
            h = e("engine"),
            u = h.Constants,
            d = e("../../../utils/WorkProcessor");
        t.exports = n;
        var c = 64,
            f = 1e3,
            p = 15,
            m = 6,
            g = 0,
            _ = 0;
        n.prototype.release = function() {
            this.abortAll(), this._elevationProcessor.release(), delete this._elevationProcessor, delete this._pendingRequestsWorker, delete this._pendingRequestHandler, this._normalMapCreator && (this._normalMapCreator.release(), delete this._normalMapCreator), this._mapRenderer.getRenderEngine().releaseMaterial(this._dummyMaterial), this._mapRenderer.getRenderEngine().releaseGeometry(this._dummyGeometry), this._mapRenderer.getRenderEngine().freeMesh(this._dummyMesh), delete this._dummyMaterial, delete this._dummyGeometry, delete this._dummyMesh, delete this._mapRenderer
        }, n.prototype.requestTileElevations = function(e, t) {
            e.isFlat = !1;
            var i = e.tileKey;
            if (this._allPendingRequests[i] && this.abort(e), e.state = o.NEEDS_REQUEST, t) this._performElevationsCreation(e);
            else {
                var n = {
                    tileElevationsData: e
                };
                this._allPendingRequests[i] = n, this._pendingRequestsQueue.push(n), this._pendingRequestsQueueNeedsSorting = !0
            }
        }, n.prototype.abortAll = function() {
            var e = r.keys(this._allPendingRequests);
            r.each(e, function(e) {
                var t = this._allPendingRequests[e];
                this.abort(t.tileElevationsData)
            }, this), this._allPendingRequests = {}, this._pendingRequestsQueue = [], this._pendingRequestsQueueNeedsSorting = !0
        }, n.prototype.abort = function(e) {
            var t = e.tileKey;
            this._allPendingRequests[t] && delete this._allPendingRequests[t], e.state = o.ABORTED;
            for (var i = 0; i < this._pendingRequestsQueue.length; i++)
                if (this._pendingRequestsQueue[i].tileElevationsData.tileKey == t) {
                    this._pendingRequestsQueue.splice(i, 1);
                    break
                }
        }, n.prototype.onCameraMoved = function() {
            this._pendingRequestsQueueNeedsSorting = !0
        }, n.prototype._getPendingRequestWork = function() {
            if (0 == this._pendingRequestsQueue.length) return null;
            var e = Date.now();
            if (!(e - this._lastUpdateDate < _)) return this._lastUpdateDate = e, this._sortElevationsRequestsQueue(), this._pendingRequestHandler
        }, n.prototype._sortElevationsRequestsQueue = function() {
            var e = this._mapRenderer.conf.get("tiles.maxZoom");
            this._pendingRequestsQueueNeedsSorting && (this._pendingRequestsQueue = r.sortBy(this._pendingRequestsQueue, function(t) {
                var i = t.tileElevationsData.tileNode,
                    n = i.isVisible ? 0 : 1e4 * (1 + e - i.zoom),
                    r = this._mapRenderer.computeDistanceToCenter(t.tileElevationsData.center);
                return r + n * r
            }, this), this._pendingRequestsQueueNeedsSorting = !1)
        }, n.prototype._handleNextPendingRequest = function() {
            if (0 != this._pendingRequestsQueue.length) {
                var e = this._pendingRequestsQueue.shift(),
                    t = e.tileElevationsData;
                delete this._allPendingRequests[t.tileKey], t.state = o.REQUESTED, this._performElevationsCreation(t)
            }
        }, n.prototype._performElevationsCreation = function(e) {
            e.state = o.LOADING;
            var t = this._createTestElevations(e.tileCoords);
            e.rawData = t;
            var i = this._createElevationsTexture(e);
            e.state = o.LOADED;
            var n = this._createNormalMapData(e),
                r = null;
            n && (e.normalMapData = n, r = this._createNormalMapTexture(e)), this._tileElevationsRequestCallback(null, e, i, r)
        }, n.prototype._createElevationsTexture = function(e) {
            var t = this._mapRenderer.getRenderEngine().createTexture();
            t.addRefCount();
            var i = this._mapRenderer.getRenderEngine()._webGL;
            this._textureFloatLinear ? (t.magFilter = u.LinearFilter, t.minFilter = u.LinearFilter) : (t.magFilter = u.NearestFilter, t.minFilter = u.NearestFilter), t.generateMipmaps = !1;
            var n = e.rawData;
            t.array = {
                width: n.nx,
                height: n.ny,
                value: n.elevations
            }, t.needsUpdate = !0, t.format = u.LuminanceFormat, t.type = u.FloatType, t.wrap = u.ClampToEdgeWrapping;
            var r = e.tileCoords;
            return t.loadedName = "/elevations/" + r.z + "/" + r.x + "/" + r.y, this._dummyMaterial.uniforms.tex0.texture = t, i.setProgram(this._dummyMaterial, this._dummyMesh), t
        }, n.prototype._createNormalMapData = function(e) {
            var t = null;
            if (this._normalMapCreator) {
                var i = e.rawData,
                    n = i.nx,
                    r = i.ny,
                    o = i.elevations,
                    a = e.bounds,
                    s = a.yMax - a.yMin,
                    l = s / (r - 3),
                    h = l;
                t = this._normalMapCreator.create(o, n, r, h)
            }
            return t
        }, n.prototype._createNormalMapTexture = function(e) {
            var t = e.normalMapData,
                i = t.normalsUint8Array,
                n = t.nx,
                r = t.ny,
                o = this._normalMapCreator.createTexture(i, n, r),
                a = e.tileCoords;
            o.loadedName = "/normalMap/" + a.z + "/" + a.x + "/" + a.y, this._dummyMaterial.uniforms.tex0.texture = o;
            var s = this._mapRenderer.getRenderEngine()._webGL;
            return s.setProgram(this._dummyMaterial, this._dummyMesh), o
        }, n.prototype._createTestElevations = function(e) {
            var t = Math.pow(2, e.z),
                i = e.x / t,
                n = (t - e.y - 1) / t,
                r = this._includeTileBoundaryPixel ? 1 : 0,
                o = 1 / t,
                a = o / (c - 1 - 2 * r),
                s = n + o + r * a;
            i -= r * a;
            for (var l = new Float32Array(c * c), h = 0; c > h; h++)
                for (var u = s - h * a, d = 0; c > d; d++) {
                    var f = i + d * a,
                        p = this._getElevation(f, u);
                    l[h * c + d] = p
                }
            return {
                elevations: l,
                nx: c,
                ny: c,
                boundarySizeX: r,
                boundarySizeY: r,
                indexedData: null
            }
        }, n.prototype._getElevation = function(e, t) {
            for (var i = 0, n = m; p > n; n++) {
                var r = Math.pow(2, n),
                    o = Math.pow(.9, n - m) * f;
                i += .5 * o * (1 + Math.sin(e * r * 2 * Math.PI) * Math.sin(t * r * 2 * Math.PI))
            }
            return i
        }
    }, {
        "../../../utils/WorkProcessor": 416,
        "../TileDataState": 363,
        "./NormalMapCreator": 372,
        engine: 10,
        "engine/tools": 97,
        underscore: 207
    }],
    375: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.tileNode = e, this.tileKey = e ? e.tileKey : null, this.tileCoords = e ? e.tileCoords : null, this.bounds = e ? e.bounds : null, this.center = e ? e.center : null, this.state = null, this.texture = null, this.rawData = {
                elevations: [0],
                nx: 1,
                ny: 1,
                boundarySizeX: 0,
                boundarySizeY: 0,
                indexedData: null
            }, this.normalMapTexture = null, this.normalMapData = {
                normalsUint8Array: null,
                nx: 0,
                ny: 0
            }, this.isFlat = !1
        }
        t.exports = n
    }, {}],
    376: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            u.call(this), t = null == t ? {} : t, this._mapRenderer = e, this._options = r.defaults(t, {
                dataSource: n.FLAT_DATA_SOURCE,
                enabled: !1
            }), this._isIn3d = this._mapRenderer.isIn3d(), this._isEnabled = t.enabled, this._tileElevationsLoadedHandler = r.bind(this._onTileElevationsLoaded, this);
            var i = this._mapRenderer.conf.get("elevations.granularityInM"),
                o = this._mapRenderer.conf.get("elevations.textureSize"),
                a = o * i;
            this._maxZoomForHeightMapTexture = Math.ceil(Math.log(2 * c / a) / Math.log(2)), this._dataSource = null, this._buildDataSource(), this._visibleTileSet = {}, this._allElevationsData = {}
        }
        var r = e("underscore"),
            o = e("./FlatTileElevationsSource"),
            a = e("./TestTileElevationsSource"),
            s = e("./ServerTileElevationsSource"),
            l = e("./TileElevationsData"),
            h = e("../TileDataState"),
            u = e("events").EventEmitter,
            d = e("util");
        t.exports = n, t.exports.FLAT_DATA_SOURCE = "flat", t.exports.TEST_DATA_SOURCE = "test", t.exports.LEGACY_DATA_SOURCE = "legacy", t.exports.BINARY_DATA_SOURCE = "binary", t.exports.INDEXED_DATA_SOURCE = "indexed", t.exports.TILE_ELEVATIONS_LOADED_EVENT = "tile_elevations_loaded", t.exports.TILE_ELEVATIONS_FAILED_EVENT = "tile_elevations_failed";
        var c = 20037508.34;
        d.inherits(n, u), n.prototype.release = function() {
            this._dataSource.release(), delete this._dataSource, r.each(this._allElevationsData, function(e, t) {
                this._releaseTileElevations(e, t, !1)
            }, this), this._visibleTileSet = {}, this._allElevationsData = {}, delete this._tileElevationsLoadedHandler, delete this._mapRenderer
        }, n.prototype.update = function(e, t) {
            this._updateVisibleTileSet(e, t), this._releaseUnusedElevations(e), this._dataSource.onCameraMoved()
        }, n.prototype.clearCache = function() {}, n.prototype.enter2d = function(e) {
            (this._isIn3d || e) && (this._dataSource.abortAll(), this._isIn3d = !1, this._options.dataSource != n.FLAT_DATA_SOURCE && (this._dataSource = new o(this._mapRenderer, this._tileElevationsLoadedHandler)), this._reloadAllTiles())
        }, n.prototype.enter3d = function(e) {
            (!this._isIn3d || e) && (this._dataSource.abortAll(), this._isIn3d = !0, this._options.dataSource != n.FLAT_DATA_SOURCE && this._buildDataSource(), this._reloadAllTiles())
        }, n.prototype.setEnabled = function(e) {
            this._isEnabled != e && (this._isEnabled = e, this._dataSource.abortAll(), this.clearCache(), this._buildDataSource(), this._reloadAllTiles())
        }, n.prototype.reload = function() {
            this._dataSource.abortAll(), this.clearCache(), this._reloadAllTiles()
        }, n.prototype.getTileElevationsData = function(e) {
            if (this._allElevationsData[e]) {
                var t = this._allElevationsData[e];
                return t
            }
            return null
        }, n.prototype._buildDataSource = function() {
            if (this._options.dataSource != n.FLAT_DATA_SOURCE && this._isIn3d && this._isEnabled) {
                if (this._options.dataSource == n.TEST_DATA_SOURCE) this._dataSource = new a(this._mapRenderer, this._tileElevationsLoadedHandler);
                else if (this._options.dataSource == n.LEGACY_DATA_SOURCE || this._options.dataSource == n.BINARY_DATA_SOURCE || this._options.dataSource == n.INDEXED_DATA_SOURCE) {
                    var e = this._options.dataSource;
                    this._options.indexed && (e = n.INDEXED_DATA_SOURCE);
                    var t = {
                        requestType: e
                    };
                    this._dataSource = new s(this._mapRenderer, this._tileElevationsLoadedHandler, t)
                }
            } else this._dataSource = new o(this._mapRenderer, this._tileElevationsLoadedHandler)
        }, n.prototype._updateVisibleTileSet = function(e, t) {
            var i = this._mapRenderer.conf.get("elevations.minElevationZoom"),
                n = e.getVisibleTilesAtZoom(i, this._maxZoomForHeightMapTexture),
                o = r.keys(n),
                a = {};
            r.each(this._visibleTileSet, function(e, t) {
                -1 == o.indexOf(t) && (a[t] = e)
            }), r.each(a, function(e, t) {
                this._removeTileFromVisibleSet(t)
            }, this), r.each(n, function(e, i) {
                if (this._allElevationsData[i] || (this._allElevationsData[i] = new l(e)), !this._visibleTileSet[i]) {
                    this._visibleTileSet[i] = e;
                    var n = this._allElevationsData[i],
                        r = n.state,
                        o = null == r || r == h.FAILING || r == h.FAILED || r == h.ABORTED;
                    o && this._dataSource.requestTileElevations(n, t)
                }
            }, this)
        }, n.prototype._requestParentTile = function(e) {
            var t = e.parent,
                i = this._mapRenderer.conf.get("elevations.minElevationZoom");
            if (t && t.zoom >= i) {
                var n = t.tileKey;
                this._allElevationsData[n] || (this._allElevationsData[n] = new l(t));
                var r = this._allElevationsData[n],
                    o = r.state,
                    a = null == o || o == h.FAILING || o == h.FAILED || o == h.ABORTED;
                a && this._dataSource.requestTileElevations(r)
            }
        }, n.prototype._releaseUnusedElevations = function(e) {
            for (var t = r.keys(this._allElevationsData), i = 0; i < t.length; i++) {
                var n = t[i],
                    o = this._allElevationsData[n];
                e.allTiles[n] || (this._releaseTileElevations(o), delete this._allElevationsData[n])
            }
        }, n.prototype._removeTileFromVisibleSet = function(e) {
            if (this._allElevationsData[e]) {
                var t = this._allElevationsData[e],
                    i = t.state;
                (i == h.NEEDS_REQUEST || i == h.REQUESTED || i == h.LOADING || i == h.FAILING) && this._dataSource.abort(t)
            }
            delete this._visibleTileSet[e]
        }, n.prototype._releaseTileElevations = function(e) {
            null != e.texture && this._mapRenderer.getRenderEngine().releaseTexture(e.texture), null != e.normalMapTexture && this._mapRenderer.getRenderEngine().releaseTexture(e.normalMapTexture)
        }, n.prototype._reloadVisibleTiles = function() {
            r.each(this._visibleTileSet, function(e, t) {
                var i = this._allElevationsData[t];
                i && i.state != h.NEEDS_REQUEST && this._dataSource.requestTileElevations(i)
            }, this)
        }, n.prototype._reloadAllTiles = function() {
            r.each(this._allElevationsData, function(e) {
                e.state != h.NEEDS_REQUEST && this._dataSource.requestTileElevations(e)
            }, this)
        }, n.prototype._onTileElevationsLoaded = function(e, t, i, r) {
            e ? this.emit(n.TILE_ELEVATIONS_FAILED_EVENT, t) : this._allElevationsData[t.tileKey] ? ((i || t.isFlat) && (null != t.texture && (this._mapRenderer.getRenderEngine().releaseTexture(t.texture), t.texture = null), t.texture = i), r && (null != t.normalMapTexture && (this._mapRenderer.getRenderEngine().releaseTexture(t.normalMapTexture), t.normalMapTexture = null), t.normalMapTexture = r), this.emit(n.TILE_ELEVATIONS_LOADED_EVENT, t)) : (i && this._mapRenderer.getRenderEngine().releaseTexture(i), r && this._mapRenderer.getRenderEngine().releaseTexture(r)), this._mapRenderer.conf.get("elevations.preloadParent") && this._requestParentTile(t.tileNode)
        }
    }, {
        "../TileDataState": 363,
        "./FlatTileElevationsSource": 369,
        "./ServerTileElevationsSource": 373,
        "./TestTileElevationsSource": 374,
        "./TileElevationsData": 375,
        events: 99,
        underscore: 207,
        util: 212
    }],
    377: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.tileNode = e, this.tileKey = e.tileKey, this.tileCoords = e.tileCoords, this.ancestors = {};
            for (var i = 0; i < e.ancestorUVs.length; i++) {
                var n = e.ancestorUVs[i];
                this.ancestors[n.tileKey] = n.uvData
            }
            this._setElevationsData(t), this.needsRefresh = !1
        }
        var r = e("util"),
            o = e("events").EventEmitter,
            a = "elevations_model_changed";
        t.exports = n, t.exports.ELEVATIONS_MODEL_CHANGED_EVENT = a;
        var s = [{
                u: 0,
                v: 0
            }, {
                u: 1,
                v: 1
            }],
            l = {
                modX: 0,
                modY: 0,
                topLeft: null,
                topRight: null,
                bottomLeft: null,
                bottomRight: null
            };
        r.inherits(n, o), n.prototype.release = function(e) {
            null != this.elevationsTexture && (e.getRenderEngine().releaseTexture(this.elevationsTexture), this.elevationsTexture = null), null != this.normalMapTexture && (e.getRenderEngine().releaseTexture(this.normalMapTexture), this.normalMapTexture = null)
        }, n.prototype.updateElevations = function(e, t) {
            this._setElevationsData(e, t), this.emit(a)
        }, n.prototype._setElevationsData = function(e, t) {
            e.texture && e.texture.addRefCount(), e.normalMapTexture && e.normalMapTexture.addRefCount(), this.elevationsTexture && t.getRenderEngine().releaseTexture(this.elevationsTexture), this.normalMapTexture && t.getRenderEngine().releaseTexture(this.normalMapTexture), this.elevationsData = e, this.elevationsTexture = e.texture, this.normalMapTexture = e.normalMapTexture, this.elevationsTileKey = e.tileKey;
            var i = this.elevationsData.rawData,
                n = this.elevationsData.normalMapData;
            this.elevationsIndexedData = i.indexedData, this.uvRect = {
                x: (.5 + i.boundarySizeX) / i.nx,
                y: (.5 + i.boundarySizeY) / i.ny,
                width: (i.nx - 1 - 2 * i.boundarySizeX) / i.nx,
                height: (i.ny - 1 - 2 * i.boundarySizeY) / i.ny
            }, this.normalsUvRect = {
                x: .5 / n.nx,
                y: .5 / n.ny,
                width: (n.nx - 1) / n.nx,
                height: (n.ny - 1) / n.ny
            }, this.isFlat = e.isFlat, this.UVs = this.ancestors[this.elevationsTileKey] ? this.ancestors[this.elevationsTileKey] : s, this._calculateUVData()
        }, n.prototype.findHeight = function(e, t) {
            if (this.isFlat || null == this.elevationsTexture) return null;
            var i = this.elevationsData.bounds;
            if (i.xMin > e || i.xMax < e || i.yMax < t || i.yMin > t) return null;
            var n = this._computeBilinearArguments(e, t);
            return n ? this._computeBilinear(n) : null
        }, n.prototype._calculateUVData = function() {
            this.uvOffset = {
                u: this.UVs[0].u * this.uvRect.width + this.uvRect.x,
                v: this.UVs[0].v * this.uvRect.height + this.uvRect.y
            }, this.uvScale = {
                u: (this.UVs[1].u - this.UVs[0].u) * this.uvRect.width,
                v: (this.UVs[1].v - this.UVs[0].v) * this.uvRect.height
            }, this.normalMapUvOffset = {
                u: this.UVs[0].u * this.normalsUvRect.width + this.normalsUvRect.x,
                v: this.UVs[0].v * this.normalsUvRect.height + this.normalsUvRect.y
            }, this.normalMapUvScale = {
                u: (this.UVs[1].u - this.UVs[0].u) * this.normalsUvRect.width,
                v: (this.UVs[1].v - this.UVs[0].v) * this.normalsUvRect.height
            }
        }, n.prototype._computeBilinearArguments = function(e, t) {
            var i = this.elevationsData.bounds,
                n = i.xMax - i.xMin,
                r = i.yMax - i.yMin,
                o = this.elevationsData.rawData.elevations,
                a = this.elevationsData.rawData.nx,
                s = this.elevationsData.rawData.ny,
                h = this.elevationsData.rawData.boundarySizeX,
                u = this.elevationsData.rawData.boundarySizeY,
                d = n / (a - 1 - 2 * h),
                c = r / (s - 1 - 2 * u),
                f = (i.yMax - t) / c + u,
                p = (e - i.xMin) / d + h;
            if (0 > f || f >= s) return console.error("operation outside elevation (y=%f)", f), null;
            if (0 > p || p >= a) return console.error("operation outside elevation (x=%f)", p), null;
            l.modX = p % 1, l.modY = f % 1, p = Math.floor(p), f = Math.floor(f);
            var m = f * a + p;
            if (this.elevationsIndexedData) {
                var g = this.elevationsIndexedData.minElevation,
                    _ = this.elevationsIndexedData.elevationRange,
                    v = _ / 65535;
                l.topLeft = g + v * o[m], l.bottomLeft = g + v * o[m + a], l.topRight = g + v * o[m + 1], l.bottomRight = g + v * o[m + a + 1]
            } else l.topLeft = o[m], l.bottomLeft = o[m + a], l.topRight = o[m + 1], l.bottomRight = o[m + a + 1];
            return l
        }, n.prototype._computeBilinear = function(e) {
            var t = e.modX,
                i = e.modY,
                n = e.topLeft,
                r = e.topRight,
                o = e.bottomLeft,
                a = e.bottomRight,
                s = (1 - t) * (1 - i),
                l = t * (1 - i),
                h = t * i,
                u = (1 - t) * i;
            return s * n + l * r + h * a + u * o
        }
    }, {
        events: 99,
        util: 212
    }],
    378: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, this._tileElevationsLoader = t, this._onTileElevationsLoadedHandler = r.bind(this.onTileElevationsLoaded, this), this._onTileElevationsFailedHandler = r.bind(this._onTileElevationsFailed, this), t.on(o.TILE_ELEVATIONS_LOADED_EVENT, this._onTileElevationsLoadedHandler), t.on(o.TILE_ELEVATIONS_FAILED_EVENT, this._onTileElevationsFailedHandler), this._currentTileSet = {}
        }
        var r = e("underscore"),
            o = e("./TileElevationsLoader"),
            a = e("./TileElevationsData"),
            s = e("./TileElevationsModel");
        t.exports = n, n.prototype.release = function() {
            this._tileElevationsLoader.removeListener(o.TILE_ELEVATIONS_LOADED_EVENT, this._onTileElevationsLoadedHandler), this._tileElevationsLoader.removeListener(o.TILE_ELEVATIONS_FAILED_EVENT, this._onTileElevationsFailedHandler), delete this._onTileElevationsLoadedHandler, delete this._onTileElevationsFailedHandler
        }, n.prototype.enter2d = function() {
            this.refreshModels()
        }, n.prototype.enter3d = function() {
            this.refreshModels()
        }, n.prototype.getTileElevationsModel = function(e) {
            var t, i, n = e.tileKey;
            return this._currentTileSet[n] ? (t = this._currentTileSet[n], t.elevationsTileKey != t.tileKey && (i = this._getElevationsData(e, 0), t.updateElevations(i, this._mapRenderer))) : (i = this._getElevationsData(e, 0), t = new s(e, i), this._currentTileSet[n] = t), t
        }, n.prototype.releaseTileElevationsModel = function(e) {
            if (this._currentTileSet[e]) {
                var t = this._currentTileSet[e];
                t.release(this._mapRenderer), delete this._currentTileSet[e]
            }
        }, n.prototype.refreshModels = function() {
            var e = r.keys(this._currentTileSet);
            r.each(e, function(e) {
                var t = this._currentTileSet[e];
                t.needsRefresh = !0
            }, this), r.each(e, function(e) {
                var t = this._currentTileSet[e];
                this._refreshTileElevationsModel(t)
            }, this)
        }, n.prototype._refreshTileElevationsModel = function(e) {
            if (e.tileNode.parent) {
                var t = e.tileNode.parent.tileKey,
                    i = this._currentTileSet[t];
                i && i.needsRefresh && this._refreshTileElevationsModel(i)
            }
            var n = this._getElevationsData(e.tileNode, 0);
            e.updateElevations(n, this._mapRenderer), e.needsRefresh = !1
        }, n.prototype._getElevationsData = function(e, t) {
            var i;
            if (e) {
                var n = e.tileKey,
                    r = this._tileElevationsLoader.getTileElevationsData(n);
                if (null != r && r.texture) return r;
                var o = this._currentTileSet[n];
                return o && null != o.elevationsTexture ? o.elevationsData : this._getElevationsData(e.parent, t + 1)
            }
            return i = new a
        }, n.prototype.onTileElevationsLoaded = function(e) {
            var t = e.tileKey;
            r.each(this._currentTileSet, function(i, n) {
                if (n == t) i.updateElevations(e, this._mapRenderer);
                else {
                    var r = i.ancestors[t];
                    r && (null == i.elevationsTileKey || e.bounds.zoom >= i.elevationsData.bounds.zoom) && i.updateElevations(e, this._mapRenderer)
                }
            }, this)
        }, n.prototype._onTileElevationsFailed = function() {}
    }, {
        "./TileElevationsData": 375,
        "./TileElevationsLoader": 376,
        "./TileElevationsModel": 377,
        underscore: 207
    }],
    379: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, this._tileTextureRequestCallback = t, this._allTextureRequests = {}, this._abortedRequestsQueue = [], this._pendingRequestsQueue = [], this._terminatedRequestsQueue = [], this._pendingRequestsQueueNeedsSorting = !0, this._terminatedRequestsQueueNeedsSorting = !0, this._abortedRequestHandler = r.bind(this._handleNextAbortedRequest, this), this._pendingRequestsWorker = r.bind(this._getPendingRequestWork, this), this._pendingRequestHandler = r.bind(this._handleNextPendingRequest, this), this._terminatedRequestsWorker = r.bind(this._getTerminatedRequestWork, this), this._terminatedRequestHandler = r.bind(this._handleNextTerminatedRequest, this), this._onTextureRequestSuccessHandler = r.bind(this._onTextureRequestSuccess, this), this._onTextureRequestErrorHandler = r.bind(this._onTextureRequestError, this);
            var i = this._tileProcessor = new o(e, {
                intervalIdle: e.conf.get("workProcessor.tilesInterval"),
                maxDurationIdle: e.conf.get("workProcessor.tilesDuration"),
                workWhenCameraMove: !0,
                intervalMoving: e.conf.get("workProcessor.tilesIntervalMoving"),
                maxDurationMoving: e.conf.get("workProcessor.tilesDurationMoving"),
                name: "rasterTileTextureProcessor"
            });
            i.registerWorker(this._pendingRequestsWorker, "RasterTileTextureSource:pendingRequestsWorker"), i.registerWorker(this._terminatedRequestsWorker, "RasterTileTextureSource:terminatedRequestsWorker"), i.start(), this._tileTextureRequestHandler = null, e._featuresRequestManager && !e._featuresRequestManager.ajaxDownloadCanBeEnabled() && (console.log("disabling ajaxDownload for tile textures"), e.conf.set("tiles.ajaxDownload", !1)), e._featuresRequestManager && e.conf.get("tiles.ajaxDownload") && (this._tileTextureRequestHandler = function(t, i) {
                return i.priority = e.conf.get("downloads.tiles.priority"), e._featuresRequestManager.askTextureToServer(t, i)
            })
        }
        var r = e("underscore"),
            o = e("../../../utils/WorkProcessor"),
            a = e("../TileDataState"),
            s = e("./TileTextureRequest");
        t.exports = n, n.prototype.release = function() {
            for (this.abortAll(); this._abortedRequestsQueue.length > 0;) {
                var e = this._abortedRequestsQueue.shift();
                e.abort(this._mapRenderer)
            }
            this._tileProcessor.release(), delete this._tileProcessor, delete this._tileTextureRequestCallback, delete this._abortedRequestHandler, delete this._pendingRequestsWorker, delete this._pendingRequestHandler, delete this._terminatedRequestsWorker, delete this._terminatedRequestHandler, delete this._onTextureRequestSuccessHandler, delete this._onTextureRequestErrorHandler, delete this._mapRenderer
        }, n.prototype.requestTileTexture = function(e, t, i) {
            this._allTextureRequests[e.tileKey] && this.abort(e), e.textureState = a.NEEDS_REQUEST;
            var n = new s(e, t);
            this._allTextureRequests[e.tileKey] = n, i ? this._performRequest(n) : (this._pendingRequestsQueue.push(n), this._pendingRequestsQueueNeedsSorting = !0)
        }, n.prototype.abortAll = function() {
            var e = r.keys(this._allTextureRequests);
            r.each(e, function(e) {
                var t = this._allTextureRequests[e];
                this.abort(t.tileTextureData)
            }, this)
        }, n.prototype.abort = function(e) {
            if (this._allTextureRequests[e.tileKey]) {
                var t = this._allTextureRequests[e.tileKey];
                if (e.textureState == a.REQUESTED) t.textureState = a.ABORTED, this._abortedRequestsQueue.push(t);
                else if (e.textureState == a.NEEDS_REQUEST) {
                    var i = this._pendingRequestsQueue.indexOf(t);
                    i > -1 && this._pendingRequestsQueue.splice(i, 1)
                } else {
                    var n = this._terminatedRequestsQueue.indexOf(t);
                    n > -1 && this._terminatedRequestsQueue.splice(n, 1), t.releaseTexture(this._mapRenderer)
                }
                e.textureState = a.ABORTED, delete this._allTextureRequests[e.tileKey]
            }
        }, n.prototype.onCameraMoved = function() {
            this._pendingRequestsQueueNeedsSorting = !0, this._terminatedRequestsQueueNeedsSorting = !0
        }, n.prototype._getPendingRequestWork = function() {
            return this._abortedRequestsQueue.length > 0 ? this._abortedRequestHandler : 0 == this._pendingRequestsQueue.length ? null : (this._sortTextureRequestsQueue(), this._pendingRequestHandler)
        }, n.prototype._handleNextAbortedRequest = function() {
            if (0 != this._abortedRequestsQueue.length) {
                var e = this._abortedRequestsQueue.shift();
                e.abort(this._mapRenderer)
            }
        }, n.prototype._handleNextPendingRequest = function() {
            if (0 != this._pendingRequestsQueue.length) {
                var e = this._pendingRequestsQueue.shift(),
                    t = Date.now();
                return null != e.nextTimeToRetry && e.nextTimeToRetry > t ? void this._pendingRequestsQueue.push(e) : void this._performRequest(e)
            }
        }, n.prototype._performRequest = function(e) {
            var t = e.tileTextureData;
            t.textureState = a.REQUESTED, e.doRequest(this._mapRenderer, this._tileTextureRequestHandler, this._onTextureRequestSuccessHandler, this._onTextureRequestErrorHandler)
        }, n.prototype._getTerminatedRequestWork = function() {
            return this._abortedRequestsQueue.length > 0 ? this._abortedRequestHandler : 0 == this._terminatedRequestsQueue.length ? null : (this._sortTextureResponsesQueue(), this._terminatedRequestHandler)
        }, n.prototype._handleNextTerminatedRequest = function() {
            if (0 != this._terminatedRequestsQueue.length) {
                var e = this._terminatedRequestsQueue.shift(),
                    t = e.tileTextureData;
                if (t.textureState == a.LOADING) this._tileTextureRequestCallback(null, t, e.texture, e.is3d), t.textureState = a.LOADED, delete this._allTextureRequests[t.tileKey];
                else if (t.textureState == a.FAILING)
                    if (3 == e.numberOfFails) e.releaseTexture(this._mapRenderer), this._tileTextureRequestCallback(new Error("Failed to load texture " + t.tileKey), t, null, e.is3d), t.textureState = a.FAILED, delete this._allTextureRequests[t.tileKey], console.error("Failed to load texture for tile " + t.tileKey);
                    else {
                        t.textureState = a.NEEDS_REQUEST;
                        var i = 1e4 * e.numberOfFails;
                        e.nextTimeToRetry = Date.now() + i, console.warn("Failed to load texture for tile " + t.tileKey + ", retrying in " + i + "ms"), this._pendingRequestsQueue.push(e)
                    }
            }
        }, n.prototype._sortTextureRequestsQueue = function() {
            this._pendingRequestsQueueNeedsSorting && (this._pendingRequestsQueue = r.sortBy(this._pendingRequestsQueue, function(e) {
                return this._mapRenderer.computeDistanceToCenter(e.tileTextureData.center)
            }, this), this._pendingRequestsQueueNeedsSorting = !1)
        }, n.prototype._sortTextureResponsesQueue = function() {
            this._terminatedRequestsQueueNeedsSorting && (this._terminatedRequestsQueue = r.sortBy(this._terminatedRequestsQueue, function(e) {
                return this._mapRenderer.computeDistanceToCenter(e.tileTextureData.center)
            }, this), this._terminatedRequestsQueueNeedsSorting = !1)
        }, n.prototype._onTextureRequestSuccess = function(e) {
            if (e.textureState != a.ABORTED) {
                var t = e.tileTextureData;
                t.textureState = a.LOADING, this._terminatedRequestsQueue.push(e)
            }
        }, n.prototype._onTextureRequestError = function(e) {
            if (e.textureState != a.ABORTED) {
                var t = e.tileTextureData;
                t.textureState = a.FAILING, this._terminatedRequestsQueue.push(e)
            }
        }
    }, {
        "../../../utils/WorkProcessor": 416,
        "../TileDataState": 363,
        "./TileTextureRequest": 385,
        underscore: 207
    }],
    380: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._mapRenderer = e, void 0 !== this._mapRenderer.conf.get("tiles.tileTextureCacheSize") ? this._tileCacheSize = this._mapRenderer.conf.get("tiles.tileTextureCacheSize") : this._tileCacheSize = r, this._textureDataCache = []
        }
        var r = 128;
        t.exports = n, n.prototype.getCacheSize = function() {
            return this._tileCacheSize
        }, n.prototype.containsTileTextureData = function(e) {
            for (var t = this._textureDataCache.length - 1; t > -1; t--) {
                var i = this._textureDataCache[t];
                if (i.tileKey == e) return !0
            }
        }, n.prototype.getTileTextureData = function(e) {
            for (var t = this._textureDataCache.length - 1; t > -1; t--) {
                var i = this._textureDataCache[t];
                if (i.tileKey == e) return this._textureDataCache.splice(t, 1), this._textureDataCache.push(i), i
            }
            return null
        }, n.prototype.addTileTexture = function(e, t, i) {
            var n = this.getTileTextureData(e);
            if (n) t && !n.texture2d && (t && t.addRefCount(), n.texture2d = t), i && !n.texture3d && (i && i.addRefCount(), n.texture3d = i);
            else {
                var r = {
                    tileKey: e,
                    texture2d: t,
                    texture3d: i
                };
                for (this._retainCacheData(r), this._textureDataCache.push(r); this._textureDataCache.length > this._tileCacheSize;) r = this._textureDataCache.shift(), this._releaseCacheData(r)
            }
        }, n.prototype.clearCache = function() {
            for (; this._textureDataCache.length > 0;) {
                var e = this._textureDataCache.shift();
                this._releaseCacheData(e)
            }
        }, n.prototype._retainCacheData = function(e) {
            e.texture2d && e.texture2d.addRefCount(), e.texture3d && e.texture3d.addRefCount()
        }, n.prototype._releaseCacheData = function(e) {
            e.texture2d && this._mapRenderer.getRenderEngine().releaseTexture(e.texture2d), e.texture3d && this._mapRenderer.getRenderEngine().releaseTexture(e.texture3d)
        }
    }, {}],
    381: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.tileKey = e.tileKey, this.tileCoords = e.tileCoords, this.center = e.center, this.textureState = null, this.texture2d = null, this.texture3d = null
        }
        t.exports = n
    }, {}],
    382: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            h.call(this), t = null == t ? {} : t, this._mapRenderer = e, this._options = r.defaults(t, {
                dataSource: d
            }), this._isIn3d = this._mapRenderer.isIn3d(), this._tileTextureLoadedHandler = r.bind(this._onTileTextureLoaded, this), this._dataSource = null, this._buildDataSource(), this._visibleTileSet = {}, this._allTextureData = {}, this._tileTextureCache = new s(e), this._useTileTextureCache = this._tileTextureCache.getCacheSize() > 0
        }
        var r = e("underscore"),
            o = e("../TileDataState"),
            a = e("./RasterTileTextureSource"),
            s = e("./TileTextureCache"),
            l = e("./TileTextureData"),
            h = e("events").EventEmitter,
            u = e("util"),
            d = "rasterDataSource",
            c = "tile_texture_loaded",
            f = "tile_texture_failed";
        u.inherits(n, h), t.exports = n, t.exports.RASTER_DATA_SOURCE = d, t.exports.TILE_TEXTURE_LOADED_EVENT = c, t.exports.TILE_TEXTURE_FAILED_EVENT = f, n.prototype.release = function() {
            this._dataSource.release(), delete this._dataSource, this._tileTextureCache.clearCache(), delete this._tileTextureCache, r.each(this._allTextureData, function(e, t) {
                this._releaseTileTextures(e, t, !1)
            }, this), this._visibleTileSet = {}, this._allTextureData = {}, delete this._tileTextureLoadedHandler, delete this._mapRenderer
        }, n.prototype.update = function(e, t) {
            this._updateVisibleTileSet(e, t), this._releaseUnusedTextures(e), this._dataSource.onCameraMoved()
        }, n.prototype.clearCache = function() {
            this._tileTextureCache.clearCache()
        }, n.prototype.enter2d = function(e) {
            (this._isIn3d || e) && (this._dataSource.abortAll(), this._isIn3d = !1, this._reloadAllTiles())
        }, n.prototype.enter3d = function(e) {
            if (!this._isIn3d || e) {
                this._dataSource.abortAll(), this._isIn3d = !0;
                var t = this._mapRenderer.getMinZoomLayer2D() - 4;
                this._reloadAllTiles(t)
            }
        }, n.prototype.reload = function() {
            this._dataSource.abortAll(), this.clearCache();
            var e = 0;
            this._isIn3d && (e = this._mapRenderer.getMinZoomLayer2D() - 4), this._reloadAllTiles(e)
        }, n.prototype.getTileTexture = function(e) {
            if (this._allTextureData[e]) {
                var t = this._allTextureData[e];
                if (this._isIn3d) {
                    if (t.texture3d) return t.texture3d
                } else if (t.texture2d) return t.texture2d
            }
            var i = this._getTextureFromCache(e, this._isIn3d);
            return null != i ? i : null
        }, n.prototype._buildDataSource = function() {
            this._options.dataSource == d && (this._dataSource = new a(this._mapRenderer, this._tileTextureLoadedHandler))
        }, n.prototype._updateVisibleTileSet = function(e, t) {
            var i = e.visibleTiles,
                n = r.keys(i),
                a = {};
            r.each(this._visibleTileSet, function(e, t) {
                -1 == n.indexOf(t) && (a[t] = e)
            }), r.each(a, function(e, t) {
                this._removeTileFromVisibleSet(t)
            }, this), r.each(i, function(e, i) {
                if (this._allTextureData[i] || (this._allTextureData[i] = new l(e)), !this._visibleTileSet[i]) {
                    this._visibleTileSet[i] = e;
                    var n = this._allTextureData[i],
                        r = this._isIn3d ? n.texture3d : n.texture2d;
                    if (!r) {
                        var a = this._getTextureFromCache(i, this._isIn3d);
                        a ? (a.addRefCount(), this._isIn3d ? n.texture3d = a : n.texture2d = a, n.textureState = o.LOADED) : this._dataSource.requestTileTexture(n, this._isIn3d, t)
                    }
                }
            }, this)
        }, n.prototype._releaseUnusedTextures = function(e) {
            for (var t = r.keys(this._allTextureData), i = 0; i < t.length; i++) {
                var n = t[i],
                    o = this._allTextureData[n];
                e.allTiles[n] || (this._releaseTileTextures(o, n, !0), delete this._allTextureData[n])
            }
        }, n.prototype._removeTileFromVisibleSet = function(e) {
            if (this._allTextureData[e]) {
                var t = this._allTextureData[e],
                    i = t.textureState;
                (i == o.NEEDS_REQUEST || i == o.REQUESTED || i == o.LOADING || i == o.FAILING) && this._dataSource.abort(t)
            }
            delete this._visibleTileSet[e]
        }, n.prototype._releaseTileTextures = function(e, t, i) {
            (e.texture2d || e.texture3d) && i && this._useTileTextureCache && this._tileTextureCache.addTileTexture(t, e.texture2d, e.texture3d), null != e.texture2d && this._mapRenderer.getRenderEngine().releaseTexture(e.texture2d), null != e.texture3d && this._mapRenderer.getRenderEngine().releaseTexture(e.texture3d)
        }, n.prototype._reloadVisibleTiles = function() {
            r.each(this._visibleTileSet, function(e, t) {
                var i = this._allTextureData[t];
                i && i.textureState != o.NEEDS_REQUEST && this._dataSource.requestTileTexture(i, this._isIn3d)
            }, this)
        }, n.prototype._reloadAllTiles = function(e) {
            e || (e = 0), r.each(this._allTextureData, function(t) {
                t.textureState != o.NEEDS_REQUEST && t.tileCoords.z >= e && this._dataSource.requestTileTexture(t, this._isIn3d)
            }, this)
        }, n.prototype._onTileTextureLoaded = function(e, t, i, n) {
            e ? this.emit(f, t.tileKey) : this._allTextureData[t.tileKey] ? (n ? (null != t.texture3d && (this._mapRenderer.getRenderEngine().releaseTexture(t.texture3d), t.texture3d = null), t.texture3d = i) : (null != t.texture2d && (this._mapRenderer.getRenderEngine().releaseTexture(t.texture2d), t.texture2d = null), t.texture2d = i), this.emit(c, t.tileKey, i)) : this._mapRenderer.getRenderEngine().releaseTexture(i)
        }, n.prototype._getTextureFromCache = function(e, t) {
            var i = this._tileTextureCache.getTileTextureData(e);
            if (i)
                if (t) {
                    if (i.texture3d) return i.texture3d
                } else if (i.texture2d) return i.texture2d;
            return null
        }
    }, {
        "../TileDataState": 363,
        "./RasterTileTextureSource": 379,
        "./TileTextureCache": 380,
        "./TileTextureData": 381,
        events: 99,
        underscore: 207,
        util: 212
    }],
    383: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            this.tileNode = e, this.tileKey = e.tileKey, this.parentTileKey = i.tileKey, this.baseTexture = t.texture, this.baseTextureIsTile = t.isTileTexture, this.parentTexture = i.texture, this.parentTextureIsTile = i.isTileTexture, this.needsRefresh = !1, this.blendingRatio = 0, this.blendingDirection = 0, this.ancestors = {};
            for (var n = 0; n < e.ancestorUVs.length; n++) {
                var r = e.ancestorUVs[n];
                this.ancestors[r.tileKey] = r.uvData
            }
            this.parentUVs = this.ancestors[this.parentTileKey] ? this.ancestors[this.parentTileKey] : h, this.baseTextureIsTile && this.baseTexture.addRefCount(), this._calculateParentUVData()
        }
        var r = e("util"),
            o = e("events").EventEmitter,
            a = e("engine"),
            s = a.Constants,
            l = "texture_model_changed";
        t.exports = n, t.exports.TEXTURE_MODEL_CHANGED_EVENT = l;
        var h = [{
            u: 0,
            v: 0
        }, {
            u: 1,
            v: 1
        }];
        r.inherits(n, o), n.prototype.release = function(e, t) {
            this.baseTextureIsTile && (e.getRenderEngine().releaseTexture(this.baseTexture), this.baseTexture = t, this.baseTextureIsTile = !1)
        }, n.prototype.updateBaseTexture = function(e, t, i) {
            t && e != this.baseTexture && (this.baseTextureIsTile && i.getRenderEngine().releaseTexture(this.baseTexture), this.baseTexture = e, this.baseTextureIsTile = t, this.baseTextureIsTile && this.baseTexture.addRefCount(), this.emit(l))
        }, n.prototype.updateParentTexture = function(e, t, i) {
            (this.parentTextureIsTile || t) && e != this.parentTexture && (this.parentTexture = e, this.parentTextureIsTile = t, this.parentTileKey = i, this.parentUVs = this.ancestors[this.parentTileKey] ? this.ancestors[this.parentTileKey] : h, this._calculateParentUVData(), this.emit(l))
        }, n.prototype.setTextureFilters = function(e, t) {
            if (this.baseTextureIsTile) {
                var i, n, r;
                e ? (n = s.LinearFilter, i = s.LinearMipMapLinearFilter, r = !0) : (n = s.NearestFilter, i = s.NearestFilter, r = !1);
                var o = this.baseTexture;
                (o.magFilter != n || o.minFilter != i) && (o.minFilter = i, o.magFilter = n, o.useAnisotropic = r)
            }
            if (this.parentTextureIsTile) {
                var a = this.parentTexture;
                !a || a.magFilter == s.LinearFilter && a.minFilter == s.LinearMipMapLinearFilter || (a.magFilter = s.LinearFilter, a.minFilter = s.LinearMipMapLinearFilter, a.useAnisotropic = t)
            }
        }, n.prototype._calculateParentUVData = function() {
            this.parentUVOffset = {
                u: this.parentUVs[0].u,
                v: this.parentUVs[0].v
            }, this.parentUVScale = {
                u: this.parentUVs[1].u - this.parentUVs[0].u,
                v: this.parentUVs[1].v - this.parentUVs[0].v
            }
        }, n.prototype.resetBlending = function() {
            this.blendingRatio = 0, this.blendingDirection = 0
        }, n.prototype.ensureBlendingFromParent = function(e) {
            e && 0 == this.blendingRatio && (this.blendingRatio = 1), 0 != this.blendingRatio && (this.blendingDirection = -1)
        }, n.prototype.ensureBlendingToParent = function() {
            1 != this.blendingRatio && (this.blendingDirection = 1)
        }, n.prototype.isBlending = function() {
            return 0 != this.blendingDirection
        }, n.prototype.isBlendingToParent = function() {
            return 1 == this.blendingDirection
        }, n.prototype.setBestBlendToShowBaseTile = function() {
            this.baseTextureIsTile ? (this.blendingRatio = 0, this.blendingDirection = 0) : (this.blendingRatio = 1, this.blendingDirection = -1)
        }, n.prototype.updateBlending = function(e, t) {
            var i = this.blendingRatio;
            if (0 == this.blendingDirection) return !1;
            if (-1 == this.blendingDirection && !this.baseTextureIsTile) return !1;
            if (1 == this.blendingDirection && !this.parentTextureIsTile) return !1;
            if (1 != this.blendingDirection || this.baseTextureIsTile) {
                var n, r, o = e / t;
                1 == this.blendingDirection ? (n = Math.min(this.blendingRatio + o, 1), r = n) : -1 == this.blendingDirection && (n = Math.min(1 - this.blendingRatio + o, 1), r = 1 - n), 1 == n && (this.blendingDirection = 0), r != this.blendingRatio && (this.blendingRatio = r)
            } else this.blendingRatio = 1, this.blendingDirection = 0;
            return this.blendingRatio != i
        }
    }, {
        engine: 10,
        events: 99,
        util: 212
    }],
    384: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this._mapRenderer = e, this._tileTextureLoader = t, this._onTileTextureLoadedHandler = r.bind(this._onTileTextureLoaded, this), this._onTileTextureFailedHandler = r.bind(this._onTileTextureFailed, this), t.on(o.TILE_TEXTURE_LOADED_EVENT, this._onTileTextureLoadedHandler), t.on(o.TILE_TEXTURE_FAILED_EVENT, this._onTileTextureFailedHandler), this._emptyTexture = null, this._generateEmptyTexture(), this._currentTileSet = {}
        }
        var r = e("underscore"),
            o = e("./TileTextureLoader"),
            a = e("./TileTextureModel"),
            s = e("engine"),
            l = s.Constants,
            h = 8;
        t.exports = n, n.prototype.release = function() {
            this._tileTextureLoader.removeListener(o.TILE_TEXTURE_LOADED_EVENT, this._onTileTextureLoadedHandler), this._tileTextureLoader.removeListener(o.TILE_TEXTURE_FAILED_EVENT, this._onTileTextureFailedHandler), delete this._onTileTextureLoadedHandler, delete this._onTileTextureFailedHandler
        }, n.prototype.enter2d = function() {
            this.refreshModels()
        }, n.prototype.enter3d = function() {
            this.refreshModels()
        }, n.prototype.getTileTextureModel = function(e) {
            var t = e.tileKey;
            if (!this._currentTileSet[t]) {
                var i = {
                    texture: this._tileTextureLoader.getTileTexture(t),
                    isTileTexture: !0
                };
                i.texture || (i.texture = this._emptyTexture, i.isTileTexture = !1);
                var n = this._getParentTextureData(e, 0),
                    r = new a(e, i, n);
                this._currentTileSet[t] = r
            }
            return this._currentTileSet[t]
        }, n.prototype.releaseTileTextureModel = function(e) {
            if (this._currentTileSet[e]) {
                var t = this._currentTileSet[e];
                t.release(this._mapRenderer, this._emptyTexture), delete this._currentTileSet[e]
            }
        }, n.prototype.refreshModels = function() {
            var e = r.keys(this._currentTileSet);
            r.each(e, function(e) {
                var t = this._currentTileSet[e];
                t.needsRefresh = !0
            }, this), r.each(e, function(e) {
                var t = this._currentTileSet[e];
                this._refreshTileTextureModel(t)
            }, this)
        }, n.prototype._refreshTileTextureModel = function(e) {
            if (e.tileNode.parent) {
                var t = e.tileNode.parent.tileKey,
                    i = this._currentTileSet[t];
                i && i.needsRefresh && this._refreshTileTextureModel(i)
            }
            var n = e.tileKey,
                r = this._tileTextureLoader.getTileTexture(n);
            r ? e.updateBaseTexture(r, !0, this._mapRenderer) : e.updateBaseTexture(this._emptyTexture, !1, this._mapRenderer);
            var o = this._getParentTextureData(e.tileNode, 0);
            o.isTileTexture && e.updateParentTexture(o.texture, o.isTileTexture, o.tileKey, this._mapRenderer), e.needsRefresh = !1
        }, n.prototype._generateEmptyTexture = function() {
            this._emptyTexture = this._mapRenderer.getRenderEngine().createTexture(), this._emptyTexture.magFilter = l.NearestFilter, this._emptyTexture.minFilter = l.NearestFilter, this._emptyTexture.generateMipmaps = !1, this._emptyTexture.array = {
                width: 1,
                height: 1,
                value: new Uint8Array([255, 255, 255, 255])
            }, this._emptyTexture.needsUpdate = !0
        }, n.prototype._getParentTextureData = function(e, t) {
            var i;
            if (e.parent && h > t) {
                var n = e.parent,
                    r = e.parent.tileKey,
                    o = this._currentTileSet[r];
                if (o && o.baseTextureIsTile) {
                    var a = o.baseTexture;
                    return i = {
                        texture: a,
                        isTileTexture: !0,
                        tileKey: r
                    }
                }
                return this._getParentTextureData(n, t + 1)
            }
            return i = {
                texture: this._emptyTexture,
                isTileTexture: !1,
                tileKey: null
            }
        }, n.prototype._onTileTextureLoaded = function(e, t) {
            r.each(this._currentTileSet, function(i, n) {
                if (n == e) i.updateBaseTexture(t, !0, this._mapRenderer);
                else if (null == i.parentTileKey) {
                    var r = i.ancestors[e];
                    r && i.updateParentTexture(t, !0, e, this._mapRenderer)
                } else i.parentTileKey == e && i.updateParentTexture(t, !0, e, this._mapRenderer)
            }, this)
        }, n.prototype._onTileTextureFailed = function() {}
    }, {
        "./TileTextureLoader": 382,
        "./TileTextureModel": 383,
        engine: 10,
        underscore: 207
    }],
    385: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.tileTextureData = e, this.tileKey = e.tileKey, this.is3d = t, this.numberOfFails = 0, this.nextTimeToRetry = null, this.texture = null, this._onLoadingTimeOutId = null, this._onSuccessCallback = null, this._onErrorCallback = null, this._textureLoadSuccessHandler = null
        }
        var r = e("underscore"),
            o = e("../../../utils/TileHelper"),
            a = e("engine"),
            s = a.Constants;
        t.exports = n, n.prototype.doRequest = function(e, t, i, n) {
            if (null == this.texture) {
                var a = o.getTileUrl(e, this.tileTextureData.tileCoords, this.is3d),
                    l = o.hasF4TileLayer(this.is3d) ? "tile" : "";
                this.texture = e.getRenderEngine().getTexture(a, s.ClampToEdgeWrapping, l), this.texture.useAnisotropic = !0
            }
            this._onSuccessCallback = i, this._onErrorCallback = n, this._textureLoadSuccessHandler = r.bind(this._onTextureLoadSuccess, this);
            var h = this._textureLoadSuccessHandler,
                u = r.bind(this._onTextureLoadError, this);
            if (!e.conf.get("tiles.ajaxDownload")) {
                var d = e.conf.get("tiles.loadTextureTimeout");
                this._onLoadingTimeOutId = setTimeout(u, d)
            }
            if (this.texture.onSuccess = h, this.texture.onError = u, e.conf.get("tiles.ajaxDownload")) this.texture.requestCallback = r.bind(function(i, n) {
                n.center = this.tileTextureData.center;
                var r = o.getBaseUrl(e, n.serverHost + i, this.tileTextureData.tileCoords);
                return t(r, n)
            }, this), e.getRenderEngine().askTextureToServer(this.texture);
            else {
                var c = this;
                this.onServerHostReadyRequest = e._renderEngine.onServerHostReady(this.texture.serverName, function(t) {
                    delete c.texture.onServerHostReadyRequest;
                    var i = o.getBaseUrl(e, t + c.texture.sourcePath, c.tileTextureData.tileCoords);
                    e.getRenderEngine().askTextureToServerWithImage(c.texture, i)
                })
            }
        }, n.prototype.abort = function(e) {
            this._stopLoadingTimer(), e.getRenderEngine().abortLoadingTexture(this.texture, this._textureLoadSuccessHandler), this.releaseTexture(e)
        }, n.prototype.releaseTexture = function(e) {
            this.texture && (e.getRenderEngine().releaseTexture(this.texture), this.texture = null)
        }, n.prototype._onTextureLoadSuccess = function() {
            this._stopLoadingTimer(), null != this.texture && this._onSuccessCallback(this)
        }, n.prototype._onTextureLoadError = function() {
            this._stopLoadingTimer(), this.numberOfFails++, this._onErrorCallback(this)
        }, n.prototype._stopLoadingTimer = function() {
            this._onLoadingTimeOutId && (clearTimeout(this._onLoadingTimeOutId), this._onLoadingTimeOutId = null)
        }
    }, {
        "../../../utils/TileHelper": 411,
        engine: 10,
        underscore: 207
    }],
    386: [function(e, t, i) {
        "use strict";
        for (var n = t.exports = {
                shift: 16,
                ctrl: 17,
                esc: 27,
                space: 32,
                pageup: 33,
                pagedown: 34,
                end: 35,
                home: 36,
                left: 37,
                up: 38,
                right: 39,
                down: 40,
                insert: 45,
                del: 46,
                numpad: {
                    0: 96,
                    1: 97,
                    2: 98,
                    3: 99,
                    4: 100,
                    5: 101,
                    6: 102,
                    7: 103,
                    8: 104,
                    9: 105,
                    multiply: 106,
                    plus: 107,
                    minus: 109,
                    divide: 111
                },
                pow: 222
            }, r = "A".charCodeAt(0); r <= "Z".charCodeAt(0); ++r) {
            var o = String.fromCharCode(r);
            n[o] = n[o.toLowerCase()] = r
        }
    }, {}],
    387: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.currentlyPressedKeys = {}, this.commands = {}, this.keyPressCommands = {}, this.ctrlCommands = {}, this.shiftCommands = {}, this.keyboardShortcuts = !0, this._renderer = e, this._directionalKeys = [a.left, a.right, a.up, a.down]
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("./Key"),
            s = e("util"),
            l = e("events").EventEmitter;
        t.exports = n, s.inherits(n, l);
        var h = n.prototype;
        h.onDivRemoved = function() {
            this.unbindEvents(), delete this._renderer
        }, h.bindEvents = function() {
            this._handleKeyDownHandler = r.bind(this.handleKeyDown, this), this._handleKeyUpHandler = r.bind(this.handleKeyUp, this), this._handleKeyPressHandler = r.bind(this.handleKeyPress, this), this._setAllKeyUpHandler = r.bind(this.setAllKeyUp, this), o(document).on("keydown", this._handleKeyDownHandler), o(document).on("keyup", this._handleKeyUpHandler), o(document).on("keypress", this._handleKeyPressHandler), o(window).on("blur", this._setAllKeyUpHandler)
        }, h.unbindEvents = function() {
            o(window).off("blur", this._setAllKeyUpHandler), o(document).off("keydown", this._handleKeyDownHandler), o(document).off("keyup", this._handleKeyUpHandler), o(document).off("keypress", this._handleKeyPressHandler), delete this._handleKeyDownHandler, delete this._handleKeyUpHandler, delete this._handleKeyPressHandler, delete this._setAllKeyUpHandler
        }, h.compute = function(e) {
            this._renderer && this._renderer.isFocus() && (this.currentlyPressedKeys[a.ctrl] ? this.handleCtrlKeys(e) : this.currentlyPressedKeys[a.shift] ? this.handleShiftKeys(e) : this.handleKeysNoMod(e))
        }, h.handleKeyDown = function(e) {
            this.keyboardShortcuts && (o(e.target).is("select,input,textarea,[contenteditable]") || (this._renderer && this._renderer.isFocus() && this._isDirectionalKeys(e.keyCode) && e.preventDefault(), this.emit("interactionStart"), this.currentlyPressedKeys[e.keyCode] = !0))
        }, h._isDirectionalKeys = function(e) {
            return r.some(this._directionalKeys, function(t) {
                return t == e
            })
        }, h.handleKeyUp = function(e) {
            this.emit("interactionEnd"), delete this.currentlyPressedKeys[e.keyCode]
        }, h.setAllKeyUp = function() {
            this.emit("interactionEnd"), this.currentlyPressedKeys = {}
        }, h.isLetterPressed = function(e) {
            return this.currentlyPressedKeys[e.toUpperCase().charCodeAt(0)]
        }, h.isKeyPressed = function(e) {
            return this.currentlyPressedKeys[e]
        }, h.registerCtrlCommand = function(e, t) {
            this.ctrlCommands[e] = t
        }, h.registerShiftCommand = function(e, t) {
            this.shiftCommands[e] = t
        }, h.registerCommand = function(e, t) {
            this.commands[e] = t
        }, h.registerKeyPressCommand = function(e, t) {
            this.keyPressCommands[e] = t
        }, h.handleCtrlKeys = function(e) {
            for (var t in this.currentlyPressedKeys) this.ctrlCommands[t] && this.ctrlCommands[t](e)
        }, h.handleShiftKeys = function(e) {
            for (var t in this.currentlyPressedKeys) this.shiftCommands[t] && this.shiftCommands[t](e)
        }, h.handleKeysNoMod = function(e) {
            for (var t in this.currentlyPressedKeys) this.commands[t] && this.commands[t](e)
        }, h.handleKeyPress = function(e) {
            if (this.keyboardShortcuts) {
                var t = String.fromCharCode(e.charCode).toUpperCase().charCodeAt(0);
                o(e.target).is("select,input,textarea,[contenteditable]") || this.keyPressCommands[t] && this.keyPressCommands[t]()
            }
        }
    }, {
        "./Key": 386,
        events: 99,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    388: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.renderer = e, this.$parentNode = e.$parentNode, this.$canvas = this.$parentNode.find("canvas"), this.leftDown = !1, this.rightDown = !1, this.middleDown = !1, this.mouseUpdated = !1, this._pointersInfo = {}, window.addEventListener("MSHoldVisual", function(e) {
                e.preventDefault()
            }, !1), this._isPointerTouchSupported = this.isPointerTouchSupported(), this.$canvas.on("contextmenu", function(e) {
                e.preventDefault()
            })
        }

        function r(e) {
            var t, i, n = 0,
                r = !1;
            return function(o) {
                return o.preventDefault(), r && Math.abs(o.screenX - t) <= c && Math.abs(o.screenY - i) <= c ? (clearTimeout(n), r = !1, e.apply(this, arguments)) : (r = !0, t = o.screenX, i = o.screenY, n = setTimeout(function() {
                    r = !1
                }, d), void 0)
            }
        }
        var o = e("underscore"),
            a = e("jquery"),
            s = e("util"),
            l = e("events").EventEmitter,
            h = e("browser-detect"),
            u = !0,
            d = 300,
            c = 4;
        t.exports = n, s.inherits(n, l);
        var f = n.prototype;
        f.bindEvents = function() {
            var e = this;
            this.renderer.conf.get("enableWebGL") && (this.bindMouseNotDraggingEvent(), this._isPointerTouchSupported ? (this.$canvas.on("pointerdown", o.bind(this.onPointerDown, this)), this.$canvas.on("lostpointercapture", o.bind(this.onPointerLostCapture, this)), this.$canvas.on("pointerout", o.bind(this.onPointerLostCapture, this)), this.$canvas.on("pointerleave", o.bind(this.onPointerLostCapture, this)), this.$canvas.on("pointercancel", o.bind(this.onPointerLostCapture, this))) : this.$canvas.on("mousedown", o.bind(this.onMouseDown, this)), this.$canvas.on("dblclick", o.bind(this.onMouseDoubleClick, this)), this.$canvas.on("contextmenu", r(o.bind(this.onMouseDoubleRightClick, this))), this.renderer.conf.get("draggable") && (this._isPointerTouchSupported || (this.$canvas.on("touchstart", o.bind(this.onTouchStart, this)), this.$canvas.on("touchmove", o.bind(this.onTouchMove, this)), this.$canvas.on("touchend", o.bind(this.onTouchEnd, this)), this.$canvas.on("touchmove", function(t) {
                (e.renderer.conf.get("draggableTouch") || e.isMultiTouch) && t.preventDefault()
            }))), this._updateBindScrollWheel())
        }, f.setDraggableTouch = function(e) {
            this.renderer.conf.set("draggableTouch", e)
        }, f.setScrollWheel = function(e) {
            this.renderer.conf.set("scrollwheel", e), this._updateBindScrollWheel()
        }, f._updateBindScrollWheel = function() {
            this.renderer.conf.get("scrollwheel") ? null == this._onMouseWheelHandler && (this._onMouseWheelHandler = o.bind(this.onMouseWheel, this), this.$canvas.on("mousewheel", this._onMouseWheelHandler), this.$canvas.on("DOMMouseScroll", this._onMouseWheelHandler)) : this._onMouseWheelHandler && (this.$canvas.off("mousewheel", this._onMouseWheelHandler), this.$canvas.off("DOMMouseScroll", this._onMouseWheelHandler), delete this._onMouseWheelHandler)
        }, f.isDragging = function() {
            return this._hasMovedSinceMouseDown || this._isTouchingScreen
        }, f.isPointerTouchSupported = function() {
            return (h.isMSIE() || this.isEdge()) && (navigator.msMaxTouchPoints > 0 || navigator.maxTouchPoints > 0)
        }, f.isEdge = function() {
            return /Edge\/\d+/.test(navigator.userAgent)
        }, f.onDivRemoved = function() {
            this._isPointerTouchSupported ? (this.$canvas.off("pointermove.notdraggingmap"), this.$canvas.off("pointerup.notdraggingmap"), a(document).off("pointermove.dragmap"), a(document).off("pointerup.dragmap")) : (this.$canvas.off("touchstart"), this.$canvas.off("touchmove"), this.$canvas.off("touchend"), this.$canvas.off("mouseout"), this.$canvas.off("mouseover"), this.$canvas.off("mousemove.notdraggingmap"), this.$canvas.off("mouseup.notdraggingmap"), this.$canvas.off("mousedown"), a(document).off("mousemove.dragmap"), a(document).off("mouseup.dragmap")), this.$canvas.off("contextmenu"), this.$canvas.off("mousewheel"), this.$canvas.off("DOMMouseScroll"), this.$canvas.off("dblclick"), delete this.renderer
        }, f.bindMouseNotDraggingEvent = function() {
            this.renderer.conf.get("draggable") && (this._isPointerTouchSupported ? (this.$canvas.off("pointermove.notdraggingmap"), this.$canvas.on("pointermove.notdraggingmap", o.bind(this.onPointerMove, this)), this.$canvas.on("pointerup.notdraggingmap", o.bind(this.onPointerUp, this)), a(document).off("pointermove.dragmap"), a(document).off("pointerup.dragmap")) : (this.$canvas.on("mouseout", o.bind(this.emit, this, "mouseout")), this.$canvas.on("mouseover", o.bind(this.emit, this, "mouseover")), this.$canvas.off("mousemove.notdraggingmap"), this.$canvas.on("mousemove.notdraggingmap", o.bind(this.onMouseMove, this)), this.$canvas.on("mouseup.notdraggingmap", o.bind(this.onMouseUp, this)),
                a(document).off("mousemove.dragmap"), a(document).off("mouseup.dragmap")), o.defer(function() {
                a("body").off("contextmenu")
            }), this._isDraggingWithMouse = !1, this._hasMovedSinceMouseDown = !1, this.emit("interactionEnd"))
        }, f.bindMouseDraggingEvent = function() {
            if (this.renderer.conf.get("enableWebGL") && this.renderer.conf.get("draggable")) {
                this._isPointerTouchSupported || (this.$canvas.off("mouseup.notdraggingmap"), this.$canvas.off("mousemove.notdraggingmap"), a(document).on("mousemove.dragmap", o.bind(this.onMouseDrag, this)), a(document).on("mouseup.dragmap", o.bind(this.onMouseDragUp, this))), this.emit("interactionStart"), this._isDraggingWithMouse = !0;
                var e = this;
                o.defer(function() {
                    a("body").on("contextmenu", o.bind(e.onContextMenu, e))
                })
            }
        }, f.onContextMenu = function(e) {
            return e.preventDefault(), e.stopPropagation(), !0
        }, f.resetButtons = function() {
            this.leftDown = !1, this.rightDown = !1, this.middleDown = !1
        }, f.onPointerOut = function(e) {
            this.onPointerUpChanged(e), this.emit("mouseout", e)
        }, f.onPointerOver = function(e) {
            this.onPointerMoveChanged(e), this.emit("mouseover", e)
        }, f.onPointerLostCapture = function(e) {
            e.buttons && this.onPointerUpChanged(e)
        }, f.getNbrTouchType = function(e) {
            var t = 0;
            return o.each(this._pointersInfo, function(i) {
                i = i.originalEvent || i, i.pointerType == e && ++t
            }), t
        }, f.onPointerDown = function(e) {
            e = e.originalEvent || e, this.mouseDownEvent = e, this.onPointerDownChanged(e);
            var t = e.originalEvent || e;
            switch (t.pointerType) {
                case "touch":
                    this.onTouchStart(e);
                    break;
                case "pen":
                    this.onTouchStart(e);
                    break;
                case "mouse":
                    this.onMouseDown(e)
            }
        }, f.onPointerUp = function(e) {
            this.onPointerUpChanged(e);
            var t = e.originalEvent || e;
            switch (t.pointerType) {
                case "touch":
                    this.onTouchEnd(e);
                    break;
                case "pen":
                    this.onTouchEnd(e);
                    break;
                case "mouse":
                    this.onMouseUp(e)
            }
        }, f.onPointerMove = function(e) {
            var t = e.originalEvent || e;
            switch (t.pointerType) {
                case "touch":
                    this.onPointerMoveChanged(e), this.onTouchMove(e);
                    break;
                case "pen":
                    this.onPointerMoveChanged(e), this.onTouchMove(e);
                    break;
                case "mouse":
                    this.onMouseMove(e)
            }
            this.cleanupPointerMoveChanged(e)
        }, f.onPointerDownChanged = function(e) {
            e = e.originalEvent || e, this._pointersInfo[e.pointerId] = e
        }, f.cleanupPointerMoveChanged = function(e) {
            e = e.originalEvent || e, -1 == e.button && 0 == e.buttons && delete this._pointersInfo[e.pointerId]
        }, f.onPointerMoveChanged = function(e) {
            e = e.originalEvent || e, this._pointersInfo[e.pointerId] = e
        }, f.onPointerUpChanged = function(e) {
            e = e.originalEvent || e, delete this._pointersInfo[e.pointerId]
        }, f.onMouseDown = function(e) {
            this.pauseEvent(e), this._hasMovedSinceMouseDown = !1;
            var t = e.button;
            0 == t ? this.leftDown = !0 : 1 == t ? this.middleDown = !0 : 2 == t && (this.rightDown = !0), this._dragClass && this.$parentNode.removeClass(this._dragClass), this._dragClass = this.leftDown ? "left-dragging" : this.rightDown ? "right-dragging" : null, this._dragClass && this.$parentNode.addClass(this._dragClass), this.$canvas.addClass("dragging"), this.addMousePosToEvent(e), this.mouseDownEvent = e, this.emit("mousedown", e), this.leftDown && this.emit("leftDown", e), this.rightDown && this.emit("rightDown", e)
        }, f.onMouseUp = function(e) {
            var t = e.originalEvent || e;
            e.isPropagationStopped() || t.defaultPrevented || this.handleReleasedOn(e)
        }, f.onMouseDragUp = function(e) {
            var t = e.originalEvent || e;
            e.isPropagationStopped() || t.defaultPrevented || this.handleReleasedOn(e)
        }, f.pauseEvent = function(e) {
            this.renderer && this.renderer.isFocus() && (e.stopPropagation && e.stopPropagation(), e.preventDefault && e.preventDefault(), e.cancelBubble = !0, e.returnValue = !1)
        }, f.onMouseDrag = function(e) {
            this.pauseEvent(e), this.handleMoveTo(e, !0)
        }, f.onMouseDoubleClick = function(e) {
            this.addMousePosToEvent(e), this.emit("doubleClick", e), this.emit("dblclick", e), this.resetButtons()
        }, f.onMouseDoubleRightClick = function(e) {
            e.type = "dblclick", this.addMousePosToEvent(e), this.emit("dblclick", e), this.resetButtons()
        }, f.touchDistance = function(e, t) {
            var i = e.clientX - t.clientX,
                n = e.clientY - t.clientY;
            return Math.sqrt(i * i + n * n)
        }, f.pinchPixelToZoomValue = function(e) {
            var t = a(window).width(),
                i = a(window).height(),
                n = Math.sqrt(t * t + i * i);
            return e / n * 4096
        }, f.cloneTouches = function(e) {
            var t;
            t = this._isPointerTouchSupported ? this._pointersInfo : e.originalEvent ? e.originalEvent.touches : e.touches;
            var i = o.map(t, function(t) {
                return {
                    clientX: t.clientX,
                    clientY: t.clientY,
                    type: e.type,
                    identifier: t.identifier
                }
            });
            return i = o.sortBy(i, "identifier")
        }, f.sendInteractionStart = function() {
            this.emit("interactionStart")
        }, f.onTouchStart = function(e) {
            if (this.renderer.conf.get("draggable")) {
                this.addMousePosToEvent(e), this.rightDown = !1;
                var t = this.cloneTouches(e);
                if (this.previousTouch && this.renderer.sendToCamera("multitouchEnd", t), this.startTouchEvent = o.clone(t[0]), this.renderer.sendToCamera("multitouchStart", t), this.previousTouch = t, this.sendInteractionStart(), this._isTouchingScreen = !0, u && 1 == t.length) {
                    this._hasMovedSinceMouseDown = !1;
                    var i = t[0];
                    i.originalEvent = e, this.emit("leftDown", i), this.isMultiTouch = !1
                } else this.isMultiTouch = !0;
                (this.renderer.conf.get("draggableTouch") || this.isMultiTouch) && (e.stopPropagation(), e.preventDefault())
            }
        }, f.hasTouchMoved = function() {
            return this._hasMovedSinceMouseDown
        }, f.onTouchMove = function(e) {
            if (this.renderer.conf.get("draggable") && this.startTouchEvent) {
                this.addMousePosToEvent(e), this.rightDown = !1;
                var t = this.cloneTouches(e);
                if (u && !this.isMultiTouch && this.previousTouch && 1 == this.previousTouch.length && 1 == t.length) {
                    var i = t[0];
                    i.type = e.type, i.originalEvent = e.originalEvent || e, i.deltaXY = {
                        x: this.previousTouch[0].clientX - i.clientX,
                        y: this.previousTouch[0].clientY - i.clientY
                    }, Math.abs(this.startTouchEvent.clientX - i.clientX) > 10 || Math.abs(this.startTouchEvent.clientY - i.clientY) > 10 || this._hasMovedSinceMouseDown ? this._hasMovedSinceMouseDown || (this._hasMovedSinceMouseDown = !0, this.bindMouseDraggingEvent()) : (i.deltaXY.x = 0, i.deltaXY.y = 0), this.renderer.conf.get("draggableTouch") ? this.emit("leftDrag", i) : this.emit("touchDragForcedStart")
                } else t.length > 1 && (this.isMultiTouch = !0, this.renderer.sendToCamera("multitouchMove", this.previousTouch, t), this.renderer.conf.get("draggableTouch") || this.emit("touchDragForcedStop"));
                this.previousTouch = t
            }
        }, f.onTouchEnd = function(e) {
            if (this.renderer.conf.get("draggable") && this.startTouchEvent) {
                this.addMousePosToEvent(e);
                var t = this.cloneTouches(e);
                if (0 == t.length) {
                    if (u && !this.isMultiTouch && this.previousTouch && 1 == this.previousTouch.length && 0 == t.length) {
                        var i = this.previousTouch[0];
                        if (i.type = e.type, i.originalEvent = e.originalEvent || e, this._hasMovedSinceMouseDown) this.bindMouseNotDraggingEvent(), this.emit("dragStop", i);
                        else {
                            var n = i.originalEvent || i;
                            n.stopPropagation(), n.preventDefault(), this.emit("click", i)
                        }
                    }
                    this.renderer.sendToCamera("multitouchEnd", t), delete this.startTouchEvent, delete this.previousTouch, this.emit("interactionEnd"), this._isTouchingScreen = !1, this.isMultiTouch = !1
                } else delete this.previousTouch, 1 == t.length && (this.isMultiTouch = !1)
            }
            this.renderer.conf.get("draggableTouch") || this.emit("touchDragForcedStop")
        }, f.onMouseMove = function(e) {
            this.handleMoveTo(e, this._isDraggingWithMouse), e.preventDefault(), e.stopPropagation()
        }, f.handleReleasedOn = function(e) {
            delete this.mouseDownEvent;
            var t = e.button;
            this._dragClass && this.$parentNode.removeClass(this._dragClass), delete this._dragClass, this.$canvas.removeClass("dragging"), 0 == t ? this.leftDown = !1 : 1 == t ? this.middleDown = !1 : 2 == t && (this.rightDown = !1), this.addMousePosToEvent(e), this.emit("mouseup", e), this._hasMovedSinceMouseDown ? (this.bindMouseNotDraggingEvent(), this.emit("dragStop", e)) : 0 == t ? this.emit("click", e) : 2 == t && this.emit("rightclick", e), this.renderer.conf.get("draggableTouch") || this.emit("touchDragForcedStop")
        }, f.computeMouseDeltaX = function(e) {
            null == this.old_mouseX_for_ie && (this.old_mouseX_for_ie = e.clientX);
            var t = this.old_mouseX_for_ie - e.clientX;
            return this.old_mouseX_for_ie = e.clientX, t
        }, f.computeMouseDeltaY = function(e) {
            null == this.old_mouseY_for_ie && (this.old_mouseY_for_ie = e.clientY);
            var t = this.old_mouseY_for_ie - e.clientY;
            return this.old_mouseY_for_ie = e.clientY, t
        }, f.addMousePosToEvent = function(e) {
            var t = e.originalEvent ? e.originalEvent : e;
            null == this.old_mouseX_for_ie && (this.old_mouseX_for_ie = e.clientX);
            var i = this.old_mouseX_for_ie - e.clientX;
            this.old_mouseX_for_ie = e.clientX, t.movementX ? i = -t.movementX : null != t.mozMovementX ? i = -t.mozMovementX : null != t.webkitMovementX && (i = -t.webkitMovementX), null == this.old_mouseY_for_ie && (this.old_mouseY_for_ie = e.clientY);
            var n = this.old_mouseY_for_ie - e.clientY;
            this.old_mouseY_for_ie = e.clientY, t.movementY ? n = -t.movementY : null != t.mozMovementY ? n = -t.mozMovementY : null != t.webkitMovementY && (n = -t.webkitMovementY), e.deltaXY = {
                x: i,
                y: n
            }
        }, f.handleMoveTo = function(e, t) {
            if (this.addMousePosToEvent(e), 0 != e.deltaXY.x || 0 != e.deltaXY.y) {
                this.updateButtonDownFromMouseEvent(e), this.isMouseMoving = !0;
                var i = this.renderer.map.minMouseMoveBeforeDragInPixels || 0;
                this.mouseDownEvent && !this._hasMovedSinceMouseDown && (Math.abs(e.clientX - this.mouseDownEvent.clientX) > i || Math.abs(e.clientY - this.mouseDownEvent.clientY) > i) && (this._hasMovedSinceMouseDown = !0, this.bindMouseDraggingEvent()), t |= this._isDraggingWithMouse, t || this.emit("mousemove", e), t && (this.leftDown && this.emit("leftDrag", e), this.middleDown && this.emit("middleDrag", e), this.rightDown && this.emit("rightDrag", e))
            }
        }, f.updateButtonDownFromMouseEvent = function(e) {
            "buttons" in e && void 0 !== e.buttons && (this.leftDown = (1 & e.buttons) > 0, this.rightDown = (2 & e.buttons) > 0, this.middleDown = (4 & e.buttons) > 0)
        }, f.onMouseWheel = function(e) {
            if (e.originalEvent) {
                var t = e.originalEvent.wheelDelta;
                null == t && (t = -40 * e.originalEvent.detail), e.delta = t, this.addMousePosToEvent(e)
            } else e.delta = e.wheelDelta;
            Math.abs(e.delta) > 5 && this.emit("wheel", e), e.preventDefault()
        }
    }, {
        "browser-detect": 4,
        events: 99,
        jquery: 111,
        underscore: 207,
        util: 212
    }],
    389: [function(e, t, i) {
        "use strict";

        function n() {
            d = l("#f4map-centered-dialog"), 0 == d.length && (d = l(s()), d.hide(), d.appendTo(l(".f4map")), d.find("#f4map-centered-dialog-background").on("click", r), d.find("#f4map-centered-dialog-close").on("click", r), l(window).on("keydown.esc", r)), c = d.find("#f4map-centered-dialog-content")
        }

        function r() {
            h && h(), o()
        }

        function o() {
            c || n(), c.children().detach(), c.empty(), d.hide(), u && d.removeClass(u), u = null, h = null
        }

        function a(e, t, i) {
            c || n(), o(), i && (d.addClass(i), u = i), h = t, c.empty().append(e), d.show()
        }
        var s = e("../../templates/centeredDialog.jade"),
            l = e("jquery"),
            h = null,
            u = null,
            d = null,
            c = null;
        t.exports = {
            initialize: n,
            open: a,
            close: o
        }
    }, {
        "../../templates/centeredDialog.jade": 428,
        jquery: 111
    }],
    390: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.map = e, this.$parentNode = t, this._loadingCounter = 0, this._computing = !1, this._displayed = !1, this._hideTimeout = null, this.$element = null, this.hideCallback = r.bind(this.hide, this)
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("../../../viewer/templates/generalSpinner.jade"),
            s = e("../translation");
        t.exports = n, n.prototype.incLoading = function() {
            0 == this._loadingCounter++ && this.updateSpinner()
        }, n.prototype.decLoading = function() {
            --this._loadingCounter, 0 == this._loadingCounter && this.updateSpinner()
        }, n.prototype.setComputing = function(e) {
            this._computing = Boolean(e), this.updateSpinner()
        }, n.prototype.initializeInterface = function() {
            this.clearInterface(), this.map.conf.get("ui.enableLoadingSpinner") && (this.$element = o(a({
                t: s.t
            })).appendTo(this.$parentNode), this.$loadingMessage = this.$element.find(".f4map-general-spinner-loading"), this.$computingMessage = this.$element.find(".f4map-general-spinner-computing"), this._displayed = !1, this.updateSpinner())
        }, n.prototype.hide = function() {
            this.$element.hide()
        }, n.prototype.updateSpinner = function() {
            if (this.map.conf.get("ui.enableLoadingSpinner") && this.$element) {
                var e = !1;
                this._loadingCounter > 0 ? (e = !0, this.$computingMessage.hide(), this.$loadingMessage.show()) : this._computing && (e = !0, this.$loadingMessage.hide(), this.$computingMessage.show()), this._displayed != e && (this._displayed = e, e ? (this.$element.show(), this.clearHideTimeout()) : this._hideTimeout = window.setTimeout(this.hideCallback, 600))
            }
        }, n.prototype.clearHideTimeout = function() {
            null != this._hideTimeout && (window.clearTimeout(this._hideTimeout), delete this._hideTimeout)
        }, n.prototype.clearInterface = function() {
            this.$element && (this.$element.remove(), delete this.$element), this.clearHideTimeout()
        }
    }, {
        "../../../viewer/templates/generalSpinner.jade": 431,
        "../translation": 396,
        jquery: 111,
        underscore: 207
    }],
    391: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.map = e, this.$mapContainer = e._renderer.$parentNode, this.visible = !1, this.position = new s, this._insertElement(), this.map._renderer.on("cameraChanged", r.bind(this.move, this))
        }
        var r = e("underscore"),
            o = e("jquery"),
            a = e("../../templates/infoWindow.jade"),
            s = e("engine").Vector3,
            l = e("../utils/LocationHelper"),
            h = e("../api/Marker");
        t.exports = n;
        var u = 50,
            d = 300,
            c = 700,
            f = 700,
            p = n.prototype;
        p.open = function(e) {
            function t(e) {
                e.stopPropagation()
            }
            this.infoWindow = e, this.$container = o(a());
            var i;
            if (e.content.jquery) i = e.content;
            else try {
                i = o.parseHTML(e.content)
            } catch (n) {
                i = o("<div>").text(e.content)
            }
            var s, l, h = this.$mapContainer.width();
            e.maxWidth ? (s = 30, l = +e.maxWidth) : (s = d, l = Math.min(Math.max(h - 2 * u, d), c)), e.minWidth && (s = +e.minWidth);
            var p = Math.max(this.$mapContainer.height() - 2 * u, f),
                m = this.$container.find(".f4map-infoWindowContent");
            m.append(i), this.$container.on("click", ".f4map-btnCloseInfoWindow", r.bind(this.onCloseButtonClicked, this)), this.$container.on("mousewheel mousedown dblclick", t), this.$container.css({
                minWidth: s + "px",
                maxWidth: l + "px",
                maxHeight: p + "px"
            }), m.css({
                maxHeight: p - 50 + "px"
            }), this.visible || (this.visible = !0, this.map._renderer.createPopup(this), this._insertElement()), this.move();
            var g = this.$container.outerWidth(),
                _ = g / 2;
            this.$container.css({
                width: g + "px",
                left: -_ + "px"
            });
            var v = this.$container.find(".f4map-arrow"),
                y = this.getPosition2D(),
                b = this.$container.outerHeight() + v.outerHeight(),
                x = 0;
            b > y.y && (x = -(b - y.y + u));
            var w = 0;
            _ > y.x ? w = -(_ - y.x + u) : y.x + _ > h && (w = y.x + _ - h + u), this.map.panBy(w, x)
        }, p.onCloseButtonClicked = function() {
            this.infoWindow.emit("closeclick"), this.infoWindow.setMap(null)
        }, p.hide = function() {
            this.visible && (this.map.conf.updateHref(), this.visible && (this.visible = !1, this.$container.detach(), this.div3d && (this.div3d.remove(), delete this.div3d), this.popup2d && delete this.popup2d)), this.infoWindow = null
        }, p.getPosition2D = function() {
            var e = this.infoWindow.anchor,
                t = e || this.infoWindow,
                i = t.getPosition()._to900913(),
                n = e && r.isFunction(e.getHeight) ? e.getHeight() : 0;
            this.position.set(i.lon, i.lat, n);
            var o = this.map._renderer.computeScreenPosInPixels(this.position);
            if (e && e instanceof h && this.map) {
                var a = this.map._getPinFromMarker(e);
                if (a) {
                    var s = a.getSize2D(),
                        l = a.getAnchor();
                    o.x += s.width / 2 - l.x, o.y -= l.y
                }
            }
            return this._applyPixelOffset(o), o
        }, p._applyPixelOffset = function(e) {
            var t = this.infoWindow.getPixelOffset();
            t && (e.x += t.width, e.y += t.height)
        }, p.move = function() {
            if (this.popup2d) this.popup2d.setLatLng(l.convert900913to4326({
                lon: this.position.x,
                lat: this.position.y
            }));
            else if (this.div3d) {
                var e = this.getPosition2D();
                this.div3d.css({
                    top: e.y,
                    left: e.x
                })
            }
        }, p._insertElement = function() {
            this.div3d && this.div3d.append(this.$container), this.popup2d && this.$container.appendTo(this.popup2d.div)
        }
    }, {
        "../../templates/infoWindow.jade": 432,
        "../api/Marker": 241,
        "../utils/LocationHelper": 407,
        engine: 10,
        jquery: 111,
        underscore: 207
    }],
    392: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("jquery"),
            o = e("../utils/LocationHelper"),
            a = e("../translation"),
            s = e("engine").MathHelper,
            l = e("./OsmSync"),
            h = e("./CenteredDialog"),
            u = e("../../templates/mapOverlay.jade"),
            d = e("../../templates/mapFooter.jade"),
            c = e("../../templates/mapFooterNoDefaultAttribution.jade"),
            f = e("../../templates/credits.jade"),
            p = e("../api/ControlPosition"),
            m = e("engine"),
            g = m.Vector2;
        t.exports = function(e, t) {
            function i(t) {
                e.lookAtNorth(), t.stopPropagation(), t.preventDefault()
            }

            function m() {
                if (e.map) {
                    var t = s.degToRad(e.getCurrentCameraConfiguration().camera.phi),
                        i = 0;
                    D ? i = Math.atan2(Math.sin(t - D), Math.cos(t - D)) : D = t;
                    var n = "rotate3d(0,0,1," + (D + i) + "rad)";
                    W.css({
                        "-moz-transform": n,
                        "-webkit-transform": n,
                        "-o-transform": n,
                        "-ms-transform": n
                    }), D += i
                }
            }

            function _(t) {
                function i(t) {
                    var i = t.coords,
                        n = o.convert4326to900913({
                            lon: i.longitude,
                            lat: i.latitude
                        }),
                        r = Math.min(1e4, i.accuracy) || 100,
                        a = {
                            left: n.lon - r,
                            right: n.lon + r,
                            top: n.lat + r,
                            bottom: n.lat - r
                        };
                    e.fitBounds(a, e.makeIdleEvent(!0))
                }

                function n(e) {
                    switch (e.code) {
                        case e.PERMISSION_DENIED:
                            alert("Vous n'avez pas autorisÃ© l'accÃ¨s Ã  votre position.");
                            break;
                        case e.POSITION_UNAVAILABLE:
                            alert("Votre emplacement n'a pas pu Ãªtre dÃ©terminÃ©.");
                            break;
                        case e.TIMEOUT:
                            alert("Le service n'a pas rÃ©pondu Ã  temps.")
                    }
                }
                G.hasClass("f4map-disabled") || (ie && ie.onGeolocClickedCallback ? ie.onGeolocClickedCallback() : (navigator.geolocation.getCurrentPosition(i, n, {
                    enableHighAccuracy: !0
                }), t.stopPropagation(), t.preventDefault()))
            }

            function v() {
                ie.getScaleControl() ? (ie.on("idle", w), ie.on("zoom_changed", w), J.show(), w()) : J.hide()
            }

            function y() {
                e.sendToCamera("zoomIn"), x()
            }

            function b() {
                e.sendToCamera("zoomOut"), x()
            }

            function x() {
                var e = ie.conf.get("camera.defaultZoomMin"),
                    t = ie.conf.get("camera.zoomMax");
                V.toggleClass("f4map-disabled", ie.zoom <= e), q.toggleClass("f4map-disabled", ie.zoom >= t)
            }

            function w() {
                if (J && J.length) {
                    var t = J.offset(),
                        i = ie._$node.offset(),
                        n = {
                            left: t.left - i.left,
                            top: t.top - i.top
                        },
                        r = J.width(),
                        a = ne.get("mapScale.width"),
                        s = new g(n.left + r - a, n.top),
                        l = J.height(),
                        h = s.y + .5 * l,
                        u = new g(s.x, h),
                        d = new g(u.x + a, h),
                        c = e.computeLonLatFromPixel(u),
                        f = e.computeLonLatFromPixel(d),
                        p = new g(c.lon, c.lat),
                        m = new g(f.lon, f.lat),
                        _ = p.distanceTo(m);
                    _ /= o.getScaleFromLatitude(.5 * (p.y + m.y));
                    for (var v = ne.get("mapScale.roundTable"), y = _, b = 1; b < v.length; ++b)
                        if (_ > v[b]) {
                            y = v[b], J.css({
                                width: y / _ * a
                            }), y = v[b];
                            break
                        }
                    var x = "km";
                    y >= 1e3 ? y /= 1e3 : x = "m", J.text(y + x)
                }
            }

            function M() {
                Q || (Q = r(f({
                    t: a.t
                }))), h.open(Q)
            }

            function T(e) {
                Y.prop("checked") ? C(e) : S(e)
            }

            function S(t) {
                e.enter2dMode(), t.stopPropagation(), t.preventDefault()
            }

            function C(t) {
                e.enter3dMode(), t.stopPropagation(), t.preventDefault()
            }

            function E() {
                var t = Boolean(ne.get("ui.touch"));
                e.$parentNode.toggleClass("f4map-touch", t)
            }

            function k(e) {
                e.stopPropagation()
            }

            function L() {
                var t = Boolean(e.isIn3d());
                O.toggleClass("f4map-disabled", !t), N.toggleClass("f4map-disabled", !t), Y.prop("checked", t);
                var i = Boolean(e.canSwitchBetween3dAnd2d());
                Z.toggleClass("f4map-disabled", !i), ne.get("enableWebGL") || (Z.hide(), O.hide(), N.hide(), r(".f4map-nav").addClass("f4-map-nav-margin"))
            }

            function P(e, t) {
                function i(t) {
                    function i(i) {
                        u = !1, s != f && (r(), s = f), h || (d = Date.now(), c = 0, "zoomIn" != t && "zoomOut" != t ? h = window.setInterval(n, o) : e.sendToCamera(t)), i.stopPropagation(), i.preventDefault()
                    }

                    function n() {
                        var i = Date.now(),
                            n = i - d;
                        c += n, e.sendToCamera(t, n), d = i
                    }

                    function l() {
                        function e() {
                            u && (window.clearInterval(h), h = null)
                        }
                        if (!u) {
                            u = !0;
                            var t = a - c;
                            0 >= t ? e() : window.setTimeout(e, t)
                        }
                    }
                    var h = null,
                        u = !1,
                        d = null,
                        c = 0,
                        f = {
                            start: i,
                            send: n,
                            stop: l
                        };
                    return f
                }

                function r(t) {
                    s && (s.stop(), s = null), t && (e.isDragging() || (t.stopPropagation(), t.preventDefault()))
                }
                var o = e.conf.get("ui.buttonActionSamplingInMs"),
                    a = e.conf.get("ui.minButtonActionDurationInMs"),
                    s = null;
                n.each(t, function(e) {
                    var t = e[1],
                        o = i(t),
                        a = e[0];
                    a.on("mousedown", n.bind(o.start, o)), a.on("mouseup", r), a.on("mouseleave", r), a.on("dblclick", k)
                })
            }

            function A(e) {
                n.each(e, function(e) {
                    var t = e[0];
                    t.off("mousedown"), t.off("mouseup"), t.off("mouseleave"), t.off("dblclick")
                })
            }
            var R = [],
                D = null,
                I = !1,
                O = null,
                N = null,
                B = null,
                F = null,
                z = null,
                H = null,
                U = null,
                W = null,
                G = null,
                j = null,
                q = null,
                V = null,
                Z = null,
                Y = null,
                K = null,
                X = null,
                $ = null,
                Q = null,
                J = null,
                ee = null,
                te = null,
                ie = e.map,
                ne = e.conf;
            this.init = function() {
                if (this.clear(), !I) {
                    if (I = !0, te = r(u({
                            t: a.t
                        })), t.append(te), ee = r(c()), ie.getAttribution()) {
                        t.append(ee);
                        var o = r(".f4map-footer-text");
                        o.empty().append(r(ie.getAttribution()))
                    } else t.append(d({
                        t: a.t
                    }));
                    O = t.find(".f4map-compass"), N = t.find(".f4map-3D-2D"), B = t.find(".f4map-compass-left"), F = t.find(".f4map-compass-right"), z = t.find(".f4map-3D-2D-to2D"), H = t.find(".f4map-3D-2D-to3D"), U = t.find(".f4map-compass-center"), W = t.find(".f4map-compass-needle"), G = t.find(".f4map-geoloc"), j = t.find(".f4map-zoom"), q = t.find(".f4map-zoomin"), V = t.find(".f4map-zoomout"), Z = t.find(".f4map-mode"), Y = t.find(".f4map-mode-3d"), K = t.find(".f4map-footer"), X = t.find(".f4map-osm-sync"), $ = t.find(".f4map-credits"), J = r(".f4map-scale", ie._$node), Q = null, R = [q, V, O, z, H, Y, Z], E(e), l.init(e, X), K.on("mousedown", k), $.on("click", M), q.on("click", y), V.on("click", b), e.on("enter3d", L), e.on("enter2d", L), P(e, [
                        [B, "turnLeft"],
                        [F, "turnRight"],
                        [z, "turnUp"],
                        [H, "turnDown"]
                    ]);
                    var s = ne.get("zoomControl");
                    j.toggle(s), q.toggle(s), V.toggle(s), ne.get("enableWebGL") && (U.on("click", i), e.on("cameraChanged", n.throttle(m, 100))), n.each(R, function(t) {
                        t.on("mousemove mousedown mouseup click touchstart touchmove touchend", function(t) {
                            e.isDragging() || t.stopPropagation()
                        })
                    }), ne.on("change:ui.touch", E);
                    var h = Boolean(ne.get("ui.enableGeoloc") && navigator.geolocation);
                    h ? (G.show(), G.on("click", _)) : G.hide(), Y.on("change", T), L(), ie.on("scalecontrol_changed", v), v(), ie.on("zoom_changed", x), x()
                }
            }, this.clear = function() {
                I && (I = !1, n.each(R, function(e) {
                    e.off("mousemove mousedown mouseup click touchstart touchmove touchend")
                }), A([
                    [B, "turnLeft"],
                    [F, "turnRight"],
                    [z, "turnUp"],
                    [H, "turnDown"]
                ]), ne.removeListener("change:ui.touch", E), e.removeListener("enter3d", L), e.removeListener("enter2d", L), q.off("click", y), V.off("click", b), G.off("click", _), $.off("click", M), Y.off("change", T), K.off("mousedown", k), U.off("click", i), ie.removeListener("idle", w), ie.removeListener("zoom_changed", w), ie.removeListener("scalecontrol_changed", v), ie.removeListener("zoom_changed", x), ee.remove(), te.remove(), l.clear(), K.remove())
            }, this.setMapTypeControlOptions = function(e) {
                e.position == p.TOP_LEFT && t.addClass("f4-map-control-topleft")
            }, this.init()
        }
    }, {
        "../../templates/credits.jade": 429,
        "../../templates/mapFooter.jade": 433,
        "../../templates/mapFooterNoDefaultAttribution.jade": 434,
        "../../templates/mapOverlay.jade": 435,
        "../api/ControlPosition": 225,
        "../translation": 396,
        "../utils/LocationHelper": 407,
        "./CenteredDialog": 389,
        "./OsmSync": 393,
        engine: 10,
        jquery: 111,
        underscore: 207
    }],
    393: [function(e, t, i) {
        "use strict";

        function n() {
            null != u && (clearTimeout(u), u = null), d && d.hide()
        }

        function r(e, t) {
            n(), d = t, c = d.find(".f4map-osm-sync-date"), c.length > 0 && e.conf.get("ui.showOsmSync") ? (a("...", ""), o(), u = setTimeout(o, 6e4)) : d.hide()
        }

        function o() {
            l.download("osmsync", {
                url: "/state.json",
                type: "GET",
                dataType: "json",
                callback: function(e, t) {
                    if (e) a("?", "OsmSync error: " + e);
                    else {
                        var i = s(t.timestamp).fromNow(),
                            n = h + "\n" + t.timestamp;
                        a(i, n)
                    }
                }
            })
        }

        function a(e, t) {
            d.attr("title", t), c.text(e + "")
        }
        var s = e("../utils/moment"),
            l = e("../utils/Ajax"),
            h = "OSM data synchronization",
            u = null,
            d = null,
            c = null;
        t.exports = {
            init: r,
            clear: n
        }
    }, {
        "../utils/Ajax": 397,
        "../utils/moment": 420
    }],
    394: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }
        var r = function() {
                function e(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var n = t[i];
                        n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                    }
                }
                return function(t, i, n) {
                    return i && e(t.prototype, i), n && e(t, n), t
                }
            }(),
            o = e("jquery"),
            a = e("../../templates/touchDragDialog.jade"),
            s = 500;
        t.exports = function() {
            function e(t) {
                n(this, e), this._$map = o(t.getDiv())
            }
            return r(e, [{
                key: "setTranslation",
                value: function(e) {
                    null == this._t && (this._t = e, this._visible && this._showDialog())
                }
            }, {
                key: "show",
                value: function() {
                    this._visible || (this._visible = !0, this._showDialog())
                }
            }, {
                key: "hide",
                value: function() {
                    var e = this;
                    this._visible && (this._visible = !1, this._startTimeout(function() {
                        e._hideDialog()
                    }))
                }
            }, {
                key: "_showDialog",
                value: function() {
                    this._stopTimeout(), null == this._$centeredDialog && this._t && (this._$centeredDialog = o(a({
                        t: this._t
                    })), this._$centeredDialog.appendTo(this._$map)), this._$centeredDialog && (this._$centeredDialog.addClass("showWithAnimation"), this._$centeredDialog.removeClass("hideWithAnimation"))
                }
            }, {
                key: "_hideDialog",
                value: function() {
                    null != this._$centeredDialog && (this._$centeredDialog.addClass("hideWithAnimation"), this._$centeredDialog.removeClass("showWithAnimation"))
                }
            }, {
                key: "_startTimeout",
                value: function(e) {
                    this._stopTimeout(), this._timeout = setTimeout(e, s)
                }
            }, {
                key: "_stopTimeout",
                value: function() {
                    null != this._timeout && (clearTimeout(this._timeout), this._timeout = null)
                }
            }]), e
        }()
    }, {
        "../../templates/touchDragDialog.jade": 436,
        jquery: 111
    }],
    395: [function(e, t, i) {
        "use strict";
        $ = e("jquery"), $.ajaxTransport("+binary", function(e, t, i) {
            if (window.FormData && (e.dataType && "binary" == e.dataType || e.data && (window.ArrayBuffer && e.data instanceof ArrayBuffer || window.Blob && e.data instanceof Blob))) {
                var n;
                return {
                    send: function(t, i) {
                        n = new XMLHttpRequest;
                        var r = e.url,
                            o = e.type,
                            a = e.async || !0,
                            s = e.responseType || "blob",
                            l = e.data || null,
                            h = e.username || null,
                            u = e.password || null;
                        n.addEventListener("load", function() {
                            var t = {};
                            t[e.dataType] = n.response, i(n.status, n.statusText, t, n.getAllResponseHeaders())
                        }), n.open(o, r, a, h, u);
                        for (var d in t) n.setRequestHeader(d, t[d]);
                        n.responseType = s, n.send(l)
                    },
                    abort: function() {
                        n && n.abort()
                    }
                }
            }
        })
    }, {
        jquery: 111
    }],
    396: [function(e, t, i) {
        "use strict";

        function n(e) {
            function t() {
                n || e(c.t)
            }

            function i() {
                n = !0
            }
            var n = !1;
            return c.t ? l.defer(t) : d.once("load", t), {
                cancel: i
            }
        }

        function r(e, t) {
            function i(e) {
                return e in n ? n[e] : "{" + e + "}"
            }
            if (++f, c.t) t();
            else {
                var n = {},
                    r = e.getLanguage(),
                    o = u("i18n/translation." + r + ".json");
                s.ajax({
                    url: o,
                    dataType: "json",
                    callback: function(e, o) {
                        n = o, e && console.error("Could not load %s translation", r), c.t = i, d.emit("load"), t(e, o)
                    }
                })
            }
        }

        function o() {
            --f, 0 == f && delete t.exports.t
        }

        function a(e, t) {
            var i = [e.language, window.navigator.userLanguage || window.navigator.language],
                n = null;
            return l.find(i, function(e) {
                return n = t["name:" + e]
            }), n || t.name || null
        }
        var s = e("jquery"),
            l = e("underscore"),
            h = e("events").EventEmitter,
            u = e("./utils/StaticFileResolver"),
            d = new h,
            c = t.exports = {
                init: r,
                translateOsmName: a,
                onDivRemoved: o,
                onceLoad: n
            },
            f = 0
    }, {
        "./utils/StaticFileResolver": 410,
        events: 99,
        jquery: 111,
        underscore: 207
    }],
    397: [function(e, t, i) {
        "use strict";

        function n(e) {
            p += e
        }

        function r(e) {
            e.json && (d.defaults(e, {
                type: "POST",
                dataType: "json"
            }), e.data && console.warn("$.ajax called with json and data options, ignoring data"), e.data = JSON.stringify(e.json), e.contentType = "application/json", delete e.json)
        }

        function o() {
            function e(e, i) {
                function o() {
                    return n(1), ++a, t.call(c, e, i)
                }
                d.isObject(e) && (i = e, e = i.url), i = i || {};
                var a = 0,
                    s = i.callback,
                    l = i.error;
                r(i), i.error = function(t, n) {
                    if (m > a && "abort" !== n && [0, 503].indexOf(t.status) >= 0) console.log("Status " + t.status + " for url " + e + ", retrying..."), o();
                    else {
                        var r = i.errorMessage || t.responseText || "Loading " + e;
                        u(r, arguments), l && l.apply(this, arguments), s && s(new Error(r))
                    }
                };
                var h = i.complete;
                if (i.complete = function() {
                        n(-1), h && h.apply(this, arguments)
                    }, s) {
                    var f = i.success;
                    i.success = function(e) {
                        f && f.apply(this, arguments), s(null, e)
                    }
                }
                return o()
            }
            var t = c.ajax;
            c.ajax = e
        }

        function a(e, t, i) {
            return f.onServerHostReady(e, function(e) {
                return i = i || "", t.url = i + e + t.url, c.ajax(t)
            })
        }

        function s(e, t) {
            return h(e, t, "arraybuffer")
        }

        function l(e, t) {
            return h(e, t, "blob")
        }

        function h(e, t, i) {
            function r() {
                s(), this.aborted || (d.resolve(u.response), this.abort())
            }

            function o() {
                s(), this.aborted || (this.abort(), console.error("%s download failed (%s queries in pipe)", e, p), d.reject("File download failed"))
            }

            function a(e) {
                e.lengthComputable && (this.aborted || d.notify(e.loaded / e.total))
            }

            function s() {
                n(-f), f = 0, h.done()
            }

            function l() {
                this.aborted = !0, s(), u.abort()
            }
            var h = t.startLoading("Loading " + e),
                u = new XMLHttpRequest,
                d = c.Deferred();
            u.aborted = !1, u.open("GET", e, !0), u.responseType = i, n(1);
            var f = 1;
            u.onload = r, u.onerror = o, u.onprogress = a;
            try {
                u.send()
            } catch (m) {
                console.error("Ajax error: " + m.message + " code " + m.code + " for url: " + e), u.onerror()
            }
            return d.abort = l, d
        }

        function u(e, t) {
            var i = t[0],
                n = t[1],
                r = t[2];
            "abort" !== n && console.error(e + ', status "' + i.status + '", responseText "' + i.responseText + '", textStatus "' + n + '", errorThrown "' + r + '" (%s queries in pipe)', p)
        }
        var d = e("underscore"),
            c = e("jquery"),
            f = e("../ServerConfig");
        t.exports = {
            wrapJQueryAjax: o,
            downloadArrayBuffer: s,
            downloadBlob: l,
            download: a
        };
        var p = 0,
            m = 3
    }, {
        "../ServerConfig": 221,
        jquery: 111,
        underscore: 207
    }],
    398: [function(e, t, i) {
        "use strict";

        function n(e) {
            for (var t = e[0].x, i = e[0].x, n = e[0].y, r = e[0].y, o = 1; o < e.length; o++) t = Math.min(t, e[o].x), i = Math.max(i, e[o].x), n = Math.min(n, e[o].y), r = Math.max(r, e[o].y);
            var a = .5 * (i - t),
                s = .5 * (r - n),
                l = Math.sqrt(a * a + s * s);
            return l
        }

        function r(e, t) {
            if (t > 0) {
                var i, r = [];
                return f.each(e, function(e) {
                    if (e.shapePts.length >= 2) {
                        i = n(e.shapePts) * t;
                        var o = p(e.shapePts, i, !0),
                            a = {
                                shapePts: o,
                                radius: e.radius,
                                shapeHolePts: []
                            };
                        r.push(a), f.each(e.shapeHolePts, function(e) {
                            i = n(e) * t;
                            var r = p(e, i, !0);
                            r.length > 2 && a.shapeHolePts.push(r)
                        })
                    }
                }), r
            }
            return e
        }

        function o(e, t) {
            if (t > 0) {
                var i = [];
                return f.each(e, function(e) {
                    if (e.shapePts.length >= 2) {
                        var n = p(e.shapePts, t, !0),
                            r = {
                                shapePts: n,
                                radius: e.radius,
                                shapeHolePts: []
                            };
                        i.push(r), f.each(e.shapeHolePts, function(e) {
                            var i = p(e, t, !0);
                            i.length > 2 && r.shapeHolePts.push(i)
                        })
                    }
                }), i
            }
            return e
        }

        function a(e, t, i, n, r) {
            var a = n.strokeWeight,
                s = n.strokePosition,
                l = [],
                h = [],
                u = [],
                d = [],
                c = 0;
            if (null != a && a > 0) {
                i > 0 && (e = o(e, i));
                var p = !0,
                    v = [];
                f.each(e, function(e) {
                    e.shapePts.length >= 2 && (v.push({
                        shapePts: e.shapePts,
                        closed: g.isClosed(e.shapePts),
                        radius: e.radius
                    }), p = !1, f.each(e.shapeHolePts, function(e) {
                        if (e.length > 1) {
                            var t = e[0],
                                i = e[e.length - 1],
                                n = t.x == i.x && t.y == i.y;
                            v.push({
                                shapePts: e,
                                closed: n,
                                radius: 0
                            })
                        }
                    }))
                }), f.each(v, function(e) {
                    if (e.shapePts.length > 1) {
                        var i = 1,
                            n = i,
                            o = i;
                        s == m.INSIDE ? (n = i, o = 0) : s == m.OUTSIDE && (n = 0, o = i);
                        var a = 10,
                            l = g.offsetInnerOuterWidthPositionPointsList(e.shapePts, n, o, e.closed);
                        try {
                            var h = {
                                closed: e.closed,
                                scaleNormal: a,
                                shapePts: e.shapePts,
                                rightPts: l.rightPts,
                                leftPts: l.leftPts,
                                useIndexedData: t,
                                radius: e.radius
                            };
                            _.triangulateLinePointsList(d, h)
                        } catch (u) {
                            var c = "Area triangulateLinePointsList failed : " + u.message;
                            r && r.push(c), console.warn("Area triangulateLinePointsList failed", u)
                        }
                    }
                });
                for (var y = 0; y < d.length; y++) {
                    var b = d[y];
                    l.push(new Float32Array(b._positionArray)), h.push(new Float32Array(b._normalArray)), b._indexArray && u.push(new Uint16Array(b._indexArray)), c = Math.max(c, b.boundingRadius)
                }
            }
            var x = {
                positionArrays: l,
                normalArrays: h,
                indexArrays: u,
                boundingRadius: c
            };
            return x
        }

        function s(e, t, i, n) {
            var r = new y;
            r._positionArray = [], r._indexArray = t ? [] : null;
            var a = [];
            a.push(r);
            var s;
            s = t ? Math.floor(y.maxIndexCount - y.maxIndexCount % 3 / 3) : y.maxFloatCount - y.maxFloatCount % 3, i > 0 && (e = o(e, i)), f.each(e, function(e) {
                if (l(e.shapePts)) {
                    var i = {
                        radius: e.radius,
                        shapePts: f.clone(e.shapePts),
                        shapeHolePts: []
                    };
                    g.checkStartEnd(i.shapePts), r.boundingRadius = Math.max(r.boundingRadius, e.radius), f.each(e.shapeHolePts, function(e) {
                        var t = f.clone(e);
                        g.checkStartEnd(t), i.shapeHolePts.push(t)
                    }), r._positionArray.length > s && (r = new y, r._positionArray = [], r._indexArray = t ? [] : null, a.push(r)), h(i, r, n, 1) || (i = {
                        radius: e.radius,
                        shapePts: f.clone(e.shapePts),
                        shapeHolePts: []
                    }, g.checkStartEnd(i.shapePts), h(i, r, n, 2))
                }
            });
            for (var u = [], d = [], c = 0, p = 0; p < a.length; p++) r = a[p], u.push(new Float32Array(r._positionArray)), r._indexArray && d.push(new Uint16Array(r._indexArray)), c = Math.max(c, r.boundingRadius);
            var m = {
                positionArrays: u,
                indexArrays: d,
                boundingRadius: c
            };
            return m
        }

        function l(e) {
            var t = !0;
            return e.length < 3 ? t = !1 : 3 == e.length && e[0].x == e[2].x && e[0].y == e[2].y && (t = !1), t
        }

        function h(e, t, i, n) {
            try {
                _.triangulateRing(t, e, {
                    height: 0,
                    color: null,
                    flipSided: !1,
                    copyArrays: !1,
                    slowerButMoreAcurate: !0,
                    normalSmoothing: !1
                }), 2 == n && console.log("Area triangulation succeeded on pass 2")
            } catch (r) {
                if (1 == n) {
                    var o = "Area triangulateRing failed on pass 1";
                    i && i.push(o), console.log(o)
                }
                return !1
            }
            return !0
        }

        function u(e) {
            var t, i, n, r = 0,
                o = 0,
                a = 0,
                s = 0,
                l = e.length,
                h = 0;
            for (t = 0; t < e.length; t++)
                if (n = e[t], r += 3 * n.shapePts.length, o += 3, n.shapeHolePts)
                    for (h += n.shapeHolePts.length, i = 0; i < n.shapeHolePts.length; i++) a += 3 * n.shapeHolePts[i].length, s += 3;
            var u = new Float32Array(r),
                d = new Float32Array(o),
                c = new Int32Array(l),
                f = new Float32Array(a),
                p = new Float32Array(s),
                m = new Int32Array(h),
                g = new Int32Array(h),
                _ = new Float32Array(l),
                v = 0,
                y = 0,
                b = 0,
                x = 0,
                w = 0,
                M = 0;
            for (t = 0; t < e.length; t++) {
                n = e[t], _[t] = n.radius;
                var T = n.shapePts;
                d[b] = T[0].x, d[b + 1] = T[0].y, d[b + 2] = T[0].z;
                var S = d[b],
                    C = d[b + 1],
                    E = d[b + 2];
                b += 3;
                for (var k = 0; k < T.length; k++) u[v++] = T[k].x - S, u[v++] = T[k].y - C, u[v++] = T[k].z - E;
                w += k, c[t] = w;
                var L = n.shapeHolePts ? n.shapeHolePts : [];
                for (i = 0; i < L.length; i++) {
                    var P = L[i];
                    p[x] = P[0].x, p[x + 1] = P[0].y, p[x + 2] = P[0].z;
                    var A = p[x],
                        R = p[x + 1],
                        D = p[x + 2];
                    x += 3;
                    for (var I = 0; I < P.length; I++) f[y++] = P[I].x - A, f[y++] = P[I].y - R, f[y++] = P[I].z - D;
                    M += I, m[i] = M, g[i] = t
                }
            }
            var O = {
                ringsShapePoints: u,
                ringsShapeHolePoints: f,
                ringsShapeOffsets: d,
                ringsShapeHoleOffsets: p,
                ringShapeEndIndices: c,
                ringShapeHolesEndIndices: m,
                ringShapeHolesRingIndices: g,
                ringRadiuses: _
            };
            return O
        }

        function d(e) {
            var t, i, n, r, o, a = e.ringsShapePoints,
                s = e.ringsShapeHolePoints,
                l = e.ringsShapeOffsets,
                h = e.ringsShapeHoleOffsets,
                u = e.ringShapeEndIndices,
                d = e.ringShapeHolesEndIndices,
                c = e.ringShapeHolesRingIndices,
                f = e.ringRadiuses,
                p = 0,
                m = [];
            for (i = 0; i < u.length; i++) {
                t = u[i], o = 3 * i;
                var g = l[o + 0],
                    _ = l[o + 1],
                    y = l[o + 2],
                    b = [];
                for (n = p; t > n; n++) r = 3 * n, b.push(new v(a[r + 0] + g, a[r + 1] + _, a[r + 2] + y));
                m.push({
                    shapePts: b,
                    shapeHolePts: [],
                    radius: f[i]
                }), p = t
            }
            p = 0;
            for (var x = 0; x < d.length; x++) {
                var w = c[x];
                t = d[x], o = 3 * x;
                var M = h[o + 0],
                    T = h[o + 1],
                    S = h[o + 2],
                    C = [];
                for (n = p; t > n; n++) r = 3 * n, C.push(new v(s[r + 0] + M, s[r + 1] + T, s[r + 2] + S));
                m[w].shapeHolePts.push(C), p = t
            }
            return m
        }

        function c(e, t, i, n, r) {
            for (var o = new v, a = 0; a < e.length; a++) {
                for (var s = e[a], l = s.shapePts, h = 0; h < l.length; h++) {
                    var u = l[h];
                    if (r) {
                        t ? o.copy(t) : o.set(0, 0, 0), i && (o.x += i.x, o.y += i.y), o.x += u.x, o.y += u.y;
                        var d = n.findHeight(o);
                        null == d && (d = 0), u.z = d
                    } else u.z = 0
                }
                if (s.shapeHolePts)
                    for (var c = 0; c < s.shapeHolePts.length; c++)
                        for (var f = s.shapeHolePts[c], p = 0; p < f.length; p++) {
                            var m = f[p];
                            r ? (t ? o.copy(t) : o.set(0, 0, 0), i && (o.x += i.x, o.y += i.y), o.x += m.x, o.y += m.y, m.z = n.findHeight(o)) : m.z = 0
                        }
            }
        }
        var f = e("underscore"),
            p = e("simplify-js"),
            m = e("../api/StrokePosition"),
            g = e("engine/src/utils/ShapeUtils"),
            _ = e("engine/src/utils/TriangulationUtils"),
            v = e("engine/src/math/Vector3"),
            y = e("engine/src/object/Geometry");
        t.exports = {
            simplifyRings: o,
            simplifyRingsWithRadiusPrecisionFactor: r,
            triangulateStrokeShape: a,
            triangulateFillShape: s,
            flattenRingData: u,
            constructRingDataFromFlattenedData: d,
            updateRingElevations: c
        }
    }, {
        "../api/StrokePosition": 251,
        "engine/src/math/Vector3": 63,
        "engine/src/object/Geometry": 68,
        "engine/src/utils/ShapeUtils": 80,
        "engine/src/utils/TriangulationUtils": 82,
        "simplify-js": 199,
        underscore: 207
    }],
    399: [function(e, t, i) {
        "use strict";

        function n() {
            var e = s();
            return e.month() > 6 ? e.year() : e.year() - 1
        }

        function r() {
            return s({
                y: n(),
                M: 11,
                d: 1
            })
        }

        function o() {
            return s({
                y: n() + 1,
                M: 0,
                d: 6
            })
        }

        function a() {
            var e = r(),
                t = o(),
                i = s();
            return i.isAfter(e) && i.isBefore(t)
        }
        var s = e("moment");
        t.exports = {
            getStartDate: r,
            getEndDate: o,
            isChristmasTime: a
        }
    }, {
        moment: 149
    }],
    400: [function(e, t, i) {
        "use strict";

        function n(e) {
            return r(e) < .73
        }

        function r(e) {
            var t = o(e);
            return .299 * t.red() + .587 * t.green() + .114 * t.blue()
        }
        var o = e("onecolor");
        t.exports = {
            isWhiteBetterThenBlackOn: n
        }
    }, {
        onecolor: 150
    }],
    401: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            w.call(this), this.setMaxListeners(0), t = t || {};
            var i = t.overrides || {},
                n = t.forceOverride,
                r = S(e, {}),
                o = this.getUrlConfig(),
                a = [];
            o.config && (a = o.config.split(",")), n && a.push(n), b.chain(i).filter(function(e, t) {
                var i = b.contains(a, t) || e.condition && e.condition(o);
                return i && console.log("Applying override " + t), i
            }).reverse().each(function(e) {
                S(b.omit(e, "condition"), r)
            }), this._defaultConfiguration = r, this.resetStateFromUrl(this), this.initChangeCheck()
        }

        function r(e, t) {
            return b.isNumber(t) && h(e) ? t = f(t) : ("lon" == e || "lat" == e) && (t = v(t)), e + "=" + encodeURIComponent(t)
        }

        function o(e, t) {
            var i = {};
            return b.each(e, function(e, n) {
                if (!a(n)) {
                    var r;
                    if (t && (r = t[n]), b.isObject(e)) {
                        var s = o(e, r);
                        b.size(s) > 0 && (i[n] = s)
                    } else e !== r && (i[n] = e)
                }
            }), i
        }

        function a(e) {
            return "_" == e[0]
        }

        function s(e) {
            return e
        }

        function l(e, t) {
            var i = m(e, t);
            return P[i] || s
        }

        function h(e) {
            return /Color$|[cC]olors\.|\.color$/.test(e)
        }

        function u(e, t, i) {
            var n = {};
            b.each(e, function(e, r) {
                if (b.isObject(e)) n[r] = u(e, t[r], i[r]);
                else {
                    var o = n[r] = t[r];
                    r in t && o !== i[r] || (t[r] = e), i[r] = e
                }
            }, this)
        }

        function d(e, t) {
            var i = A[e];
            i || (i = A[e] = e.split("."));
            for (var n = 0; n < i.length; ++n) t && (t = t[i[n]]);
            return t
        }

        function c(e) {
            var t = e.split("&"),
                i = {};
            return b.each(t, function(e) {
                var t = b.str.strLeft(e, "="),
                    n = b.str.strRight(e, "=");
                try {
                    n = decodeURIComponent(n)
                } catch (r) {}
                t && (i[t] = n)
            }), i
        }

        function f(e) {
            var t = "000000" + e.toString(16);
            return t.substr(t.length - 6, 6).toUpperCase()
        }

        function p(e) {
            var t = x("<span>").addClass("option_name");
            return t.append(e), t.append(":&nbsp;"), t
        }

        function m(e, t) {
            var i = "undefined" == typeof t ? "undefined" : y(t);
            return "number" === i && h(e) && (i = "color"), i
        }

        function g(e, t) {
            var i = t,
                n = m(e, t),
                r = I[n];
            return r && (i = r(i)), "" + i
        }

        function _(e) {
            return b.map(e, function(e, t) {
                return t + "=" + encodeURIComponent(e)
            }).join("&")
        }

        function v(e) {
            var t = 7;
            return b.str.numberFormat(e, t, ".", "")
        }
        var y = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
            },
            b = e("underscore"),
            x = e("jquery"),
            w = e("events").EventEmitter,
            M = e("util"),
            T = e("./HistoryHelper"),
            S = e("./deepCopy"),
            C = e("./deepClone"),
            E = e("url");
        e("../common_dependencies");
        var k = x(window);
        t.exports = n, M.inherits(n, w);
        var L = n.prototype;
        L.getCookieConfig = function(e) {
            if (!this._cachedCookieConfig) {
                var t = {};
                if (this.cookie) {
                    var i = x.cookie(this.cookie);
                    i && (t = c(i))
                }
                this._cachedCookieConfig = t
            }
            var n = this._cachedCookieConfig;
            return e && (n = n[e]), n
        }, L.saveCookieConfig = function(e) {
            if (this.cookie) {
                var t = _(e);
                delete this._cachedCookieConfig, x.cookie(this.cookie, t, {
                    expires: 3650,
                    path: "/"
                })
            }
        }, L.setOptionInCookie = function(e, t) {
            if (this.cookie) {
                var i = this.getCookieConfig();
                i[e] = t, this.saveCookieConfig(i)
            }
        }, L.removeCookieConfig = function(e) {
            if (this.cookie) {
                var t = this.getCookieConfig();
                delete t[e], this.saveCookieConfig(t)
            }
        }, L.getDefaults = function() {
            return this._defaultConfiguration
        }, L.addModifiedOptions = function(e, t, i) {
            b.each(t, function(t, n) {
                if (null != t) {
                    var o = n;
                    i && (o = i + "." + o), b.isObject(t) ? this.addModifiedOptions(e, t, o) : b.isFunction(t) || this.shouldOptionBeSetInUrl(o, t) && e.push(r(o, t))
                }
            }, this)
        }, L.shouldOptionBeSetInUrl = function(e, t) {
            var i, n = this.getDefaultConfigValueFromName(e),
                r = this.getCookieConfig(e);
            if (null != r) {
                var o = this.parseConfigValue(e, r);
                i = t != o
            } else i = t != n;
            return i
        }, L.getConfigString = function() {
            var e = [];
            return this.addModifiedOptions(e, this.getState()), e.join("&")
        }, L.getUrl = function() {
            var e = this.getConfigString(),
                t = location.href.replace(/#.*$/, "");
            return t += e ? "#" + e : "#"
        }, L.getBaseUrl = function() {
            var e = location.href;
            return e = e.replace(/#.*$/, ""), e = e.replace(/\?.*$/, ""), e = e.replace(/\/[^\/]+.html$/, "")
        }, L.getShareUrl = function() {
            var e = this.getConfigString(),
                t = this.getBaseUrl();
            return t += e ? "#" + e : "#"
        }, L.getModifiedOptions = function() {
            return o(this, this._defaultConfiguration)
        }, L.getState = function() {
            var e = {};
            return b.each(this, function(t, i) {
                a(i) || b.isFunction(t) || (e[i] = t)
            }), e
        }, L.canUpdateHref = function() {
            var e = window.parent != window;
            return !1 !== this.updateHRef && !e
        }, L.updateHref = function() {
            this.canUpdateHref() && this._forceUpdateHref()
        }, L._forceUpdateHref = function() {
            var e = this.getUrl();
            if (location.href !== e)
                if (T.isHistoryApiSupported()) {
                    var t = this.getState();
                    history.replaceState(t, "", e), this.fixHash(e)
                } else location.replace(e)
        }, L.pushToHistory = function() {
            if (this.canUpdateHref()) {
                var e = this.getUrl();
                T.isHistoryApiSupported() && (history.pushState(this.getState(), "", e), this.fixHash(e))
            }
        }, L.fixHash = function(e) {
            var t = "#",
                i = e.indexOf("#");
            ~i && (t = "#" + e.substring(i + 1)), t != location.hash && (location.fixedHash = t)
        }, L.handleHistoryChange = function() {
            var e = this;
            k.on("hashchange", function() {
                e.applyNewState(e.getStateFromUrl())
            }), k.on("popstate", function(t) {
                e.handlePopState(t)
            })
        }, L.handlePopState = function(e) {
            var t = "state" in window.history && null !== window.history.state;
            if (t) {
                var i = e.originalEvent.state;
                null == i && (i = this.getStateFromUrl()), this.applyNewState(i)
            }
        }, L.applyNewState = function(e) {
            b.isEqual(e, this.getState()) || (S(e, this), this.emit("historyChange"), this.checkChanges())
        }, L.reloadCurrentState = function() {
            this.emit("historyChange")
        }, L.initChangeCheck = function() {
            this._lastChangeState = this.getCurrentValues()
        }, L._checkSubConfChanges = function(e, t, i) {
            b.each(t, function(t, n) {
                var r = i[n];
                b.isEqual(r, t) || (this.emit(e + n, t, r), b.isObject(t) && this._checkSubConfChanges(e + n + ".", t, r || {}))
            }, this)
        }, L.checkChanges = function() {
            b.defer(b.bind(function() {
                var e = this.getCurrentValues(),
                    t = this._lastChangeState;
                b.isEqual(e, t) || (this.emit("change", this), this._checkSubConfChanges("change:", e, t), this._lastChangeState = e)
            }, this))
        }, L.resetStateFromUrl = function(e, t) {
            C(this._defaultConfiguration, e);
            var i = this.getCookieConfig();
            this.overrideWithUrlConfig(i, e), this.overrideWithUrlConfig(this.getUrlConfig(t), e)
        }, L.getStateFromUrl = function(e) {
            var t = {};
            return this.resetStateFromUrl(t, e), t
        }, L.gotoOptionPage = function() {
            var e = document.location.pathname || "";
            e.length && "/" != e.charAt(e.length - 1) && (e += "/"), document.location = e + "options#" + this.getConfigString()
        };
        var P = {
            string: s,
            number: function(e) {
                var t = parseFloat(e),
                    i = parseInt(e, 10);
                return isNaN(t) ? isNaN(i) ? null : i : 0 !== t || isNaN(i) ? t : i
            },
            color: function(e) {
                return parseInt(e, 16)
            },
            "boolean": function(e) {
                return "true" === e ? !0 : "false" === e ? !1 : null
            },
            object: function(e, t) {
                return console.warn("Skipping invalid parameter: ", t), null
            }
        };
        L.parseConfigValue = function(e, t) {
            var i = this.getDefaultConfigValueFromName(e),
                n = l(e, i);
            return n ? n(t, e) : (console.error("Skipping parameter ", e, ". Configuration parser not found for ", i), null)
        }, L.getContainerObject = function(e, t) {
            for (var i = e, n = t.split("."), r = 0; r < n.length - 1; ++r) i && (i = i[n[r]]);
            return i
        }, L.getContainerObjectKey = function(e) {
            var t = e.split(".");
            return t[t.length - 1]
        }, L.setNoEvent = function(e, t) {
            b.isObject(e) ? this.setCurrentValues(e, !0) : this.setCurrentValue(e, t, !0), this._lastChangeState = this.getCurrentValues()
        }, L.set = function(e, t) {
            b.isObject(e) ? this.setCurrentValues(e) : this.setCurrentValue(e, t)
        }, L.setCurrentValue = function(e, t, i) {
            var n = this.getContainerObject(this, e),
                r = this.getContainerObjectKey(e);
            n[r] = t, i || this.checkChanges()
        }, L.setCurrentValues = function(e, t) {
            S(e, this), t || this.checkChanges()
        }, L.get = function(e) {
            return d(e, this)
        }, L.getCurrentValue = function(e) {
            return d(e, this)
        }, L.getCurrentValues = function() {
            var e = this.getState();
            return S(e, {})
        }, L.getDefaultValue = function(e) {
            return this.getDefaultConfigValueFromName(e)
        }, L.setCurrentValueAsDefaultValue = function(e) {
            this.setDefaultValue(e, this.getCurrentValue(e))
        }, L.setDefaultValue = function(e, t) {
            var i = this.getContainerObject(this._defaultConfiguration, e),
                n = this.getContainerObjectKey(e);
            i[n] = t
        }, L.setDefaultValues = function(e) {
            S(e, this._defaultConfiguration)
        }, L.setDefaultAndCurrentValue = function(e, t) {
            this.setDefaultValue(e, t), this.setCurrentValue(e, t)
        }, L.setDefaultsAndUnmodifiedCurrentValues = function(e) {
            var t = u(e, this, this._defaultConfiguration);
            return this.checkChanges(), t
        }, L.setInitialValues = function(e) {
            this.setDefaultValues(e), S(e, this), this.updateHRef && (S(this.getStateFromUrl(), this), this.handleHistoryChange())
        }, L.setDefaultAndCurrentValues = function(e) {
            this.setDefaultValues(e), this.setCurrentValues(e)
        }, L.overrideWithUrlConfig = function(e, t) {
            for (var i in e) {
                var n = this.getContainerObject(t, i);
                if (n) {
                    var r = this.getContainerObjectKey(i),
                        o = this.getDefaultConfigValueFromName(i),
                        a = e[i];
                    if (null != o) {
                        var s = this.parseConfigValue(i, a);
                        null != s && (n[r] = s)
                    } else n[r] = a
                }
            }
        };
        var A = {};
        L.getDefaultConfigValueFromName = function(e) {
            return d(e, this._defaultConfiguration)
        }, L.getUrlConfig = function(e) {
            var t = {},
                i = null,
                n = null,
                r = location;
            return e && (r = E.parse(e)), i = r.search, b.isString(r.fixedHash) ? n = r.fixedHash : r.hash && (n = r.hash), i && b.extend(t, c(i.substr(1))), n && b.extend(t, c(n.substr(1))), t
        }, L.setOptionInputStyle = function(e) {
            function t() {
                var e = "cookie_for_" + c;
                x("#" + e).remove();
                var t = x("<span>").attr("id", e).addClass("cookie_field"),
                    s = r.getCookieConfig(a);
                if (null != s) {
                    t.append(x("<span>").text(s).addClass("cookie_value").attr("title", "Value in cookie"));
                    var l = x('<button class="btn"><i class="fa fa-times" title="Remove from cookie"></button>');
                    t.append(l), l.click(n)
                }
                var h = x('<button class="btn"><i class="fa fa-floppy-o" title="Save in cookie"></button>');
                t.append(h), o.append(t), h.click(i)
            }

            function i() {
                var i = e.val();
                r.setOptionInCookie(a, i), t()
            }

            function n() {
                r.removeCookieConfig(a), t()
            }
            var r = this,
                o = e.parent(),
                a = e.attr("name"),
                s = this.getDefaultConfigValueFromName(a),
                h = l(a, s),
                u = h(e.val()),
                d = u != s,
                c = a.replace(/[.; ]/g, "_"),
                f = "default_for_" + c;
            if (x("#" + f).remove(), d) {
                var p = x("<span>");
                p.attr("id", f), p.addClass("default_value");
                var m = g(a, s);
                p.text("(default: " + m + ")"), o.append(p), p.click(function() {
                    e.focus(), e.val(m), e.blur(), e.change()
                })
            }
            e.toggleClass("modified_option", d), this.cookie && t()
        }, L.watchConfigInputForChanges = function(e) {
            var t = this;
            this.setOptionInputStyle(e), e.on("input change", function() {
                t.setOptionInputStyle(e)
            })
        };
        var R = 1.1;
        L.inputForValue = function(e, t, i, n, r) {
            function o() {
                var e = a.val();
                a.css("width", Math.ceil((("" + e).length + 2) * R) + "ex")
            }
            e.append(p(n)), r = r || "text";
            var a = x("<input>");
            a.attr("type", r), a.attr("name", i), a.val(t), e.append(a), o(), a.on("input change", o), this.watchConfigInputForChanges(a)
        }, L.inputForColor = function(e, t, i, n) {
            e.append(p(n));
            var r = x("<input>");
            r.attr("type", "text"), r.attr("name", i);
            var o = f(t);
            r.val(o), r.attr("maxlength", 6), r.css("width", "6em"), r.addClass("color"), e.append(r), this.watchConfigInputForChanges(r)
        };
        var D = {
            string: function(e, t, i, n) {
                this.inputForValue(e, t, i, n)
            },
            number: function(e, t, i, n) {
                this.inputForValue(e, t, i, n)
            },
            color: function(e, t, i, n) {
                this.inputForColor(e, t, i, n)
            },
            "boolean": function(e, t, i, n) {
                function r() {
                    var e = "true" == o.val();
                    o.toggleClass("true", e), o.toggleClass("false", !e)
                }
                e.append(p(n));
                var o = x("<select>").addClass("input-small");
                o.attr("name", i), o.append(x('<option value="true">true</option>').attr("selected", t)), o.append(x('<option value="false">false</option>').attr("selected", !t)), e.append(o), this.watchConfigInputForChanges(o), o.on("change", r), r()
            },
            object: function(e, t, i, n) {
                var r = x('<div class="section">');
                r.append('<span class="legend">' + n + "</span>"), e.append(r), this.inputForObject(r, t, i)
            }
        };
        L.inputForObject = function(e, t, i) {
            for (var n in t)
                if (!a(n)) {
                    var r = t[n];
                    if (null != r) {
                        var o = n;
                        i && (o = i + "." + o);
                        var s = m(o, r),
                            l = D[s];
                        if (l) {
                            var h = x('<div class="option form-horizontal">');
                            e.append(h), l.call(this, h, r, o, n)
                        }
                    }
                }
        };
        var I = {
            color: f
        };
        L.isModified = function(e) {
            var t = this.getDefaultConfigValueFromName(e),
                i = d(e, this);
            return t !== i
        }, L.generateForm = function(e, t) {
            void 0 === t && (t = "./"), e.append('<button class="apply btn btn-primary" id="apply_top">Go</button>'), e.append("<br>"), this.inputForObject(e, this), e.append("<br>"), e.append('<button class="apply btn btn-primary" id="apply_bottom">Go</button>');
            var i = this;
            e.find(".apply").click(function() {
                var n = {};
                x("*[name]", e).each(function(e, t) {
                    var r = x(t).attr("name"),
                        o = x(t).val(),
                        a = i.parseConfigValue(r, o);
                    i.shouldOptionBeSetInUrl(r, a) && (n[r] = o)
                }), document.location = t + "#" + _(n)
            })
        }, t.exports.parseQueryString = c, t.exports.formatNumber = v
    }, {
        "../common_dependencies": 308,
        "./HistoryHelper": 405,
        "./deepClone": 418,
        "./deepCopy": 419,
        events: 99,
        jquery: 111,
        underscore: 207,
        url: 208,
        util: 212
    }],
    402: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }

        function r(e) {
            var t, i, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {},
                r = n.ignoreStartDate,
                o = void 0 === r ? !1 : r;
            if (e["xmas:day_date"]) {
                var l = h.map(e["xmas:day_date"].split("/"), function(e) {
                    return e.trim()
                });
                2 == l.length && (t = a(l[0]), i = s(l[1]))
            } else e.start_date && (t = a(e.start_date)), e.end_date && (i = s(e.end_date));
            return e["xmas:feature"] ? (t || (t = d.getStartDate()), i || (i = d.getEndDate())) : o && (t = null), new c(t, i)
        }

        function o(e, t) {
            var i;
            return i = u(e, "YYYY-MM-DD", !0), i.isValid() ? i[t]("day") : (i = u(e, "YYYY-MM", !0), i.isValid() ? i[t]("month") : (i = u(e, "YYYY", !0), i.isValid() ? i[t]("year") : null))
        }

        function a(e) {
            return o(e, "startOf")
        }

        function s(e) {
            return o(e, "endOf")
        }
        var l = function() {
                function e(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var n = t[i];
                        n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                    }
                }
                return function(t, i, n) {
                    return i && e(t.prototype, i), n && e(t, n), t
                }
            }(),
            h = e("underscore"),
            u = e("moment"),
            d = e("./Christmas");
        t.exports = {
            getRangeFromOsmTags: r
        };
        var c = function() {
            function e(t, i) {
                n(this, e), this._startDate = t, this._endDate = i
            }
            return l(e, [{
                key: "isInRange",
                value: function(e) {
                    return !(this._startDate && this._startDate.isAfter(e) || this._endDate && this._endDate.isBefore(e))
                }
            }]), e
        }()
    }, {
        "./Christmas": 399,
        moment: 149,
        underscore: 207
    }],
    403: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function")
        }
        var r = function() {
                function e(e, t) {
                    for (var i = 0; i < t.length; i++) {
                        var n = t[i];
                        n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n)
                    }
                }
                return function(t, i, n) {
                    return i && e(t.prototype, i), n && e(t, n), t
                }
            }(),
            o = e("underscore");
        t.exports = function() {
            function e() {
                n(this, e), this._listeners = []
            }
            return r(e, [{
                key: "on",
                value: function(e, t, i) {
                    var n = this;
                    o.isObject(t) ? o.each(t, function(t, i) {
                        o.isFunction(t) ? n.on(e, i, t) : o.each(t, function(t, r) {
                            n.on(e, i, r, t)
                        })
                    }) : 4 == arguments.length ? this._onSelector.apply(this, arguments) : (this._listeners.push({
                        removeListener: function() {
                            e.removeListener ? e.removeListener(t, i) : e.off && e.off(t, i)
                        }
                    }), e.on(t, i))
                }
            }, {
                key: "_onSelector",
                value: function(e, t, i, n) {
                    this._listeners.push({
                        removeListener: function() {
                            e.off(t, i, n)
                        }
                    }), e.on(t, i, n)
                }
            }, {
                key: "removeAllListeners",
                value: function() {
                    o.each(this._listeners, function(e) {
                        var t = e.removeListener;
                        t()
                    }), this._listeners = []
                }
            }]), e
        }()
    }, {
        underscore: 207
    }],
    404: [function(e, t, i) {
        "use strict";

        function n(e, t, i) {
            var n = new s,
                r = 0;
            e.fixedColor && (n.fixedColor = e.fixedColor.clone());
            for (var o = 0; i > r + (t - 1) && n.verifyAppend(e);) {
                if (n.append(e, null, null), o++, r > 0)
                    for (var a = e._bonesIndexArray.length, l = n._bonesIndexArray.length - a, h = l; l + a > h; h++) n._bonesIndexArray[h] += r;
                r += t
            }
            return {
                packedGeometry: n,
                packedBoneCount: r,
                numberOfPacks: o
            }
        }

        function r(e, t, i, n) {
            var r = new s;
            r.clearOnWebglLoad = !0, r._miniSkinIndexArray = [];
            var o = e.getPointsCount(),
                a = null,
                d = null;
            n && (a = new u, d = new h), r.colorsMapping = [], i ? (delete e.fixedColor, r._colorArray = []) : r.fixedColor = e.fixedColor.clone();
            for (var c = null, f = 0; t > f; ++f) {
                var p = e.clone();
                p._miniSkinIndexArray = [];
                for (var m = 0; o > m; ++m) p._miniSkinIndexArray.push(f);
                i && (c = new l(i[f % i.length])), n && (d.z = 2 * Math.random() * Math.PI, a.setRotation(d)), r.append(p, a, c)
            }
            return r
        }

        function o(e) {
            var t = new s;
            return t._positionArray = e.positionArray, t._colorArray = e.colorArray, t._normalArray = e.normalArray, t._uvArray = e.uvArray, t._userDataArray = e.userDataArray, t._weightsArray = e.weightsArray, t._bonesIndexArray = e.bonesIndexArray, t._miniSkinIndexArray = e.miniSkinIndexArray, t._indexArray = e.indexArray, e.fixedColor && (t.fixedColor = new l, t.fixedColor.setHex(e.fixedColor)), t
        }

        function a(e) {
            var t = {
                positionArray: null,
                colorArray: null,
                normalArray: null,
                uvArray: null,
                userDataArray: null,
                weightsArray: null,
                bonesIndexArray: null,
                miniSkinIndexArray: null,
                indexArray: null,
                fixedColor: null
            };
            return e._positionArray && (t.positionArray = new Float32Array(e._positionArray)), e._colorArray && (t.colorArray = new Float32Array(e._colorArray)), e._normalArray && (t.normalArray = new Float32Array(e._normalArray)), e._uvArray && (t.uvArray = new Float32Array(e._uvArray)), e._userDataArray && (t.userDataArray = new Float32Array(e._userDataArray)), e._weightsArray && (t.weightsArray = new Float32Array(e._weightsArray)), e._bonesIndexArray && (t.bonesIndexArray = new Float32Array(e._bonesIndexArray)), e._miniSkinIndexArray && (t.miniSkinIndexArray = new Float32Array(e._miniSkinIndexArray)), e._indexArray && (t.indexArray = new Uint16Array(e._indexArray)), e.fixedColor && (t.fixedColor = e.fixedColor.getHex()), t
        }
        var s = e("engine/src/object/Geometry"),
            l = e("engine/src/Color"),
            h = e("engine/src/math/Vector3"),
            u = e("engine/src/math/Matrix4");
        t.exports = {
            packGeometry: n,
            buildSkinnedGeometry: r,
            constructGeometry: o,
            flattenGeometry: a
        }
    }, {
        "engine/src/Color": 13,
        "engine/src/math/Matrix4": 60,
        "engine/src/math/Vector3": 63,
        "engine/src/object/Geometry": 68
    }],
    405: [function(e, t, i) {
        "use strict";

        function n() {
            return !!(window.history && history.pushState && history.replaceState)
        }
        t.exports = {
            isHistoryApiSupported: n
        }
    }, {}],
    406: [function(e, t, i) {
        "use strict";

        function n(e) {
            var t = s.parse(e).host;
            if (t && a.isCrossDomain(e)) {
                var i = "",
                    n = l.getHost();
                if (n) {
                    var r = l.getProtocol();
                    i = r ? r + "//" + n : "https://" + n
                }
                return i + "/crossdomain?url=" + encodeURIComponent(e)
            }
            return null
        }

        function r(e) {
            return e.iconUrl ? e.iconUrl : (e.iconUrl = o(e), e.iconUrl)
        }

        function o(e) {
            if (e.canvas) return console.warn("Icon canvas is deprecated, use url instead (canvas.toDataURL())"), e.canvas.toDataURL();
            if (/^data:/.test(e.url)) return e.url;
            if (e.image || e.url) {
                var t = e.image ? e.image.src : e.url,
                    i = /^\/\//.test(t) ? location.protocol + t : t;
                if (s.parse(i).host) {
                    var r = n(i);
                    return r ? r : t
                }
                return t
            }
            return null
        }
        var a = e("./UrlHelper"),
            s = e("url"),
            l = e("./apiUrl");
        t.exports = {
            getIconUrl: r
        }
    }, {
        "./UrlHelper": 413,
        "./apiUrl": 417,
        url: 208
    }],
    407: [function(e, t, i) {
        "use strict";

        function n(e) {
            return {
                lon: _.convertLon900913To4326(e.lon),
                lat: _.convertLat900913To4326(e.lat)
            }
        }

        function r(e) {
            return {
                lon: _.convertLon4326To900913(e.lon),
                lat: _.convertLat4326To900913(e.lat)
            }
        }

        function o(e) {
            return e instanceof g ? e._to900913() : r({
                lat: e.lat,
                lon: e.lng
            })
        }

        function a(e) {
            return g.from900913(e.lat, e.lon)
        }

        function s(e) {
            return {
                lon: f.has(e, "lon") ? e.lon : f.has(e, "lng") ? e.lng : e.x,
                lat: f.has(e, "lat") ? e.lat : e.y
            }
        }

        function l(e) {
            return 2 * p / Math.pow(2, e)
        }

        function h(e) {
            return m.cosh(Math.PI * e / p)
        }

        function u(e) {
            return Math.min(Math.max(e, -p), p)
        }

        function d(e, t) {
            return Math.round(e.lon) == Math.round(t.lon) && Math.round(e.lat) == Math.round(t.lat)
        }

        function c(e, t) {
            return e.toString() == t.toString()
        }
        var f = e("underscore"),
            p = 20037508.34,
            m = e("engine").MathHelper,
            g = e("../api/LatLng"),
            _ = e("mercatorProjection");
        t.exports = {
            convert900913to4326: n,
            convert4326to900913: r,
            convertGoogleLatLngTo900913: o,
            convert900913toGoogleLatLng: a,
            convertLonLatOrXYToLonLat: s,
            clampLatToMercatorExtent: u,
            isSamePosition: d,
            isSameGeometry: c,
            getScaleFromLatitude: h,
            getTileSizeFromZoom: l
        }
    }, {
        "../api/LatLng": 233,
        engine: 10,
        mercatorProjection: 147,
        underscore: 207
    }],
    408: [function(e, t, i) {
        "use strict";

        function n() {
            this._renderEngine = null, this._models = {}, this._packedModels = {}, this._skinnedGeometries = {}, this._pendingModelLoadedCallbacks = {}, this._pendingModelPackedCallbacks = {}, this._pendingGeometrySkinningRequests = {}, this._modelColors = {}, this._maxBoneCount = 1, this._useWorker = !0, this._packingRequestQueue = [], this._pendingPackingWork = {}, this._activePackingWork = {}
        }
        var r = e("underscore"),
            o = e("engine"),
            a = o.BinaryLoader,
            s = o.SkeletonUtils,
            l = o.Color,
            h = e("./GeometryPackingHelper"),
            u = e("./worker/WorkerManager");
        t.exports = n, n.prototype.init = function(e, t) {
            this._mapRenderer = e, this._renderEngine = e.getRenderEngine(), this._useWorker = this._useWorker && t, this._maxBoneCount = this._renderEngine._shaderHandler.maxBonesCount, this._isInitialized = !0, this._useWorker && (this.workerRequestCallback = r.bind(this._performWork, this), this.needsWorkerCallback = r.bind(function() {
                return this._packingRequestQueue.length > 0
            }, this), this.workerSuccessHandler = r.bind(this.onWorkerSuccess, this), this.workerErrorHandler = r.bind(this.onWorkerError, this), this._workerConsumer = {
                name: "ModelCache",
                consumer: this,
                workerCallback: this.workerRequestCallback,
                needsWorker: this.needsWorkerCallback,
                maxWorkers: 1,
                currentConsumption: 0
            }, u.registerWorkerConsumer(this._workerConsumer))
        }, n.prototype.clearAll = function() {
            return this._isInitialized = !1, this._renderEngine ? (r.each(this._models, function(e) {
                this._renderEngine.releaseGeometry(e.geometry)
            }, this), this._models = {}, r.each(this._packedModels, function(e) {
                this._renderEngine.releaseGeometry(e.geometry)
            }, this), this._packedModels = {}, void(this._workerConsumer && (u.unregisterWorkerConsumer(this._workerConsumer), delete this._workerConsumer))) : void console.error("ModelCache.clearAll : must be initialised first with valid render engine")
        }, n.prototype.loadModel = function(e, t) {
            if (this._models[e]) {
                var i = this._models[e];
                if (t) {
                    var n = this;
                    r.defer(function() {
                        n._isInitialized && t(null, i.geometry, i.skeleton)
                    })
                }
            } else this._addModelRequest(e, t)
        }, n.prototype.removeModel = function(e) {
            if (!this._renderEngine) return void console.error("ModelCache.removeModel : must be initialised first with valid render engine");
            if (this._models[e]) {
                var t = this._models[e];
                this._renderEngine.releaseGeometry(t.geometry), delete this._models[e]
            }
        }, n.prototype.packModel = function(e, t) {
            if (this._packedModels[e]) {
                var i = this._packedModels[e];
                t && r.defer(function() {
                    t(i.geometry, i.boneCount, i.numberOfPacks, i.originalSkeleton)
                })
            } else t && (this._pendingModelPackedCallbacks[e] || (this._pendingModelPackedCallbacks[e] = []), this._pendingModelPackedCallbacks[e].push(t)), this._models[e] ? this._performModelPacking(e) : this._addModelRequest(e)
        }, n.prototype.buildSkinnedGeometry = function(e, t, i, n, o) {
            var a = this.buildSkinnedGeometryKey(e, i, n);
            if (this._skinnedGeometries[a]) {
                var s = this._skinnedGeometries[a];
                o && r.defer(function() {
                    o(s.geometry)
                })
            } else o && (this._pendingGeometrySkinningRequests[e] || (this._pendingGeometrySkinningRequests[e] = []), this._pendingGeometrySkinningRequests[e].push({
                count: t,
                colors: i,
                randomRotZ: n,
                callback: o
            })), this._models[e] ? this._performGeometrySkinning(e, t, i, n) : this._addModelRequest(e)
        }, n.prototype.buildSkinnedGeometryKey = function(e, t, i) {
            var n = {
                url: e,
                colors: t,
                randomRotZ: i
            };
            return JSON.stringify(n)
        }, n.prototype.removePackedModel = function(e) {
            if (!this._renderEngine) return void console.error("ModelCache.removePackedModel : must be initialised first with valid render engine");
            if (this._packedModels[e]) {
                var t = this._packedModels[e];
                this._renderEngine.releaseGeometry(t.geometry), delete this._packedModels[e]
            }
        }, n.prototype.setModelColor = function(e, t) {
            this._modelColors[e] = t, this._models[e] && (this._models[e].geometry.fixedColor.set(t), this._models[e].geometry.__isColorDirty = !0), this._packedModels[e] && (this._packedModels[e].geometry.fixedColor.set(t), this._packedModels[e].geometry.__isColorDirty = !0)
        }, n.prototype._addModelRequest = function(e, t) {
            var i = this;
            this._pendingModelLoadedCallbacks[e] || (this._pendingModelLoadedCallbacks[e] = [], new a(e, function(t, n, r) {
                i._onModelLoaded(t, e, n, r)
            })), t && this._pendingModelLoadedCallbacks[e].push(t)
        }, n.prototype._onModelLoaded = function(e, t, i, n) {
            if (!e) {
                n || (n = s.createSkeleton(1));
                var o = this._models[t] = {
                    geometry: i,
                    skeleton: n
                };
                this._modelColors[t] && (o.geometry.fixedColor.set(this._modelColors[t]), o.geometry.__isColorDirty = !0)
            }
            var a = this._pendingModelLoadedCallbacks[t];
            if (delete this._pendingModelLoadedCallbacks[t], r.defer(function() {
                    r.each(a, function(t) {
                        t(e, i, n)
                    })
                }), this._pendingModelPackedCallbacks[t] && this.packModel(t), this._pendingGeometrySkinningRequests[t]) {
                var l = this._pendingGeometrySkinningRequests[t];
                this.buildSkinnedGeometry(l.url, l.count, l.colors, l.randomRotZ)
            }
        }, n.prototype._performModelPacking = function(e) {
            if (!this._renderEngine) return void console.error("ModelCache._performModelPacking : must be initialised first with valid render engine");
            var t = this._models[e];
            if (this._useWorker && this._mapRenderer.workersEnabled) this._packGeometryInWorker(e, t);
            else {
                var i = t.geometry,
                    n = t.skeleton,
                    r = h.packGeometry(i, n.bones.length, this._maxBoneCount);
                this._onModelPacked(e, r.packedGeometry, r.packedBoneCount, r.numberOfPacks, n)
            }
        }, n.prototype._performGeometrySkinning = function(e, t, i, n) {
            var r = this._models[e];
            if (this._useWorker && this._mapRenderer.workersEnabled) this._skinGeometryInWorker(e, r, t, i, n);
            else {
                var o = r.geometry,
                    a = h.buildSkinnedGeometry(o, t, i, n);
                this._onGeometrySkinned(e, a, t, i, n)
            }
        }, n.prototype._onModelPacked = function(e, t, i, n, o) {
            var a = this._packedModels[e] = {
                    geometry: t,
                    boneCount: i,
                    numberOfPacks: n,
                    originalSkeleton: o
                },
                s = this._pendingModelPackedCallbacks[e];
            delete this._pendingModelPackedCallbacks[e], r.defer(function() {
                r.each(s, function(e) {
                    e(a.geometry, a.boneCount, a.numberOfPacks, a.originalSkeleton)
                })
            })
        }, n.prototype._onGeometrySkinned = function(e, t, i, n, o) {
            var a = this.buildSkinnedGeometryKey(e, n, o),
                s = this._skinnedGeometries[a] = {
                    geometry: t,
                    count: i,
                    color: n,
                    randomRotZ: o
                };
            if (t.colorsMapping = [], n)
                for (var h = 0; i > h; h++) {
                    var u = new l(n[h % n.length]);
                    t.colorsMapping.push(u)
                }
            var d = this._pendingGeometrySkinningRequests[e];
            delete this._pendingGeometrySkinningRequests[e], r.defer(function() {
                r.each(d, function(e) {
                    e.callback(s.geometry)
                })
            })
        }, n.prototype._packGeometryInWorker = function(e, t) {
            var i = t.geometry,
                n = t.skeleton,
                r = h.flattenGeometry(i),
                o = {
                    url: e,
                    model: t,
                    flattenedGeometry: r,
                    skeletonBoneCount: n.bones.length,
                    count: -1,
                    randomRotZ: !1,
                    colors: null,
                    isSkinning: !1
                };
            this._packingRequestQueue.push(o), this._pendingPackingWork[e] = o, u.requestWorker(this)
        }, n.prototype._skinGeometryInWorker = function(e, t, i, n, r) {
            var o = t.geometry,
                a = h.flattenGeometry(o),
                s = {
                    url: e,
                    model: t,
                    flattenedGeometry: a,
                    skeletonBoneCount: 1,
                    count: i,
                    randomRotZ: r,
                    colors: n,
                    isSkinning: !0
                };
            this._packingRequestQueue.push(s), this._pendingPackingWork[e] = s, u.requestWorker(this)
        }, n.prototype._performWork = function(e) {
            if (0 == this._packingRequestQueue.length) u.releaseWorker(e);
            else {
                var t = this._packingRequestQueue.shift(),
                    i = t.url;
                delete this._pendingPackingWork[i], this._activePackingWork[i] = t;
                var n = t.flattenedGeometry,
                    r = {
                        url: i,
                        flattenedGeometry: n,
                        skeletonBoneCount: t.skeletonBoneCount,
                        count: t.count,
                        randomRotZ: t.randomRotZ,
                        colors: t.colors,
                        isSkinning: t.isSkinning,
                        maxBoneCount: this._maxBoneCount
                    },
                    o = [];
                n.positionArray && o.push(n.positionArray.buffer), n.colorArray && o.push(n.colorArray.buffer), n.normalArray && o.push(n.normalArray.buffer), n.uvArray && o.push(n.uvArray.buffer), n.userDataArray && o.push(n.userDataArray.buffer), n.weightsArray && o.push(n.weightsArray.buffer), n.bonesIndexArray && o.push(n.bonesIndexArray.buffer), n.miniSkinIndexArray && o.push(n.miniSkinIndexArray.buffer), n.indexArray && o.push(n.indexArray.buffer), e.packGeometry({
                    data: r,
                    success: this.workerSuccessHandler,
                    error: this.workerErrorHandler,
                    transfers: o
                })
            }
        }, n.prototype.onWorkerSuccess = function(e, t) {
            var i = t.url;
            if (this._activePackingWork[i]) {
                var n = this._activePackingWork[i];
                delete this._activePackingWork[i];
                var o = n.model,
                    a = h.constructGeometry(t.flattenedPackedGeometry),
                    s = t.packedBoneCount,
                    l = t.numberOfPacks,
                    d = t.errors;
                d.length > 0 && (console.warn("Got errors from model packing:"), r.each(d, function(e) {
                    console.warn(e)
                })), t.isSkinning ? this._onGeometrySkinned(i, a, n.count, n.colors, n.randomRotZ) : this._onModelPacked(i, a, s, l, o.skeleton)
            }
            u.releaseWorker(e)
        }, n.prototype.onWorkerError = function(e, t) {
            console.error("Geometry packing worker failed : " + t), u.releaseWorker(e)
        }
    }, {
        "./GeometryPackingHelper": 404,
        "./worker/WorkerManager": 422,
        engine: 10,
        underscore: 207
    }],
    409: [function(e, t, i) {
        "use strict";

        function n() {
            function e(e) {
                n[e.priority] || (n[e.priority] = {
                    priority: e.priority,
                    hasToWaitAll: e.hasToWaitAll,
                    isTexture: e.isTexture,
                    timeToWait: e.timeToWait,
                    workOnMove: e.workOnMove,
                    pendingRequests: [],
                    requestsWithData: [],
                    ongoingRequestsNbr: 0
                }), o.lastReceivedDate = Date.now()
            }

            function t(t) {
                return n[t] || e({
                    priority: t
                }), n[t]
            }

            function i(e) {
                var i = t(e.options.priority);
                i.pendingRequests.push(e), i.needToSort = !0
            }
            var n = [],
                o = {
                    lastReceivedDate: 0,
                    init: e,
                    setNeedToSort: function() {
                        r.each(n, function(e) {
                            e && (e.needToSort = !0)
                        })
                    },
                    queue: i,
                    getPriorityRequest: t,
                    all: function() {
                        return n
                    }
                };
            return o
        }
        var r = e("underscore");
        t.exports = n
    }, {
        underscore: 207
    }],
    410: [function(e, t, i) {
        "use strict";
        var n = e("url"),
            r = e("./apiUrl"),
            o = e("fack");
        t.exports = function(e) {
            return /^(https?:)?\/\//.test(e) ? e : n.resolve(r(), o.resourceUrl(e))
        }
    }, {
        "./apiUrl": 417,
        fack: 101,
        url: 208
    }],
    411: [function(e, t, i) {
        "use strict";
        var n = e("underscore"),
            r = e("engine").ShapeUtils,
            o = t.exports;
        o.currentLayer = null, o.urlTemplate2d = null, o.urlTemplate3d = null;
        var a = 20037508.34,
            s = {
                xMin: -a,
                xMax: a,
                yMin: -a,
                yMax: a,
                zoom: 0
            };
        o.setCurrentTileLayer = function(e) {
            this.currentLayer = e
        }, o.hasF4TileLayer = function(e) {
            return e ? !this.urlTemplate3d : !this.urlTemplate2d
        }, o.getBaseUrl = function(e, t, i) {
            var n, r = t,
                o = /\[(.*)\]/;
            if (-1 != r.indexOf("%d")) n = Math.abs(i.x + i.y) % e.conf.get("tiles.maxServerCount"), r = r.replace("%d", n);
            else if (o.test(r)) {
                var a = o.exec(r),
                    s = a[1];
                n = Math.abs(i.x + i.y) % s.length, r = r.replace(o, s[n])
            }
            return r
        }, o.getTileUrl = function(e, t, i) {
            var n = e.getMinZoomLayer2D(),
                r = e.conf.get("tiles.layer2d"),
                o = e.conf.get("zoom"),
                a = this.urlTemplate2d;
            return i && (t.z > n || o > n && t.z <= o) && (r = e.conf.get("tiles.layer3d"), a = this.urlTemplate3d), a ? a.replace("{z}", t.z).replace("{x}", t.x).replace("{y}", t.y) : "/tiles/" + r + "/" + t.z + "/" + t.x + "/" + t.y + ".png"
        }, o.getWorldBounds = function() {
            return s
        }, o.clampFrustum = function(e) {
            e.xMin = Math.max(e.xMin, s.xMin), e.yMin = Math.max(e.yMin, s.yMin), e.xMax = Math.min(e.xMax, s.xMax), e.yMax = Math.min(e.yMax, s.yMax)
        }, o.computeFrustumPoints = function(e, t) {
            var i = e.getVisibleGroundBoundingBox(t);
            if (e.map.elevation && e.isIn3d()) {
                var n = e.getPosCamera();
                i.push(n)
            }
            return i
        }, o.computeFrustum = function(e, t) {
            var i = o.computeFrustumPoints(e, t),
                r = {
                    frustumPoints: i
                };
            return r.xMin = n.min(n.pluck(i, "x")), r.xMax = n.max(n.pluck(i, "x")), r.yMin = n.min(n.pluck(i, "y")), r.yMax = n.max(n.pluck(i, "y")), o.clampFrustum(r), r
        }, o.isOutsideFrustum = function(e, t) {
            var i = e.bounds,
                n = i.xMin >= t.xMax || i.xMax <= t.xMin || i.yMax <= t.yMin || i.yMin >= t.yMax;
            return n ? !0 : !r.isBoundsCloseToPointsList(t.frustumPoints, i)
        }, o.getTileSizeInMeters = function(e) {
            var t = Math.pow(2, e);
            return 2 * a / t
        }, o.sphericalMercatorToTile = function(e, t, i) {
            var n = o.getTileSizeInMeters(i),
                r = Math.floor((e + a) / n),
                s = Math.floor((a - t) / n);
            return {
                x: r,
                y: s,
                z: i
            }
        }, o.clampToLimit = function(e, t) {
            e.xMin = Math.max(e.xMin, t.left), e.yMin = Math.max(e.yMin, t.bottom), e.xMax = Math.min(e.xMax, t.right), e.yMax = Math.min(e.yMax, t.top)
        }, o.getTileBounds = function(e) {
            var t = o.getTileSizeInMeters(e.z),
                i = e.x * t,
                n = e.y * t,
                r = i - a,
                s = a - n;
            return {
                yMax: s,
                yMin: s - t,
                xMin: r,
                xMax: r + t
            }
        }, o.getTileCenter = function(e) {
            var t = o.getTileSizeInMeters(e.z),
                i = e.x * t,
                n = e.y * t,
                r = i - a,
                s = a - n;
            return {
                y: s - t / 2,
                x: r + t / 2
            }
        }, o.getNeighborsTileKeys = function(e) {
            var t = e.split("_"),
                i = +t[0],
                n = +t[1],
                r = +t[2];
            return [this.generateTileKeyFromCoords(n - 1, r - 1, i), this.generateTileKeyFromCoords(n, r - 1, i), this.generateTileKeyFromCoords(n + 1, r - 1, i), this.generateTileKeyFromCoords(n - 1, r, i), this.generateTileKeyFromCoords(n + 1, r, i), this.generateTileKeyFromCoords(n - 1, r + 1, i), this.generateTileKeyFromCoords(n, r + 1, i), this.generateTileKeyFromCoords(n + 1, r + 1, i)]
        }, o.getTileCoordFromTileKey = function(e) {
            var t = e.split("_");
            return 3 != t.length ? (console.warn("Wrong format for tileKey : " + e), {}) : {
                z: t[0],
                x: t[1],
                y: t[2]
            }
        }, o.generateTileKeyFromCoords = function(e, t, i) {
            return i + "_" + e + "_" + t
        }, o.generateKey = function(e) {
            return e.z + "_" + e.x + "_" + e.y
        }, o.setUrlTemplate2d = function(e) {
            this.urlTemplate2d = e
        }, o.setUrlTemplate3d = function(e) {
            this.urlTemplate3d = e
        }
    }, {
        engine: 10,
        underscore: 207
    }],
    412: [function(e, t, i) {
        "use strict";

        function n(e) {
            return {
                nullAllowed: !0,
                check: o(e)
            }
        }

        function r(e, t) {
            var i = a(e);
            i(t)
        }

        function o(e) {
            if (e.check) return _.bind(e.check, e);
            if (Boolean == e) return s;
            if (Number == e) return l;
            if (Object == e) return h;
            if (String == e) return u;
            if (Date == e) return c;
            if (_.isFunction(e)) return function(t) {
                d(t, e)
            };
            if (_.isObject(e)) return f(e);
            throw new Error("no check known for type " + e)
        }

        function a(e) {
            var t = o(e);
            return e.nullAllowed && (t = m(t)), t
        }

        function s(e) {
            if (!_.isBoolean(e)) throw new Error("expected a boolean, got " + p(e))
        }

        function l(e) {
            if (!_.isNumber(e)) throw new Error("expected a number, got " + p(e))
        }

        function h(e) {
            if (!_.isObject(e)) throw new Error("expected an object, got " + p(e))
        }

        function u(e) {
            if (!_.isString(e)) throw new Error("expected a string, got " + p(e))
        }

        function d(e, t) {
            if (!(e instanceof t)) throw new Error("expected an instance of " + t.name + ", got " + p(e))
        }

        function c(e) {
            if (d(e, Date), isNaN(e.getTime())) throw new Error("invalid date")
        }

        function f(e) {
            var t = {};
            return _.each(e, function(e) {
                    t[e] = !0
                }),
                function(e) {
                    if (!t[e]) throw new Error("" + e + " is not a correct enum value")
                }
        }

        function p(e) {
            return null === e ? "null" : "undefined" == typeof e ? "undefined" : g(e)
        }

        function m(e) {
            return function(t) {
                null != t && e(t)
            }
        }
        var g = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
                return typeof e
            } : function(e) {
                return e && "function" == typeof Symbol && e.constructor === Symbol ? "symbol" : typeof e
            },
            _ = e("underscore");
        t.exports = {
            OrNull: n,
            check: r,
            getCheckFunction: a
        }
    }, {
        underscore: 207
    }],
    413: [function(e, t, i) {
        "use strict";

        function n(e) {
            return /^data:/.test(e)
        }

        function r(e) {
            var t = a.parse(a.resolve(document.location.href, e));
            return t.host == document.location.host
        }

        function o(e) {
            return !n(e) && !r(e)
        }
        var a = e("url");
        t.exports = {
            isCrossDomain: o
        }
    }, {
        url: 208
    }],
    414: [function(e, t, i) {
        "use strict";

        function n(e) {
            this._webGLRenderer = e, this._webglTestCallback = r.bind(this._onWebGLBenchTestFinished, this), this._performanceCalc = null
        }
        var r = e("underscore"),
            o = e("engine/src/utils/perfcalc/WebGLPerformanceCalculator");
        t.exports = n, n.prototype.test = function(e) {
            this._performanceCalc || (this._lastScore = 0, this._webglTestCount = 0, this._callback = e, this._doWebGLBenchTest())
        }, n.prototype.abort = function() {
            this._performanceCalc && (this._performanceCalc.abort(), this._performanceCalc = null, this._callback = null)
        }, n.prototype._doWebGLBenchTest = function() {
            var e = {
                testList: ["vertex_buffer_upload", "texture_upload", "render_high_poly", "fragment_shader", "pixel_read"],
                webGL: this._webGLRenderer
            };
            this._performanceCalc = new o, this._performanceCalc.calculate(e, this._webglTestCallback)
        }, n.prototype._onWebGLBenchTestFinished = function(e, t) {
            if (this._webglTestCount++, this._performanceCalc = null, e) this._callback && (this._callback(e), this._callback = null);
            else {
                var i = this._lastScore,
                    n = t.benchmarkScore;
                this._lastScore = n, this._webglTestCount < 5 && Math.abs(n - i) > .5 ? this._doWebGLBenchTest() : this._callback && (this._callback(null, t), this._callback = null)
            }
        }
    }, {
        "engine/src/utils/perfcalc/WebGLPerformanceCalculator": 88,
        underscore: 207
    }],
    415: [function(e, t, i) {
        "use strict";
        var n = {
            alpha: !1,
            depth: !0,
            stencil: !0,
            clearColor: 16777215,
            antialias: !0,
            premultipliedAlpha: !1,
            preserveDrawingBuffer: !1,
            failIfMajorPerformanceCaveat: !0
        };
        t.exports = n
    }, {}],
    416: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            this.renderer = e, t = t || {}, this._index = o++, this._name = t.name, this._workers = [], this._intervalIdle = t.intervalIdle, this._maxDurationIdle = t.maxDurationIdle, this._intervalMoving = t.intervalMoving || this._intervalIdle, this._maxDurationMoving = t.maxDurationMoving || this._maxDurationMoving, this._maxDurationInMs = null, this._intervalInMs = null, this._workersToDelete = [], this._isInteracting = !1, this._isCameraMoving = !1, this._onMapEnabledCallback = r.bind(this.onMapEnabled, this), this._onCameraMoveCallback = r.bind(this.onCameraMove, this), this._onCameraStabilizedCalback = r.bind(this.onCameraStabilized, this), this._onInteractionStartCallback = r.bind(this.onInteractionStart, this), this._onInteractionEndCallback = r.bind(this.onInteractionEnd, this), this.init(), this.setWorkOnMove(t.workWhenCameraMove), this._workHandler = r.bind(this.work, this)
        }
        var r = e("underscore"),
            o = 1;
        n.prototype.setWorkOnMove = function(e) {
            this._workWhenCameraMove != e && (this._workWhenCameraMove = e)
        }, n.prototype.init = function() {
            this.renderer.map.on("enabled_changed", this._onMapEnabledCallback), this.renderer.on("cameraChanged", this._onCameraMoveCallback), this.renderer.on("cameraStabilized", this._onCameraStabilizedCalback);
            var e = this.renderer._mouseManager;
            e && (e.on("interactionStart", this._onInteractionStartCallback), e.on("interactionEnd", this._onInteractionEndCallback));
            var t = this.renderer._keyboardManager;
            t && (t.on("interactionStart", this._onInteractionStartCallback), t.on("interactionEnd", this._onInteractionEndCallback))
        }, n.prototype.release = function() {
            var e = this;
            this.renderer.map.removeListener("enabled_changed", this._onMapEnabledCallback), this.renderer.removeListener("cameraChanged", this._onCameraMoveCallback), this.renderer.removeListener("cameraStabilized", this._onCameraStabilizedCalback);
            var t = this.renderer._mouseManager;
            t && (t.removeListener("interactionStart", this._onInteractionStartCallback), t.removeListener("interactionEnd", this._onInteractionEndCallback));
            var i = this.renderer._keyboardManager;
            i && (i.removeListener("interactionStart", this._onInteractionStartCallback), i.removeListener("interactionEnd", this._onInteractionEndCallback)), this.stop();
            var n = r.clone(this._workers);
            r.each(n, function(t) {
                e.unregisterWorker(t)
            }), this._workers = []
        }, n.prototype.onMapEnabled = function() {
            var e = this.renderer.map.enabled;
            e ? this._startWorking() : this.stop()
        }, n.prototype.onCameraMove = function() {
            this.renderer.conf.workOnMove || (this._isCameraMoving = !0, this._updateMaxDuration())
        }, n.prototype.onCameraStabilized = function() {
            this._isCameraMoving = !1, this._updateMaxDuration()
        }, n.prototype.onInteractionStart = function() {
            this.renderer.conf.workOnMove || (this._isInteracting = !0, this._updateMaxDuration())
        }, n.prototype.onInteractionEnd = function() {
            this._isInteracting = !1, this._updateMaxDuration()
        }, n.prototype.isIdle = function() {
            return !this._isInteracting && !this._isCameraMoving
        }, n.prototype._updateMaxDuration = function() {
            this.isIdle() || !this._workWhenCameraMove ? this._maxDurationInMs = this._maxDurationIdle : this._maxDurationInMs = this._maxDurationMoving
        }, n.prototype.start = function() {
            this.isIdle() || !this._workWhenCameraMove ? this.restartInterval(this._maxDurationIdle, this._intervalIdle) : this.restartInterval(this._maxDurationMoving, this._intervalMoving)
        }, n.prototype.stop = function() {
            null != this._timeoutId && (clearTimeout(this._timeoutId), this._timeoutId = null)
        }, n.prototype.registerWorker = function(e, t) {
            e.funcName = t, this._workers.push(e)
        }, n.prototype.unregisterWorker = function(e) {
            var t = r.indexOf(this._workers, e);
            t > -1 ? this._workers.splice(t, 1) : console.warn("didnt find work for removal :" + this._name + ":" + e.funcName)
        }, n.prototype.restartInterval = function(e, t) {
            (this._maxDurationInMs != e || this._intervalInMs != t) && (this._maxDurationInMs = e, this._intervalInMs = t, this._startWorking())
        }, n.prototype._startWorking = function() {
            this.stop(), this._intervalInMs && (this._timeoutId = setTimeout(this._workHandler, this._intervalInMs))
        }, n.prototype.mustStopAnyWorkAsSoonAsPossible = function() {
            return this.renderer.map.enabled ? this._workWhenCameraMove ? !1 : this._isInteracting || this._isCameraMoving || this.renderer.isDragging() || this.renderer.isMoving() : !0
        }, n.prototype.work = function() {
            this._timeoutId = null, this._executeWork(), this._startWorking()
        }, n.prototype._executeWork = function() {
            var e = this.mustStopAnyWorkAsSoonAsPossible();
            if (!e)
                for (var t = Date.now(); this._workers.length > 0;) {
                    for (var i = !1, n = 0; n < this._workers.length; ++n) {
                        if (this.mustStopAnyWorkAsSoonAsPossible()) return;
                        var r = this._workers[n],
                            o = r(t);
                        if (o) {
                            i = !0, o();
                            var a = Date.now(),
                                s = a - t;
                            if (s > this._maxDurationInMs) return
                        }
                        if (!this.renderer.canWorkProcessorWorkMore(this)) return
                    }
                    if (!i) return
                }
        }, t.exports = n
    }, {
        underscore: 207
    }],
    417: [function(e, t, i) {
        "use strict";

        function n() {
            l = s();
            var e = /^\/\//.test(l) ? location.protocol + l : l,
                t = f.parse(e, !0);
            if (h = t.host, u = t.protocol, d = t.query.api_key, !h) {
                var i = window.location;
                h = i.host, u = i.protocol
            }
            return l
        }

        function r() {
            return h
        }

        function o() {
            return u
        }

        function a() {
            return d
        }

        function s() {
            if (document.currentScript) return c(document.currentScript).attr("src");
            for (var e, t = c("script"), i = t.length;
                (!e || e.indexOf(p) < 0) && i > 0;) {
                --i;
                var n = t[i];
                e = c(n).attr("src")
            }
            return e
        }
        var l, h, u, d, c = e("jquery"),
            f = e("url"),
            p = "api.js";
        t.exports = function() {
            return l
        }, t.exports.init = n, t.exports.getHost = r, t.exports.getProtocol = o, t.exports.getApiKey = a
    }, {
        jquery: 111,
        url: 208
    }],
    418: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            if (!r.isObject(e)) return e;
            null == t && (t = {});
            for (var i in e)
                if (e.hasOwnProperty(i)) {
                    var o = e[i];
                    if (null != o)
                        if (r.isObject(o)) {
                            var a = r.isArray(o) ? [] : {};
                            n(o, a), t[i] = a
                        } else t[i] = o
                }
            return t
        }
        var r = e("underscore");
        t.exports = n
    }, {
        underscore: 207
    }],
    419: [function(e, t, i) {
        "use strict";

        function n(e, t) {
            for (var i in e)
                if (e.hasOwnProperty(i)) {
                    var o = e[i];
                    r.isObject(o) ? (null == t[i] && (r.isArray(o) ? t[i] = [] : t[i] = {}), n(o, t[i])) : t[i] = o
                }
            return t
        }
        var r = e("underscore");
        t.exports = n
    }, {
        underscore: 207
    }],
    420: [function(e, t, i) {
        "use strict";
        var n = e("moment");
        e("moment/locale/fr"), t.exports = n, n.init = function(e) {
            var t = e.conf.getLanguage();
            n.locale(t)
        }, n.fn.fromNowInPast = function(e) {
            var t = n(),
                i = t > this ? this : t;
            return i.fromNow(e)
        };
        var r = 1e3,
            o = 6e4,
            a = 36e5,
            s = 864e5,
            l = 6048e5;
        n.fn.twitterShort = function() {
            var e = Math.abs(this.diff(n())),
                t = null,
                i = null;
            if (r >= e) t = "seconds", i = 1;
            else if (o > e) t = "seconds";
            else if (a > e) t = "minutes";
            else if (s > e) t = "hours";
            else {
                if (!(l > e)) return this.format("M/D/YY");
                t = "days"
            }
            return i && t || (i = n.duration(e)[t]()), i + t.substring(0, 1)
        }
    }, {
        moment: 149,
        "moment/locale/fr": 148
    }],
    421: [function(e, t, i) {
        "use strict";

        function n() {
            "undefined" == typeof console && (window.console = {}), o.each(["debug", "info", "log", "warn", "error", "trace"], function(e) {
                console[e] || (console[e] = r)
            }), "undefined" == typeof Float32Array && (console.warn("Float32Array is not defined"), window.Float32Array = function() {})
        }

        function r() {}
        var o = e("underscore");
        t.exports = {
            install: n
        }
    }, {
        underscore: 207
    }],
    422: [function(e, t, i) {
        "use strict";

        function n() {
            this._workerConsumers = [], this._workerInitialisedListeners = [], this._allWorkers = [], this._availableWorkers = [], this._currentConsumers = {}, this._isEnabled = !1, this._isInitialised = !1
        }
        var r = e("underscore"),
            o = e("./WorkerProxy"),
            a = window.URL || window.webkitURL ? (window.URL || window.webkitURL).revokeObjectURL : null,
            s = "_worker.js",
            l = 2,
            h = !1,
            u = h ? console : {
                log: function() {}
            };
        t.exports = new n;
        var d = n.prototype;
        d.init = function() {
            if (!this._isInitialised)
                for (var e = r.bind(function(e, t) {
                        e ? (this._allWorkers = r.without(this.allWorkers, t), console.error("Cannot create map workers: " + e.message)) : (this._availableWorkers.push(t), t.workerBlobUrl && (a(t.workerBlobUrl), delete t.workerBlobUrl), this._isEnabled = !0, this._handleNextRequest()), this._isInitialised = !0, this._notifyWorkerInitialisedListeners(e)
                    }, this), t = r.bind(function(e, t) {
                        this._allWorkers = r.without(this._allWorkers, t), console.error('Map worker "' + t.id + '" in error'), 0 == this._allWorkers.length && (console.log("Disabling map workers"), this._isEnabled = !1)
                    }, this), i = 0; l > i; i++) {
                    var n = new o(s);
                    this._allWorkers.push(n), n.onReady(e), n.addErrorHandler(t), n.load()
                }
        }, d.onInitialised = function(e) {
            this._isInitialised ? e() : this._addWorkerInitialisedListener(e)
        }, d.isWorkerEnabled = function() {
            return this._isEnabled
        }, d.registerWorkerConsumer = function(e) {
            -1 == this._workerConsumers.indexOf(e) && (e.currentConsumption = 0, this._workerConsumers.push(e))
        }, d.unregisterWorkerConsumer = function(e) {
            var t = this._workerConsumers.indexOf(e); - 1 != t && this._workerConsumers.splice(t, 1)
        }, d.requestWorker = function(e) {
            this._availableWorkers.length > 0 && this._consumeWorker(e)
        }, d.releaseWorker = function(e) {
            var t = this._currentConsumers[e.id];
            delete this._currentConsumers[e.id], t && (t.currentConsumption--, u.log("Worker " + e.id + " released by " + t.name)), this._availableWorkers.push(e), this._handleNextRequest()
        }, d._addWorkerInitialisedListener = function(e) {
            this._workerInitialisedListeners.push(e)
        }, d._notifyWorkerInitialisedListeners = function(e) {
            r.each(this._workerInitialisedListeners, function(t) {
                t(e)
            }), this._workerInitialisedListeners = []
        }, d._handleNextRequest = function() {
            for (var e = null, t = 0; t < this._workerConsumers.length; t++) {
                var i = this._workerConsumers[t];
                if (i.currentConsumption < i.maxWorkers) {
                    if (i.needsWorker()) {
                        e = i.consumer;
                        break
                    }
                    u.log("Skipping " + i.name + " since does not need worker")
                } else u.log("Skipping " + i.name + " since consuming already")
            }
            null != e ? this._consumeWorker(e) : u.log("No consumers")
        }, d._consumeWorker = function(e) {
            if (this._availableWorkers.length > 0) {
                for (var t = null, i = -1, n = 0; n < this._workerConsumers.length; n++)
                    if (this._workerConsumers[n].consumer == e) {
                        t = this._workerConsumers[n], i = n;
                        break
                    }
                if (t && t.currentConsumption < t.maxWorkers) {
                    var r = this._availableWorkers.shift();
                    this._workerConsumers.splice(i, 1), this._workerConsumers.push(t), this._currentConsumers[r.id] = t, t.currentConsumption++, u.log("Worker " + r.id + " consumed by " + t.name + ", currently consuming " + t.currentConsumption), t.workerCallback(r)
                }
            }
        }
    }, {
        "./WorkerProxy": 423,
        underscore: 207
    }],
    423: [function(e, t, i) {
        "use strict";

        function n(e) {
            this.id = "wp_" + ++l, this._callbacks = {}, this.workerSupported = window.Worker, this._isReady = !1, this._workerUrl = e, this._readyHandlers = [], this._errorHandlers = [], this._currentSyncMessageReturned = !1
        }
        var r = e("underscore"),
            o = e("../StaticFileResolver"),
            a = window.URL || window.webkitURL ? (window.URL || window.webkitURL).revokeObjectURL : null,
            s = window.URL || window.webkitURL ? (window.URL || window.webkitURL).createObjectURL : null,
            l = 0,
            h = "f4map.com";
        t.exports = n, n.workerBlobs = {}, n.waitingWorkerLoadersCallback = {}, n.loadingBlob = {}, n.prototype.load = function() {
            this.createWorkerImpl(this._workerUrl, r.bind(function(e) {
                e ? this.notifyOnReady(e) : this.buildApi()
            }, this))
        }, n.prototype.createWorkerImpl = function(e, t) {
            if (!this.workerSupported) return void r.defer(function() {
                t(new Error("Web workers not available on this platform"))
            });
            var i = o(e);
            if (null != n.workerBlobs[i]) this.createWorkerFromUrl(URL.createObjectURL(n.workerBlobs[i]), t);
            else if (n.loadingBlob[i]) null == n.waitingWorkerLoadersCallback[i] && (n.waitingWorkerLoadersCallback[i] = []), n.waitingWorkerLoadersCallback[i].push({
                target: this,
                onReadyCallback: t
            });
            else {
                n.loadingBlob[i] = !0;
                var a = new XMLHttpRequest;
                a.open("GET", i, !0), a.responseType = "blob";
                var l = this;
                a.onload = function() {
                    if (200 == this.status) try {
                        var r = this.response;
                        n.workerBlobs[i] = r, l.createWorkerFromUrl(s(r), t), delete n.loadingBlob[i], l.handleWaitingLoaderCallbacks(i)
                    } catch (o) {
                        t(new Error("Cannot create Blob object"))
                    } else {
                        var a = 'Unable to load worker "' + e + '" at ' + i + '. Got error "' + this.statusText + '"';
                        t(new Error(a))
                    }
                }, a.send()
            }
        }, n.prototype.handleWaitingLoaderCallbacks = function(e) {
            var t = n.waitingWorkerLoadersCallback[e],
                i = n.workerBlobs[e];
            t && i && (r.each(t, function(e) {
                var t = e.target,
                    n = e.onReadyCallback;
                t.createWorkerFromUrl(URL.createObjectURL(i), n)
            }), delete n.waitingWorkerLoadersCallback[e])
        }, n.prototype.createWorkerFromUrl = function(e, t) {
            try {
                this._proxyWorker = new Worker(e), this.workerBlobUrl = e, this._proxyWorker.onmessage = r.bind(this.onMessage, this), this._proxyWorker.onerror = r.bind(this.onError, this), t()
            } catch (i) {
                a(e), t(i)
            }
        }, n.prototype.buildApi = function() {
            this.sendMessage("__getApi", {
                success: r.bind(this.handleApiReceived, this),
                error: r.bind(this.handleApiRequestError, this)
            })
        }, n.prototype.handleApiReceived = function(e, t) {
            r.each(t, function(e) {
                var t = e.name;
                this[t] = this.makeWorkerProxyFunction(t)
            }, this), this.notifyOnReady()
        }, n.prototype.handleApiRequestError = function(e, t) {
            this.notifyOnReady(t)
        }, n.prototype.makeWorkerProxyFunction = function(e) {
            return r.bind(function(t) {
                this._isReady && this.sendMessage(e, {
                    data: t.data,
                    success: t.success,
                    error: t.error,
                    transfers: t.transfers
                })
            }, this)
        }, n.prototype.notifyOnReady = function(e) {
            this._isReady = !0, r.defer(r.bind(function() {
                for (var t = 0; t < this._readyHandlers.length; t++) this._readyHandlers[t](e, this);
                this._readyHandlers = []
            }, this))
        }, n.prototype.notifyOnError = function(e) {
            r.defer(r.bind(function() {
                for (var t = 0; t < this._errorHandlers.length; t++) this._errorHandlers[t](e, this)
            }, this))
        }, n.prototype.sendMessage = function(e, t) {
            var i = "msg" + Date.now() + "-" + Math.random(),
                n = t.data,
                r = t.success,
                o = t.error,
                a = t.transfer,
                s = {
                    origin: h,
                    messageId: i,
                    cmd: e,
                    data: n
                };
            this._callbacks[i] = {
                success: r,
                error: o
            }, this._proxyWorker.postMessage(s, a)
        }, n.prototype.onMessage = function(e) {
            var t = e.data,
                i = t.messageId,
                n = t.data,
                r = t.error,
                o = t.origin;
            if (o && o == h) {
                var a = this._callbacks[i];
                a ? (delete this._callbacks[i], r ? a.error ? a.error(this, r) : console.error("Caught unhandled error : " + r) : a.success && a.success(this, n)) : console.log("Got response for non-existant message callback")
            }
        }, n.prototype.onError = function(e) {
            this.notifyOnError(e)
        }, n.prototype.onReady = function(e) {
            this._isReady ? e(null, this) : this._readyHandlers.push(e)
        }, n.prototype.addErrorHandler = function(e) {
            this._errorHandlers.push(e)
        }
    }, {
        "../StaticFileResolver": 410,
        underscore: 207
    }],
    424: [function(e, t, i) {
        "use strict";
        ! function(e) {
            return e.ajaxTransport(function(t, i, n) {
                if (t.crossDomain && !e.support.cors && window.XDomainRequest) {
                    var r;
                    return {
                        send: function(i, n) {
                            r = new window.XDomainRequest, r.onload = function() {
                                var i = {
                                    text: r.responseText
                                };
                                if (r.contentType.match(/\/xml/)) {
                                    var o = new ActiveXObject("Microsoft.XMLDOM");
                                    if (o.async = !1, o.loadXML(r.responseText), i.xml = o, 0 != e(o).children("error").length) {
                                        var a = e(o).find("error");
                                        n(parseInt(a.attr("response_code")), a.attr("message_key"), i)
                                    } else n(200, "success", i)
                                } else r.contentType.match(/\/json/) && !t.dataType && console.warn("missing dataType, json will not be parsed in IE9- : ", t.url), n(200, "success", i)
                            }, r.onprogress = function() {}, r.onerror = r.ontimeout = function() {
                                var e = {
                                    text: r.responseText || "XDR failed."
                                };
                                n(555, "failed", e)
                            }, r.open(t.type, t.url), "POST" == t.type ? r.send(t.data) : r.send()
                        },
                        abort: function() {
                            r && r.abort()
                        }
                    }
                }
                return null
            }), {}
        }(jQuery)
    }, {}],
    425: [function(e, t, i) {
        "use strict";
        ! function(e, t, i) {
            function n(e) {
                return e
            }

            function r(e) {
                return decodeURIComponent(e.replace(o, " "))
            }
            var o = /\+/g,
                a = e.cookie = function(o, s, l) {
                    if (s !== i) {
                        if (l = e.extend({}, a.defaults, l), null === s && (l.expires = -1), "number" == typeof l.expires) {
                            var h = l.expires,
                                u = l.expires = new Date;
                            u.setDate(u.getDate() + h)
                        }
                        return s = a.json ? JSON.stringify(s) : String(s), t.cookie = [encodeURIComponent(o), "=", a.raw ? s : encodeURIComponent(s), l.expires ? "; expires=" + l.expires.toUTCString() : "", l.path ? "; path=" + l.path : "", l.domain ? "; domain=" + l.domain : "", l.secure ? "; secure" : ""].join("")
                    }
                    for (var d = a.raw ? n : r, c = t.cookie.split("; "), f = 0, p = c.length; p > f; f++) {
                        var m = c[f].split("=");
                        if (d(m.shift()) === o) {
                            var g = d(m.join("="));
                            return a.json ? JSON.parse(g) : g
                        }
                    }
                    return null
                };
            a.defaults = {}, e.removeCookie = function(t, i) {
                return null !== e.cookie(t) ? (e.cookie(t, null, i), !0) : !1
            }
        }(jQuery, document)
    }, {}],
    426: [function(e, t, i) {
        "use strict";
        ! function(e) {
            e.easing.jswing = e.easing.swing, e.extend(e.easing, {
                def: "easeOutQuad",
                swing: function(t, i, n, r, o) {
                    return e.easing[e.easing.def](t, i, n, r, o)
                },
                easeInQuad: function(e, t, i, n, r) {
                    return n * (t /= r) * t + i
                },
                easeOutQuad: function(e, t, i, n, r) {
                    return -n * (t /= r) * (t - 2) + i
                },
                easeInOutQuad: function(e, t, i, n, r) {
                    return (t /= r / 2) < 1 ? n / 2 * t * t + i : -n / 2 * (--t * (t - 2) - 1) + i
                },
                easeInCubic: function(e, t, i, n, r) {
                    return n * (t /= r) * t * t + i
                },
                easeOutCubic: function(e, t, i, n, r) {
                    return n * ((t = t / r - 1) * t * t + 1) + i
                },
                easeInOutCubic: function(e, t, i, n, r) {
                    return (t /= r / 2) < 1 ? n / 2 * t * t * t + i : n / 2 * ((t -= 2) * t * t + 2) + i
                },
                easeInQuart: function(e, t, i, n, r) {
                    return n * (t /= r) * t * t * t + i
                },
                easeOutQuart: function(e, t, i, n, r) {
                    return -n * ((t = t / r - 1) * t * t * t - 1) + i
                },
                easeInOutQuart: function(e, t, i, n, r) {
                    return (t /= r / 2) < 1 ? n / 2 * t * t * t * t + i : -n / 2 * ((t -= 2) * t * t * t - 2) + i
                },
                easeInQuint: function(e, t, i, n, r) {
                    return n * (t /= r) * t * t * t * t + i
                },
                easeOutQuint: function(e, t, i, n, r) {
                    return n * ((t = t / r - 1) * t * t * t * t + 1) + i
                },
                easeInOutQuint: function(e, t, i, n, r) {
                    return (t /= r / 2) < 1 ? n / 2 * t * t * t * t * t + i : n / 2 * ((t -= 2) * t * t * t * t + 2) + i
                },
                easeInSine: function(e, t, i, n, r) {
                    return -n * Math.cos(t / r * (Math.PI / 2)) + n + i
                },
                easeOutSine: function(e, t, i, n, r) {
                    return n * Math.sin(t / r * (Math.PI / 2)) + i
                },
                easeInOutSine: function(e, t, i, n, r) {
                    return -n / 2 * (Math.cos(Math.PI * t / r) - 1) + i
                },
                easeInExpo: function(e, t, i, n, r) {
                    return 0 == t ? i : n * Math.pow(2, 10 * (t / r - 1)) + i
                },
                easeOutExpo: function(e, t, i, n, r) {
                    return t == r ? i + n : n * (-Math.pow(2, -10 * t / r) + 1) + i
                },
                easeInOutExpo: function(e, t, i, n, r) {
                    return 0 == t ? i : t == r ? i + n : (t /= r / 2) < 1 ? n / 2 * Math.pow(2, 10 * (t - 1)) + i : n / 2 * (-Math.pow(2, -10 * --t) + 2) + i
                },
                easeInCirc: function(e, t, i, n, r) {
                    return -n * (Math.sqrt(1 - (t /= r) * t) - 1) + i
                },
                easeOutCirc: function(e, t, i, n, r) {
                    return n * Math.sqrt(1 - (t = t / r - 1) * t) + i
                },
                easeInOutCirc: function(e, t, i, n, r) {
                    return (t /= r / 2) < 1 ? -n / 2 * (Math.sqrt(1 - t * t) - 1) + i : n / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + i
                },
                easeInElastic: function(e, t, i, n, r) {
                    var o = 1.70158,
                        a = 0,
                        s = n;
                    if (0 == t) return i;
                    if (1 == (t /= r)) return i + n;
                    if (a || (a = .3 * r), s < Math.abs(n)) {
                        s = n;
                        var o = a / 4
                    } else var o = a / (2 * Math.PI) * Math.asin(n / s);
                    return -(s * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * r - o) * (2 * Math.PI) / a)) + i
                },
                easeOutElastic: function(e, t, i, n, r) {
                    var o = 1.70158,
                        a = 0,
                        s = n;
                    if (0 == t) return i;
                    if (1 == (t /= r)) return i + n;
                    if (a || (a = .3 * r), s < Math.abs(n)) {
                        s = n;
                        var o = a / 4
                    } else var o = a / (2 * Math.PI) * Math.asin(n / s);
                    return s * Math.pow(2, -10 * t) * Math.sin((t * r - o) * (2 * Math.PI) / a) + n + i
                },
                easeInOutElastic: function(e, t, i, n, r) {
                    var o = 1.70158,
                        a = 0,
                        s = n;
                    if (0 == t) return i;
                    if (2 == (t /= r / 2)) return i + n;
                    if (a || (a = r * (.3 * 1.5)), s < Math.abs(n)) {
                        s = n;
                        var o = a / 4
                    } else var o = a / (2 * Math.PI) * Math.asin(n / s);
                    return 1 > t ? -.5 * (s * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * r - o) * (2 * Math.PI) / a)) + i : s * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * r - o) * (2 * Math.PI) / a) * .5 + n + i
                },
                easeInBack: function(e, t, i, n, r, o) {
                    return void 0 == o && (o = 1.70158), n * (t /= r) * t * ((o + 1) * t - o) + i
                },
                easeOutBack: function(e, t, i, n, r, o) {
                    return void 0 == o && (o = 1.70158), n * ((t = t / r - 1) * t * ((o + 1) * t + o) + 1) + i
                },
                easeInOutBack: function(e, t, i, n, r, o) {
                    return void 0 == o && (o = 1.70158), (t /= r / 2) < 1 ? n / 2 * (t * t * (((o *= 1.525) + 1) * t - o)) + i : n / 2 * ((t -= 2) * t * (((o *= 1.525) + 1) * t + o) + 2) + i
                },
                easeInBounce: function(t, i, n, r, o) {
                    return r - e.easing.easeOutBounce(t, o - i, 0, r, o) + n
                },
                easeOutBounce: function(e, t, i, n, r) {
                    return (t /= r) < 1 / 2.75 ? n * (7.5625 * t * t) + i : 2 / 2.75 > t ? n * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + i : 2.5 / 2.75 > t ? n * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + i : n * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + i
                },
                easeInOutBounce: function(t, i, n, r, o) {
                    return o / 2 > i ? .5 * e.easing.easeInBounce(t, 2 * i, 0, r, o) + n : .5 * e.easing.easeOutBounce(t, 2 * i - o, 0, r, o) + .5 * r + n
                }
            })
        }(jQuery)
    }, {}],
    427: [function(e, t, i) {
        "use strict";
        ! function(e) {
            function t(t) {
                var i = t.handler,
                    n = (t.namespace || "").toLowerCase().split(" ");
                n = e.map(n, function(e) {
                    return e.split(".")
                }), (1 !== n.length || "" !== n[0] && "autocomplete" !== n[0].substring(0, 12) && "accordion" !== n[0].substring(0, 9) && "tabs" !== n[0].substring(0, 4) && "menu" !== n[0].substring(0, 4)) && (t.handler = function(t) {
                    if (this === t.target || !/textarea|select/i.test(t.target.nodeName) && "text" !== t.target.type && "true" != e(t.target).prop("contenteditable")) {
                        var r = "keypress" !== t.type && e.hotkeys.specialKeys[t.which],
                            o = String.fromCharCode(t.which).toLowerCase(),
                            a = "",
                            s = {};
                        t.altKey && "alt" !== r && (a += "alt_"), t.ctrlKey && "ctrl" !== r && (a += "ctrl_"), t.metaKey && !t.ctrlKey && "meta" !== r && (a += "meta_"), t.shiftKey && "shift" !== r && (a += "shift_"), r ? s[a + r] = !0 : (s[a + o] = !0, s[a + e.hotkeys.shiftNums[o]] = !0, "shift_" === a && (s[e.hotkeys.shiftNums[o]] = !0));
                        for (var l = 0, h = n.length; h > l; l++)
                            if (s[n[l]]) return i.apply(this, arguments)
                    }
                })
            }
            e.hotkeys = {
                version: "0.8+",
                specialKeys: {
                    8: "backspace",
                    9: "tab",
                    13: "return",
                    16: "shift",
                    17: "ctrl",
                    18: "alt",
                    19: "pause",
                    20: "capslock",
                    27: "esc",
                    32: "space",
                    33: "pageup",
                    34: "pagedown",
                    35: "end",
                    36: "home",
                    37: "left",
                    38: "up",
                    39: "right",
                    40: "down",
                    45: "insert",
                    46: "del",
                    96: "0",
                    97: "1",
                    98: "2",
                    99: "3",
                    100: "4",
                    101: "5",
                    102: "6",
                    103: "7",
                    104: "8",
                    105: "9",
                    106: "*",
                    107: "+",
                    109: "-",
                    110: ".",
                    111: "/",
                    112: "f1",
                    113: "f2",
                    114: "f3",
                    115: "f4",
                    116: "f5",
                    117: "f6",
                    118: "f7",
                    119: "f8",
                    120: "f9",
                    121: "f10",
                    122: "f11",
                    123: "f12",
                    144: "numlock",
                    145: "scroll",
                    188: ",",
                    190: ".",
                    191: "/",
                    224: "meta"
                },
                shiftNums: {
                    "`": "~",
                    1: "!",
                    2: "@",
                    3: "#",
                    4: "$",
                    5: "%",
                    6: "^",
                    7: "&",
                    8: "*",
                    9: "(",
                    0: ")",
                    "-": "_",
                    "=": "+",
                    ";": ": ",
                    "'": '"',
                    ",": "<",
                    ".": ">",
                    "/": "?",
                    "\\": "|"
                }
            }, e.each(["keydown", "keyup", "keypress"], function() {
                e.event.special[this] = {
                    add: t
                }
            })
        }(jQuery)
    }, {}],
    428: [function(e, t, i) {
        e("jade/lib/runtime.js");
        t.exports = function(e) {
            var t = [];
            return t.push('<div id="f4map-centered-dialog"><div id="f4map-centered-dialog-background"></div><div id="f4map-centered-dialog-box"><button id="f4map-centered-dialog-close" type="button"></button><div id="f4map-centered-dialog-content"></div></div></div>'), t.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    429: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = {},
                a = e || {};
            return function(e, t) {
                o.credit = function(e, t, o) {
                    this && this.block, this && this.attributes || {};
                    n.push("<li><a" + r.attr("href", t, !0, !1) + ' target="_blank"' + r.attr("title", o, !0, !1) + ">" + r.escape(null == (i = e) ? "" : i) + "</a></li>")
                }, n.push("<h1>" + r.escape(null == (i = e(t) ? t("footer_credits") : "") ? "" : i) + "</h1><ul>"), o.credit("F4map Â©2011-2016 F4", "//www.f4map.com"), o.credit("Map data Â© OpenStreetMap contributors", "http://www.openstreetmap.org/copyright"), o.credit("Digital ElevationData", "http://www.viewfinderpanoramas.org/dem3.html"), o.credit("World Weather Online", "http://www.worldweatheronline.com", "Free local weather content provider"), o.credit("node.js", "http://nodejs.org/"), o.credit("Nominatim", "http://nominatim.openstreetmap.org/"), o.credit("Tilemill", "http://mapbox.com/tilemill/"), o.credit("PostgreSQL", "http://www.postgresql.org/"), o.credit("PostGIS", "http://postgis.net/"), o.credit("Mapnik", "http://mapnik.org"), o.credit("Varnish", "https://www.varnish-cache.org/"), o.credit("jQuery", "http://jquery.com/"), o.credit("Leaflet", "http://leafletjs.com/"), n.push("</ul>")
            }.call(this, "Boolean" in a ? a.Boolean : "undefined" != typeof Boolean ? Boolean : void 0, "t" in a ? a.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    430: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = e || {};
            return function(e) {
                n.push('<div class="f4map-draw"><button type="button" class="f4map-draw-polygon"><i class="fa fa-pencil-square-o"></i>&nbsp;' + r.escape(null == (i = e("polygone")) ? "" : i) + '</button><button type="button" class="f4map-draw-polyline"><i class="fa fa-pencil"></i>&nbsp;' + r.escape(null == (i = e("polyline")) ? "" : i) + '</button><button type="button" class="f4map-draw-hand enabled f4map-last"><i class="fa fa-stop"></i>&nbsp;' + r.escape(null == (i = e("stop-drawing")) ? "" : i) + "</button></div>")
            }.call(this, "t" in o ? o.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    431: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = e || {};
            return function(e, t) {
                n.push('<div class="f4map-general-spinner"><i class="f4map-general-spinner-logo"></i>'), e(t) && n.push('<span class="f4map-general-spinner-loading">' + r.escape(null == (i = t("spinner-loading")) ? "" : i) + '</span><span style="display:none;" class="f4map-general-spinner-computing">' + r.escape(null == (i = t("spinner-computing")) ? "" : i) + "</span>"), n.push("</div>")
            }.call(this, "Boolean" in o ? o.Boolean : "undefined" != typeof Boolean ? Boolean : void 0, "t" in o ? o.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    432: [function(e, t, i) {
        e("jade/lib/runtime.js");
        t.exports = function(e) {
            var t = [];
            return t.push('<div class="f4map-infoWindow"><div class="f4map-btnCloseInfoWindow">x</div><div class="f4map-infoWindowContent"></div><div class="f4map-arrow"><div class="leftContainer"><div class="leftArrowPart"></div></div><div class="rightContainer"><div class="rightArrowPart"></div></div></div></div>'), t.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    433: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = e || {};
            return function(e, t) {
                n.push('<div class="f4map-footer"><div class="f4map-scale"></div><div class="f4map-footer-text"><span class="f4map-copyright"><a href="http://www.f4map.com" target="_blank" class="f4map-link">F4map&nbsp;Â©&nbsp;F4</a></span><span class="f4map-osm-contributors">'), e(t) && n.push(r.escape(null == (i = t("footer_mapData")) ? "" : i)), n.push('&nbsp;Â©&nbsp;<a href="http://www.openstreetmap.org/copyright" target="_blank" class="f4map-osm-contributors-link">'), e(t) && n.push(r.escape(null == (i = t("footer_osmContributors")) ? "" : i)), n.push('</a><span class="f4map-osm-sync">&nbsp;('), e(t) && n.push(r.escape(null == (i = t("footer_updated_prefix")) ? "" : i)), n.push('<span class="f4map-osm-sync-date"></span>'), e(t) && n.push(r.escape(null == (i = t("footer_updated_suffix")) ? "" : i)), n.push(')</span></span><a data-placement="bottom" class="f4map-credits">'), e(t) && n.push(r.escape(null == (i = t("footer_credits")) ? "" : i)), n.push("</a></div></div>")
            }.call(this, "Boolean" in o ? o.Boolean : "undefined" != typeof Boolean ? Boolean : void 0, "t" in o ? o.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    434: [function(e, t, i) {
        e("jade/lib/runtime.js");
        t.exports = function(e) {
            var t = [];
            return t.push('<div class="f4map-footer"><div class="f4map-scale"></div><div class="f4map-footer-text"></div></div>'), t.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    435: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = e || {};
            return function(e, t) {
                n.push('<div class="f4map-nav"><div' + r.attr("title", e(t) ? t("tooltip-nav-zoom") : "", !0, !1) + ' class="f4map-zoom"><button type="button" class="f4map-zoomin"></button></div><div' + r.attr("title", e(t) ? t("tooltip-nav-unzoom") : "", !0, !1) + ' class="f4map-zoom"><button type="button" class="f4map-zoomout"></button></div><button' + r.attr("title", e(t) ? t("tooltip-nav-geoloc") : "", !0, !1) + ' type="button" class="f4map-geoloc"></button><div' + r.attr("title", e(t) ? t("tooltip-nav-camera-3D") : "", !0, !1) + ' class="f4map-3D-2D"><div class="f4map-3D-2D-to2D"></div><div class="f4map-3D-2D-to3D"></div></div><div' + r.attr("title", e(t) ? t("tooltip-nav-rotate-3D") : "", !0, !1) + ' class="f4map-compass"><button type="button" class="f4map-compass-center"><div class="f4map-compass-needle"></div></button><button type="button" class="f4map-compass-left"></button><button type="button" class="f4map-compass-right"></button></div><label class="f4map-mode"><input type="checkbox" class="f4map-mode-3d"/>'), e(t) && n.push("" + r.escape(null == (i = t("overlay_3dMap")) ? "" : i)), n.push("</label></div>")
            }.call(this, "Boolean" in o ? o.Boolean : "undefined" != typeof Boolean ? Boolean : void 0, "t" in o ? o.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    436: [function(e, i, n) {
        var r = e("jade/lib/runtime.js");
        i.exports = function(e) {
            var i, n = [],
                o = e || {};
            return function(e) {
                n.push('<div class="f4map-touchDrag-dialog"><div class="f4map-touchDrag-dialog-content">' + r.escape(null == (i = e("touchDragMessage")) ? "" : i) + "</div></div>")
            }.call(this, "t" in o ? o.t : "undefined" != typeof t ? t : void 0), n.join("")
        }
    }, {
        "jade/lib/runtime.js": 109
    }],
    437: [function(e, t, i) {
        t.exports = {
            fingerprints: {
                "robots.txt": "19c3569c09006c53a3143b44ac6101db82f2df78",
                "cursors/closedhand.cur": "afdc1b09a85db2acc84e029007277ed62c730624",
                "cursors/rotate.cur": "ceff7475535f4b3eb61308e513cf5c608d15cf0f",
                "data/models/Lib_Object/LibOut_Boat.bis": "196e3a3e0f320a8dd504cc3dadcfab63cd8c6ce4",
                "data/models/Lib_Object/LibOut_Bus_A.bis": "3ac2012f916e6bb833002efe13afd97d0a95fcef",
                "data/models/Lib_Object/LibOut_Bush_00.bis": "606d41cbf0194fdd53ecc53398d896de151132cc",
                "data/models/Lib_Object/LibOut_Car_A.bis": "696b5f5d8f7dbaf526376abe17185eff5c4c3a77",
                "data/models/Lib_Object/LibOut_CherryTree.bis": "4a69d249cda29b35c62b062b18b42b29dd808278",
                "data/models/Lib_Object/LibOut_Conifer_00.bis": "246b4579af5cda27a1e6fcb135327a657fa1aec5",
                "data/models/Lib_Object/LibOut_Conifer_LOD.bis": "cc6029c88e684c733fca5edbab03b40eb4324f73",
                "data/models/Lib_Object/LibOut_Conifer_Xmas.bis": "6505e8deb3355714011c5292eece559909dda737",
                "data/models/Lib_Object/LibOut_Conifer_Xmas_LOD.bis": "c19d7d1b7bfabc975736de1b73eee9306b3d5b6d",
                "data/models/Lib_Object/LibOut_Conifer_Xmas_Snow.bis": "6505e8deb3355714011c5292eece559909dda737",
                "data/models/Lib_Object/LibOut_Conifer_Xmas_Snow_LOD.bis": "77b43628baf1f7a133185bbe96c88d92ec7c9553",
                "data/models/Lib_Object/LibOut_Deciduous_00.bis": "305c1a18294328782dffe8f49c471b5840d474a1",
                "data/models/Lib_Object/LibOut_Deciduous_LOD.bis": "97f11d7b51832ed3fa93a01b749cd33a24f5236a",
                "data/models/Lib_Object/LibOut_Flag.bis": "c081a0603638117a018ec3162b9c843eed20180d",
                "data/models/Lib_Object/LibOut_Grave.bis": "002ca0446871cd9d0270a7fcebbdf9d1625931ab",
                "data/models/Lib_Object/LibOut_Grue.bis": "64651123098a195739187b3e1569792faa1c8a65",
                "data/models/Lib_Object/LibOut_Palm_00.bis": "237560037c7a93c2828791dfe80ce930f7433152",
                "data/models/Lib_Object/LibOut_Palm_LOD.bis": "bab33c4c48d01cbb30b3e10cd5bf5c4437ba325f",
                "data/models/Lib_Object/LibOut_PetroleumWell.bis": "131b7227b06338ff16d1c23b0fbe3b8ffbc8c804",
                "data/models/Lib_Object/LibOut_Plane.bis": "9d6a8d1bd0480c687a3ff7550def52e3cd48df0e",
                "data/models/Lib_Object/LibOut_PowerPole.bis": "fe8b4297701039b514b519ded86f5cad2dc0cc7a",
                "data/models/Lib_Object/LibOut_PowerTower.bis": "464aa0c54de931e7b8f92ca32f07f62ece9b9625",
                "data/models/Lib_Object/LibOut_Rock.bis": "dc13f069305a437a5c664d1fc6976bb336ee6563",
                "data/models/Lib_Object/LibOut_SkiOeuf.bis": "fb2f55c608c98ecd862a9e83c595d0ef55a44ade",
                "data/models/Lib_Object/LibOut_SkiPylon.bis": "227f461b59c142bc623bdf33adc9c5fb9f20f7fa",
                "data/models/Lib_Object/LibOut_SkiTelepherique.bis": "2507e939682097fad489c821babf6c7ae9bbfc07",
                "data/models/Lib_Object/LibOut_SkiTelesiege.bis": "2ce059a240192057d504921524add5469703acbc",
                "data/models/Lib_Object/LibOut_Sky.bis": "68c35daaa958cdd30bb89b3e52a77ca73e381c3f",
                "data/models/Lib_Object/LibOut_Snowman.bis": "4094b80a1aa2a6dfa85bc8a71a6091bdc049de3b",
                "data/models/Lib_Object/LibOut_StreetLamp_00.bis": "ac1f74884a959729013d18812ee2e87e9e2b92dc",
                "data/models/Lib_Object/LibOut_SubMarine.bis": "e0bf495258e8a68e8ede533fd34b23558aa0e6e0",
                "data/models/Lib_Object/Lighthouse.bis": "c6f68618b83e466560c8c97061dd2100c92ae0d3",
                "data/models/Lib_Object/Venus.bis": "32c34d13e9c264509ef3fd86cc63b8f78f1c2662",
                "data/models/Lib_Object/WindGenerator.bis": "f6a3d8800845e6da3ef043f7ef3239c6854c59f9",
                "data/textures/EnvMap.jpg": "b742f3612095cd27375e484727dc84b1d84991ae",
                "data/textures/Fence.png": "439520657e1725e4317e24503e0c6e03bd08f7fb",
                "data/textures/GradientSky.png": "1afa71f8646c7844083c625349d86c7ee6b4c971",
                "data/textures/LensFlare.png": "17c306fb4817c374cb5796f91261ed6fba5b0d08",
                "data/textures/LibOut_CherryTree_Flowers.png": "4df86152d7061690c18fda90cb4582721545279c",
                "data/textures/LibOut_CherryTree_Leaves.png": "7b1564f62a5fd397417f36fc571d5bd2ec2af3c3",
                "data/textures/LibOut_CherryTree_WhiteFlowers.png": "ea434883e6b6cc11e82c1d9d37022b82aa9dec96",
                "data/textures/LibOut_Conifer_00.png": "df5a242527197a5b6408e32c41d2c1441b47be4d",
                "data/textures/LibOut_Conifer_Xmas.png": "d70fba4a26bb5c510c5b22dc065ee418ec48691c",
                "data/textures/LibOut_Conifer_Xmas_LOD.png": "891b155ad64ca415fca2f6845101dec8949112ab",
                "data/textures/LibOut_Conifer_Xmas_Snow.png": "f8d4a8c39b1aea72c7864965fdc43ad62920c2b2",
                "data/textures/LibOut_Deciduous_00.png": "bd9135c6b6c2cd78c41c23fa50643d16ae7fe31c",
                "data/textures/LibOut_Flag.jpg": "d177485c0a659a120fe32fc9b4dfb83bf072a81e",
                "data/textures/LibOut_Grue.png": "cf7d87c85f9592c14f17881f944cb837e0c2ab8b",
                "data/textures/LibOut_PackedTexture.png": "7a0d6a79a4a542a741205eaf750f22c057165e54",
                "data/textures/LibOut_Palm_00.png": "91daf1d5bfc754d61152c67b3d3eeccdc5c66a2d",
                "data/textures/LibOut_PowerTower.png": "ed125090fe05532e795a78932162fb162549df0e",
                "data/textures/LibOut_Rock.jpg": "8f0bc934c0b08bb5ce62269c8b5048a599b01c6f",
                "data/textures/LibOut_SkiOeuf.jpg": "52d5b6cddc3c1f98ef5e1a3a71a9024897e30336",
                "data/textures/LibOut_SkiPylon.png": "fbc4065844de740aa3003cba015f31429b737fe4",
                "data/textures/LibOut_SkiTelepherique.jpg": "4417b43f871e2d9f52b7e634a7071ad637c61173",
                "data/textures/LibOut_SkiTelesiege.jpg": "7ebadad020d02de99d6085ab50f8dfbb9447f761",
                "data/textures/LibOut_Snowman.jpg": "c3bc492dc3e681111de51c5777ade6a7fd356e91",
                "data/textures/LibOut_Tree_LOD.png": "4c2f418c1c18c5a21ee4a20de0057ff7fc47d73b",
                "data/textures/LightNoise.jpg": "845e184f87a9a2a6645351ec4c467812160d7dc1",
                "data/textures/Lighthouse.jpg": "55b2ff0c8d517ddb98064c0a4fa2dc27395511c9",
                "data/textures/Noise.jpg": "7cdf9bb4fd68d1cb4e269748ab1c873e5c3c896c",
                "data/textures/Venus.jpg": "efc4853596d27a13db688fe39b7544ce5250f895",
                "data/textures/WaterBump.jpg": "d48d2136b6af6fd4d7f1f6eca093ac3f76b5e194",
                "data/textures/WaterBumpAndReflection.png": "cbe337f758a68c45cade730b3cf688c93dde083d",
                "data/textures/heatmap_blur.png": "706e03d85a672c024a849f9e8fa944dcc9d352dc",
                "data/textures/heatmap_gradient.png": "372640d07aea150e5f88206a23787922ccabc0cf",
                "examples/US.png": "75b0a61311c8a421e7cbcb734b71f2b0bd1c5741",
                "examples/beachflag-sprite.png": "cc9985bd85800811dd9d1d5730a2a2a2f194905e",
                "examples/beachflag.png": "cad465f6287543b90d4bf8e1e3bedd4bcea24b26",
                "examples/blue-marker.png": "70f05611305f77658e8f1a9827e5ddbdf97462b6",
                "examples/bluecirclemarker.png": "57f9d91839020f0802ebf5b65d998db2616e195f",
                "examples/redpoint.png": "45ac1e4b1a8544473219ad3326c67cfff2cdca2f",
                "i18n/translation.en.json": "cd5bd2303bb5ac757e2aa1657b76eadc162bc64a",
                "i18n/translation.fr.json": "cd5bd2303bb5ac757e2aa1657b76eadc162bc64a",
                "images/compass.png": "a6be7252d4e3b2a811bb21940bf6871fc864efbd",
                "images/compass_nav.png": "4d8a6855410452128970d11cfa2407e1202f73a2",
                "images/compass_nav_new.png": "507b621144322e851f95f1e0d31ea9ff5d2d4531",
                "images/compass_needle.png": "4c94b4e3fc8bd7b396483e041250961c87f5bccd",
                "images/default_favicon.png": "f2cb32957a1f69928396acf4ec8fc0cb411210a9",
                "images/f4_favicon.png": "7c9b8dc1271ef66637eb7ff76f58db6b3b8484c5",
                "images/favicon.ico": "556e296d0aef7b71e06b8e905bdd837c412e137d",
                "images/loading.gif": "942d8fe092c1c473af19906751c2bee5322a9b55",
                "images/loading.jpg": "9434585def04c425b5c4255bb90862b5d0af1222",
                "images/marker-icon.png": "70f05611305f77658e8f1a9827e5ddbdf97462b6",
                "lib/img/blank.gif": "9d01cc5dc8e042c0d4ad6cfb8b3ac38e84a5ef9f",
                "lib/img/cloud-popup-relative.png": "e8fbcac3e0a69aefe8be56fe20bd2b246da559bc",
                "lib/img/drag-rectangle-off.png": "e5721026018618a7fa3c66b27b50e866794b59b3",
                "lib/img/drag-rectangle-on.png": "7db140db94f9bb046bcd6a0c8b6aa03bd78190af",
                "lib/img/east-mini.png": "346108b23379af8b1de5936953cdd4955b7a5c82",
                "lib/img/layer-switcher-maximize.png": "085cbd47b83fedcc6bda25dc0499df33a592a49c",
                "lib/img/layer-switcher-minimize.png": "c77c664fac799fc44e748da3860bed8d05c16f45",
                "lib/img/marker-blue.png": "a574ad17b0b0f6f3d5ffa62bbac07a372adf86f9",
                "lib/img/marker-gold.png": "27fc5cee85232b5ee02dfa6d64f402cd0de99656",
                "lib/img/marker-green.png": "96aa21d30959077213863ffc4662962f45e9ea04",
                "lib/img/marker.png": "55b37fac9add56cd5d525d3c7ea45c4b87e430a6",
                "lib/img/measuring-stick-off.png": "2f05b3113e22bd5ec812bbacf05f1b7267b0f21e",
                "lib/img/measuring-stick-on.png": "843bcde3700d62eada96331d2a5683867abe2ab9",
                "lib/img/north-mini.png": "d592063e7c7df29280cc4518516979fb31524858",
                "lib/img/panning-hand-off.png": "1a1563dafa64cf5d6db93b9970de2961facabe65",
                "lib/img/panning-hand-on.png": "b210d7d20d3786119bc10426a45735a82730d47c",
                "lib/img/slider.png": "9d1073ce20c3ea542b9dd4cd8b81049766fb5db1",
                "lib/img/south-mini.png": "e7392c3446c480434ea4ab39c3460809d631c639",
                "lib/img/west-mini.png": "df984d537428fc20fc3a5658fc67b1bec9de6da3",
                "lib/img/zoom-minus-mini.png": "5eecc1efb60e5530a18887a138844966236a90f9",
                "lib/img/zoom-plus-mini.png": "ac6d1f36ddd2357b95115fa4e29ba51494a3cfa0",
                "lib/img/zoom-world-mini.png": "a30017e2bb4c5e8c7e142e816b79df977ee4973a",
                "lib/img/zoombar.png": "07ca32c259e6990cda44b0c913d1589aec0eaf7f",
                "lib/jscolor/arrow.gif": "425fee7ea7bc578c8e3f6298ebd6c3619738f2eb",
                "lib/jscolor/cross.gif": "563b3d5d8cb15f4b5f99e05206c5a6d238111210",
                "lib/jscolor/demo.html": "db97c3a69a80de78486610f84b2059d04c739c07",
                "lib/jscolor/hs.png": "8a937187ca475f678753774b244deecbb06fbd82",
                "lib/jscolor/hv.png": "1781663d8c4c2937de23de0b7fdc2899ec7aec7a",
                "lib/jscolor/jscolor.js": "ca1ee050ea5f7f69f1d1252c40a17663ec8ce698",
                "lib/leaflet/leaflet.css": "7d24bfaf6965f362f8ac4527876a7ba54ee4f0b8",
                "lib/leaflet/images/layers-2x.png": "34239130c3aea22f21455746284d5a266435fa39",
                "lib/leaflet/images/layers.png": "0dbc42bf6f9b7166196dd88bdbb45a11307ec8a5",
                "lib/leaflet/images/marker-icon-2x.png": "77a97a1552a99795fb7ebcf9117cbe7fa653eb8a",
                "lib/leaflet/images/marker-icon.png": "70f05611305f77658e8f1a9827e5ddbdf97462b6",
                "lib/leaflet/images/marker-shadow.png": "1edd41cfd08b19f0ea18a1fc3f603b7bb9bb2b95",
                "lib/theme/default/google.css": "fd99dbb6fd953da7391dc46368fc16360ffc5b42",
                "lib/theme/default/ie6-style.css": "2a2c5dcf93778567dd20e64c06f09b0458e3b4c9",
                "lib/theme/default/style.css": "7613753876252711f06443b17dc2954a072754e0",
                "lib/theme/default/style.mobile.css": "801555ccbe5d2ed40be782c5ec0f48113cac389c",
                "lib/theme/default/img/add_point_off.png": "619054b425cc09b106f5a54ba51ac807caeb7640",
                "lib/theme/default/img/add_point_on.png": "295aaebda3569b5653e2927886c4b694b7b33734",
                "lib/theme/default/img/blank.gif": "9d01cc5dc8e042c0d4ad6cfb8b3ac38e84a5ef9f",
                "lib/theme/default/img/close.gif": "c4ea801f6f43d6fa6e89b388afd4df89a0e713dd",
                "lib/theme/default/img/drag-rectangle-off.png": "e5721026018618a7fa3c66b27b50e866794b59b3",
                "lib/theme/default/img/drag-rectangle-on.png": "7db140db94f9bb046bcd6a0c8b6aa03bd78190af",
                "lib/theme/default/img/draw_line_off.png": "ab83b59394bf77b35cbd2bc8ca720842f47f663d",
                "lib/theme/default/img/draw_line_on.png": "d43b705b050ca579b9fc73b46d56770dac76d405",
                "lib/theme/default/img/draw_point_off.png": "e2ff88470ddbd5acdc766780f9da83ee18d2e0e8",
                "lib/theme/default/img/draw_point_on.png": "4fde22d395a31a6b537e9e9e47d8ff69338b2653",
                "lib/theme/default/img/draw_polygon_off.png": "e9df960d7ce29fffc145fb4859805a2a9cd758de",
                "lib/theme/default/img/draw_polygon_on.png": "7564de8e5c13a6a291583d3cd5beffb867a1d5ec",
                "lib/theme/default/img/editing_tool_bar.png": "58603c8cbc55a60800fbecbad6bd9b8ea73b3b5d",
                "lib/theme/default/img/move_feature_off.png": "db3823427a91e74b5b0fb127105f7776b2eb152f",
                "lib/theme/default/img/move_feature_on.png": "7621e3c335a1f300edd78620ee9a7957aeb9442d",
                "lib/theme/default/img/navigation_history.png": "46be1e5958ab1901efd9401f3528942e32fc0190",
                "lib/theme/default/img/overview_replacement.gif": "7191fd2cb81a52f88030caed0f43f55f1aa208d4",
                "lib/theme/default/img/pan-panel-NOALPHA.png": "5bc7d194a3f43ebcbee8c7d064b469ddfd3b2149",
                "lib/theme/default/img/pan-panel.png": "546442b686590881171287f354fe14d0751ad3f7",
                "lib/theme/default/img/pan_off.png": "41ee45f0c9be87468928d302aa3ca1180e3538d1",
                "lib/theme/default/img/pan_on.png": "36b6e7c6abf93fb1c6ea36fcce95a415a389b2d5",
                "lib/theme/default/img/panning-hand-off.png": "1a1563dafa64cf5d6db93b9970de2961facabe65",
                "lib/theme/default/img/panning-hand-on.png": "b210d7d20d3786119bc10426a45735a82730d47c",
                "lib/theme/default/img/remove_point_off.png": "7641cb56ff0c25d7b3c2bc8ddb9795fc0330fe3e",
                "lib/theme/default/img/remove_point_on.png": "b54a3a18b1f684f5d433701efc6d1718a3d947ac",
                "lib/theme/default/img/ruler.png": "2711b71805e51eb7cbe4e137398f75e643c3b77b",
                "lib/theme/default/img/save_features_off.png": "5e29327a104b47f716e6a281aab9a1473f3201e0",
                "lib/theme/default/img/save_features_on.png": "c8d14a9516ebf6d6931e873b05da6a59b3683ae5",
                "lib/theme/default/img/view_next_off.png": "b9035ea7b3c822f5c35540c9539dd7609acb4f39",
                "lib/theme/default/img/view_next_on.png": "acd63411a72ee52538def521a53f2639a45b6e41",
                "lib/theme/default/img/view_previous_off.png": "8581a73ee4ba21a68d0f55c679253abde1658056",
                "lib/theme/default/img/view_previous_on.png": "67dfa697a59120820b6f7fb60f3ccd608b23065e",
                "lib/theme/default/img/zoom-panel-NOALPHA.png": "17fe004434d037e265643aad32c0739f6fc4dc77",
                "lib/theme/default/img/zoom-panel.png": "2209fa9ddc8c1464b4ea50ae2ed7084f83c39ded",
                "fonts/FontAwesome.otf": "46198321f916ab2aa86c0ad51e0aacaa73783bd7",
                "fonts/fontawesome-webfont.eot": "ad0c0513a2fbb7326ac5e11f7c94b95aa23b02e0",
                "fonts/fontawesome-webfont.svg": "2dae80725de31dbb78dbded93a8a9ea9f988e40a",
                "fonts/fontawesome-webfont.ttf": "c59792c0a05a4da1f9202a390a27e2d500c36752",
                "fonts/fontawesome-webfont.woff": "7f2f3c55c2de192387c351b995115f6b79e09173",
                "css/changelog.css": "95cda4eb50ded446294830b8b0d25ac65e8ec4d3",
                "css/documentation.css": "bbf120d5ba02d57be6ccc0f9db21c4b0b0ee1dc2",
                "css/example-fullpage.css": "b9a1fd4b5d7562e0daa02f81c6ff5d3788fea35c",
                "css/example.css": "12924ef2a3b26ec37fe66ca11f116a101aef2431",
                "css/examples.css": "4f36d696aca52e12dc45514e7c62997cbce2fafd",
                "css/f4-map-api.css": "badbb9d78df39654f9e9458e7dff1939ce8c321e",
                "_worker.js": "ae64becc86d45d7397edc75e98af7ba3e7dbd0ad",
                "_worker.js.map": "ae64becc86d45d7397edc75e98af7ba3e7dbd0ad"
            }
        }
    }, {}],
    438: [function(e, t, i) {
        t.exports = {
            i18next: {
                resGetPath: "/static/i18n/__ns__.__lng__.json"
            }
        }
    }, {}]
}, {}, [309]);
//# sourceMappingURL=api.js.map